

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fuk.png">
  <link rel="icon" href="https://img.dkdun.cn/v1/2024/12/83e0272660805f52.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="butt3rf1y">
  <meta name="keywords" content="">
  
    <meta name="description" content="低空经济网络安全The Hidden Link12我们截获了一个名为“MAV1”的恐怖组织发出的无人机遥测下行数据。&#96;capture.pcap&#96;中的数据流量看起来很正常，是吗？We&#x27;ve intercepted a drone&#x27;s telemetry downlink from a terrorist group called &quot;MAV1&quot;. The tra">
<meta property="og:type" content="article">
<meta property="og:title" content="第八届“强网”拟态防御国际精英挑战赛">
<meta property="og:url" content="http://example.com/2025/10/31/%E7%AC%AC%E5%85%AB%E5%B1%8A%E2%80%9C%E5%BC%BA%E7%BD%91%E2%80%9D%E6%8B%9F%E6%80%81%E9%98%B2%E5%BE%A1%E5%9B%BD%E9%99%85%E7%B2%BE%E8%8B%B1%E6%8C%91%E6%88%98%E8%B5%9B/index.html">
<meta property="og:site_name" content="(｡･ω･｡)Welcome~">
<meta property="og:description" content="低空经济网络安全The Hidden Link12我们截获了一个名为“MAV1”的恐怖组织发出的无人机遥测下行数据。&#96;capture.pcap&#96;中的数据流量看起来很正常，是吗？We&#x27;ve intercepted a drone&#x27;s telemetry downlink from a terrorist group called &quot;MAV1&quot;. The tra">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img.dkdun.cn/v1/2025/12/7445be6e12538c08.png">
<meta property="og:image" content="https://img.dkdun.cn/v1/2025/12/18050df4ad4cc704.png">
<meta property="og:image" content="https://img.dkdun.cn/v1/2025/12/bfc125be7b0c8f93.png">
<meta property="og:image" content="https://img.dkdun.cn/v1/2025/12/e219ce3ca518f4bf.png">
<meta property="og:image" content="https://img.dkdun.cn/v1/2025/12/11cfbafdce4552c2.png">
<meta property="og:image" content="https://img.dkdun.cn/v1/2025/12/087c30a4ad0a0b09.png">
<meta property="og:image" content="https://img.dkdun.cn/v1/2025/12/150b7c758f257193.png">
<meta property="og:image" content="https://img.dkdun.cn/v1/2025/12/a8a1d9ef1639f9d4.png">
<meta property="og:image" content="https://img.dkdun.cn/v1/2025/12/9b49f75c5f12e8c8.png">
<meta property="og:image" content="https://img.dkdun.cn/v1/2025/12/8b27d0258edaef79.png">
<meta property="og:image" content="https://img.dkdun.cn/v1/2025/12/eb3da915dc7fdaa6.png">
<meta property="og:image" content="https://img.dkdun.cn/v1/2025/12/5944452d05dbf31b.png">
<meta property="og:image" content="https://img.dkdun.cn/v1/2025/12/41929ce197bcbd01.png">
<meta property="og:image" content="https://img.dkdun.cn/v1/2025/12/f4e50fa745cc942b.png">
<meta property="og:image" content="https://img.dkdun.cn/v1/2025/12/c17646a2974eb246.png">
<meta property="og:image" content="https://img.dkdun.cn/v1/2025/12/c66cdb2fdc6c6077.png">
<meta property="og:image" content="https://img.dkdun.cn/v1/2025/12/00d3b8af7bf992c2.png">
<meta property="og:image" content="https://img.dkdun.cn/v1/2025/12/cd6c5205dfbd7d36.png">
<meta property="og:image" content="https://img.dkdun.cn/v1/2025/12/4066a7447d75e5fb.png">
<meta property="og:image" content="https://img.dkdun.cn/v1/2025/12/55e419b47d592310.png">
<meta property="og:image" content="https://img.dkdun.cn/v1/2025/12/dd79dc89c493ae3c.png">
<meta property="og:image" content="https://img.dkdun.cn/v1/2025/12/ce9ef01f983743aa.png">
<meta property="og:image" content="https://img.dkdun.cn/v1/2025/12/bcda459476d065a1.png">
<meta property="og:image" content="https://img.dkdun.cn/v1/2025/12/24bc4016f8397602.png">
<meta property="og:image" content="https://img.dkdun.cn/v1/2025/12/b2d65af1ffa097eb.png">
<meta property="og:image" content="https://img.dkdun.cn/v1/2025/12/6d358b308a2ae6ce.png">
<meta property="og:image" content="https://img.dkdun.cn/v1/2025/12/3445360aea5140f4.png">
<meta property="og:image" content="https://img.dkdun.cn/v1/2025/12/8054575a4a972a55.png">
<meta property="og:image" content="https://img.dkdun.cn/v1/2025/12/9673f512ff5afe4e.png">
<meta property="article:published_time" content="2025-10-31T15:21:07.000Z">
<meta property="article:modified_time" content="2025-10-31T16:01:45.022Z">
<meta property="article:author" content="butt3rf1y">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://img.dkdun.cn/v1/2025/12/7445be6e12538c08.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>第八届“强网”拟态防御国际精英挑战赛 - (｡･ω･｡)Welcome~</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":false,"loading_img":"/img/loading.gif","onlypost":true,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  



  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>butt3rf1y&#39;s Space</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://img.dkdun.cn/v1/2025/12/ee5d8516e3530463.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.1)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="第八届“强网”拟态防御国际精英挑战赛"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-10-31 23:21" pubdate>
          2025年10月31日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          3.1k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          26 分钟
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> 次
        </span>
        

      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

	<link rel="icon" href="https://img.dkdun.cn/v1/2024/12/e40f2f1a8320e35c.png" type="image/x-icon">
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">第八届“强网”拟态防御国际精英挑战赛</h1>
            
              <p id="updated-time" class="note note-info" style="">
                
                  
                    本文最后更新于 2025年11月1日 凌晨
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <h1 id="低空经济网络安全"><a href="#低空经济网络安全" class="headerlink" title="低空经济网络安全"></a>低空经济网络安全</h1><h2 id="The-Hidden-Link"><a href="#The-Hidden-Link" class="headerlink" title="The Hidden Link"></a>The Hidden Link</h2><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">我们截获了一个名为“MAV1”的恐怖组织发出的无人机遥测下行数据。`capture.pcap`中的数据流量看起来很正常，是吗？<br>W<span class="hljs-string">e&#x27;ve intercepted a drone&#x27;</span>s telemetry downlink <span class="hljs-keyword">from</span> a terrorist <span class="hljs-keyword">group</span> <span class="hljs-keyword">called</span> &quot;MAV1&quot;. The traffic <span class="hljs-keyword">in</span> `capture.pcap` appears <span class="hljs-keyword">to</span> be normal, <span class="hljs-keyword">or</span> <span class="hljs-keyword">is</span> it?<br></code></pre></td></tr></table></figure>

<p>访问几个数据包就会发现有疑似 flag 的字符</p>
<p><img src="https://img.dkdun.cn/v1/2025/12/7445be6e12538c08.png"></p>
<p>用 strings 提取字符</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-keyword">Bk3d&#125;</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">Bll3r</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">BflagJ</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">B&#123;dr0</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">Bt_c0:</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">Bntr0</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">B_h4c!</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">Bn3_f</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">Bl1gh</span><br></code></pre></td></tr></table></figure>

<p>去掉多余字母和标点符号，拼好 flag</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">flag&#123;dr<span class="hljs-number">0</span><span class="hljs-symbol">n3</span>_fl<span class="hljs-number">1</span>ght_c<span class="hljs-number">0</span><span class="hljs-symbol">ntr0</span>ll<span class="hljs-number">3</span>r_h<span class="hljs-number">4</span>ck<span class="hljs-number">3</span>d&#125;<br></code></pre></td></tr></table></figure>

<h1 id="Mobile"><a href="#Mobile" class="headerlink" title="Mobile"></a>Mobile</h1><h2 id="EZMiniAPP"><a href="#EZMiniAPP" class="headerlink" title="EZMiniAPP"></a>EZMiniAPP</h2><p>未加密，可以直接用 wxappUnpacker 反编译</p>
<p>在 chunk_0.appservice.js 文件中找到主函数，customEncrypt 是加密函数，有校验</p>
<p><img src="https://img.dkdun.cn/v1/2025/12/18050df4ad4cc704.png"></p>
<p>密文 ： [1, 33, 194, 133, 195, 102, 232, 104, 200, 14, 8, 163, 131, 71, 68, 97, 2, 76, 72, 171, 74, 106, 225, 1, 65]</p>
<p>密钥 Key： “newKey2025!”</p>
<p>要找出输入字符串 a，使得 <code>customEncrypt(a, &quot;newKey2025!&quot;)</code>  结果等于上面的密文数组，customEncrypt 直接调用了真正的加密函数 enigmaticTransformation</p>
<p>这里对密钥进行处理</p>
<p><img src="https://img.dkdun.cn/v1/2025/12/bfc125be7b0c8f93.png"></p>
<p>进行异或，用当前字符索引 o 对 3 取模的结果，采用不同的 XOR 规则</p>
<p><img src="https://img.dkdun.cn/v1/2025/12/e219ce3ca518f4bf.png"></p>
<p>按照值 c 不同对异或的结果 u 进行不同的移位</p>
<p><img src="https://img.dkdun.cn/v1/2025/12/11cfbafdce4552c2.png"></p>
<p>脚本如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> json<br><br>TARGET_CIPHER = [<br>    <span class="hljs-number">1</span>, <span class="hljs-number">33</span>, <span class="hljs-number">194</span>, <span class="hljs-number">133</span>, <span class="hljs-number">195</span>, <span class="hljs-number">102</span>, <span class="hljs-number">232</span>, <span class="hljs-number">104</span>, <span class="hljs-number">200</span>, <span class="hljs-number">14</span>, <span class="hljs-number">8</span>, <span class="hljs-number">163</span>, <span class="hljs-number">131</span>, <br>    <span class="hljs-number">71</span>, <span class="hljs-number">68</span>, <span class="hljs-number">97</span>, <span class="hljs-number">2</span>, <span class="hljs-number">76</span>, <span class="hljs-number">72</span>, <span class="hljs-number">171</span>, <span class="hljs-number">74</span>, <span class="hljs-number">106</span>, <span class="hljs-number">225</span>, <span class="hljs-number">1</span>, <span class="hljs-number">65</span><br>]<br><br>KEY_STR = <span class="hljs-string">&quot;newKey2025!&quot;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_key_array</span>(<span class="hljs-params">t_str</span>):<br>    <span class="hljs-keyword">return</span> [<span class="hljs-built_in">ord</span>(c) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> t_str]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">calculate_rotation_c</span>(<span class="hljs-params">i_arr</span>):<br>    t = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> e, val <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(i_arr):<br>        <span class="hljs-keyword">if</span> e % <span class="hljs-number">4</span> == <span class="hljs-number">0</span>:<br>            t += <span class="hljs-number">1</span> * val<br>        <span class="hljs-keyword">elif</span> e % <span class="hljs-number">4</span> == <span class="hljs-number">1</span>:<br>            t += val + <span class="hljs-number">0</span><br>        <span class="hljs-keyword">elif</span> e % <span class="hljs-number">4</span> == <span class="hljs-number">2</span>:<br>            t += <span class="hljs-number">0</span> | val<br>        <span class="hljs-keyword">elif</span> e % <span class="hljs-number">4</span> == <span class="hljs-number">3</span>:<br>            t += <span class="hljs-number">0</span> ^ val<br>    <span class="hljs-keyword">return</span> t % <span class="hljs-number">8</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">circular_right_shift</span>(<span class="hljs-params">value, shift</span>):<br>    value &amp;= <span class="hljs-number">0xFF</span> <br>    <span class="hljs-keyword">return</span> ((value &gt;&gt; shift) | (value &lt;&lt; (<span class="hljs-number">8</span> - shift))) &amp; <span class="hljs-number">0xFF</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">enigmatic_decryption</span>(<span class="hljs-params">cipher_arr, key_str</span>):<br>    key_arr = get_key_array(key_str)<br>    s = <span class="hljs-built_in">len</span>(key_arr)<br>    c = calculate_rotation_c(key_arr) <br><br>    decrypted_bytes = []<br>    <br>    <span class="hljs-keyword">for</span> o, h <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(cipher_arr):<br>        u = circular_right_shift(h, c)<br>        key_stream_val = key_arr[o % s]<br>        <br>        original_char_code = u ^ key_stream_val<br>        <br>        decrypted_bytes.append(original_char_code)<br><br>    <span class="hljs-keyword">try</span>:<br>        flag = <span class="hljs-string">&quot;&quot;</span>.join([<span class="hljs-built_in">chr</span>(b) <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> decrypted_bytes])<br>        <span class="hljs-keyword">return</span> flag<br>    <span class="hljs-keyword">except</span> ValueError:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;无法解码为有效字符串，可能解密错误&quot;</span><br><br>FLAG = enigmatic_decryption(TARGET_CIPHER, KEY_STR)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;目标密文 (Target Cipher): <span class="hljs-subst">&#123;TARGET_CIPHER&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;使用的密钥 (Key): &#x27;<span class="hljs-subst">&#123;KEY_STR&#125;</span>&#x27;&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;-&quot;</span> * <span class="hljs-number">30</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;计算出的旋转量 (c): <span class="hljs-subst">&#123;calculate_rotation_c(get_key_array(KEY_STR))&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;解密结果 (Flag): <span class="hljs-subst">&#123;FLAG&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>

<p>得到 flag</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;JustEasyMiniProgram&#125;</span><br></code></pre></td></tr></table></figure>

<h2 id="Just"><a href="#Just" class="headerlink" title="Just"></a>Just</h2><p>il2cpp 在安卓上的加密应用</p>
<p>查看源码，发现在程序启动时会加载 libjust.so 文件</p>
<p><img src="https://img.dkdun.cn/v1/2025/12/087c30a4ad0a0b09.png"></p>
<p>解包查看 libjust.so 文件，根据字符串定位到 sub_8288 函数，发现 hook 了dlopen</p>
<p><img src="https://img.dkdun.cn/v1/2025/12/150b7c758f257193.png"></p>
<p><img src="https://img.dkdun.cn/v1/2025/12/a8a1d9ef1639f9d4.png"></p>
<p>sub_8A0C 函数是校验函数，跟进分析，一个 RC4 的加密，异或 0x33</p>
<p>密钥为 “nihaounity”</p>
<p><img src="https://img.dkdun.cn/v1/2025/12/9b49f75c5f12e8c8.png"></p>
<p><img src="https://img.dkdun.cn/v1/2025/12/8b27d0258edaef79.png"></p>
<p>创建一个名为 “dec_il2cpp”的新文件，将解密后的内容写入此文件</p>
<p><img src="https://img.dkdun.cn/v1/2025/12/eb3da915dc7fdaa6.png"></p>
<p>加载 il2cpp.so 文件，发现加载不出来，所以可能需要解密这个 il2cpp.so</p>
<p><img src="https://img.dkdun.cn/v1/2025/12/5944452d05dbf31b.png"></p>
<p>根据加密逻辑和密钥用脚本解密 so 文件，脚本如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt_rc4_variant</span>(<span class="hljs-params">data: <span class="hljs-built_in">bytes</span>, key: <span class="hljs-built_in">str</span> = <span class="hljs-string">&quot;nihaounity&quot;</span>, xor_constant: <span class="hljs-built_in">int</span> = <span class="hljs-number">0x33</span></span>) -&gt; <span class="hljs-built_in">bytes</span>:<br><br>    key_bytes = key.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    key_len = <span class="hljs-built_in">len</span>(key_bytes)<br>    data_len = <span class="hljs-built_in">len</span>(data)<br><br>    s_box = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br><br>    j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + s_box[i] + key_bytes[i % key_len]) % <span class="hljs-number">256</span><br>        s_box[i], s_box[j] = s_box[j], s_box[i]<br>    i = <span class="hljs-number">0</span><br>    j = <span class="hljs-number">0</span><br>    decrypted_data = <span class="hljs-built_in">bytearray</span>(data)<br><br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(data_len):<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + s_box[i]) % <span class="hljs-number">256</span><br>        s_box[i], s_box[j] = s_box[j], s_box[i]<br>        t = (s_box[i] + s_box[j]) % <span class="hljs-number">256</span><br>        keystream_byte = s_box[t]<br>        decrypted_data[k] = data[k] ^ keystream_byte ^ xor_constant<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(decrypted_data)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br><br>    input_path = sys.argv[<span class="hljs-number">1</span>]<br>    output_path = sys.argv[<span class="hljs-number">2</span>]<br>    KEY = <span class="hljs-string">&quot;nihaounity&quot;</span><br>    XOR_CONST = <span class="hljs-number">0x33</span><br><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(input_path, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>            encrypted_data = f.read()<br><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] 正在读取文件: <span class="hljs-subst">&#123;input_path&#125;</span> (<span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(encrypted_data)&#125;</span> 字节)&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] 解密密钥: &#x27;<span class="hljs-subst">&#123;KEY&#125;</span>&#x27;, 异或常数: 0x<span class="hljs-subst">&#123;XOR_CONST:02x&#125;</span>&quot;</span>)<br>        <br>        decrypted_data = decrypt_rc4_variant(encrypted_data, KEY, XOR_CONST)<br><br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(output_path, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>            f.write(decrypted_data)<br><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] 解密完成，文件已保存至: <span class="hljs-subst">&#123;output_path&#125;</span>&quot;</span>)<br><br>    <span class="hljs-keyword">except</span> FileNotFoundError:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[!] 错误: 找不到文件 <span class="hljs-subst">&#123;input_path&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[!] 发生错误: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure>

<p>加载解密出来的 decil2cpp.so，文件很大，加载很慢，根据字符串的 global-metadata.dat 定位过去</p>
<p><img src="https://img.dkdun.cn/v1/2025/12/41929ce197bcbd01.png"></p>
<p>定位到 sub_211B8C 函数，发现这里在定位并加载元数据文件，调用了 sub_211D94 函数加载</p>
<p><img src="https://img.dkdun.cn/v1/2025/12/f4e50fa745cc942b.png"></p>
<p>跟进</p>
<p><img src="https://img.dkdun.cn/v1/2025/12/c17646a2974eb246.png"></p>
<p>加载数据的地方，继续跟进</p>
<p><img src="https://img.dkdun.cn/v1/2025/12/c66cdb2fdc6c6077.png"></p>
<p>来到 sub_21A2C8，这是一个解密函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">char</span> *__fastcall <span class="hljs-title function_">sub_21A2C8</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> __int16 *a1, __int64 a2)</span><br>&#123;<br>  __int64 v2; <span class="hljs-comment">// x21</span><br>  __int64 v4; <span class="hljs-comment">// x8</span><br>  __int64 v5; <span class="hljs-comment">// x22</span><br>  <span class="hljs-type">char</span> *v6; <span class="hljs-comment">// x19</span><br>  __int64 i; <span class="hljs-comment">// x8</span><br>  __int64 v8; <span class="hljs-comment">// x13</span><br>  __int64 v9; <span class="hljs-comment">// x12</span><br><br>  v2 = a1[<span class="hljs-number">512</span>];<br>  v4 = a2 - <span class="hljs-number">4</span> * v2;<br>  v5 = v4 - <span class="hljs-number">1028</span>;<br>  v6 = (<span class="hljs-type">char</span> *)<span class="hljs-built_in">malloc</span>(v4 - <span class="hljs-number">4</span>);<br>  <span class="hljs-built_in">memcpy</span>(v6, a1, <span class="hljs-number">0x400</span>u);<br>  <span class="hljs-keyword">if</span> ( v5 &gt;= <span class="hljs-number">1</span> )<br>  &#123;<br>    <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; v5; i += <span class="hljs-number">4</span> )<br>    &#123;<br>      v8 = i + <span class="hljs-number">3</span>;<br>      v9 = i + i / v2;<br>      <span class="hljs-keyword">if</span> ( i &gt;= <span class="hljs-number">0</span> )<br>        v8 = i;<br>      *(_DWORD *)&amp;v6[(v8 &amp; <span class="hljs-number">0xFFFFFFFFFFFFFFFC</span>LL) + <span class="hljs-number">1024</span>] = *(_DWORD *)((<span class="hljs-type">char</span> *)&amp;a1[<span class="hljs-number">2</span> * v2 + <span class="hljs-number">514</span>]<br>                                                                     + (v8 &amp; <span class="hljs-number">0xFFFFFFFFFFFFFFFC</span>LL))<br>                                                         ^ *(_DWORD *)&amp;a1[<span class="hljs-number">2</span> * (v9 % v2) + <span class="hljs-number">514</span>];<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">return</span> v6;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>根据逻辑写解密脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> struct<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> os<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt_metadata_custom_xor</span>(<span class="hljs-params">encrypted_data: <span class="hljs-built_in">bytes</span></span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>    data_len = <span class="hljs-built_in">len</span>(encrypted_data)<br><br>    v2 = struct.unpack(<span class="hljs-string">&#x27;&lt;H&#x27;</span>, encrypted_data[<span class="hljs-number">1024</span>:<span class="hljs-number">1026</span>])[<span class="hljs-number">0</span>]<br>    v5 = data_len - (<span class="hljs-number">4</span> * v2) - <span class="hljs-number">1028</span><br>    decrypted_data = <span class="hljs-built_in">bytearray</span>(encrypted_data)<br>    encrypted_data_base_offset = <span class="hljs-number">4</span> * v2 + <span class="hljs-number">1028</span><br>    keystream_base_offset = <span class="hljs-number">1028</span><br><br>    i = <span class="hljs-number">0</span> <br>    <span class="hljs-keyword">while</span> i &lt; v5:<br>        v9 = i + i // v2<br>        keystream_index = v9 % v2<br>        keystream_offset = keystream_base_offset + keystream_index * <span class="hljs-number">4</span><br>        encrypted_offset = encrypted_data_base_offset + i<br>        decrypted_offset = <span class="hljs-number">1024</span> + i<br>        keystream_block = struct.unpack(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, encrypted_data[keystream_offset:keystream_offset+<span class="hljs-number">4</span>])[<span class="hljs-number">0</span>]<br>        encrypted_block = struct.unpack(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, encrypted_data[encrypted_offset:encrypted_offset+<span class="hljs-number">4</span>])[<span class="hljs-number">0</span>]<br>        decrypted_block = encrypted_block ^ keystream_block<br>        struct.pack_into(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, decrypted_data, decrypted_offset, decrypted_block)<br>        <br>        i += <span class="hljs-number">4</span><br>        <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] 解密完成。共处理 <span class="hljs-subst">&#123;i&#125;</span> 字节数据。&quot;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(decrypted_data)<br>    expected_output_len = data_len - (<span class="hljs-number">4</span> * v2) - <span class="hljs-number">4</span><br>    <br>    <span class="hljs-keyword">if</span> expected_output_len &lt; <span class="hljs-built_in">len</span>(decrypted_data):<br>        decrypted_data = decrypted_data[:expected_output_len]<br>        <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] 解密完成。共处理 <span class="hljs-subst">&#123;i&#125;</span> 字节数据。最终输出长度: <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(decrypted_data)&#125;</span> 字节&quot;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(decrypted_data)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    input_path = sys.argv[<span class="hljs-number">1</span>]<br>    output_path = sys.argv[<span class="hljs-number">2</span>]<br><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(input_path, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        encrypted_data = f.read()<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] 正在读取文件: <span class="hljs-subst">&#123;input_path&#125;</span> (<span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(encrypted_data)&#125;</span> 字节)&quot;</span>)<br>    decrypted_data = decrypt_metadata_custom_xor(encrypted_data)<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(output_path, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        f.write(decrypted_data)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] 解密完成，文件已保存至: <span class="hljs-subst">&#123;output_path&#125;</span>&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure>

<p>解密后的 dat 文件用 Il2CppDumper 直接解包</p>
<p><img src="https://img.dkdun.cn/v1/2025/12/00d3b8af7bf992c2.png"></p>
<p>进入 DummyDll 目录，查看 Assembly-CSharp.dll，可以看到 Check 函数和加密函数</p>
<p><img src="https://img.dkdun.cn/v1/2025/12/cd6c5205dfbd7d36.png"></p>
<p>so 附加 Il2CppDumper 自动生成的 ida_py3.py 脚本和 script.json 文件恢复符号表，找 Flagchecker 看逻辑</p>
<p>CheckFlag 函数中有加密，两段不一样的，前面对前 8 个字节进行 tea 加密，v78 是 40 字节的密文</p>
<p><img src="https://img.dkdun.cn/v1/2025/12/4066a7447d75e5fb.png"></p>
<p>后一段是对剩下的 32 字节处理，每 8 字节还与前一个 8 字节进行异或</p>
<p><img src="https://img.dkdun.cn/v1/2025/12/55e419b47d592310.png"></p>
<p>观察 tea 函数，密文存在 a2 指向的内存位置</p>
<p><img src="https://img.dkdun.cn/v1/2025/12/dd79dc89c493ae3c.png"></p>
<p>密文和密钥我没有环境，不好调试，在 cctor 中有初始化类的静态字段，初始化了密钥和密文，可以从这 Filed 去找</p>
<p><img src="https://img.dkdun.cn/v1/2025/12/ce9ef01f983743aa.png"></p>
<p>查看 dump.cs，搜索 PrivateImplementationDetails </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c">internal sealed <span class="hljs-class"><span class="hljs-keyword">class</span> &lt;</span>PrivateImplementationDetails&gt; <span class="hljs-comment">// TypeDefIndex: 2223</span><br>&#123;<br>	<span class="hljs-comment">// Fields</span><br>	internal <span class="hljs-type">static</span> readonly &lt;PrivateImplementationDetails&gt;.__StaticArrayInitTypeSize=<span class="hljs-number">40</span> <span class="hljs-number">29F</span>C2CC7503351583297C73AC477A5D7AA78899F3C0D66E1F909139D4AA1FFB2 <span class="hljs-comment">/*Metadata offset 0xF901D*/</span>; <span class="hljs-comment">// 0x0</span><br>	internal <span class="hljs-type">static</span> readonly &lt;PrivateImplementationDetails&gt;.__StaticArrayInitTypeSize=<span class="hljs-number">16</span> C8E4E9E3F34C25560172B0D40B6DF4823260AA87EC6866054AA4691711E5D7BF <span class="hljs-comment">/*Metadata offset 0xF9045*/</span>; <span class="hljs-comment">// 0x28</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>这里找到了偏移 0xF901D 和 0xF904，直接按结构偏移读 global-data.dat 的数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys, binascii<br><span class="hljs-keyword">from</span> pathlib <span class="hljs-keyword">import</span> Path<br><br>META_PATH = <span class="hljs-string">&quot;g-d.dat&quot;</span><br><br>DEFAULTS = &#123;<br>    <span class="hljs-string">&quot;Ciphertext_40&quot;</span>: &#123;<span class="hljs-string">&quot;offset&quot;</span>: <span class="hljs-number">0xF901D</span>, <span class="hljs-string">&quot;size&quot;</span>: <span class="hljs-number">40</span>&#125;,<br>    <span class="hljs-string">&quot;XTEAKey_16&quot;</span>: &#123;<span class="hljs-string">&quot;offset&quot;</span>: <span class="hljs-number">0xF9045</span>, <span class="hljs-string">&quot;size&quot;</span>: <span class="hljs-number">16</span>&#125;,<br>&#125;<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    meta = Path(META_PATH)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> meta.is_file():<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;metadata file not found: <span class="hljs-subst">&#123;META_PATH&#125;</span>&quot;</span>)<br>        sys.exit(<span class="hljs-number">1</span>)<br><br>    data = meta.read_bytes()<br><br>    cipher = key = <span class="hljs-literal">None</span><br>    <span class="hljs-keyword">for</span> name, info <span class="hljs-keyword">in</span> DEFAULTS.items():<br>        off = info[<span class="hljs-string">&quot;offset&quot;</span>]<br>        size = info[<span class="hljs-string">&quot;size&quot;</span>]<br>        <span class="hljs-keyword">if</span> off &gt;= <span class="hljs-built_in">len</span>(data):<br>            <span class="hljs-keyword">continue</span><br>        blob = data[off:off + size]<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;Ciphertext&quot;</span> <span class="hljs-keyword">in</span> name:<br>            cipher = blob<br>        <span class="hljs-keyword">elif</span> <span class="hljs-string">&quot;Key&quot;</span> <span class="hljs-keyword">in</span> name:<br>            key = blob<br><br>    <span class="hljs-keyword">if</span> cipher:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Ciphertext HEX:&quot;</span>, binascii.hexlify(cipher).decode().upper())<br>    <span class="hljs-keyword">if</span> key:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Key HEX       :&quot;</span>, binascii.hexlify(key).decode().upper())<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br><br></code></pre></td></tr></table></figure>

<p>拿到密文和密钥</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cmd">Ciphertext HEX: AF5864409DB92167AEB529049E86C543230FBFA6B2AE4AB5C569B7A803D1AECFC62C5B7FA2861E1A<br>Key HEX       : <span class="hljs-number">78563412121110091615141318171615</span><br></code></pre></td></tr></table></figure>

<p>解密逻辑：最开始对最前 8 个字节进行 tea 解密，随后的 32 字节每 8 字节要与前一个 8 字节进行异或，从后往前循环</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> struct<br><span class="hljs-keyword">import</span> binascii<br><br>ROUNDS = <span class="hljs-number">16</span><br>DELTA = <span class="hljs-number">0x61C88647</span><br>MASK = <span class="hljs-number">0xFFFFFFFF</span><br><br>KEY_BYTES = binascii.unhexlify(<span class="hljs-string">&quot;78563412121110091615141318171615&quot;</span>)<br>KEY_WORDS = struct.unpack(<span class="hljs-string">&#x27;&lt;IIII&#x27;</span>, KEY_BYTES)<br><br>CIPHERTEXT_HEX = <span class="hljs-string">&quot;AF5864409DB92167AEB529049E86C543230FBFA6B2AE4AB5C569B7A803D1AECFC62C5B7FA2861E1A&quot;</span><br>CIPHERTEXT_BYTES = <span class="hljs-built_in">bytearray</span>(binascii.unhexlify(CIPHERTEXT_HEX))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt_block</span>(<span class="hljs-params">v0, v1, key_words</span>):<br>    k0, k1, k2, k3 = key_words<br>    s = (<span class="hljs-number">0</span> - DELTA * ROUNDS) &amp; MASK<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ROUNDS):<br>        s = (s + DELTA) &amp; MASK<br>        v1 = (v1 - (((v0 &lt;&lt; <span class="hljs-number">4</span>) + k2) ^ (v0 + s) ^ ((v0 &gt;&gt; <span class="hljs-number">5</span>) + k3))) &amp; MASK<br>        v0 = (v0 - (((v1 &lt;&lt; <span class="hljs-number">4</span>) + k0) ^ (v1 + s) ^ ((v1 &gt;&gt; <span class="hljs-number">5</span>) + k1))) &amp; MASK<br>    <span class="hljs-keyword">return</span> v0, v1<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt_data</span>(<span class="hljs-params">cipher_bytes, key_words</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">2</span>):<br>        c0, c1 = struct.unpack(<span class="hljs-string">&#x27;&lt;II&#x27;</span>, cipher_bytes[<span class="hljs-number">0</span>:<span class="hljs-number">8</span>])<br>        offset = i * <span class="hljs-number">4</span><br>        ci, cj = struct.unpack(<span class="hljs-string">&#x27;&lt;II&#x27;</span>, cipher_bytes[offset:offset+<span class="hljs-number">8</span>])<br>        pi = ci ^ c0<br>        pj = cj ^ c1<br>        cipher_bytes[offset:offset+<span class="hljs-number">8</span>] = struct.pack(<span class="hljs-string">&#x27;&lt;II&#x27;</span>, pi, pj)<br>        dv0, dv1 = decrypt_block(c0, c1, key_words)<br>        cipher_bytes[<span class="hljs-number">0</span>:<span class="hljs-number">8</span>] = struct.pack(<span class="hljs-string">&#x27;&lt;II&#x27;</span>, dv0, dv1)<br>    f0, f1 = struct.unpack(<span class="hljs-string">&#x27;&lt;II&#x27;</span>, cipher_bytes[<span class="hljs-number">0</span>:<span class="hljs-number">8</span>])<br>    rf0, rf1 = decrypt_block(f0, f1, key_words)<br>    cipher_bytes[<span class="hljs-number">0</span>:<span class="hljs-number">8</span>] = struct.pack(<span class="hljs-string">&#x27;&lt;II&#x27;</span>, rf0, rf1)<br>    <span class="hljs-keyword">return</span> cipher_bytes<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">run_decryption</span>():<br>    result = decrypt_data(CIPHERTEXT_BYTES, KEY_WORDS)<br>    flag = result.rstrip(<span class="hljs-string">b&#x27;\x00&#x27;</span>).decode(<span class="hljs-string">&#x27;ascii&#x27;</span>, errors=<span class="hljs-string">&#x27;ignore&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Decrypted HEX:&quot;</span>, binascii.hexlify(result).decode().upper())<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Decrypted ASCII:&quot;</span>, flag)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    run_decryption()<br></code></pre></td></tr></table></figure>

<p>得到 flag</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby">flag&#123;unitygame_I5S0ooFunny_Isnotit?<span class="hljs-string">??</span><span class="hljs-string">??</span>&#125;<br></code></pre></td></tr></table></figure>

<h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="hyperjump"><a href="#hyperjump" class="headerlink" title="hyperjump"></a>hyperjump</h2><p>vm 类型的题目</p>
<p><img src="https://img.dkdun.cn/v1/2025/12/bcda459476d065a1.png"></p>
<p>根进函数可以看到调度器，典型的 VM switch-case 结构</p>
<p><img src="https://img.dkdun.cn/v1/2025/12/24bc4016f8397602.png"></p>
<p>跟进 case 里跳转的函数可以看到这是 VM 指令处理器，有一些 VM 指令</p>
<p><img src="https://img.dkdun.cn/v1/2025/12/b2d65af1ffa097eb.png"></p>
<p>分析可知为单字节加密，输入长度为 24，这里的 v24 是字符串输入的索引</p>
<p><img src="https://img.dkdun.cn/v1/2025/12/6d358b308a2ae6ce.png"></p>
<p>可以进行侧信道爆破，用 Pintools，并且题目还给了 md5 值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> subprocess<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><span class="hljs-comment"># --- 1. 配置区 ---</span><br><br>TARGET_BINARY = os.path.abspath(<span class="hljs-string">&#x27;./hyperjump&#x27;</span>)<br>FLAG_LEN = <span class="hljs-number">24</span><br>START_INDEX = <span class="hljs-number">0</span><br><br>PIN_ROOT = <span class="hljs-string">&#x27;/root/pin&#x27;</span><br>PIN_TOOL_PATH = os.path.abspath(<span class="hljs-string">&#x27;./pin/source/tools/ManualExamples/obj-intel64/inscount0.so&#x27;</span>)<br><br>PIN_CMD_LIST = [os.path.join(PIN_ROOT, <span class="hljs-string">&#x27;pin&#x27;</span>), <span class="hljs-string">&#x27;-t&#x27;</span>, PIN_TOOL_PATH, <span class="hljs-string">&#x27;--&#x27;</span>, TARGET_BINARY]<br><br>CHARSET = string.ascii_lowercase + string.digits + <span class="hljs-string">&quot;_@&#123;&#125;&quot;</span><br><br>context.log_level = <span class="hljs-string">&#x27;info&#x27;</span><br><br><br><span class="hljs-comment"># --- 2. 使用 subprocess 可靠获取 Pin 输出并解析指令数 ---</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">read_inscount_outfile</span>(<span class="hljs-params">workdir=<span class="hljs-literal">None</span></span>):<br>    candidates = [<span class="hljs-string">&#x27;inscount.out&#x27;</span>, <span class="hljs-string">&#x27;inscount.txt&#x27;</span>, <span class="hljs-string">&#x27;pin.out&#x27;</span>]<br>    <span class="hljs-keyword">for</span> name <span class="hljs-keyword">in</span> candidates:<br>        path = os.path.join(workdir <span class="hljs-keyword">if</span> workdir <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;.&#x27;</span>, name)<br>        <span class="hljs-keyword">if</span> os.path.exists(path):<br>            <span class="hljs-keyword">try</span>:<br>                <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(path, <span class="hljs-string">&#x27;r&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>, errors=<span class="hljs-string">&#x27;ignore&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>                    data = f.read()<br>                <span class="hljs-comment"># 尝试解析数字</span><br>                m = re.search(<span class="hljs-string">r&#x27;(\d+)\s+instructions&#x27;</span>, data)<br>                <span class="hljs-keyword">if</span> m:<br>                    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(m.group(<span class="hljs-number">1</span>)), data<br>                <span class="hljs-comment"># 直接取第一个数字</span><br>                m2 = re.search(<span class="hljs-string">r&#x27;(\d+)&#x27;</span>, data)<br>                <span class="hljs-keyword">if</span> m2:<br>                    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(m2.group(<span class="hljs-number">1</span>)), data<br>            <span class="hljs-keyword">except</span> Exception:<br>                <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>, <span class="hljs-literal">None</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_inscount</span>(<span class="hljs-params">payload: <span class="hljs-built_in">bytes</span></span>) -&gt; <span class="hljs-built_in">int</span>:<br><br>    IO_TIMEOUT = <span class="hljs-number">5</span><br>    log.info(<span class="hljs-string">f&quot;Testing payload: <span class="hljs-subst">&#123;payload.decode(<span class="hljs-string">&#x27;latin-1&#x27;</span>)[:START_INDEX+<span class="hljs-number">1</span>]&#125;</span>...&quot;</span>)<br><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-comment"># 启动 Pin 并把 payload 发到 stdin</span><br>        <span class="hljs-comment"># 注意：text=True 使 input/outputs 为 str 类型</span><br>        proc = subprocess.run(<br>            PIN_CMD_LIST,<br>            <span class="hljs-built_in">input</span>=payload.decode(<span class="hljs-string">&#x27;latin-1&#x27;</span>) + <span class="hljs-string">&#x27;\n&#x27;</span>,  <span class="hljs-comment"># 把 payload 当作 stdin 发给程序</span><br>            capture_output=<span class="hljs-literal">True</span>,<br>            timeout=IO_TIMEOUT,<br>            text=<span class="hljs-literal">True</span>,<br>            cwd=<span class="hljs-string">&#x27;.&#x27;</span>  <span class="hljs-comment"># 确保当前目录是工作目录（inscount 输出文件通常在 cwd）</span><br>        )<br><br>        stdout = proc.stdout <span class="hljs-keyword">or</span> <span class="hljs-string">&quot;&quot;</span><br>        stderr = proc.stderr <span class="hljs-keyword">or</span> <span class="hljs-string">&quot;&quot;</span><br>        exitcode = proc.returncode<br><br>        <span class="hljs-comment"># 打印调试信息（PID 不好拿到，因为 subprocess.run 是阻塞调用）</span><br>        sys.stderr.write(<span class="hljs-string">f&quot;\n--- Pin Tool 完整输出 (Exit Code <span class="hljs-subst">&#123;exitcode&#125;</span>): ---\n&quot;</span>)<br>        <span class="hljs-keyword">if</span> stdout.strip():<br>            sys.stderr.write(<span class="hljs-string">&quot;[stdout]\n&quot;</span> + stdout.strip() + <span class="hljs-string">&quot;\n&quot;</span>)<br>        <span class="hljs-keyword">if</span> stderr.strip():<br>            sys.stderr.write(<span class="hljs-string">&quot;[stderr]\n&quot;</span> + stderr.strip() + <span class="hljs-string">&quot;\n&quot;</span>)<br>        sys.stderr.write(<span class="hljs-string">&quot;--------------------------------------------------\n&quot;</span>)<br><br>        combined = stdout + <span class="hljs-string">&quot;\n&quot;</span> + stderr<br><br>        <span class="hljs-comment"># 1) 先在 combined 输出中查找像 &quot;12345 instructions&quot; 的形式</span><br>        match_re = re.search(<span class="hljs-string">r&#x27;(\d+)\s+instructions&#x27;</span>, combined, re.IGNORECASE)<br>        <span class="hljs-keyword">if</span> match_re:<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(match_re.group(<span class="hljs-number">1</span>))<br><br>        <span class="hljs-comment"># 2) 再查找最后一行是数字的情况</span><br>        lines = combined.strip().splitlines()<br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">reversed</span>(lines):<br>            s = line.strip()<br>            <span class="hljs-keyword">if</span> s.isdigit():<br>                <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(s)<br><br>        <span class="hljs-comment"># 3) 检查常见的输出文件（inscount.out 等）</span><br>        file_count, file_content = read_inscount_outfile(workdir=<span class="hljs-string">&#x27;.&#x27;</span>)<br>        <span class="hljs-keyword">if</span> file_count <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            <span class="hljs-comment"># 可选：删除该文件以免后续干扰（如果你不想删除可以注释掉）</span><br>            <span class="hljs-keyword">try</span>:<br>                os.remove(<span class="hljs-string">&#x27;inscount.out&#x27;</span>)<br>            <span class="hljs-keyword">except</span> Exception:<br>                <span class="hljs-keyword">pass</span><br>            <span class="hljs-keyword">return</span> file_count<br><br>        <span class="hljs-comment"># 4) 启发式判断：若退出码非 0 且输出包含拒绝信息，则视为无效（返回 0）</span><br>        low = combined.lower()<br>        <span class="hljs-keyword">if</span> exitcode <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> exitcode != <span class="hljs-number">0</span>:<br>            <span class="hljs-comment"># 常见拒绝提示</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">any</span>(k <span class="hljs-keyword">in</span> low <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> [<span class="hljs-string">&#x27;nope&#x27;</span>, <span class="hljs-string">&#x27;try again&#x27;</span>, <span class="hljs-string">&#x27;wrong&#x27;</span>, <span class="hljs-string">&#x27;incorrect&#x27;</span>]):<br>                <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>            <span class="hljs-comment"># 若 stderr 有 pin 自身的错误，返回 0</span><br>            <span class="hljs-keyword">if</span> stderr.strip():<br>                <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br><br>        <span class="hljs-comment"># 5) 若退出码是 0 且输出包含成功关键字，则返回非常大的计数作为 heuristic</span><br>        <span class="hljs-keyword">if</span> exitcode == <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">any</span>(k <span class="hljs-keyword">in</span> low <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> [<span class="hljs-string">&#x27;flag&#x27;</span>, <span class="hljs-string">&#x27;correct&#x27;</span>, <span class="hljs-string">&#x27;congrats&#x27;</span>, <span class="hljs-string">&#x27;success&#x27;</span>]):<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">10</span>**<span class="hljs-number">9</span><br><br>        <span class="hljs-comment"># 否则无法解析到有效信息</span><br>        log.warning(<span class="hljs-string">&quot;无法从 Pin 输出或文件中解析到指令数（stdout/stderr/file 均无数字）。&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">except</span> subprocess.TimeoutExpired <span class="hljs-keyword">as</span> te:<br>        sys.stderr.write(<span class="hljs-string">f&quot;[TIMEOUT] Pin 运行超时: <span class="hljs-subst">&#123;te&#125;</span>\n&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    <span class="hljs-keyword">except</span> FileNotFoundError <span class="hljs-keyword">as</span> fe:<br>        sys.stderr.write(<span class="hljs-string">f&quot;[FATAL] 找不到 pin 可执行文件或路径错误: <span class="hljs-subst">&#123;fe&#125;</span>\n&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        sys.stderr.write(<span class="hljs-string">f&quot;[FATAL ERROR] get_inscount 发生错误: <span class="hljs-subst">&#123;e&#125;</span>\n&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br><br><br><span class="hljs-comment"># --- 3. 爆破主循环 ---</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    known_flag = <span class="hljs-built_in">list</span>(<span class="hljs-string">&quot;A&quot;</span> * FLAG_LEN)<br>    log.info(<span class="hljs-string">f&quot;开始爆破，长度 <span class="hljs-subst">&#123;FLAG_LEN&#125;</span>，字符集大小 <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(CHARSET)&#125;</span>，从索引 <span class="hljs-subst">&#123;START_INDEX&#125;</span> 开始。&quot;</span>)<br><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(TARGET_BINARY):<br>        log.critical(<span class="hljs-string">f&quot;目标文件不存在: <span class="hljs-subst">&#123;TARGET_BINARY&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(PIN_TOOL_PATH):<br>        log.critical(<span class="hljs-string">f&quot;Pin Tool 不存在: <span class="hljs-subst">&#123;PIN_TOOL_PATH&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(PIN_CMD_LIST[<span class="hljs-number">0</span>]):<br>        log.critical(<span class="hljs-string">f&quot;Pin 可执行文件不存在: <span class="hljs-subst">&#123;PIN_CMD_LIST[<span class="hljs-number">0</span>]&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span><br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(START_INDEX, FLAG_LEN):<br>        log.info(<span class="hljs-string">f&quot;\n&gt;&gt;&gt;&gt; 正在爆破第 <span class="hljs-subst">&#123;i&#125;</span> 位...&quot;</span>)<br><br>        max_count = <span class="hljs-number">0</span><br>        best_char = <span class="hljs-literal">None</span><br><br>        <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> CHARSET:<br>            current_test = known_flag[:]<br>            current_test[i] = char<br>            payload = <span class="hljs-string">&quot;&quot;</span>.join(current_test).encode(<span class="hljs-string">&#x27;latin-1&#x27;</span>)<br><br>            count = get_inscount(payload)<br><br>            <span class="hljs-keyword">if</span> count == <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">continue</span><br><br>            <span class="hljs-keyword">if</span> count &gt; max_count:<br>                max_count = count<br>                best_char = char<br>                log.info(<span class="hljs-string">f&quot;发现新的最大值: 字符 &#x27;<span class="hljs-subst">&#123;best_char&#125;</span>&#x27; -&gt; <span class="hljs-subst">&#123;max_count&#125;</span> 条指令&quot;</span>)<br><br>        <span class="hljs-keyword">if</span> best_char:<br>            known_flag[i] = best_char<br>            log.success(<span class="hljs-string">f&quot;第 <span class="hljs-subst">&#123;i&#125;</span> 位确定为: &#x27;<span class="hljs-subst">&#123;best_char&#125;</span>&#x27;&quot;</span>)<br>            log.success(<span class="hljs-string">f&quot;当前 Flag: <span class="hljs-subst">&#123;<span class="hljs-string">&#x27;&#x27;</span>.join(known_flag)&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            log.warning(<span class="hljs-string">f&quot;第 <span class="hljs-subst">&#123;i&#125;</span> 位爆破失败。所有字符返回 0。&quot;</span>)<br>            <span class="hljs-keyword">break</span><br><br>    log.success(<span class="hljs-string">f&quot;\n--- 爆破完成 ---&quot;</span>)<br>    log.success(<span class="hljs-string">f&quot;最终 Flag: <span class="hljs-subst">&#123;<span class="hljs-string">&#x27;&#x27;</span>.join(known_flag)&#125;</span>&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()<br></code></pre></td></tr></table></figure>

<p>等一会儿</p>
<p><img src="https://img.dkdun.cn/v1/2025/12/3445360aea5140f4.png"></p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;m4z3d_vm_jump5__42&#125;</span><br></code></pre></td></tr></table></figure>

<p>还可以改文件字节码，让程序返回值为长度，修改 mov eax，1 为 mov eax，ebx，patch 为新文件</p>
<p><img src="https://img.dkdun.cn/v1/2025/12/8054575a4a972a55.png"></p>
<p>再利用 BFS 搜索进行单字节爆破</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">import</span> subprocess<br><span class="hljs-keyword">import</span> sys<br><br>FLAG_LENGTH = <span class="hljs-number">24</span><br>CHARSET = string.ascii_letters + string.digits + string.punctuation<br><br>jobs = [(<span class="hljs-built_in">list</span>(<span class="hljs-string">&quot;flag&#123;&quot;</span>), <span class="hljs-number">5</span>)]<br>final_flags = <span class="hljs-built_in">set</span>()<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Starting BFS brute-force to find ALL passing flags...&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;-&quot;</span> * <span class="hljs-number">50</span>)<br><br><span class="hljs-keyword">while</span> jobs:<br>    current_guess, i = jobs.pop(<span class="hljs-number">0</span>)<br>    <br>    <span class="hljs-keyword">if</span> i == FLAG_LENGTH:<br>        final_flags.add(<span class="hljs-string">&quot;&quot;</span>.join(current_guess))<br>        <span class="hljs-keyword">continue</span><br>    <br>    res = []<br>    <br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> CHARSET:<br>        test_guess = current_guess + [char] + [<span class="hljs-string">&quot;A&quot;</span>] * (FLAG_LENGTH - i - <span class="hljs-number">1</span>)<br>        input_data = <span class="hljs-string">&quot;&quot;</span>.join(test_guess).encode()<br>        <br>        <span class="hljs-keyword">try</span>:<br>            p = subprocess.run(<br>                [<span class="hljs-string">&quot;./hyperjump_patched&quot;</span>],<br>                <span class="hljs-built_in">input</span>=input_data,<br>                timeout=<span class="hljs-number">10</span>,<br>                capture_output=<span class="hljs-literal">True</span><br>            )<br>            <br>            count = p.returncode<br>            <span class="hljs-keyword">if</span> count == <span class="hljs-number">0</span>:<br>                 count = FLAG_LENGTH<br>                 <br>        <span class="hljs-keyword">except</span> subprocess.TimeoutExpired:<br>             count = -<span class="hljs-number">1</span> <br>        <span class="hljs-keyword">except</span> Exception:<br>             count = -<span class="hljs-number">1</span><br><br>        res.append((char, count))<br><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> res:<br>        <span class="hljs-keyword">continue</span><br><br>    max_count = <span class="hljs-built_in">max</span>(r[<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> res)<br>    <br>    <span class="hljs-keyword">if</span> max_count &lt;= <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">continue</span><br>        <br>    <span class="hljs-keyword">for</span> char, count <span class="hljs-keyword">in</span> res:<br>        <span class="hljs-keyword">if</span> count == max_count:<br>            new_guess = current_guess + [char]<br>            jobs.append((new_guess, i + <span class="hljs-number">1</span>))<br>            current_flag = <span class="hljs-string">&quot;&quot;</span>.join(new_guess)<br>            output_line = <span class="hljs-string">f&quot;[Index <span class="hljs-subst">&#123;i+<span class="hljs-number">1</span>:02d&#125;</span>] Testing: <span class="hljs-subst">&#123;current_flag:&lt;&#123;FLAG_LENGTH&#125;</span>&#125; (Max Match: <span class="hljs-subst">&#123;max_count&#125;</span>) | Jobs left: <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(jobs)&#125;</span>)&quot;</span><br>            sys.stdout.write(<span class="hljs-string">f&quot;\r<span class="hljs-subst">&#123;output_line&#125;</span>&quot;</span>)<br>            sys.stdout.flush()<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n&quot;</span> + <span class="hljs-string">&quot;-&quot;</span> * <span class="hljs-number">50</span>)<br><span class="hljs-keyword">if</span> final_flags:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;🎉 Found ALL passing Flags:&quot;</span>)<br>    <span class="hljs-keyword">for</span> flag <span class="hljs-keyword">in</span> <span class="hljs-built_in">sorted</span>(<span class="hljs-built_in">list</span>(final_flags)):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;   -&gt; <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;❌ No complete flag found.&quot;</span>)<br></code></pre></td></tr></table></figure>

<p><img src="https://img.dkdun.cn/v1/2025/12/9673f512ff5afe4e.png"></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E6%AF%94%E8%B5%9B/" class="category-chain-item">比赛</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>第八届“强网”拟态防御国际精英挑战赛</div>
      <div>http://example.com/2025/10/31/第八届“强网”拟态防御国际精英挑战赛/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>butt3rf1y</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年10月31日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/10/29/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-10%E6%9C%88/" title="2025年Solar应急响应公益月赛-10月">
                        <span class="hidden-mobile">2025年Solar应急响应公益月赛-10月</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments">
      
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/valine/1.5.1/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"rWKtzRd76Kz6dC7Vd9dUwQux-gzGzoHsz","appKey":"DxMgc7gveh6B1aJKyAZnoFNj","path":"window.location.pathname","placeholder":null,"avatar":"retro","meta":["nick","mail","link"],"requiredFields":[],"pageSize":10,"lang":"zh-CN","highlight":false,"recordIP":true,"serverURLs":"","emojiCDN":null,"emojiMaps":null,"enableQQ":true},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          var imgSelector = '#valine .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span> </a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> <div style="font-size: 0.85rem"> <span id="timeDate">载入天数...</span> <span id="times">载入时分秒...</span> <script src="/js/duration.js"></script> </div> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    

  

</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>







  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>

<!--浏览器搞笑标题-->
<script type="text/javascript" src="\js\FunnyTitle.js"></script>


  <!--下面两行是核心内容-->
  <link  rel="stylesheet" href="/css/TrymenT-ClocK.min.css" />
  <!-- TrymenT-ClocK.min.js removed per user request -->
 
